/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var nU=Object.create;var cy=Object.defineProperty;var aU=Object.getOwnPropertyDescriptor;var sU=Object.getOwnPropertyNames;var oU=Object.getPrototypeOf,lU=Object.prototype.hasOwnProperty;var _e=(a,t)=>()=>(a&&(t=a(a=0)),t);var uy=(a,t)=>()=>(t||a((t={exports:{}}).exports,t),t.exports),At=(a,t)=>{for(var e in t)cy(a,e,{get:t[e],enumerable:!0})},AP=(a,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of sU(t))!lU.call(a,n)&&n!==e&&cy(a,n,{get:()=>t[n],enumerable:!(r=aU(t,n))||r.enumerable});return a};var Ca=(a,t,e)=>(e=a!=null?nU(oU(a)):{},AP(t||!a||!a.__esModule?cy(e,"default",{value:a,enumerable:!0}):e,a)),Do=a=>AP(cy({},"__esModule",{value:!0}),a);var xT=uy((dy,OP)=>{(function(a,t){typeof dy=="object"&&typeof OP!="undefined"?t(dy):typeof define=="function"&&define.amd?define(["exports"],t):(a=typeof globalThis!="undefined"?globalThis:a||self,t(a.leaflet={}))})(dy,(function(a){"use strict";var t="1.9.4";function e(p){var b,S,A,H;for(S=1,A=arguments.length;S<A;S++){H=arguments[S];for(b in H)p[b]=H[b]}return p}var r=Object.create||(function(){function p(){}return function(b){return p.prototype=b,new p}})();function n(p,b){var S=Array.prototype.slice;if(p.bind)return p.bind.apply(p,S.call(arguments,1));var A=S.call(arguments,2);return function(){return p.apply(b,A.length?A.concat(S.call(arguments)):arguments)}}var s=0;function o(p){return"_leaflet_id"in p||(p._leaflet_id=++s),p._leaflet_id}function l(p,b,S){var A,H,J,de;return de=function(){A=!1,H&&(J.apply(S,H),H=!1)},J=function(){A?H=arguments:(p.apply(S,arguments),setTimeout(de,b),A=!0)},J}function c(p,b,S){var A=b[1],H=b[0],J=A-H;return p===A&&S?p:((p-H)%J+J)%J+H}function u(){return!1}function d(p,b){if(b===!1)return p;var S=Math.pow(10,b===void 0?6:b);return Math.round(p*S)/S}function h(p){return p.trim?p.trim():p.replace(/^\s+|\s+$/g,"")}function f(p){return h(p).split(/\s+/)}function m(p,b){Object.prototype.hasOwnProperty.call(p,"options")||(p.options=p.options?r(p.options):{});for(var S in b)p.options[S]=b[S];return p.options}function g(p,b,S){var A=[];for(var H in p)A.push(encodeURIComponent(S?H.toUpperCase():H)+"="+encodeURIComponent(p[H]));return(!b||b.indexOf("?")===-1?"?":"&")+A.join("&")}var y=/\{ *([\w_ -]+) *\}/g;function v(p,b){return p.replace(y,function(S,A){var H=b[A];if(H===void 0)throw new Error("No value provided for variable "+S);return typeof H=="function"&&(H=H(b)),H})}var E=Array.isArray||function(p){return Object.prototype.toString.call(p)==="[object Array]"};function C(p,b){for(var S=0;S<p.length;S++)if(p[S]===b)return S;return-1}var _="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function x(p){return window["webkit"+p]||window["moz"+p]||window["ms"+p]}var P=0;function I(p){var b=+new Date,S=Math.max(0,16-(b-P));return P=b+S,window.setTimeout(p,S)}var M=window.requestAnimationFrame||x("RequestAnimationFrame")||I,O=window.cancelAnimationFrame||x("CancelAnimationFrame")||x("CancelRequestAnimationFrame")||function(p){window.clearTimeout(p)};function R(p,b,S){if(S&&M===I)p.call(b);else return M.call(window,n(p,b))}function F(p){p&&O.call(window,p)}var $={__proto__:null,extend:e,create:r,bind:n,get lastId(){return s},stamp:o,throttle:l,wrapNum:c,falseFn:u,formatNum:d,trim:h,splitWords:f,setOptions:m,getParamString:g,template:v,isArray:E,indexOf:C,emptyImageUrl:_,requestFn:M,cancelFn:O,requestAnimFrame:R,cancelAnimFrame:F};function k(){}k.extend=function(p){var b=function(){m(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},S=b.__super__=this.prototype,A=r(S);A.constructor=b,b.prototype=A;for(var H in this)Object.prototype.hasOwnProperty.call(this,H)&&H!=="prototype"&&H!=="__super__"&&(b[H]=this[H]);return p.statics&&e(b,p.statics),p.includes&&(N(p.includes),e.apply(null,[A].concat(p.includes))),e(A,p),delete A.statics,delete A.includes,A.options&&(A.options=S.options?r(S.options):{},e(A.options,p.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){S.callInitHooks&&S.callInitHooks.call(this),this._initHooksCalled=!0;for(var J=0,de=A._initHooks.length;J<de;J++)A._initHooks[J].call(this)}},b},k.include=function(p){var b=this.prototype.options;return e(this.prototype,p),p.options&&(this.prototype.options=b,this.mergeOptions(p.options)),this},k.mergeOptions=function(p){return e(this.prototype.options,p),this},k.addInitHook=function(p){var b=Array.prototype.slice.call(arguments,1),S=typeof p=="function"?p:function(){this[p].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(S),this};function N(p){if(!(typeof L=="undefined"||!L||!L.Mixin)){p=E(p)?p:[p];for(var b=0;b<p.length;b++)p[b]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var G={on:function(p,b,S){if(typeof p=="object")for(var A in p)this._on(A,p[A],b);else{p=f(p);for(var H=0,J=p.length;H<J;H++)this._on(p[H],b,S)}return this},off:function(p,b,S){if(!arguments.length)delete this._events;else if(typeof p=="object")for(var A in p)this._off(A,p[A],b);else{p=f(p);for(var H=arguments.length===1,J=0,de=p.length;J<de;J++)H?this._off(p[J]):this._off(p[J],b,S)}return this},_on:function(p,b,S,A){if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}if(this._listens(p,b,S)===!1){S===this&&(S=void 0);var H={fn:b,ctx:S};A&&(H.once=!0),this._events=this._events||{},this._events[p]=this._events[p]||[],this._events[p].push(H)}},_off:function(p,b,S){var A,H,J;if(this._events&&(A=this._events[p],!!A)){if(arguments.length===1){if(this._firingCount)for(H=0,J=A.length;H<J;H++)A[H].fn=u;delete this._events[p];return}if(typeof b!="function"){console.warn("wrong listener type: "+typeof b);return}var de=this._listens(p,b,S);if(de!==!1){var be=A[de];this._firingCount&&(be.fn=u,this._events[p]=A=A.slice()),A.splice(de,1)}}},fire:function(p,b,S){if(!this.listens(p,S))return this;var A=e({},b,{type:p,target:this,sourceTarget:b&&b.sourceTarget||this});if(this._events){var H=this._events[p];if(H){this._firingCount=this._firingCount+1||1;for(var J=0,de=H.length;J<de;J++){var be=H[J],ke=be.fn;be.once&&this.off(p,ke,be.ctx),ke.call(be.ctx||this,A)}this._firingCount--}}return S&&this._propagateEvent(A),this},listens:function(p,b,S,A){typeof p!="string"&&console.warn('"string" type argument expected');var H=b;typeof b!="function"&&(A=!!b,H=void 0,S=void 0);var J=this._events&&this._events[p];if(J&&J.length&&this._listens(p,H,S)!==!1)return!0;if(A){for(var de in this._eventParents)if(this._eventParents[de].listens(p,b,S,A))return!0}return!1},_listens:function(p,b,S){if(!this._events)return!1;var A=this._events[p]||[];if(!b)return!!A.length;S===this&&(S=void 0);for(var H=0,J=A.length;H<J;H++)if(A[H].fn===b&&A[H].ctx===S)return H;return!1},once:function(p,b,S){if(typeof p=="object")for(var A in p)this._on(A,p[A],b,!0);else{p=f(p);for(var H=0,J=p.length;H<J;H++)this._on(p[H],b,S,!0)}return this},addEventParent:function(p){return this._eventParents=this._eventParents||{},this._eventParents[o(p)]=p,this},removeEventParent:function(p){return this._eventParents&&delete this._eventParents[o(p)],this},_propagateEvent:function(p){for(var b in this._eventParents)this._eventParents[b].fire(p.type,e({layer:p.target,propagatedFrom:p.target},p),!0)}};G.addEventListener=G.on,G.removeEventListener=G.clearAllEventListeners=G.off,G.addOneTimeEventListener=G.once,G.fireEvent=G.fire,G.hasEventListeners=G.listens;var W=k.extend(G);function Y(p,b,S){this.x=S?Math.round(p):p,this.y=S?Math.round(b):b}var U=Math.trunc||function(p){return p>0?Math.floor(p):Math.ceil(p)};Y.prototype={clone:function(){return new Y(this.x,this.y)},add:function(p){return this.clone()._add(Z(p))},_add:function(p){return this.x+=p.x,this.y+=p.y,this},subtract:function(p){return this.clone()._subtract(Z(p))},_subtract:function(p){return this.x-=p.x,this.y-=p.y,this},divideBy:function(p){return this.clone()._divideBy(p)},_divideBy:function(p){return this.x/=p,this.y/=p,this},multiplyBy:function(p){return this.clone()._multiplyBy(p)},_multiplyBy:function(p){return this.x*=p,this.y*=p,this},scaleBy:function(p){return new Y(this.x*p.x,this.y*p.y)},unscaleBy:function(p){return new Y(this.x/p.x,this.y/p.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=U(this.x),this.y=U(this.y),this},distanceTo:function(p){p=Z(p);var b=p.x-this.x,S=p.y-this.y;return Math.sqrt(b*b+S*S)},equals:function(p){return p=Z(p),p.x===this.x&&p.y===this.y},contains:function(p){return p=Z(p),Math.abs(p.x)<=Math.abs(this.x)&&Math.abs(p.y)<=Math.abs(this.y)},toString:function(){return"Point("+d(this.x)+", "+d(this.y)+")"}};function Z(p,b,S){return p instanceof Y?p:E(p)?new Y(p[0],p[1]):p==null?p:typeof p=="object"&&"x"in p&&"y"in p?new Y(p.x,p.y):new Y(p,b,S)}function q(p,b){if(p)for(var S=b?[p,b]:p,A=0,H=S.length;A<H;A++)this.extend(S[A])}q.prototype={extend:function(p){var b,S;if(!p)return this;if(p instanceof Y||typeof p[0]=="number"||"x"in p)b=S=Z(p);else if(p=X(p),b=p.min,S=p.max,!b||!S)return this;return!this.min&&!this.max?(this.min=b.clone(),this.max=S.clone()):(this.min.x=Math.min(b.x,this.min.x),this.max.x=Math.max(S.x,this.max.x),this.min.y=Math.min(b.y,this.min.y),this.max.y=Math.max(S.y,this.max.y)),this},getCenter:function(p){return Z((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,p)},getBottomLeft:function(){return Z(this.min.x,this.max.y)},getTopRight:function(){return Z(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(p){var b,S;return typeof p[0]=="number"||p instanceof Y?p=Z(p):p=X(p),p instanceof q?(b=p.min,S=p.max):b=S=p,b.x>=this.min.x&&S.x<=this.max.x&&b.y>=this.min.y&&S.y<=this.max.y},intersects:function(p){p=X(p);var b=this.min,S=this.max,A=p.min,H=p.max,J=H.x>=b.x&&A.x<=S.x,de=H.y>=b.y&&A.y<=S.y;return J&&de},overlaps:function(p){p=X(p);var b=this.min,S=this.max,A=p.min,H=p.max,J=H.x>b.x&&A.x<S.x,de=H.y>b.y&&A.y<S.y;return J&&de},isValid:function(){return!!(this.min&&this.max)},pad:function(p){var b=this.min,S=this.max,A=Math.abs(b.x-S.x)*p,H=Math.abs(b.y-S.y)*p;return X(Z(b.x-A,b.y-H),Z(S.x+A,S.y+H))},equals:function(p){return p?(p=X(p),this.min.equals(p.getTopLeft())&&this.max.equals(p.getBottomRight())):!1}};function X(p,b){return!p||p instanceof q?p:new q(p,b)}function ie(p,b){if(p)for(var S=b?[p,b]:p,A=0,H=S.length;A<H;A++)this.extend(S[A])}ie.prototype={extend:function(p){var b=this._southWest,S=this._northEast,A,H;if(p instanceof K)A=p,H=p;else if(p instanceof ie){if(A=p._southWest,H=p._northEast,!A||!H)return this}else return p?this.extend(se(p)||j(p)):this;return!b&&!S?(this._southWest=new K(A.lat,A.lng),this._northEast=new K(H.lat,H.lng)):(b.lat=Math.min(A.lat,b.lat),b.lng=Math.min(A.lng,b.lng),S.lat=Math.max(H.lat,S.lat),S.lng=Math.max(H.lng,S.lng)),this},pad:function(p){var b=this._southWest,S=this._northEast,A=Math.abs(b.lat-S.lat)*p,H=Math.abs(b.lng-S.lng)*p;return new ie(new K(b.lat-A,b.lng-H),new K(S.lat+A,S.lng+H))},getCenter:function(){return new K((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new K(this.getNorth(),this.getWest())},getSouthEast:function(){return new K(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(p){typeof p[0]=="number"||p instanceof K||"lat"in p?p=se(p):p=j(p);var b=this._southWest,S=this._northEast,A,H;return p instanceof ie?(A=p.getSouthWest(),H=p.getNorthEast()):A=H=p,A.lat>=b.lat&&H.lat<=S.lat&&A.lng>=b.lng&&H.lng<=S.lng},intersects:function(p){p=j(p);var b=this._southWest,S=this._northEast,A=p.getSouthWest(),H=p.getNorthEast(),J=H.lat>=b.lat&&A.lat<=S.lat,de=H.lng>=b.lng&&A.lng<=S.lng;return J&&de},overlaps:function(p){p=j(p);var b=this._southWest,S=this._northEast,A=p.getSouthWest(),H=p.getNorthEast(),J=H.lat>b.lat&&A.lat<S.lat,de=H.lng>b.lng&&A.lng<S.lng;return J&&de},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(p,b){return p?(p=j(p),this._southWest.equals(p.getSouthWest(),b)&&this._northEast.equals(p.getNorthEast(),b)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function j(p,b){return p instanceof ie?p:new ie(p,b)}function K(p,b,S){if(isNaN(p)||isNaN(b))throw new Error("Invalid LatLng object: ("+p+", "+b+")");this.lat=+p,this.lng=+b,S!==void 0&&(this.alt=+S)}K.prototype={equals:function(p,b){if(!p)return!1;p=se(p);var S=Math.max(Math.abs(this.lat-p.lat),Math.abs(this.lng-p.lng));return S<=(b===void 0?1e-9:b)},toString:function(p){return"LatLng("+d(this.lat,p)+", "+d(this.lng,p)+")"},distanceTo:function(p){return ge.distance(this,se(p))},wrap:function(){return ge.wrapLatLng(this)},toBounds:function(p){var b=180*p/40075017,S=b/Math.cos(Math.PI/180*this.lat);return j([this.lat-b,this.lng-S],[this.lat+b,this.lng+S])},clone:function(){return new K(this.lat,this.lng,this.alt)}};function se(p,b,S){return p instanceof K?p:E(p)&&typeof p[0]!="object"?p.length===3?new K(p[0],p[1],p[2]):p.length===2?new K(p[0],p[1]):null:p==null?p:typeof p=="object"&&"lat"in p?new K(p.lat,"lng"in p?p.lng:p.lon,p.alt):b===void 0?null:new K(p,b,S)}var ne={latLngToPoint:function(p,b){var S=this.projection.project(p),A=this.scale(b);return this.transformation._transform(S,A)},pointToLatLng:function(p,b){var S=this.scale(b),A=this.transformation.untransform(p,S);return this.projection.unproject(A)},project:function(p){return this.projection.project(p)},unproject:function(p){return this.projection.unproject(p)},scale:function(p){return 256*Math.pow(2,p)},zoom:function(p){return Math.log(p/256)/Math.LN2},getProjectedBounds:function(p){if(this.infinite)return null;var b=this.projection.bounds,S=this.scale(p),A=this.transformation.transform(b.min,S),H=this.transformation.transform(b.max,S);return new q(A,H)},infinite:!1,wrapLatLng:function(p){var b=this.wrapLng?c(p.lng,this.wrapLng,!0):p.lng,S=this.wrapLat?c(p.lat,this.wrapLat,!0):p.lat,A=p.alt;return new K(S,b,A)},wrapLatLngBounds:function(p){var b=p.getCenter(),S=this.wrapLatLng(b),A=b.lat-S.lat,H=b.lng-S.lng;if(A===0&&H===0)return p;var J=p.getSouthWest(),de=p.getNorthEast(),be=new K(J.lat-A,J.lng-H),ke=new K(de.lat-A,de.lng-H);return new ie(be,ke)}},ge=e({},ne,{wrapLng:[-180,180],R:6371e3,distance:function(p,b){var S=Math.PI/180,A=p.lat*S,H=b.lat*S,J=Math.sin((b.lat-p.lat)*S/2),de=Math.sin((b.lng-p.lng)*S/2),be=J*J+Math.cos(A)*Math.cos(H)*de*de,ke=2*Math.atan2(Math.sqrt(be),Math.sqrt(1-be));return this.R*ke}}),ve=6378137,Se={R:ve,MAX_LATITUDE:85.0511287798,project:function(p){var b=Math.PI/180,S=this.MAX_LATITUDE,A=Math.max(Math.min(S,p.lat),-S),H=Math.sin(A*b);return new Y(this.R*p.lng*b,this.R*Math.log((1+H)/(1-H))/2)},unproject:function(p){var b=180/Math.PI;return new K((2*Math.atan(Math.exp(p.y/this.R))-Math.PI/2)*b,p.x*b/this.R)},bounds:(function(){var p=ve*Math.PI;return new q([-p,-p],[p,p])})()};function Te(p,b,S,A){if(E(p)){this._a=p[0],this._b=p[1],this._c=p[2],this._d=p[3];return}this._a=p,this._b=b,this._c=S,this._d=A}Te.prototype={transform:function(p,b){return this._transform(p.clone(),b)},_transform:function(p,b){return b=b||1,p.x=b*(this._a*p.x+this._b),p.y=b*(this._c*p.y+this._d),p},untransform:function(p,b){return b=b||1,new Y((p.x/b-this._b)/this._a,(p.y/b-this._d)/this._c)}};function me(p,b,S,A){return new Te(p,b,S,A)}var pe=e({},ge,{code:"EPSG:3857",projection:Se,transformation:(function(){var p=.5/(Math.PI*Se.R);return me(p,.5,-p,.5)})()}),B=e({},pe,{code:"EPSG:900913"});function oe(p){return document.createElementNS("http://www.w3.org/2000/svg",p)}function he(p,b){var S="",A,H,J,de,be,ke;for(A=0,J=p.length;A<J;A++){for(be=p[A],H=0,de=be.length;H<de;H++)ke=be[H],S+=(H?"L":"M")+ke.x+" "+ke.y;S+=b?De.svg?"z":"x":""}return S||"M0 0"}var te=document.documentElement.style,re="ActiveXObject"in window,ce=re&&!document.addEventListener,Ee="msLaunchUri"in navigator&&!("documentMode"in document),Ce=Wt("webkit"),le=Wt("android"),we=Wt("android 2")||Wt("android 3"),Le=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Me=le&&Wt("Google")&&Le<537&&!("AudioNode"in window),Ne=!!window.opera,Ge=!Ee&&Wt("chrome"),Ye=Wt("gecko")&&!Ce&&!Ne&&!re,ft=!Ge&&Wt("safari"),ct=Wt("phantom"),Ve="OTransition"in te,et=navigator.platform.indexOf("Win")===0,$e=re&&"transition"in te,Ie="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!we,ee="MozPerspective"in te,ye=!window.L_DISABLE_3D&&($e||Ie||ee)&&!Ve&&!ct,Pe=typeof orientation!="undefined"||Wt("mobile"),xe=Pe&&Ce,Fe=Pe&&Ie,qe=!window.PointerEvent&&window.MSPointerEvent,Re=!!(window.PointerEvent||qe),ze="ontouchstart"in window||!!window.TouchEvent,Ze=!window.L_NO_TOUCH&&(ze||Re),rt=Pe&&Ne,Ct=Pe&&Ye,bt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Xe=(function(){var p=!1;try{var b=Object.defineProperty({},"passive",{get:function(){p=!0}});window.addEventListener("testPassiveEventSupport",u,b),window.removeEventListener("testPassiveEventSupport",u,b)}catch(S){}return p})(),wt=(function(){return!!document.createElement("canvas").getContext})(),vt=!!(document.createElementNS&&oe("svg").createSVGRect),Kr=!!vt&&(function(){var p=document.createElement("div");return p.innerHTML="<svg/>",(p.firstChild&&p.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ur=!vt&&(function(){try{var p=document.createElement("div");p.innerHTML='<v:shape adj="1"/>';var b=p.firstChild;return b.style.behavior="url(#default#VML)",b&&typeof b.adj=="object"}catch(S){return!1}})(),Si=navigator.platform.indexOf("Mac")===0,mr=navigator.platform.indexOf("Linux")===0;function Wt(p){return navigator.userAgent.toLowerCase().indexOf(p)>=0}var De={ie:re,ielt9:ce,edge:Ee,webkit:Ce,android:le,android23:we,androidStock:Me,opera:Ne,chrome:Ge,gecko:Ye,safari:ft,phantom:ct,opera12:Ve,win:et,ie3d:$e,webkit3d:Ie,gecko3d:ee,any3d:ye,mobile:Pe,mobileWebkit:xe,mobileWebkit3d:Fe,msPointer:qe,pointer:Re,touch:Ze,touchNative:ze,mobileOpera:rt,mobileGecko:Ct,retina:bt,passiveEvents:Xe,canvas:wt,svg:vt,vml:ur,inlineSvg:Kr,mac:Si,linux:mr},ri=De.msPointer?"MSPointerDown":"pointerdown",va=De.msPointer?"MSPointerMove":"pointermove",Nt=De.msPointer?"MSPointerUp":"pointerup",un=De.msPointer?"MSPointerCancel":"pointercancel",Dt={touchstart:ri,touchmove:va,touchend:Nt,touchcancel:un},Dn={touchstart:Rf,touchmove:ll,touchend:ll,touchcancel:ll},ya={},Sr=!1;function Lr(p,b,S){return b==="touchstart"&&$a(),Dn[b]?(S=Dn[b].bind(this,S),p.addEventListener(Dt[b],S,!1),S):(console.warn("wrong event specified:",b),u)}function dr(p,b,S){if(!Dt[b]){console.warn("wrong event specified:",b);return}p.removeEventListener(Dt[b],S,!1)}function zt(p){ya[p.pointerId]=p}function xi(p){ya[p.pointerId]&&(ya[p.pointerId]=p)}function Rr(p){delete ya[p.pointerId]}function $a(){Sr||(document.addEventListener(ri,zt,!0),document.addEventListener(va,xi,!0),document.addEventListener(Nt,Rr,!0),document.addEventListener(un,Rr,!0),Sr=!0)}function ll(p,b){if(b.pointerType!==(b.MSPOINTER_TYPE_MOUSE||"mouse")){b.touches=[];for(var S in ya)b.touches.push(ya[S]);b.changedTouches=[b],p(b)}}function Rf(p,b){b.MSPOINTER_TYPE_TOUCH&&b.pointerType===b.MSPOINTER_TYPE_TOUCH&&ki(b),ll(p,b)}function Nf(p){var b={},S,A;for(A in p)S=p[A],b[A]=S&&S.bind?S.bind(p):S;return p=b,b.type="dblclick",b.detail=2,b.isTrusted=!1,b._simulated=!0,b}var Nr=200;function cl(p,b){p.addEventListener("dblclick",b);var S=0,A;function H(J){if(J.detail!==1){A=J.detail;return}if(!(J.pointerType==="mouse"||J.sourceCapabilities&&!J.sourceCapabilities.firesTouchEvents)){var de=Sv(J);if(!(de.some(function(ke){return ke instanceof HTMLLabelElement&&ke.attributes.for})&&!de.some(function(ke){return ke instanceof HTMLInputElement||ke instanceof HTMLSelectElement}))){var be=Date.now();be-S<=Nr?(A++,A===2&&b(Nf(J))):A=1,S=be}}}return p.addEventListener("click",H),{dblclick:b,simDblclick:H}}function Bf(p,b){p.removeEventListener("dblclick",b.dblclick),p.removeEventListener("click",b.simDblclick)}var ul=od(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),qn=od(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),dl=qn==="webkitTransition"||qn==="OTransition"?qn+"End":"transitionend";function wo(p){return typeof p=="string"?document.getElementById(p):p}function Ws(p,b){var S=p.style[b]||p.currentStyle&&p.currentStyle[b];if((!S||S==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(p,null);S=A?A[b]:null}return S==="auto"?null:S}function Bt(p,b,S){var A=document.createElement(p);return A.className=b||"",S&&S.appendChild(A),A}function xr(p){var b=p.parentNode;b&&b.removeChild(p)}function $i(p){for(;p.firstChild;)p.removeChild(p.firstChild)}function ba(p){var b=p.parentNode;b&&b.lastChild!==p&&b.appendChild(p)}function za(p){var b=p.parentNode;b&&b.firstChild!==p&&b.insertBefore(p,b.firstChild)}function ds(p,b){if(p.classList!==void 0)return p.classList.contains(b);var S=Ha(p);return S.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(S)}function ot(p,b){if(p.classList!==void 0)for(var S=f(b),A=0,H=S.length;A<H;A++)p.classList.add(S[A]);else if(!ds(p,b)){var J=Ha(p);Lc(p,(J?J+" ":"")+b)}}function Br(p,b){p.classList!==void 0?p.classList.remove(b):Lc(p,h((" "+Ha(p)+" ").replace(" "+b+" "," ")))}function Lc(p,b){p.className.baseVal===void 0?p.className=b:p.className.baseVal=b}function Ha(p){return p.correspondingElement&&(p=p.correspondingElement),p.className.baseVal===void 0?p.className:p.className.baseVal}function Pn(p,b){"opacity"in p.style?p.style.opacity=b:"filter"in p.style&&GE(p,b)}function GE(p,b){var S=!1,A="DXImageTransform.Microsoft.Alpha";try{S=p.filters.item(A)}catch(H){if(b===1)return}b=Math.round(b*100),S?(S.Enabled=b!==100,S.Opacity=b):p.style.filter+=" progid:"+A+"(opacity="+b+")"}function od(p){for(var b=document.documentElement.style,S=0;S<p.length;S++)if(p[S]in b)return p[S];return!1}function wa(p,b,S){var A=b||new Y(0,0);p.style[ul]=(De.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(S?" scale("+S+")":"")}function $r(p,b){p._leaflet_pos=b,De.any3d?wa(p,b):(p.style.left=b.x+"px",p.style.top=b.y+"px")}function Us(p){return p._leaflet_pos||new Y(0,0)}var hs,Ln,$f;if("onselectstart"in document)hs=function(){_t(window,"selectstart",ki)},Ln=function(){gr(window,"selectstart",ki)};else{var Mc=od(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);hs=function(){if(Mc){var p=document.documentElement.style;$f=p[Mc],p[Mc]="none"}},Ln=function(){Mc&&(document.documentElement.style[Mc]=$f,$f=void 0)}}function zf(){_t(window,"dragstart",ki)}function Hf(){gr(window,"dragstart",ki)}var ld,Gf;function Vf(p){for(;p.tabIndex===-1;)p=p.parentNode;p.style&&(cd(),ld=p,Gf=p.style.outlineStyle,p.style.outlineStyle="none",_t(window,"keydown",cd))}function cd(){ld&&(ld.style.outlineStyle=Gf,ld=void 0,Gf=void 0,gr(window,"keydown",cd))}function ud(p){do p=p.parentNode;while((!p.offsetWidth||!p.offsetHeight)&&p!==document.body);return p}function Wf(p){var b=p.getBoundingClientRect();return{x:b.width/p.offsetWidth||1,y:b.height/p.offsetHeight||1,boundingClientRect:b}}var Cv={__proto__:null,TRANSFORM:ul,TRANSITION:qn,TRANSITION_END:dl,get:wo,getStyle:Ws,create:Bt,remove:xr,empty:$i,toFront:ba,toBack:za,hasClass:ds,addClass:ot,removeClass:Br,setClass:Lc,getClass:Ha,setOpacity:Pn,testProp:od,setTransform:wa,setPosition:$r,getPosition:Us,get disableTextSelection(){return hs},get enableTextSelection(){return Ln},disableImageDrag:zf,enableImageDrag:Hf,preventOutline:Vf,restoreOutline:cd,getSizedParentNode:ud,getScale:Wf};function _t(p,b,S,A){if(b&&typeof b=="object")for(var H in b)jf(p,H,b[H],S);else{b=f(b);for(var J=0,de=b.length;J<de;J++)jf(p,b[J],S,A)}return this}var Ga="_leaflet_events";function gr(p,b,S,A){if(arguments.length===1)_v(p),delete p[Ga];else if(b&&typeof b=="object")for(var H in b)Yf(p,H,b[H],S);else if(b=f(b),arguments.length===2)_v(p,function(be){return C(b,be)!==-1});else for(var J=0,de=b.length;J<de;J++)Yf(p,b[J],S,A);return this}function _v(p,b){for(var S in p[Ga]){var A=S.split(/\d/)[0];(!b||b(A))&&Yf(p,A,null,null,S)}}var Uf={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function jf(p,b,S,A){var H=b+o(S)+(A?"_"+o(A):"");if(p[Ga]&&p[Ga][H])return this;var J=function(be){return S.call(A||p,be||window.event)},de=J;!De.touchNative&&De.pointer&&b.indexOf("touch")===0?J=Lr(p,b,J):De.touch&&b==="dblclick"?J=cl(p,J):"addEventListener"in p?b==="touchstart"||b==="touchmove"||b==="wheel"||b==="mousewheel"?p.addEventListener(Uf[b]||b,J,De.passiveEvents?{passive:!1}:!1):b==="mouseenter"||b==="mouseleave"?(J=function(be){be=be||window.event,Ac(p,be)&&de(be)},p.addEventListener(Uf[b],J,!1)):p.addEventListener(b,de,!1):p.attachEvent("on"+b,J),p[Ga]=p[Ga]||{},p[Ga][H]=J}function Yf(p,b,S,A,H){H=H||b+o(S)+(A?"_"+o(A):"");var J=p[Ga]&&p[Ga][H];if(!J)return this;!De.touchNative&&De.pointer&&b.indexOf("touch")===0?dr(p,b,J):De.touch&&b==="dblclick"?Bf(p,J):"removeEventListener"in p?p.removeEventListener(Uf[b]||b,J,!1):p.detachEvent("on"+b,J),p[Ga][H]=null}function Eo(p){return p.stopPropagation?p.stopPropagation():p.originalEvent?p.originalEvent._stopped=!0:p.cancelBubble=!0,this}function qf(p){return jf(p,"wheel",Eo),this}function Ic(p){return _t(p,"mousedown touchstart dblclick contextmenu",Eo),p._leaflet_disable_click=!0,this}function ki(p){return p.preventDefault?p.preventDefault():p.returnValue=!1,this}function To(p){return ki(p),Eo(p),this}function Sv(p){if(p.composedPath)return p.composedPath();for(var b=[],S=p.target;S;)b.push(S),S=S.parentNode;return b}function xv(p,b){if(!b)return new Y(p.clientX,p.clientY);var S=Wf(b),A=S.boundingClientRect;return new Y((p.clientX-A.left)/S.x-b.clientLeft,(p.clientY-A.top)/S.y-b.clientTop)}var VE=De.linux&&De.chrome?window.devicePixelRatio:De.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function dd(p){return De.edge?p.wheelDeltaY/2:p.deltaY&&p.deltaMode===0?-p.deltaY/VE:p.deltaY&&p.deltaMode===1?-p.deltaY*20:p.deltaY&&p.deltaMode===2?-p.deltaY*60:p.deltaX||p.deltaZ?0:p.wheelDelta?(p.wheelDeltaY||p.wheelDelta)/2:p.detail&&Math.abs(p.detail)<32765?-p.detail*20:p.detail?p.detail/-32765*60:0}function Ac(p,b){var S=b.relatedTarget;if(!S)return!0;try{for(;S&&S!==p;)S=S.parentNode}catch(A){return!1}return S!==p}var WE={__proto__:null,on:_t,off:gr,stopPropagation:Eo,disableScrollPropagation:qf,disableClickPropagation:Ic,preventDefault:ki,stop:To,getPropagationPath:Sv,getMousePosition:xv,getWheelDelta:dd,isExternalTarget:Ac,addListener:_t,removeListener:gr},Zf=W.extend({run:function(p,b,S,A){this.stop(),this._el=p,this._inProgress=!0,this._duration=S||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=Us(p),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=R(this._animate,this),this._step()},_step:function(p){var b=+new Date-this._startTime,S=this._duration*1e3;b<S?this._runFrame(this._easeOut(b/S),p):(this._runFrame(1),this._complete())},_runFrame:function(p,b){var S=this._startPos.add(this._offset.multiplyBy(p));b&&S._round(),$r(this._el,S),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(p){return 1-Math.pow(1-p,this._easeOutPower)}}),$t=W.extend({options:{crs:pe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(p,b){b=m(this,b),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(p),this._initLayout(),this._onResize=n(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),b.zoom!==void 0&&(this._zoom=this._limitZoom(b.zoom)),b.center&&b.zoom!==void 0&&this.setView(se(b.center),b.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=qn&&De.any3d&&!De.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),_t(this._proxy,dl,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(p,b,S){if(b=b===void 0?this._zoom:this._limitZoom(b),p=this._limitCenter(se(p),b,this.options.maxBounds),S=S||{},this._stop(),this._loaded&&!S.reset&&S!==!0){S.animate!==void 0&&(S.zoom=e({animate:S.animate},S.zoom),S.pan=e({animate:S.animate,duration:S.duration},S.pan));var A=this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(p,b,S.zoom):this._tryAnimatedPan(p,S.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(p,b,S.pan&&S.pan.noMoveStart),this},setZoom:function(p,b){return this._loaded?this.setView(this.getCenter(),p,{zoom:b}):(this._zoom=p,this)},zoomIn:function(p,b){return p=p||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+p,b)},zoomOut:function(p,b){return p=p||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-p,b)},setZoomAround:function(p,b,S){var A=this.getZoomScale(b),H=this.getSize().divideBy(2),J=p instanceof Y?p:this.latLngToContainerPoint(p),de=J.subtract(H).multiplyBy(1-1/A),be=this.containerPointToLatLng(H.add(de));return this.setView(be,b,{zoom:S})},_getBoundsCenterZoom:function(p,b){b=b||{},p=p.getBounds?p.getBounds():j(p);var S=Z(b.paddingTopLeft||b.padding||[0,0]),A=Z(b.paddingBottomRight||b.padding||[0,0]),H=this.getBoundsZoom(p,!1,S.add(A));if(H=typeof b.maxZoom=="number"?Math.min(b.maxZoom,H):H,H===1/0)return{center:p.getCenter(),zoom:H};var J=A.subtract(S).divideBy(2),de=this.project(p.getSouthWest(),H),be=this.project(p.getNorthEast(),H),ke=this.unproject(de.add(be).divideBy(2).add(J),H);return{center:ke,zoom:H}},fitBounds:function(p,b){if(p=j(p),!p.isValid())throw new Error("Bounds are not valid.");var S=this._getBoundsCenterZoom(p,b);return this.setView(S.center,S.zoom,b)},fitWorld:function(p){return this.fitBounds([[-90,-180],[90,180]],p)},panTo:function(p,b){return this.setView(p,this._zoom,{pan:b})},panBy:function(p,b){if(p=Z(p).round(),b=b||{},!p.x&&!p.y)return this.fire("moveend");if(b.animate!==!0&&!this.getSize().contains(p))return this._resetView(this.unproject(this.project(this.getCenter()).add(p)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Zf,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),b.animate!==!1){ot(this._mapPane,"leaflet-pan-anim");var S=this._getMapPanePos().subtract(p).round();this._panAnim.run(this._mapPane,S,b.duration||.25,b.easeLinearity)}else this._rawPanBy(p),this.fire("move").fire("moveend");return this},flyTo:function(p,b,S){if(S=S||{},S.animate===!1||!De.any3d)return this.setView(p,b,S);this._stop();var A=this.project(this.getCenter()),H=this.project(p),J=this.getSize(),de=this._zoom;p=se(p),b=b===void 0?de:b;var be=Math.max(J.x,J.y),ke=be*this.getZoomScale(de,b),Be=H.distanceTo(A)||1,Ke=1.42,dt=Ke*Ke;function Ot(ni){var _d=ni?-1:1,vT=ni?ke:be,yT=ke*ke-be*be+_d*dt*dt*Be*Be,bT=2*vT*dt*Be,lp=yT/bT,ay=Math.sqrt(lp*lp+1)-lp,wT=ay<1e-9?-18:Math.log(ay);return wT}function Ji(ni){return(Math.exp(ni)-Math.exp(-ni))/2}function pi(ni){return(Math.exp(ni)+Math.exp(-ni))/2}function Xn(ni){return Ji(ni)/pi(ni)}var dn=Ot(0);function yl(ni){return be*(pi(dn)/pi(dn+Ke*ni))}function fT(ni){return be*(pi(dn)*Xn(dn+Ke*ni)-Ji(dn))/dt}function pT(ni){return 1-Math.pow(1-ni,1.5)}var mT=Date.now(),iy=(Ot(1)-dn)/Ke,gT=S.duration?1e3*S.duration:1e3*iy*.8;function ny(){var ni=(Date.now()-mT)/gT,_d=pT(ni)*iy;ni<=1?(this._flyToFrame=R(ny,this),this._move(this.unproject(A.add(H.subtract(A).multiplyBy(fT(_d)/Be)),de),this.getScaleZoom(be/yl(_d),de),{flyTo:!0})):this._move(p,b)._moveEnd(!0)}return this._moveStart(!0,S.noMoveStart),ny.call(this),this},flyToBounds:function(p,b){var S=this._getBoundsCenterZoom(p,b);return this.flyTo(S.center,S.zoom,b)},setMaxBounds:function(p){return p=j(p),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),p.isValid()?(this.options.maxBounds=p,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(p){var b=this.options.minZoom;return this.options.minZoom=p,this._loaded&&b!==p&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(p):this},setMaxZoom:function(p){var b=this.options.maxZoom;return this.options.maxZoom=p,this._loaded&&b!==p&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(p):this},panInsideBounds:function(p,b){this._enforcingBounds=!0;var S=this.getCenter(),A=this._limitCenter(S,this._zoom,j(p));return S.equals(A)||this.panTo(A,b),this._enforcingBounds=!1,this},panInside:function(p,b){b=b||{};var S=Z(b.paddingTopLeft||b.padding||[0,0]),A=Z(b.paddingBottomRight||b.padding||[0,0]),H=this.project(this.getCenter()),J=this.project(p),de=this.getPixelBounds(),be=X([de.min.add(S),de.max.subtract(A)]),ke=be.getSize();if(!be.contains(J)){this._enforcingBounds=!0;var Be=J.subtract(be.getCenter()),Ke=be.extend(J).getSize().subtract(ke);H.x+=Be.x<0?-Ke.x:Ke.x,H.y+=Be.y<0?-Ke.y:Ke.y,this.panTo(this.unproject(H),b),this._enforcingBounds=!1}return this},invalidateSize:function(p){if(!this._loaded)return this;p=e({animate:!1,pan:!0},p===!0?{animate:!0}:p);var b=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var S=this.getSize(),A=b.divideBy(2).round(),H=S.divideBy(2).round(),J=A.subtract(H);return!J.x&&!J.y?this:(p.animate&&p.pan?this.panBy(J):(p.pan&&this._rawPanBy(J),this.fire("move"),p.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(n(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:S}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(p){if(p=this._locateOptions=e({timeout:1e4,watch:!1},p),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=n(this._handleGeolocationResponse,this),S=n(this._handleGeolocationError,this);return p.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,S,p):navigator.geolocation.getCurrentPosition(b,S,p),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(p){if(this._container._leaflet_id){var b=p.code,S=p.message||(b===1?"permission denied":b===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+S+"."})}},_handleGeolocationResponse:function(p){if(this._container._leaflet_id){var b=p.coords.latitude,S=p.coords.longitude,A=new K(b,S),H=A.toBounds(p.coords.accuracy*2),J=this._locateOptions;if(J.setView){var de=this.getBoundsZoom(H);this.setView(A,J.maxZoom?Math.min(de,J.maxZoom):de)}var be={latlng:A,bounds:H,timestamp:p.timestamp};for(var ke in p.coords)typeof p.coords[ke]=="number"&&(be[ke]=p.coords[ke]);this.fire("locationfound",be)}},addHandler:function(p,b){if(!b)return this;var S=this[p]=new b(this);return this._handlers.push(S),this.options[p]&&S.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(b){this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),xr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var p;for(p in this._layers)this._layers[p].remove();for(p in this._panes)xr(this._panes[p]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(p,b){var S="leaflet-pane"+(p?" leaflet-"+p.replace("Pane","")+"-pane":""),A=Bt("div",S,b||this._mapPane);return p&&(this._panes[p]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var p=this.getPixelBounds(),b=this.unproject(p.getBottomLeft()),S=this.unproject(p.getTopRight());return new ie(b,S)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(p,b,S){p=j(p),S=Z(S||[0,0]);var A=this.getZoom()||0,H=this.getMinZoom(),J=this.getMaxZoom(),de=p.getNorthWest(),be=p.getSouthEast(),ke=this.getSize().subtract(S),Be=X(this.project(be,A),this.project(de,A)).getSize(),Ke=De.any3d?this.options.zoomSnap:1,dt=ke.x/Be.x,Ot=ke.y/Be.y,Ji=b?Math.max(dt,Ot):Math.min(dt,Ot);return A=this.getScaleZoom(Ji,A),Ke&&(A=Math.round(A/(Ke/100))*(Ke/100),A=b?Math.ceil(A/Ke)*Ke:Math.floor(A/Ke)*Ke),Math.max(H,Math.min(J,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Y(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(p,b){var S=this._getTopLeftPoint(p,b);return new q(S,S.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(p){return this.options.crs.getProjectedBounds(p===void 0?this.getZoom():p)},getPane:function(p){return typeof p=="string"?this._panes[p]:p},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(p,b){var S=this.options.crs;return b=b===void 0?this._zoom:b,S.scale(p)/S.scale(b)},getScaleZoom:function(p,b){var S=this.options.crs;b=b===void 0?this._zoom:b;var A=S.zoom(p*S.scale(b));return isNaN(A)?1/0:A},project:function(p,b){return b=b===void 0?this._zoom:b,this.options.crs.latLngToPoint(se(p),b)},unproject:function(p,b){return b=b===void 0?this._zoom:b,this.options.crs.pointToLatLng(Z(p),b)},layerPointToLatLng:function(p){var b=Z(p).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(p){var b=this.project(se(p))._round();return b._subtract(this.getPixelOrigin())},wrapLatLng:function(p){return this.options.crs.wrapLatLng(se(p))},wrapLatLngBounds:function(p){return this.options.crs.wrapLatLngBounds(j(p))},distance:function(p,b){return this.options.crs.distance(se(p),se(b))},containerPointToLayerPoint:function(p){return Z(p).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(p){return Z(p).add(this._getMapPanePos())},containerPointToLatLng:function(p){var b=this.containerPointToLayerPoint(Z(p));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(p){return this.layerPointToContainerPoint(this.latLngToLayerPoint(se(p)))},mouseEventToContainerPoint:function(p){return xv(p,this._container)},mouseEventToLayerPoint:function(p){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(p))},mouseEventToLatLng:function(p){return this.layerPointToLatLng(this.mouseEventToLayerPoint(p))},_initContainer:function(p){var b=this._container=wo(p);if(b){if(b._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");_t(b,"scroll",this._onScroll,this),this._containerId=o(b)},_initLayout:function(){var p=this._container;this._fadeAnimated=this.options.fadeAnimation&&De.any3d,ot(p,"leaflet-container"+(De.touch?" leaflet-touch":"")+(De.retina?" leaflet-retina":"")+(De.ielt9?" leaflet-oldie":"")+(De.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=Ws(p,"position");b!=="absolute"&&b!=="relative"&&b!=="fixed"&&b!=="sticky"&&(p.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var p=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),$r(this._mapPane,new Y(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ot(p.markerPane,"leaflet-zoom-hide"),ot(p.shadowPane,"leaflet-zoom-hide"))},_resetView:function(p,b,S){$r(this._mapPane,new Y(0,0));var A=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var H=this._zoom!==b;this._moveStart(H,S)._move(p,b)._moveEnd(H),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(p,b){return p&&this.fire("zoomstart"),b||this.fire("movestart"),this},_move:function(p,b,S,A){b===void 0&&(b=this._zoom);var H=this._zoom!==b;return this._zoom=b,this._lastCenter=p,this._pixelOrigin=this._getNewPixelOrigin(p),A?S&&S.pinch&&this.fire("zoom",S):((H||S&&S.pinch)&&this.fire("zoom",S),this.fire("move",S)),this},_moveEnd:function(p){return p&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(p){$r(this._mapPane,this._getMapPanePos().subtract(p))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(p){this._targets={},this._targets[o(this._container)]=this;var b=p?gr:_t;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&b(window,"resize",this._onResize,this),De.any3d&&this.options.transform3DLimit&&(p?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=R(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var p=this._getMapPanePos();Math.max(Math.abs(p.x),Math.abs(p.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(p,b){for(var S=[],A,H=b==="mouseout"||b==="mouseover",J=p.target||p.srcElement,de=!1;J;){if(A=this._targets[o(J)],A&&(b==="click"||b==="preclick")&&this._draggableMoved(A)){de=!0;break}if(A&&A.listens(b,!0)&&(H&&!Ac(J,p)||(S.push(A),H))||J===this._container)break;J=J.parentNode}return!S.length&&!de&&!H&&this.listens(b,!0)&&(S=[this]),S},_isClickDisabled:function(p){for(;p&&p!==this._container;){if(p._leaflet_disable_click)return!0;p=p.parentNode}},_handleDOMEvent:function(p){var b=p.target||p.srcElement;if(!(!this._loaded||b._leaflet_disable_events||p.type==="click"&&this._isClickDisabled(b))){var S=p.type;S==="mousedown"&&Vf(b),this._fireDOMEvent(p,S)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(p,b,S){if(p.type==="click"){var A=e({},p);A.type="preclick",this._fireDOMEvent(A,A.type,S)}var H=this._findEventTargets(p,b);if(S){for(var J=[],de=0;de<S.length;de++)S[de].listens(b,!0)&&J.push(S[de]);H=J.concat(H)}if(H.length){b==="contextmenu"&&ki(p);var be=H[0],ke={originalEvent:p};if(p.type!=="keypress"&&p.type!=="keydown"&&p.type!=="keyup"){var Be=be.getLatLng&&(!be._radius||be._radius<=10);ke.containerPoint=Be?this.latLngToContainerPoint(be.getLatLng()):this.mouseEventToContainerPoint(p),ke.layerPoint=this.containerPointToLayerPoint(ke.containerPoint),ke.latlng=Be?be.getLatLng():this.layerPointToLatLng(ke.layerPoint)}for(de=0;de<H.length;de++)if(H[de].fire(b,ke,!0),ke.originalEvent._stopped||H[de].options.bubblingMouseEvents===!1&&C(this._mouseEvents,b)!==-1)return}},_draggableMoved:function(p){return p=p.dragging&&p.dragging.enabled()?p:this,p.dragging&&p.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var p=0,b=this._handlers.length;p<b;p++)this._handlers[p].disable()},whenReady:function(p,b){return this._loaded?p.call(b||this,{target:this}):this.on("load",p,b),this},_getMapPanePos:function(){return Us(this._mapPane)||new Y(0,0)},_moved:function(){var p=this._getMapPanePos();return p&&!p.equals([0,0])},_getTopLeftPoint:function(p,b){var S=p&&b!==void 0?this._getNewPixelOrigin(p,b):this.getPixelOrigin();return S.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(p,b){var S=this.getSize()._divideBy(2);return this.project(p,b)._subtract(S)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(p,b,S){var A=this._getNewPixelOrigin(S,b);return this.project(p,b)._subtract(A)},_latLngBoundsToNewLayerBounds:function(p,b,S){var A=this._getNewPixelOrigin(S,b);return X([this.project(p.getSouthWest(),b)._subtract(A),this.project(p.getNorthWest(),b)._subtract(A),this.project(p.getSouthEast(),b)._subtract(A),this.project(p.getNorthEast(),b)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(p){return this.latLngToLayerPoint(p).subtract(this._getCenterLayerPoint())},_limitCenter:function(p,b,S){if(!S)return p;var A=this.project(p,b),H=this.getSize().divideBy(2),J=new q(A.subtract(H),A.add(H)),de=this._getBoundsOffset(J,S,b);return Math.abs(de.x)<=1&&Math.abs(de.y)<=1?p:this.unproject(A.add(de),b)},_limitOffset:function(p,b){if(!b)return p;var S=this.getPixelBounds(),A=new q(S.min.add(p),S.max.add(p));return p.add(this._getBoundsOffset(A,b))},_getBoundsOffset:function(p,b,S){var A=X(this.project(b.getNorthEast(),S),this.project(b.getSouthWest(),S)),H=A.min.subtract(p.min),J=A.max.subtract(p.max),de=this._rebound(H.x,-J.x),be=this._rebound(H.y,-J.y);return new Y(de,be)},_rebound:function(p,b){return p+b>0?Math.round(p-b)/2:Math.max(0,Math.ceil(p))-Math.max(0,Math.floor(b))},_limitZoom:function(p){var b=this.getMinZoom(),S=this.getMaxZoom(),A=De.any3d?this.options.zoomSnap:1;return A&&(p=Math.round(p/A)*A),Math.max(b,Math.min(S,p))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Br(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(p,b){var S=this._getCenterOffset(p)._trunc();return(b&&b.animate)!==!0&&!this.getSize().contains(S)?!1:(this.panBy(S,b),!0)},_createAnimProxy:function(){var p=this._proxy=Bt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(p),this.on("zoomanim",function(b){var S=ul,A=this._proxy.style[S];wa(this._proxy,this.project(b.center,b.zoom),this.getZoomScale(b.zoom,1)),A===this._proxy.style[S]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){xr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var p=this.getCenter(),b=this.getZoom();wa(this._proxy,this.project(p,b),this.getZoomScale(b,1))},_catchTransitionEnd:function(p){this._animatingZoom&&p.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(p,b,S){if(this._animatingZoom)return!0;if(S=S||{},!this._zoomAnimated||S.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(b),H=this._getCenterOffset(p)._divideBy(1-1/A);return S.animate!==!0&&!this.getSize().contains(H)?!1:(R(function(){this._moveStart(!0,S.noMoveStart||!1)._animateZoom(p,b,!0)},this),!0)},_animateZoom:function(p,b,S,A){this._mapPane&&(S&&(this._animatingZoom=!0,this._animateToCenter=p,this._animateToZoom=b,ot(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:p,zoom:b,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(n(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Br(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function UE(p,b){return new $t(p,b)}var Ea=k.extend({options:{position:"topright"},initialize:function(p){m(this,p)},getPosition:function(){return this.options.position},setPosition:function(p){var b=this._map;return b&&b.removeControl(this),this.options.position=p,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(p){this.remove(),this._map=p;var b=this._container=this.onAdd(p),S=this.getPosition(),A=p._controlCorners[S];return ot(b,"leaflet-control"),S.indexOf("bottom")!==-1?A.insertBefore(b,A.firstChild):A.appendChild(b),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(xr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(p){this._map&&p&&p.screenX>0&&p.screenY>0&&this._map.getContainer().focus()}}),Oc=function(p){return new Ea(p)};$t.include({addControl:function(p){return p.addTo(this),this},removeControl:function(p){return p.remove(),this},_initControlPos:function(){var p=this._controlCorners={},b="leaflet-",S=this._controlContainer=Bt("div",b+"control-container",this._container);function A(H,J){var de=b+H+" "+b+J;p[H+J]=Bt("div",de,S)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var p in this._controlCorners)xr(this._controlCorners[p]);xr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var kv=Ea.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(p,b,S,A){return S<A?-1:A<S?1:0}},initialize:function(p,b,S){m(this,S),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in p)this._addLayer(p[A],A);for(A in b)this._addLayer(b[A],A,!0)},onAdd:function(p){this._initLayout(),this._update(),this._map=p,p.on("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(p){return Ea.prototype.addTo.call(this,p),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(p,b){return this._addLayer(p,b),this._map?this._update():this},addOverlay:function(p,b){return this._addLayer(p,b,!0),this._map?this._update():this},removeLayer:function(p){p.off("add remove",this._onLayerChange,this);var b=this._getLayer(o(p));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){ot(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var p=this._map.getSize().y-(this._container.offsetTop+50);return p<this._section.clientHeight?(ot(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=p+"px"):Br(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Br(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var p="leaflet-control-layers",b=this._container=Bt("div",p),S=this.options.collapsed;b.setAttribute("aria-haspopup",!0),Ic(b),qf(b);var A=this._section=Bt("section",p+"-list");S&&(this._map.on("click",this.collapse,this),_t(b,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var H=this._layersLink=Bt("a",p+"-toggle",b);H.href="#",H.title="Layers",H.setAttribute("role","button"),_t(H,{keydown:function(J){J.keyCode===13&&this._expandSafely()},click:function(J){ki(J),this._expandSafely()}},this),S||this.expand(),this._baseLayersList=Bt("div",p+"-base",A),this._separator=Bt("div",p+"-separator",A),this._overlaysList=Bt("div",p+"-overlays",A),b.appendChild(A)},_getLayer:function(p){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&o(this._layers[b].layer)===p)return this._layers[b]},_addLayer:function(p,b,S){this._map&&p.on("add remove",this._onLayerChange,this),this._layers.push({layer:p,name:b,overlay:S}),this.options.sortLayers&&this._layers.sort(n(function(A,H){return this.options.sortFunction(A.layer,H.layer,A.name,H.name)},this)),this.options.autoZIndex&&p.setZIndex&&(this._lastZIndex++,p.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;$i(this._baseLayersList),$i(this._overlaysList),this._layerControlInputs=[];var p,b,S,A,H=0;for(S=0;S<this._layers.length;S++)A=this._layers[S],this._addItem(A),b=b||A.overlay,p=p||!A.overlay,H+=A.overlay?0:1;return this.options.hideSingleBase&&(p=p&&H>1,this._baseLayersList.style.display=p?"":"none"),this._separator.style.display=b&&p?"":"none",this},_onLayerChange:function(p){this._handlingClick||this._update();var b=this._getLayer(o(p.target)),S=b.overlay?p.type==="add"?"overlayadd":"overlayremove":p.type==="add"?"baselayerchange":null;S&&this._map.fire(S,b)},_createRadioElement:function(p,b){var S='<input type="radio" class="leaflet-control-layers-selector" name="'+p+'"'+(b?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=S,A.firstChild},_addItem:function(p){var b=document.createElement("label"),S=this._map.hasLayer(p.layer),A;p.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=S):A=this._createRadioElement("leaflet-base-layers_"+o(this),S),this._layerControlInputs.push(A),A.layerId=o(p.layer),_t(A,"click",this._onInputClick,this);var H=document.createElement("span");H.innerHTML=" "+p.name;var J=document.createElement("span");b.appendChild(J),J.appendChild(A),J.appendChild(H);var de=p.overlay?this._overlaysList:this._baseLayersList;return de.appendChild(b),this._checkDisabledLayers(),b},_onInputClick:function(){if(!this._preventClick){var p=this._layerControlInputs,b,S,A=[],H=[];this._handlingClick=!0;for(var J=p.length-1;J>=0;J--)b=p[J],S=this._getLayer(b.layerId).layer,b.checked?A.push(S):b.checked||H.push(S);for(J=0;J<H.length;J++)this._map.hasLayer(H[J])&&this._map.removeLayer(H[J]);for(J=0;J<A.length;J++)this._map.hasLayer(A[J])||this._map.addLayer(A[J]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var p=this._layerControlInputs,b,S,A=this._map.getZoom(),H=p.length-1;H>=0;H--)b=p[H],S=this._getLayer(b.layerId).layer,b.disabled=S.options.minZoom!==void 0&&A<S.options.minZoom||S.options.maxZoom!==void 0&&A>S.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var p=this._section;this._preventClick=!0,_t(p,"click",ki),this.expand();var b=this;setTimeout(function(){gr(p,"click",ki),b._preventClick=!1})}}),Dv=function(p,b,S){return new kv(p,b,S)},vr=Ea.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(p){var b="leaflet-control-zoom",S=Bt("div",b+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,b+"-in",S,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,b+"-out",S,this._zoomOut),this._updateDisabled(),p.on("zoomend zoomlevelschange",this._updateDisabled,this),S},onRemove:function(p){p.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(p){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(p.shiftKey?3:1))},_zoomOut:function(p){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(p.shiftKey?3:1))},_createButton:function(p,b,S,A,H){var J=Bt("a",S,A);return J.innerHTML=p,J.href="#",J.title=b,J.setAttribute("role","button"),J.setAttribute("aria-label",b),Ic(J),_t(J,"click",To),_t(J,"click",H,this),_t(J,"click",this._refocusOnMap,this),J},_updateDisabled:function(){var p=this._map,b="leaflet-disabled";Br(this._zoomInButton,b),Br(this._zoomOutButton,b),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||p._zoom===p.getMinZoom())&&(ot(this._zoomOutButton,b),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||p._zoom===p.getMaxZoom())&&(ot(this._zoomInButton,b),this._zoomInButton.setAttribute("aria-disabled","true"))}});$t.mergeOptions({zoomControl:!0}),$t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new vr,this.addControl(this.zoomControl))});var Fc=function(p){return new vr(p)},hl=Ea.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(p){var b="leaflet-control-scale",S=Bt("div",b),A=this.options;return this._addScales(A,b+"-line",S),p.on(A.updateWhenIdle?"moveend":"move",this._update,this),p.whenReady(this._update,this),S},onRemove:function(p){p.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(p,b,S){p.metric&&(this._mScale=Bt("div",b,S)),p.imperial&&(this._iScale=Bt("div",b,S))},_update:function(){var p=this._map,b=p.getSize().y/2,S=p.distance(p.containerPointToLatLng([0,b]),p.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(S)},_updateScales:function(p){this.options.metric&&p&&this._updateMetric(p),this.options.imperial&&p&&this._updateImperial(p)},_updateMetric:function(p){var b=this._getRoundNum(p),S=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,S,b/p)},_updateImperial:function(p){var b=p*3.2808399,S,A,H;b>5280?(S=b/5280,A=this._getRoundNum(S),this._updateScale(this._iScale,A+" mi",A/S)):(H=this._getRoundNum(b),this._updateScale(this._iScale,H+" ft",H/b))},_updateScale:function(p,b,S){p.style.width=Math.round(this.options.maxWidth*S)+"px",p.innerHTML=b},_getRoundNum:function(p){var b=Math.pow(10,(Math.floor(p)+"").length-1),S=p/b;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:1,b*S}}),jE=function(p){return new hl(p)},Pv='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Kf=Ea.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(De.inlineSvg?Pv+" ":"")+"Leaflet</a>"},initialize:function(p){m(this,p),this._attributions={}},onAdd:function(p){p.attributionControl=this,this._container=Bt("div","leaflet-control-attribution"),Ic(this._container);for(var b in p._layers)p._layers[b].getAttribution&&this.addAttribution(p._layers[b].getAttribution());return this._update(),p.on("layeradd",this._addAttribution,this),this._container},onRemove:function(p){p.off("layeradd",this._addAttribution,this)},_addAttribution:function(p){p.layer.getAttribution&&(this.addAttribution(p.layer.getAttribution()),p.layer.once("remove",function(){this.removeAttribution(p.layer.getAttribution())},this))},setPrefix:function(p){return this.options.prefix=p,this._update(),this},addAttribution:function(p){return p?(this._attributions[p]||(this._attributions[p]=0),this._attributions[p]++,this._update(),this):this},removeAttribution:function(p){return p?(this._attributions[p]&&(this._attributions[p]--,this._update()),this):this},_update:function(){if(this._map){var p=[];for(var b in this._attributions)this._attributions[b]&&p.push(b);var S=[];this.options.prefix&&S.push(this.options.prefix),p.length&&S.push(p.join(", ")),this._container.innerHTML=S.join(' <span aria-hidden="true">|</span> ')}}});$t.mergeOptions({attributionControl:!0}),$t.addInitHook(function(){this.options.attributionControl&&new Kf().addTo(this)});var YE=function(p){return new Kf(p)};Ea.Layers=kv,Ea.Zoom=vr,Ea.Scale=hl,Ea.Attribution=Kf,Oc.layers=Dv,Oc.zoom=Fc,Oc.scale=jE,Oc.attribution=YE;var Mn=k.extend({initialize:function(p){this._map=p},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Mn.addTo=function(p,b){return p.addHandler(b,this),this};var js={Events:G},hd=De.touch?"touchstart mousedown":"mousedown",Ys=W.extend({options:{clickTolerance:3},initialize:function(p,b,S,A){m(this,A),this._element=p,this._dragStartTarget=b||p,this._preventOutline=S},enable:function(){this._enabled||(_t(this._dragStartTarget,hd,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ys._dragging===this&&this.finishDrag(!0),gr(this._dragStartTarget,hd,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(p){if(this._enabled&&(this._moved=!1,!ds(this._element,"leaflet-zoom-anim"))){if(p.touches&&p.touches.length!==1){Ys._dragging===this&&this.finishDrag();return}if(!(Ys._dragging||p.shiftKey||p.which!==1&&p.button!==1&&!p.touches)&&(Ys._dragging=this,this._preventOutline&&Vf(this._element),zf(),hs(),!this._moving)){this.fire("down");var b=p.touches?p.touches[0]:p,S=ud(this._element);this._startPoint=new Y(b.clientX,b.clientY),this._startPos=Us(this._element),this._parentScale=Wf(S);var A=p.type==="mousedown";_t(document,A?"mousemove":"touchmove",this._onMove,this),_t(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(p){if(this._enabled){if(p.touches&&p.touches.length>1){this._moved=!0;return}var b=p.touches&&p.touches.length===1?p.touches[0]:p,S=new Y(b.clientX,b.clientY)._subtract(this._startPoint);!S.x&&!S.y||Math.abs(S.x)+Math.abs(S.y)<this.options.clickTolerance||(S.x/=this._parentScale.x,S.y/=this._parentScale.y,ki(p),this._moved||(this.fire("dragstart"),this._moved=!0,ot(document.body,"leaflet-dragging"),this._lastTarget=p.target||p.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ot(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(S),this._moving=!0,this._lastEvent=p,this._updatePosition())}},_updatePosition:function(){var p={originalEvent:this._lastEvent};this.fire("predrag",p),$r(this._element,this._newPos),this.fire("drag",p)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(p){Br(document.body,"leaflet-dragging"),this._lastTarget&&(Br(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),gr(document,"mousemove touchmove",this._onMove,this),gr(document,"mouseup touchend touchcancel",this._onUp,this),Hf(),Ln();var b=this._moved&&this._moving;this._moving=!1,Ys._dragging=!1,b&&this.fire("dragend",{noInertia:p,distance:this._newPos.distanceTo(this._startPos)})}});function Va(p,b,S){var A,H=[1,4,2,8],J,de,be,ke,Be,Ke,dt,Ot;for(J=0,Ke=p.length;J<Ke;J++)p[J]._code=Co(p[J],b);for(be=0;be<4;be++){for(dt=H[be],A=[],J=0,Ke=p.length,de=Ke-1;J<Ke;de=J++)ke=p[J],Be=p[de],ke._code&dt?Be._code&dt||(Ot=pd(Be,ke,dt,b,S),Ot._code=Co(Ot,b),A.push(Ot)):(Be._code&dt&&(Ot=pd(Be,ke,dt,b,S),Ot._code=Co(Ot,b),A.push(Ot)),A.push(ke));p=A}return p}function Lv(p,b){var S,A,H,J,de,be,ke,Be,Ke;if(!p||p.length===0)throw new Error("latlngs not passed");Zn(p)||(console.warn("latlngs are not flat! Only the first ring will be used"),p=p[0]);var dt=se([0,0]),Ot=j(p),Ji=Ot.getNorthWest().distanceTo(Ot.getSouthWest())*Ot.getNorthEast().distanceTo(Ot.getNorthWest());Ji<1700&&(dt=Rc(p));var pi=p.length,Xn=[];for(S=0;S<pi;S++){var dn=se(p[S]);Xn.push(b.project(se([dn.lat-dt.lat,dn.lng-dt.lng])))}for(be=ke=Be=0,S=0,A=pi-1;S<pi;A=S++)H=Xn[S],J=Xn[A],de=H.y*J.x-J.y*H.x,ke+=(H.x+J.x)*de,Be+=(H.y+J.y)*de,be+=de*3;be===0?Ke=Xn[0]:Ke=[ke/be,Be/be];var yl=b.unproject(Z(Ke));return se([yl.lat+dt.lat,yl.lng+dt.lng])}function Rc(p){for(var b=0,S=0,A=0,H=0;H<p.length;H++){var J=se(p[H]);b+=J.lat,S+=J.lng,A++}return se([b/A,S/A])}var qE={__proto__:null,clipPolygon:Va,polygonCenter:Lv,centroid:Rc};function Mv(p,b){if(!b||!p.length)return p.slice();var S=b*b;return p=ZE(p,S),p=Xf(p,S),p}function Iv(p,b,S){return Math.sqrt(Nc(p,b,S,!0))}function fd(p,b,S){return Nc(p,b,S)}function Xf(p,b){var S=p.length,A=typeof Uint8Array!="undefined"?Uint8Array:Array,H=new A(S);H[0]=H[S-1]=1,Jf(p,H,b,0,S-1);var J,de=[];for(J=0;J<S;J++)H[J]&&de.push(p[J]);return de}function Jf(p,b,S,A,H){var J=0,de,be,ke;for(be=A+1;be<=H-1;be++)ke=Nc(p[be],p[A],p[H],!0),ke>J&&(de=be,J=ke);J>S&&(b[de]=1,Jf(p,b,S,A,de),Jf(p,b,S,de,H))}function ZE(p,b){for(var S=[p[0]],A=1,H=0,J=p.length;A<J;A++)KE(p[A],p[H])>b&&(S.push(p[A]),H=A);return H<J-1&&S.push(p[J-1]),S}var Av;function Qf(p,b,S,A,H){var J=A?Av:Co(p,S),de=Co(b,S),be,ke,Be;for(Av=de;;){if(!(J|de))return[p,b];if(J&de)return!1;be=J||de,ke=pd(p,b,be,S,H),Be=Co(ke,S),be===J?(p=ke,J=Be):(b=ke,de=Be)}}function pd(p,b,S,A,H){var J=b.x-p.x,de=b.y-p.y,be=A.min,ke=A.max,Be,Ke;return S&8?(Be=p.x+J*(ke.y-p.y)/de,Ke=ke.y):S&4?(Be=p.x+J*(be.y-p.y)/de,Ke=be.y):S&2?(Be=ke.x,Ke=p.y+de*(ke.x-p.x)/J):S&1&&(Be=be.x,Ke=p.y+de*(be.x-p.x)/J),new Y(Be,Ke,H)}function Co(p,b){var S=0;return p.x<b.min.x?S|=1:p.x>b.max.x&&(S|=2),p.y<b.min.y?S|=4:p.y>b.max.y&&(S|=8),S}function KE(p,b){var S=b.x-p.x,A=b.y-p.y;return S*S+A*A}function Nc(p,b,S,A){var H=b.x,J=b.y,de=S.x-H,be=S.y-J,ke=de*de+be*be,Be;return ke>0&&(Be=((p.x-H)*de+(p.y-J)*be)/ke,Be>1?(H=S.x,J=S.y):Be>0&&(H+=de*Be,J+=be*Be)),de=p.x-H,be=p.y-J,A?de*de+be*be:new Y(H,J)}function Zn(p){return!E(p[0])||typeof p[0][0]!="object"&&typeof p[0][0]!="undefined"}function ep(p){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Zn(p)}function Ov(p,b){var S,A,H,J,de,be,ke,Be;if(!p||p.length===0)throw new Error("latlngs not passed");Zn(p)||(console.warn("latlngs are not flat! Only the first ring will be used"),p=p[0]);var Ke=se([0,0]),dt=j(p),Ot=dt.getNorthWest().distanceTo(dt.getSouthWest())*dt.getNorthEast().distanceTo(dt.getNorthWest());Ot<1700&&(Ke=Rc(p));var Ji=p.length,pi=[];for(S=0;S<Ji;S++){var Xn=se(p[S]);pi.push(b.project(se([Xn.lat-Ke.lat,Xn.lng-Ke.lng])))}for(S=0,A=0;S<Ji-1;S++)A+=pi[S].distanceTo(pi[S+1])/2;if(A===0)Be=pi[0];else for(S=0,J=0;S<Ji-1;S++)if(de=pi[S],be=pi[S+1],H=de.distanceTo(be),J+=H,J>A){ke=(J-A)/H,Be=[be.x-ke*(be.x-de.x),be.y-ke*(be.y-de.y)];break}var dn=b.unproject(Z(Be));return se([dn.lat+Ke.lat,dn.lng+Ke.lng])}var fl={__proto__:null,simplify:Mv,pointToSegmentDistance:Iv,closestPointOnSegment:fd,clipSegment:Qf,_getEdgeIntersection:pd,_getBitCode:Co,_sqClosestPointOnSegment:Nc,isFlat:Zn,_flat:ep,polylineCenter:Ov},tp={project:function(p){return new Y(p.lng,p.lat)},unproject:function(p){return new K(p.y,p.x)},bounds:new q([-180,-90],[180,90])},Bc={R:6378137,R_MINOR:6356752314245179e-9,bounds:new q([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(p){var b=Math.PI/180,S=this.R,A=p.lat*b,H=this.R_MINOR/S,J=Math.sqrt(1-H*H),de=J*Math.sin(A),be=Math.tan(Math.PI/4-A/2)/Math.pow((1-de)/(1+de),J/2);return A=-S*Math.log(Math.max(be,1e-10)),new Y(p.lng*b*S,A)},unproject:function(p){for(var b=180/Math.PI,S=this.R,A=this.R_MINOR/S,H=Math.sqrt(1-A*A),J=Math.exp(-p.y/S),de=Math.PI/2-2*Math.atan(J),be=0,ke=.1,Be;be<15&&Math.abs(ke)>1e-7;be++)Be=H*Math.sin(de),Be=Math.pow((1-Be)/(1+Be),H/2),ke=Math.PI/2-2*Math.atan(J*Be)-de,de+=ke;return new K(de*b,p.x*b/S)}},XE={__proto__:null,LonLat:tp,Mercator:Bc,SphericalMercator:Se},rp=e({},ge,{code:"EPSG:3395",projection:Bc,transformation:(function(){var p=.5/(Math.PI*Bc.R);return me(p,.5,-p,.5)})()}),Fv=e({},ge,{code:"EPSG:4326",projection:tp,transformation:me(1/180,1,-1/180,.5)}),JE=e({},ne,{projection:tp,transformation:me(1,0,-1,0),scale:function(p){return Math.pow(2,p)},zoom:function(p){return Math.log(p)/Math.LN2},distance:function(p,b){var S=b.lng-p.lng,A=b.lat-p.lat;return Math.sqrt(S*S+A*A)},infinite:!0});ne.Earth=ge,ne.EPSG3395=rp,ne.EPSG3857=pe,ne.EPSG900913=B,ne.EPSG4326=Fv,ne.Simple=JE;var Ta=W.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(p){return p.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(p){return p&&p.removeLayer(this),this},getPane:function(p){return this._map.getPane(p?this.options[p]||p:this.options.pane)},addInteractiveTarget:function(p){return this._map._targets[o(p)]=this,this},removeInteractiveTarget:function(p){return delete this._map._targets[o(p)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(p){var b=p.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var S=this.getEvents();b.on(S,this),this.once("remove",function(){b.off(S,this)},this)}this.onAdd(b),this.fire("add"),b.fire("layeradd",{layer:this})}}});$t.include({addLayer:function(p){if(!p._layerAdd)throw new Error("The provided object is not a Layer.");var b=o(p);return this._layers[b]?this:(this._layers[b]=p,p._mapToAdd=this,p.beforeAdd&&p.beforeAdd(this),this.whenReady(p._layerAdd,p),this)},removeLayer:function(p){var b=o(p);return this._layers[b]?(this._loaded&&p.onRemove(this),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:p}),p.fire("remove")),p._map=p._mapToAdd=null,this):this},hasLayer:function(p){return o(p)in this._layers},eachLayer:function(p,b){for(var S in this._layers)p.call(b,this._layers[S]);return this},_addLayers:function(p){p=p?E(p)?p:[p]:[];for(var b=0,S=p.length;b<S;b++)this.addLayer(p[b])},_addZoomLimit:function(p){(!isNaN(p.options.maxZoom)||!isNaN(p.options.minZoom))&&(this._zoomBoundLayers[o(p)]=p,this._updateZoomLevels())},_removeZoomLimit:function(p){var b=o(p);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var p=1/0,b=-1/0,S=this._getZoomSpan();for(var A in this._zoomBoundLayers){var H=this._zoomBoundLayers[A].options;p=H.minZoom===void 0?p:Math.min(p,H.minZoom),b=H.maxZoom===void 0?b:Math.max(b,H.maxZoom)}this._layersMaxZoom=b===-1/0?void 0:b,this._layersMinZoom=p===1/0?void 0:p,S!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var pl=Ta.extend({initialize:function(p,b){m(this,b),this._layers={};var S,A;if(p)for(S=0,A=p.length;S<A;S++)this.addLayer(p[S])},addLayer:function(p){var b=this.getLayerId(p);return this._layers[b]=p,this._map&&this._map.addLayer(p),this},removeLayer:function(p){var b=p in this._layers?p:this.getLayerId(p);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(p){var b=typeof p=="number"?p:this.getLayerId(p);return b in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(p){var b=Array.prototype.slice.call(arguments,1),S,A;for(S in this._layers)A=this._layers[S],A[p]&&A[p].apply(A,b);return this},onAdd:function(p){this.eachLayer(p.addLayer,p)},onRemove:function(p){this.eachLayer(p.removeLayer,p)},eachLayer:function(p,b){for(var S in this._layers)p.call(b,this._layers[S]);return this},getLayer:function(p){return this._layers[p]},getLayers:function(){var p=[];return this.eachLayer(p.push,p),p},setZIndex:function(p){return this.invoke("setZIndex",p)},getLayerId:function(p){return o(p)}}),Rv=function(p,b){return new pl(p,b)},fs=pl.extend({addLayer:function(p){return this.hasLayer(p)?this:(p.addEventParent(this),pl.prototype.addLayer.call(this,p),this.fire("layeradd",{layer:p}))},removeLayer:function(p){return this.hasLayer(p)?(p in this._layers&&(p=this._layers[p]),p.removeEventParent(this),pl.prototype.removeLayer.call(this,p),this.fire("layerremove",{layer:p})):this},setStyle:function(p){return this.invoke("setStyle",p)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var p=new ie;for(var b in this._layers){var S=this._layers[b];p.extend(S.getBounds?S.getBounds():S.getLatLng())}return p}}),Nv=function(p,b){return new fs(p,b)},Kt=k.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(p){m(this,p)},createIcon:function(p){return this._createIcon("icon",p)},createShadow:function(p){return this._createIcon("shadow",p)},_createIcon:function(p,b){var S=this._getIconUrl(p);if(!S){if(p==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(S,b&&b.tagName==="IMG"?b:null);return this._setIconStyles(A,p),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(p,b){var S=this.options,A=S[b+"Size"];typeof A=="number"&&(A=[A,A]);var H=Z(A),J=Z(b==="shadow"&&S.shadowAnchor||S.iconAnchor||H&&H.divideBy(2,!0));p.className="leaflet-marker-"+b+" "+(S.className||""),J&&(p.style.marginLeft=-J.x+"px",p.style.marginTop=-J.y+"px"),H&&(p.style.width=H.x+"px",p.style.height=H.y+"px")},_createImg:function(p,b){return b=b||document.createElement("img"),b.src=p,b},_getIconUrl:function(p){return De.retina&&this.options[p+"RetinaUrl"]||this.options[p+"Url"]}});function QE(p){return new Kt(p)}var $c=Kt.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(p){return typeof $c.imagePath!="string"&&($c.imagePath=this._detectIconPath()),(this.options.imagePath||$c.imagePath)+Kt.prototype._getIconUrl.call(this,p)},_stripUrl:function(p){var b=function(S,A,H){var J=A.exec(S);return J&&J[H]};return p=b(p,/^url\((['"])?(.+)\1\)$/,2),p&&b(p,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var p=Bt("div","leaflet-default-icon-path",document.body),b=Ws(p,"background-image")||Ws(p,"backgroundImage");if(document.body.removeChild(p),b=this._stripUrl(b),b)return b;var S=document.querySelector('link[href$="leaflet.css"]');return S?S.href.substring(0,S.href.length-11-1):""}}),ip=Mn.extend({initialize:function(p){this._marker=p},addHooks:function(){var p=this._marker._icon;this._draggable||(this._draggable=new Ys(p,p,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ot(p,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Br(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(p){var b=this._marker,S=b._map,A=this._marker.options.autoPanSpeed,H=this._marker.options.autoPanPadding,J=Us(b._icon),de=S.getPixelBounds(),be=S.getPixelOrigin(),ke=X(de.min._subtract(be).add(H),de.max._subtract(be).subtract(H));if(!ke.contains(J)){var Be=Z((Math.max(ke.max.x,J.x)-ke.max.x)/(de.max.x-ke.max.x)-(Math.min(ke.min.x,J.x)-ke.min.x)/(de.min.x-ke.min.x),(Math.max(ke.max.y,J.y)-ke.max.y)/(de.max.y-ke.max.y)-(Math.min(ke.min.y,J.y)-ke.min.y)/(de.min.y-ke.min.y)).multiplyBy(A);S.panBy(Be,{animate:!1}),this._draggable._newPos._add(Be),this._draggable._startPos._add(Be),$r(b._icon,this._draggable._newPos),this._onDrag(p),this._panRequest=R(this._adjustPan.bind(this,p))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(p){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=R(this._adjustPan.bind(this,p)))},_onDrag:function(p){var b=this._marker,S=b._shadow,A=Us(b._icon),H=b._map.layerPointToLatLng(A);S&&$r(S,A),b._latlng=H,p.latlng=H,p.oldLatLng=this._oldLatLng,b.fire("move",p).fire("drag",p)},_onDragEnd:function(p){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",p)}}),md=Ta.extend({options:{icon:new $c,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(p,b){m(this,b),this._latlng=se(p)},onAdd:function(p){this._zoomAnimated=this._zoomAnimated&&p.options.markerZoomAnimation,this._zoomAnimated&&p.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(p){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&p.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(p){var b=this._latlng;return this._latlng=se(p),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(p){return this.options.zIndexOffset=p,this.update()},getIcon:function(){return this.options.icon},setIcon:function(p){return this.options.icon=p,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var p=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(p)}return this},_initIcon:function(){var p=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),S=p.icon.createIcon(this._icon),A=!1;S!==this._icon&&(this._icon&&this._removeIcon(),A=!0,p.title&&(S.title=p.title),S.tagName==="IMG"&&(S.alt=p.alt||"")),ot(S,b),p.keyboard&&(S.tabIndex="0",S.setAttribute("role","button")),this._icon=S,p.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&_t(S,"focus",this._panOnFocus,this);var H=p.icon.createShadow(this._shadow),J=!1;H!==this._shadow&&(this._removeShadow(),J=!0),H&&(ot(H,b),H.alt=""),this._shadow=H,p.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),H&&J&&this.getPane(p.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&gr(this._icon,"focus",this._panOnFocus,this),xr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&xr(this._shadow),this._shadow=null},_setPos:function(p){this._icon&&$r(this._icon,p),this._shadow&&$r(this._shadow,p),this._zIndex=p.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(p){this._icon&&(this._icon.style.zIndex=this._zIndex+p)},_animateZoom:function(p){var b=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(ot(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ip)){var p=this.options.draggable;this.dragging&&(p=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ip(this),p&&this.dragging.enable()}},setOpacity:function(p){return this.options.opacity=p,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var p=this.options.opacity;this._icon&&Pn(this._icon,p),this._shadow&&Pn(this._shadow,p)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var p=this._map;if(p){var b=this.options.icon.options,S=b.iconSize?Z(b.iconSize):Z(0,0),A=b.iconAnchor?Z(b.iconAnchor):Z(0,0);p.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:S.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function eT(p,b){return new md(p,b)}var qs=Ta.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(p){this._renderer=p.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(p){return m(this,p),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&p&&Object.prototype.hasOwnProperty.call(p,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Zs=qs.extend({options:{fill:!0,radius:10},initialize:function(p,b){m(this,b),this._latlng=se(p),this._radius=this.options.radius},setLatLng:function(p){var b=this._latlng;return this._latlng=se(p),this.redraw(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(p){return this.options.radius=this._radius=p,this.redraw()},getRadius:function(){return this._radius},setStyle:function(p){var b=p&&p.radius||this._radius;return qs.prototype.setStyle.call(this,p),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var p=this._radius,b=this._radiusY||p,S=this._clickTolerance(),A=[p+S,b+S];this._pxBounds=new q(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(p){return p.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function tT(p,b){return new Zs(p,b)}var np=Zs.extend({initialize:function(p,b,S){if(typeof b=="number"&&(b=e({},S,{radius:b})),m(this,b),this._latlng=se(p),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(p){return this._mRadius=p,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var p=[this._radius,this._radiusY||this._radius];return new ie(this._map.layerPointToLatLng(this._point.subtract(p)),this._map.layerPointToLatLng(this._point.add(p)))},setStyle:qs.prototype.setStyle,_project:function(){var p=this._latlng.lng,b=this._latlng.lat,S=this._map,A=S.options.crs;if(A.distance===ge.distance){var H=Math.PI/180,J=this._mRadius/ge.R/H,de=S.project([b+J,p]),be=S.project([b-J,p]),ke=de.add(be).divideBy(2),Be=S.unproject(ke).lat,Ke=Math.acos((Math.cos(J*H)-Math.sin(b*H)*Math.sin(Be*H))/(Math.cos(b*H)*Math.cos(Be*H)))/H;(isNaN(Ke)||Ke===0)&&(Ke=J/Math.cos(Math.PI/180*b)),this._point=ke.subtract(S.getPixelOrigin()),this._radius=isNaN(Ke)?0:ke.x-S.project([Be,p-Ke]).x,this._radiusY=ke.y-de.y}else{var dt=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=S.latLngToLayerPoint(this._latlng),this._radius=this._point.x-S.latLngToLayerPoint(dt).x}this._updateBounds()}});function rT(p,b,S){return new np(p,b,S)}var Kn=qs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(p,b){m(this,b),this._setLatLngs(p)},getLatLngs:function(){return this._latlngs},setLatLngs:function(p){return this._setLatLngs(p),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(p){for(var b=1/0,S=null,A=Nc,H,J,de=0,be=this._parts.length;de<be;de++)for(var ke=this._parts[de],Be=1,Ke=ke.length;Be<Ke;Be++){H=ke[Be-1],J=ke[Be];var dt=A(p,H,J,!0);dt<b&&(b=dt,S=A(p,H,J))}return S&&(S.distance=Math.sqrt(b)),S},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ov(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(p,b){return b=b||this._defaultShape(),p=se(p),b.push(p),this._bounds.extend(p),this.redraw()},_setLatLngs:function(p){this._bounds=new ie,this._latlngs=this._convertLatLngs(p)},_defaultShape:function(){return Zn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(p){for(var b=[],S=Zn(p),A=0,H=p.length;A<H;A++)S?(b[A]=se(p[A]),this._bounds.extend(b[A])):b[A]=this._convertLatLngs(p[A]);return b},_project:function(){var p=new q;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,p),this._bounds.isValid()&&p.isValid()&&(this._rawPxBounds=p,this._updateBounds())},_updateBounds:function(){var p=this._clickTolerance(),b=new Y(p,p);this._rawPxBounds&&(this._pxBounds=new q([this._rawPxBounds.min.subtract(b),this._rawPxBounds.max.add(b)]))},_projectLatlngs:function(p,b,S){var A=p[0]instanceof K,H=p.length,J,de;if(A){for(de=[],J=0;J<H;J++)de[J]=this._map.latLngToLayerPoint(p[J]),S.extend(de[J]);b.push(de)}else for(J=0;J<H;J++)this._projectLatlngs(p[J],b,S)},_clipPoints:function(){var p=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(p))){if(this.options.noClip){this._parts=this._rings;return}var b=this._parts,S,A,H,J,de,be,ke;for(S=0,H=0,J=this._rings.length;S<J;S++)for(ke=this._rings[S],A=0,de=ke.length;A<de-1;A++)be=Qf(ke[A],ke[A+1],p,A,!0),be&&(b[H]=b[H]||[],b[H].push(be[0]),(be[1]!==ke[A+1]||A===de-2)&&(b[H].push(be[1]),H++))}},_simplifyPoints:function(){for(var p=this._parts,b=this.options.smoothFactor,S=0,A=p.length;S<A;S++)p[S]=Mv(p[S],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(p,b){var S,A,H,J,de,be,ke=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(S=0,J=this._parts.length;S<J;S++)for(be=this._parts[S],A=0,de=be.length,H=de-1;A<de;H=A++)if(!(!b&&A===0)&&Iv(p,be[H],be[A])<=ke)return!0;return!1}});function gd(p,b){return new Kn(p,b)}Kn._flat=ep;var Ks=Kn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Lv(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(p){var b=Kn.prototype._convertLatLngs.call(this,p),S=b.length;return S>=2&&b[0]instanceof K&&b[0].equals(b[S-1])&&b.pop(),b},_setLatLngs:function(p){Kn.prototype._setLatLngs.call(this,p),Zn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Zn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var p=this._renderer._bounds,b=this.options.weight,S=new Y(b,b);if(p=new q(p.min.subtract(S),p.max.add(S)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(p))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,H=this._rings.length,J;A<H;A++)J=Va(this._rings[A],p,!0),J.length&&this._parts.push(J)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(p){var b=!1,S,A,H,J,de,be,ke,Be;if(!this._pxBounds||!this._pxBounds.contains(p))return!1;for(J=0,ke=this._parts.length;J<ke;J++)for(S=this._parts[J],de=0,Be=S.length,be=Be-1;de<Be;be=de++)A=S[de],H=S[be],A.y>p.y!=H.y>p.y&&p.x<(H.x-A.x)*(p.y-A.y)/(H.y-A.y)+A.x&&(b=!b);return b||Kn.prototype._containsPoint.call(this,p,!0)}});function iT(p,b){return new Ks(p,b)}var Wa=fs.extend({initialize:function(p,b){m(this,b),this._layers={},p&&this.addData(p)},addData:function(p){var b=E(p)?p:p.features,S,A,H;if(b){for(S=0,A=b.length;S<A;S++)H=b[S],(H.geometries||H.geometry||H.features||H.coordinates)&&this.addData(H);return this}var J=this.options;if(J.filter&&!J.filter(p))return this;var de=vd(p,J);return de?(de.feature=wd(p),de.defaultOptions=de.options,this.resetStyle(de),J.onEachFeature&&J.onEachFeature(p,de),this.addLayer(de)):this},resetStyle:function(p){return p===void 0?this.eachLayer(this.resetStyle,this):(p.options=e({},p.defaultOptions),this._setLayerStyle(p,this.options.style),this)},setStyle:function(p){return this.eachLayer(function(b){this._setLayerStyle(b,p)},this)},_setLayerStyle:function(p,b){p.setStyle&&(typeof b=="function"&&(b=b(p.feature)),p.setStyle(b))}});function vd(p,b){var S=p.type==="Feature"?p.geometry:p,A=S?S.coordinates:null,H=[],J=b&&b.pointToLayer,de=b&&b.coordsToLatLng||zc,be,ke,Be,Ke;if(!A&&!S)return null;switch(S.type){case"Point":return be=de(A),yd(J,p,be,b);case"MultiPoint":for(Be=0,Ke=A.length;Be<Ke;Be++)be=de(A[Be]),H.push(yd(J,p,be,b));return new fs(H);case"LineString":case"MultiLineString":return ke=ml(A,S.type==="LineString"?0:1,de),new Kn(ke,b);case"Polygon":case"MultiPolygon":return ke=ml(A,S.type==="Polygon"?1:2,de),new Ks(ke,b);case"GeometryCollection":for(Be=0,Ke=S.geometries.length;Be<Ke;Be++){var dt=vd({geometry:S.geometries[Be],type:"Feature",properties:p.properties},b);dt&&H.push(dt)}return new fs(H);case"FeatureCollection":for(Be=0,Ke=S.features.length;Be<Ke;Be++){var Ot=vd(S.features[Be],b);Ot&&H.push(Ot)}return new fs(H);default:throw new Error("Invalid GeoJSON object.")}}function yd(p,b,S,A){return p?p(b,S):new md(S,A&&A.markersInheritOptions&&A)}function zc(p){return new K(p[1],p[0],p[2])}function ml(p,b,S){for(var A=[],H=0,J=p.length,de;H<J;H++)de=b?ml(p[H],b-1,S):(S||zc)(p[H]),A.push(de);return A}function ap(p,b){return p=se(p),p.alt!==void 0?[d(p.lng,b),d(p.lat,b),d(p.alt,b)]:[d(p.lng,b),d(p.lat,b)]}function bd(p,b,S,A){for(var H=[],J=0,de=p.length;J<de;J++)H.push(b?bd(p[J],Zn(p[J])?0:b-1,S,A):ap(p[J],A));return!b&&S&&H.length>0&&H.push(H[0].slice()),H}function gl(p,b){return p.feature?e({},p.feature,{geometry:b}):wd(b)}function wd(p){return p.type==="Feature"||p.type==="FeatureCollection"?p:{type:"Feature",properties:{},geometry:p}}var sp={toGeoJSON:function(p){return gl(this,{type:"Point",coordinates:ap(this.getLatLng(),p)})}};md.include(sp),np.include(sp),Zs.include(sp),Kn.include({toGeoJSON:function(p){var b=!Zn(this._latlngs),S=bd(this._latlngs,b?1:0,!1,p);return gl(this,{type:(b?"Multi":"")+"LineString",coordinates:S})}}),Ks.include({toGeoJSON:function(p){var b=!Zn(this._latlngs),S=b&&!Zn(this._latlngs[0]),A=bd(this._latlngs,S?2:b?1:0,!0,p);return b||(A=[A]),gl(this,{type:(S?"Multi":"")+"Polygon",coordinates:A})}}),pl.include({toMultiPoint:function(p){var b=[];return this.eachLayer(function(S){b.push(S.toGeoJSON(p).geometry.coordinates)}),gl(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(p){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(b==="MultiPoint")return this.toMultiPoint(p);var S=b==="GeometryCollection",A=[];return this.eachLayer(function(H){if(H.toGeoJSON){var J=H.toGeoJSON(p);if(S)A.push(J.geometry);else{var de=wd(J);de.type==="FeatureCollection"?A.push.apply(A,de.features):A.push(de)}}}),S?gl(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function Bv(p,b){return new Wa(p,b)}var nT=Bv,Ed=Ta.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(p,b,S){this._url=p,this._bounds=j(b),m(this,S)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ot(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){xr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(p){return this.options.opacity=p,this._image&&this._updateOpacity(),this},setStyle:function(p){return p.opacity&&this.setOpacity(p.opacity),this},bringToFront:function(){return this._map&&ba(this._image),this},bringToBack:function(){return this._map&&za(this._image),this},setUrl:function(p){return this._url=p,this._image&&(this._image.src=p),this},setBounds:function(p){return this._bounds=j(p),this._map&&this._reset(),this},getEvents:function(){var p={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},setZIndex:function(p){return this.options.zIndex=p,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var p=this._url.tagName==="IMG",b=this._image=p?this._url:Bt("img");if(ot(b,"leaflet-image-layer"),this._zoomAnimated&&ot(b,"leaflet-zoom-animated"),this.options.className&&ot(b,this.options.className),b.onselectstart=u,b.onmousemove=u,b.onload=n(this.fire,this,"load"),b.onerror=n(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),p){this._url=b.src;return}b.src=this._url,b.alt=this.options.alt},_animateZoom:function(p){var b=this._map.getZoomScale(p.zoom),S=this._map._latLngBoundsToNewLayerBounds(this._bounds,p.zoom,p.center).min;wa(this._image,S,b)},_reset:function(){var p=this._image,b=new q(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),S=b.getSize();$r(p,b.min),p.style.width=S.x+"px",p.style.height=S.y+"px"},_updateOpacity:function(){Pn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var p=this.options.errorOverlayUrl;p&&this._url!==p&&(this._url=p,this._image.src=p)},getCenter:function(){return this._bounds.getCenter()}}),aT=function(p,b,S){return new Ed(p,b,S)},$v=Ed.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var p=this._url.tagName==="VIDEO",b=this._image=p?this._url:Bt("video");if(ot(b,"leaflet-image-layer"),this._zoomAnimated&&ot(b,"leaflet-zoom-animated"),this.options.className&&ot(b,this.options.className),b.onselectstart=u,b.onmousemove=u,b.onloadeddata=n(this.fire,this,"load"),p){for(var S=b.getElementsByTagName("source"),A=[],H=0;H<S.length;H++)A.push(S[H].src);this._url=S.length>0?A:[b.src];return}E(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(b.style,"objectFit")&&(b.style.objectFit="fill"),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop,b.muted=!!this.options.muted,b.playsInline=!!this.options.playsInline;for(var J=0;J<this._url.length;J++){var de=Bt("source");de.src=this._url[J],b.appendChild(de)}}});function zv(p,b,S){return new $v(p,b,S)}var Hv=Ed.extend({_initImage:function(){var p=this._image=this._url;ot(p,"leaflet-image-layer"),this._zoomAnimated&&ot(p,"leaflet-zoom-animated"),this.options.className&&ot(p,this.options.className),p.onselectstart=u,p.onmousemove=u}});function sT(p,b,S){return new Hv(p,b,S)}var ii=Ta.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(p,b){p&&(p instanceof K||E(p))?(this._latlng=se(p),m(this,b)):(m(this,p),this._source=b),this.options.content&&(this._content=this.options.content)},openOn:function(p){return p=arguments.length?p:this._source._map,p.hasLayer(this)||p.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(p){return this._map?this.close():(arguments.length?this._source=p:p=this._source,this._prepareOpen(),this.openOn(p._map)),this},onAdd:function(p){this._zoomAnimated=p._zoomAnimated,this._container||this._initLayout(),p._fadeAnimated&&Pn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),p._fadeAnimated&&Pn(this._container,1),this.bringToFront(),this.options.interactive&&(ot(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(p){p._fadeAnimated?(Pn(this._container,0),this._removeTimeout=setTimeout(n(xr,void 0,this._container),200)):xr(this._container),this.options.interactive&&(Br(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(p){return this._latlng=se(p),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(p){return this._content=p,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var p={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ba(this._container),this},bringToBack:function(){return this._map&&za(this._container),this},_prepareOpen:function(p){var b=this._source;if(!b._map)return!1;if(b instanceof fs){b=null;var S=this._source._layers;for(var A in S)if(S[A]._map){b=S[A];break}if(!b)return!1;this._source=b}if(!p)if(b.getCenter)p=b.getCenter();else if(b.getLatLng)p=b.getLatLng();else if(b.getBounds)p=b.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(p),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var p=this._contentNode,b=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof b=="string")p.innerHTML=b;else{for(;p.hasChildNodes();)p.removeChild(p.firstChild);p.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var p=this._map.latLngToLayerPoint(this._latlng),b=Z(this.options.offset),S=this._getAnchor();this._zoomAnimated?$r(this._container,p.add(S)):b=b.add(p).add(S);var A=this._containerBottom=-b.y,H=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=A+"px",this._container.style.left=H+"px"}},_getAnchor:function(){return[0,0]}});$t.include({_initOverlay:function(p,b,S,A){var H=b;return H instanceof p||(H=new p(A).setContent(b)),S&&H.setLatLng(S),H}}),Ta.include({_initOverlay:function(p,b,S,A){var H=S;return H instanceof p?(m(H,A),H._source=this):(H=b&&!A?b:new p(A,this),H.setContent(S)),H}});var Ua=ii.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(p){return p=arguments.length?p:this._source._map,!p.hasLayer(this)&&p._popup&&p._popup.options.autoClose&&p.removeLayer(p._popup),p._popup=this,ii.prototype.openOn.call(this,p)},onAdd:function(p){ii.prototype.onAdd.call(this,p),p.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof qs||this._source.on("preclick",Eo))},onRemove:function(p){ii.prototype.onRemove.call(this,p),p.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof qs||this._source.off("preclick",Eo))},getEvents:function(){var p=ii.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(p.preclick=this.close),this.options.keepInView&&(p.moveend=this._adjustPan),p},_initLayout:function(){var p="leaflet-popup",b=this._container=Bt("div",p+" "+(this.options.className||"")+" leaflet-zoom-animated"),S=this._wrapper=Bt("div",p+"-content-wrapper",b);if(this._contentNode=Bt("div",p+"-content",S),Ic(b),qf(this._contentNode),_t(b,"contextmenu",Eo),this._tipContainer=Bt("div",p+"-tip-container",b),this._tip=Bt("div",p+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=Bt("a",p+"-close-button",b);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',_t(A,"click",function(H){ki(H),this.close()},this)}},_updateLayout:function(){var p=this._contentNode,b=p.style;b.width="",b.whiteSpace="nowrap";var S=p.offsetWidth;S=Math.min(S,this.options.maxWidth),S=Math.max(S,this.options.minWidth),b.width=S+1+"px",b.whiteSpace="",b.height="";var A=p.offsetHeight,H=this.options.maxHeight,J="leaflet-popup-scrolled";H&&A>H?(b.height=H+"px",ot(p,J)):Br(p,J),this._containerWidth=this._container.offsetWidth},_animateZoom:function(p){var b=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center),S=this._getAnchor();$r(this._container,b.add(S))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var p=this._map,b=parseInt(Ws(this._container,"marginBottom"),10)||0,S=this._container.offsetHeight+b,A=this._containerWidth,H=new Y(this._containerLeft,-S-this._containerBottom);H._add(Us(this._container));var J=p.layerPointToContainerPoint(H),de=Z(this.options.autoPanPadding),be=Z(this.options.autoPanPaddingTopLeft||de),ke=Z(this.options.autoPanPaddingBottomRight||de),Be=p.getSize(),Ke=0,dt=0;J.x+A+ke.x>Be.x&&(Ke=J.x+A-Be.x+ke.x),J.x-Ke-be.x<0&&(Ke=J.x-be.x),J.y+S+ke.y>Be.y&&(dt=J.y+S-Be.y+ke.y),J.y-dt-be.y<0&&(dt=J.y-be.y),(Ke||dt)&&(this.options.keepInView&&(this._autopanning=!0),p.fire("autopanstart").panBy([Ke,dt]))}},_getAnchor:function(){return Z(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Gv=function(p,b){return new Ua(p,b)};$t.mergeOptions({closePopupOnClick:!0}),$t.include({openPopup:function(p,b,S){return this._initOverlay(Ua,p,b,S).openOn(this),this},closePopup:function(p){return p=arguments.length?p:this._popup,p&&p.close(),this}}),Ta.include({bindPopup:function(p,b){return this._popup=this._initOverlay(Ua,this._popup,p,b),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(p){return this._popup&&(this instanceof fs||(this._popup._source=this),this._popup._prepareOpen(p||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(p){return this._popup&&this._popup.setContent(p),this},getPopup:function(){return this._popup},_openPopup:function(p){if(!(!this._popup||!this._map)){To(p);var b=p.layer||p.target;if(this._popup._source===b&&!(b instanceof qs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(p.latlng);return}this._popup._source=b,this.openPopup(p.latlng)}},_movePopup:function(p){this._popup.setLatLng(p.latlng)},_onKeyPress:function(p){p.originalEvent.keyCode===13&&this._openPopup(p)}});var Td=ii.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(p){ii.prototype.onAdd.call(this,p),this.setOpacity(this.options.opacity),p.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(p){ii.prototype.onRemove.call(this,p),p.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var p=ii.prototype.getEvents.call(this);return this.options.permanent||(p.preclick=this.close),p},_initLayout:function(){var p="leaflet-tooltip",b=p+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Bt("div",b),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+o(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(p){var b,S,A=this._map,H=this._container,J=A.latLngToContainerPoint(A.getCenter()),de=A.layerPointToContainerPoint(p),be=this.options.direction,ke=H.offsetWidth,Be=H.offsetHeight,Ke=Z(this.options.offset),dt=this._getAnchor();be==="top"?(b=ke/2,S=Be):be==="bottom"?(b=ke/2,S=0):be==="center"?(b=ke/2,S=Be/2):be==="right"?(b=0,S=Be/2):be==="left"?(b=ke,S=Be/2):de.x<J.x?(be="right",b=0,S=Be/2):(be="left",b=ke+(Ke.x+dt.x)*2,S=Be/2),p=p.subtract(Z(b,S,!0)).add(Ke).add(dt),Br(H,"leaflet-tooltip-right"),Br(H,"leaflet-tooltip-left"),Br(H,"leaflet-tooltip-top"),Br(H,"leaflet-tooltip-bottom"),ot(H,"leaflet-tooltip-"+be),$r(H,p)},_updatePosition:function(){var p=this._map.latLngToLayerPoint(this._latlng);this._setPosition(p)},setOpacity:function(p){this.options.opacity=p,this._container&&Pn(this._container,p)},_animateZoom:function(p){var b=this._map._latLngToNewLayerPoint(this._latlng,p.zoom,p.center);this._setPosition(b)},_getAnchor:function(){return Z(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Vv=function(p,b){return new Td(p,b)};$t.include({openTooltip:function(p,b,S){return this._initOverlay(Td,p,b,S).openOn(this),this},closeTooltip:function(p){return p.close(),this}}),Ta.include({bindTooltip:function(p,b){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Td,this._tooltip,p,b),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(p){if(!(!p&&this._tooltipHandlersAdded)){var b=p?"off":"on",S={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?S.add=this._openTooltip:(S.mouseover=this._openTooltip,S.mouseout=this.closeTooltip,S.click=this._openTooltip,this._map?this._addFocusListeners():S.add=this._addFocusListeners),this._tooltip.options.sticky&&(S.mousemove=this._moveTooltip),this[b](S),this._tooltipHandlersAdded=!p}},openTooltip:function(p){return this._tooltip&&(this instanceof fs||(this._tooltip._source=this),this._tooltip._prepareOpen(p)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(p){return this._tooltip&&this._tooltip.setContent(p),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(p){var b=typeof p.getElement=="function"&&p.getElement();b&&(_t(b,"focus",function(){this._tooltip._source=p,this.openTooltip()},this),_t(b,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(p){var b=typeof p.getElement=="function"&&p.getElement();b&&b.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(p){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var b=this;this._map.once("moveend",function(){b._openOnceFlag=!1,b._openTooltip(p)});return}this._tooltip._source=p.layer||p.target,this.openTooltip(this._tooltip.options.sticky?p.latlng:void 0)}},_moveTooltip:function(p){var b=p.latlng,S,A;this._tooltip.options.sticky&&p.originalEvent&&(S=this._map.mouseEventToContainerPoint(p.originalEvent),A=this._map.containerPointToLayerPoint(S),b=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(b)}});var op=Kt.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(p){var b=p&&p.tagName==="DIV"?p:document.createElement("div"),S=this.options;if(S.html instanceof Element?($i(b),b.appendChild(S.html)):b.innerHTML=S.html!==!1?S.html:"",S.bgPos){var A=Z(S.bgPos);b.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(b,"icon"),b},createShadow:function(){return null}});function oT(p){return new op(p)}Kt.Default=$c;var Hc=Ta.extend({options:{tileSize:256,opacity:1,updateWhenIdle:De.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(p){m(this,p)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(p){p._addZoomLimit(this)},onRemove:function(p){this._removeAllTiles(),xr(this._container),p._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ba(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(za(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(p){return this.options.opacity=p,this._updateOpacity(),this},setZIndex:function(p){return this.options.zIndex=p,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var p=this._clampZoom(this._map.getZoom());p!==this._tileZoom&&(this._tileZoom=p,this._updateLevels()),this._update()}return this},getEvents:function(){var p={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=l(this._onMoveEnd,this.options.updateInterval,this)),p.move=this._onMove),this._zoomAnimated&&(p.zoomanim=this._animateZoom),p},createTile:function(){return document.createElement("div")},getTileSize:function(){var p=this.options.tileSize;return p instanceof Y?p:new Y(p,p)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(p){for(var b=this.getPane().children,S=-p(-1/0,1/0),A=0,H=b.length,J;A<H;A++)J=b[A].style.zIndex,b[A]!==this._container&&J&&(S=p(S,+J));isFinite(S)&&(this.options.zIndex=S+p(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!De.ielt9){Pn(this._container,this.options.opacity);var p=+new Date,b=!1,S=!1;for(var A in this._tiles){var H=this._tiles[A];if(!(!H.current||!H.loaded)){var J=Math.min(1,(p-H.loaded)/200);Pn(H.el,J),J<1?b=!0:(H.active?S=!0:this._onOpaqueTile(H),H.active=!0)}}S&&!this._noPrune&&this._pruneTiles(),b&&(F(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this))}},_onOpaqueTile:u,_initContainer:function(){this._container||(this._container=Bt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var p=this._tileZoom,b=this.options.maxZoom;if(p!==void 0){for(var S in this._levels)S=Number(S),this._levels[S].el.children.length||S===p?(this._levels[S].el.style.zIndex=b-Math.abs(p-S),this._onUpdateLevel(S)):(xr(this._levels[S].el),this._removeTilesAtZoom(S),this._onRemoveLevel(S),delete this._levels[S]);var A=this._levels[p],H=this._map;return A||(A=this._levels[p]={},A.el=Bt("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=b,A.origin=H.project(H.unproject(H.getPixelOrigin()),p).round(),A.zoom=p,this._setZoomTransform(A,H.getCenter(),H.getZoom()),u(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:u,_onRemoveLevel:u,_onCreateLevel:u,_pruneTiles:function(){if(this._map){var p,b,S=this._map.getZoom();if(S>this.options.maxZoom||S<this.options.minZoom){this._removeAllTiles();return}for(p in this._tiles)b=this._tiles[p],b.retain=b.current;for(p in this._tiles)if(b=this._tiles[p],b.current&&!b.active){var A=b.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(p in this._tiles)this._tiles[p].retain||this._removeTile(p)}},_removeTilesAtZoom:function(p){for(var b in this._tiles)this._tiles[b].coords.z===p&&this._removeTile(b)},_removeAllTiles:function(){for(var p in this._tiles)this._removeTile(p)},_invalidateAll:function(){for(var p in this._levels)xr(this._levels[p].el),this._onRemoveLevel(Number(p)),delete this._levels[p];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(p,b,S,A){var H=Math.floor(p/2),J=Math.floor(b/2),de=S-1,be=new Y(+H,+J);be.z=+de;var ke=this._tileCoordsToKey(be),Be=this._tiles[ke];return Be&&Be.active?(Be.retain=!0,!0):(Be&&Be.loaded&&(Be.retain=!0),de>A?this._retainParent(H,J,de,A):!1)},_retainChildren:function(p,b,S,A){for(var H=2*p;H<2*p+2;H++)for(var J=2*b;J<2*b+2;J++){var de=new Y(H,J);de.z=S+1;var be=this._tileCoordsToKey(de),ke=this._tiles[be];if(ke&&ke.active){ke.retain=!0;continue}else ke&&ke.loaded&&(ke.retain=!0);S+1<A&&this._retainChildren(H,J,S+1,A)}},_resetView:function(p){var b=p&&(p.pinch||p.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(p){this._setView(p.center,p.zoom,!0,p.noUpdate)},_clampZoom:function(p){var b=this.options;return b.minNativeZoom!==void 0&&p<b.minNativeZoom?b.minNativeZoom:b.maxNativeZoom!==void 0&&b.maxNativeZoom<p?b.maxNativeZoom:p},_setView:function(p,b,S,A){var H=Math.round(b);this.options.maxZoom!==void 0&&H>this.options.maxZoom||this.options.minZoom!==void 0&&H<this.options.minZoom?H=void 0:H=this._clampZoom(H);var J=this.options.updateWhenZooming&&H!==this._tileZoom;(!A||J)&&(this._tileZoom=H,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),H!==void 0&&this._update(p),S||this._pruneTiles(),this._noPrune=!!S),this._setZoomTransforms(p,b)},_setZoomTransforms:function(p,b){for(var S in this._levels)this._setZoomTransform(this._levels[S],p,b)},_setZoomTransform:function(p,b,S){var A=this._map.getZoomScale(S,p.zoom),H=p.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(b,S)).round();De.any3d?wa(p.el,H,A):$r(p.el,H)},_resetGrid:function(){var p=this._map,b=p.options.crs,S=this._tileSize=this.getTileSize(),A=this._tileZoom,H=this._map.getPixelWorldBounds(this._tileZoom);H&&(this._globalTileRange=this._pxBoundsToTileRange(H)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(p.project([0,b.wrapLng[0]],A).x/S.x),Math.ceil(p.project([0,b.wrapLng[1]],A).x/S.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(p.project([b.wrapLat[0],0],A).y/S.x),Math.ceil(p.project([b.wrapLat[1],0],A).y/S.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(p){var b=this._map,S=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),A=b.getZoomScale(S,this._tileZoom),H=b.project(p,this._tileZoom).floor(),J=b.getSize().divideBy(A*2);return new q(H.subtract(J),H.add(J))},_update:function(p){var b=this._map;if(b){var S=this._clampZoom(b.getZoom());if(p===void 0&&(p=b.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(p),H=this._pxBoundsToTileRange(A),J=H.getCenter(),de=[],be=this.options.keepBuffer,ke=new q(H.getBottomLeft().subtract([be,-be]),H.getTopRight().add([be,-be]));if(!(isFinite(H.min.x)&&isFinite(H.min.y)&&isFinite(H.max.x)&&isFinite(H.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Be in this._tiles){var Ke=this._tiles[Be].coords;(Ke.z!==this._tileZoom||!ke.contains(new Y(Ke.x,Ke.y)))&&(this._tiles[Be].current=!1)}if(Math.abs(S-this._tileZoom)>1){this._setView(p,S);return}for(var dt=H.min.y;dt<=H.max.y;dt++)for(var Ot=H.min.x;Ot<=H.max.x;Ot++){var Ji=new Y(Ot,dt);if(Ji.z=this._tileZoom,!!this._isValidTile(Ji)){var pi=this._tiles[this._tileCoordsToKey(Ji)];pi?pi.current=!0:de.push(Ji)}}if(de.sort(function(dn,yl){return dn.distanceTo(J)-yl.distanceTo(J)}),de.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Xn=document.createDocumentFragment();for(Ot=0;Ot<de.length;Ot++)this._addTile(de[Ot],Xn);this._level.el.appendChild(Xn)}}}},_isValidTile:function(p){var b=this._map.options.crs;if(!b.infinite){var S=this._globalTileRange;if(!b.wrapLng&&(p.x<S.min.x||p.x>S.max.x)||!b.wrapLat&&(p.y<S.min.y||p.y>S.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(p);return j(this.options.bounds).overlaps(A)},_keyToBounds:function(p){return this._tileCoordsToBounds(this._keyToTileCoords(p))},_tileCoordsToNwSe:function(p){var b=this._map,S=this.getTileSize(),A=p.scaleBy(S),H=A.add(S),J=b.unproject(A,p.z),de=b.unproject(H,p.z);return[J,de]},_tileCoordsToBounds:function(p){var b=this._tileCoordsToNwSe(p),S=new ie(b[0],b[1]);return this.options.noWrap||(S=this._map.wrapLatLngBounds(S)),S},_tileCoordsToKey:function(p){return p.x+":"+p.y+":"+p.z},_keyToTileCoords:function(p){var b=p.split(":"),S=new Y(+b[0],+b[1]);return S.z=+b[2],S},_removeTile:function(p){var b=this._tiles[p];b&&(xr(b.el),delete this._tiles[p],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(p)}))},_initTile:function(p){ot(p,"leaflet-tile");var b=this.getTileSize();p.style.width=b.x+"px",p.style.height=b.y+"px",p.onselectstart=u,p.onmousemove=u,De.ielt9&&this.options.opacity<1&&Pn(p,this.options.opacity)},_addTile:function(p,b){var S=this._getTilePos(p),A=this._tileCoordsToKey(p),H=this.createTile(this._wrapCoords(p),n(this._tileReady,this,p));this._initTile(H),this.createTile.length<2&&R(n(this._tileReady,this,p,null,H)),$r(H,S),this._tiles[A]={el:H,coords:p,current:!0},b.appendChild(H),this.fire("tileloadstart",{tile:H,coords:p})},_tileReady:function(p,b,S){b&&this.fire("tileerror",{error:b,tile:S,coords:p});var A=this._tileCoordsToKey(p);S=this._tiles[A],S&&(S.loaded=+new Date,this._map._fadeAnimated?(Pn(S.el,0),F(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this)):(S.active=!0,this._pruneTiles()),b||(ot(S.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:S.el,coords:p})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),De.ielt9||!this._map._fadeAnimated?R(this._pruneTiles,this):setTimeout(n(this._pruneTiles,this),250)))},_getTilePos:function(p){return p.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(p){var b=new Y(this._wrapX?c(p.x,this._wrapX):p.x,this._wrapY?c(p.y,this._wrapY):p.y);return b.z=p.z,b},_pxBoundsToTileRange:function(p){var b=this.getTileSize();return new q(p.min.unscaleBy(b).floor(),p.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var p in this._tiles)if(!this._tiles[p].loaded)return!1;return!0}});function Wv(p){return new Hc(p)}var vl=Hc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(p,b){this._url=p,b=m(this,b),b.detectRetina&&De.retina&&b.maxZoom>0?(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom=Math.min(b.maxZoom,b.minZoom+1)):(b.zoomOffset++,b.maxZoom=Math.max(b.minZoom,b.maxZoom-1)),b.minZoom=Math.max(0,b.minZoom)):b.zoomReverse?b.minZoom=Math.min(b.maxZoom,b.minZoom):b.maxZoom=Math.max(b.minZoom,b.maxZoom),typeof b.subdomains=="string"&&(b.subdomains=b.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(p,b){return this._url===p&&b===void 0&&(b=!0),this._url=p,b||this.redraw(),this},createTile:function(p,b){var S=document.createElement("img");return _t(S,"load",n(this._tileOnLoad,this,b,S)),_t(S,"error",n(this._tileOnError,this,b,S)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(S.referrerPolicy=this.options.referrerPolicy),S.alt="",S.src=this.getTileUrl(p),S},getTileUrl:function(p){var b={r:De.retina?"@2x":"",s:this._getSubdomain(p),x:p.x,y:p.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var S=this._globalTileRange.max.y-p.y;this.options.tms&&(b.y=S),b["-y"]=S}return v(this._url,e(b,this.options))},_tileOnLoad:function(p,b){De.ielt9?setTimeout(n(p,this,null,b),0):p(null,b)},_tileOnError:function(p,b,S){var A=this.options.errorTileUrl;A&&b.getAttribute("src")!==A&&(b.src=A),p(S,b)},_onTileRemove:function(p){p.tile.onload=null},_getZoomForUrl:function(){var p=this._tileZoom,b=this.options.maxZoom,S=this.options.zoomReverse,A=this.options.zoomOffset;return S&&(p=b-p),p+A},_getSubdomain:function(p){var b=Math.abs(p.x+p.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var p,b;for(p in this._tiles)if(this._tiles[p].coords.z!==this._tileZoom&&(b=this._tiles[p].el,b.onload=u,b.onerror=u,!b.complete)){b.src=_;var S=this._tiles[p].coords;xr(b),delete this._tiles[p],this.fire("tileabort",{tile:b,coords:S})}},_removeTile:function(p){var b=this._tiles[p];if(b)return b.el.setAttribute("src",_),Hc.prototype._removeTile.call(this,p)},_tileReady:function(p,b,S){if(!(!this._map||S&&S.getAttribute("src")===_))return Hc.prototype._tileReady.call(this,p,b,S)}});function Uv(p,b){return new vl(p,b)}var jv=vl.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(p,b){this._url=p;var S=e({},this.defaultWmsParams);for(var A in b)A in this.options||(S[A]=b[A]);b=m(this,b);var H=b.detectRetina&&De.retina?2:1,J=this.getTileSize();S.width=J.x*H,S.height=J.y*H,this.wmsParams=S},onAdd:function(p){this._crs=this.options.crs||p.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,vl.prototype.onAdd.call(this,p)},getTileUrl:function(p){var b=this._tileCoordsToNwSe(p),S=this._crs,A=X(S.project(b[0]),S.project(b[1])),H=A.min,J=A.max,de=(this._wmsVersion>=1.3&&this._crs===Fv?[H.y,H.x,J.y,J.x]:[H.x,H.y,J.x,J.y]).join(","),be=vl.prototype.getTileUrl.call(this,p);return be+g(this.wmsParams,be,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+de},setParams:function(p,b){return e(this.wmsParams,p),b||this.redraw(),this}});function lT(p,b){return new jv(p,b)}vl.WMS=jv,Uv.wms=lT;var ps=Ta.extend({options:{padding:.1},initialize:function(p){m(this,p),o(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ot(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var p={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(p.zoomanim=this._onAnimZoom),p},_onAnimZoom:function(p){this._updateTransform(p.center,p.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(p,b){var S=this._map.getZoomScale(b,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),H=this._map.project(this._center,b),J=A.multiplyBy(-S).add(H).subtract(this._map._getNewPixelOrigin(p,b));De.any3d?wa(this._container,J,S):$r(this._container,J)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var p in this._layers)this._layers[p]._reset()},_onZoomEnd:function(){for(var p in this._layers)this._layers[p]._project()},_updatePaths:function(){for(var p in this._layers)this._layers[p]._update()},_update:function(){var p=this.options.padding,b=this._map.getSize(),S=this._map.containerPointToLayerPoint(b.multiplyBy(-p)).round();this._bounds=new q(S,S.add(b.multiplyBy(1+p*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Yv=ps.extend({options:{tolerance:0},getEvents:function(){var p=ps.prototype.getEvents.call(this);return p.viewprereset=this._onViewPreReset,p},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ps.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var p=this._container=document.createElement("canvas");_t(p,"mousemove",this._onMouseMove,this),_t(p,"click dblclick mousedown mouseup contextmenu",this._onClick,this),_t(p,"mouseout",this._handleMouseOut,this),p._leaflet_disable_events=!0,this._ctx=p.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,xr(this._container),gr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var p;this._redrawBounds=null;for(var b in this._layers)p=this._layers[b],p._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ps.prototype._update.call(this);var p=this._bounds,b=this._container,S=p.getSize(),A=De.retina?2:1;$r(b,p.min),b.width=A*S.x,b.height=A*S.y,b.style.width=S.x+"px",b.style.height=S.y+"px",De.retina&&this._ctx.scale(2,2),this._ctx.translate(-p.min.x,-p.min.y),this.fire("update")}},_reset:function(){ps.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(p){this._updateDashArray(p),this._layers[o(p)]=p;var b=p._order={layer:p,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(p){this._requestRedraw(p)},_removePath:function(p){var b=p._order,S=b.next,A=b.prev;S?S.prev=A:this._drawLast=A,A?A.next=S:this._drawFirst=S,delete p._order,delete this._layers[o(p)],this._requestRedraw(p)},_updatePath:function(p){this._extendRedrawBounds(p),p._project(),p._update(),this._requestRedraw(p)},_updateStyle:function(p){this._updateDashArray(p),this._requestRedraw(p)},_updateDashArray:function(p){if(typeof p.options.dashArray=="string"){var b=p.options.dashArray.split(/[, ]+/),S=[],A,H;for(H=0;H<b.length;H++){if(A=Number(b[H]),isNaN(A))return;S.push(A)}p.options._dashArray=S}else p.options._dashArray=p.options.dashArray},_requestRedraw:function(p){this._map&&(this._extendRedrawBounds(p),this._redrawRequest=this._redrawRequest||R(this._redraw,this))},_extendRedrawBounds:function(p){if(p._pxBounds){var b=(p.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new q,this._redrawBounds.extend(p._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(p._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var p=this._redrawBounds;if(p){var b=p.getSize();this._ctx.clearRect(p.min.x,p.min.y,b.x,b.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var p,b=this._redrawBounds;if(this._ctx.save(),b){var S=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,S.x,S.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)p=A.layer,(!b||p._pxBounds&&p._pxBounds.intersects(b))&&p._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(p,b){if(this._drawing){var S,A,H,J,de=p._parts,be=de.length,ke=this._ctx;if(be){for(ke.beginPath(),S=0;S<be;S++){for(A=0,H=de[S].length;A<H;A++)J=de[S][A],ke[A?"lineTo":"moveTo"](J.x,J.y);b&&ke.closePath()}this._fillStroke(ke,p)}}},_updateCircle:function(p){if(!(!this._drawing||p._empty())){var b=p._point,S=this._ctx,A=Math.max(Math.round(p._radius),1),H=(Math.max(Math.round(p._radiusY),1)||A)/A;H!==1&&(S.save(),S.scale(1,H)),S.beginPath(),S.arc(b.x,b.y/H,A,0,Math.PI*2,!1),H!==1&&S.restore(),this._fillStroke(S,p)}},_fillStroke:function(p,b){var S=b.options;S.fill&&(p.globalAlpha=S.fillOpacity,p.fillStyle=S.fillColor||S.color,p.fill(S.fillRule||"evenodd")),S.stroke&&S.weight!==0&&(p.setLineDash&&p.setLineDash(b.options&&b.options._dashArray||[]),p.globalAlpha=S.opacity,p.lineWidth=S.weight,p.strokeStyle=S.color,p.lineCap=S.lineCap,p.lineJoin=S.lineJoin,p.stroke())},_onClick:function(p){for(var b=this._map.mouseEventToLayerPoint(p),S,A,H=this._drawFirst;H;H=H.next)S=H.layer,S.options.interactive&&S._containsPoint(b)&&(!(p.type==="click"||p.type==="preclick")||!this._map._draggableMoved(S))&&(A=S);this._fireEvent(A?[A]:!1,p)},_onMouseMove:function(p){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var b=this._map.mouseEventToLayerPoint(p);this._handleMouseHover(p,b)}},_handleMouseOut:function(p){var b=this._hoveredLayer;b&&(Br(this._container,"leaflet-interactive"),this._fireEvent([b],p,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(p,b){if(!this._mouseHoverThrottled){for(var S,A,H=this._drawFirst;H;H=H.next)S=H.layer,S.options.interactive&&S._containsPoint(b)&&(A=S);A!==this._hoveredLayer&&(this._handleMouseOut(p),A&&(ot(this._container,"leaflet-interactive"),this._fireEvent([A],p,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,p),this._mouseHoverThrottled=!0,setTimeout(n(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(p,b,S){this._map._fireDOMEvent(b,S||b.type,p)},_bringToFront:function(p){var b=p._order;if(b){var S=b.next,A=b.prev;if(S)S.prev=A;else return;A?A.next=S:S&&(this._drawFirst=S),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(p)}},_bringToBack:function(p){var b=p._order;if(b){var S=b.next,A=b.prev;if(A)A.next=S;else return;S?S.prev=A:A&&(this._drawLast=A),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(p)}}});function qv(p){return De.canvas?new Yv(p):null}var Gc=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(p){return document.createElement("<lvml:"+p+' class="lvml">')}}catch(p){}return function(p){return document.createElement("<"+p+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),cT={_initContainer:function(){this._container=Bt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ps.prototype._update.call(this),this.fire("update"))},_initPath:function(p){var b=p._container=Gc("shape");ot(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",p._path=Gc("path"),b.appendChild(p._path),this._updateStyle(p),this._layers[o(p)]=p},_addPath:function(p){var b=p._container;this._container.appendChild(b),p.options.interactive&&p.addInteractiveTarget(b)},_removePath:function(p){var b=p._container;xr(b),p.removeInteractiveTarget(b),delete this._layers[o(p)]},_updateStyle:function(p){var b=p._stroke,S=p._fill,A=p.options,H=p._container;H.stroked=!!A.stroke,H.filled=!!A.fill,A.stroke?(b||(b=p._stroke=Gc("stroke")),H.appendChild(b),b.weight=A.weight+"px",b.color=A.color,b.opacity=A.opacity,A.dashArray?b.dashStyle=E(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=A.lineCap.replace("butt","flat"),b.joinstyle=A.lineJoin):b&&(H.removeChild(b),p._stroke=null),A.fill?(S||(S=p._fill=Gc("fill")),H.appendChild(S),S.color=A.fillColor||A.color,S.opacity=A.fillOpacity):S&&(H.removeChild(S),p._fill=null)},_updateCircle:function(p){var b=p._point.round(),S=Math.round(p._radius),A=Math.round(p._radiusY||S);this._setPath(p,p._empty()?"M0 0":"AL "+b.x+","+b.y+" "+S+","+A+" 0,"+65535*360)},_setPath:function(p,b){p._path.v=b},_bringToFront:function(p){ba(p._container)},_bringToBack:function(p){za(p._container)}},Cd=De.vml?Gc:oe,Vc=ps.extend({_initContainer:function(){this._container=Cd("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Cd("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){xr(this._container),gr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ps.prototype._update.call(this);var p=this._bounds,b=p.getSize(),S=this._container;(!this._svgSize||!this._svgSize.equals(b))&&(this._svgSize=b,S.setAttribute("width",b.x),S.setAttribute("height",b.y)),$r(S,p.min),S.setAttribute("viewBox",[p.min.x,p.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(p){var b=p._path=Cd("path");p.options.className&&ot(b,p.options.className),p.options.interactive&&ot(b,"leaflet-interactive"),this._updateStyle(p),this._layers[o(p)]=p},_addPath:function(p){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(p._path),p.addInteractiveTarget(p._path)},_removePath:function(p){xr(p._path),p.removeInteractiveTarget(p._path),delete this._layers[o(p)]},_updatePath:function(p){p._project(),p._update()},_updateStyle:function(p){var b=p._path,S=p.options;b&&(S.stroke?(b.setAttribute("stroke",S.color),b.setAttribute("stroke-opacity",S.opacity),b.setAttribute("stroke-width",S.weight),b.setAttribute("stroke-linecap",S.lineCap),b.setAttribute("stroke-linejoin",S.lineJoin),S.dashArray?b.setAttribute("stroke-dasharray",S.dashArray):b.removeAttribute("stroke-dasharray"),S.dashOffset?b.setAttribute("stroke-dashoffset",S.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),S.fill?(b.setAttribute("fill",S.fillColor||S.color),b.setAttribute("fill-opacity",S.fillOpacity),b.setAttribute("fill-rule",S.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(p,b){this._setPath(p,he(p._parts,b))},_updateCircle:function(p){var b=p._point,S=Math.max(Math.round(p._radius),1),A=Math.max(Math.round(p._radiusY),1)||S,H="a"+S+","+A+" 0 1,0 ",J=p._empty()?"M0 0":"M"+(b.x-S)+","+b.y+H+S*2+",0 "+H+-S*2+",0 ";this._setPath(p,J)},_setPath:function(p,b){p._path.setAttribute("d",b)},_bringToFront:function(p){ba(p._path)},_bringToBack:function(p){za(p._path)}});De.vml&&Vc.include(cT);function Zv(p){return De.svg||De.vml?new Vc(p):null}$t.include({getRenderer:function(p){var b=p.options.renderer||this._getPaneRenderer(p.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this._createRenderer()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(p){if(p==="overlayPane"||p===void 0)return!1;var b=this._paneRenderers[p];return b===void 0&&(b=this._createRenderer({pane:p}),this._paneRenderers[p]=b),b},_createRenderer:function(p){return this.options.preferCanvas&&qv(p)||Zv(p)}});var Kv=Ks.extend({initialize:function(p,b){Ks.prototype.initialize.call(this,this._boundsToLatLngs(p),b)},setBounds:function(p){return this.setLatLngs(this._boundsToLatLngs(p))},_boundsToLatLngs:function(p){return p=j(p),[p.getSouthWest(),p.getNorthWest(),p.getNorthEast(),p.getSouthEast()]}});function uT(p,b){return new Kv(p,b)}Vc.create=Cd,Vc.pointsToPath=he,Wa.geometryToLayer=vd,Wa.coordsToLatLng=zc,Wa.coordsToLatLngs=ml,Wa.latLngToCoords=ap,Wa.latLngsToCoords=bd,Wa.getFeature=gl,Wa.asFeature=wd,$t.mergeOptions({boxZoom:!0});var Wc=Mn.extend({initialize:function(p){this._map=p,this._container=p._container,this._pane=p._panes.overlayPane,this._resetStateTimeout=0,p.on("unload",this._destroy,this)},addHooks:function(){_t(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){gr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){xr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(p){if(!p.shiftKey||p.which!==1&&p.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),hs(),zf(),this._startPoint=this._map.mouseEventToContainerPoint(p),_t(document,{contextmenu:To,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(p){this._moved||(this._moved=!0,this._box=Bt("div","leaflet-zoom-box",this._container),ot(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(p);var b=new q(this._point,this._startPoint),S=b.getSize();$r(this._box,b.min),this._box.style.width=S.x+"px",this._box.style.height=S.y+"px"},_finish:function(){this._moved&&(xr(this._box),Br(this._container,"leaflet-crosshair")),Ln(),Hf(),gr(document,{contextmenu:To,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(p){if(!(p.which!==1&&p.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(n(this._resetState,this),0);var b=new ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(p){p.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});$t.addInitHook("addHandler","boxZoom",Wc),$t.mergeOptions({doubleClickZoom:!0});var Xv=Mn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(p){var b=this._map,S=b.getZoom(),A=b.options.zoomDelta,H=p.originalEvent.shiftKey?S-A:S+A;b.options.doubleClickZoom==="center"?b.setZoom(H):b.setZoomAround(p.containerPoint,H)}});$t.addInitHook("addHandler","doubleClickZoom",Xv),$t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Jv=Mn.extend({addHooks:function(){if(!this._draggable){var p=this._map;this._draggable=new Ys(p._mapPane,p._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),p.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),p.on("zoomend",this._onZoomEnd,this),p.whenReady(this._onZoomEnd,this))}ot(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Br(this._map._container,"leaflet-grab"),Br(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var p=this._map;if(p._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=j(this._map.options.maxBounds);this._offsetLimit=X(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;p.fire("movestart").fire("dragstart"),p.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(p){if(this._map.options.inertia){var b=this._lastTime=+new Date,S=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(S),this._times.push(b),this._prunePositions(b)}this._map.fire("move",p).fire("drag",p)},_prunePositions:function(p){for(;this._positions.length>1&&p-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var p=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(p).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(p,b){return p-(p-b)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var p=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;p.x<b.min.x&&(p.x=this._viscousLimit(p.x,b.min.x)),p.y<b.min.y&&(p.y=this._viscousLimit(p.y,b.min.y)),p.x>b.max.x&&(p.x=this._viscousLimit(p.x,b.max.x)),p.y>b.max.y&&(p.y=this._viscousLimit(p.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(p)}},_onPreDragWrap:function(){var p=this._worldWidth,b=Math.round(p/2),S=this._initialWorldOffset,A=this._draggable._newPos.x,H=(A-b+S)%p+b-S,J=(A+b+S)%p-b-S,de=Math.abs(H+S)<Math.abs(J+S)?H:J;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=de},_onDragEnd:function(p){var b=this._map,S=b.options,A=!S.inertia||p.noInertia||this._times.length<2;if(b.fire("dragend",p),A)b.fire("moveend");else{this._prunePositions(+new Date);var H=this._lastPos.subtract(this._positions[0]),J=(this._lastTime-this._times[0])/1e3,de=S.easeLinearity,be=H.multiplyBy(de/J),ke=be.distanceTo([0,0]),Be=Math.min(S.inertiaMaxSpeed,ke),Ke=be.multiplyBy(Be/ke),dt=Be/(S.inertiaDeceleration*de),Ot=Ke.multiplyBy(-dt/2).round();!Ot.x&&!Ot.y?b.fire("moveend"):(Ot=b._limitOffset(Ot,b.options.maxBounds),R(function(){b.panBy(Ot,{duration:dt,easeLinearity:de,noMoveStart:!0,animate:!0})}))}}});$t.addInitHook("addHandler","dragging",Jv),$t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Qv=Mn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(p){this._map=p,this._setPanDelta(p.options.keyboardPanDelta),this._setZoomDelta(p.options.zoomDelta)},addHooks:function(){var p=this._map._container;p.tabIndex<=0&&(p.tabIndex="0"),_t(p,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),gr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var p=document.body,b=document.documentElement,S=p.scrollTop||b.scrollTop,A=p.scrollLeft||b.scrollLeft;this._map._container.focus(),window.scrollTo(A,S)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(p){var b=this._panKeys={},S=this.keyCodes,A,H;for(A=0,H=S.left.length;A<H;A++)b[S.left[A]]=[-1*p,0];for(A=0,H=S.right.length;A<H;A++)b[S.right[A]]=[p,0];for(A=0,H=S.down.length;A<H;A++)b[S.down[A]]=[0,p];for(A=0,H=S.up.length;A<H;A++)b[S.up[A]]=[0,-1*p]},_setZoomDelta:function(p){var b=this._zoomKeys={},S=this.keyCodes,A,H;for(A=0,H=S.zoomIn.length;A<H;A++)b[S.zoomIn[A]]=p;for(A=0,H=S.zoomOut.length;A<H;A++)b[S.zoomOut[A]]=-p},_addHooks:function(){_t(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){gr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(p){if(!(p.altKey||p.ctrlKey||p.metaKey)){var b=p.keyCode,S=this._map,A;if(b in this._panKeys){if(!S._panAnim||!S._panAnim._inProgress)if(A=this._panKeys[b],p.shiftKey&&(A=Z(A).multiplyBy(3)),S.options.maxBounds&&(A=S._limitOffset(Z(A),S.options.maxBounds)),S.options.worldCopyJump){var H=S.wrapLatLng(S.unproject(S.project(S.getCenter()).add(A)));S.panTo(H)}else S.panBy(A)}else if(b in this._zoomKeys)S.setZoom(S.getZoom()+(p.shiftKey?3:1)*this._zoomKeys[b]);else if(b===27&&S._popup&&S._popup.options.closeOnEscapeKey)S.closePopup();else return;To(p)}}});$t.addInitHook("addHandler","keyboard",Qv),$t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ey=Mn.extend({addHooks:function(){_t(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){gr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(p){var b=dd(p),S=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(p),this._startTime||(this._startTime=+new Date);var A=Math.max(S-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(n(this._performZoom,this),A),To(p)},_performZoom:function(){var p=this._map,b=p.getZoom(),S=this._map.options.zoomSnap||0;p._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),H=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,J=S?Math.ceil(H/S)*S:H,de=p._limitZoom(b+(this._delta>0?J:-J))-b;this._delta=0,this._startTime=null,de&&(p.options.scrollWheelZoom==="center"?p.setZoom(b+de):p.setZoomAround(this._lastMousePos,b+de))}});$t.addInitHook("addHandler","scrollWheelZoom",ey);var dT=600;$t.mergeOptions({tapHold:De.touchNative&&De.safari&&De.mobile,tapTolerance:15});var ty=Mn.extend({addHooks:function(){_t(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){gr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(p){if(clearTimeout(this._holdTimeout),p.touches.length===1){var b=p.touches[0];this._startPos=this._newPos=new Y(b.clientX,b.clientY),this._holdTimeout=setTimeout(n(function(){this._cancel(),this._isTapValid()&&(_t(document,"touchend",ki),_t(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",b))},this),dT),_t(document,"touchend touchcancel contextmenu",this._cancel,this),_t(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function p(){gr(document,"touchend",ki),gr(document,"touchend touchcancel",p)},_cancel:function(){clearTimeout(this._holdTimeout),gr(document,"touchend touchcancel contextmenu",this._cancel,this),gr(document,"touchmove",this._onMove,this)},_onMove:function(p){var b=p.touches[0];this._newPos=new Y(b.clientX,b.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(p,b){var S=new MouseEvent(p,{bubbles:!0,cancelable:!0,view:window,screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY});S._simulated=!0,b.target.dispatchEvent(S)}});$t.addInitHook("addHandler","tapHold",ty),$t.mergeOptions({touchZoom:De.touch,bounceAtZoomLimits:!0});var ry=Mn.extend({addHooks:function(){ot(this._map._container,"leaflet-touch-zoom"),_t(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Br(this._map._container,"leaflet-touch-zoom"),gr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(p){var b=this._map;if(!(!p.touches||p.touches.length!==2||b._animatingZoom||this._zooming)){var S=b.mouseEventToContainerPoint(p.touches[0]),A=b.mouseEventToContainerPoint(p.touches[1]);this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),b.options.touchZoom!=="center"&&(this._pinchStartLatLng=b.containerPointToLatLng(S.add(A)._divideBy(2))),this._startDist=S.distanceTo(A),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),_t(document,"touchmove",this._onTouchMove,this),_t(document,"touchend touchcancel",this._onTouchEnd,this),ki(p)}},_onTouchMove:function(p){if(!(!p.touches||p.touches.length!==2||!this._zooming)){var b=this._map,S=b.mouseEventToContainerPoint(p.touches[0]),A=b.mouseEventToContainerPoint(p.touches[1]),H=S.distanceTo(A)/this._startDist;if(this._zoom=b.getScaleZoom(H,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&H<1||this._zoom>b.getMaxZoom()&&H>1)&&(this._zoom=b._limitZoom(this._zoom)),b.options.touchZoom==="center"){if(this._center=this._startLatLng,H===1)return}else{var J=S._add(A)._divideBy(2)._subtract(this._centerPoint);if(H===1&&J.x===0&&J.y===0)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(J),this._zoom)}this._moved||(b._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var de=n(b._move,b,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=R(de,this,!0),ki(p)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),gr(document,"touchmove",this._onTouchMove,this),gr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});$t.addInitHook("addHandler","touchZoom",ry),$t.BoxZoom=Wc,$t.DoubleClickZoom=Xv,$t.Drag=Jv,$t.Keyboard=Qv,$t.ScrollWheelZoom=ey,$t.TapHold=ty,$t.TouchZoom=ry,a.Bounds=q,a.Browser=De,a.CRS=ne,a.Canvas=Yv,a.Circle=np,a.CircleMarker=Zs,a.Class=k,a.Control=Ea,a.DivIcon=op,a.DivOverlay=ii,a.DomEvent=WE,a.DomUtil=Cv,a.Draggable=Ys,a.Evented=W,a.FeatureGroup=fs,a.GeoJSON=Wa,a.GridLayer=Hc,a.Handler=Mn,a.Icon=Kt,a.ImageOverlay=Ed,a.LatLng=K,a.LatLngBounds=ie,a.Layer=Ta,a.LayerGroup=pl,a.LineUtil=fl,a.Map=$t,a.Marker=md,a.Mixin=js,a.Path=qs,a.Point=Y,a.PolyUtil=qE,a.Polygon=Ks,a.Polyline=Kn,a.Popup=Ua,a.PosAnimation=Zf,a.Projection=XE,a.Rectangle=Kv,a.Renderer=ps,a.SVG=Vc,a.SVGOverlay=Hv,a.TileLayer=vl,a.Tooltip=Td,a.Transformation=Te,a.Util=$,a.VideoOverlay=$v,a.bind=n,a.bounds=X,a.canvas=qv,a.circle=rT,a.circleMarker=tT,a.control=Oc,a.divIcon=oT,a.extend=e,a.featureGroup=Nv,a.geoJSON=Bv,a.geoJson=nT,a.gridLayer=Wv,a.icon=QE,a.imageOverlay=aT,a.latLng=se,a.latLngBounds=j,a.layerGroup=Rv,a.map=UE,a.marker=eT,a.point=Z,a.polygon=iT,a.polyline=gd,a.popup=Gv,a.rectangle=uT,a.setOptions=m,a.stamp=o,a.svg=Zv,a.svgOverlay=sT,a.tileLayer=Uv,a.tooltip=Vv,a.transformation=me,a.version=t,a.videoOverlay=zv;var hT=window.L;a.noConflict=function(){return window.L=hT,this},window.L=a}))});var Po,hy,fy,py,ms,kd,mi,gs,El=_e(()=>{Po=class extends Error{},hy=class extends Po{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}},fy=class extends Po{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}},py=class extends Po{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}},ms=class extends Po{},kd=class extends Po{constructor(t){super(`Invalid unit ${t}`)}},mi=class extends Po{},gs=class extends Po{constructor(){super("Zone is an abstract class")}}});var je,vs,_a,Tl,cp,kT,up,dp,hp,fp,pp,mp,gp,vp,yp,bp,wp,Ep,Tp,Cp,DT,_p,Sp,xp,kp,Dp=_e(()=>{je="numeric",vs="short",_a="long",Tl={year:je,month:je,day:je},cp={year:je,month:vs,day:je},kT={year:je,month:vs,day:je,weekday:vs},up={year:je,month:_a,day:je},dp={year:je,month:_a,day:je,weekday:_a},hp={hour:je,minute:je},fp={hour:je,minute:je,second:je},pp={hour:je,minute:je,second:je,timeZoneName:vs},mp={hour:je,minute:je,second:je,timeZoneName:_a},gp={hour:je,minute:je,hourCycle:"h23"},vp={hour:je,minute:je,second:je,hourCycle:"h23"},yp={hour:je,minute:je,second:je,hourCycle:"h23",timeZoneName:vs},bp={hour:je,minute:je,second:je,hourCycle:"h23",timeZoneName:_a},wp={year:je,month:je,day:je,hour:je,minute:je},Ep={year:je,month:je,day:je,hour:je,minute:je,second:je},Tp={year:je,month:vs,day:je,hour:je,minute:je},Cp={year:je,month:vs,day:je,hour:je,minute:je,second:je},DT={year:je,month:vs,day:je,weekday:vs,hour:je,minute:je},_p={year:je,month:_a,day:je,hour:je,minute:je,timeZoneName:vs},Sp={year:je,month:_a,day:je,hour:je,minute:je,second:je,timeZoneName:vs},xp={year:je,month:_a,day:je,weekday:_a,hour:je,minute:je,timeZoneName:_a},kp={year:je,month:_a,day:je,weekday:_a,hour:je,minute:je,second:je,timeZoneName:_a}});var Jn,jc=_e(()=>{El();Jn=class{get type(){throw new gs}get name(){throw new gs}get ianaName(){return this.name}get isUniversal(){throw new gs}offsetName(t,e){throw new gs}formatOffset(t,e){throw new gs}offset(t){throw new gs}equals(t){throw new gs}get isValid(){throw new gs}}});var PT,Cl,gy=_e(()=>{An();jc();PT=null,Cl=class a extends Jn{static get instance(){return PT===null&&(PT=new a),PT}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(t,{format:e,locale:r}){return vy(t,e,r)}formatOffset(t,e){return _l(this.offset(t),e)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return t.type==="system"}get isValid(){return!0}}});function cU(a){return by[a]||(by[a]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:a,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),by[a]}function dU(a,t){let e=a.format(t).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(e),[,n,s,o,l,c,u,d]=r;return[o,n,s,l,c,u,d]}function hU(a,t){let e=a.formatToParts(t),r=[];for(let n=0;n<e.length;n++){let{type:s,value:o}=e[n],l=uU[s];s==="era"?r[l]=o:ht(l)||(r[l]=parseInt(o,10))}return r}var by,uU,yy,hn,Sl=_e(()=>{An();jc();by={};uU={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};yy={},hn=class a extends Jn{static create(t){return yy[t]||(yy[t]=new a(t)),yy[t]}static resetCache(){yy={},by={}}static isValidSpecifier(t){return this.isValidZone(t)}static isValidZone(t){if(!t)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch(e){return!1}}constructor(t){super(),this.zoneName=t,this.valid=a.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(t,{format:e,locale:r}){return vy(t,e,r,this.name)}formatOffset(t,e){return _l(this.offset(t),e)}offset(t){let e=new Date(t);if(isNaN(e))return NaN;let r=cU(this.name),[n,s,o,l,c,u,d]=r.formatToParts?hU(r,e):dU(r,e);l==="BC"&&(n=-Math.abs(n)+1);let f=Dd({year:n,month:s,day:o,hour:c===24?0:c,minute:u,second:d,millisecond:0}),m=+e,g=m%1e3;return m-=g>=0?g:1e3+g,(f-m)/(60*1e3)}equals(t){return t.type==="iana"&&t.name===this.name}get isValid(){return this.valid}}});function fU(a,t={}){let e=JSON.stringify([a,t]),r=FP[e];return r||(r=new Intl.ListFormat(a,t),FP[e]=r),r}function MT(a,t={}){let e=JSON.stringify([a,t]),r=LT[e];return r||(r=new Intl.DateTimeFormat(a,t),LT[e]=r),r}function pU(a,t={}){let e=JSON.stringify([a,t]),r=IT[e];return r||(r=new Intl.NumberFormat(a,t),IT[e]=r),r}function mU(a,t={}){let{base:e,...r}=t,n=JSON.stringify([a,r]),s=AT[n];return s||(s=new Intl.RelativeTimeFormat(a,t),AT[n]=s),s}function gU(){return Pp||(Pp=new Intl.DateTimeFormat().resolvedOptions().locale,Pp)}function vU(a){let t=RP[a];if(!t){let e=new Intl.Locale(a);t="getWeekInfo"in e?e.getWeekInfo():e.weekInfo,RP[a]=t}return t}function yU(a){let t=a.indexOf("-x-");t!==-1&&(a=a.substring(0,t));let e=a.indexOf("-u-");if(e===-1)return[a];{let r,n;try{r=MT(a).resolvedOptions(),n=a}catch(l){let c=a.substring(0,e);r=MT(c).resolvedOptions(),n=c}let{numberingSystem:s,calendar:o}=r;return[n,s,o]}}function bU(a,t,e){return(e||t)&&(a.includes("-u-")||(a+="-u"),e&&(a+=`-ca-${e}`),t&&(a+=`-nu-${t}`)),a}function wU(a){let t=[];for(let e=1;e<=12;e++){let r=gt.utc(2009,e,1);t.push(a(r))}return t}function EU(a){let t=[];for(let e=1;e<=7;e++){let r=gt.utc(2016,11,13+e);t.push(a(r))}return t}function wy(a,t,e,r){let n=a.listingMode();return n==="error"?null:n==="en"?e(t):r(t)}function TU(a){return a.numberingSystem&&a.numberingSystem!=="latn"?!1:a.numberingSystem==="latn"||!a.locale||a.locale.startsWith("en")||new Intl.DateTimeFormat(a.intl).resolvedOptions().numberingSystem==="latn"}var FP,LT,IT,AT,Pp,RP,OT,FT,RT,CU,nr,Mp=_e(()=>{An();Cy();xl();Yc();Sl();FP={};LT={};IT={};AT={};Pp=null;RP={};OT=class{constructor(t,e,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;let{padTo:n,floor:s,...o}=r;if(!e||Object.keys(o).length>0){let l={useGrouping:!1,...r};r.padTo>0&&(l.minimumIntegerDigits=r.padTo),this.inf=pU(t,l)}}format(t){if(this.inf){let e=this.floor?Math.floor(t):t;return this.inf.format(e)}else{let e=this.floor?Math.floor(t):Pd(t,3);return Xr(e,this.padTo)}}},FT=class{constructor(t,e,r){this.opts=r,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=t;else if(t.zone.type==="fixed"){let o=-1*(t.offset/60),l=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;t.offset!==0&&hn.create(l).valid?(n=l,this.dt=t):(n="UTC",this.dt=t.offset===0?t:t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone)}else t.zone.type==="system"?this.dt=t:t.zone.type==="iana"?(this.dt=t,n=t.zone.name):(n="UTC",this.dt=t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone);let s={...this.opts};s.timeZone=s.timeZone||n,this.dtf=MT(e,s)}format(){return this.originalZone?this.formatToParts().map(({value:t})=>t).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){let t=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?t.map(e=>{if(e.type==="timeZoneName"){let r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...e,value:r}}else return e}):t}resolvedOptions(){return this.dtf.resolvedOptions()}},RT=class{constructor(t,e,r){this.opts={style:"long",...r},!e&&Ey()&&(this.rtf=mU(t,r))}format(t,e){return this.rtf?this.rtf.format(t,e):NP(e,t,this.opts.numeric,this.opts.style!=="long")}formatToParts(t,e){return this.rtf?this.rtf.formatToParts(t,e):[]}},CU={firstDay:1,minimalDays:4,weekend:[6,7]},nr=class a{static fromOpts(t){return a.create(t.locale,t.numberingSystem,t.outputCalendar,t.weekSettings,t.defaultToEN)}static create(t,e,r,n,s=!1){let o=t||er.defaultLocale,l=o||(s?"en-US":gU()),c=e||er.defaultNumberingSystem,u=r||er.defaultOutputCalendar,d=Lp(n)||er.defaultWeekSettings;return new a(l,c,u,d,o)}static resetCache(){Pp=null,LT={},IT={},AT={}}static fromObject({locale:t,numberingSystem:e,outputCalendar:r,weekSettings:n}={}){return a.create(t,e,r,n)}constructor(t,e,r,n,s){let[o,l,c]=yU(t);this.locale=o,this.numberingSystem=e||l||null,this.outputCalendar=r||c||null,this.weekSettings=n,this.intl=bU(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=TU(this)),this.fastNumbersCached}listingMode(){let t=this.isEnglish(),e=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return t&&e?"en":"intl"}clone(t){return!t||Object.getOwnPropertyNames(t).length===0?this:a.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,Lp(t.weekSettings)||this.weekSettings,t.defaultToEN||!1)}redefaultToEN(t={}){return this.clone({...t,defaultToEN:!0})}redefaultToSystem(t={}){return this.clone({...t,defaultToEN:!1})}months(t,e=!1){return wy(this,t,NT,()=>{let r=e?{month:t,day:"numeric"}:{month:t},n=e?"format":"standalone";return this.monthsCache[n][t]||(this.monthsCache[n][t]=wU(s=>this.extract(s,r,"month"))),this.monthsCache[n][t]})}weekdays(t,e=!1){return wy(this,t,BT,()=>{let r=e?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},n=e?"format":"standalone";return this.weekdaysCache[n][t]||(this.weekdaysCache[n][t]=EU(s=>this.extract(s,r,"weekday"))),this.weekdaysCache[n][t]})}meridiems(){return wy(this,void 0,()=>$T,()=>{if(!this.meridiemCache){let t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[gt.utc(2016,11,13,9),gt.utc(2016,11,13,19)].map(e=>this.extract(e,t,"dayperiod"))}return this.meridiemCache})}eras(t){return wy(this,t,zT,()=>{let e={era:t};return this.eraCache[t]||(this.eraCache[t]=[gt.utc(-40,1,1),gt.utc(2017,1,1)].map(r=>this.extract(r,e,"era"))),this.eraCache[t]})}extract(t,e,r){let n=this.dtFormatter(t,e),s=n.formatToParts(),o=s.find(l=>l.type.toLowerCase()===r);return o?o.value:null}numberFormatter(t={}){return new OT(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,e={}){return new FT(t,this.intl,e)}relFormatter(t={}){return new RT(this.intl,this.isEnglish(),t)}listFormatter(t={}){return fU(this.intl,t)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Ty()?vU(this.locale):CU}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}}});var GT,zi,Ld=_e(()=>{An();jc();GT=null,zi=class a extends Jn{static get utcInstance(){return GT===null&&(GT=new a(0)),GT}static instance(t){return t===0?a.utcInstance:new a(t)}static parseSpecifier(t){if(t){let e=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(e)return new a(qc(e[1],e[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${_l(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${_l(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,e){return _l(this.fixed,e)}get isUniversal(){return!0}offset(){return this.fixed}equals(t){return t.type==="fixed"&&t.fixed===this.fixed}get isValid(){return!0}}});var Md,VT=_e(()=>{jc();Md=class extends Jn{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}});function ys(a,t){let e;if(ht(a)||a===null)return t;if(a instanceof Jn)return a;if(BP(a)){let r=a.toLowerCase();return r==="default"?t:r==="local"||r==="system"?Cl.instance:r==="utc"||r==="gmt"?zi.utcInstance:zi.parseSpecifier(r)||hn.create(a)}else return Xs(a)?zi.instance(a):typeof a=="object"&&"offset"in a&&typeof a.offset=="function"?a:new Md(a)}var _y=_e(()=>{jc();Sl();Ld();VT();An();gy()});var $P,zP,HP,GP,VP,WP,UP,jP,er,xl=_e(()=>{gy();Sl();Mp();_y();An();$P=()=>Date.now(),zP="system",HP=null,GP=null,VP=null,WP=60,jP=null,er=class{static get now(){return $P}static set now(t){$P=t}static set defaultZone(t){zP=t}static get defaultZone(){return ys(zP,Cl.instance)}static get defaultLocale(){return HP}static set defaultLocale(t){HP=t}static get defaultNumberingSystem(){return GP}static set defaultNumberingSystem(t){GP=t}static get defaultOutputCalendar(){return VP}static set defaultOutputCalendar(t){VP=t}static get defaultWeekSettings(){return jP}static set defaultWeekSettings(t){jP=Lp(t)}static get twoDigitCutoffYear(){return WP}static set twoDigitCutoffYear(t){WP=t%100}static get throwOnInvalid(){return UP}static set throwOnInvalid(t){UP=t}static resetCaches(){nr.resetCache(),hn.resetCache()}}});var Hi,Ip=_e(()=>{Hi=class{constructor(t,e){this.reason=t,this.explanation=e}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}});function ja(a,t){return new Hi("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${a}, which is invalid`)}function Sy(a,t,e){let r=new Date(Date.UTC(a,t-1,e));a<100&&a>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);let n=r.getUTCDay();return n===0?7:n}function ZP(a,t,e){return e+(Kc(a)?qP:YP)[t-1]}function KP(a,t){let e=Kc(a)?qP:YP,r=e.findIndex(s=>s<t),n=t-e[r];return{month:r+1,day:n}}function xy(a,t){return(a-t+7)%7+1}function Ap(a,t=4,e=1){let{year:r,month:n,day:s}=a,o=ZP(r,n,s),l=xy(Sy(r,n,s),e),c=Math.floor((o-l+14-t)/7),u;return c<1?(u=r-1,c=Zc(u,t,e)):c>Zc(r,t,e)?(u=r+1,c=1):u=r,{weekYear:u,weekNumber:c,weekday:l,...Fp(a)}}function WT(a,t=4,e=1){let{weekYear:r,weekNumber:n,weekday:s}=a,o=xy(Sy(r,1,t),e),l=kl(r),c=n*7+s-o-7+t,u;c<1?(u=r-1,c+=kl(u)):c>l?(u=r+1,c-=kl(r)):u=r;let{month:d,day:h}=KP(u,c);return{year:u,month:d,day:h,...Fp(a)}}function ky(a){let{year:t,month:e,day:r}=a,n=ZP(t,e,r);return{year:t,ordinal:n,...Fp(a)}}function UT(a){let{year:t,ordinal:e}=a,{month:r,day:n}=KP(t,e);return{year:t,month:r,day:n,...Fp(a)}}function jT(a,t){if(!ht(a.localWeekday)||!ht(a.localWeekNumber)||!ht(a.localWeekYear)){if(!ht(a.weekday)||!ht(a.weekNumber)||!ht(a.weekYear))throw new ms("Cannot mix locale-based week fields with ISO-based week fields");return ht(a.localWeekday)||(a.weekday=a.localWeekday),ht(a.localWeekNumber)||(a.weekNumber=a.localWeekNumber),ht(a.localWeekYear)||(a.weekYear=a.localWeekYear),delete a.localWeekday,delete a.localWeekNumber,delete a.localWeekYear,{minDaysInFirstWeek:t.getMinDaysInFirstWeek(),startOfWeek:t.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function XP(a,t=4,e=1){let r=Op(a.weekYear),n=Sa(a.weekNumber,1,Zc(a.weekYear,t,e)),s=Sa(a.weekday,1,7);return r?n?s?!1:ja("weekday",a.weekday):ja("week",a.weekNumber):ja("weekYear",a.weekYear)}function JP(a){let t=Op(a.year),e=Sa(a.ordinal,1,kl(a.year));return t?e?!1:ja("ordinal",a.ordinal):ja("year",a.year)}function YT(a){let t=Op(a.year),e=Sa(a.month,1,12),r=Sa(a.day,1,Id(a.year,a.month));return t?e?r?!1:ja("day",a.day):ja("month",a.month):ja("year",a.year)}function qT(a){let{hour:t,minute:e,second:r,millisecond:n}=a,s=Sa(t,0,23)||t===24&&e===0&&r===0&&n===0,o=Sa(e,0,59),l=Sa(r,0,59),c=Sa(n,0,999);return s?o?l?c?!1:ja("millisecond",n):ja("second",r):ja("minute",e):ja("hour",t)}var YP,qP,ZT=_e(()=>{An();Ip();El();YP=[0,31,59,90,120,151,181,212,243,273,304,334],qP=[0,31,60,91,121,152,182,213,244,274,305,335]});function ht(a){return typeof a=="undefined"}function Xs(a){return typeof a=="number"}function Op(a){return typeof a=="number"&&a%1===0}function BP(a){return typeof a=="string"}function eL(a){return Object.prototype.toString.call(a)==="[object Date]"}function Ey(){try{return typeof Intl!="undefined"&&!!Intl.RelativeTimeFormat}catch(a){return!1}}function Ty(){try{return typeof Intl!="undefined"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch(a){return!1}}function tL(a){return Array.isArray(a)?a:[a]}function KT(a,t,e){if(a.length!==0)return a.reduce((r,n)=>{let s=[t(n),n];return r&&e(r[0],s[0])===r[0]?r:s},null)[1]}function rL(a,t){return t.reduce((e,r)=>(e[r]=a[r],e),{})}function Dl(a,t){return Object.prototype.hasOwnProperty.call(a,t)}function Lp(a){if(a==null)return null;if(typeof a!="object")throw new mi("Week settings must be an object");if(!Sa(a.firstDay,1,7)||!Sa(a.minimalDays,1,7)||!Array.isArray(a.weekend)||a.weekend.some(t=>!Sa(t,1,7)))throw new mi("Invalid week settings");return{firstDay:a.firstDay,minimalDays:a.minimalDays,weekend:Array.from(a.weekend)}}function Sa(a,t,e){return Op(a)&&a>=t&&a<=e}function _U(a,t){return a-t*Math.floor(a/t)}function Xr(a,t=2){let e=a<0,r;return e?r="-"+(""+-a).padStart(t,"0"):r=(""+a).padStart(t,"0"),r}function Lo(a){if(!(ht(a)||a===null||a===""))return parseInt(a,10)}function Pl(a){if(!(ht(a)||a===null||a===""))return parseFloat(a)}function Rp(a){if(!(ht(a)||a===null||a==="")){let t=parseFloat("0."+a)*1e3;return Math.floor(t)}}function Pd(a,t,e=!1){let r=10**t;return(e?Math.trunc:Math.round)(a*r)/r}function Kc(a){return a%4===0&&(a%100!==0||a%400===0)}function kl(a){return Kc(a)?366:365}function Id(a,t){let e=_U(t-1,12)+1,r=a+(t-e)/12;return e===2?Kc(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][e-1]}function Dd(a){let t=Date.UTC(a.year,a.month-1,a.day,a.hour,a.minute,a.second,a.millisecond);return a.year<100&&a.year>=0&&(t=new Date(t),t.setUTCFullYear(a.year,a.month-1,a.day)),+t}function QP(a,t,e){return-xy(Sy(a,1,t),e)+t-1}function Zc(a,t=4,e=1){let r=QP(a,t,e),n=QP(a+1,t,e);return(kl(a)-r+n)/7}function Np(a){return a>99?a:a>er.twoDigitCutoffYear?1900+a:2e3+a}function vy(a,t,e,r=null){let n=new Date(a),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(s.timeZone=r);let o={timeZoneName:t,...s},l=new Intl.DateTimeFormat(e,o).formatToParts(n).find(c=>c.type.toLowerCase()==="timezonename");return l?l.value:null}function qc(a,t){let e=parseInt(a,10);Number.isNaN(e)&&(e=0);let r=parseInt(t,10)||0,n=e<0||Object.is(e,-0)?-r:r;return e*60+n}function XT(a){let t=Number(a);if(typeof a=="boolean"||a===""||Number.isNaN(t))throw new mi(`Invalid unit value ${a}`);return t}function Ad(a,t){let e={};for(let r in a)if(Dl(a,r)){let n=a[r];if(n==null)continue;e[t(r)]=XT(n)}return e}function _l(a,t){let e=Math.trunc(Math.abs(a/60)),r=Math.trunc(Math.abs(a%60)),n=a>=0?"+":"-";switch(t){case"short":return`${n}${Xr(e,2)}:${Xr(r,2)}`;case"narrow":return`${n}${e}${r>0?`:${r}`:""}`;case"techie":return`${n}${Xr(e,2)}${Xr(r,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function Fp(a){return rL(a,["hour","minute","second","millisecond"])}var An=_e(()=>{El();xl();ZT()});function NT(a){switch(a){case"narrow":return[...xU];case"short":return[...JT];case"long":return[...SU];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}function BT(a){switch(a){case"narrow":return[...kU];case"short":return[...eC];case"long":return[...QT];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}function zT(a){switch(a){case"narrow":return[...LU];case"short":return[...PU];case"long":return[...DU];default:return null}}function iL(a){return $T[a.hour<12?0:1]}function nL(a,t){return BT(t)[a.weekday-1]}function aL(a,t){return NT(t)[a.month-1]}function sL(a,t){return zT(t)[a.year<0?0:1]}function NP(a,t,e="always",r=!1){let n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(a)===-1;if(e==="auto"&&s){let h=a==="days";switch(t){case 1:return h?"tomorrow":`next ${n[a][0]}`;case-1:return h?"yesterday":`last ${n[a][0]}`;case 0:return h?"today":`this ${n[a][0]}`;default:}}let o=Object.is(t,-0)||t<0,l=Math.abs(t),c=l===1,u=n[a],d=r?c?u[1]:u[2]||u[1]:c?n[a][0]:a;return o?`${l} ${d} ago`:`in ${l} ${d}`}var SU,JT,xU,QT,eC,kU,$T,DU,PU,LU,Cy=_e(()=>{Dp();An();SU=["January","February","March","April","May","June","July","August","September","October","November","December"],JT=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],xU=["J","F","M","A","M","J","J","A","S","O","N","D"];QT=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],eC=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],kU=["M","T","W","T","F","S","S"];$T=["AM","PM"],DU=["Before Christ","Anno Domini"],PU=["BC","AD"],LU=["B","A"]});function oL(a,t){let e="";for(let r of a)r.literal?e+=r.val:e+=t(r.val);return e}var MU,Gi,Bp=_e(()=>{Cy();Dp();An();MU={D:Tl,DD:cp,DDD:up,DDDD:dp,t:hp,tt:fp,ttt:pp,tttt:mp,T:gp,TT:vp,TTT:yp,TTTT:bp,f:wp,ff:Tp,fff:_p,ffff:xp,F:Ep,FF:Cp,FFF:Sp,FFFF:kp},Gi=class a{static create(t,e={}){return new a(t,e)}static parseFormat(t){let e=null,r="",n=!1,s=[];for(let o=0;o<t.length;o++){let l=t.charAt(o);l==="'"?(r.length>0&&s.push({literal:n||/^\s+$/.test(r),val:r}),e=null,r="",n=!n):n||l===e?r+=l:(r.length>0&&s.push({literal:/^\s+$/.test(r),val:r}),r=l,e=l)}return r.length>0&&s.push({literal:n||/^\s+$/.test(r),val:r}),s}static macroTokenToFormatOpts(t){return MU[t]}constructor(t,e){this.opts=e,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,e){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,{...this.opts,...e}).format()}dtFormatter(t,e={}){return this.loc.dtFormatter(t,{...this.opts,...e})}formatDateTime(t,e){return this.dtFormatter(t,e).format()}formatDateTimeParts(t,e){return this.dtFormatter(t,e).formatToParts()}formatInterval(t,e){return this.dtFormatter(t.start,e).dtf.formatRange(t.start.toJSDate(),t.end.toJSDate())}resolvedOptions(t,e){return this.dtFormatter(t,e).resolvedOptions()}num(t,e=0){if(this.opts.forceSimple)return Xr(t,e);let r={...this.opts};return e>0&&(r.padTo=e),this.loc.numberFormatter(r).format(t)}formatDateTimeFromString(t,e){let r=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(m,g)=>this.loc.extract(t,m,g),o=m=>t.isOffsetFixed&&t.offset===0&&m.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,m.format):"",l=()=>r?iL(t):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),c=(m,g)=>r?aL(t,m):s(g?{month:m}:{month:m,day:"numeric"},"month"),u=(m,g)=>r?nL(t,m):s(g?{weekday:m}:{weekday:m,month:"long",day:"numeric"},"weekday"),d=m=>{let g=a.macroTokenToFormatOpts(m);return g?this.formatWithSystemDefault(t,g):m},h=m=>r?sL(t,m):s({era:m},"era"),f=m=>{switch(m){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"uu":return this.num(Math.floor(t.millisecond/10),2);case"uuu":return this.num(Math.floor(t.millisecond/100));case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12===0?12:t.hour%12);case"hh":return this.num(t.hour%12===0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return l();case"d":return n?s({day:"numeric"},"day"):this.num(t.day);case"dd":return n?s({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return u("short",!0);case"cccc":return u("long",!0);case"ccccc":return u("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return u("short",!1);case"EEEE":return u("long",!1);case"EEEEE":return u("narrow",!1);case"L":return n?s({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return n?s({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return c("short",!0);case"LLLL":return c("long",!0);case"LLLLL":return c("narrow",!0);case"M":return n?s({month:"numeric"},"month"):this.num(t.month);case"MM":return n?s({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return c("short",!1);case"MMMM":return c("long",!1);case"MMMMM":return c("narrow",!1);case"y":return n?s({year:"numeric"},"year"):this.num(t.year);case"yy":return n?s({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return n?s({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return n?s({year:"numeric"},"year"):this.num(t.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"n":return this.num(t.localWeekNumber);case"nn":return this.num(t.localWeekNumber,2);case"ii":return this.num(t.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(t.localWeekYear,4);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return d(m)}};return oL(a.parseFormat(e),f)}formatDurationFromString(t,e){let r=c=>{switch(c[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=c=>u=>{let d=r(u);return d?this.num(c.get(d),u.length):u},s=a.parseFormat(e),o=s.reduce((c,{literal:u,val:d})=>u?c:c.concat(d),[]),l=t.shiftTo(...o.map(r).filter(c=>c));return oL(s,n(l))}}});function Fd(...a){let t=a.reduce((e,r)=>e+r.source,"");return RegExp(`^${t}$`)}function Rd(...a){return t=>a.reduce(([e,r,n],s)=>{let[o,l,c]=s(t,n);return[{...e,...o},l||r,c]},[{},null,1]).slice(0,2)}function Nd(a,...t){if(a==null)return[null,null];for(let[e,r]of t){let n=e.exec(a);if(n)return r(n)}return[null,null]}function uL(...a){return(t,e)=>{let r={},n;for(n=0;n<a.length;n++)r[a[n]]=Lo(t[e+n]);return[r,null,e+n]}}function Od(a,t,e){let r=a[t];return ht(r)?e:Lo(r)}function zU(a,t){return[{year:Od(a,t),month:Od(a,t+1,1),day:Od(a,t+2,1)},null,t+3]}function Bd(a,t){return[{hours:Od(a,t,0),minutes:Od(a,t+1,0),seconds:Od(a,t+2,0),milliseconds:Rp(a[t+3])},null,t+4]}function $p(a,t){let e=!a[t]&&!a[t+1],r=qc(a[t+1],a[t+2]),n=e?null:zi.instance(r);return[{},n,t+3]}function zp(a,t){let e=a[t]?hn.create(a[t]):null;return[{},e,t+1]}function VU(a){let[t,e,r,n,s,o,l,c,u]=a,d=t[0]==="-",h=c&&c[0]==="-",f=(m,g=!1)=>m!==void 0&&(g||m&&d)?-m:m;return[{years:f(Pl(e)),months:f(Pl(r)),weeks:f(Pl(n)),days:f(Pl(s)),hours:f(Pl(o)),minutes:f(Pl(l)),seconds:f(Pl(c),c==="-0"),milliseconds:f(Rp(u),h)}]}function iC(a,t,e,r,n,s,o){let l={year:t.length===2?Np(Lo(t)):Lo(t),month:JT.indexOf(e)+1,day:Lo(r),hour:Lo(n),minute:Lo(s)};return o&&(l.second=Lo(o)),a&&(l.weekday=a.length>3?QT.indexOf(a)+1:eC.indexOf(a)+1),l}function jU(a){let[,t,e,r,n,s,o,l,c,u,d,h]=a,f=iC(t,n,r,e,s,o,l),m;return c?m=WU[c]:u?m=0:m=qc(d,h),[f,new zi(m)]}function YU(a){return a.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}function lL(a){let[,t,e,r,n,s,o,l]=a;return[iC(t,n,r,e,s,o,l),zi.utcInstance]}function XU(a){let[,t,e,r,n,s,o,l]=a;return[iC(t,l,e,r,n,s,o),zi.utcInstance]}function mL(a){return Nd(a,[JU,pL],[QU,r6],[e6,i6],[t6,n6])}function gL(a){return Nd(YU(a),[UU,jU])}function vL(a){return Nd(a,[qU,lL],[ZU,lL],[KU,XU])}function yL(a){return Nd(a,[GU,VU])}function bL(a){return Nd(a,[HU,a6])}function wL(a){return Nd(a,[s6,pL],[o6,l6])}var cL,dL,IU,tC,hL,rC,AU,OU,FU,RU,NU,BU,fL,$U,HU,GU,WU,UU,qU,ZU,KU,JU,QU,e6,t6,pL,r6,i6,n6,a6,s6,o6,l6,nC=_e(()=>{An();Cy();Ld();Sl();cL=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;dL=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,IU=`(?:${dL.source}?(?:\\[(${cL.source})\\])?)?`,tC=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,hL=RegExp(`${tC.source}${IU}`),rC=RegExp(`(?:T${hL.source})?`),AU=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,OU=/(\d{4})-?W(\d\d)(?:-?(\d))?/,FU=/(\d{4})-?(\d{3})/,RU=uL("weekYear","weekNumber","weekDay"),NU=uL("year","ordinal"),BU=/(\d{4})-(\d\d)-(\d\d)/,fL=RegExp(`${tC.source} ?(?:${dL.source}|(${cL.source}))?`),$U=RegExp(`(?: ${fL.source})?`);HU=RegExp(`^T?${tC.source}$`),GU=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;WU={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};UU=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;qU=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,ZU=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,KU=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;JU=Fd(AU,rC),QU=Fd(OU,rC),e6=Fd(FU,rC),t6=Fd(hL),pL=Rd(zU,Bd,$p,zp),r6=Rd(RU,Bd,$p,zp),i6=Rd(NU,Bd,$p,zp),n6=Rd(Bd,$p,zp);a6=Rd(Bd);s6=Fd(BU,$U),o6=Fd(fL),l6=Rd(Bd,$p,zp)});function Ll(a,t,e=!1){let r={values:e?t.values:{...a.values,...t.values||{}},loc:a.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||a.conversionAccuracy,matrix:t.matrix||a.matrix};return new Jr(r)}function _L(a,t){var r;let e=(r=t.milliseconds)!=null?r:0;for(let n of d6.slice(1))t[n]&&(e+=t[n]*a[n].milliseconds);return e}function TL(a,t){let e=_L(a,t)<0?-1:1;Xc.reduceRight((r,n)=>{if(ht(t[n]))return r;if(r){let s=t[r]*e,o=a[n][r],l=Math.floor(s/o);t[n]+=l*e,t[r]-=l*o*e}return n},null),Xc.reduce((r,n)=>{if(ht(t[n]))return r;if(r){let s=t[r]%1;t[r]-=s,t[n]+=s*a[r][n]}return n},null)}function h6(a){let t={};for(let[e,r]of Object.entries(a))r!==0&&(t[e]=r);return t}var EL,CL,c6,Ya,$d,u6,Xc,d6,Jr,Hp=_e(()=>{El();Bp();Ip();Mp();nC();An();xl();Yc();EL="Invalid Duration",CL={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},c6={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...CL},Ya=146097/400,$d=146097/4800,u6={years:{quarters:4,months:12,weeks:Ya/7,days:Ya,hours:Ya*24,minutes:Ya*24*60,seconds:Ya*24*60*60,milliseconds:Ya*24*60*60*1e3},quarters:{months:3,weeks:Ya/28,days:Ya/4,hours:Ya*24/4,minutes:Ya*24*60/4,seconds:Ya*24*60*60/4,milliseconds:Ya*24*60*60*1e3/4},months:{weeks:$d/7,days:$d,hours:$d*24,minutes:$d*24*60,seconds:$d*24*60*60,milliseconds:$d*24*60*60*1e3},...CL},Xc=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],d6=Xc.slice(0).reverse();Jr=class a{constructor(t){let e=t.conversionAccuracy==="longterm"||!1,r=e?u6:c6;t.matrix&&(r=t.matrix),this.values=t.values,this.loc=t.loc||nr.create(),this.conversionAccuracy=e?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(t,e){return a.fromObject({milliseconds:t},e)}static fromObject(t,e={}){if(t==null||typeof t!="object")throw new mi(`Duration.fromObject: argument expected to be an object, got ${t===null?"null":typeof t}`);return new a({values:Ad(t,a.normalizeUnit),loc:nr.fromObject(e),conversionAccuracy:e.conversionAccuracy,matrix:e.matrix})}static fromDurationLike(t){if(Xs(t))return a.fromMillis(t);if(a.isDuration(t))return t;if(typeof t=="object")return a.fromObject(t);throw new mi(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(t,e){let[r]=yL(t);return r?a.fromObject(r,e):a.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,e){let[r]=bL(t);return r?a.fromObject(r,e):a.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,e=null){if(!t)throw new mi("need to specify a reason the Duration is invalid");let r=t instanceof Hi?t:new Hi(t,e);if(er.throwOnInvalid)throw new py(r);return new a({invalid:r})}static normalizeUnit(t){let e={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t&&t.toLowerCase()];if(!e)throw new kd(t);return e}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,e={}){let r={...e,floor:e.round!==!1&&e.floor!==!1};return this.isValid?Gi.create(this.loc,r).formatDurationFromString(this,t):EL}toHuman(t={}){if(!this.isValid)return EL;let e=Xc.map(r=>{let n=this.values[r];return ht(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...t,unit:r.slice(0,-1)}).format(n)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:t.listStyle||"narrow",...t}).format(e)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let t="P";return this.years!==0&&(t+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(t+=this.months+this.quarters*3+"M"),this.weeks!==0&&(t+=this.weeks+"W"),this.days!==0&&(t+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(t+="T"),this.hours!==0&&(t+=this.hours+"H"),this.minutes!==0&&(t+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(t+=Pd(this.seconds+this.milliseconds/1e3,3)+"S"),t==="P"&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;let e=this.toMillis();return e<0||e>=864e5?null:(t={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...t,includeOffset:!1},gt.fromMillis(e,{zone:"UTC"}).toISOTime(t))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?_L(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;let e=a.fromDurationLike(t),r={};for(let n of Xc)(Dl(e.values,n)||Dl(this.values,n))&&(r[n]=e.get(n)+this.get(n));return Ll(this,{values:r},!0)}minus(t){if(!this.isValid)return this;let e=a.fromDurationLike(t);return this.plus(e.negate())}mapUnits(t){if(!this.isValid)return this;let e={};for(let r of Object.keys(this.values))e[r]=XT(t(this.values[r],r));return Ll(this,{values:e},!0)}get(t){return this[a.normalizeUnit(t)]}set(t){if(!this.isValid)return this;let e={...this.values,...Ad(t,a.normalizeUnit)};return Ll(this,{values:e})}reconfigure({locale:t,numberingSystem:e,conversionAccuracy:r,matrix:n}={}){let o={loc:this.loc.clone({locale:t,numberingSystem:e}),matrix:n,conversionAccuracy:r};return Ll(this,o)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;let t=this.toObject();return TL(this.matrix,t),Ll(this,{values:t},!0)}rescale(){if(!this.isValid)return this;let t=h6(this.normalize().shiftToAll().toObject());return Ll(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(t.length===0)return this;t=t.map(o=>a.normalizeUnit(o));let e={},r={},n=this.toObject(),s;for(let o of Xc)if(t.indexOf(o)>=0){s=o;let l=0;for(let u in r)l+=this.matrix[u][o]*r[u],r[u]=0;Xs(n[o])&&(l+=n[o]);let c=Math.trunc(l);e[o]=c,r[o]=(l*1e3-c*1e3)/1e3}else Xs(n[o])&&(r[o]=n[o]);for(let o in r)r[o]!==0&&(e[s]+=o===s?r[o]:r[o]/this.matrix[s][o]);return TL(this.matrix,e),Ll(this,{values:e},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;let t={};for(let e of Object.keys(this.values))t[e]=this.values[e]===0?0:-this.values[e];return Ll(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid||!this.loc.equals(t.loc))return!1;function e(r,n){return r===void 0||r===0?n===void 0||n===0:r===n}for(let r of Xc)if(!e(this.values[r],t.values[r]))return!1;return!0}}});function f6(a,t){return!a||!a.isValid?Mo.invalid("missing or invalid start"):!t||!t.isValid?Mo.invalid("missing or invalid end"):t<a?Mo.invalid("end before start",`The end of an interval must be after its start, but you had start=${a.toISO()} and end=${t.toISO()}`):null}var zd,Mo,aC=_e(()=>{Yc();Hp();xl();El();Ip();Bp();Dp();zd="Invalid Interval";Mo=class a{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,e=null){if(!t)throw new mi("need to specify a reason the Interval is invalid");let r=t instanceof Hi?t:new Hi(t,e);if(er.throwOnInvalid)throw new fy(r);return new a({invalid:r})}static fromDateTimes(t,e){let r=Hd(t),n=Hd(e),s=f6(r,n);return s==null?new a({start:r,end:n}):s}static after(t,e){let r=Jr.fromDurationLike(e),n=Hd(t);return a.fromDateTimes(n,n.plus(r))}static before(t,e){let r=Jr.fromDurationLike(e),n=Hd(t);return a.fromDateTimes(n.minus(r),n)}static fromISO(t,e){let[r,n]=(t||"").split("/",2);if(r&&n){let s,o;try{s=gt.fromISO(r,e),o=s.isValid}catch(u){o=!1}let l,c;try{l=gt.fromISO(n,e),c=l.isValid}catch(u){c=!1}if(o&&c)return a.fromDateTimes(s,l);if(o){let u=Jr.fromISO(n,e);if(u.isValid)return a.after(s,u)}else if(c){let u=Jr.fromISO(r,e);if(u.isValid)return a.before(l,u)}}return a.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds",e){if(!this.isValid)return NaN;let r=this.start.startOf(t,e),n;return e!=null&&e.useLocaleWeeks?n=this.end.reconfigure({locale:r.locale}):n=this.end,n=n.startOf(t,e),Math.floor(n.diff(r,t).get(t))+(n.valueOf()!==this.end.valueOf())}hasSame(t){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,t):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return this.isValid?this.s>t:!1}isBefore(t){return this.isValid?this.e<=t:!1}contains(t){return this.isValid?this.s<=t&&this.e>t:!1}set({start:t,end:e}={}){return this.isValid?a.fromDateTimes(t||this.s,e||this.e):this}splitAt(...t){if(!this.isValid)return[];let e=t.map(Hd).filter(o=>this.contains(o)).sort((o,l)=>o.toMillis()-l.toMillis()),r=[],{s:n}=this,s=0;for(;n<this.e;){let o=e[s]||this.e,l=+o>+this.e?this.e:o;r.push(a.fromDateTimes(n,l)),n=l,s+=1}return r}splitBy(t){let e=Jr.fromDurationLike(t);if(!this.isValid||!e.isValid||e.as("milliseconds")===0)return[];let{s:r}=this,n=1,s,o=[];for(;r<this.e;){let l=this.start.plus(e.mapUnits(c=>c*n));s=+l>+this.e?this.e:l,o.push(a.fromDateTimes(r,s)),r=s,n+=1}return o}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return this.isValid?+this.e==+t.s:!1}abutsEnd(t){return this.isValid?+t.e==+this.s:!1}engulfs(t){return this.isValid?this.s<=t.s&&this.e>=t.e:!1}equals(t){return!this.isValid||!t.isValid?!1:this.s.equals(t.s)&&this.e.equals(t.e)}intersection(t){if(!this.isValid)return this;let e=this.s>t.s?this.s:t.s,r=this.e<t.e?this.e:t.e;return e>=r?null:a.fromDateTimes(e,r)}union(t){if(!this.isValid)return this;let e=this.s<t.s?this.s:t.s,r=this.e>t.e?this.e:t.e;return a.fromDateTimes(e,r)}static merge(t){let[e,r]=t.sort((n,s)=>n.s-s.s).reduce(([n,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[n,s.union(o)]:[n.concat([s]),o]:[n,o],[[],null]);return r&&e.push(r),e}static xor(t){let e=null,r=0,n=[],s=t.map(c=>[{time:c.s,type:"s"},{time:c.e,type:"e"}]),o=Array.prototype.concat(...s),l=o.sort((c,u)=>c.time-u.time);for(let c of l)r+=c.type==="s"?1:-1,r===1?e=c.time:(e&&+e!=+c.time&&n.push(a.fromDateTimes(e,c.time)),e=null);return a.merge(n)}difference(...t){return a.xor([this].concat(t)).map(e=>this.intersection(e)).filter(e=>e&&!e.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:zd}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(t=Tl,e={}){return this.isValid?Gi.create(this.s.loc.clone(e),t).formatInterval(this):zd}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:zd}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:zd}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:zd}toFormat(t,{separator:e=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(t)}${e}${this.e.toFormat(t)}`:zd}toDuration(t,e){return this.isValid?this.e.diff(this.s,t,e):Jr.invalid(this.invalidReason)}mapEndpoints(t){return a.fromDateTimes(t(this.s),t(this.e))}}});var Io,sC=_e(()=>{Yc();xl();Mp();Sl();_y();An();Io=class{static hasDST(t=er.defaultZone){let e=gt.now().setZone(t).set({month:12});return!t.isUniversal&&e.offset!==e.set({month:6}).offset}static isValidIANAZone(t){return hn.isValidZone(t)}static normalizeZone(t){return ys(t,er.defaultZone)}static getStartOfWeek({locale:t=null,locObj:e=null}={}){return(e||nr.create(t)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:t=null,locObj:e=null}={}){return(e||nr.create(t)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:t=null,locObj:e=null}={}){return(e||nr.create(t)).getWeekendDays().slice()}static months(t="long",{locale:e=null,numberingSystem:r=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||nr.create(e,r,s)).months(t)}static monthsFormat(t="long",{locale:e=null,numberingSystem:r=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||nr.create(e,r,s)).months(t,!0)}static weekdays(t="long",{locale:e=null,numberingSystem:r=null,locObj:n=null}={}){return(n||nr.create(e,r,null)).weekdays(t)}static weekdaysFormat(t="long",{locale:e=null,numberingSystem:r=null,locObj:n=null}={}){return(n||nr.create(e,r,null)).weekdays(t,!0)}static meridiems({locale:t=null}={}){return nr.create(t).meridiems()}static eras(t="short",{locale:e=null}={}){return nr.create(e,null,"gregory").eras(t)}static features(){return{relative:Ey(),localeWeek:Ty()}}}});function SL(a,t){let e=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=e(t)-e(a);return Math.floor(Jr.fromMillis(r).as("days"))}function p6(a,t,e){let r=[["years",(c,u)=>u.year-c.year],["quarters",(c,u)=>u.quarter-c.quarter+(u.year-c.year)*4],["months",(c,u)=>u.month-c.month+(u.year-c.year)*12],["weeks",(c,u)=>{let d=SL(c,u);return(d-d%7)/7}],["days",SL]],n={},s=a,o,l;for(let[c,u]of r)e.indexOf(c)>=0&&(o=c,n[c]=u(a,t),l=s.plus(n),l>t?(n[c]--,a=s.plus(n),a>t&&(l=a,n[c]--,a=s.plus(n))):a=l);return[a,n,l,o]}function xL(a,t,e,r){let[n,s,o,l]=p6(a,t,e),c=t-n,u=e.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);u.length===0&&(o<t&&(o=n.plus({[l]:1})),o!==n&&(s[l]=(s[l]||0)+c/(o-n)));let d=Jr.fromObject(s,r);return u.length>0?Jr.fromMillis(c,r).shiftTo(...u).plus(d):d}var kL=_e(()=>{Hp()});function PL(a){let t=parseInt(a,10);if(isNaN(t)){t="";for(let e=0;e<a.length;e++){let r=a.charCodeAt(e);if(a[e].search(oC.hanidec)!==-1)t+=m6.indexOf(a[e]);else for(let n in DL){let[s,o]=DL[n];r>=s&&r<=o&&(t+=r-s)}}return parseInt(t,10)}else return t}function qa({numberingSystem:a},t=""){return new RegExp(`${oC[a||"latn"]}${t}`)}var oC,DL,m6,LL=_e(()=>{oC={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},DL={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},m6=oC.hanidec.replace(/[\[|\]]/g,"").split("")});function tr(a,t=e=>e){return{regex:a,deser:([e])=>t(PL(e))}}function y6(a){return a.replace(/\./g,"\\.?").replace(OL,AL)}function ML(a){return a.replace(/\./g,"").replace(OL," ").toLowerCase()}function bs(a,t){return a===null?null:{regex:RegExp(a.map(y6).join("|")),deser:([e])=>a.findIndex(r=>ML(e)===ML(r))+t}}function IL(a,t){return{regex:a,deser:([,e,r])=>qc(e,r),groups:t}}function Dy(a){return{regex:a,deser:([t])=>t}}function b6(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function w6(a,t){let e=qa(t),r=qa(t,"{2}"),n=qa(t,"{3}"),s=qa(t,"{4}"),o=qa(t,"{6}"),l=qa(t,"{1,2}"),c=qa(t,"{1,3}"),u=qa(t,"{1,6}"),d=qa(t,"{1,9}"),h=qa(t,"{2,4}"),f=qa(t,"{4,6}"),m=v=>({regex:RegExp(b6(v.val)),deser:([E])=>E,literal:!0}),y=(v=>{if(a.literal)return m(v);switch(v.val){case"G":return bs(t.eras("short"),0);case"GG":return bs(t.eras("long"),0);case"y":return tr(u);case"yy":return tr(h,Np);case"yyyy":return tr(s);case"yyyyy":return tr(f);case"yyyyyy":return tr(o);case"M":return tr(l);case"MM":return tr(r);case"MMM":return bs(t.months("short",!0),1);case"MMMM":return bs(t.months("long",!0),1);case"L":return tr(l);case"LL":return tr(r);case"LLL":return bs(t.months("short",!1),1);case"LLLL":return bs(t.months("long",!1),1);case"d":return tr(l);case"dd":return tr(r);case"o":return tr(c);case"ooo":return tr(n);case"HH":return tr(r);case"H":return tr(l);case"hh":return tr(r);case"h":return tr(l);case"mm":return tr(r);case"m":return tr(l);case"q":return tr(l);case"qq":return tr(r);case"s":return tr(l);case"ss":return tr(r);case"S":return tr(c);case"SSS":return tr(n);case"u":return Dy(d);case"uu":return Dy(l);case"uuu":return tr(e);case"a":return bs(t.meridiems(),0);case"kkkk":return tr(s);case"kk":return tr(h,Np);case"W":return tr(l);case"WW":return tr(r);case"E":case"c":return tr(e);case"EEE":return bs(t.weekdays("short",!1),1);case"EEEE":return bs(t.weekdays("long",!1),1);case"ccc":return bs(t.weekdays("short",!0),1);case"cccc":return bs(t.weekdays("long",!0),1);case"Z":case"ZZ":return IL(new RegExp(`([+-]${l.source})(?::(${r.source}))?`),2);case"ZZZ":return IL(new RegExp(`([+-]${l.source})(${r.source})?`),2);case"z":return Dy(/[a-z_+-/]{1,256}?/i);case" ":return Dy(/[^\S\n\r]/);default:return m(v)}})(a)||{invalidReason:g6};return y.token=a,y}function T6(a,t,e){let{type:r,value:n}=a;if(r==="literal"){let c=/^\s+$/.test(n);return{literal:!c,val:c?" ":n}}let s=t[r],o=r;r==="hour"&&(t.hour12!=null?o=t.hour12?"hour12":"hour24":t.hourCycle!=null?t.hourCycle==="h11"||t.hourCycle==="h12"?o="hour12":o="hour24":o=e.hour12?"hour12":"hour24");let l=E6[o];if(typeof l=="object"&&(l=l[s]),l)return{literal:!1,val:l}}function C6(a){return[`^${a.map(e=>e.regex).reduce((e,r)=>`${e}(${r.source})`,"")}$`,a]}function _6(a,t,e){let r=a.match(t);if(r){let n={},s=1;for(let o in e)if(Dl(e,o)){let l=e[o],c=l.groups?l.groups+1:1;!l.literal&&l.token&&(n[l.token.val[0]]=l.deser(r.slice(s,s+c))),s+=c}return[r,n]}else return[r,{}]}function S6(a){let t=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}},e=null,r;return ht(a.z)||(e=hn.create(a.z)),ht(a.Z)||(e||(e=new zi(a.Z)),r=a.Z),ht(a.q)||(a.M=(a.q-1)*3+1),ht(a.h)||(a.h<12&&a.a===1?a.h+=12:a.h===12&&a.a===0&&(a.h=0)),a.G===0&&a.y&&(a.y=-a.y),ht(a.u)||(a.S=Rp(a.u)),[Object.keys(a).reduce((s,o)=>{let l=t(o);return l&&(s[l]=a[o]),s},{}),e,r]}function x6(){return lC||(lC=gt.fromMillis(1555555555555)),lC}function k6(a,t){if(a.literal)return a;let e=Gi.macroTokenToFormatOpts(a.val),r=dC(e,t);return r==null||r.includes(void 0)?a:r}function cC(a,t){return Array.prototype.concat(...a.map(e=>k6(e,t)))}function uC(a,t,e){let r=cC(Gi.parseFormat(e),a),n=r.map(o=>w6(o,a)),s=n.find(o=>o.invalidReason);if(s)return{input:t,tokens:r,invalidReason:s.invalidReason};{let[o,l]=C6(n),c=RegExp(o,"i"),[u,d]=_6(t,c,l),[h,f,m]=d?S6(d):[null,null,void 0];if(Dl(d,"a")&&Dl(d,"H"))throw new ms("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:r,regex:c,rawMatches:u,matches:d,result:h,zone:f,specificOffset:m}}}function FL(a,t,e){let{result:r,zone:n,specificOffset:s,invalidReason:o}=uC(a,t,e);return[r,n,s,o]}function dC(a,t){if(!a)return null;let r=Gi.create(t,a).dtFormatter(x6()),n=r.formatToParts(),s=r.resolvedOptions();return n.map(o=>T6(o,a,s))}var g6,v6,AL,OL,E6,lC,RL=_e(()=>{An();Bp();Ld();Sl();Yc();LL();El();g6="missing Intl.DateTimeFormat.formatToParts support";v6="\xA0",AL=`[ ${v6}]`,OL=new RegExp(AL,"g");E6={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};lC=null});function Py(a){return new Hi("unsupported zone",`the zone "${a.name}" is not supported`)}function fC(a){return a.weekData===null&&(a.weekData=Ap(a.c)),a.weekData}function pC(a){return a.localWeekData===null&&(a.localWeekData=Ap(a.c,a.loc.getMinDaysInFirstWeek(),a.loc.getStartOfWeek())),a.localWeekData}function Jc(a,t){let e={ts:a.ts,zone:a.zone,c:a.c,o:a.o,loc:a.loc,invalid:a.invalid};return new gt({...e,...t,old:e})}function WL(a,t,e){let r=a-t*60*1e3,n=e.offset(r);if(t===n)return[r,t];r-=(n-t)*60*1e3;let s=e.offset(r);return n===s?[r,n]:[a-Math.min(n,s)*60*1e3,Math.max(n,s)]}function Ly(a,t){a+=t*60*1e3;let e=new Date(a);return{year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate(),hour:e.getUTCHours(),minute:e.getUTCMinutes(),second:e.getUTCSeconds(),millisecond:e.getUTCMilliseconds()}}function Iy(a,t,e){return WL(Dd(a),t,e)}function BL(a,t){let e=a.o,r=a.c.year+Math.trunc(t.years),n=a.c.month+Math.trunc(t.months)+Math.trunc(t.quarters)*3,s={...a.c,year:r,month:n,day:Math.min(a.c.day,Id(r,n))+Math.trunc(t.days)+Math.trunc(t.weeks)*7},o=Jr.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),l=Dd(s),[c,u]=WL(l,e,a.zone);return o!==0&&(c+=o,u=a.zone.offset(c)),{ts:c,o:u}}function Gp(a,t,e,r,n,s){let{setZone:o,zone:l}=e;if(a&&Object.keys(a).length!==0||t){let c=t||l,u=gt.fromObject(a,{...e,zone:c,specificOffset:s});return o?u:u.setZone(l)}else return gt.invalid(new Hi("unparsable",`the input "${n}" can't be parsed as ${r}`))}function My(a,t,e=!0){return a.isValid?Gi.create(nr.create("en-US"),{allowZ:e,forceSimple:!0}).formatDateTimeFromString(a,t):null}function mC(a,t){let e=a.c.year>9999||a.c.year<0,r="";return e&&a.c.year>=0&&(r+="+"),r+=Xr(a.c.year,e?6:4),t?(r+="-",r+=Xr(a.c.month),r+="-",r+=Xr(a.c.day)):(r+=Xr(a.c.month),r+=Xr(a.c.day)),r}function $L(a,t,e,r,n,s){let o=Xr(a.c.hour);return t?(o+=":",o+=Xr(a.c.minute),(a.c.millisecond!==0||a.c.second!==0||!e)&&(o+=":")):o+=Xr(a.c.minute),(a.c.millisecond!==0||a.c.second!==0||!e)&&(o+=Xr(a.c.second),(a.c.millisecond!==0||!r)&&(o+=".",o+=Xr(a.c.millisecond,3))),n&&(a.isOffsetFixed&&a.offset===0&&!s?o+="Z":a.o<0?(o+="-",o+=Xr(Math.trunc(-a.o/60)),o+=":",o+=Xr(Math.trunc(-a.o%60))):(o+="+",o+=Xr(Math.trunc(a.o/60)),o+=":",o+=Xr(Math.trunc(a.o%60)))),s&&(o+="["+a.zone.ianaName+"]"),o}function I6(a){let t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[a.toLowerCase()];if(!t)throw new kd(a);return t}function zL(a){switch(a.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return I6(a)}}function HL(a,t){let e=ys(t.zone,er.defaultZone),r=nr.fromObject(t),n=er.now(),s,o;if(ht(a.year))s=n;else{for(let u of jL)ht(a[u])&&(a[u]=UL[u]);let l=YT(a)||qT(a);if(l)return gt.invalid(l);let c=e.offset(n);[s,o]=Iy(a,c,e)}return new gt({ts:s,zone:e,loc:r,o})}function GL(a,t,e){let r=ht(e.round)?!0:e.round,n=(o,l)=>(o=Pd(o,r||e.calendary?0:2,!0),t.loc.clone(e).relFormatter(e).format(o,l)),s=o=>e.calendary?t.hasSame(a,o)?0:t.startOf(o).diff(a.startOf(o),o).get(o):t.diff(a,o).get(o);if(e.unit)return n(s(e.unit),e.unit);for(let o of e.units){let l=s(o);if(Math.abs(l)>=1)return n(l,o)}return n(a>t?-0:0,e.units[e.units.length-1])}function VL(a){let t={},e;return a.length>0&&typeof a[a.length-1]=="object"?(t=a[a.length-1],e=Array.from(a).slice(0,a.length-1)):e=Array.from(a),[t,e]}function Hd(a){if(gt.isDateTime(a))return a;if(a&&a.valueOf&&Xs(a.valueOf()))return gt.fromJSDate(a);if(a&&typeof a=="object")return gt.fromObject(a);throw new mi(`Unknown datetime argument: ${a}, of type ${typeof a}`)}var hC,NL,UL,D6,P6,jL,L6,M6,gt,Yc=_e(()=>{Hp();aC();xl();sC();Bp();Ld();Mp();An();_y();kL();nC();RL();ZT();Dp();El();Ip();hC="Invalid DateTime",NL=864e13;UL={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},D6={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},P6={ordinal:1,hour:0,minute:0,second:0,millisecond:0},jL=["year","month","day","hour","minute","second","millisecond"],L6=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],M6=["year","ordinal","hour","minute","second","millisecond"];gt=class a{constructor(t){let e=t.zone||er.defaultZone,r=t.invalid||(Number.isNaN(t.ts)?new Hi("invalid input"):null)||(e.isValid?null:Py(e));this.ts=ht(t.ts)?er.now():t.ts;let n=null,s=null;if(!r)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(e))[n,s]=[t.old.c,t.old.o];else{let l=e.offset(this.ts);n=Ly(this.ts,l),r=Number.isNaN(n.year)?new Hi("invalid input"):null,n=r?null:n,s=r?null:l}this._zone=e,this.loc=t.loc||nr.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=n,this.o=s,this.isLuxonDateTime=!0}static now(){return new a({})}static local(){let[t,e]=VL(arguments),[r,n,s,o,l,c,u]=e;return HL({year:r,month:n,day:s,hour:o,minute:l,second:c,millisecond:u},t)}static utc(){let[t,e]=VL(arguments),[r,n,s,o,l,c,u]=e;return t.zone=zi.utcInstance,HL({year:r,month:n,day:s,hour:o,minute:l,second:c,millisecond:u},t)}static fromJSDate(t,e={}){let r=eL(t)?t.valueOf():NaN;if(Number.isNaN(r))return a.invalid("invalid input");let n=ys(e.zone,er.defaultZone);return n.isValid?new a({ts:r,zone:n,loc:nr.fromObject(e)}):a.invalid(Py(n))}static fromMillis(t,e={}){if(Xs(t))return t<-NL||t>NL?a.invalid("Timestamp out of range"):new a({ts:t,zone:ys(e.zone,er.defaultZone),loc:nr.fromObject(e)});throw new mi(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,e={}){if(Xs(t))return new a({ts:t*1e3,zone:ys(e.zone,er.defaultZone),loc:nr.fromObject(e)});throw new mi("fromSeconds requires a numerical input")}static fromObject(t,e={}){t=t||{};let r=ys(e.zone,er.defaultZone);if(!r.isValid)return a.invalid(Py(r));let n=nr.fromObject(e),s=Ad(t,zL),{minDaysInFirstWeek:o,startOfWeek:l}=jT(s,n),c=er.now(),u=ht(e.specificOffset)?r.offset(c):e.specificOffset,d=!ht(s.ordinal),h=!ht(s.year),f=!ht(s.month)||!ht(s.day),m=h||f,g=s.weekYear||s.weekNumber;if((m||d)&&g)throw new ms("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(f&&d)throw new ms("Can't mix ordinal dates with month/day");let y=g||s.weekday&&!m,v,E,C=Ly(c,u);y?(v=L6,E=D6,C=Ap(C,o,l)):d?(v=M6,E=P6,C=ky(C)):(v=jL,E=UL);let _=!1;for(let F of v){let $=s[F];ht($)?_?s[F]=E[F]:s[F]=C[F]:_=!0}let x=y?XP(s,o,l):d?JP(s):YT(s),P=x||qT(s);if(P)return a.invalid(P);let I=y?WT(s,o,l):d?UT(s):s,[M,O]=Iy(I,u,r),R=new a({ts:M,zone:r,o:O,loc:n});return s.weekday&&m&&t.weekday!==R.weekday?a.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${R.toISO()}`):R}static fromISO(t,e={}){let[r,n]=mL(t);return Gp(r,n,e,"ISO 8601",t)}static fromRFC2822(t,e={}){let[r,n]=gL(t);return Gp(r,n,e,"RFC 2822",t)}static fromHTTP(t,e={}){let[r,n]=vL(t);return Gp(r,n,e,"HTTP",e)}static fromFormat(t,e,r={}){if(ht(t)||ht(e))throw new mi("fromFormat requires an input string and a format");let{locale:n=null,numberingSystem:s=null}=r,o=nr.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0}),[l,c,u,d]=FL(o,t,e);return d?a.invalid(d):Gp(l,c,r,`format ${e}`,t,u)}static fromString(t,e,r={}){return a.fromFormat(t,e,r)}static fromSQL(t,e={}){let[r,n]=wL(t);return Gp(r,n,e,"SQL",t)}static invalid(t,e=null){if(!t)throw new mi("need to specify a reason the DateTime is invalid");let r=t instanceof Hi?t:new Hi(t,e);if(er.throwOnInvalid)throw new hy(r);return new a({invalid:r})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}static parseFormatForOpts(t,e={}){let r=dC(t,nr.fromObject(e));return r?r.map(n=>n?n.val:null).join(""):null}static expandFormat(t,e={}){return cC(Gi.parseFormat(t),nr.fromObject(e)).map(n=>n.val).join("")}get(t){return this[t]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?fC(this).weekYear:NaN}get weekNumber(){return this.isValid?fC(this).weekNumber:NaN}get weekday(){return this.isValid?fC(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?pC(this).weekday:NaN}get localWeekNumber(){return this.isValid?pC(this).weekNumber:NaN}get localWeekYear(){return this.isValid?pC(this).weekYear:NaN}get ordinal(){return this.isValid?ky(this.c).ordinal:NaN}get monthShort(){return this.isValid?Io.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Io.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Io.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Io.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];let t=864e5,e=6e4,r=Dd(this.c),n=this.zone.offset(r-t),s=this.zone.offset(r+t),o=this.zone.offset(r-n*e),l=this.zone.offset(r-s*e);if(o===l)return[this];let c=r-o*e,u=r-l*e,d=Ly(c,o),h=Ly(u,l);return d.hour===h.hour&&d.minute===h.minute&&d.second===h.second&&d.millisecond===h.millisecond?[Jc(this,{ts:c}),Jc(this,{ts:u})]:[this]}get isInLeapYear(){return Kc(this.year)}get daysInMonth(){return Id(this.year,this.month)}get daysInYear(){return this.isValid?kl(this.year):NaN}get weeksInWeekYear(){return this.isValid?Zc(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?Zc(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(t={}){let{locale:e,numberingSystem:r,calendar:n}=Gi.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:e,numberingSystem:r,outputCalendar:n}}toUTC(t=0,e={}){return this.setZone(zi.instance(t),e)}toLocal(){return this.setZone(er.defaultZone)}setZone(t,{keepLocalTime:e=!1,keepCalendarTime:r=!1}={}){if(t=ys(t,er.defaultZone),t.equals(this.zone))return this;if(t.isValid){let n=this.ts;if(e||r){let s=t.offset(this.ts),o=this.toObject();[n]=Iy(o,s,t)}return Jc(this,{ts:n,zone:t})}else return a.invalid(Py(t))}reconfigure({locale:t,numberingSystem:e,outputCalendar:r}={}){let n=this.loc.clone({locale:t,numberingSystem:e,outputCalendar:r});return Jc(this,{loc:n})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;let e=Ad(t,zL),{minDaysInFirstWeek:r,startOfWeek:n}=jT(e,this.loc),s=!ht(e.weekYear)||!ht(e.weekNumber)||!ht(e.weekday),o=!ht(e.ordinal),l=!ht(e.year),c=!ht(e.month)||!ht(e.day),u=l||c,d=e.weekYear||e.weekNumber;if((u||o)&&d)throw new ms("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&o)throw new ms("Can't mix ordinal dates with month/day");let h;s?h=WT({...Ap(this.c,r,n),...e},r,n):ht(e.ordinal)?(h={...this.toObject(),...e},ht(e.day)&&(h.day=Math.min(Id(h.year,h.month),h.day))):h=UT({...ky(this.c),...e});let[f,m]=Iy(h,this.o,this.zone);return Jc(this,{ts:f,o:m})}plus(t){if(!this.isValid)return this;let e=Jr.fromDurationLike(t);return Jc(this,BL(this,e))}minus(t){if(!this.isValid)return this;let e=Jr.fromDurationLike(t).negate();return Jc(this,BL(this,e))}startOf(t,{useLocaleWeeks:e=!1}={}){if(!this.isValid)return this;let r={},n=Jr.normalizeUnit(t);switch(n){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break;case"milliseconds":break}if(n==="weeks")if(e){let s=this.loc.getStartOfWeek(),{weekday:o}=this;o<s&&(r.weekNumber=this.weekNumber-1),r.weekday=s}else r.weekday=1;if(n==="quarters"){let s=Math.ceil(this.month/3);r.month=(s-1)*3+1}return this.set(r)}endOf(t,e){return this.isValid?this.plus({[t]:1}).startOf(t,e).minus(1):this}toFormat(t,e={}){return this.isValid?Gi.create(this.loc.redefaultToEN(e)).formatDateTimeFromString(this,t):hC}toLocaleString(t=Tl,e={}){return this.isValid?Gi.create(this.loc.clone(e),t).formatDateTime(this):hC}toLocaleParts(t={}){return this.isValid?Gi.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO({format:t="extended",suppressSeconds:e=!1,suppressMilliseconds:r=!1,includeOffset:n=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;let o=t==="extended",l=mC(this,o);return l+="T",l+=$L(this,o,e,r,n,s),l}toISODate({format:t="extended"}={}){return this.isValid?mC(this,t==="extended"):null}toISOWeekDate(){return My(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:e=!1,includeOffset:r=!0,includePrefix:n=!1,extendedZone:s=!1,format:o="extended"}={}){return this.isValid?(n?"T":"")+$L(this,o==="extended",e,t,r,s):null}toRFC2822(){return My(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return My(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?mC(this,!0):null}toSQLTime({includeOffset:t=!0,includeZone:e=!1,includeOffsetSpace:r=!0}={}){let n="HH:mm:ss.SSS";return(e||t)&&(r&&(n+=" "),e?n+="z":t&&(n+="ZZ")),My(this,n,!0)}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():hC}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};let e={...this.c};return t.includeConfig&&(e.outputCalendar=this.outputCalendar,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,e="milliseconds",r={}){if(!this.isValid||!t.isValid)return Jr.invalid("created by diffing an invalid DateTime");let n={locale:this.locale,numberingSystem:this.numberingSystem,...r},s=tL(e).map(Jr.normalizeUnit),o=t.valueOf()>this.valueOf(),l=o?this:t,c=o?t:this,u=xL(l,c,s,n);return o?u.negate():u}diffNow(t="milliseconds",e={}){return this.diff(a.now(),t,e)}until(t){return this.isValid?Mo.fromDateTimes(this,t):this}hasSame(t,e,r){if(!this.isValid)return!1;let n=t.valueOf(),s=this.setZone(t.zone,{keepLocalTime:!0});return s.startOf(e,r)<=n&&n<=s.endOf(e,r)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;let e=t.base||a.fromObject({},{zone:this.zone}),r=t.padding?this<e?-t.padding:t.padding:0,n=["years","months","days","hours","minutes","seconds"],s=t.unit;return Array.isArray(t.unit)&&(n=t.unit,s=void 0),GL(e,this.plus(r),{...t,numeric:"always",units:n,unit:s})}toRelativeCalendar(t={}){return this.isValid?GL(t.base||a.fromObject({},{zone:this.zone}),this,{...t,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...t){if(!t.every(a.isDateTime))throw new mi("min requires all arguments be DateTimes");return KT(t,e=>e.valueOf(),Math.min)}static max(...t){if(!t.every(a.isDateTime))throw new mi("max requires all arguments be DateTimes");return KT(t,e=>e.valueOf(),Math.max)}static fromFormatExplain(t,e,r={}){let{locale:n=null,numberingSystem:s=null}=r,o=nr.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0});return uC(o,t,e)}static fromStringExplain(t,e,r={}){return a.fromFormatExplain(t,e,r)}static get DATE_SHORT(){return Tl}static get DATE_MED(){return cp}static get DATE_MED_WITH_WEEKDAY(){return kT}static get DATE_FULL(){return up}static get DATE_HUGE(){return dp}static get TIME_SIMPLE(){return hp}static get TIME_WITH_SECONDS(){return fp}static get TIME_WITH_SHORT_OFFSET(){return pp}static get TIME_WITH_LONG_OFFSET(){return mp}static get TIME_24_SIMPLE(){return gp}static get TIME_24_WITH_SECONDS(){return vp}static get TIME_24_WITH_SHORT_OFFSET(){return yp}static get TIME_24_WITH_LONG_OFFSET(){return bp}static get DATETIME_SHORT(){return wp}static get DATETIME_SHORT_WITH_SECONDS(){return Ep}static get DATETIME_MED(){return Tp}static get DATETIME_MED_WITH_SECONDS(){return Cp}static get DATETIME_MED_WITH_WEEKDAY(){return DT}static get DATETIME_FULL(){return _p}static get DATETIME_FULL_WITH_SECONDS(){return Sp}static get DATETIME_HUGE(){return xp}static get DATETIME_HUGE_WITH_SECONDS(){return kp}}});var gC=_e(()=>{Yc();Hp();aC();sC();jc();Ld();Sl();VT();gy();xl()});var YL=uy((vC,yC)=>{(function(a,t){typeof vC=="object"&&typeof yC!="undefined"?yC.exports=t():typeof define=="function"&&define.amd?define(t):(a=typeof globalThis!="undefined"?globalThis:a||self).dayjs_plugin_quarterOfYear=t()})(vC,(function(){"use strict";var a="month",t="quarter";return function(e,r){var n=r.prototype;n.quarter=function(l){return this.$utils().u(l)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(l-1))};var s=n.add;n.add=function(l,c){return l=Number(l),this.$utils().p(c)===t?this.add(3*l,a):s.bind(this)(l,c)};var o=n.startOf;n.startOf=function(l,c){var u=this.$utils(),d=!!u.u(c)||c;if(u.p(l)===t){var h=this.quarter()-1;return d?this.month(3*h).startOf(a).startOf("day"):this.month(3*h+2).endOf(a).endOf("day")}return o.bind(this)(l,c)}}}))});var Ml=uy((bC,wC)=>{(function(a,t){typeof bC=="object"&&typeof wC!="undefined"?wC.exports=t():typeof define=="function"&&define.amd?define(t):(a=typeof globalThis!="undefined"?globalThis:a||self).dayjs=t()})(bC,(function(){"use strict";var a=1e3,t=6e4,e=36e5,r="millisecond",n="second",s="minute",o="hour",l="day",c="week",u="month",d="quarter",h="year",f="date",m="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(k){var N=["th","st","nd","rd"],G=k%100;return"["+k+(N[(G-20)%10]||N[G]||N[0])+"]"}},E=function(k,N,G){var W=String(k);return!W||W.length>=N?k:""+Array(N+1-W.length).join(G)+k},C={s:E,z:function(k){var N=-k.utcOffset(),G=Math.abs(N),W=Math.floor(G/60),Y=G%60;return(N<=0?"+":"-")+E(W,2,"0")+":"+E(Y,2,"0")},m:function k(N,G){if(N.date()<G.date())return-k(G,N);var W=12*(G.year()-N.year())+(G.month()-N.month()),Y=N.clone().add(W,u),U=G-Y<0,Z=N.clone().add(W+(U?-1:1),u);return+(-(W+(G-Y)/(U?Y-Z:Z-Y))||0)},a:function(k){return k<0?Math.ceil(k)||0:Math.floor(k)},p:function(k){return{M:u,y:h,w:c,d:l,D:f,h:o,m:s,s:n,ms:r,Q:d}[k]||String(k||"").toLowerCase().replace(/s$/,"")},u:function(k){return k===void 0}},_="en",x={};x[_]=v;var P="$isDayjsObject",I=function(k){return k instanceof F||!(!k||!k[P])},M=function k(N,G,W){var Y;if(!N)return _;if(typeof N=="string"){var U=N.toLowerCase();x[U]&&(Y=U),G&&(x[U]=G,Y=U);var Z=N.split("-");if(!Y&&Z.length>1)return k(Z[0])}else{var q=N.name;x[q]=N,Y=q}return!W&&Y&&(_=Y),Y||!W&&_},O=function(k,N){if(I(k))return k.clone();var G=typeof N=="object"?N:{};return G.date=k,G.args=arguments,new F(G)},R=C;R.l=M,R.i=I,R.w=function(k,N){return O(k,{locale:N.$L,utc:N.$u,x:N.$x,$offset:N.$offset})};var F=(function(){function k(G){this.$L=M(G.locale,null,!0),this.parse(G),this.$x=this.$x||G.x||{},this[P]=!0}var N=k.prototype;return N.parse=function(G){this.$d=(function(W){var Y=W.date,U=W.utc;if(Y===null)return new Date(NaN);if(R.u(Y))return new Date;if(Y instanceof Date)return new Date(Y);if(typeof Y=="string"&&!/Z$/i.test(Y)){var Z=Y.match(g);if(Z){var q=Z[2]-1||0,X=(Z[7]||"0").substring(0,3);return U?new Date(Date.UTC(Z[1],q,Z[3]||1,Z[4]||0,Z[5]||0,Z[6]||0,X)):new Date(Z[1],q,Z[3]||1,Z[4]||0,Z[5]||0,Z[6]||0,X)}}return new Date(Y)})(G),this.init()},N.init=function(){var G=this.$d;this.$y=G.getFullYear(),this.$M=G.getMonth(),this.$D=G.getDate(),this.$W=G.getDay(),this.$H=G.getHours(),this.$m=G.getMinutes(),this.$s=G.getSeconds(),this.$ms=G.getMilliseconds()},N.$utils=function(){return R},N.isValid=function(){return this.$d.toString()!==m},N.isSame=function(G,W){var Y=O(G);return this.startOf(W)<=Y&&Y<=this.endOf(W)},N.isAfter=function(G,W){return O(G)<this.startOf(W)},N.isBefore=function(G,W){return this.endOf(W)<O(G)},N.$g=function(G,W,Y){return R.u(G)?this[W]:this.set(Y,G)},N.unix=function(){return Math.floor(this.valueOf()/1e3)},N.valueOf=function(){return this.$d.getTime()},N.startOf=function(G,W){var Y=this,U=!!R.u(W)||W,Z=R.p(G),q=function(ve,Se){var Te=R.w(Y.$u?Date.UTC(Y.$y,Se,ve):new Date(Y.$y,Se,ve),Y);return U?Te:Te.endOf(l)},X=function(ve,Se){return R.w(Y.toDate()[ve].apply(Y.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(Se)),Y)},ie=this.$W,j=this.$M,K=this.$D,se="set"+(this.$u?"UTC":"");switch(Z){case h:return U?q(1,0):q(31,11);case u:return U?q(1,j):q(0,j+1);case c:var ne=this.$locale().weekStart||0,ge=(ie<ne?ie+7:ie)-ne;return q(U?K-ge:K+(6-ge),j);case l:case f:return X(se+"Hours",0);case o:return X(se+"Minutes",1);case s:return X(se+"Seconds",2);case n:return X(se+"Milliseconds",3);default:return this.clone()}},N.endOf=function(G){return this.startOf(G,!1)},N.$set=function(G,W){var Y,U=R.p(G),Z="set"+(this.$u?"UTC":""),q=(Y={},Y[l]=Z+"Date",Y[f]=Z+"Date",Y[u]=Z+"Month",Y[h]=Z+"FullYear",Y[o]=Z+"Hours",Y[s]=Z+"Minutes",Y[n]=Z+"Seconds",Y[r]=Z+"Milliseconds",Y)[U],X=U===l?this.$D+(W-this.$W):W;if(U===u||U===h){var ie=this.clone().set(f,1);ie.$d[q](X),ie.init(),this.$d=ie.set(f,Math.min(this.$D,ie.daysInMonth())).$d}else q&&this.$d[q](X);return this.init(),this},N.set=function(G,W){return this.clone().$set(G,W)},N.get=function(G){return this[R.p(G)]()},N.add=function(G,W){var Y,U=this;G=Number(G);var Z=R.p(W),q=function(j){var K=O(U);return R.w(K.date(K.date()+Math.round(j*G)),U)};if(Z===u)return this.set(u,this.$M+G);if(Z===h)return this.set(h,this.$y+G);if(Z===l)return q(1);if(Z===c)return q(7);var X=(Y={},Y[s]=t,Y[o]=e,Y[n]=a,Y)[Z]||1,ie=this.$d.getTime()+G*X;return R.w(ie,this)},N.subtract=function(G,W){return this.add(-1*G,W)},N.format=function(G){var W=this,Y=this.$locale();if(!this.isValid())return Y.invalidDate||m;var U=G||"YYYY-MM-DDTHH:mm:ssZ",Z=R.z(this),q=this.$H,X=this.$m,ie=this.$M,j=Y.weekdays,K=Y.months,se=Y.meridiem,ne=function(Se,Te,me,pe){return Se&&(Se[Te]||Se(W,U))||me[Te].slice(0,pe)},ge=function(Se){return R.s(q%12||12,Se,"0")},ve=se||function(Se,Te,me){var pe=Se<12?"AM":"PM";return me?pe.toLowerCase():pe};return U.replace(y,(function(Se,Te){return Te||(function(me){switch(me){case"YY":return String(W.$y).slice(-2);case"YYYY":return R.s(W.$y,4,"0");case"M":return ie+1;case"MM":return R.s(ie+1,2,"0");case"MMM":return ne(Y.monthsShort,ie,K,3);case"MMMM":return ne(K,ie);case"D":return W.$D;case"DD":return R.s(W.$D,2,"0");case"d":return String(W.$W);case"dd":return ne(Y.weekdaysMin,W.$W,j,2);case"ddd":return ne(Y.weekdaysShort,W.$W,j,3);case"dddd":return j[W.$W];case"H":return String(q);case"HH":return R.s(q,2,"0");case"h":return ge(1);case"hh":return ge(2);case"a":return ve(q,X,!0);case"A":return ve(q,X,!1);case"m":return String(X);case"mm":return R.s(X,2,"0");case"s":return String(W.$s);case"ss":return R.s(W.$s,2,"0");case"SSS":return R.s(W.$ms,3,"0");case"Z":return Z}return null})(Se)||Z.replace(":","")}))},N.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},N.diff=function(G,W,Y){var U,Z=this,q=R.p(W),X=O(G),ie=(X.utcOffset()-this.utcOffset())*t,j=this-X,K=function(){return R.m(Z,X)};switch(q){case h:U=K()/12;break;case u:U=K();break;case d:U=K()/3;break;case c:U=(j-ie)/6048e5;break;case l:U=(j-ie)/864e5;break;case o:U=j/e;break;case s:U=j/t;break;case n:U=j/a;break;default:U=j}return Y?U:R.a(U)},N.daysInMonth=function(){return this.endOf(u).$D},N.$locale=function(){return x[this.$L]},N.locale=function(G,W){if(!G)return this.$L;var Y=this.clone(),U=M(G,W,!0);return U&&(Y.$L=U),Y},N.clone=function(){return R.w(this.$d,this)},N.toDate=function(){return new Date(this.valueOf())},N.toJSON=function(){return this.isValid()?this.toISOString():null},N.toISOString=function(){return this.$d.toISOString()},N.toString=function(){return this.$d.toUTCString()},k})(),$=F.prototype;return O.prototype=$,[["$ms",r],["$s",n],["$m",s],["$H",o],["$W",l],["$M",u],["$y",h],["$D",f]].forEach((function(k){$[k[1]]=function(N){return this.$g(N,k[0],k[1])}})),O.extend=function(k,N){return k.$i||(k(N,F,O),k.$i=!0),O},O.locale=M,O.isDayjs=I,O.unix=function(k){return O(1e3*k)},O.en=x[_],O.Ls=x,O.p={},O}))});var jt,gi,xa,Il=_e(()=>{(function(a){a[a.AM=0]="AM",a[a.PM=1]="PM"})(jt||(jt={}));(function(a){a[a.SUNDAY=0]="SUNDAY",a[a.MONDAY=1]="MONDAY",a[a.TUESDAY=2]="TUESDAY",a[a.WEDNESDAY=3]="WEDNESDAY",a[a.THURSDAY=4]="THURSDAY",a[a.FRIDAY=5]="FRIDAY",a[a.SATURDAY=6]="SATURDAY"})(gi||(gi={}));(function(a){a[a.JANUARY=1]="JANUARY",a[a.FEBRUARY=2]="FEBRUARY",a[a.MARCH=3]="MARCH",a[a.APRIL=4]="APRIL",a[a.MAY=5]="MAY",a[a.JUNE=6]="JUNE",a[a.JULY=7]="JULY",a[a.AUGUST=8]="AUGUST",a[a.SEPTEMBER=9]="SEPTEMBER",a[a.OCTOBER=10]="OCTOBER",a[a.NOVEMBER=11]="NOVEMBER",a[a.DECEMBER=12]="DECEMBER"})(xa||(xa={}))});function qL(a,t){t=t.add(1,"day"),Qc(a,t),Gd(a,t)}function ws(a,t){a.assign("day",t.date()),a.assign("month",t.month()+1),a.assign("year",t.year())}function Ay(a,t){a.assign("hour",t.hour()),a.assign("minute",t.minute()),a.assign("second",t.second()),a.assign("millisecond",t.millisecond()),a.get("hour")<12?a.assign("meridiem",jt.AM):a.assign("meridiem",jt.PM)}function Qc(a,t){a.imply("day",t.date()),a.imply("month",t.month()+1),a.imply("year",t.year())}function Gd(a,t){a.imply("hour",t.hour()),a.imply("minute",t.minute()),a.imply("second",t.second()),a.imply("millisecond",t.millisecond())}var Vd=_e(()=>{Il()});function Al(a,t,e,r,n=0){let s=0,o=0;for(;o<r;)s++,new Date(a,t-1,s).getDay()===e&&o++;return new Date(a,t-1,s,n)}function ZL(a,t,e,r=0){let n=e===0?7:e,s=new Date(a,t-1+1,1,12),o=s.getDay()===0?7:s.getDay(),l;return o===n?l=7:o<n?l=7+o-n:l=o-n,s.setDate(s.getDate()-l),new Date(a,t-1,s.getDate(),r)}function Oy(a,t,e={}){var n;if(a==null)return null;if(typeof a=="number")return a;let r=(n=e[a])!=null?n:A6[a];return r==null?null:typeof r=="number"?r:t==null?null:(0,EC.default)(t).isAfter(r.dstStart(t.getFullYear()))&&!(0,EC.default)(t).isAfter(r.dstEnd(t.getFullYear()))?r.timezoneOffsetDuringDst:r.timezoneOffsetNonDst}var EC,A6,TC=_e(()=>{EC=Ca(Ml(),1);Il();A6={ACDT:630,ACST:570,ADT:-180,AEDT:660,AEST:600,AFT:270,AKDT:-480,AKST:-540,ALMT:360,AMST:-180,AMT:-240,ANAST:720,ANAT:720,AQTT:300,ART:-180,AST:-240,AWDT:540,AWST:480,AZOST:0,AZOT:-60,AZST:300,AZT:240,BNT:480,BOT:-240,BRST:-120,BRT:-180,BST:60,BTT:360,CAST:480,CAT:120,CCT:390,CDT:-300,CEST:120,CET:{timezoneOffsetDuringDst:120,timezoneOffsetNonDst:60,dstStart:a=>ZL(a,xa.MARCH,gi.SUNDAY,2),dstEnd:a=>ZL(a,xa.OCTOBER,gi.SUNDAY,3)},CHADT:825,CHAST:765,CKT:-600,CLST:-180,CLT:-240,COT:-300,CST:-360,CT:{timezoneOffsetDuringDst:-300,timezoneOffsetNonDst:-360,dstStart:a=>Al(a,xa.MARCH,gi.SUNDAY,2,2),dstEnd:a=>Al(a,xa.NOVEMBER,gi.SUNDAY,1,2)},CVT:-60,CXT:420,ChST:600,DAVT:420,EASST:-300,EAST:-360,EAT:180,ECT:-300,EDT:-240,EEST:180,EET:120,EGST:0,EGT:-60,EST:-300,ET:{timezoneOffsetDuringDst:-240,timezoneOffsetNonDst:-300,dstStart:a=>Al(a,xa.MARCH,gi.SUNDAY,2,2),dstEnd:a=>Al(a,xa.NOVEMBER,gi.SUNDAY,1,2)},FJST:780,FJT:720,FKST:-180,FKT:-240,FNT:-120,GALT:-360,GAMT:-540,GET:240,GFT:-180,GILT:720,GMT:0,GST:240,GYT:-240,HAA:-180,HAC:-300,HADT:-540,HAE:-240,HAP:-420,HAR:-360,HAST:-600,HAT:-90,HAY:-480,HKT:480,HLV:-210,HNA:-240,HNC:-360,HNE:-300,HNP:-480,HNR:-420,HNT:-150,HNY:-540,HOVT:420,ICT:420,IDT:180,IOT:360,IRDT:270,IRKST:540,IRKT:540,IRST:210,IST:330,JST:540,KGT:360,KRAST:480,KRAT:480,KST:540,KUYT:240,LHDT:660,LHST:630,LINT:840,MAGST:720,MAGT:720,MART:-510,MAWT:300,MDT:-360,MESZ:120,MEZ:60,MHT:720,MMT:390,MSD:240,MSK:180,MST:-420,MT:{timezoneOffsetDuringDst:-360,timezoneOffsetNonDst:-420,dstStart:a=>Al(a,xa.MARCH,gi.SUNDAY,2,2),dstEnd:a=>Al(a,xa.NOVEMBER,gi.SUNDAY,1,2)},MUT:240,MVT:300,MYT:480,NCT:660,NDT:-90,NFT:690,NOVST:420,NOVT:360,NPT:345,NST:-150,NUT:-660,NZDT:780,NZST:720,OMSST:420,OMST:420,PDT:-420,PET:-300,PETST:720,PETT:720,PGT:600,PHOT:780,PHT:480,PKT:300,PMDT:-120,PMST:-180,PONT:660,PST:-480,PT:{timezoneOffsetDuringDst:-420,timezoneOffsetNonDst:-480,dstStart:a=>Al(a,xa.MARCH,gi.SUNDAY,2,2),dstEnd:a=>Al(a,xa.NOVEMBER,gi.SUNDAY,1,2)},PWT:540,PYST:-180,PYT:-240,RET:240,SAMT:240,SAST:120,SBT:660,SCT:240,SGT:480,SRT:-180,SST:-660,TAHT:-600,TFT:300,TJT:300,TKT:780,TLT:540,TMT:300,TVT:720,ULAT:480,UTC:0,UYST:-120,UYT:-180,UZT:300,VET:-210,VLAST:660,VLAT:660,VUT:660,WAST:120,WAT:60,WEST:60,WESZ:60,WET:0,WEZ:0,WFT:720,WGST:-120,WGT:-180,WIB:420,WIT:540,WITA:480,WST:780,WT:0,YAKST:600,YAKT:600,YAPT:600,YEKST:360,YEKT:360}});var KL,Vp,Wd,Jt,eu,Js=_e(()=>{KL=Ca(YL(),1),Vp=Ca(Ml(),1);Vd();TC();Vp.default.extend(KL.default);Wd=class{constructor(t){var e;t=t!=null?t:new Date,t instanceof Date?this.instant=t:(this.instant=(e=t.instant)!=null?e:new Date,this.timezoneOffset=Oy(t.timezone,this.instant))}getDateWithAdjustedTimezone(){return new Date(this.instant.getTime()+this.getSystemTimezoneAdjustmentMinute(this.instant)*6e4)}getSystemTimezoneAdjustmentMinute(t,e){var s;(!t||t.getTime()<0)&&(t=new Date);let r=-t.getTimezoneOffset(),n=(s=e!=null?e:this.timezoneOffset)!=null?s:r;return r-n}},Jt=class a{constructor(t,e){if(this.reference=t,this.knownValues={},this.impliedValues={},e)for(let n in e)this.knownValues[n]=e[n];let r=(0,Vp.default)(t.instant);this.imply("day",r.date()),this.imply("month",r.month()+1),this.imply("year",r.year()),this.imply("hour",12),this.imply("minute",0),this.imply("second",0),this.imply("millisecond",0)}get(t){return t in this.knownValues?this.knownValues[t]:t in this.impliedValues?this.impliedValues[t]:null}isCertain(t){return t in this.knownValues}getCertainComponents(){return Object.keys(this.knownValues)}imply(t,e){return t in this.knownValues?this:(this.impliedValues[t]=e,this)}assign(t,e){return this.knownValues[t]=e,delete this.impliedValues[t],this}delete(t){delete this.knownValues[t],delete this.impliedValues[t]}clone(){let t=new a(this.reference);t.knownValues={},t.impliedValues={};for(let e in this.knownValues)t.knownValues[e]=this.knownValues[e];for(let e in this.impliedValues)t.impliedValues[e]=this.impliedValues[e];return t}isOnlyDate(){return!this.isCertain("hour")&&!this.isCertain("minute")&&!this.isCertain("second")}isOnlyTime(){return!this.isCertain("weekday")&&!this.isCertain("day")&&!this.isCertain("month")}isOnlyWeekdayComponent(){return this.isCertain("weekday")&&!this.isCertain("day")&&!this.isCertain("month")}isDateWithUnknownYear(){return this.isCertain("month")&&!this.isCertain("year")}isValidDate(){let t=this.dateWithoutTimezoneAdjustment();return!(t.getFullYear()!==this.get("year")||t.getMonth()!==this.get("month")-1||t.getDate()!==this.get("day")||this.get("hour")!=null&&t.getHours()!=this.get("hour")||this.get("minute")!=null&&t.getMinutes()!=this.get("minute"))}toString(){return`[ParsingComponents {knownValues: ${JSON.stringify(this.knownValues)}, impliedValues: ${JSON.stringify(this.impliedValues)}}, reference: ${JSON.stringify(this.reference)}]`}dayjs(){return(0,Vp.default)(this.date())}date(){let t=this.dateWithoutTimezoneAdjustment(),e=this.reference.getSystemTimezoneAdjustmentMinute(t,this.get("timezoneOffset"));return new Date(t.getTime()+e*6e4)}dateWithoutTimezoneAdjustment(){let t=new Date(this.get("year"),this.get("month")-1,this.get("day"),this.get("hour"),this.get("minute"),this.get("second"),this.get("millisecond"));return t.setFullYear(this.get("year")),t}static createRelativeFromReference(t,e){let r=(0,Vp.default)(t.instant);for(let s in e)r=r.add(e[s],s);let n=new a(t);return e.hour||e.minute||e.second?(Ay(n,r),ws(n,r),t.timezoneOffset!==null&&n.assign("timezoneOffset",-t.instant.getTimezoneOffset())):(Gd(n,r),t.timezoneOffset!==null&&n.imply("timezoneOffset",-t.instant.getTimezoneOffset()),e.d?(n.assign("day",r.date()),n.assign("month",r.month()+1),n.assign("year",r.year())):(e.week&&n.imply("weekday",r.day()),n.imply("day",r.date()),e.month?(n.assign("month",r.month()+1),n.assign("year",r.year())):(n.imply("month",r.month()+1),e.year?n.assign("year",r.year()):n.imply("year",r.year())))),n}},eu=class a{constructor(t,e,r,n,s){this.reference=t,this.refDate=t.instant,this.index=e,this.text=r,this.start=n||new Jt(t),this.end=s}clone(){let t=new a(this.reference,this.index,this.text);return t.start=this.start?this.start.clone():null,t.end=this.end?this.end.clone():null,t}date(){return this.start.date()}toString(){return`[ParsingResult {index: ${this.index}, text: '${this.text}', ...}]`}}});function CC(a,t){let e=t.replace(/\((?!\?)/g,"(?:");return`${a}${e}\\s{0,5}(?:,?\\s{0,5}${e}){0,10}`}function O6(a){let t;return a instanceof Array?t=[...a]:a instanceof Map?t=Array.from(a.keys()):t=Object.keys(a),t}function Qi(a){return`(?:${O6(a).sort((e,r)=>r.length-e.length).join("|").replace(/\./g,"\\.")})`}var Ol=_e(()=>{});function Fy(a){return a<100&&(a>50?a=a+1900:a=a+2e3),a}function Fl(a,t,e){let r=(0,XL.default)(a),n=r;n=n.month(e-1),n=n.date(t),n=n.year(r.year());let s=n.add(1,"y"),o=n.add(-1,"y");return Math.abs(s.diff(r))<Math.abs(n.diff(r))?n=s:Math.abs(o.diff(r))<Math.abs(n.diff(r))&&(n=o),n.year()}var XL,Ud=_e(()=>{XL=Ca(Ml(),1)});function F6(a){let t=a.toLowerCase();return _C[t]!==void 0?_C[t]:t==="a"||t==="an"||t=="the"?1:t.match(/few/)?3:t.match(/half/)?.5:t.match(/couple/)?2:t.match(/several/)?7:parseFloat(t)}function Yd(a){let t=a.toLowerCase();return SC[t]!==void 0?SC[t]:(t=t.replace(/(?:st|nd|rd|th)$/i,""),parseInt(t))}function Zd(a){if(/BE/i.test(a))return a=a.replace(/BE/i,""),parseInt(a)-543;if(/BCE?/i.test(a))return a=a.replace(/BCE?/i,""),-parseInt(a);if(/(AD|CE)/i.test(a))return a=a.replace(/(AD|CE)/i,""),parseInt(a);let t=parseInt(a);return Fy(t)}function Qs(a){let t={},e=a,r=JL.exec(e);for(;r;)N6(t,r),e=e.substring(r[0].length).trim(),r=JL.exec(e);return t}function N6(a,t){let e=F6(t[1]),r=Wp[t[2].toLowerCase()];a[r]=e}var xC,kC,Za,_C,SC,QL,Wp,eM,jd,qd,tM,JL,R6,Ao,Rl,en=_e(()=>{Ol();Ud();xC={sunday:0,sun:0,"sun.":0,monday:1,mon:1,"mon.":1,tuesday:2,tue:2,"tue.":2,wednesday:3,wed:3,"wed.":3,thursday:4,thurs:4,"thurs.":4,thur:4,"thur.":4,thu:4,"thu.":4,friday:5,fri:5,"fri.":5,saturday:6,sat:6,"sat.":6},kC={january:1,february:2,march:3,april:4,may:5,june:6,july:7,august:8,september:9,october:10,november:11,december:12},Za={...kC,jan:1,"jan.":1,feb:2,"feb.":2,mar:3,"mar.":3,apr:4,"apr.":4,jun:6,"jun.":6,jul:7,"jul.":7,aug:8,"aug.":8,sep:9,"sep.":9,sept:9,"sept.":9,oct:10,"oct.":10,nov:11,"nov.":11,dec:12,"dec.":12},_C={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12},SC={first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9,tenth:10,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19,twentieth:20,"twenty first":21,"twenty-first":21,"twenty second":22,"twenty-second":22,"twenty third":23,"twenty-third":23,"twenty fourth":24,"twenty-fourth":24,"twenty fifth":25,"twenty-fifth":25,"twenty sixth":26,"twenty-sixth":26,"twenty seventh":27,"twenty-seventh":27,"twenty eighth":28,"twenty-eighth":28,"twenty ninth":29,"twenty-ninth":29,thirtieth:30,"thirty first":31,"thirty-first":31},QL={second:"second",seconds:"second",minute:"minute",minutes:"minute",hour:"hour",hours:"hour",day:"d",days:"d",week:"week",weeks:"week",month:"month",months:"month",quarter:"quarter",quarters:"quarter",year:"year",years:"year"},Wp={s:"second",sec:"second",second:"second",seconds:"second",m:"minute",min:"minute",mins:"minute",minute:"minute",minutes:"minute",h:"hour",hr:"hour",hrs:"hour",hour:"hour",hours:"hour",d:"d",day:"d",days:"d",w:"w",week:"week",weeks:"week",mo:"month",mon:"month",mos:"month",month:"month",months:"month",qtr:"quarter",quarter:"quarter",quarters:"quarter",y:"year",yr:"year",year:"year",years:"year",...QL},eM=`(?:${Qi(_C)}|[0-9]+|[0-9]+\\.[0-9]+|half(?:\\s{0,2}an?)?|an?\\b(?:\\s{0,2}few)?|few|several|the|a?\\s{0,2}couple\\s{0,2}(?:of)?)`;jd=`(?:${Qi(SC)}|[0-9]{1,2}(?:st|nd|rd|th)?)`;qd="(?:[1-9][0-9]{0,3}\\s{0,2}(?:BE|AD|BC|BCE|CE)|[1-2][0-9]{3}|[5-9][0-9])";tM=`(${eM})\\s{0,3}(${Qi(Wp)})`,JL=new RegExp(tM,"i"),R6=`(${eM})\\s{0,3}(${Qi(QL)})`,Ao=CC("(?:(?:about|around)\\s{0,3})?",tM),Rl=CC("(?:(?:about|around)\\s{0,3})?",R6)});var ar,On=_e(()=>{ar=class{constructor(){this.cachedInnerPattern=null,this.cachedPattern=null}patternLeftBoundary(){return"(\\W|^)"}pattern(t){let e=this.innerPattern(t);return e==this.cachedInnerPattern?this.cachedPattern:(this.cachedPattern=new RegExp(`${this.patternLeftBoundary()}${e.source}`,e.flags),this.cachedInnerPattern=e,this.cachedPattern)}extract(t,e){var n;let r=(n=e[1])!=null?n:"";e.index=e.index+r.length,e[0]=e[0].substring(r.length);for(let s=2;s<e.length;s++)e[s-1]=e[s];return this.innerExtract(t,e)}}});var B6,$6,z6,Up,rM=_e(()=>{en();Js();On();B6=new RegExp(`(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${Ao})(?=\\W|$)`,"i"),$6=new RegExp(`(?:within|in|for)\\s*(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${Ao})(?=\\W|$)`,"i"),z6=new RegExp(`(?:within|in|for)\\s*(?:(?:about|around|roughly|approximately|just)\\s*(?:~\\s*)?)?(${Rl})(?=\\W|$)`,"i"),Up=class extends ar{constructor(t){super(),this.strictMode=t}innerPattern(t){return this.strictMode?z6:t.option.forwardDate?B6:$6}innerExtract(t,e){let r=Qs(e[1]);return Jt.createRelativeFromReference(t.reference,r)}}});var H6,iM,nM,G6,aM,jp,sM=_e(()=>{Ud();en();en();en();Ol();On();H6=new RegExp(`(?:on\\s{0,3})?(${jd})(?:\\s{0,3}(?:to|\\-|\\\u2013|until|through|till)?\\s{0,3}(${jd}))?(?:-|/|\\s{0,3}(?:of)?\\s{0,3})(${Qi(Za)})(?:(?:-|/|,?\\s{0,3})(${qd}(?![^\\s]\\d)))?(?=\\W|$)`,"i"),iM=1,nM=2,G6=3,aM=4,jp=class extends ar{innerPattern(){return H6}innerExtract(t,e){let r=t.createParsingResult(e.index,e[0]),n=Za[e[G6].toLowerCase()],s=Yd(e[iM]);if(s>31)return e.index=e.index+e[iM].length,null;if(r.start.assign("month",n),r.start.assign("day",s),e[aM]){let o=Zd(e[aM]);r.start.assign("year",o)}else{let o=Fl(t.refDate,s,n);r.start.imply("year",o)}if(e[nM]){let o=Yd(e[nM]);r.end=r.start.clone(),r.end.assign("day",o)}return r}}});var V6,W6,U6,oM,lM,Yp,cM=_e(()=>{Ud();en();en();en();Ol();On();V6=new RegExp(`(${Qi(Za)})(?:-|/|\\s*,?\\s*)(${jd})(?!\\s*(?:am|pm))\\s*(?:(?:to|\\-)\\s*(${jd})\\s*)?(?:(?:-|/|\\s*,?\\s*)(${qd}))?(?=\\W|$)(?!\\:\\d)`,"i"),W6=1,U6=2,oM=3,lM=4,Yp=class extends ar{innerPattern(){return V6}innerExtract(t,e){let r=Za[e[W6].toLowerCase()],n=Yd(e[U6]);if(n>31)return null;let s=t.createParsingComponents({day:n,month:r});if(e[lM]){let c=Zd(e[lM]);s.assign("year",c)}else{let c=Fl(t.refDate,n,r);s.imply("year",c)}if(!e[oM])return s;let o=Yd(e[oM]),l=t.createParsingResult(e.index,e[0]);return l.start=s,l.end=s.clone(),l.end.assign("day",o),l}}});var j6,Y6,q6,uM,qp,dM=_e(()=>{en();Ud();Ol();en();On();j6=new RegExp(`((?:in)\\s*)?(${Qi(Za)})\\s*(?:[,-]?\\s*(${qd})?)?(?=[^\\s\\w]|\\s+[^0-9]|\\s+$|$)`,"i"),Y6=1,q6=2,uM=3,qp=class extends ar{innerPattern(){return j6}innerExtract(t,e){let r=e[q6].toLowerCase();if(e[0].length<=3&&!kC[r])return null;let n=t.createParsingResult(e.index+(e[Y6]||"").length,e.index+e[0].length);n.start.imply("day",1);let s=Za[r];if(n.start.assign("month",s),e[uM]){let o=Zd(e[uM]);n.start.assign("year",o)}else{let o=Fl(t.refDate,1,s);n.start.imply("year",o)}return n}}});var Z6,K6,X6,hM,J6,Zp,fM=_e(()=>{en();Ol();On();Z6=new RegExp(`([0-9]{4})[\\.\\/\\s](?:(${Qi(Za)})|([0-9]{1,2}))[\\.\\/\\s]([0-9]{1,2})(?=\\W|$)`,"i"),K6=1,X6=2,hM=3,J6=4,Zp=class extends ar{innerPattern(){return Z6}innerExtract(t,e){let r=e[hM]?parseInt(e[hM]):Za[e[X6].toLowerCase()];if(r<1||r>12)return null;let n=parseInt(e[K6]);return{day:parseInt(e[J6]),month:r,year:n}}}});var Q6,e8,t8,Kp,pM=_e(()=>{On();Q6=new RegExp("([0-9]|0[1-9]|1[012])/([0-9]{4})","i"),e8=1,t8=2,Kp=class extends ar{innerPattern(){return Q6}innerExtract(t,e){let r=parseInt(e[t8]),n=parseInt(e[e8]);return t.createParsingComponents().imply("day",1).assign("month",n).assign("year",r)}}});function r8(a,t,e,r){return new RegExp(`${a}${t}(\\d{1,4})(?:(?:\\.|:|\uFF1A)(\\d{1,2})(?:(?::|\uFF1A)(\\d{2})(?:\\.(\\d{1,6}))?)?)?(?:\\s*(a\\.m\\.|p\\.m\\.|am?|pm?))?${e}`,r)}function i8(a,t){return new RegExp(`^(${a})(\\d{1,4})(?:(?:\\.|\\:|\\\uFF1A)(\\d{1,2})(?:(?:\\.|\\:|\\\uFF1A)(\\d{1,2})(?:\\.(\\d{1,6}))?)?)?(?:\\s*(a\\.m\\.|p\\.m\\.|am?|pm?))?${t}`,"i")}var mM,Kd,Ry,Ny,Xp,By,gM=_e(()=>{Il();mM=2,Kd=3,Ry=4,Ny=5,Xp=6,By=class{constructor(t=!1){this.cachedPrimaryPrefix=null,this.cachedPrimarySuffix=null,this.cachedPrimaryTimePattern=null,this.cachedFollowingPhase=null,this.cachedFollowingSuffix=null,this.cachedFollowingTimePatten=null,this.strictMode=t}patternFlags(){return"i"}primaryPatternLeftBoundary(){return"(^|\\s|T|\\b)"}primarySuffix(){return"(?=\\W|$)"}followingSuffix(){return"(?=\\W|$)"}pattern(t){return this.getPrimaryTimePatternThroughCache()}extract(t,e){let r=this.extractPrimaryTimeComponents(t,e);if(!r)return e.index+=e[0].length,null;let n=e.index+e[1].length,s=e[0].substring(e[1].length),o=t.createParsingResult(n,s,r);e.index+=e[0].length;let l=t.text.substring(e.index),u=this.getFollowingTimePatternThroughCache().exec(l);return s.match(/^\d{3,4}/)&&u&&u[0].match(/^\s*([+-])\s*\d{2,4}$/)?null:!u||u[0].match(/^\s*([+-])\s*\d{3,4}$/)?this.checkAndReturnWithoutFollowingPattern(o):(o.end=this.extractFollowingTimeComponents(t,u,o),o.end&&(o.text+=u[0]),this.checkAndReturnWithFollowingPattern(o))}extractPrimaryTimeComponents(t,e,r=!1){let n=t.createParsingComponents(),s=0,o=null,l=parseInt(e[mM]);if(l>100){if(this.strictMode||e[Kd]!=null)return null;s=l%100,l=Math.floor(l/100)}if(l>24)return null;if(e[Kd]!=null){if(e[Kd].length==1&&!e[Xp])return null;s=parseInt(e[Kd])}if(s>=60)return null;if(l>12&&(o=jt.PM),e[Xp]!=null){if(l>12)return null;let c=e[Xp][0].toLowerCase();c=="a"&&(o=jt.AM,l==12&&(l=0)),c=="p"&&(o=jt.PM,l!=12&&(l+=12))}if(n.assign("hour",l),n.assign("minute",s),o!==null?n.assign("meridiem",o):l<12?n.imply("meridiem",jt.AM):n.imply("meridiem",jt.PM),e[Ny]!=null){let c=parseInt(e[Ny].substring(0,3));if(c>=1e3)return null;n.assign("millisecond",c)}if(e[Ry]!=null){let c=parseInt(e[Ry]);if(c>=60)return null;n.assign("second",c)}return n}extractFollowingTimeComponents(t,e,r){let n=t.createParsingComponents();if(e[Ny]!=null){let c=parseInt(e[Ny].substring(0,3));if(c>=1e3)return null;n.assign("millisecond",c)}if(e[Ry]!=null){let c=parseInt(e[Ry]);if(c>=60)return null;n.assign("second",c)}let s=parseInt(e[mM]),o=0,l=-1;if(e[Kd]!=null?o=parseInt(e[Kd]):s>100&&(o=s%100,s=Math.floor(s/100)),o>=60||s>24)return null;if(s>=12&&(l=jt.PM),e[Xp]!=null){if(s>12)return null;let c=e[Xp][0].toLowerCase();c=="a"&&(l=jt.AM,s==12&&(s=0,n.isCertain("day")||n.imply("day",n.get("day")+1))),c=="p"&&(l=jt.PM,s!=12&&(s+=12)),r.start.isCertain("meridiem")||(l==jt.AM?(r.start.imply("meridiem",jt.AM),r.start.get("hour")==12&&r.start.assign("hour",0)):(r.start.imply("meridiem",jt.PM),r.start.get("hour")!=12&&r.start.assign("hour",r.start.get("hour")+12)))}return n.assign("hour",s),n.assign("minute",o),l>=0?n.assign("meridiem",l):r.start.isCertain("meridiem")&&r.start.get("hour")>12?r.start.get("hour")-12>s?n.imply("meridiem",jt.AM):s<=12&&(n.assign("hour",s+12),n.assign("meridiem",jt.PM)):s>12?n.imply("meridiem",jt.PM):s<=12&&n.imply("meridiem",jt.AM),n.date().getTime()<r.start.date().getTime()&&n.imply("day",n.get("day")+1),n}checkAndReturnWithoutFollowingPattern(t){if(t.text.match(/^\d$/)||t.text.match(/^\d\d\d+$/)||t.text.match(/\d[apAP]$/))return null;let e=t.text.match(/[^\d:.](\d[\d.]+)$/);if(e){let r=e[1];if(this.strictMode||r.includes(".")&&!r.match(/\d(\.\d{2})+$/)||parseInt(r)>24)return null}return t}checkAndReturnWithFollowingPattern(t){if(t.text.match(/^\d+-\d+$/))return null;let e=t.text.match(/[^\d:.](\d[\d.]+)\s*-\s*(\d[\d.]+)$/);if(e){if(this.strictMode)return null;let r=e[1],n=e[2];if(n.includes(".")&&!n.match(/\d(\.\d{2})+$/))return null;let s=parseInt(n),o=parseInt(r);if(s>24||o>24)return null}return t}getPrimaryTimePatternThroughCache(){let t=this.primaryPrefix(),e=this.primarySuffix();return this.cachedPrimaryPrefix===t&&this.cachedPrimarySuffix===e?this.cachedPrimaryTimePattern:(this.cachedPrimaryTimePattern=r8(this.primaryPatternLeftBoundary(),t,e,this.patternFlags()),this.cachedPrimaryPrefix=t,this.cachedPrimarySuffix=e,this.cachedPrimaryTimePattern)}getFollowingTimePatternThroughCache(){let t=this.followingPhase(),e=this.followingSuffix();return this.cachedFollowingPhase===t&&this.cachedFollowingSuffix===e?this.cachedFollowingTimePatten:(this.cachedFollowingTimePatten=i8(t,e),this.cachedFollowingPhase=t,this.cachedFollowingSuffix=e,this.cachedFollowingTimePatten)}}});var Jp,vM=_e(()=>{Il();gM();Jp=class extends By{constructor(t){super(t)}followingPhase(){return"\\s*(?:\\-|\\\u2013|\\~|\\\u301C|to|until|through|till|\\?)\\s*"}primaryPrefix(){return"(?:(?:at|from)\\s*)??"}primarySuffix(){return"(?:\\s*(?:o\\W*clock|at\\s*night|in\\s*the\\s*(?:morning|afternoon)))?(?!/)(?=\\W|$)"}extractPrimaryTimeComponents(t,e){let r=super.extractPrimaryTimeComponents(t,e);if(r){if(e[0].endsWith("night")){let n=r.get("hour");n>=6&&n<12?(r.assign("hour",r.get("hour")+12),r.assign("meridiem",jt.PM)):n<6&&r.assign("meridiem",jt.AM)}if(e[0].endsWith("afternoon")){r.assign("meridiem",jt.PM);let n=r.get("hour");n>=0&&n<=6&&r.assign("hour",r.get("hour")+12)}e[0].endsWith("morning")&&(r.assign("meridiem",jt.AM),r.get("hour")<12&&r.assign("hour",r.get("hour")))}return r}}});function Xd(a){let t={};for(let e in a)t[e]=-a[e];return t}function yM(a,t){let e=a.clone(),r=a.dayjs();for(let n in t)r=r.add(t[n],n);return("day"in t||"d"in t||"week"in t||"month"in t||"year"in t)&&(e.imply("day",r.date()),e.imply("month",r.month()+1),e.imply("year",r.year())),("second"in t||"minute"in t||"hour"in t)&&(e.imply("second",r.second()),e.imply("minute",r.minute()),e.imply("hour",r.hour())),e}var Qp=_e(()=>{});var n8,a8,em,bM=_e(()=>{en();Js();On();Qp();n8=new RegExp(`(${Ao})\\s{0,5}(?:ago|before|earlier)(?=\\W|$)`,"i"),a8=new RegExp(`(${Rl})\\s{0,5}(?:ago|before|earlier)(?=\\W|$)`,"i"),em=class extends ar{constructor(t){super(),this.strictMode=t}innerPattern(){return this.strictMode?a8:n8}innerExtract(t,e){let r=Qs(e[1]),n=Xd(r);return Jt.createRelativeFromReference(t.reference,n)}}});var s8,o8,l8,tm,wM=_e(()=>{en();Js();On();s8=new RegExp(`(${Ao})\\s{0,5}(?:later|after|from now|henceforth|forward|out)(?=(?:\\W|$))`,"i"),o8=new RegExp("("+Rl+")(later|from now)(?=(?:\\W|$))","i"),l8=1,tm=class extends ar{constructor(t){super(),this.strictMode=t}innerPattern(){return this.strictMode?o8:s8}innerExtract(t,e){let r=Qs(e[l8]);return Jt.createRelativeFromReference(t.reference,r)}}});var $y,eo,Jd=_e(()=>{$y=class{refine(t,e){return e.filter(r=>this.isValid(t,r))}},eo=class{refine(t,e){if(e.length<2)return e;let r=[],n=e[0],s=null;for(let o=1;o<e.length;o++){s=e[o];let l=t.text.substring(n.index+n.text.length,s.index);if(!this.shouldMergeResults(l,n,s,t))r.push(n),n=s;else{let c=n,u=s,d=this.mergeResults(l,c,u,t);t.debug(()=>{console.log(`${this.constructor.name} merged ${c} and ${u} into ${d}`)}),n=d}}return n!=null&&r.push(n),r}}});var rm,EM=_e(()=>{Jd();rm=class extends eo{shouldMergeResults(t,e,r){return!e.end&&!r.end&&t.match(this.patternBetween())!=null}mergeResults(t,e,r){if(!e.start.isOnlyWeekdayComponent()&&!r.start.isOnlyWeekdayComponent()&&(r.start.getCertainComponents().forEach(s=>{e.start.isCertain(s)||e.start.imply(s,r.start.get(s))}),e.start.getCertainComponents().forEach(s=>{r.start.isCertain(s)||r.start.imply(s,e.start.get(s))})),e.start.date().getTime()>r.start.date().getTime()){let s=e.start.dayjs(),o=r.start.dayjs();r.start.isOnlyWeekdayComponent()&&o.add(7,"days").isAfter(s)?(o=o.add(7,"days"),r.start.imply("day",o.date()),r.start.imply("month",o.month()+1),r.start.imply("year",o.year())):e.start.isOnlyWeekdayComponent()&&s.add(-7,"days").isBefore(o)?(s=s.add(-7,"days"),e.start.imply("day",s.date()),e.start.imply("month",s.month()+1),e.start.imply("year",s.year())):r.start.isDateWithUnknownYear()&&o.add(1,"years").isAfter(s)?(o=o.add(1,"years"),r.start.imply("year",o.year())):e.start.isDateWithUnknownYear()&&s.add(-1,"years").isBefore(o)?(s=s.add(-1,"years"),e.start.imply("year",s.year())):[r,e]=[e,r]}let n=e.clone();return n.start=e.start,n.end=r.start,n.index=Math.min(e.index,r.index),e.index<r.index?n.text=e.text+t+r.text:n.text=r.text+t+e.text,n}}});var im,TM=_e(()=>{EM();im=class extends rm{patternBetween(){return/^\s*(to|-||until|through|till)\s*$/i}}});function DC(a,t){let e=a.clone(),r=a.start,n=t.start;if(e.start=CM(r,n),a.end!=null||t.end!=null){let s=a.end==null?a.start:a.end,o=t.end==null?t.start:t.end,l=CM(s,o);if(a.end==null&&l.date().getTime()<e.start.date().getTime()){let c=l.dayjs().add(1,"day");l.isCertain("day")?ws(l,c):Qc(l,c)}e.end=l}return e}function CM(a,t){let e=a.clone();return t.isCertain("hour")?(e.assign("hour",t.get("hour")),e.assign("minute",t.get("minute")),t.isCertain("second")?(e.assign("second",t.get("second")),t.isCertain("millisecond")?e.assign("millisecond",t.get("millisecond")):e.imply("millisecond",t.get("millisecond"))):(e.imply("second",t.get("second")),e.imply("millisecond",t.get("millisecond")))):(e.imply("hour",t.get("hour")),e.imply("minute",t.get("minute")),e.imply("second",t.get("second")),e.imply("millisecond",t.get("millisecond"))),t.isCertain("timezoneOffset")&&e.assign("timezoneOffset",t.get("timezoneOffset")),t.isCertain("meridiem")?e.assign("meridiem",t.get("meridiem")):t.get("meridiem")!=null&&e.get("meridiem")==null&&e.imply("meridiem",t.get("meridiem")),e.get("meridiem")==jt.PM&&e.get("hour")<12&&(t.isCertain("hour")?e.assign("hour",e.get("hour")+12):e.imply("hour",e.get("hour")+12)),e}var _M=_e(()=>{Il();Vd()});var nm,SM=_e(()=>{Jd();_M();nm=class extends eo{shouldMergeResults(t,e,r){return(e.start.isOnlyDate()&&r.start.isOnlyTime()||r.start.isOnlyDate()&&e.start.isOnlyTime())&&t.match(this.patternBetween())!=null}mergeResults(t,e,r){let n=e.start.isOnlyDate()?DC(e,r):DC(r,e);return n.index=e.index,n.text=e.text+t+r.text,n}}});var am,xM=_e(()=>{SM();am=class extends nm{patternBetween(){return new RegExp("^\\s*(T|at|after|before|on|of|,|-)?\\s*$")}}});var c8,sm,kM=_e(()=>{TC();c8=new RegExp("^\\s*,?\\s*\\(?([A-Z]{2,4})\\)?(?=\\W|$)","i"),sm=class{constructor(t){this.timezoneOverrides=t}refine(t,e){var n;let r=(n=t.option.timezones)!=null?n:{};return e.forEach(s=>{var m,g;let o=t.text.substring(s.index+s.text.length),l=c8.exec(o);if(!l)return;let c=l[1].toUpperCase(),u=(g=(m=s.start.date())!=null?m:s.refDate)!=null?g:new Date,d={...this.timezoneOverrides,...r},h=Oy(c,u,d);if(h==null)return;t.debug(()=>{console.log(`Extracting timezone: '${c}' into: ${h} for: ${s.start}`)});let f=s.start.get("timezoneOffset");f!==null&&h!=f&&(s.start.isCertain("timezoneOffset")||c!=l[1])||s.start.isOnlyDate()&&c!=l[1]||(s.text+=l[0],s.start.isCertain("timezoneOffset")||s.start.assign("timezoneOffset",h),s.end!=null&&!s.end.isCertain("timezoneOffset")&&s.end.assign("timezoneOffset",h))}),e}}});var u8,d8,h8,f8,om,DM=_e(()=>{u8=new RegExp("^\\s*(?:\\(?(?:GMT|UTC)\\s?)?([+-])(\\d{1,2})(?::?(\\d{2}))?\\)?","i"),d8=1,h8=2,f8=3,om=class{refine(t,e){return e.forEach(function(r){if(r.start.isCertain("timezoneOffset"))return;let n=t.text.substring(r.index+r.text.length),s=u8.exec(n);if(!s)return;t.debug(()=>{console.log(`Extracting timezone: '${s[0]}' into : ${r}`)});let o=parseInt(s[h8]),l=parseInt(s[f8]||"0"),c=o*60+l;c>840||(s[d8]==="-"&&(c=-c),r.end!=null&&r.end.assign("timezoneOffset",c),r.start.assign("timezoneOffset",c),r.text+=s[0])}),e}}});var Qd,PM=_e(()=>{Qd=class{refine(t,e){if(e.length<2)return e;let r=[],n=e[0];for(let s=1;s<e.length;s++){let o=e[s];o.index<n.index+n.text.length?o.text.length>n.text.length&&(n=o):(r.push(n),n=o)}return n!=null&&r.push(n),r}}});var LM,lm,MM=_e(()=>{LM=Ca(Ml(),1);Vd();lm=class{refine(t,e){return t.option.forwardDate&&e.forEach(function(r){let n=(0,LM.default)(t.refDate);if(r.start.isOnlyTime()&&n.isAfter(r.start.dayjs())&&(n=n.add(1,"day"),Qc(r.start,n),r.end&&r.end.isOnlyTime()&&(Qc(r.end,n),r.start.dayjs().isAfter(r.end.dayjs())&&(n=n.add(1,"day"),Qc(r.end,n)))),r.start.isOnlyWeekdayComponent()&&n.isAfter(r.start.dayjs())&&(n.day()>=r.start.get("weekday")?n=n.day(r.start.get("weekday")+7):n=n.day(r.start.get("weekday")),r.start.imply("day",n.date()),r.start.imply("month",n.month()+1),r.start.imply("year",n.year()),t.debug(()=>{console.log(`Forward weekly adjusted for ${r} (${r.start})`)}),r.end&&r.end.isOnlyWeekdayComponent()&&(n.day()>r.end.get("weekday")?n=n.day(r.end.get("weekday")+7):n=n.day(r.end.get("weekday")),r.end.imply("day",n.date()),r.end.imply("month",n.month()+1),r.end.imply("year",n.year()),t.debug(()=>{console.log(`Forward weekly adjusted for ${r} (${r.end})`)}))),r.start.isDateWithUnknownYear()&&n.isAfter(r.start.dayjs()))for(let s=0;s<3&&n.isAfter(r.start.dayjs());s++)r.start.imply("year",r.start.get("year")+1),t.debug(()=>{console.log(`Forward yearly adjusted for ${r} (${r.start})`)}),r.end&&!r.end.isCertain("year")&&(r.end.imply("year",r.end.get("year")+1),t.debug(()=>{console.log(`Forward yearly adjusted for ${r} (${r.end})`)}))}),e}}});var cm,IM=_e(()=>{Jd();cm=class extends $y{constructor(t){super(),this.strictMode=t}isValid(t,e){return e.text.replace(" ","").match(/^\d*(\.\d*)?$/)?(t.debug(()=>{console.log(`Removing unlikely result '${e.text}'`)}),!1):e.start.isValidDate()?e.end&&!e.end.isValidDate()?(t.debug(()=>{console.log(`Removing invalid result: ${e} (${e.end})`)}),!1):this.strictMode?this.isStrictModeValid(t,e):!0:(t.debug(()=>{console.log(`Removing invalid result: ${e} (${e.start})`)}),!1)}isStrictModeValid(t,e){return e.start.isOnlyWeekdayComponent()?(t.debug(()=>{console.log(`(Strict) Removing weekday only component: ${e} (${e.end})`)}),!1):e.start.isOnlyTime()&&(!e.start.isCertain("hour")||!e.start.isCertain("minute"))?(t.debug(()=>{console.log(`(Strict) Removing uncertain time component: ${e} (${e.end})`)}),!1):!0}}});var p8,m8,g8,v8,AM,y8,OM,FM,RM,NM,um,BM=_e(()=>{On();p8=new RegExp("([0-9]{4})\\-([0-9]{1,2})\\-([0-9]{1,2})(?:T([0-9]{1,2}):([0-9]{1,2})(?::([0-9]{1,2})(?:\\.(\\d{1,4}))?)?(?:Z|([+-]\\d{2}):?(\\d{2})?)?)?(?=\\W|$)","i"),m8=1,g8=2,v8=3,AM=4,y8=5,OM=6,FM=7,RM=8,NM=9,um=class extends ar{innerPattern(){return p8}innerExtract(t,e){let r={};if(r.year=parseInt(e[m8]),r.month=parseInt(e[g8]),r.day=parseInt(e[v8]),e[AM]!=null)if(r.hour=parseInt(e[AM]),r.minute=parseInt(e[y8]),e[OM]!=null&&(r.second=parseInt(e[OM])),e[FM]!=null&&(r.millisecond=parseInt(e[FM])),e[RM]==null)r.timezoneOffset=0;else{let n=parseInt(e[RM]),s=0;e[NM]!=null&&(s=parseInt(e[NM]));let o=n*60;o<0?o-=s:o+=s,r.timezoneOffset=o}return r}}});var dm,$M=_e(()=>{Jd();dm=class extends eo{mergeResults(t,e,r){let n=r.clone();return n.index=e.index,n.text=e.text+t+n.text,n.start.assign("weekday",e.start.get("weekday")),n.end&&n.end.assign("weekday",e.start.get("weekday")),n}shouldMergeResults(t,e,r){return e.start.isOnlyWeekdayComponent()&&!e.start.isCertain("hour")&&r.start.isCertain("day")&&t.match(/^,?\s*$/)!=null}}});function zM(a,t=!1){return a.parsers.unshift(new um),a.refiners.unshift(new dm),a.refiners.unshift(new om),a.refiners.unshift(new Qd),a.refiners.push(new sm),a.refiners.push(new Qd),a.refiners.push(new lm),a.refiners.push(new cm(t)),a}var HM=_e(()=>{kM();DM();PM();MM();IM();BM();$M()});function GM(a){let t=(0,eh.default)(a.instant),e=new Jt(a,{});return ws(e,t),Ay(e,t),a.timezoneOffset!==null&&e.assign("timezoneOffset",t.utcOffset()),e}function VM(a){let t=(0,eh.default)(a.instant),e=new Jt(a,{});return ws(e,t),Gd(e,t),e}function WM(a){return b8(a,1)}function b8(a,t){return jM(a,-t)}function UM(a){return jM(a,1)}function jM(a,t){let e=(0,eh.default)(a.instant),r=new Jt(a,{});return e=e.add(t,"day"),ws(r,e),Gd(r,e),r}function YM(a,t=22){let e=(0,eh.default)(a.instant),r=new Jt(a,{});return r.imply("hour",t),r.imply("meridiem",jt.PM),ws(r,e),r}function qM(a,t=20){let e=new Jt(a,{});return e.imply("meridiem",jt.PM),e.imply("hour",t),e}function ZM(a){let t=new Jt(a,{}),e=(0,eh.default)(a.instant);return e.hour()>2&&qL(t,e),t.assign("hour",0),t.imply("minute",0),t.imply("second",0),t.imply("millisecond",0),t}function KM(a,t=6){let e=new Jt(a,{});return e.imply("meridiem",jt.AM),e.imply("hour",t),e.imply("minute",0),e.imply("second",0),e.imply("millisecond",0),e}function XM(a,t=15){let e=new Jt(a,{});return e.imply("meridiem",jt.PM),e.imply("hour",t),e.imply("minute",0),e.imply("second",0),e.imply("millisecond",0),e}function JM(a){let t=new Jt(a,{});return t.imply("meridiem",jt.AM),t.imply("hour",12),t.imply("minute",0),t.imply("second",0),t.imply("millisecond",0),t}var eh,PC=_e(()=>{Js();eh=Ca(Ml(),1);Vd();Il()});var eI,w8,hm,tI=_e(()=>{eI=Ca(Ml(),1);On();Vd();PC();w8=/(now|today|tonight|tomorrow|tmr|tmrw|yesterday|last\s*night)(?=\W|$)/i,hm=class extends ar{innerPattern(t){return w8}innerExtract(t,e){let r=(0,eI.default)(t.refDate),n=e[0].toLowerCase(),s=t.createParsingComponents();switch(n){case"now":return GM(t.reference);case"today":return VM(t.reference);case"yesterday":return WM(t.reference);case"tomorrow":case"tmr":case"tmrw":return UM(t.reference);case"tonight":return YM(t.reference);default:n.match(/last\s*night/)&&(r.hour()>6&&(r=r.add(-1,"day")),ws(s,r),s.imply("hour",0));break}return s}}});var E8,fm,rI=_e(()=>{On();PC();E8=/(?:this)?\s{0,3}(morning|afternoon|evening|night|midnight|midday|noon)(?=\W|$)/i,fm=class extends ar{innerPattern(){return E8}innerExtract(t,e){switch(e[1].toLowerCase()){case"afternoon":return XM(t.reference);case"evening":case"night":return qM(t.reference);case"midnight":return ZM(t.reference);case"morning":return KM(t.reference);case"noon":case"midday":return JM(t.reference)}return null}}});function iI(a,t,e){let r=a.getDateWithAdjustedTimezone(),n=T8(r,t,e),s=new Jt(a);return s=yM(s,{day:n}),s.assign("weekday",t),s}function T8(a,t,e){let r=a.getDay();switch(e){case"this":return zy(a,t);case"last":return nI(a,t);case"next":return r==gi.SUNDAY?t==gi.SUNDAY?7:t:r==gi.SATURDAY?t==gi.SATURDAY?7:t==gi.SUNDAY?8:1+t:t<r&&t!=gi.SUNDAY?zy(a,t):zy(a,t)+7}return C8(a,t)}function C8(a,t){let e=nI(a,t),r=zy(a,t);return r<-e?r:e}function zy(a,t){let e=a.getDay(),r=t-e;return r<0&&(r+=7),r}function nI(a,t){let e=a.getDay(),r=t-e;return r>=0&&(r-=7),r}var aI=_e(()=>{Il();Js();Qp()});var _8,S8,x8,k8,pm,sI=_e(()=>{en();Ol();On();aI();_8=new RegExp(`(?:(?:\\,|\\(|\\\uFF08)\\s*)?(?:on\\s*?)?(?:(this|last|past|next)\\s*)?(${Qi(xC)})(?:\\s*(?:\\,|\\)|\\\uFF09))?(?:\\s*(this|last|past|next)\\s*week)?(?=\\W|$)`,"i"),S8=1,x8=2,k8=3,pm=class extends ar{innerPattern(){return _8}innerExtract(t,e){let r=e[x8].toLowerCase(),n=xC[r],s=e[S8],o=e[k8],l=s||o;l=l||"",l=l.toLowerCase();let c=null;return l=="last"||l=="past"?c="last":l=="next"?c="next":l=="this"&&(c="this"),iI(t.reference,n,c)}}});var oI,D8,P8,L8,mm,lI=_e(()=>{en();Js();oI=Ca(Ml(),1);On();Ol();D8=new RegExp(`(this|last|past|next|after\\s*this)\\s*(${Qi(Wp)})(?=\\s*)(?=\\W|$)`,"i"),P8=1,L8=2,mm=class extends ar{innerPattern(){return D8}innerExtract(t,e){let r=e[P8].toLowerCase(),n=e[L8].toLowerCase(),s=Wp[n];if(r=="next"||r.startsWith("after")){let c={};return c[s]=1,Jt.createRelativeFromReference(t.reference,c)}if(r=="last"||r=="past"){let c={};return c[s]=-1,Jt.createRelativeFromReference(t.reference,c)}let o=t.createParsingComponents(),l=(0,oI.default)(t.reference.instant);return n.match(/week/i)?(l=l.add(-l.get("d"),"d"),o.imply("day",l.date()),o.imply("month",l.month()+1),o.imply("year",l.year())):n.match(/month/i)?(l=l.add(-l.date()+1,"d"),o.imply("day",l.date()),o.assign("year",l.year()),o.assign("month",l.month()+1)):n.match(/year/i)&&(l=l.add(-l.date()+1,"d"),l=l.add(-l.month(),"month"),o.imply("day",l.date()),o.imply("month",l.month()+1),o.assign("year",l.year())),o}}});var M8,Hy,I8,cI,uI,LC,gm,dI=_e(()=>{Ud();M8=new RegExp("([^\\d]|^)([0-3]{0,1}[0-9]{1})[\\/\\.\\-]([0-3]{0,1}[0-9]{1})(?:[\\/\\.\\-]([0-9]{4}|[0-9]{2}))?(\\W|$)","i"),Hy=1,I8=5,cI=2,uI=3,LC=4,gm=class{constructor(t){this.groupNumberMonth=t?uI:cI,this.groupNumberDay=t?cI:uI}pattern(){return M8}extract(t,e){if(e[Hy].length==0&&e.index>0&&e.index<t.text.length){let c=t.text[e.index-1];if(c>="0"&&c<="9")return}let r=e.index+e[Hy].length,n=e[0].substr(e[Hy].length,e[0].length-e[Hy].length-e[I8].length);if(n.match(/^\d\.\d$/)||n.match(/^\d\.\d{1,2}\.\d{1,2}\s*$/)||!e[LC]&&e[0].indexOf("/")<0)return;let s=t.createParsingResult(r,n),o=parseInt(e[this.groupNumberMonth]),l=parseInt(e[this.groupNumberDay]);if((o<1||o>12)&&o>12)if(l>=1&&l<=12&&o<=31)[l,o]=[o,l];else return null;if(l<1||l>31)return null;if(s.start.assign("day",l),s.start.assign("month",o),e[LC]){let c=parseInt(e[LC]),u=Fy(c);s.start.assign("year",u)}else{let c=Fl(t.refDate,l,o);s.start.imply("year",c)}return s}}});var A8,O8,vm,hI=_e(()=>{en();Js();On();Qp();A8=new RegExp(`(this|last|past|next|after|\\+|-)\\s*(${Ao})(?=\\W|$)`,"i"),O8=new RegExp(`(this|last|past|next|after|\\+|-)\\s*(${Rl})(?=\\W|$)`,"i"),vm=class extends ar{constructor(t=!0){super(),this.allowAbbreviations=t}innerPattern(){return this.allowAbbreviations?A8:O8}innerExtract(t,e){let r=e[1].toLowerCase(),n=Qs(e[2]);switch(r){case"last":case"past":case"-":n=Xd(n);break}return Jt.createRelativeFromReference(t.reference,n)}}});function fI(a){return a.text.match(/\s+(before|from)$/i)!=null}function F8(a){return a.text.match(/\s+(after|since)$/i)!=null}var ym,pI=_e(()=>{Jd();Js();en();Qp();ym=class extends eo{patternBetween(){return/^\s*$/i}shouldMergeResults(t,e,r){return!t.match(this.patternBetween())||!fI(e)&&!F8(e)?!1:!!r.start.get("day")&&!!r.start.get("month")&&!!r.start.get("year")}mergeResults(t,e,r){let n=Qs(e.text);fI(e)&&(n=Xd(n));let s=Jt.createRelativeFromReference(new Wd(r.start.date()),n);return new eu(r.reference,e.index,`${e.text}${t}${r.text}`,s)}}});var tu,MC=_e(()=>{rM();sM();cM();dM();fM();pM();vM();bM();wM();TM();xM();HM();tI();rI();sI();lI();dI();hI();pI();tu=class{createCasualConfiguration(t=!1){let e=this.createConfiguration(!1,t);return e.parsers.unshift(new hm),e.parsers.unshift(new fm),e.parsers.unshift(new qp),e.parsers.unshift(new mm),e.parsers.unshift(new vm),e}createConfiguration(t=!0,e=!1){return zM({parsers:[new gm(e),new Up(t),new jp,new Yp,new pm,new Zp,new Kp,new Jp(t),new em(t),new tm(t)],refiners:[new ym,new am,new im]},t)}}});var th,IC,mI=_e(()=>{Js();MC();th=class a{constructor(t){this.defaultConfig=new tu,t=t||this.defaultConfig.createCasualConfiguration(),this.parsers=[...t.parsers],this.refiners=[...t.refiners]}clone(){return new a({parsers:[...this.parsers],refiners:[...this.refiners]})}parseDate(t,e,r){let n=this.parse(t,e,r);return n.length>0?n[0].start.date():null}parse(t,e,r){let n=new IC(t,e,r),s=[];return this.parsers.forEach(o=>{let l=a.executeParser(n,o);s=s.concat(l)}),s.sort((o,l)=>o.index-l.index),this.refiners.forEach(function(o){s=o.refine(n,s)}),s}static executeParser(t,e){let r=[],n=e.pattern(t),s=t.text,o=t.text,l=n.exec(o);for(;l;){let c=l.index+s.length-o.length;l.index=c;let u=e.extract(t,l);if(!u){o=s.substring(l.index+1),l=n.exec(o);continue}let d=null;u instanceof eu?d=u:u instanceof Jt?(d=t.createParsingResult(l.index,l[0]),d.start=u):d=t.createParsingResult(l.index,l[0],u);let h=d.index,f=d.text;t.debug(()=>console.log(`${e.constructor.name} extracted (at index=${h}) '${f}'`)),r.push(d),o=s.substring(h+f.length),l=n.exec(o)}return r}},IC=class{constructor(t,e,r){this.text=t,this.reference=new Wd(e),this.option=r!=null?r:{},this.refDate=this.reference.instant}createParsingComponents(t){return t instanceof Jt?t:new Jt(this.reference,t)}createParsingResult(t,e,r,n){let s=typeof e=="string"?e:this.text.substring(t,e),o=r?this.createParsingComponents(r):null,l=n?this.createParsingComponents(n):null;return new eu(this.reference,t,s,o,l)}debug(t){this.option.debug&&(this.option.debug instanceof Function?this.option.debug(t):this.option.debug.debug(t))}}});var AC,gI,R8,u1e,vI=_e(()=>{mI();MC();AC=new tu,gI=new th(AC.createCasualConfiguration(!1)),R8=new th(AC.createConfiguration(!0,!1)),u1e=new th(AC.createConfiguration(!1,!0))});function rh(a,t,e){return B8.parse(a,t,e)}var B8,OC=_e(()=>{vI();B8=gI});function FC(a){let t=a.start;return t.isCertain("hour")||t.isCertain("minute")?"time":t.isCertain("day")?"day":t.isCertain("month")?"month":"year"}function ih(a){return a.hour!==0||a.minute!==0||a.second!==0||a.millisecond!==0?"time":a.day!==1?"day":a.month!==1?"month":"year"}function Pt(a,t={}){if(!a||!a.trim())return{error:"empty"};let e=a.trim(),r=$8.test(e),n=e.match(wI);if(n){let u=parseInt(n[1]);if(u>0){if(/^\s*\d+\s*(?:CE|ce|A\.D\.|AD|ad|a\.d\.)\s*$/i.test(e)){let f=gt.fromObject({year:u},{zone:t.timezone});if(f.isValid)return{start:f,precision:"year",approximate:r}}let h=[e.replace(wI,u.toString())];for(let f of h){let m=gt.fromISO(f,{zone:t.timezone});if(m.isValid)return{start:m,precision:ih(m),approximate:r};let g=gt.fromSQL(f,{zone:t.timezone});if(g.isValid)return{start:g,precision:ih(g),approximate:r}}try{let f=t.referenceDate,m=rh(e,f,{forwardDate:!!t.forwardDate});if(m&&m.length>0){let g=m[0],y=gt.fromJSDate(g.start.date(),{zone:t.timezone}),v=g.end?gt.fromJSDate(g.end.date(),{zone:t.timezone}):void 0,E=FC(g);return{start:y,end:v,precision:E,approximate:r}}}catch(f){}}}let s=e.match(bI);if(s){let u=parseInt(s[1]);if(u>0){let d=1-u;if(/^\s*\d+\s*(?:BC|bce|BCE|B\.C\.|B\.C|B\.C\.E\.|b\.c\.|b\.c\.e\.|bc|b\.c\.e)\s*$/i.test(e)){let m=gt.fromObject({year:d},{zone:t.timezone});if(m.isValid)return{start:m,precision:"year",approximate:r,isBCE:!0,originalYear:u}}let f=[e.replace(bI,d.toString()),d.toString()];for(let m of f){let g=gt.fromISO(m,{zone:t.timezone});if(g.isValid)return{start:g,precision:ih(g),approximate:r,isBCE:!0,originalYear:u};let y=gt.fromSQL(m,{zone:t.timezone});if(y.isValid)return{start:y,precision:ih(y),approximate:r,isBCE:!0,originalYear:u}}try{let m=t.referenceDate,g=rh(e,m,{forwardDate:!!t.forwardDate});if(g&&g.length>0){let y=g[0],v=y.start.date(),E=gt.fromJSDate(v,{zone:t.timezone});if(E.year<0||s){let C=y.end?gt.fromJSDate(y.end.date(),{zone:t.timezone}):void 0,_=FC(y),x=s||E.year<0,P=s?u:E.year===0?1:Math.abs(E.year),I=E;if(s){let M=1-u;I=E.set({year:M,month:E.month,day:E.day})}return{start:I,end:C,precision:_,approximate:r,isBCE:!0,originalYear:P}}}}catch(m){}}}let o=gt.fromISO(e,{zone:t.timezone});if(o.isValid){let u="day",d=e.trim();return/^\d{4}$/.test(d)?u="year":/^\d{4}-\d{2}$/.test(d)?u="month":/^\d{4}-\d{2}-\d{2}$/.test(d)?u="day":d.includes("T")||d.includes(":")&&d.includes(" ")?u="time":u=ih(o),{start:o,precision:u,approximate:r}}let l=gt.fromSQL(e,{zone:t.timezone});if(l.isValid)return{start:l,precision:ih(l),approximate:r};try{let u=t.referenceDate,d=rh(e,u,{forwardDate:!!t.forwardDate});if(d&&d.length>0){let h=d[0],f=gt.fromJSDate(h.start.date(),{zone:t.timezone}),m=h.end?gt.fromJSDate(h.end.date(),{zone:t.timezone}):void 0,g=FC(h);return{start:f,end:m,precision:g,approximate:r}}}catch(u){}let c=[["yyyy-MM","month"],["yyyy","year"],["LLL dd yyyy","day"],["LLLL dd yyyy","day"]];for(let[u,d]of c){let h=gt.fromFormat(e,u,{zone:t.timezone});if(h.isValid)return{start:h,precision:d,approximate:r}}return{error:"unparsed"}}function EI(a,t,e,r){if(!a)return"";if(e&&r){let s=a.month,o=a.day,l=r+" BCE";return s===1&&o===1?l:o===1?`${a.monthLong} ${l}`:`${a.monthLong} ${o}, ${l}`}return(t?a.setLocale(t):a).toLocaleString(gt.DATETIME_MED_WITH_WEEKDAY)}function to(a){return a==null?void 0:a.toMillis()}var $8,bI,wI,nh=_e(()=>{gC();OC();$8=/(circa|around|about|approx|~|approx\.)/i,bI=/\b(\d+)\s*(BC|bce|BCE|B\.C\.|B\.C|B\.C\.E\.|b\.c\.|b\.c\.e\.|bc|b\.c\.e)\b/i,wI=/\b(\d+)\s*(CE|ce|A\.D\.|AD|ad|a\.d\.)\b/i});var Xa={};At(Xa,{buildFrontmatter:()=>Ka,getWhitelistKeys:()=>Vi,parseFrontmatterFromContent:()=>RC,parseSectionsFromMarkdown:()=>Qn,toSafeFileName:()=>z8});function Vi(a){return TI[a]}function Ka(a,t,e,r){var h,f;let n=TI[a],s={},o=(h=r==null?void 0:r.customFieldsMode)!=null?h:"flatten",l=new Set(Object.keys(t||{})),c=r==null?void 0:r.originalFrontmatter,u=c?new Set(Object.keys(c)):new Set,d=t==null?void 0:t.customFields;if(d&&typeof d=="object"&&!Array.isArray(d)){let m=d;if(o==="flatten"){let g={};for(let[y,v]of Object.entries(m)){if(y==="customFields")continue;if(l.has(y)){g[y]=v;continue}if(u.has(y)){s[y]=v;continue}if(v!=null){if(typeof v=="string"&&v.includes(`
`)){g[y]=v;continue}Array.isArray(v)&&v.length===0||typeof v=="object"&&Object.keys(v).length===0||(s[y]=v)}}Object.keys(g).length>0&&(s.customFields=g)}else Object.keys(m).length>0&&(s.customFields=m)}for(let[m,g]of Object.entries(t||{})){if(!(n.has(m)||((f=e==null?void 0:e.has(m))!=null?f:!1))||m==="customFields"&&o==="flatten")continue;if(u.has(m)){s[m]=g;continue}if(g!=null){if(typeof g=="string"){if(g.includes(`
`))continue;s[m]=g;continue}if(Array.isArray(g)){if(g.length===0)continue;s[m]=g;continue}if(typeof g=="object"){if(Object.keys(g).length===0)continue;s[m]=g;continue}s[m]=g}}if(c)for(let[m,g]of Object.entries(c))m!=="position"&&(m in s||(s[m]=g));if(c){let m={};for(let g of Object.keys(c))g!=="position"&&g in s&&(m[g]=s[g]);for(let[g,y]of Object.entries(s))g in m||(m[g]=y);return m}return s}function Qn(a){let t={};if(!a)return t;if(a.includes("##")){let e=a.split(`
`),r="",n=[];for(let s of e)if(s.startsWith("##")){if(r){let o=n.join(`
`).trim();t[r]=o}r=s.replace(/^##\s*/,"").trim(),n=[]}else r&&n.push(s);if(r){let s=n.join(`
`).trim();t[r]=s}}return Object.keys(t).length>0,t}function RC(a){if(!a||!a.startsWith("---"))return;let t=a.indexOf(`
---`,3);if(t===-1)return;let e=a.substring(3,t).trim();if(!e)return{};try{try{if(Gy.parseYaml&&typeof Gy.parseYaml=="function"){let s=(0,Gy.parseYaml)(e);if(s&&typeof s=="object"&&!Array.isArray(s))return s}}catch(s){}let r=e.split(`
`),n={};for(let s=0;s<r.length;s++){let o=r[s];if(o.startsWith("  ")||o.startsWith("	"))continue;let l=o.indexOf(":");if(l===-1)continue;let c=o.substring(0,l).trim();if(!c)continue;let u=o.substring(l+1).trim();if(u===""&&s+1<r.length&&r[s+1].trim().startsWith("-")){let h=[];for(s++;s<r.length&&r[s].trim().startsWith("-");){let f=r[s].trim().substring(1).trim();h.push(f),s++}s--,n[c]=h;continue}if(u===""||u==="null"||u==="~"){n[c]=null;continue}if(u.startsWith('"')&&u.endsWith('"')||u.startsWith("'")&&u.endsWith("'")){n[c]=u.substring(1,u.length-1);continue}if(u==="true"){n[c]=!0;continue}if(u==="false"){n[c]=!1;continue}let d=Number(u);if(!isNaN(d)&&u!==""){n[c]=d;continue}n[c]=u}return n}catch(r){console.warn("Error parsing frontmatter from content:",r);return}}function z8(a,t="Untitled"){return(a&&a.trim()?a:t).replace(/[\\/:"*?<>|#^\[\]{}]+/g,"")}var Gy,TI,oi=_e(()=>{Gy=require("obsidian"),TI={character:new Set(["id","name","traits","relationships","locations","events","status","affiliation","groups","profileImagePath","customFields","connections"]),location:new Set(["id","name","locationType","region","status","parentLocation","groups","profileImagePath","customFields","connections"]),event:new Set(["id","name","dateTime","characters","location","status","groups","profileImagePath","customFields","connections","isMilestone","dependencies","progress","tags","narrativeMarkers","narrativeSequence"]),item:new Set(["id","name","isPlotCritical","currentOwner","pastOwners","currentLocation","associatedEvents","groups","profileImagePath","customFields","connections"]),reference:new Set(["id","name","category","tags","profileImagePath"]),chapter:new Set(["id","name","number","tags","profileImagePath","linkedCharacters","linkedLocations","linkedEvents","linkedItems","linkedGroups"]),scene:new Set(["id","name","chapterId","chapterName","status","priority","tags","profileImagePath","linkedCharacters","linkedLocations","linkedEvents","linkedItems","linkedGroups"]),map:new Set(["id","name","scale","parentMapId","childMapIds","backgroundImagePath","mapData","width","height","defaultZoom","center","bounds","markers","layers","gridEnabled","gridSize","profileImagePath","linkedLocations","groups","customFields","created","modified"]),culture:new Set(["id","name","profileImagePath","languages","techLevel","governmentType","status","population","linkedLocations","linkedCharacters","linkedEvents","relatedCultures","parentCulture","groups","customFields","connections"]),faction:new Set(["id","name","profileImagePath","factionType","strength","status","militaryPower","economicPower","politicalInfluence","colors","emblem","motto","members","territories","factionRelationships","linkedEvents","linkedCulture","parentFaction","subfactions","groups","customFields","connections"]),economy:new Set(["id","name","profileImagePath","economicSystem","status","currencies","resources","tradeRoutes","linkedLocations","linkedFactions","linkedCultures","linkedEvents","groups","customFields","connections"]),magicSystem:new Set(["id","name","profileImagePath","systemType","rarity","powerLevel","status","materials","categories","abilities","consistencyRules","linkedCharacters","linkedLocations","linkedCultures","linkedEvents","linkedItems","groups","customFields","connections"]),calendar:new Set(["id","name","profileImagePath","calendarType","status","epoch","eras","months","daysPerWeek","hoursPerDay","linkedEvents","linkedCultures","groups","customFields","connections"])}});var SI,_I=_e(()=>{SI={dashboardTitle:"Storyteller suite",openDashboard:"Open dashboard",createNew:"Create new",uploadImage:"Upload Image",image:"Image",storyCreated:'Story "{0}" created and activated.',created:'{0} "{1}" created.',updated:'{0} "{1}" updated.',movedToTrash:'{0} "{1}" moved to trash.',imageUploaded:"Image uploaded: {0}",errorUploadingImage:"Error uploading image. Please try again.",noteCreatedWithSections:"Note created with standard sections for easy editing.",workspaceLeafCreateError:"Error opening dashboard: Could not create workspace leaf.",workspaceLeafRevealError:"Error revealing dashboard: Workspace leaf not found.",errorCannotDeleteWithoutFilePath:"Error: Cannot delete {0} without file path.",errorCannotOpenNoteWithoutFilePath:"Error: Cannot open {0} note without file path.",remoteImagesBlocked:"Remote images are blocked by settings. Import the image to your gallery to use it safely.",importImage:"Import image",language:"Language",selectLanguage:"Select language",english:"English",chinese:"Chinese (\u4E2D\u6587)",languageChanged:"Language changed. Reload plugin for full effect.",name:"Name",description:"Description",backstory:"Backstory",history:"History",location:"Location",character:"Character",event:"Event",item:"Item",reference:"Reference",chapter:"Chapter",scene:"Scene",group:"Group",characters:"Characters",locations:"Locations",events:"Events",items:"Items",references:"References",chapters:"Chapters",scenes:"Scenes",groups:"Groups",gallery:"Gallery",timeline:"Timeline",create:"Create",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",view:"View",upload:"Upload",import:"Import",export:"Export",refresh:"Refresh",createNewCharacter:"Create new character",editCharacter:"Edit character",createNewLocation:"Create new location",editLocation:"Edit location",createNewEvent:"Create new event",editEvent:"Edit event",createNewItem:"Create new item",editItem:"Edit item",createNewReference:"Create new reference",editReference:"Edit reference",createNewChapter:"Create new chapter",editChapter:"Edit chapter",createNewScene:"Create new scene",editScene:"Edit scene",createNewGroup:"Create new group",editGroup:"Edit group",tags:"Tags",summary:"Summary",content:"Content",number:"Number",orderingNumber:"Ordering number (optional)",category:"Category",createCharacter:"Create character",createLocation:"Create location",createEvent:"Create event",createItem:"Create item",createReference:"Create reference",createChapter:"Create chapter",createScene:"Create scene",createGroup:"Create group",saveChanges:"Save changes",deleteCharacter:"Delete character",deleteLocation:"Delete location",deleteEvent:"Delete event",deleteItem:"Delete item",deleteReference:"Delete reference",deleteChapter:"Delete chapter",deleteScene:"Delete scene",deleteGroup:"Delete group",add:"Add",clear:"Clear",ok:"OK",confirm:"Confirm",selectBtn:"Select",previewBtn:"Preview",editBtn:"Edit",openNoteBtn:"Open Note",flattenCustomFields:"Flatten to native keys (recommended)",nestedCustomFields:"Nested under customFields (YAML map)",noGrouping:"No grouping",byLocation:"By location",byGroup:"By group",noneOption:"None",fitOption:"Fit",decadeOption:"Decade",centuryOption:"Century",customFoldersPlaceholderWarning:'Custom folders use {story*} placeholders. Select or create an active story, then click "Rescan custom folders".',openNote:"Open note",createGroupBtn:"Create group",createChapterBtn:"Create chapter",createSceneBtn:"Create scene",createReferenceBtn:"Create reference",viewCharacters:"View characters",viewLocations:"View locations",viewEvents:"View events",viewItems:"View items",viewReferences:"View references",viewChapters:"View chapters",viewScenes:"View scenes",viewGroups:"View groups",viewTimeline:"View timeline",openTimelinePanel:"Open timeline panel",viewGallery:"View gallery",selectOrCreateStoryFirst:"Select or create a story first.",selectGroupPlaceholder:"-- Select group --",affiliation:"Affiliation",groupsHelpCharacter:"Assign this character to one or more groups.",members:"Members",noCustomFields:"No custom fields defined.",selectFromGallery:"Select from gallery",clearImage:"Clear image",addImage:"Add image",imageGallery:"Image gallery",filter:"Filter",search:"Search",storyName:"Story Name",createNewStory:"Create new story",plotItems:"Plot items",title:"Title",caption:"Caption",fit:"Fit",decade:"Decade",century:"Century",today:"Today",copyRange:"Copy range",stackItems:"Stack items",goToChapter:"Go to chapter",unassigned:"Unassigned",chapterTitlePh:"Chapter title",sceneTitlePh:"Scene title",numberEg:"e.g., 1",tagsPh:"tag1, tag2",briefChapterSummaryPh:"Brief summary for this chapter...",writeYourScenePh:"Write your scene...",beatSheet:"Beat sheet (one per line)",beatSheetExample:"- Meet the mentor\\n- The refusal",stories:"Stories",active:"Active",setActive:"Set Active",editStory:"Edit Story",storyDiscovery:"Story discovery",refreshDiscovery:"Refresh discovery",galleryUploadFolder:"Gallery upload folder",timelineAndParsing:"Timeline and parsing",customFieldsSerialization:"Custom fields serialization",forwardDateBias:"Forward-date bias for natural language parsing",customToday:"Custom today (timeline reference)",defaultTimelineGrouping:"Default timeline grouping",defaultZoomPreset:"Default zoom preset",defaultStacking:"Default stacking",defaultDensity:"Default density",showLegendByDefault:"Show legend by default",timelineDefaultHeight:"Timeline default height",useCustomEntityFolders:"Use custom entity folders",previewResolvedFolders:"Preview resolved folders",storyRootFolderOptional:"Story root folder (optional)",charactersFolder:"Characters folder",locationsFolder:"Locations folder",eventsFolder:"Events folder",itemsFolder:"Items folder",referencesFolder:"References folder",scenesFolder:"Scenes folder",chaptersFolder:"Chapters folder",oneStoryMode:"One Story Mode",oneStoryBaseFolder:"One Story base folder",showTutorialSection:"Show tutorial section",support:"Support",supportDevelopment:"Support development",about:"About",pluginInformation:"Plugin information",buyMeACoffee:"Buy me a coffee",github:"GitHub",preview:"Preview",clearCustomToday:"Clear custom today",enterCharacterName:"Enter character name",characterDescriptionPh:"A brief description of the character...",traitsPlaceholder:"e.g., Brave, Curious, Stubborn",characterHistoryPh:"The character's history...",statusPlaceholderCharacter:"e.g., Alive, Deceased, Missing",enterItemName:"Enter item name",itemDescriptionPh:"A visual description of the item...",itemHistoryPh:"The item's origin, past, and significance...",enterLocationName:"Enter location name",locationDescriptionPh:"A brief description of the location...",locationHistoryPh:"The location's history and past events...",statusPlaceholderLocation:"e.g., Active, Ruins, Abandoned",enterEventName:"Enter event name",eventDescriptionPh:"A description of the event...",eventOutcomePh:"The result or consequences of the event...",enterDateTime:"Enter date/time",statusPlaceholderEvent:"e.g., Upcoming, Completed, Ongoing, key plot point",dateTime:"Date/time",outcome:"Outcome",status:"Status",charactersInvolved:"Characters involved",associatedImages:"Associated images",links:"Links",relationships:"Relationships & Location",currentOwner:"Current Owner",currentLocation:"Current Location",plotCritical:"Plot Critical",traits:"Traits",profileImage:"Profile image",itemImage:"Item Image",selectOwner:"Select Owner",selectLocation:"Select Location",changeLocation:"Change location",clearLocation:"Clear location (set to none)",parentLocation:"Parent Location",selectParentLocation:"Select Parent Location",clearParentLocation:"Clear parent location",addCharacter:"Add character",addCustomField:"Add custom field",fieldName:"Field name",fieldValue:"Field value",customFieldValueTitle:"Custom field value",newCustomFieldTitle:"New custom field",valueForX:'Value for "{0}"',fieldNameCannotBeEmpty:"Field name cannot be empty",thatNameIsReserved:"That name is reserved",fieldAlreadyExists:"A field with that name already exists",characterNameRequired:"Character name cannot be empty.",eventNameRequired:"Event name cannot be empty.",itemNameRequired:"Item name cannot be empty.",customFields:"Custom fields",select:"Select",current:"Current",none:"None",removeX:"Remove {0}",removeFieldX:'Remove field "{0}"',filterX:"Filter {0}",searchX:"Search {0}...",networkGraph:"Network Graph",relationshipType:"Relationship type",relationshipTypes:"Relationship types",relationshipTypeDesc:"Choose the type of relationship",relationshipLabelDesc:"Optional custom label for this relationship",exampleRelationshipLabel:"e.g., Best friend, Sibling, Business partner",addRelationship:"Add relationship",editRelationship:"Edit relationship",targetEntity:"Target entity",pleaseSelectTarget:"Please select a target entity",ally:"Ally",enemy:"Enemy",family:"Family",rival:"Rival",romantic:"Romantic",mentor:"Mentor",acquaintance:"Acquaintance",neutral:"Neutral",custom:"Custom",filterByGroup:"Filter by group",filterByTimeline:"Filter by timeline",filterByEntityTypes:"Filter by entity types",exportGraph:"Export graph",toggleEdgeLabels:"Toggle edge labels",showLegend:"Show legend",legend:"Legend",noRelationshipsFound:"No relationships found. Add connections between entities to visualize them in the network graph.",storyBoard:"Story Board",createStoryBoard:"Create Story Board",updateStoryBoard:"Update Story Board",openStoryBoard:"Open Story Board",storyBoardCreated:"Story board created!",storyBoardUpdated:"Story board updated!",storyBoardUpdatedPreserved:"Story board updated! Manual edits preserved.",overwriteStoryBoard:"Overwrite Story Board?",createStoryBoardPrompt:"Create Story Board?",createStoryBoardMessage:"No story board found. Would you like to create one?",storyBoardExistsMessage:"A story board already exists. Do you want to overwrite it?",noScenesForStoryBoard:"No scenes found. Create some scenes first!",noStoryBoardFound:'No story board found. Create one first using "Create Story Board".',errorOpeningStoryBoard:"Error opening story board. See console for details.",storyBoardEmpty:"No scenes found. The story board will be empty.",errorReadingStoryBoard:"Error reading existing story board. It may be corrupted.",errorUpdatingStoryBoard:"Error updating story board. See console for details.",storyBoardLayout:"Story board layout",storyBoardLayoutDesc:"Choose how to organize scenes on the canvas",layoutByChapters:"By Chapters",layoutByTimeline:"By Timeline",layoutByStatus:"By Status (Kanban)",storyBoardColorBy:"Color scenes by",storyBoardColorByDesc:"Choose what determines scene card colors",colorByStatus:"Status (Draft, WIP, etc.)",colorByChapter:"Chapter",colorByNone:"None",storyBoardShowEdges:"Show scene flow arrows",storyBoardShowEdgesDesc:"Display arrows connecting scenes in sequence",storyBoardCardSize:"Card size",storyBoardCardWidth:"Card width",storyBoardCardHeight:"Card height",graphFilters:"Graph filters",timelineStart:"Timeline start",timelineEnd:"Timeline end",timelineRangeSeparator:" / ",selectEntityTypes:"Select entity types",applyFilters:"Apply filters",resetFilters:"Reset filters",exportAsPNG:"Export as PNG",exportAsJPG:"Export as JPG",graphExported:"Graph exported.",connections:"Connections",searchEntities:"Search entities...",zoomIn:"Zoom In",zoomOut:"Zoom Out",fitToView:"Fit to View",layout:"Layout",forceDirected:"Force-Directed",circle:"Circle",grid:"Grid",concentric:"Concentric",nodeTypes:"Node Types",interactions:"Interactions",addConnection:"Add connection",noConnectionsYet:"No connections yet.",label:"Label",optional:"(Optional)",all:"All",milestone:"Milestone",milestoneDesc:"Mark this event as a key story moment",progress:"Progress",progressDesc:"Completion percentage (0-100)",dependencies:"Dependencies",dependenciesDesc:"Events that must occur before this one",addDependency:"Add Dependency",editMode:"Edit Mode",lockMode:"Lock Mode",editModeTooltip:"Edit mode (drag to reschedule)",filters:"Filters",milestonesOnly:"Milestones Only",milestonesOnlyDesc:"Show only milestone events",filterByCharacter:"Filter by Character",filterByLocation:"Filter by Location",clearAllFilters:"Clear All Filters",selectCharacterFilter:"Select character...",selectLocationFilter:"Select location...",selectGroupFilter:"Select group...",characterFilter:"Character:",locationFilter:"Location:",groupFilter:"Group:",eventRescheduled:'Event "{0}" rescheduled',editModeEnabled:"Edit mode enabled - drag events to reschedule",editModeDisabled:"Edit mode disabled",dependencyAdded:'Dependency "{0}" already added',byCharacter:"By character",ganttView:"Gantt View",timelineView:"Timeline View",switchedToGantt:"Switched to Gantt view",switchedToTimeline:"Switched to Timeline view",entityTypes:"Entity Types",openInPanel:"Open in Panel",openInModal:"Open in Modal",close:"Close",manageTimelineEras:"Manage Timeline Eras & Periods",addEra:"Add Era",eraType:"Era Type",startDate:"Start Date",endDate:"End Date",eraColor:"Era Color",manageTimelineTracks:"Manage Timeline Tracks",addTrack:"Add Track",trackType:"Track Type",trackColor:"Track Color",newStory:"+ New story",noCharactersFound:'No characters found. Click "Create new" to add your first character.',noLocationsFound:"No locations found.",noEventsFound:"No events found.",noItemsFound:"No items found.",noImagesFound:"No images found.",noGroupsFound:"No groups found.",noReferencesFound:"No references found.",noChaptersFound:"No chapters found.",noScenesFound:"No scenes found.",matchingFilter:" Matching filter.",filterItems:"Filter Items",filterGroups:"Filter groups",noMembers:"No members.",enterGroupName:"Enter group name",describeGroupPh:"Describe this group...",color:"Color",colorPlaceholder:"#RRGGBB or color name",groupNameRequired:"Group name is required.",groupNameExists:"A group with this name already exists. Please choose a different name.",addImageDetails:"Add image details",editImageDetails:"Edit image details",commaSeparatedTags:"Comma-separated tags.",commaSeparatedCharacterNames:"Comma-separated character names.",commaSeparatedLocationNames:"Comma-separated location names.",commaSeparatedEventNames:"Comma-separated event names.",saveDetails:"Save details",removeFromGallery:"Remove from gallery",imageDetailsSaved:'Image details for "{0}" saved.',imageRemovedFromGallery:'Image "{0}" removed from gallery.',confirmDeleteScene:'Delete scene "{0}"?',confirmDeleteReference:'Delete reference "{0}"?',confirmDeleteChapter:'Delete chapter "{0}"?',confirmDeleteGroup:'Are you sure you want to delete group "{0}"?',confirmDeleteCharacter:'Are you sure you want to delete "{0}"?',confirmDeleteEvent:'Are you sure you want to delete the event "{0}"? This will move the note to system trash.',confirmDeleteLocation:'Are you sure you want to delete "{0}"?',confirmDeleteItem:'Are you sure you want to delete "{0}"?',confirmDeleteStory:'Delete story "{0}"? This cannot be undone.',confirmRemoveImageFromGallery:'Are you sure you want to remove "{0}" from the gallery? This does not delete the file itself.',confirmDeleteCharacterTrash:'Are you sure you want to delete "{0}"? This will move the file to system trash.',confirmDeleteItemTrash:'Are you sure you want to delete "{0}"? This will move the file to system trash.',sceneCreated:'Scene "{0}" created.',sceneUpdated:'Scene "{0}" updated.',chapterCreated:'Chapter "{0}" created.',chapterUpdated:'Chapter "{0}" updated.',referenceCreated:'Reference "{0}" created.',referenceUpdated:'Reference "{0}" updated.',groupCreated:'Group "{0}" created.',groupRenamed:'Group renamed to "{0}".',groupDeleted:'Group "{0}" deleted.',characterDeleted:'Character "{0}" deleted.',locationDeleted:'Location "{0}" deleted.',itemDeleted:'Item "{0}" deleted.',fileMovedToTrash:"{0} file moved to trash.",characterLinkedAlready:'Character "{0}" is already linked.',failedToDelete:"Failed to delete {0}.",failedToSave:"Failed to save {0}.",customFieldError:"Custom field name must be unique, non-empty, and not reserved.",sceneNameRequired:"Scene title is required.",chapterNameRequired:"Chapter title is required.",locationNameRequired:"Location name cannot be empty.",circularLocationError:"Cannot set parent location: This would create a circular reference.",errorLoadingCharacters:"Error loading characters. Check console.",errorLoadingLocations:"Error loading locations. Check console.",errorLoadingEvents:"Error loading events. Check console.",errorLoadingItems:"Error loading items. Check console.",groupNotFound:"Group not found.",noGroupsToRename:"No groups to rename.",noGroupsToDelete:"No groups to delete.",couldNotFindNote:"Could not find the note file.",autoDetectedStories:"Storyteller: Auto-detected and imported {0} new story folder(s).",errorDiscoveringStories:"Storyteller Suite: Error discovering stories: {0}",storiesRefreshed:"Storyteller: Found and imported {0} new story folder(s).",noNewStoriesFound:"Storyteller: No new story folders found.",errorRefreshingStories:"Storyteller Suite: Error refreshing stories: {0}",errorScanningFolders:"Storyteller Suite: Error scanning custom folders: {0}",couldNotAutoDetect:"Storyteller: Could not auto-detect a story root. Please set folders manually.",autoDetectedFolders:'Storyteller: Auto-detected custom folders under "{0}" (matches: {1}).',uploadedToVault:'Uploaded "{0}" to vault.',errorUploadingFile:"Error uploading file. Check console for details.",errorParsingFile:"Error parsing file: {0}",currentValue:"Current: {0}",ownerValue:"Owner: {0}",noImagesFoundFilter:"No images found. Matching filter.",tutorialGettingStarted:"Tutorial and getting started",type:"Type",region:"Region",storyNameField:"Story Name",descriptionField:"Description",beatSheetPh:`- Meet the mentor
- The refusal`,categoryPh:"Language, Prophecy, Inspiration, Misc, ...",fieldNamePh:"Field name",fieldValuePh:"Field value",galleryUploadFolderPh:"StorytellerSuite/GalleryUploads",customTodayPh:"YYYY-MM-DD or full ISO (supports BCE dates)",timelineHeightPh:"e.g., 380px",storyRootFolderPh:"Creative/Writing/{storyName}",charactersFolderPh:"MyStory/Characters",locationsFolderPh:"MyStory/Locations",eventsFolderPh:"MyStory/Events",itemsFolderPh:"MyStory/Items",referencesFolderPh:"MyStory/References",scenesFolderPh:"MyStory/Scenes",chaptersFolderPh:"MyStory/Chapters",oneStoryBaseFolderPh:"StorytellerSuite",enterStoryNamePh:"Enter story name",describeStoryPh:"Describe your story (optional)",selectImageFilePh:"Select an image file...",filterImagesPh:"Filter by title, tag, link...",selectItemPh:"Select an item to link...",selectEventLocationPh:"Select the event's location...",selectParentLocationPh:"Select a parent location...",selectGroupPh:"Select a group\u2026",filterFoldersPh:"Type to filter folders\u2026",selectGalleryImagePh:"Select an image from the gallery...",selectEventPh:"Select an event to link...",selectCharacterPh:"Select a character to link...",priorityInChapter:"Priority in chapter",priorityEg:"e.g., 1",beatSheetOneLine:"Beat sheet one line",writeScenePh:"Write your scene...",scanVaultDesc:"Scan your vault for existing Storyteller stories and import them. Useful after moving folders or changing structure.",galleryFolderDesc:"Folder where uploaded gallery images will be stored",customFieldsDesc:"Choose how custom fields are stored in frontmatter",forwardDateBiasDesc:'Prefer future interpretation for relative dates (e.g., "Friday")',customTodayDesc:"Optional date used for the Today button and relative parsing. Supports BCE dates (e.g., 2024-01-15 for CE, or -00499-01-01 for 500 BCE). Leave empty to use system today.",timelineHeightDesc:"Adjust the height of the timeline modal",useCustomFoldersDesc:"When enabled, use the folder paths below. You can include {storyName}, {storySlug}, or {storyId} to make per-story folders (e.g., Creative/Writing/{storyName}/Characters).",previewFoldersDesc:"See each entity's resolved folder path based on current settings and active story",storyRootDesc:"Base path template for all entities. Supports {storyName}, {storySlug}, {storyId}. Example: Creative/Writing/{storyName}",charactersFolderDesc:"Path for character markdown files (placeholders allowed: {storyName}, {storySlug}, {storyId})",locationsFolderDesc:"Path for location markdown files (placeholders allowed: {storyName}, {storySlug}, {storyId})",eventsFolderDesc:"Path for event markdown files (placeholders allowed: {storyName}, {storySlug}, {storyId})",itemsFolderDesc:"Path for item markdown files (placeholders allowed: {storyName}, {storySlug}, {storyId})",referencesFolderDesc:"Path for reference markdown files (placeholders allowed: {storyName}, {storySlug}, {storyId})",scenesFolderDesc:"Path for scene markdown files (placeholders allowed: {storyName}, {storySlug}, {storyId})",chaptersFolderDesc:"Path for chapter markdown files (placeholders allowed: {storyName}, {storySlug}, {storyId})",oneStoryModeDesc:"Flatten the folder structure to a single story. When enabled (and custom folders disabled), content goes under a single base folder without Stories/StoryName.",oneStoryBaseFolderDesc:"Base folder for Characters/Locations/Events/Items/References/Chapters",showTutorialDesc:"Display the tutorial and getting started section in settings",supportDevDesc:"If you find this plugin helpful, consider supporting its development",pluginInfoDesc:"Storyteller Suite - A comprehensive suite for managing characters, locations, events, and galleries for your stories.",storyNameDesc:"Required. Must be unique.",descriptionOptionalDesc:"Optional",locationNameDesc:"The location's name.",locationTypeDesc:"e.g., City, Forest, Castle, Tavern",locationRegionDesc:"Broader geographic area.",locationStatusDesc:"e.g., Active, Ruins, Abandoned",parentLocationDesc:"Select a parent location that contains this location.",assignToGroupsDesc:"Assign this location to one or more groups.",manageGroupsDesc:"Manage your groups. Shared across all entity types.",searchGroupsDesc:"Search by group name or description.",manageCharactersDesc:"Manage your story characters.",manageLocationsDesc:"Manage your story locations.",manageEventsDesc:"Manage your story events.",manageImagesDesc:"Manage your story images.",assignEventToGroupsDesc:"Assign this event to one or more groups.",assignItemToGroupsDesc:"Assign this item to one or more groups.",assignCharacterToGroupsDesc:"Assign this character to one or more groups.",nodesLabel:"Nodes",edgesLabel:"Edges",filteredLabel:"Filtered",loadingNodes:"Loading nodes",emptyGraphTitle:"No entities to display",emptyGraphMessage:"Create characters, locations, events, or items to see them in the network graph.",emptyGraphTip:"Add relationships between entities to see connections visualized here.",keyboardShortcuts:"Keyboard Shortcuts",graphUpdated:"Graph updated",filterApplied:"Filter applied",layoutChanged:"Layout changed",graphFitToView:"Fit graph to view",showingXNodes:"Showing {0} node",showingXEdges:"{0} edge",noNodesVisible:"No nodes visible with current filters",createNewEconomy:"Create new economy",createEconomy:"Create economy",editEconomy:"Edit economy",deleteEconomy:"Delete economy",viewEconomies:"View economies",economies:"Economies",economy:"Economy",economicSystem:"Economic System",economicSystemDesc:"Type of economic organization",economyNameDesc:'Name of the economic system (e.g., "Kingdom of Eldoria Economy")',industries:"Industries",industriesDesc:"Major industries, production, and economic activities",taxation:"Taxation & Trade Policy",taxationDesc:"Tax system, trade regulations, and economic policies",representativeImage:"Representative Image",barterEconomy:"Barter Economy",marketEconomy:"Market Economy",commandEconomy:"Command Economy",mixedEconomy:"Mixed Economy",feudalEconomy:"Feudal Economy",giftEconomy:"Gift Economy",booming:"Booming",growing:"Growing",recession:"Recession",depression:"Depression",recovering:"Recovering",economyNameRequired:"Economy name is required",economyStatusDesc:"Current economic health state",economyDescriptionDesc:"Overview and characteristics of the economic system",noEconomiesFound:"No economies found",searchEconomies:"Search economies...",confirmDeleteEconomy:'Are you sure you want to delete economy "{0}"? This will move the note to system trash.',economyCreated:'Economy "{0}" created.',economyUpdated:'Economy "{0}" updated.',economyDeleted:'Economy "{0}" deleted.',createNewCulture:"Create new culture",createCulture:"Create culture",editCulture:"Edit culture",deleteCulture:"Delete culture",viewCultures:"View cultures",cultures:"Cultures",culture:"Culture",cultureNameDesc:"Name of the culture or society",techLevel:"Technology Level",techLevelDesc:"Technological advancement of the culture",governmentType:"Government Type",governmentTypeDesc:"Political system and leadership structure",languages:"Languages",languagesDesc:"Comma-separated list of languages spoken (e.g., Common, Elvish, Dwarvish)",population:"Population",populationDesc:'Estimated population size (e.g., "10,000" or "Large")',valuesBeliefs:"Values & Beliefs",valuesBeliefsDesc:"Core cultural values, worldview, and philosophical beliefs",religion:"Religion",religionDesc:"Religious beliefs, practices, and deities worshipped",socialStructure:"Social Structure",socialStructureDesc:"Class hierarchy, social organization, and caste systems",namingConventions:"Naming Conventions",namingConventionsDesc:"How members of this culture name people, places, and things",customsTraditions:"Customs & Traditions",customsTraditionsDesc:"Cultural practices, ceremonies, holidays, and traditions",cultureStatusDesc:"Current state of the culture",cultureDescriptionDesc:"Overview and key characteristics of the culture",cultureHistoryDesc:"Origins, major historical events, and cultural evolution",stoneAge:"Stone Age",bronzeAge:"Bronze Age",ironAge:"Iron Age",medieval:"Medieval",renaissance:"Renaissance",industrial:"Industrial",modern:"Modern",futuristic:"Futuristic",monarchy:"Monarchy",democracy:"Democracy",republic:"Republic",theocracy:"Theocracy",tribal:"Tribal",empire:"Empire",feudal:"Feudal",oligarchy:"Oligarchy",anarchy:"Anarchy",thriving:"Thriving",stable:"Stable",declining:"Declining",extinct:"Extinct",emerging:"Emerging",cultureNameRequired:"Culture name is required",noCulturesFound:"No cultures found",searchCultures:"Search cultures...",confirmDeleteCulture:'Delete culture "{0}"? This will move the note to system trash.',cultureCreated:'Culture "{0}" created.',cultureUpdated:'Culture "{0}" updated.',cultureDeleted:'Culture "{0}" deleted.',createNewMagicSystem:"Create new magic system",createMagicSystem:"Create magic system",editMagicSystem:"Edit magic system",deleteMagicSystem:"Delete magic system",viewMagicSystems:"View magic systems",magicSystems:"Magic Systems",magicSystem:"Magic System",magicSystemNameDesc:'Name of the magic system (e.g., "Arcane Arts", "Divine Magic")',systemType:"System Type",systemTypeDesc:"Source or category of magical power",rarity:"Rarity",rarityDesc:"How common is magic in the world?",powerLevel:"Power Level",powerLevelDesc:"Overall potency of this magic system",rulesMechanics:"Rules & Mechanics",rulesMechanicsDesc:"How magic is used, cast, or channeled",source:"Source",sourceDesc:"Where does magical power come from?",costsConsequences:"Costs & Consequences",costsConsequencesDesc:"What does using magic cost the caster?",limitations:"Limitations",limitationsDesc:"What are the boundaries and restrictions of this magic?",trainingLearning:"Training & Learning",trainingLearningDesc:"How is magic learned and mastered?",arcane:"Arcane (Learned)",divine:"Divine (Faith-based)",natural:"Natural (Nature/Druidic)",psionic:"Psionic (Mind Powers)",bloodMagic:"Blood Magic",elemental:"Elemental",necromancy:"Necromancy",alchemy:"Alchemy",runeMagic:"Rune Magic",ubiquitous:"Ubiquitous (Everyone has it)",common:"Common (Many have it)",uncommon:"Uncommon (Some have it)",rare:"Rare (Few have it)",legendary:"Legendary (Almost none)",low:"Low (Subtle effects)",moderate:"Moderate (Noticeable effects)",high:"High (Powerful effects)",godlike:"Godlike (Reality-bending)",forbidden:"Forbidden",lostKnowledge:"Lost Knowledge",resurgent:"Resurgent",magicSystemNameRequired:"Magic system name is required",noMagicSystemsFound:"No magic systems found",searchMagicSystems:"Search magic systems...",confirmDeleteMagicSystem:'Delete magic system "{0}"? This will move the note to system trash.',magicSystemCreated:'Magic System "{0}" created.',magicSystemUpdated:'Magic System "{0}" updated.',magicSystemDeleted:'Magic System "{0}" deleted.',magicSystemStatusDesc:"Current state of the magic system",magicSystemDescriptionDesc:"Overview and explanation of the magic system",magicSystemHistoryDesc:"Origins, discovery, and evolution of the magic system",startFromTemplate:"Start from Template",startFromTemplateDesc:"Optionally start with a pre-configured template",chooseTemplate:"Choose Template",selectTemplate:"Select a template",templateApplied:'Template "{0}" applied',noTemplatesAvailable:"This template does not contain any items",cannotDeleteWithoutPath:"Cannot delete without file path.",cannotOpenWithoutPath:"Cannot open note without file path.",templates:"Templates",entityTemplates:"Entity Templates",browseManageTemplates:"Browse and manage reusable templates for characters, locations, and other entities.",createNewTemplate:"Create New Template",templateCreated:'Template "{0}" created!',searchTemplates:"Search",searchTemplatesPlaceholder:"Search templates by name, description, or tags...",genre:"Genre",allGenres:"All Genres",templateCategory:"Category",allTemplateCategories:"All Categories",singleEntity:"Single Entity",entitySet:"Entity Set",fullWorld:"Full World",sortBy:"Sort By",sortByName:"Name",sortByUsage:"Usage Count",sortByRecent:"Recently Used",showBuiltIn:"Show Built-in",showCustom:"Show Custom",noTemplatesFound:"No templates found. Try adjusting your filters or create a new template.",foundXTemplates:"Found {0} template",builtIn:"Built-in",usedXTimes:"Used: {0}x",contains:"Contains: ",useTemplate:"Use Template",applyTemplate:"Apply Template",duplicate:"Duplicate",templateSelected:'Template "{0}" selected. Apply this template from the entity creation modal.',templateDeleted:'Template "{0}" deleted.',failedToDeleteTemplate:"Failed to delete template: {0}",templateCopySuffix:" (Copy)",templateDuplicated:'Template duplicated as "{0}"',failedToDuplicateTemplate:"Failed to duplicate template: {0}",deleteTemplate:"Delete Template?",confirmDeleteTemplate:'Are you sure you want to delete the template "{0}"? This action cannot be undone.',dashboardTabVisibility:"Dashboard Tab Visibility",dashboardTabVisibilityDesc:"Choose which tabs to show in the dashboard sidebar. Hidden tabs will not appear in the tab bar.",tabIsVisible:"Tab is visible",tabIsHidden:"Tab is hidden",tabShown:"{0} tab shown",tabHidden:"{0} tab hidden",refreshDashboardToSeeChanges:". Refresh the dashboard to see changes.",ganttViewSettings:"Gantt View Settings",showProgressBarsInGantt:"Show progress bars in Gantt view",showProgressBarsInGanttDesc:"Display progress bar overlays on Gantt bars to visualize event completion.",defaultGanttDuration:"Default Gantt duration (days)",defaultGanttDurationDesc:"Default duration in days for events without an end date when shown in Gantt view.",dependencyArrowStyle:"Dependency arrow style",dependencyArrowStyleDesc:"Visual style for dependency arrows between events in Gantt view.",solid:"Solid",dashed:"Dashed",dotted:"Dotted",mapSettings:"Map Settings",enableFrontmatterMarkers:"Enable frontmatter markers",enableFrontmatterMarkersDesc:"Auto-generate markers from notes with location or mapmarkers in frontmatter",enableDataViewMarkers:"Enable DataView markers",enableDataViewMarkersDesc:"Auto-generate markers from DataView queries (requires DataView plugin)",tutorialWelcome:"Welcome to Storyteller Suite!",tutorialWelcomeDesc:"This plugin helps you organize and manage all aspects of your stories. Here's how to get started:",tutorialTip:"Tip: Click any section below to expand detailed instructions and examples.",tutorialDashboardTitle:"Dashboard and ribbon icon",tutorialDashboardAccess:"Access the Dashboard:",tutorialDashboardRibbon:"Click the <strong>book-open icon</strong> in the left ribbon (sidebar)",tutorialDashboardCommand:'Use Command Palette: <kbd>Ctrl/Cmd + P</kbd> \u2192 "Storyteller: Open dashboard"',tutorialDashboardHub:"The dashboard is your central hub for managing all story elements",tutorialStoryTitle:"Story management",tutorialStoryCreating:"Creating Your First Story:",tutorialStoryButton:'Use the <strong>"Create New Story"</strong> button below (hidden when <em>One Story Mode</em> is enabled)',tutorialStoryCommand:'Or from Command Palette: "Storyteller: Create New Story"',tutorialStoryName:"Give your story a name and description",tutorialStoryDefault:"By default, the plugin creates folders at <code>StorytellerSuite/Stories/YourStoryName/</code>",tutorialStoryManaging:"Managing Stories:",tutorialStorySwitch:'Switch between stories using the <strong>"Set Active"</strong> button',tutorialStoryEdit:"Edit story details with the pencil icon",tutorialStoryDelete:"Delete stories with the trash icon (this only removes from plugin, not your files)",tutorialStoryActivation:`Immediate activation tip: Creating a story from <em>Settings</em> updates the settings list immediately, but the dashboard's story dropdown may not refresh until you reopen the dashboard. For instant activation and UI refresh, use the dashboard/command palette action <em>"Storyteller: Create New Story"</em>, or close/reopen the dashboard via <em>"Storyteller: Open dashboard"</em>.`,tutorialStoryOneMode:"One Story Mode: When enabled in settings, the interface is simplified to a single-story layout and the <em>New story</em> button is hidden. Content is organized under a single base folder.",tutorialCharacterTitle:"Character management",tutorialCharacterCreating:"Creating Characters:",tutorialCharacterDashboard:'<strong>Dashboard:</strong> Click "Create Character" button',tutorialCharacterCommand:'<strong>Command Palette:</strong> "Storyteller: Create new character"',tutorialCharacterDetails:"Fill in character details, backstory, relationships",tutorialCharacterImages:"Add profile images from your vault",tutorialCharacterManaging:"Managing Characters:",tutorialCharacterView:'<strong>View All:</strong> Dashboard \u2192 "View Characters" or Command Palette \u2192 "Storyteller: View characters"',tutorialCharacterEdit:"<strong>Edit:</strong> Click character name in dashboard or character list",tutorialCharacterDelete:"<strong>Delete:</strong> Use the trash icon (moves to Obsidian trash)",tutorialCharacterStorage:"Characters are stored as markdown files in <code>Characters/</code> folder",tutorialLocationTitle:"Location management",tutorialLocationCreating:"Creating Locations:",tutorialLocationDashboard:'<strong>Dashboard:</strong> Click "Create Location" button',tutorialLocationCommand:'<strong>Command Palette:</strong> "Storyteller: Create new location"',tutorialLocationDetails:"Add descriptions, history, region, location type",tutorialLocationLink:"Link to related characters and events",tutorialLocationManaging:"Managing Locations:",tutorialLocationView:'<strong>View All:</strong> Dashboard \u2192 "View Locations" or Command Palette \u2192 "Storyteller: View locations"',tutorialLocationStorage:"Locations are stored in <code>Locations/</code> folder as markdown files",tutorialLocationEdit:"Edit by clicking location name, delete with trash icon",tutorialEventTitle:"Event and timeline management",tutorialEventCreating:"Creating Events:",tutorialEventDashboard:'<strong>Dashboard:</strong> Click "Create Event" button',tutorialEventCommand:'<strong>Command Palette:</strong> "Storyteller: Create new event"',tutorialEventDetails:"Set date/time, add descriptions, outcomes",tutorialEventLink:"Link to involved characters and locations",tutorialEventNew:"<strong>New:</strong> Mark events as milestones, set progress (0-100%), add dependencies",tutorialEventTimeline:"Timeline View:",tutorialEventTimelineDashboard:'<strong>Dashboard:</strong> Click "View Timeline" button',tutorialEventTimelineCommand:'<strong>Command Palette:</strong> "Storyteller: View timeline"',tutorialEventTimelineSee:"See all events chronologically ordered",tutorialEventStorage:"Events stored in <code>Events/</code> folder",tutorialGanttTitle:"Gantt-style timeline features",tutorialGanttEnhanced:"Enhanced Timeline View:",tutorialGanttToggle:"<strong>Toggle View:</strong> Switch between classic Timeline and Gantt view using the toggle button",tutorialGanttMilestones:"<strong>Milestones:</strong> Mark important events as milestones (golden styling with star icon)",tutorialGanttProgress:"<strong>Progress Tracking:</strong> Set completion percentage (0-100%) on events with visual progress bars",tutorialGanttDependencies:"<strong>Dependencies:</strong> Link events to show cause-and-effect relationships with arrows",tutorialGanttDrag:"Drag-and-Drop Rescheduling:",tutorialGanttLock:"Click the <strong>lock/pencil icon</strong> in the toolbar to enable edit mode",tutorialGanttDragEvents:"Drag events to new dates - changes auto-save",tutorialGanttDisable:"Click the icon again to disable editing and lock the timeline",tutorialGanttFiltering:"Filtering and Grouping:",tutorialGanttFilterPanel:'<strong>Filter Panel:</strong> Click "Filters" to open the collapsible filter panel',tutorialGanttFilterBy:"<strong>Filter by:</strong> Character, location, group, or milestones-only",tutorialGanttFilterChips:'<strong>Filter Chips:</strong> Click chips to remove individual filters, or "Clear All"',tutorialGanttSwimlanes:"<strong>Swimlanes:</strong> Group events by location, group, or character",tutorialPlotTitle:"Plot items management",tutorialPlotManaging:"Managing Important Objects:",tutorialPlotCreate:'<strong>Create:</strong> Dashboard \u2192 "Create Plot Item" or Command Palette \u2192 "Storyteller: Create new plot item"',tutorialPlotCritical:'<strong>Mark Critical:</strong> Use the "Plot Critical" checkbox for key story items',tutorialPlotOwnership:"<strong>Track Ownership:</strong> Link current owner, past owners, and location",tutorialPlotView:'<strong>View All:</strong> Dashboard \u2192 "View Plot Items" or Command Palette \u2192 "Storyteller: View plot items"',tutorialPlotStorage:"Items stored in <code>Items/</code> folder",tutorialGalleryTitle:"Gallery management",tutorialGalleryOrganization:"Image Organization:",tutorialGalleryAccess:'<strong>Access:</strong> Dashboard \u2192 "Gallery" button or Command Palette \u2192 "Storyteller: Open gallery"',tutorialGalleryUpload:"<strong>Upload:</strong> Drag & drop images directly into the gallery",tutorialGalleryOrganize:"<strong>Organize:</strong> Add tags, categories, descriptions to images",tutorialGalleryLink:"<strong>Link:</strong> Easily reference gallery images in character/location profiles",tutorialGalleryConfig:"Configure upload folder below (default: <code>StorytellerSuite/GalleryUploads</code>)",tutorialGroupsTitle:"Groups and organization",tutorialGroupsOrganizing:"Organizing with Groups:",tutorialGroupsCreate:'<strong>Create Groups:</strong> Command Palette \u2192 "Storyteller: Create group"',tutorialGroupsAdd:"<strong>Add Members:</strong> Characters, locations, events, and items can be grouped",tutorialGroupsManage:'<strong>Manage:</strong> Rename with "Storyteller: Rename group", delete with "Storyteller: Delete group"',tutorialGroupsUseCases:"<strong>Use Cases:</strong> Royal family, specific kingdoms, plot arcs, etc.",tutorialWorldTitle:"World-building entities",tutorialWorldFive:"Five Entity Types for Comprehensive Worldbuilding:",tutorialWorldCultures:"<strong>Cultures:</strong> Tech level, government type, languages, values, customs, social structure",tutorialWorldFactions:"<strong>Factions:</strong> Organizations with type, power level, colors, motto, goals, resources",tutorialWorldEconomies:"<strong>Economies:</strong> System type (barter, market, feudal), industries, trade policy",tutorialWorldMagic:"<strong>Magic Systems:</strong> Type (arcane, divine, natural), rarity, power level, rules, costs",tutorialWorldCalendars:"<strong>Calendars:</strong> Calendar type (solar, lunar), days configuration, weekdays",tutorialWorldCreating:"Creating World-Building Entities:",tutorialWorldCommand:'<strong>Command Palette:</strong> "Storyteller: Create new culture/faction/economy/magic system/calendar"',tutorialWorldView:'<strong>View All:</strong> "Storyteller: View cultures/factions/economies/magic systems/calendars"',tutorialWorldModals:"Each entity has dedicated modals with relevant fields",tutorialWorldStorage:"Entities stored in their respective folders (e.g., <code>Cultures/</code>, <code>Factions/</code>)",tutorialTimelineTitle:"Timeline forks and causality",tutorialTimelineAlternate:"Alternate Timelines (What-If Scenarios):",tutorialTimelineCreateFork:'<strong>Create Fork:</strong> Command Palette \u2192 "Storyteller: Create timeline fork"',tutorialTimelineDivergence:"<strong>Divergence Point:</strong> Select the event where the timeline splits",tutorialTimelineForkStatus:"<strong>Fork Status:</strong> Track as exploring, canon, abandoned, or merged",tutorialTimelineViewForks:"<strong>View Forks:</strong> Use the fork selector dropdown in the timeline view",tutorialTimelineCausality:"Causality Links (Cause and Effect):",tutorialTimelineAddLink:'<strong>Add Link:</strong> Command Palette \u2192 "Storyteller: Add causality link"',tutorialTimelineLinkTypes:"<strong>Link Types:</strong> Direct, indirect, conditional, or catalyst",tutorialTimelineStrength:"<strong>Strength Levels:</strong> Weak, moderate, strong, or absolute",tutorialTimelineLinksHelp:"Links help track how events influence each other",tutorialTimelineConflict:"Conflict Detection:",tutorialTimelineRunDetection:'<strong>Run Detection:</strong> Command Palette \u2192 "Storyteller: Detect timeline conflicts"',tutorialTimelineDetects:"<strong>Detects:</strong> Location conflicts (character in multiple places), death conflicts (dead characters appearing later), causality violations (effects before causes)",tutorialTimelineBadge:"<strong>Conflict Badge:</strong> Shows count in timeline toolbar - click to review",tutorialTimelineActionable:"<strong>Actionable:</strong> Each conflict includes suggestions for resolution",tutorialTemplatesTitle:"Entity templates",tutorialTemplatesCreate:"Create Reusable Templates:",tutorialTemplatesSave:"<strong>Save as Template:</strong> When editing any entity, save it as a reusable template",tutorialTemplatesLibrary:'<strong>Template Library:</strong> Command Palette \u2192 "Storyteller: Open entity template library"',tutorialTemplatesDashboard:"<strong>Dashboard Tab:</strong> Access templates from the Templates tab in the dashboard",tutorialTemplatesBuiltIn:"Built-in Templates:",tutorialTemplatesArchetypes:"Character archetypes: Medieval King, Tavern Keeper, Wise Mentor, Cyberpunk Hacker, Detective",tutorialTemplatesMore:"More templates available for quick character creation",tutorialTemplatesFeatures:"Template Features:",tutorialTemplatesBrowse:"<strong>Browse:</strong> Search and filter templates by genre, category, entity type",tutorialTemplatesSort:"<strong>Sort:</strong> By name, usage count, or recently used",tutorialTemplatesUsage:"<strong>Usage Tracking:</strong> See which templates you use most often",tutorialTemplatesCustomize:"<strong>Customize:</strong> Duplicate and modify templates for your needs",tutorialDiscoveryTitle:"Story discovery and import",tutorialDiscoveryAutomatic:"Automatic Discovery:",tutorialDiscoveryDetects:"Plugin automatically detects existing <code>StorytellerSuite/Stories/</code> folders",tutorialDiscoveryManual:'<strong>Manual Refresh:</strong> Command Palette \u2192 "Storyteller: Refresh story discovery"',tutorialDiscoveryImport:"Import existing story folders without losing data",tutorialDiscoveryUseful:"Useful when moving stories between vaults",tutorialCustomTitle:"Custom folders: recommended manual workflow",tutorialCustomSimple:"Simple, reliable setup for custom folders:",tutorialCustomStep1:"<strong>Create your story folder and subfolders manually</strong> in your vault (e.g., <code>Creative/Writing/My_Story/Characters</code>, <code>Locations</code>, <code>Events</code>, etc.).",tutorialCustomStep2:"In Settings \u2192 Storyteller Suite \u2192 enable <strong>Use custom entity folders</strong>. Optionally set a <strong>Story root folder</strong> template for convenience.",tutorialCustomStep3:'Open the dashboard and use <strong>"Create new story"</strong>. After creation, <strong>refresh/activate</strong> the dashboard. The plugin will recognize your manual story folder as the active story.',tutorialCustomStep4:"Use <strong>Preview resolved folders</strong> in settings to confirm the exact paths the plugin will use.",tutorialCustomSwitching:"Switching stories in custom-folder mode: Use the <em>story dropdown at the top of the dashboard</em> to change the active story. Then go to <em>Settings \u2192 Storyteller Suite</em> and <strong>manually assign per\u2011entity folders</strong> for that story . Sorry I know this is a bit janky.",tutorialShortcutsTitle:"Keyboard shortcuts and commands",tutorialShortcutsCore:"Core Commands (via Ctrl/Cmd + P):",tutorialShortcutsOpen:"<strong>Storyteller: Open dashboard</strong> - Main interface",tutorialShortcutsNewStory:"<strong>Storyteller: Create New Story</strong> - Start a new story project",tutorialShortcutsCreate:"<strong>Storyteller: Create new character/location/event/plot item</strong>",tutorialShortcutsView:"<strong>Storyteller: View characters/locations/timeline/plot items</strong>",tutorialShortcutsGallery:"<strong>Storyteller: Open gallery</strong> - Image management",tutorialShortcutsGroup:"<strong>Storyteller: Create/Rename/Delete group</strong> - Organization",tutorialShortcutsRefresh:"<strong>Storyteller: Refresh story discovery</strong> - Import existing folders",tutorialShortcutsWorld:"World-Building Commands:",tutorialShortcutsWorldCreate:"<strong>Storyteller: Create new culture/faction/economy/magic system/calendar</strong>",tutorialShortcutsWorldView:"<strong>Storyteller: View cultures/factions/economies/magic systems/calendars</strong>",tutorialShortcutsTimeline:"Timeline and Causality Commands:",tutorialShortcutsTimelineFork:"<strong>Storyteller: Create timeline fork</strong> - Create alternate timeline",tutorialShortcutsTimelineViewForks:"<strong>Storyteller: View timeline forks</strong> - List all forks",tutorialShortcutsTimelineLink:"<strong>Storyteller: Add causality link</strong> - Link cause and effect events",tutorialShortcutsTimelineViewLinks:"<strong>Storyteller: View causality links</strong> - List all causal relationships",tutorialShortcutsTimelineDetect:"<strong>Storyteller: Detect timeline conflicts</strong> - Find inconsistencies",tutorialShortcutsTimelineViewConflicts:"<strong>Storyteller: View timeline conflicts</strong> - Review existing conflicts",tutorialShortcutsTemplate:"Template Commands:",tutorialShortcutsTemplateLibrary:"<strong>Storyteller: Open entity template library</strong> - Browse and manage templates",tutorialShortcutsTip:"Tip: You can assign custom hotkeys to any of these commands in Obsidian's Hotkeys settings!",tutorialFileTitle:"File structure and integration",tutorialFileOrganized:"How Your Files Are Organized:",tutorialFileDefault:"Default (multi-story):",tutorialFileOneMode:"One Story Mode (flattened):",tutorialFileIntegration:"Obsidian Integration:",tutorialFileMarkdown:"All data stored as <strong>markdown files</strong> with frontmatter",tutorialFileDataview:"Fully compatible with <strong>Dataview plugin</strong> for custom queries",tutorialFileWikiLinks:"Use <strong>[[wiki links]]</strong> to connect characters, locations, events",tutorialFileReadable:"Files are <strong>readable and editable</strong> even without the plugin",tutorialFileBackup:"<strong>Backup safe:</strong> Your data is never locked in a proprietary format",tutorialFileTip:"Tip: Configure these modes in Settings \u2192 Storyteller Suite under <em>Use custom entity folders</em> and <em>One Story Mode</em>. The <em>New story</em> button is hidden automatically in One Story Mode."}});var kI,xI=_e(()=>{kI={dashboardTitle:"\u6545\u4E8B\u8BB2\u8FF0\u8005\u5957\u4EF6",openDashboard:"\u6253\u5F00\u4EEA\u8868\u677F",createNew:"\u521B\u5EFA\u65B0\u7684",uploadImage:"\u4E0A\u4F20\u56FE\u50CF",image:"\u56FE\u50CF",storyCreated:'\u6545\u4E8B"{0}"\u5DF2\u521B\u5EFA\u5E76\u6FC0\u6D3B\u3002',created:'{0}"{1}"\u5DF2\u521B\u5EFA\u3002',updated:'{0}"{1}"\u5DF2\u66F4\u65B0\u3002',movedToTrash:'{0}"{1}"\u5DF2\u79FB\u81F3\u56DE\u6536\u7AD9\u3002',imageUploaded:"\u56FE\u50CF\u5DF2\u4E0A\u4F20\uFF1A{0}",errorUploadingImage:"\u4E0A\u4F20\u56FE\u50CF\u51FA\u9519\u3002\u8BF7\u91CD\u8BD5\u3002",noteCreatedWithSections:"\u5DF2\u521B\u5EFA\u5E26\u6709\u6807\u51C6\u7AE0\u8282\u7684\u7B14\u8BB0\uFF0C\u4FBF\u4E8E\u7F16\u8F91\u3002",workspaceLeafCreateError:"\u6253\u5F00\u4EEA\u8868\u677F\u65F6\u51FA\u9519\uFF1A\u65E0\u6CD5\u521B\u5EFA\u5DE5\u4F5C\u533A\u53F6\u3002",workspaceLeafRevealError:"\u663E\u793A\u4EEA\u8868\u677F\u65F6\u51FA\u9519\uFF1A\u5DE5\u4F5C\u533A\u53F6\u672A\u627E\u5230\u3002",errorCannotDeleteWithoutFilePath:"\u9519\u8BEF\uFF1A\u6CA1\u6709\u6587\u4EF6\u8DEF\u5F84\uFF0C\u65E0\u6CD5\u5220\u9664{0}\u3002",errorCannotOpenNoteWithoutFilePath:"\u9519\u8BEF\uFF1A\u6CA1\u6709\u6587\u4EF6\u8DEF\u5F84\uFF0C\u65E0\u6CD5\u6253\u5F00{0}\u7B14\u8BB0\u3002",remoteImagesBlocked:"\u8BBE\u7F6E\u963B\u6B62\u4E86\u8FDC\u7A0B\u56FE\u50CF\u3002\u8BF7\u5C06\u56FE\u50CF\u5BFC\u5165\u56FE\u5E93\u4EE5\u5B89\u5168\u4F7F\u7528\u3002",importImage:"\u5BFC\u5165\u56FE\u50CF",language:"\u8BED\u8A00",selectLanguage:"\u9009\u62E9\u8BED\u8A00",english:"English (\u82F1\u8BED)",chinese:"\u4E2D\u6587 (Chinese)",languageChanged:"\u8BED\u8A00\u5DF2\u66F4\u6539\u3002\u91CD\u65B0\u52A0\u8F7D\u63D2\u4EF6\u4EE5\u5B8C\u5168\u751F\u6548\u3002",name:"\u540D\u79F0",description:"\u63CF\u8FF0",backstory:"\u80CC\u666F\u6545\u4E8B",history:"\u5386\u53F2",location:"\u4F4D\u7F6E",character:"\u89D2\u8272",event:"\u4E8B\u4EF6",item:"\u7269\u54C1",reference:"\u53C2\u8003",chapter:"\u7AE0\u8282",scene:"\u573A\u666F",group:"\u7EC4\u7FA4",characters:"\u89D2\u8272",locations:"\u4F4D\u7F6E",events:"\u4E8B\u4EF6",items:"\u7269\u54C1",references:"\u53C2\u8003",chapters:"\u7AE0\u8282",scenes:"\u573A\u666F",groups:"\u7EC4\u7FA4",gallery:"\u56FE\u5E93",timeline:"\u65F6\u95F4\u7EBF",create:"\u521B\u5EFA",edit:"\u7F16\u8F91",delete:"\u5220\u9664",save:"\u4FDD\u5B58",cancel:"\u53D6\u6D88",view:"\u67E5\u770B",upload:"\u4E0A\u4F20",import:"\u5BFC\u5165",export:"\u5BFC\u51FA",refresh:"\u5237\u65B0",createNewCharacter:"\u521B\u5EFA\u65B0\u89D2\u8272",editCharacter:"\u7F16\u8F91\u89D2\u8272",createNewLocation:"\u521B\u5EFA\u65B0\u4F4D\u7F6E",editLocation:"\u7F16\u8F91\u4F4D\u7F6E",createNewEvent:"\u521B\u5EFA\u65B0\u4E8B\u4EF6",editEvent:"\u7F16\u8F91\u4E8B\u4EF6",createNewItem:"\u521B\u5EFA\u65B0\u7269\u54C1",editItem:"\u7F16\u8F91\u7269\u54C1",createNewReference:"\u521B\u5EFA\u65B0\u53C2\u8003",editReference:"\u7F16\u8F91\u53C2\u8003",createNewChapter:"\u521B\u5EFA\u65B0\u7AE0\u8282",editChapter:"\u7F16\u8F91\u7AE0\u8282",createNewScene:"\u521B\u5EFA\u65B0\u573A\u666F",editScene:"\u7F16\u8F91\u573A\u666F",createNewGroup:"\u521B\u5EFA\u65B0\u7EC4\u7FA4",editGroup:"\u7F16\u8F91\u7EC4\u7FA4",tags:"\u6807\u7B7E",summary:"\u6458\u8981",content:"\u5185\u5BB9",number:"\u7F16\u53F7",orderingNumber:"\u6392\u5E8F\u7F16\u53F7\uFF08\u53EF\u9009\uFF09",category:"\u7C7B\u522B",createCharacter:"\u521B\u5EFA\u89D2\u8272",createLocation:"\u521B\u5EFA\u4F4D\u7F6E",createEvent:"\u521B\u5EFA\u4E8B\u4EF6",createItem:"\u521B\u5EFA\u7269\u54C1",createReference:"\u521B\u5EFA\u53C2\u8003",createChapter:"\u521B\u5EFA\u7AE0\u8282",createScene:"\u521B\u5EFA\u573A\u666F",createGroup:"\u521B\u5EFA\u7EC4\u7FA4",saveChanges:"\u4FDD\u5B58\u66F4\u6539",deleteCharacter:"\u5220\u9664\u89D2\u8272",deleteLocation:"\u5220\u9664\u4F4D\u7F6E",deleteEvent:"\u5220\u9664\u4E8B\u4EF6",deleteItem:"\u5220\u9664\u7269\u54C1",deleteReference:"\u5220\u9664\u53C2\u8003",deleteChapter:"\u5220\u9664\u7AE0\u8282",deleteScene:"\u5220\u9664\u573A\u666F",deleteGroup:"\u5220\u9664\u7EC4\u7FA4",add:"\u6DFB\u52A0",clear:"\u6E05\u9664",ok:"\u786E\u5B9A",confirm:"\u786E\u8BA4",selectBtn:"\u9009\u62E9",previewBtn:"\u9884\u89C8",editBtn:"\u7F16\u8F91",openNoteBtn:"\u6253\u5F00\u7B14\u8BB0",flattenCustomFields:"\u5C55\u5E73\u4E3A\u539F\u751F\u952E\uFF08\u63A8\u8350\uFF09",nestedCustomFields:"\u5D4C\u5957\u5728customFields\u4E0B\uFF08YAML\u6620\u5C04\uFF09",noGrouping:"\u65E0\u5206\u7EC4",byLocation:"\u6309\u4F4D\u7F6E",byGroup:"\u6309\u7EC4\u7FA4",noneOption:"\u65E0",fitOption:"\u9002\u914D",decadeOption:"\u5341\u5E74",centuryOption:"\u4E16\u7EAA",customFoldersPlaceholderWarning:'\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939\u4F7F\u7528{story*}\u5360\u4F4D\u7B26\u3002\u8BF7\u9009\u62E9\u6216\u521B\u5EFA\u4E00\u4E2A\u6D3B\u52A8\u6545\u4E8B\uFF0C\u7136\u540E\u70B9\u51FB"\u91CD\u65B0\u626B\u63CF\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939"\u3002',openNote:"\u6253\u5F00\u7B14\u8BB0",createGroupBtn:"\u521B\u5EFA\u7EC4\u7FA4",createChapterBtn:"\u521B\u5EFA\u7AE0\u8282",createSceneBtn:"\u521B\u5EFA\u573A\u666F",createReferenceBtn:"\u521B\u5EFA\u53C2\u8003",viewCharacters:"\u67E5\u770B\u89D2\u8272",viewLocations:"\u67E5\u770B\u4F4D\u7F6E",viewEvents:"\u67E5\u770B\u4E8B\u4EF6",viewItems:"\u67E5\u770B\u7269\u54C1",viewReferences:"\u67E5\u770B\u53C2\u8003",viewChapters:"\u67E5\u770B\u7AE0\u8282",viewScenes:"\u67E5\u770B\u573A\u666F",viewGroups:"\u67E5\u770B\u7EC4\u7FA4",viewTimeline:"\u67E5\u770B\u65F6\u95F4\u7EBF",openTimelinePanel:"\u6253\u5F00\u65F6\u95F4\u7EBF\u9762\u677F",viewGallery:"\u67E5\u770B\u56FE\u5E93",selectOrCreateStoryFirst:"\u8BF7\u5148\u9009\u62E9\u6216\u521B\u5EFA\u4E00\u4E2A\u6545\u4E8B\u3002",selectGroupPlaceholder:"-- \u9009\u62E9\u7EC4\u7FA4 --",affiliation:"\u96B6\u5C5E",groupsHelpCharacter:"\u5C06\u6B64\u89D2\u8272\u5206\u914D\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u7EC4\u7FA4\u3002",members:"\u6210\u5458",noCustomFields:"\u672A\u5B9A\u4E49\u81EA\u5B9A\u4E49\u5B57\u6BB5\u3002",selectFromGallery:"\u4ECE\u56FE\u5E93\u9009\u62E9",clearImage:"\u6E05\u9664\u56FE\u50CF",addImage:"\u6DFB\u52A0\u56FE\u50CF",imageGallery:"\u56FE\u50CF\u5E93",filter:"\u7B5B\u9009",search:"\u641C\u7D22",storyName:"\u6545\u4E8B\u540D\u79F0",createNewStory:"\u521B\u5EFA\u65B0\u6545\u4E8B",plotItems:"\u60C5\u8282\u7269\u54C1",title:"\u6807\u9898",caption:"\u8BF4\u660E",fit:"\u9002\u914D",decade:"\u5341\u5E74",century:"\u4E16\u7EAA",today:"\u4ECA\u5929",copyRange:"\u590D\u5236\u8303\u56F4",stackItems:"\u5806\u53E0\u9879\u76EE",goToChapter:"\u524D\u5F80\u7AE0\u8282",unassigned:"\u672A\u5206\u914D",chapterTitlePh:"\u7AE0\u8282\u6807\u9898",sceneTitlePh:"\u573A\u666F\u6807\u9898",numberEg:"\u4F8B\u5982\uFF1A1",tagsPh:"\u6807\u7B7E1\uFF0C\u6807\u7B7E2",briefChapterSummaryPh:"\u672C\u7AE0\u8282\u7684\u7B80\u8981\u6458\u8981...",writeYourScenePh:"\u5199\u4E0B\u4F60\u7684\u573A\u666F...",beatSheet:"\u8282\u62CD\u8868\uFF08\u6BCF\u884C\u4E00\u4E2A\uFF09",beatSheetExample:"- \u9047\u89C1\u5BFC\u5E08\\n- \u62D2\u7EDD",stories:"\u6545\u4E8B",active:"\u5DF2\u6FC0\u6D3B",setActive:"\u8BBE\u4E3A\u6FC0\u6D3B",editStory:"\u7F16\u8F91\u6545\u4E8B",storyDiscovery:"\u6545\u4E8B\u53D1\u73B0",refreshDiscovery:"\u5237\u65B0\u53D1\u73B0",galleryUploadFolder:"\u56FE\u5E93\u4E0A\u4F20\u6587\u4EF6\u5939",timelineAndParsing:"\u65F6\u95F4\u7EBF\u4E0E\u89E3\u6790",customFieldsSerialization:"\u81EA\u5B9A\u4E49\u5B57\u6BB5\u5E8F\u5217\u5316",forwardDateBias:"\u81EA\u7136\u8BED\u8A00\u89E3\u6790\u504F\u5411\u672A\u6765",customToday:"\u81EA\u5B9A\u4E49\u4ECA\u5929\uFF08\u65F6\u95F4\u7EBF\u53C2\u8003\uFF09",defaultTimelineGrouping:"\u9ED8\u8BA4\u65F6\u95F4\u7EBF\u5206\u7EC4",defaultZoomPreset:"\u9ED8\u8BA4\u7F29\u653E\u9884\u8BBE",defaultStacking:"\u9ED8\u8BA4\u5806\u53E0",defaultDensity:"\u9ED8\u8BA4\u5BC6\u5EA6",showLegendByDefault:"\u9ED8\u8BA4\u663E\u793A\u56FE\u4F8B",timelineDefaultHeight:"\u65F6\u95F4\u7EBF\u9ED8\u8BA4\u9AD8\u5EA6",useCustomEntityFolders:"\u4F7F\u7528\u81EA\u5B9A\u4E49\u5B9E\u4F53\u6587\u4EF6\u5939",previewResolvedFolders:"\u9884\u89C8\u89E3\u6790\u540E\u7684\u6587\u4EF6\u5939",storyRootFolderOptional:"\u6545\u4E8B\u6839\u6587\u4EF6\u5939\uFF08\u53EF\u9009\uFF09",charactersFolder:"\u89D2\u8272\u6587\u4EF6\u5939",locationsFolder:"\u4F4D\u7F6E\u6587\u4EF6\u5939",eventsFolder:"\u4E8B\u4EF6\u6587\u4EF6\u5939",itemsFolder:"\u7269\u54C1\u6587\u4EF6\u5939",referencesFolder:"\u53C2\u8003\u6587\u4EF6\u5939",scenesFolder:"\u573A\u666F\u6587\u4EF6\u5939",chaptersFolder:"\u7AE0\u8282\u6587\u4EF6\u5939",oneStoryMode:"\u5355\u6545\u4E8B\u6A21\u5F0F",oneStoryBaseFolder:"\u5355\u6545\u4E8B\u57FA\u7840\u6587\u4EF6\u5939",showTutorialSection:"\u663E\u793A\u6559\u7A0B\u90E8\u5206",support:"\u652F\u6301",supportDevelopment:"\u652F\u6301\u5F00\u53D1",about:"\u5173\u4E8E",pluginInformation:"\u63D2\u4EF6\u4FE1\u606F",buyMeACoffee:"\u8BF7\u6211\u559D\u5496\u5561",github:"GitHub",preview:"\u9884\u89C8",clearCustomToday:"\u6E05\u9664\u81EA\u5B9A\u4E49\u4ECA\u5929",enterCharacterName:"\u8F93\u5165\u89D2\u8272\u540D\u79F0",characterDescriptionPh:"\u89D2\u8272\u7684\u7B80\u8981\u63CF\u8FF0...",traitsPlaceholder:"\u4F8B\u5982\uFF1A\u52C7\u6562\u3001\u597D\u5947\u3001\u56FA\u6267",characterHistoryPh:"\u89D2\u8272\u7684\u5386\u53F2...",statusPlaceholderCharacter:"\u4F8B\u5982\uFF1A\u5B58\u6D3B\u3001\u5DF2\u6545\u3001\u5931\u8E2A",enterItemName:"\u8F93\u5165\u7269\u54C1\u540D\u79F0",itemDescriptionPh:"\u5BF9\u8BE5\u7269\u54C1\u7684\u5916\u89C2\u8FDB\u884C\u63CF\u8FF0...",itemHistoryPh:"\u8BE5\u7269\u54C1\u7684\u8D77\u6E90\u3001\u8FC7\u53BB\u4E0E\u610F\u4E49...",enterLocationName:"\u8F93\u5165\u4F4D\u7F6E\u540D\u79F0",locationDescriptionPh:"\u4F4D\u7F6E\u7684\u7B80\u8981\u63CF\u8FF0...",locationHistoryPh:"\u8BE5\u4F4D\u7F6E\u7684\u5386\u53F2\u548C\u8FC7\u53BB\u4E8B\u4EF6...",statusPlaceholderLocation:"\u4F8B\u5982\uFF1A\u6D3B\u8DC3\u3001\u5E9F\u589F\u3001\u5E9F\u5F03",enterEventName:"\u8F93\u5165\u4E8B\u4EF6\u540D\u79F0",eventDescriptionPh:"\u5BF9\u8BE5\u4E8B\u4EF6\u7684\u63CF\u8FF0...",eventOutcomePh:"\u8BE5\u4E8B\u4EF6\u7684\u7ED3\u679C\u6216\u540E\u679C...",enterDateTime:"\u8F93\u5165\u65E5\u671F/\u65F6\u95F4",statusPlaceholderEvent:"\u4F8B\u5982\uFF1A\u5373\u5C06\u3001\u5DF2\u5B8C\u6210\u3001\u8FDB\u884C\u4E2D\u3001\u5173\u952E\u60C5\u8282\u70B9",dateTime:"\u65E5\u671F/\u65F6\u95F4",outcome:"\u7ED3\u679C",status:"\u72B6\u6001",charactersInvolved:"\u6D89\u53CA\u7684\u89D2\u8272",associatedImages:"\u5173\u8054\u56FE\u50CF",links:"\u94FE\u63A5",relationships:"\u5173\u7CFB\u548C\u4F4D\u7F6E",currentOwner:"\u5F53\u524D\u62E5\u6709\u8005",currentLocation:"\u5F53\u524D\u4F4D\u7F6E",plotCritical:"\u60C5\u8282\u5173\u952E",traits:"\u7279\u5F81",profileImage:"\u4E2A\u4EBA\u8D44\u6599\u56FE\u50CF",itemImage:"\u7269\u54C1\u56FE\u50CF",selectOwner:"\u9009\u62E9\u62E5\u6709\u8005",selectLocation:"\u9009\u62E9\u4F4D\u7F6E",changeLocation:"\u66F4\u6539\u4F4D\u7F6E",clearLocation:"\u6E05\u9664\u4F4D\u7F6E\uFF08\u8BBE\u4E3A\u65E0\uFF09",parentLocation:"\u7236\u4F4D\u7F6E",selectParentLocation:"\u9009\u62E9\u7236\u4F4D\u7F6E",clearParentLocation:"\u6E05\u9664\u7236\u4F4D\u7F6E",addCharacter:"\u6DFB\u52A0\u89D2\u8272",addCustomField:"\u6DFB\u52A0\u81EA\u5B9A\u4E49\u5B57\u6BB5",fieldName:"\u5B57\u6BB5\u540D\u79F0",fieldValue:"\u5B57\u6BB5\u503C",customFieldValueTitle:"\u81EA\u5B9A\u4E49\u5B57\u6BB5\u503C",newCustomFieldTitle:"\u65B0\u5EFA\u81EA\u5B9A\u4E49\u5B57\u6BB5",valueForX:'"{0}" \u7684\u503C',fieldNameCannotBeEmpty:"\u5B57\u6BB5\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",thatNameIsReserved:"\u8BE5\u540D\u79F0\u5DF2\u4FDD\u7559",fieldAlreadyExists:"\u5DF2\u5B58\u5728\u540C\u540D\u5B57\u6BB5",characterNameRequired:"\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\u3002",eventNameRequired:"\u4E8B\u4EF6\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\u3002",itemNameRequired:"\u7269\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\u3002",customFields:"\u81EA\u5B9A\u4E49\u5B57\u6BB5",select:"\u9009\u62E9",current:"\u5F53\u524D",none:"\u65E0",removeX:"\u79FB\u9664 {0}",removeFieldX:'\u79FB\u9664\u5B57\u6BB5 "{0}"',filterX:"\u7B5B\u9009{0}",searchX:"\u641C\u7D22{0}...",networkGraph:"\u7F51\u7EDC\u56FE\u8C31",relationshipType:"\u5173\u7CFB\u7C7B\u578B",relationshipTypes:"\u5173\u7CFB\u7C7B\u578B",relationshipTypeDesc:"\u9009\u62E9\u5173\u7CFB\u7C7B\u578B",relationshipLabelDesc:"\u6B64\u5173\u7CFB\u7684\u53EF\u9009\u81EA\u5B9A\u4E49\u6807\u7B7E",exampleRelationshipLabel:"\u4F8B\u5982\uFF1A\u6700\u597D\u7684\u670B\u53CB\u3001\u5144\u5F1F\u59D0\u59B9\u3001\u5546\u4E1A\u4F19\u4F34",addRelationship:"\u6DFB\u52A0\u5173\u7CFB",editRelationship:"\u7F16\u8F91\u5173\u7CFB",targetEntity:"\u76EE\u6807\u5B9E\u4F53",pleaseSelectTarget:"\u8BF7\u9009\u62E9\u76EE\u6807\u5B9E\u4F53",ally:"\u76DF\u53CB",enemy:"\u654C\u4EBA",family:"\u5BB6\u4EBA",rival:"\u7ADE\u4E89\u5BF9\u624B",romantic:"\u604B\u4EBA",mentor:"\u5BFC\u5E08",acquaintance:"\u719F\u4EBA",neutral:"\u4E2D\u7ACB",custom:"\u81EA\u5B9A\u4E49",filterByGroup:"\u6309\u7EC4\u7B5B\u9009",filterByTimeline:"\u6309\u65F6\u95F4\u7EBF\u7B5B\u9009",filterByEntityTypes:"\u6309\u5B9E\u4F53\u7C7B\u578B\u7B5B\u9009",exportGraph:"\u5BFC\u51FA\u56FE\u8C31",toggleEdgeLabels:"\u5207\u6362\u8FB9\u6807\u7B7E",showLegend:"\u663E\u793A\u56FE\u4F8B",legend:"\u56FE\u4F8B",noRelationshipsFound:"\u672A\u627E\u5230\u5173\u7CFB\u3002\u5728\u5B9E\u4F53\u4E4B\u95F4\u6DFB\u52A0\u8FDE\u63A5\u4EE5\u5728\u7F51\u7EDC\u56FE\u8C31\u4E2D\u53EF\u89C6\u5316\u5B83\u4EEC\u3002",storyBoard:"\u6545\u4E8B\u677F",createStoryBoard:"\u521B\u5EFA\u6545\u4E8B\u677F",updateStoryBoard:"\u66F4\u65B0\u6545\u4E8B\u677F",openStoryBoard:"\u6253\u5F00\u6545\u4E8B\u677F",storyBoardCreated:"\u6545\u4E8B\u677F\u5DF2\u521B\u5EFA\uFF01",storyBoardUpdated:"\u6545\u4E8B\u677F\u5DF2\u66F4\u65B0\uFF01",storyBoardUpdatedPreserved:"\u6545\u4E8B\u677F\u5DF2\u66F4\u65B0\uFF01\u5DF2\u4FDD\u7559\u624B\u52A8\u7F16\u8F91\u3002",overwriteStoryBoard:"\u8986\u76D6\u6545\u4E8B\u677F\uFF1F",createStoryBoardPrompt:"\u521B\u5EFA\u6545\u4E8B\u677F\uFF1F",createStoryBoardMessage:"\u672A\u627E\u5230\u6545\u4E8B\u677F\u3002\u60A8\u8981\u521B\u5EFA\u4E00\u4E2A\u5417\uFF1F",storyBoardExistsMessage:"\u6545\u4E8B\u677F\u5DF2\u5B58\u5728\u3002\u60A8\u8981\u8986\u76D6\u5B83\u5417\uFF1F",noScenesForStoryBoard:"\u672A\u627E\u5230\u573A\u666F\u3002\u8BF7\u5148\u521B\u5EFA\u4E00\u4E9B\u573A\u666F\uFF01",noStoryBoardFound:'\u672A\u627E\u5230\u6545\u4E8B\u677F\u3002\u8BF7\u5148\u4F7F\u7528"\u521B\u5EFA\u6545\u4E8B\u677F"\u521B\u5EFA\u4E00\u4E2A\u3002',errorOpeningStoryBoard:"\u6253\u5F00\u6545\u4E8B\u677F\u65F6\u51FA\u9519\u3002\u8BF7\u67E5\u770B\u63A7\u5236\u53F0\u4E86\u89E3\u8BE6\u60C5\u3002",storyBoardEmpty:"\u672A\u627E\u5230\u573A\u666F\u3002\u6545\u4E8B\u677F\u5C06\u4E3A\u7A7A\u3002",errorReadingStoryBoard:"\u8BFB\u53D6\u73B0\u6709\u6545\u4E8B\u677F\u65F6\u51FA\u9519\u3002\u5B83\u53EF\u80FD\u5DF2\u635F\u574F\u3002",errorUpdatingStoryBoard:"\u66F4\u65B0\u6545\u4E8B\u677F\u65F6\u51FA\u9519\u3002\u8BF7\u67E5\u770B\u63A7\u5236\u53F0\u4E86\u89E3\u8BE6\u60C5\u3002",storyBoardLayout:"\u6545\u4E8B\u677F\u5E03\u5C40",storyBoardLayoutDesc:"\u9009\u62E9\u5982\u4F55\u5728\u753B\u5E03\u4E0A\u7EC4\u7EC7\u573A\u666F",layoutByChapters:"\u6309\u7AE0\u8282",layoutByTimeline:"\u6309\u65F6\u95F4\u7EBF",layoutByStatus:"\u6309\u72B6\u6001\uFF08\u770B\u677F\uFF09",storyBoardColorBy:"\u573A\u666F\u7740\u8272\u4F9D\u636E",storyBoardColorByDesc:"\u9009\u62E9\u51B3\u5B9A\u573A\u666F\u5361\u7247\u989C\u8272\u7684\u56E0\u7D20",colorByStatus:"\u72B6\u6001\uFF08\u8349\u7A3F\u3001\u8FDB\u884C\u4E2D\u7B49\uFF09",colorByChapter:"\u7AE0\u8282",colorByNone:"\u65E0",storyBoardShowEdges:"\u663E\u793A\u573A\u666F\u6D41\u7A0B\u7BAD\u5934",storyBoardShowEdgesDesc:"\u663E\u793A\u6309\u987A\u5E8F\u8FDE\u63A5\u573A\u666F\u7684\u7BAD\u5934",storyBoardCardSize:"\u5361\u7247\u5927\u5C0F",storyBoardCardWidth:"\u5361\u7247\u5BBD\u5EA6",storyBoardCardHeight:"\u5361\u7247\u9AD8\u5EA6",graphFilters:"\u56FE\u8C31\u7B5B\u9009",timelineStart:"\u65F6\u95F4\u7EBF\u5F00\u59CB",timelineEnd:"\u65F6\u95F4\u7EBF\u7ED3\u675F",timelineRangeSeparator:" \u81F3 ",selectEntityTypes:"\u9009\u62E9\u5B9E\u4F53\u7C7B\u578B",applyFilters:"\u5E94\u7528\u7B5B\u9009",resetFilters:"\u91CD\u7F6E\u7B5B\u9009",exportAsPNG:"\u5BFC\u51FA\u4E3APNG",exportAsJPG:"\u5BFC\u51FA\u4E3AJPG",graphExported:"\u56FE\u8C31\u5DF2\u5BFC\u51FA\u3002",connections:"\u8FDE\u63A5",searchEntities:"\u641C\u7D22\u5B9E\u4F53...",zoomIn:"\u653E\u5927",zoomOut:"\u7F29\u5C0F",fitToView:"\u9002\u5E94\u89C6\u56FE",layout:"\u5E03\u5C40",forceDirected:"\u529B\u5BFC\u5411",circle:"\u5706\u5F62",grid:"\u7F51\u683C",concentric:"\u540C\u5FC3\u5706",nodeTypes:"\u8282\u70B9\u7C7B\u578B",interactions:"\u4EA4\u4E92",addConnection:"\u6DFB\u52A0\u8FDE\u63A5",noConnectionsYet:"\u8FD8\u6CA1\u6709\u8FDE\u63A5\u3002",label:"\u6807\u7B7E",optional:"\uFF08\u53EF\u9009\uFF09",all:"\u5168\u90E8",milestone:"\u91CC\u7A0B\u7891",milestoneDesc:"\u5C06\u6B64\u4E8B\u4EF6\u6807\u8BB0\u4E3A\u5173\u952E\u6545\u4E8B\u65F6\u523B",progress:"\u8FDB\u5EA6",progressDesc:"\u5B8C\u6210\u767E\u5206\u6BD4\uFF080-100\uFF09",dependencies:"\u4F9D\u8D56\u9879",dependenciesDesc:"\u5728\u6B64\u4E8B\u4EF6\u4E4B\u524D\u5FC5\u987B\u53D1\u751F\u7684\u4E8B\u4EF6",addDependency:"\u6DFB\u52A0\u4F9D\u8D56\u9879",editMode:"\u7F16\u8F91\u6A21\u5F0F",lockMode:"\u9501\u5B9A\u6A21\u5F0F",editModeTooltip:"\u7F16\u8F91\u6A21\u5F0F\uFF08\u62D6\u52A8\u4EE5\u91CD\u65B0\u5B89\u6392\uFF09",filters:"\u7B5B\u9009\u5668",milestonesOnly:"\u4EC5\u91CC\u7A0B\u7891",milestonesOnlyDesc:"\u4EC5\u663E\u793A\u91CC\u7A0B\u7891\u4E8B\u4EF6",filterByCharacter:"\u6309\u89D2\u8272\u7B5B\u9009",filterByLocation:"\u6309\u4F4D\u7F6E\u7B5B\u9009",clearAllFilters:"\u6E05\u9664\u6240\u6709\u7B5B\u9009\u5668",selectCharacterFilter:"\u9009\u62E9\u89D2\u8272...",selectLocationFilter:"\u9009\u62E9\u4F4D\u7F6E...",selectGroupFilter:"\u9009\u62E9\u7EC4\u7FA4...",characterFilter:"\u89D2\u8272\uFF1A",locationFilter:"\u4F4D\u7F6E\uFF1A",groupFilter:"\u7EC4\u7FA4\uFF1A",eventRescheduled:'\u4E8B\u4EF6"{0}"\u5DF2\u91CD\u65B0\u5B89\u6392',editModeEnabled:"\u7F16\u8F91\u6A21\u5F0F\u5DF2\u542F\u7528 - \u62D6\u52A8\u4E8B\u4EF6\u4EE5\u91CD\u65B0\u5B89\u6392",editModeDisabled:"\u7F16\u8F91\u6A21\u5F0F\u5DF2\u7981\u7528",dependencyAdded:'\u4F9D\u8D56\u9879"{0}"\u5DF2\u6DFB\u52A0',byCharacter:"\u6309\u89D2\u8272",ganttView:"\u7518\u7279\u56FE\u89C6\u56FE",timelineView:"\u65F6\u95F4\u7EBF\u89C6\u56FE",switchedToGantt:"\u5DF2\u5207\u6362\u5230\u7518\u7279\u56FE\u89C6\u56FE",switchedToTimeline:"\u5DF2\u5207\u6362\u5230\u65F6\u95F4\u7EBF\u89C6\u56FE",entityTypes:"\u5B9E\u4F53\u7C7B\u578B",openInPanel:"\u5728\u9762\u677F\u4E2D\u6253\u5F00",openInModal:"\u5728\u6A21\u6001\u6846\u4E2D\u6253\u5F00",close:"\u5173\u95ED",manageTimelineEras:"\u7BA1\u7406\u65F6\u95F4\u7EBF\u7EAA\u5143\u548C\u65F6\u671F",addEra:"\u6DFB\u52A0\u7EAA\u5143",eraType:"\u7EAA\u5143\u7C7B\u578B",startDate:"\u5F00\u59CB\u65E5\u671F",endDate:"\u7ED3\u675F\u65E5\u671F",eraColor:"\u7EAA\u5143\u989C\u8272",manageTimelineTracks:"\u7BA1\u7406\u65F6\u95F4\u7EBF\u8F68\u9053",addTrack:"\u6DFB\u52A0\u8F68\u9053",trackType:"\u8F68\u9053\u7C7B\u578B",trackColor:"\u8F68\u9053\u989C\u8272",newStory:"+ \u65B0\u6545\u4E8B",noCharactersFound:'\u672A\u627E\u5230\u89D2\u8272\u3002\u70B9\u51FB"\u521B\u5EFA\u65B0\u7684"\u6765\u6DFB\u52A0\u60A8\u7684\u7B2C\u4E00\u4E2A\u89D2\u8272\u3002',noLocationsFound:"\u672A\u627E\u5230\u4F4D\u7F6E\u3002",noEventsFound:"\u672A\u627E\u5230\u4E8B\u4EF6\u3002",noItemsFound:"\u672A\u627E\u5230\u7269\u54C1\u3002",noImagesFound:"\u672A\u627E\u5230\u56FE\u50CF\u3002",noGroupsFound:"\u672A\u627E\u5230\u7EC4\u7FA4\u3002",noReferencesFound:"\u672A\u627E\u5230\u53C2\u8003\u3002",noChaptersFound:"\u672A\u627E\u5230\u7AE0\u8282\u3002",noScenesFound:"\u672A\u627E\u5230\u573A\u666F\u3002",matchingFilter:" \u5339\u914D\u7B5B\u9009\u5668\u3002",filterItems:"\u7B5B\u9009\u7269\u54C1",filterGroups:"\u7B5B\u9009\u7EC4\u7FA4",noMembers:"\u65E0\u6210\u5458\u3002",enterGroupName:"\u8F93\u5165\u7EC4\u7FA4\u540D\u79F0",describeGroupPh:"\u63CF\u8FF0\u6B64\u7EC4\u7FA4...",color:"\u989C\u8272",colorPlaceholder:"#RRGGBB \u6216\u989C\u8272\u540D\u79F0",groupNameRequired:"\u7EC4\u7FA4\u540D\u79F0\u662F\u5FC5\u586B\u9879\u3002",groupNameExists:"\u5DF2\u5B58\u5728\u540C\u540D\u7EC4\u7FA4\u3002\u8BF7\u4F7F\u7528\u4E0D\u540C\u7684\u540D\u79F0\u3002",addImageDetails:"\u6DFB\u52A0\u56FE\u50CF\u8BE6\u60C5",editImageDetails:"\u7F16\u8F91\u56FE\u50CF\u8BE6\u60C5",commaSeparatedTags:"\u4EE5\u9017\u53F7\u5206\u9694\u7684\u6807\u7B7E\u3002",commaSeparatedCharacterNames:"\u4EE5\u9017\u53F7\u5206\u9694\u7684\u89D2\u8272\u540D\u79F0\u3002",commaSeparatedLocationNames:"\u4EE5\u9017\u53F7\u5206\u9694\u7684\u4F4D\u7F6E\u540D\u79F0\u3002",commaSeparatedEventNames:"\u4EE5\u9017\u53F7\u5206\u9694\u7684\u4E8B\u4EF6\u540D\u79F0\u3002",saveDetails:"\u4FDD\u5B58\u8BE6\u60C5",removeFromGallery:"\u4ECE\u56FE\u5E93\u79FB\u9664",imageDetailsSaved:'\u5DF2\u4FDD\u5B58 "{0}" \u7684\u56FE\u50CF\u8BE6\u60C5\u3002',imageRemovedFromGallery:'\u5DF2\u4ECE\u56FE\u5E93\u4E2D\u79FB\u9664 "{0}"\u3002',confirmDeleteScene:'\u5220\u9664\u573A\u666F "{0}"\uFF1F',confirmDeleteReference:'\u5220\u9664\u53C2\u8003 "{0}"\uFF1F',confirmDeleteChapter:'\u5220\u9664\u7AE0\u8282 "{0}"\uFF1F',confirmDeleteGroup:'\u786E\u5B9A\u8981\u5220\u9664\u7EC4\u7FA4 "{0}"\uFF1F',confirmDeleteCharacter:'\u786E\u5B9A\u8981\u5220\u9664 "{0}"\uFF1F',confirmDeleteEvent:'\u786E\u5B9A\u8981\u5220\u9664\u4E8B\u4EF6 "{0}"\uFF1F\u8FD9\u5C06\u628A\u7B14\u8BB0\u79FB\u81F3\u7CFB\u7EDF\u56DE\u6536\u7AD9\u3002',confirmDeleteLocation:'\u786E\u5B9A\u8981\u5220\u9664 "{0}"\uFF1F',confirmDeleteItem:'\u786E\u5B9A\u8981\u5220\u9664 "{0}"\uFF1F',confirmDeleteStory:'\u5220\u9664\u6545\u4E8B "{0}"\uFF1F\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\u3002',confirmRemoveImageFromGallery:'\u786E\u5B9A\u8981\u4ECE\u56FE\u5E93\u4E2D\u79FB\u9664 "{0}"\uFF1F\u8FD9\u4E0D\u4F1A\u5220\u9664\u6587\u4EF6\u672C\u8EAB\u3002',confirmDeleteCharacterTrash:'\u786E\u5B9A\u8981\u5220\u9664 "{0}"\uFF1F\u8FD9\u5C06\u628A\u6587\u4EF6\u79FB\u81F3\u7CFB\u7EDF\u56DE\u6536\u7AD9\u3002',confirmDeleteItemTrash:'\u786E\u5B9A\u8981\u5220\u9664 "{0}"\uFF1F\u8FD9\u5C06\u628A\u6587\u4EF6\u79FB\u81F3\u7CFB\u7EDF\u56DE\u6536\u7AD9\u3002',sceneCreated:'\u573A\u666F "{0}" \u5DF2\u521B\u5EFA\u3002',sceneUpdated:'\u573A\u666F "{0}" \u5DF2\u66F4\u65B0\u3002',chapterCreated:'\u7AE0\u8282 "{0}" \u5DF2\u521B\u5EFA\u3002',chapterUpdated:'\u7AE0\u8282 "{0}" \u5DF2\u66F4\u65B0\u3002',referenceCreated:'\u53C2\u8003 "{0}" \u5DF2\u521B\u5EFA\u3002',referenceUpdated:'\u53C2\u8003 "{0}" \u5DF2\u66F4\u65B0\u3002',groupCreated:'\u7EC4\u7FA4 "{0}" \u5DF2\u521B\u5EFA\u3002',groupRenamed:'\u7EC4\u7FA4\u5DF2\u91CD\u547D\u540D\u4E3A "{0}"\u3002',groupDeleted:'\u7EC4\u7FA4 "{0}" \u5DF2\u5220\u9664\u3002',characterDeleted:'\u89D2\u8272 "{0}" \u5DF2\u5220\u9664\u3002',locationDeleted:'\u4F4D\u7F6E "{0}" \u5DF2\u5220\u9664\u3002',itemDeleted:'\u7269\u54C1 "{0}" \u5DF2\u5220\u9664\u3002',fileMovedToTrash:"{0} \u6587\u4EF6\u5DF2\u79FB\u81F3\u56DE\u6536\u7AD9\u3002",characterLinkedAlready:'\u89D2\u8272 "{0}" \u5DF2\u7ECF\u5173\u8054\u3002',failedToDelete:"\u5220\u9664{0}\u5931\u8D25\u3002",failedToSave:"\u4FDD\u5B58{0}\u5931\u8D25\u3002",customFieldError:"\u81EA\u5B9A\u4E49\u5B57\u6BB5\u540D\u79F0\u5FC5\u987B\u552F\u4E00\u3001\u975E\u7A7A\u4E14\u672A\u4FDD\u7559\u3002",sceneNameRequired:"\u573A\u666F\u6807\u9898\u662F\u5FC5\u586B\u9879\u3002",chapterNameRequired:"\u7AE0\u8282\u6807\u9898\u662F\u5FC5\u586B\u9879\u3002",locationNameRequired:"\u4F4D\u7F6E\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\u3002",circularLocationError:"\u65E0\u6CD5\u8BBE\u7F6E\u7236\u4F4D\u7F6E\uFF1A\u8FD9\u5C06\u521B\u5EFA\u5FAA\u73AF\u5F15\u7528\u3002",errorLoadingCharacters:"\u52A0\u8F7D\u89D2\u8272\u65F6\u51FA\u9519\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u3002",errorLoadingLocations:"\u52A0\u8F7D\u4F4D\u7F6E\u65F6\u51FA\u9519\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u3002",errorLoadingEvents:"\u52A0\u8F7D\u4E8B\u4EF6\u65F6\u51FA\u9519\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u3002",errorLoadingItems:"\u52A0\u8F7D\u7269\u54C1\u65F6\u51FA\u9519\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u3002",groupNotFound:"\u672A\u627E\u5230\u7EC4\u7FA4\u3002",noGroupsToRename:"\u6CA1\u6709\u7EC4\u7FA4\u53EF\u91CD\u547D\u540D\u3002",noGroupsToDelete:"\u6CA1\u6709\u7EC4\u7FA4\u53EF\u5220\u9664\u3002",couldNotFindNote:"\u627E\u4E0D\u5230\u7B14\u8BB0\u6587\u4EF6\u3002",autoDetectedStories:"\u6545\u4E8B\u8BB2\u8FF0\u8005\uFF1A\u81EA\u52A8\u68C0\u6D4B\u5E76\u5BFC\u5165\u4E86 {0} \u4E2A\u65B0\u6545\u4E8B\u6587\u4EF6\u5939\u3002",errorDiscoveringStories:"\u6545\u4E8B\u8BB2\u8FF0\u8005\u5957\u4EF6\uFF1A\u53D1\u73B0\u6545\u4E8B\u65F6\u51FA\u9519\uFF1A{0}",storiesRefreshed:"\u6545\u4E8B\u8BB2\u8FF0\u8005\uFF1A\u53D1\u73B0\u5E76\u5BFC\u5165\u4E86 {0} \u4E2A\u65B0\u6545\u4E8B\u6587\u4EF6\u5939\u3002",noNewStoriesFound:"\u6545\u4E8B\u8BB2\u8FF0\u8005\uFF1A\u672A\u53D1\u73B0\u65B0\u7684\u6545\u4E8B\u6587\u4EF6\u5939\u3002",errorRefreshingStories:"\u6545\u4E8B\u8BB2\u8FF0\u8005\u5957\u4EF6\uFF1A\u5237\u65B0\u6545\u4E8B\u65F6\u51FA\u9519\uFF1A{0}",errorScanningFolders:"\u6545\u4E8B\u8BB2\u8FF0\u8005\u5957\u4EF6\uFF1A\u626B\u63CF\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939\u65F6\u51FA\u9519\uFF1A{0}",couldNotAutoDetect:"\u6545\u4E8B\u8BB2\u8FF0\u8005\uFF1A\u65E0\u6CD5\u81EA\u52A8\u68C0\u6D4B\u6545\u4E8B\u6839\u76EE\u5F55\u3002\u8BF7\u624B\u52A8\u8BBE\u7F6E\u6587\u4EF6\u5939\u3002",autoDetectedFolders:'\u6545\u4E8B\u8BB2\u8FF0\u8005\uFF1A\u5728 "{0}" \u4E0B\u81EA\u52A8\u68C0\u6D4B\u5230\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939\uFF08\u5339\u914D\uFF1A{1}\uFF09\u3002',uploadedToVault:'\u5DF2\u4E0A\u4F20 "{0}" \u5230\u4FDD\u9669\u5E93\u3002',errorUploadingFile:"\u4E0A\u4F20\u6587\u4EF6\u65F6\u51FA\u9519\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u4E86\u89E3\u8BE6\u60C5\u3002",errorParsingFile:"\u89E3\u6790\u6587\u4EF6\u65F6\u51FA\u9519\uFF1A{0}",currentValue:"\u5F53\u524D\uFF1A{0}",ownerValue:"\u62E5\u6709\u8005\uFF1A{0}",noImagesFoundFilter:"\u672A\u627E\u5230\u56FE\u50CF\u3002\u5339\u914D\u7B5B\u9009\u5668\u3002",tutorialGettingStarted:"\u6559\u7A0B\u548C\u5165\u95E8\u6307\u5357",type:"\u7C7B\u578B",region:"\u533A\u57DF",storyNameField:"\u6545\u4E8B\u540D\u79F0",descriptionField:"\u63CF\u8FF0",beatSheetPh:`- \u9047\u89C1\u5BFC\u5E08
- \u62D2\u7EDD`,categoryPh:"\u8BED\u8A00\u3001\u9884\u8A00\u3001\u7075\u611F\u3001\u6742\u9879...",fieldNamePh:"\u5B57\u6BB5\u540D\u79F0",fieldValuePh:"\u5B57\u6BB5\u503C",galleryUploadFolderPh:"\u6545\u4E8B\u8BB2\u8FF0\u8005\u5957\u4EF6/\u56FE\u5E93\u4E0A\u4F20",customTodayPh:"YYYY-MM-DD \u6216\u5B8C\u6574 ISO\uFF08\u652F\u6301\u516C\u5143\u524D\u65E5\u671F\uFF09",timelineHeightPh:"\u4F8B\u5982\uFF1A380px",storyRootFolderPh:"\u521B\u610F/\u5199\u4F5C/{storyName}",charactersFolderPh:"\u6211\u7684\u6545\u4E8B/\u89D2\u8272",locationsFolderPh:"\u6211\u7684\u6545\u4E8B/\u4F4D\u7F6E",eventsFolderPh:"\u6211\u7684\u6545\u4E8B/\u4E8B\u4EF6",itemsFolderPh:"\u6211\u7684\u6545\u4E8B/\u7269\u54C1",referencesFolderPh:"\u6211\u7684\u6545\u4E8B/\u53C2\u8003",scenesFolderPh:"\u6211\u7684\u6545\u4E8B/\u573A\u666F",chaptersFolderPh:"\u6211\u7684\u6545\u4E8B/\u7AE0\u8282",oneStoryBaseFolderPh:"\u6545\u4E8B\u8BB2\u8FF0\u8005\u5957\u4EF6",enterStoryNamePh:"\u8F93\u5165\u6545\u4E8B\u540D\u79F0",describeStoryPh:"\u63CF\u8FF0\u4F60\u7684\u6545\u4E8B\uFF08\u53EF\u9009\uFF09",selectImageFilePh:"\u9009\u62E9\u56FE\u50CF\u6587\u4EF6...",filterImagesPh:"\u6309\u6807\u9898\u3001\u6807\u7B7E\u3001\u94FE\u63A5\u7B5B\u9009...",selectItemPh:"\u9009\u62E9\u8981\u94FE\u63A5\u7684\u7269\u54C1...",selectEventLocationPh:"\u9009\u62E9\u4E8B\u4EF6\u7684\u4F4D\u7F6E...",selectParentLocationPh:"\u9009\u62E9\u7236\u4F4D\u7F6E...",selectGroupPh:"\u9009\u62E9\u7EC4\u7FA4...",filterFoldersPh:"\u8F93\u5165\u4EE5\u7B5B\u9009\u6587\u4EF6\u5939...",selectGalleryImagePh:"\u4ECE\u56FE\u5E93\u9009\u62E9\u56FE\u50CF...",selectEventPh:"\u9009\u62E9\u8981\u94FE\u63A5\u7684\u4E8B\u4EF6...",selectCharacterPh:"\u9009\u62E9\u8981\u94FE\u63A5\u7684\u89D2\u8272...",priorityInChapter:"\u7AE0\u8282\u4E2D\u7684\u4F18\u5148\u7EA7",priorityEg:"\u4F8B\u5982\uFF0C1",beatSheetOneLine:"\u8282\u62CD\u8868\u5355\u884C",writeScenePh:"\u5199\u4E0B\u4F60\u7684\u573A\u666F...",scanVaultDesc:"\u626B\u63CF\u4F60\u7684\u4FDD\u9669\u5E93\u4EE5\u67E5\u627E\u73B0\u6709\u7684\u6545\u4E8B\u8BB2\u8FF0\u8005\u6545\u4E8B\u5E76\u5BFC\u5165\u5B83\u4EEC\u3002\u5728\u79FB\u52A8\u6587\u4EF6\u5939\u6216\u66F4\u6539\u7ED3\u6784\u540E\u5F88\u6709\u7528\u3002",galleryFolderDesc:"\u5B58\u50A8\u4E0A\u4F20\u7684\u56FE\u5E93\u56FE\u50CF\u7684\u6587\u4EF6\u5939",customFieldsDesc:"\u9009\u62E9\u81EA\u5B9A\u4E49\u5B57\u6BB5\u5728\u524D\u7F6E\u5185\u5BB9\u4E2D\u7684\u5B58\u50A8\u65B9\u5F0F",forwardDateBiasDesc:'\u5BF9\u76F8\u5BF9\u65E5\u671F\u504F\u5411\u672A\u6765\u89E3\u91CA\uFF08\u4F8B\u5982"\u661F\u671F\u4E94"\uFF09',customTodayDesc:'\u7528\u4E8E"\u4ECA\u5929"\u6309\u94AE\u548C\u76F8\u5BF9\u89E3\u6790\u7684\u53EF\u9009\u65E5\u671F\u3002\u652F\u6301\u516C\u5143\u524D\u65E5\u671F\uFF08\u4F8B\u5982\uFF0C2024-01-15 \u8868\u793A\u516C\u5143\uFF0C-00499-01-01 \u8868\u793A\u516C\u5143\u524D 500 \u5E74\uFF09\u3002\u7559\u7A7A\u4F7F\u7528\u7CFB\u7EDF\u4ECA\u5929\u3002',timelineHeightDesc:"\u8C03\u6574\u65F6\u95F4\u7EBF\u6A21\u6001\u6846\u7684\u9AD8\u5EA6",useCustomFoldersDesc:"\u542F\u7528\u65F6\uFF0C\u4F7F\u7528\u4E0B\u9762\u7684\u6587\u4EF6\u5939\u8DEF\u5F84\u3002\u4F60\u53EF\u4EE5\u5305\u542B {storyName}\u3001{storySlug} \u6216 {storyId} \u6765\u521B\u5EFA\u6BCF\u4E2A\u6545\u4E8B\u7684\u6587\u4EF6\u5939\uFF08\u4F8B\u5982\uFF0C\u521B\u610F/\u5199\u4F5C/{storyName}/\u89D2\u8272\uFF09\u3002",previewFoldersDesc:"\u6839\u636E\u5F53\u524D\u8BBE\u7F6E\u548C\u6D3B\u52A8\u6545\u4E8B\u67E5\u770B\u6BCF\u4E2A\u5B9E\u4F53\u7684\u89E3\u6790\u6587\u4EF6\u5939\u8DEF\u5F84",storyRootDesc:"\u6240\u6709\u5B9E\u4F53\u7684\u57FA\u7840\u8DEF\u5F84\u6A21\u677F\u3002\u652F\u6301 {storyName}\u3001{storySlug}\u3001{storyId}\u3002\u793A\u4F8B\uFF1A\u521B\u610F/\u5199\u4F5C/{storyName}",charactersFolderDesc:"\u89D2\u8272 Markdown \u6587\u4EF6\u7684\u8DEF\u5F84\uFF08\u5141\u8BB8\u5360\u4F4D\u7B26\uFF1A{storyName}\u3001{storySlug}\u3001{storyId}\uFF09",locationsFolderDesc:"\u4F4D\u7F6E Markdown \u6587\u4EF6\u7684\u8DEF\u5F84\uFF08\u5141\u8BB8\u5360\u4F4D\u7B26\uFF1A{storyName}\u3001{storySlug}\u3001{storyId}\uFF09",eventsFolderDesc:"\u4E8B\u4EF6 Markdown \u6587\u4EF6\u7684\u8DEF\u5F84\uFF08\u5141\u8BB8\u5360\u4F4D\u7B26\uFF1A{storyName}\u3001{storySlug}\u3001{storyId}\uFF09",itemsFolderDesc:"\u7269\u54C1 Markdown \u6587\u4EF6\u7684\u8DEF\u5F84\uFF08\u5141\u8BB8\u5360\u4F4D\u7B26\uFF1A{storyName}\u3001{storySlug}\u3001{storyId}\uFF09",referencesFolderDesc:"\u53C2\u8003 Markdown \u6587\u4EF6\u7684\u8DEF\u5F84\uFF08\u5141\u8BB8\u5360\u4F4D\u7B26\uFF1A{storyName}\u3001{storySlug}\u3001{storyId}\uFF09",scenesFolderDesc:"\u573A\u666F Markdown \u6587\u4EF6\u7684\u8DEF\u5F84\uFF08\u5141\u8BB8\u5360\u4F4D\u7B26\uFF1A{storyName}\u3001{storySlug}\u3001{storyId}\uFF09",chaptersFolderDesc:"\u7AE0\u8282 Markdown \u6587\u4EF6\u7684\u8DEF\u5F84\uFF08\u5141\u8BB8\u5360\u4F4D\u7B26\uFF1A{storyName}\u3001{storySlug}\u3001{storyId}\uFF09",oneStoryModeDesc:"\u5C06\u6587\u4EF6\u5939\u7ED3\u6784\u6241\u5E73\u5316\u4E3A\u5355\u4E2A\u6545\u4E8B\u3002\u542F\u7528\u65F6\uFF08\u4E14\u7981\u7528\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939\uFF09\uFF0C\u5185\u5BB9\u653E\u5728\u5355\u4E2A\u57FA\u7840\u6587\u4EF6\u5939\u4E0B\uFF0C\u4E0D\u5305\u542B\u6545\u4E8B/\u6545\u4E8B\u540D\u79F0\u3002",oneStoryBaseFolderDesc:"\u89D2\u8272/\u4F4D\u7F6E/\u4E8B\u4EF6/\u7269\u54C1/\u53C2\u8003/\u7AE0\u8282\u7684\u57FA\u7840\u6587\u4EF6\u5939",showTutorialDesc:"\u5728\u8BBE\u7F6E\u4E2D\u663E\u793A\u6559\u7A0B\u548C\u5165\u95E8\u6307\u5357\u90E8\u5206",supportDevDesc:"\u5982\u679C\u4F60\u89C9\u5F97\u8FD9\u4E2A\u63D2\u4EF6\u6709\u7528\uFF0C\u8BF7\u8003\u8651\u652F\u6301\u5176\u5F00\u53D1",pluginInfoDesc:"\u6545\u4E8B\u8BB2\u8FF0\u8005\u5957\u4EF6 - \u7BA1\u7406\u6545\u4E8B\u89D2\u8272\u3001\u4F4D\u7F6E\u3001\u4E8B\u4EF6\u548C\u56FE\u5E93\u7684\u7EFC\u5408\u5957\u4EF6\u3002",storyNameDesc:"\u5FC5\u586B\u3002\u5FC5\u987B\u552F\u4E00\u3002",descriptionOptionalDesc:"\u53EF\u9009",locationNameDesc:"\u4F4D\u7F6E\u7684\u540D\u79F0\u3002",locationTypeDesc:"\u4F8B\u5982\uFF1A\u57CE\u5E02\u3001\u68EE\u6797\u3001\u57CE\u5821\u3001\u9152\u9986",locationRegionDesc:"\u66F4\u5E7F\u6CDB\u7684\u5730\u7406\u533A\u57DF\u3002",locationStatusDesc:"\u4F8B\u5982\uFF1A\u6D3B\u8DC3\u3001\u5E9F\u589F\u3001\u5E9F\u5F03",parentLocationDesc:"\u9009\u62E9\u5305\u542B\u6B64\u4F4D\u7F6E\u7684\u7236\u4F4D\u7F6E\u3002",assignToGroupsDesc:"\u5C06\u6B64\u4F4D\u7F6E\u5206\u914D\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u7EC4\u7FA4\u3002",manageGroupsDesc:"\u7BA1\u7406\u4F60\u7684\u7EC4\u7FA4\u3002\u5728\u6240\u6709\u5B9E\u4F53\u7C7B\u578B\u95F4\u5171\u4EAB\u3002",searchGroupsDesc:"\u6309\u7EC4\u7FA4\u540D\u79F0\u6216\u63CF\u8FF0\u641C\u7D22\u3002",manageCharactersDesc:"\u7BA1\u7406\u4F60\u7684\u6545\u4E8B\u89D2\u8272\u3002",manageLocationsDesc:"\u7BA1\u7406\u4F60\u7684\u6545\u4E8B\u4F4D\u7F6E\u3002",manageEventsDesc:"\u7BA1\u7406\u4F60\u7684\u6545\u4E8B\u4E8B\u4EF6\u3002",manageImagesDesc:"\u7BA1\u7406\u4F60\u7684\u6545\u4E8B\u56FE\u50CF\u3002",assignEventToGroupsDesc:"\u5C06\u6B64\u4E8B\u4EF6\u5206\u914D\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u7EC4\u7FA4\u3002",assignItemToGroupsDesc:"\u5C06\u6B64\u7269\u54C1\u5206\u914D\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u7EC4\u7FA4\u3002",assignCharacterToGroupsDesc:"\u5C06\u6B64\u89D2\u8272\u5206\u914D\u5230\u4E00\u4E2A\u6216\u591A\u4E2A\u7EC4\u7FA4\u3002",nodesLabel:"\u8282\u70B9",edgesLabel:"\u8FB9",filteredLabel:"\u5DF2\u7B5B\u9009",loadingNodes:"\u52A0\u8F7D\u8282\u70B9\u4E2D",emptyGraphTitle:"\u65E0\u5B9E\u4F53\u53EF\u663E\u793A",emptyGraphMessage:"\u521B\u5EFA\u89D2\u8272\u3001\u4F4D\u7F6E\u3001\u4E8B\u4EF6\u6216\u7269\u54C1\u4EE5\u5728\u7F51\u7EDC\u56FE\u8C31\u4E2D\u67E5\u770B\u5B83\u4EEC\u3002",emptyGraphTip:"\u5728\u5B9E\u4F53\u4E4B\u95F4\u6DFB\u52A0\u5173\u7CFB\u4EE5\u5728\u6B64\u5904\u53EF\u89C6\u5316\u8FDE\u63A5\u3002",keyboardShortcuts:"\u952E\u76D8\u5FEB\u6377\u952E",graphUpdated:"\u56FE\u8C31\u5DF2\u66F4\u65B0",filterApplied:"\u5DF2\u5E94\u7528\u7B5B\u9009",layoutChanged:"\u5E03\u5C40\u5DF2\u66F4\u6539",graphFitToView:"\u9002\u5E94\u56FE\u8C31\u5230\u89C6\u56FE",showingXNodes:"\u663E\u793A {0} \u4E2A\u8282\u70B9",showingXEdges:"{0} \u6761\u8FB9",noNodesVisible:"\u5F53\u524D\u7B5B\u9009\u5668\u4E0B\u65E0\u53EF\u89C1\u8282\u70B9",createNewEconomy:"\u521B\u5EFA\u65B0\u7ECF\u6D4E",createEconomy:"\u521B\u5EFA\u7ECF\u6D4E",editEconomy:"\u7F16\u8F91\u7ECF\u6D4E",deleteEconomy:"\u5220\u9664\u7ECF\u6D4E",viewEconomies:"\u67E5\u770B\u7ECF\u6D4E",economies:"\u7ECF\u6D4E",economy:"\u7ECF\u6D4E",economicSystem:"\u7ECF\u6D4E\u4F53\u7CFB",economicSystemDesc:"\u7ECF\u6D4E\u7EC4\u7EC7\u7C7B\u578B",economyNameDesc:'\u7ECF\u6D4E\u4F53\u7CFB\u7684\u540D\u79F0\uFF08\u4F8B\u5982\uFF1A"\u57C3\u5C14\u591A\u5229\u4E9A\u738B\u56FD\u7ECF\u6D4E"\uFF09',industries:"\u4EA7\u4E1A",industriesDesc:"\u4E3B\u8981\u4EA7\u4E1A\u3001\u751F\u4EA7\u548C\u7ECF\u6D4E\u6D3B\u52A8",taxation:"\u7A0E\u6536\u4E0E\u8D38\u6613\u653F\u7B56",taxationDesc:"\u7A0E\u6536\u4F53\u7CFB\u3001\u8D38\u6613\u6CD5\u89C4\u548C\u7ECF\u6D4E\u653F\u7B56",representativeImage:"\u4EE3\u8868\u56FE\u50CF",barterEconomy:"\u7269\u7269\u4EA4\u6362\u7ECF\u6D4E",marketEconomy:"\u5E02\u573A\u7ECF\u6D4E",commandEconomy:"\u8BA1\u5212\u7ECF\u6D4E",mixedEconomy:"\u6DF7\u5408\u7ECF\u6D4E",feudalEconomy:"\u5C01\u5EFA\u7ECF\u6D4E",giftEconomy:"\u8D60\u4E88\u7ECF\u6D4E",booming:"\u7E41\u8363",growing:"\u589E\u957F",recession:"\u8870\u9000",depression:"\u8427\u6761",recovering:"\u590D\u82CF",economyNameRequired:"\u7ECF\u6D4E\u540D\u79F0\u4E3A\u5FC5\u586B\u9879",economyStatusDesc:"\u5F53\u524D\u7ECF\u6D4E\u5065\u5EB7\u72B6\u51B5",economyDescriptionDesc:"\u7ECF\u6D4E\u4F53\u7CFB\u7684\u6982\u8FF0\u548C\u7279\u5F81",noEconomiesFound:"\u672A\u627E\u5230\u7ECF\u6D4E",searchEconomies:"\u641C\u7D22\u7ECF\u6D4E...",confirmDeleteEconomy:'\u786E\u5B9A\u8981\u5220\u9664\u7ECF\u6D4E"{0}"\u5417\uFF1F\u8FD9\u5C06\u628A\u7B14\u8BB0\u79FB\u81F3\u7CFB\u7EDF\u56DE\u6536\u7AD9\u3002',economyCreated:'\u7ECF\u6D4E"{0}"\u5DF2\u521B\u5EFA\u3002',economyUpdated:'\u7ECF\u6D4E"{0}"\u5DF2\u66F4\u65B0\u3002',economyDeleted:'\u7ECF\u6D4E"{0}"\u5DF2\u5220\u9664\u3002',createNewCulture:"\u521B\u5EFA\u65B0\u6587\u5316",createCulture:"\u521B\u5EFA\u6587\u5316",editCulture:"\u7F16\u8F91\u6587\u5316",deleteCulture:"\u5220\u9664\u6587\u5316",viewCultures:"\u67E5\u770B\u6587\u5316",cultures:"\u6587\u5316",culture:"\u6587\u5316",cultureNameDesc:"\u6587\u5316\u6216\u793E\u4F1A\u7684\u540D\u79F0",techLevel:"\u79D1\u6280\u6C34\u5E73",techLevelDesc:"\u6587\u5316\u7684\u79D1\u6280\u8FDB\u6B65\u6C34\u5E73",governmentType:"\u653F\u5E9C\u7C7B\u578B",governmentTypeDesc:"\u653F\u6CBB\u4F53\u5236\u548C\u9886\u5BFC\u7ED3\u6784",languages:"\u8BED\u8A00",languagesDesc:"\u4EE5\u9017\u53F7\u5206\u9694\u7684\u8BED\u8A00\u5217\u8868\uFF08\u4F8B\u5982\uFF1A\u901A\u7528\u8BED\u3001\u7CBE\u7075\u8BED\u3001\u77EE\u4EBA\u8BED\uFF09",population:"\u4EBA\u53E3",populationDesc:'\u4F30\u8BA1\u4EBA\u53E3\u89C4\u6A21\uFF08\u4F8B\u5982\uFF1A"10,000"\u6216"\u5927"\uFF09',valuesBeliefs:"\u4EF7\u503C\u89C2\u548C\u4FE1\u4EF0",valuesBeliefsDesc:"\u6838\u5FC3\u6587\u5316\u4EF7\u503C\u89C2\u3001\u4E16\u754C\u89C2\u548C\u54F2\u5B66\u4FE1\u4EF0",religion:"\u5B97\u6559",religionDesc:"\u5B97\u6559\u4FE1\u4EF0\u3001\u5B9E\u8DF5\u548C\u5D07\u62DC\u7684\u795E\u7075",socialStructure:"\u793E\u4F1A\u7ED3\u6784",socialStructureDesc:"\u9636\u7EA7\u7B49\u7EA7\u3001\u793E\u4F1A\u7EC4\u7EC7\u548C\u79CD\u59D3\u5236\u5EA6",namingConventions:"\u547D\u540D\u89C4\u5219",namingConventionsDesc:"\u8BE5\u6587\u5316\u6210\u5458\u5982\u4F55\u547D\u540D\u4EBA\u7269\u3001\u5730\u70B9\u548C\u4E8B\u7269",customsTraditions:"\u4E60\u4FD7\u4E0E\u4F20\u7EDF",customsTraditionsDesc:"\u6587\u5316\u4E60\u4FD7\u3001\u4EEA\u5F0F\u3001\u8282\u65E5\u548C\u4F20\u7EDF",cultureStatusDesc:"\u6587\u5316\u7684\u5F53\u524D\u72B6\u6001",cultureDescriptionDesc:"\u6587\u5316\u7684\u6982\u8FF0\u548C\u5173\u952E\u7279\u5F81",cultureHistoryDesc:"\u8D77\u6E90\u3001\u91CD\u5927\u5386\u53F2\u4E8B\u4EF6\u548C\u6587\u5316\u6F14\u53D8",stoneAge:"\u77F3\u5668\u65F6\u4EE3",bronzeAge:"\u9752\u94DC\u65F6\u4EE3",ironAge:"\u94C1\u5668\u65F6\u4EE3",medieval:"\u4E2D\u4E16\u7EAA",renaissance:"\u6587\u827A\u590D\u5174",industrial:"\u5DE5\u4E1A\u65F6\u4EE3",modern:"\u73B0\u4EE3",futuristic:"\u672A\u6765",monarchy:"\u541B\u4E3B\u5236",democracy:"\u6C11\u4E3B\u5236",republic:"\u5171\u548C\u5236",theocracy:"\u795E\u6743\u653F\u6CBB",tribal:"\u90E8\u843D\u5236",empire:"\u5E1D\u56FD",feudal:"\u5C01\u5EFA\u5236",oligarchy:"\u5BE1\u5934\u5236",anarchy:"\u65E0\u653F\u5E9C",thriving:"\u7E41\u8363",stable:"\u7A33\u5B9A",declining:"\u8870\u843D",extinct:"\u706D\u7EDD",emerging:"\u65B0\u5174",cultureNameRequired:"\u6587\u5316\u540D\u79F0\u4E3A\u5FC5\u586B\u9879",noCulturesFound:"\u672A\u627E\u5230\u6587\u5316",searchCultures:"\u641C\u7D22\u6587\u5316...",confirmDeleteCulture:'\u5220\u9664\u6587\u5316"{0}"\uFF1F\u8FD9\u5C06\u628A\u7B14\u8BB0\u79FB\u81F3\u7CFB\u7EDF\u56DE\u6536\u7AD9\u3002',cultureCreated:'\u6587\u5316"{0}"\u5DF2\u521B\u5EFA\u3002',cultureUpdated:'\u6587\u5316"{0}"\u5DF2\u66F4\u65B0\u3002',cultureDeleted:'\u6587\u5316"{0}"\u5DF2\u5220\u9664\u3002',createNewMagicSystem:"\u521B\u5EFA\u65B0\u9B54\u6CD5\u7CFB\u7EDF",createMagicSystem:"\u521B\u5EFA\u9B54\u6CD5\u7CFB\u7EDF",editMagicSystem:"\u7F16\u8F91\u9B54\u6CD5\u7CFB\u7EDF",deleteMagicSystem:"\u5220\u9664\u9B54\u6CD5\u7CFB\u7EDF",viewMagicSystems:"\u67E5\u770B\u9B54\u6CD5\u7CFB\u7EDF",magicSystems:"\u9B54\u6CD5\u7CFB\u7EDF",magicSystem:"\u9B54\u6CD5\u7CFB\u7EDF",magicSystemNameDesc:'\u9B54\u6CD5\u7CFB\u7EDF\u7684\u540D\u79F0\uFF08\u4F8B\u5982\uFF1A"\u5965\u672F\u827A\u672F"\u3001"\u795E\u5723\u9B54\u6CD5"\uFF09',systemType:"\u7CFB\u7EDF\u7C7B\u578B",systemTypeDesc:"\u9B54\u6CD5\u529B\u91CF\u7684\u6765\u6E90\u6216\u7C7B\u522B",rarity:"\u7A00\u6709\u5EA6",rarityDesc:"\u9B54\u6CD5\u5728\u4E16\u754C\u4E2D\u6709\u591A\u5E38\u89C1\uFF1F",powerLevel:"\u529B\u91CF\u7B49\u7EA7",powerLevelDesc:"\u8BE5\u9B54\u6CD5\u7CFB\u7EDF\u7684\u6574\u4F53\u5A01\u529B",rulesMechanics:"\u89C4\u5219\u4E0E\u673A\u5236",rulesMechanicsDesc:"\u9B54\u6CD5\u5982\u4F55\u4F7F\u7528\u3001\u65BD\u653E\u6216\u4F20\u5BFC",source:"\u6765\u6E90",sourceDesc:"\u9B54\u6CD5\u529B\u91CF\u4ECE\u4F55\u800C\u6765\uFF1F",costsConsequences:"\u4EE3\u4EF7\u4E0E\u540E\u679C",costsConsequencesDesc:"\u4F7F\u7528\u9B54\u6CD5\u5BF9\u65BD\u6CD5\u8005\u7684\u4EE3\u4EF7\u662F\u4EC0\u4E48\uFF1F",limitations:"\u9650\u5236",limitationsDesc:"\u8BE5\u9B54\u6CD5\u7684\u8FB9\u754C\u548C\u9650\u5236\u662F\u4EC0\u4E48\uFF1F",trainingLearning:"\u8BAD\u7EC3\u4E0E\u5B66\u4E60",trainingLearningDesc:"\u9B54\u6CD5\u5982\u4F55\u5B66\u4E60\u548C\u638C\u63E1\uFF1F",arcane:"\u5965\u672F\uFF08\u5B66\u4E60\u578B\uFF09",divine:"\u795E\u5723\uFF08\u4FE1\u4EF0\u578B\uFF09",natural:"\u81EA\u7136\uFF08\u81EA\u7136/\u5FB7\u9C81\u4F0A\uFF09",psionic:"\u7075\u80FD\uFF08\u5FC3\u7075\u529B\u91CF\uFF09",bloodMagic:"\u8840\u9B54\u6CD5",elemental:"\u5143\u7D20",necromancy:"\u6B7B\u7075\u672F",alchemy:"\u70BC\u91D1\u672F",runeMagic:"\u7B26\u6587\u9B54\u6CD5",ubiquitous:"\u666E\u904D\uFF08\u4EBA\u4EBA\u90FD\u6709\uFF09",common:"\u5E38\u89C1\uFF08\u8BB8\u591A\u4EBA\u6709\uFF09",uncommon:"\u4E0D\u5E38\u89C1\uFF08\u4E00\u4E9B\u4EBA\u6709\uFF09",rare:"\u7A00\u6709\uFF08\u5C11\u6570\u4EBA\u6709\uFF09",legendary:"\u4F20\u8BF4\uFF08\u51E0\u4E4E\u6CA1\u6709\uFF09",low:"\u4F4E\uFF08\u7EC6\u5FAE\u6548\u679C\uFF09",moderate:"\u4E2D\u7B49\uFF08\u660E\u663E\u6548\u679C\uFF09",high:"\u9AD8\uFF08\u5F3A\u5927\u6548\u679C\uFF09",godlike:"\u795E\u7EA7\uFF08\u626D\u66F2\u73B0\u5B9E\uFF09",forbidden:"\u7981\u6B62",lostKnowledge:"\u5931\u4F20\u77E5\u8BC6",resurgent:"\u590D\u82CF",magicSystemNameRequired:"\u9B54\u6CD5\u7CFB\u7EDF\u540D\u79F0\u4E3A\u5FC5\u586B\u9879",noMagicSystemsFound:"\u672A\u627E\u5230\u9B54\u6CD5\u7CFB\u7EDF",searchMagicSystems:"\u641C\u7D22\u9B54\u6CD5\u7CFB\u7EDF...",confirmDeleteMagicSystem:'\u5220\u9664\u9B54\u6CD5\u7CFB\u7EDF"{0}"\uFF1F\u8FD9\u5C06\u628A\u7B14\u8BB0\u79FB\u81F3\u7CFB\u7EDF\u56DE\u6536\u7AD9\u3002',magicSystemCreated:'\u9B54\u6CD5\u7CFB\u7EDF"{0}"\u5DF2\u521B\u5EFA\u3002',magicSystemUpdated:'\u9B54\u6CD5\u7CFB\u7EDF"{0}"\u5DF2\u66F4\u65B0\u3002',magicSystemDeleted:'\u9B54\u6CD5\u7CFB\u7EDF"{0}"\u5DF2\u5220\u9664\u3002',magicSystemStatusDesc:"\u9B54\u6CD5\u7CFB\u7EDF\u7684\u5F53\u524D\u72B6\u6001",magicSystemDescriptionDesc:"\u9B54\u6CD5\u7CFB\u7EDF\u7684\u6982\u8FF0\u548C\u8BF4\u660E",magicSystemHistoryDesc:"\u9B54\u6CD5\u7CFB\u7EDF\u7684\u8D77\u6E90\u3001\u53D1\u73B0\u548C\u6F14\u53D8",startFromTemplate:"\u4ECE\u6A21\u677F\u5F00\u59CB",startFromTemplateDesc:"\u53EF\u9009\u62E9\u4ECE\u9884\u914D\u7F6E\u7684\u6A21\u677F\u5F00\u59CB",chooseTemplate:"\u9009\u62E9\u6A21\u677F",selectTemplate:"\u9009\u62E9\u4E00\u4E2A\u6A21\u677F",templateApplied:'\u5DF2\u5E94\u7528\u6A21\u677F"{0}"',noTemplatesAvailable:"\u6B64\u6A21\u677F\u4E0D\u5305\u542B\u4EFB\u4F55\u9879\u76EE",cannotDeleteWithoutPath:"\u6CA1\u6709\u6587\u4EF6\u8DEF\u5F84\u65E0\u6CD5\u5220\u9664\u3002",cannotOpenWithoutPath:"\u6CA1\u6709\u6587\u4EF6\u8DEF\u5F84\u65E0\u6CD5\u6253\u5F00\u7B14\u8BB0\u3002",templates:"\u6A21\u677F",entityTemplates:"\u5B9E\u4F53\u6A21\u677F",browseManageTemplates:"\u6D4F\u89C8\u548C\u7BA1\u7406\u53EF\u91CD\u7528\u7684\u89D2\u8272\u3001\u4F4D\u7F6E\u548C\u5176\u4ED6\u5B9E\u4F53\u6A21\u677F\u3002",createNewTemplate:"\u521B\u5EFA\u65B0\u6A21\u677F",templateCreated:'\u6A21\u677F"{0}"\u5DF2\u521B\u5EFA\uFF01',searchTemplates:"\u641C\u7D22",searchTemplatesPlaceholder:"\u6309\u540D\u79F0\u3001\u63CF\u8FF0\u6216\u6807\u7B7E\u641C\u7D22\u6A21\u677F...",genre:"\u7C7B\u578B",allGenres:"\u6240\u6709\u7C7B\u578B",templateCategory:"\u7C7B\u522B",allTemplateCategories:"\u6240\u6709\u7C7B\u522B",singleEntity:"\u5355\u4E2A\u5B9E\u4F53",entitySet:"\u5B9E\u4F53\u96C6\u5408",fullWorld:"\u5B8C\u6574\u4E16\u754C",sortBy:"\u6392\u5E8F\u65B9\u5F0F",sortByName:"\u540D\u79F0",sortByUsage:"\u4F7F\u7528\u6B21\u6570",sortByRecent:"\u6700\u8FD1\u4F7F\u7528",showBuiltIn:"\u663E\u793A\u5185\u7F6E",showCustom:"\u663E\u793A\u81EA\u5B9A\u4E49",noTemplatesFound:"\u672A\u627E\u5230\u6A21\u677F\u3002\u8BF7\u5C1D\u8BD5\u8C03\u6574\u7B5B\u9009\u6761\u4EF6\u6216\u521B\u5EFA\u65B0\u6A21\u677F\u3002",foundXTemplates:"\u627E\u5230 {0} \u4E2A\u6A21\u677F",builtIn:"\u5185\u7F6E",usedXTimes:"\u5DF2\u4F7F\u7528\uFF1A{0}\u6B21",contains:"\u5305\u542B\uFF1A",useTemplate:"\u4F7F\u7528\u6A21\u677F",duplicate:"\u590D\u5236",templateSelected:'\u6A21\u677F"{0}"\u5DF2\u9009\u62E9\u3002\u4ECE\u5B9E\u4F53\u521B\u5EFA\u6A21\u6001\u6846\u5E94\u7528\u6B64\u6A21\u677F\u3002',templateDeleted:'\u6A21\u677F"{0}"\u5DF2\u5220\u9664\u3002',failedToDeleteTemplate:"\u5220\u9664\u6A21\u677F\u5931\u8D25\uFF1A{0}",templateCopySuffix:"\uFF08\u526F\u672C\uFF09",templateDuplicated:'\u6A21\u677F\u5DF2\u590D\u5236\u4E3A"{0}"',failedToDuplicateTemplate:"\u590D\u5236\u6A21\u677F\u5931\u8D25\uFF1A{0}",deleteTemplate:"\u5220\u9664\u6A21\u677F\uFF1F",confirmDeleteTemplate:'\u786E\u5B9A\u8981\u5220\u9664\u6A21\u677F"{0}"\u5417\uFF1F\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\u3002',dashboardTabVisibility:"\u4EEA\u8868\u677F\u6807\u7B7E\u9875\u53EF\u89C1\u6027",dashboardTabVisibilityDesc:"\u9009\u62E9\u5728\u4EEA\u8868\u677F\u4FA7\u8FB9\u680F\u4E2D\u663E\u793A\u54EA\u4E9B\u6807\u7B7E\u9875\u3002\u9690\u85CF\u7684\u6807\u7B7E\u9875\u4E0D\u4F1A\u51FA\u73B0\u5728\u6807\u7B7E\u680F\u4E2D\u3002",tabIsVisible:"\u6807\u7B7E\u9875\u53EF\u89C1",tabIsHidden:"\u6807\u7B7E\u9875\u5DF2\u9690\u85CF",tabShown:"{0} \u6807\u7B7E\u9875\u5DF2\u663E\u793A",tabHidden:"{0} \u6807\u7B7E\u9875\u5DF2\u9690\u85CF",refreshDashboardToSeeChanges:"\u3002\u5237\u65B0\u4EEA\u8868\u677F\u4EE5\u67E5\u770B\u66F4\u6539\u3002",ganttViewSettings:"\u7518\u7279\u56FE\u89C6\u56FE\u8BBE\u7F6E",showProgressBarsInGantt:"\u5728\u7518\u7279\u56FE\u89C6\u56FE\u4E2D\u663E\u793A\u8FDB\u5EA6\u6761",showProgressBarsInGanttDesc:"\u5728\u7518\u7279\u56FE\u6761\u5F62\u56FE\u4E0A\u663E\u793A\u8FDB\u5EA6\u6761\u53E0\u52A0\u5C42\uFF0C\u4EE5\u53EF\u89C6\u5316\u4E8B\u4EF6\u5B8C\u6210\u60C5\u51B5\u3002",defaultGanttDuration:"\u9ED8\u8BA4\u7518\u7279\u56FE\u6301\u7EED\u65F6\u95F4\uFF08\u5929\uFF09",defaultGanttDurationDesc:"\u5728\u7518\u7279\u56FE\u89C6\u56FE\u4E2D\u663E\u793A\u6CA1\u6709\u7ED3\u675F\u65E5\u671F\u7684\u4E8B\u4EF6\u7684\u9ED8\u8BA4\u6301\u7EED\u65F6\u95F4\uFF08\u5929\uFF09\u3002",dependencyArrowStyle:"\u4F9D\u8D56\u7BAD\u5934\u6837\u5F0F",dependencyArrowStyleDesc:"\u7518\u7279\u56FE\u89C6\u56FE\u4E2D\u4E8B\u4EF6\u4E4B\u95F4\u4F9D\u8D56\u7BAD\u5934\u7684\u89C6\u89C9\u6837\u5F0F\u3002",solid:"\u5B9E\u7EBF",dashed:"\u865A\u7EBF",dotted:"\u70B9\u7EBF",mapSettings:"\u5730\u56FE\u8BBE\u7F6E",enableFrontmatterMarkers:"\u542F\u7528\u524D\u7F6E\u5143\u6570\u636E\u6807\u8BB0",enableFrontmatterMarkersDesc:"\u4ECE\u5E26\u6709\u4F4D\u7F6E\u6216\u5730\u56FE\u6807\u8BB0\u7684\u524D\u7F6E\u5143\u6570\u636E\u7684\u7B14\u8BB0\u4E2D\u81EA\u52A8\u751F\u6210\u6807\u8BB0",enableDataViewMarkers:"\u542F\u7528\u6570\u636E\u89C6\u56FE\u6807\u8BB0",enableDataViewMarkersDesc:"\u4ECE\u6570\u636E\u89C6\u56FE\u67E5\u8BE2\u4E2D\u81EA\u52A8\u751F\u6210\u6807\u8BB0\uFF08\u9700\u8981\u6570\u636E\u89C6\u56FE\u63D2\u4EF6\uFF09",tutorialWelcome:"\u6B22\u8FCE\u4F7F\u7528 Storyteller Suite\uFF01",tutorialWelcomeDesc:"\u6B64\u63D2\u4EF6\u53EF\u5E2E\u52A9\u60A8\u7EC4\u7EC7\u548C\u7BA1\u7406\u6545\u4E8B\u7684\u6240\u6709\u65B9\u9762\u3002\u4EE5\u4E0B\u662F\u5982\u4F55\u5F00\u59CB\uFF1A",tutorialTip:"\u63D0\u793A\uFF1A\u70B9\u51FB\u4E0B\u9762\u7684\u4EFB\u4F55\u90E8\u5206\u4EE5\u5C55\u5F00\u8BE6\u7EC6\u8BF4\u660E\u548C\u793A\u4F8B\u3002",tutorialDashboardTitle:"\u4EEA\u8868\u677F\u548C\u529F\u80FD\u533A\u56FE\u6807",tutorialDashboardAccess:"\u8BBF\u95EE\u4EEA\u8868\u677F\uFF1A",tutorialDashboardRibbon:"\u70B9\u51FB\u5DE6\u4FA7\u529F\u80FD\u533A\uFF08\u4FA7\u8FB9\u680F\uFF09\u4E2D\u7684<strong>\u6253\u5F00\u4E66\u672C\u56FE\u6807</strong>",tutorialDashboardCommand:'\u4F7F\u7528\u547D\u4EE4\u9762\u677F\uFF1A<kbd>Ctrl/Cmd + P</kbd> \u2192 "Storyteller: \u6253\u5F00\u4EEA\u8868\u677F"',tutorialDashboardHub:"\u4EEA\u8868\u677F\u662F\u7BA1\u7406\u6240\u6709\u6545\u4E8B\u5143\u7D20\u7684\u4E2D\u5FC3\u67A2\u7EBD",tutorialStoryTitle:"\u6545\u4E8B\u7BA1\u7406",tutorialStoryCreating:"\u521B\u5EFA\u60A8\u7684\u7B2C\u4E00\u4E2A\u6545\u4E8B\uFF1A",tutorialStoryButton:'\u4F7F\u7528\u4E0B\u9762\u7684<strong>"\u521B\u5EFA\u65B0\u6545\u4E8B"</strong>\u6309\u94AE\uFF08\u542F\u7528<em>\u5355\u4E00\u6545\u4E8B\u6A21\u5F0F</em>\u65F6\u9690\u85CF\uFF09',tutorialStoryCommand:'\u6216\u4ECE\u547D\u4EE4\u9762\u677F\uFF1A"Storyteller: \u521B\u5EFA\u65B0\u6545\u4E8B"',tutorialStoryName:"\u4E3A\u60A8\u7684\u6545\u4E8B\u547D\u540D\u5E76\u6DFB\u52A0\u63CF\u8FF0",tutorialStoryDefault:"\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u63D2\u4EF6\u4F1A\u5728 <code>StorytellerSuite/Stories/\u60A8\u7684\u6545\u4E8B\u540D\u79F0/</code> \u521B\u5EFA\u6587\u4EF6\u5939",tutorialStoryManaging:"\u7BA1\u7406\u6545\u4E8B\uFF1A",tutorialStorySwitch:'\u4F7F\u7528<strong>"\u8BBE\u4E3A\u6D3B\u52A8"</strong>\u6309\u94AE\u5728\u6545\u4E8B\u4E4B\u95F4\u5207\u6362',tutorialStoryEdit:"\u4F7F\u7528\u94C5\u7B14\u56FE\u6807\u7F16\u8F91\u6545\u4E8B\u8BE6\u60C5",tutorialStoryDelete:"\u4F7F\u7528\u5783\u573E\u6876\u56FE\u6807\u5220\u9664\u6545\u4E8B\uFF08\u8FD9\u53EA\u4F1A\u4ECE\u63D2\u4EF6\u4E2D\u79FB\u9664\uFF0C\u4E0D\u4F1A\u5220\u9664\u60A8\u7684\u6587\u4EF6\uFF09",tutorialStoryActivation:'\u5373\u65F6\u6FC0\u6D3B\u63D0\u793A\uFF1A\u4ECE<em>\u8BBE\u7F6E</em>\u521B\u5EFA\u6545\u4E8B\u4F1A\u7ACB\u5373\u66F4\u65B0\u8BBE\u7F6E\u5217\u8868\uFF0C\u4F46\u4EEA\u8868\u677F\u7684\u6545\u4E8B\u4E0B\u62C9\u83DC\u5355\u53EF\u80FD\u4E0D\u4F1A\u5237\u65B0\uFF0C\u76F4\u5230\u60A8\u91CD\u65B0\u6253\u5F00\u4EEA\u8868\u677F\u3002\u8981\u7ACB\u5373\u6FC0\u6D3B\u548C\u5237\u65B0\u754C\u9762\uFF0C\u8BF7\u4F7F\u7528\u4EEA\u8868\u677F/\u547D\u4EE4\u9762\u677F\u64CD\u4F5C<em>"Storyteller: \u521B\u5EFA\u65B0\u6545\u4E8B"</em>\uFF0C\u6216\u901A\u8FC7<em>"Storyteller: \u6253\u5F00\u4EEA\u8868\u677F"</em>\u5173\u95ED/\u91CD\u65B0\u6253\u5F00\u4EEA\u8868\u677F\u3002',tutorialStoryOneMode:"\u5355\u4E00\u6545\u4E8B\u6A21\u5F0F\uFF1A\u5728\u8BBE\u7F6E\u4E2D\u542F\u7528\u65F6\uFF0C\u754C\u9762\u7B80\u5316\u4E3A\u5355\u4E00\u6545\u4E8B\u5E03\u5C40\uFF0C<em>\u65B0\u6545\u4E8B</em>\u6309\u94AE\u88AB\u9690\u85CF\u3002\u5185\u5BB9\u7EC4\u7EC7\u5728\u5355\u4E2A\u57FA\u7840\u6587\u4EF6\u5939\u4E0B\u3002",tutorialCharacterTitle:"\u89D2\u8272\u7BA1\u7406",tutorialCharacterCreating:"\u521B\u5EFA\u89D2\u8272\uFF1A",tutorialCharacterDashboard:'<strong>\u4EEA\u8868\u677F\uFF1A</strong>\u70B9\u51FB"\u521B\u5EFA\u89D2\u8272"\u6309\u94AE',tutorialCharacterCommand:'<strong>\u547D\u4EE4\u9762\u677F\uFF1A</strong>"Storyteller: \u521B\u5EFA\u65B0\u89D2\u8272"',tutorialCharacterDetails:"\u586B\u5199\u89D2\u8272\u8BE6\u60C5\u3001\u80CC\u666F\u6545\u4E8B\u3001\u5173\u7CFB",tutorialCharacterImages:"\u4ECE\u60A8\u7684\u5E93\u4E2D\u6DFB\u52A0\u4E2A\u4EBA\u8D44\u6599\u56FE\u7247",tutorialCharacterManaging:"\u7BA1\u7406\u89D2\u8272\uFF1A",tutorialCharacterView:'<strong>\u67E5\u770B\u5168\u90E8\uFF1A</strong>\u4EEA\u8868\u677F \u2192 "\u67E5\u770B\u89D2\u8272"\u6216\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u67E5\u770B\u89D2\u8272"',tutorialCharacterEdit:"<strong>\u7F16\u8F91\uFF1A</strong>\u70B9\u51FB\u4EEA\u8868\u677F\u6216\u89D2\u8272\u5217\u8868\u4E2D\u7684\u89D2\u8272\u540D\u79F0",tutorialCharacterDelete:"<strong>\u5220\u9664\uFF1A</strong>\u4F7F\u7528\u5783\u573E\u6876\u56FE\u6807\uFF08\u79FB\u52A8\u5230 Obsidian \u5783\u573E\u6876\uFF09",tutorialCharacterStorage:"\u89D2\u8272\u4EE5 markdown \u6587\u4EF6\u5F62\u5F0F\u5B58\u50A8\u5728 <code>Characters/</code> \u6587\u4EF6\u5939\u4E2D",tutorialLocationTitle:"\u5730\u70B9\u7BA1\u7406",tutorialLocationCreating:"\u521B\u5EFA\u5730\u70B9\uFF1A",tutorialLocationDashboard:'<strong>\u4EEA\u8868\u677F\uFF1A</strong>\u70B9\u51FB"\u521B\u5EFA\u5730\u70B9"\u6309\u94AE',tutorialLocationCommand:'<strong>\u547D\u4EE4\u9762\u677F\uFF1A</strong>"Storyteller: \u521B\u5EFA\u65B0\u5730\u70B9"',tutorialLocationDetails:"\u6DFB\u52A0\u63CF\u8FF0\u3001\u5386\u53F2\u3001\u533A\u57DF\u3001\u5730\u70B9\u7C7B\u578B",tutorialLocationLink:"\u94FE\u63A5\u5230\u76F8\u5173\u89D2\u8272\u548C\u4E8B\u4EF6",tutorialLocationManaging:"\u7BA1\u7406\u5730\u70B9\uFF1A",tutorialLocationView:'<strong>\u67E5\u770B\u5168\u90E8\uFF1A</strong>\u4EEA\u8868\u677F \u2192 "\u67E5\u770B\u5730\u70B9"\u6216\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u67E5\u770B\u5730\u70B9"',tutorialLocationStorage:"\u5730\u70B9\u4EE5 markdown \u6587\u4EF6\u5F62\u5F0F\u5B58\u50A8\u5728 <code>Locations/</code> \u6587\u4EF6\u5939\u4E2D",tutorialLocationEdit:"\u901A\u8FC7\u70B9\u51FB\u5730\u70B9\u540D\u79F0\u8FDB\u884C\u7F16\u8F91\uFF0C\u4F7F\u7528\u5783\u573E\u6876\u56FE\u6807\u5220\u9664",tutorialEventTitle:"\u4E8B\u4EF6\u548C\u65F6\u95F4\u7EBF\u7BA1\u7406",tutorialEventCreating:"\u521B\u5EFA\u4E8B\u4EF6\uFF1A",tutorialEventDashboard:'<strong>\u4EEA\u8868\u677F\uFF1A</strong>\u70B9\u51FB"\u521B\u5EFA\u4E8B\u4EF6"\u6309\u94AE',tutorialEventCommand:'<strong>\u547D\u4EE4\u9762\u677F\uFF1A</strong>"Storyteller: \u521B\u5EFA\u65B0\u4E8B\u4EF6"',tutorialEventDetails:"\u8BBE\u7F6E\u65E5\u671F/\u65F6\u95F4\uFF0C\u6DFB\u52A0\u63CF\u8FF0\u3001\u7ED3\u679C",tutorialEventLink:"\u94FE\u63A5\u5230\u6D89\u53CA\u7684\u89D2\u8272\u548C\u5730\u70B9",tutorialEventNew:"<strong>\u65B0\u529F\u80FD\uFF1A</strong>\u5C06\u4E8B\u4EF6\u6807\u8BB0\u4E3A\u91CC\u7A0B\u7891\uFF0C\u8BBE\u7F6E\u8FDB\u5EA6\uFF080-100%\uFF09\uFF0C\u6DFB\u52A0\u4F9D\u8D56\u9879",tutorialEventTimeline:"\u65F6\u95F4\u7EBF\u89C6\u56FE\uFF1A",tutorialEventTimelineDashboard:'<strong>\u4EEA\u8868\u677F\uFF1A</strong>\u70B9\u51FB"\u67E5\u770B\u65F6\u95F4\u7EBF"\u6309\u94AE',tutorialEventTimelineCommand:'<strong>\u547D\u4EE4\u9762\u677F\uFF1A</strong>"Storyteller: \u67E5\u770B\u65F6\u95F4\u7EBF"',tutorialEventTimelineSee:"\u6309\u65F6\u95F4\u987A\u5E8F\u67E5\u770B\u6240\u6709\u4E8B\u4EF6",tutorialEventStorage:"\u4E8B\u4EF6\u5B58\u50A8\u5728 <code>Events/</code> \u6587\u4EF6\u5939\u4E2D",tutorialGanttTitle:"\u7518\u7279\u56FE\u6837\u5F0F\u65F6\u95F4\u7EBF\u529F\u80FD",tutorialGanttEnhanced:"\u589E\u5F3A\u7684\u65F6\u95F4\u7EBF\u89C6\u56FE\uFF1A",tutorialGanttToggle:"<strong>\u5207\u6362\u89C6\u56FE\uFF1A</strong>\u4F7F\u7528\u5207\u6362\u6309\u94AE\u5728\u7ECF\u5178\u65F6\u95F4\u7EBF\u548C\u7518\u7279\u56FE\u89C6\u56FE\u4E4B\u95F4\u5207\u6362",tutorialGanttMilestones:"<strong>\u91CC\u7A0B\u7891\uFF1A</strong>\u5C06\u91CD\u8981\u4E8B\u4EF6\u6807\u8BB0\u4E3A\u91CC\u7A0B\u7891\uFF08\u91D1\u8272\u6837\u5F0F\uFF0C\u5E26\u661F\u5F62\u56FE\u6807\uFF09",tutorialGanttProgress:"<strong>\u8FDB\u5EA6\u8DDF\u8E2A\uFF1A</strong>\u5728\u4E8B\u4EF6\u4E0A\u8BBE\u7F6E\u5B8C\u6210\u767E\u5206\u6BD4\uFF080-100%\uFF09\uFF0C\u5E26\u53EF\u89C6\u5316\u8FDB\u5EA6\u6761",tutorialGanttDependencies:"<strong>\u4F9D\u8D56\u9879\uFF1A</strong>\u94FE\u63A5\u4E8B\u4EF6\u4EE5\u663E\u793A\u56E0\u679C\u5173\u7CFB\uFF0C\u7528\u7BAD\u5934\u8868\u793A",tutorialGanttDrag:"\u62D6\u653E\u91CD\u65B0\u5B89\u6392\uFF1A",tutorialGanttLock:"\u70B9\u51FB\u5DE5\u5177\u680F\u4E2D\u7684<strong>\u9501\u5B9A/\u94C5\u7B14\u56FE\u6807</strong>\u4EE5\u542F\u7528\u7F16\u8F91\u6A21\u5F0F",tutorialGanttDragEvents:"\u5C06\u4E8B\u4EF6\u62D6\u5230\u65B0\u65E5\u671F - \u66F4\u6539\u81EA\u52A8\u4FDD\u5B58",tutorialGanttDisable:"\u518D\u6B21\u70B9\u51FB\u56FE\u6807\u4EE5\u7981\u7528\u7F16\u8F91\u5E76\u9501\u5B9A\u65F6\u95F4\u7EBF",tutorialGanttFiltering:"\u7B5B\u9009\u548C\u5206\u7EC4\uFF1A",tutorialGanttFilterPanel:'<strong>\u7B5B\u9009\u9762\u677F\uFF1A</strong>\u70B9\u51FB"\u7B5B\u9009"\u4EE5\u6253\u5F00\u53EF\u6298\u53E0\u7684\u7B5B\u9009\u9762\u677F',tutorialGanttFilterBy:"<strong>\u6309\u4EE5\u4E0B\u65B9\u5F0F\u7B5B\u9009\uFF1A</strong>\u89D2\u8272\u3001\u5730\u70B9\u3001\u7EC4\u6216\u4EC5\u91CC\u7A0B\u7891",tutorialGanttFilterChips:'<strong>\u7B5B\u9009\u6807\u7B7E\uFF1A</strong>\u70B9\u51FB\u6807\u7B7E\u4EE5\u5220\u9664\u5355\u4E2A\u7B5B\u9009\u5668\uFF0C\u6216"\u5168\u90E8\u6E05\u9664"',tutorialGanttSwimlanes:"<strong>\u6CF3\u9053\uFF1A</strong>\u6309\u5730\u70B9\u3001\u7EC4\u6216\u89D2\u8272\u5BF9\u4E8B\u4EF6\u8FDB\u884C\u5206\u7EC4",tutorialPlotTitle:"\u60C5\u8282\u7269\u54C1\u7BA1\u7406",tutorialPlotManaging:"\u7BA1\u7406\u91CD\u8981\u7269\u54C1\uFF1A",tutorialPlotCreate:'<strong>\u521B\u5EFA\uFF1A</strong>\u4EEA\u8868\u677F \u2192 "\u521B\u5EFA\u60C5\u8282\u7269\u54C1"\u6216\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u521B\u5EFA\u65B0\u60C5\u8282\u7269\u54C1"',tutorialPlotCritical:'<strong>\u6807\u8BB0\u4E3A\u5173\u952E\uFF1A</strong>\u5BF9\u5173\u952E\u6545\u4E8B\u7269\u54C1\u4F7F\u7528"\u60C5\u8282\u5173\u952E"\u590D\u9009\u6846',tutorialPlotOwnership:"<strong>\u8DDF\u8E2A\u6240\u6709\u6743\uFF1A</strong>\u94FE\u63A5\u5F53\u524D\u6240\u6709\u8005\u3001\u524D\u6240\u6709\u8005\u548C\u5730\u70B9",tutorialPlotView:'<strong>\u67E5\u770B\u5168\u90E8\uFF1A</strong>\u4EEA\u8868\u677F \u2192 "\u67E5\u770B\u60C5\u8282\u7269\u54C1"\u6216\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u67E5\u770B\u60C5\u8282\u7269\u54C1"',tutorialPlotStorage:"\u7269\u54C1\u5B58\u50A8\u5728 <code>Items/</code> \u6587\u4EF6\u5939\u4E2D",tutorialGalleryTitle:"\u56FE\u5E93\u7BA1\u7406",tutorialGalleryOrganization:"\u56FE\u7247\u7EC4\u7EC7\uFF1A",tutorialGalleryAccess:'<strong>\u8BBF\u95EE\uFF1A</strong>\u4EEA\u8868\u677F \u2192 "\u56FE\u5E93"\u6309\u94AE\u6216\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u6253\u5F00\u56FE\u5E93"',tutorialGalleryUpload:"<strong>\u4E0A\u4F20\uFF1A</strong>\u76F4\u63A5\u5C06\u56FE\u7247\u62D6\u653E\u5230\u56FE\u5E93\u4E2D",tutorialGalleryOrganize:"<strong>\u7EC4\u7EC7\uFF1A</strong>\u4E3A\u56FE\u7247\u6DFB\u52A0\u6807\u7B7E\u3001\u7C7B\u522B\u3001\u63CF\u8FF0",tutorialGalleryLink:"<strong>\u94FE\u63A5\uFF1A</strong>\u8F7B\u677E\u5728\u56FE\u5E93\u4E2D\u5F15\u7528\u89D2\u8272/\u5730\u70B9\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u56FE\u7247",tutorialGalleryConfig:"\u5728\u4E0B\u9762\u914D\u7F6E\u4E0A\u4F20\u6587\u4EF6\u5939\uFF08\u9ED8\u8BA4\uFF1A<code>StorytellerSuite/GalleryUploads</code>\uFF09",tutorialGroupsTitle:"\u7EC4\u548C\u7EC4\u7EC7",tutorialGroupsOrganizing:"\u4F7F\u7528\u7EC4\u8FDB\u884C\u7EC4\u7EC7\uFF1A",tutorialGroupsCreate:'<strong>\u521B\u5EFA\u7EC4\uFF1A</strong>\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u521B\u5EFA\u7EC4"',tutorialGroupsAdd:"<strong>\u6DFB\u52A0\u6210\u5458\uFF1A</strong>\u89D2\u8272\u3001\u5730\u70B9\u3001\u4E8B\u4EF6\u548C\u7269\u54C1\u53EF\u4EE5\u5206\u7EC4",tutorialGroupsManage:'<strong>\u7BA1\u7406\uFF1A</strong>\u4F7F\u7528"Storyteller: \u91CD\u547D\u540D\u7EC4"\u91CD\u547D\u540D\uFF0C\u4F7F\u7528"Storyteller: \u5220\u9664\u7EC4"\u5220\u9664',tutorialGroupsUseCases:"<strong>\u7528\u4F8B\uFF1A</strong>\u7687\u5BA4\u5BB6\u65CF\u3001\u7279\u5B9A\u738B\u56FD\u3001\u60C5\u8282\u5F27\u7EBF\u7B49",tutorialWorldTitle:"\u4E16\u754C\u6784\u5EFA\u5B9E\u4F53",tutorialWorldFive:"\u7528\u4E8E\u5B8C\u6574\u4E16\u754C\u6784\u5EFA\u7684\u4E94\u79CD\u5B9E\u4F53\u7C7B\u578B\uFF1A",tutorialWorldCultures:"<strong>\u6587\u5316\uFF1A</strong>\u6280\u672F\u6C34\u5E73\u3001\u653F\u5E9C\u7C7B\u578B\u3001\u8BED\u8A00\u3001\u4EF7\u503C\u89C2\u3001\u4E60\u4FD7\u3001\u793E\u4F1A\u7ED3\u6784",tutorialWorldFactions:"<strong>\u6D3E\u7CFB\uFF1A</strong>\u5177\u6709\u7C7B\u578B\u3001\u6743\u529B\u7EA7\u522B\u3001\u989C\u8272\u3001\u5EA7\u53F3\u94ED\u3001\u76EE\u6807\u3001\u8D44\u6E90\u7684\u7EC4\u7EC7",tutorialWorldEconomies:"<strong>\u7ECF\u6D4E\uFF1A</strong>\u7CFB\u7EDF\u7C7B\u578B\uFF08\u6613\u8D27\u3001\u5E02\u573A\u3001\u5C01\u5EFA\uFF09\u3001\u4EA7\u4E1A\u3001\u8D38\u6613\u653F\u7B56",tutorialWorldMagic:"<strong>\u9B54\u6CD5\u7CFB\u7EDF\uFF1A</strong>\u7C7B\u578B\uFF08\u5965\u672F\u3001\u795E\u5723\u3001\u81EA\u7136\uFF09\u3001\u7A00\u6709\u5EA6\u3001\u529B\u91CF\u7EA7\u522B\u3001\u89C4\u5219\u3001\u6210\u672C",tutorialWorldCalendars:"<strong>\u65E5\u5386\uFF1A</strong>\u65E5\u5386\u7C7B\u578B\uFF08\u592A\u9633\u3001\u6708\u4EAE\uFF09\u3001\u5929\u6570\u914D\u7F6E\u3001\u5DE5\u4F5C\u65E5",tutorialWorldCreating:"\u521B\u5EFA\u4E16\u754C\u6784\u5EFA\u5B9E\u4F53\uFF1A",tutorialWorldCommand:'<strong>\u547D\u4EE4\u9762\u677F\uFF1A</strong>"Storyteller: \u521B\u5EFA\u65B0\u6587\u5316/\u6D3E\u7CFB/\u7ECF\u6D4E/\u9B54\u6CD5\u7CFB\u7EDF/\u65E5\u5386"',tutorialWorldView:'<strong>\u67E5\u770B\u5168\u90E8\uFF1A</strong>"Storyteller: \u67E5\u770B\u6587\u5316/\u6D3E\u7CFB/\u7ECF\u6D4E/\u9B54\u6CD5\u7CFB\u7EDF/\u65E5\u5386"',tutorialWorldModals:"\u6BCF\u4E2A\u5B9E\u4F53\u90FD\u6709\u5E26\u6709\u76F8\u5173\u5B57\u6BB5\u7684\u4E13\u7528\u6A21\u6001\u7A97\u53E3",tutorialWorldStorage:"\u5B9E\u4F53\u5B58\u50A8\u5728\u5176\u5404\u81EA\u7684\u6587\u4EF6\u5939\u4E2D\uFF08\u4F8B\u5982 <code>Cultures/</code>\u3001<code>Factions/</code>\uFF09",tutorialTimelineTitle:"\u65F6\u95F4\u7EBF\u5206\u652F\u548C\u56E0\u679C\u5173\u7CFB",tutorialTimelineAlternate:"\u66FF\u4EE3\u65F6\u95F4\u7EBF\uFF08\u5047\u8BBE\u573A\u666F\uFF09\uFF1A",tutorialTimelineCreateFork:'<strong>\u521B\u5EFA\u5206\u652F\uFF1A</strong>\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u521B\u5EFA\u65F6\u95F4\u7EBF\u5206\u652F"',tutorialTimelineDivergence:"<strong>\u5206\u6B67\u70B9\uFF1A</strong>\u9009\u62E9\u65F6\u95F4\u7EBF\u5206\u88C2\u7684\u4E8B\u4EF6",tutorialTimelineForkStatus:"<strong>\u5206\u652F\u72B6\u6001\uFF1A</strong>\u8DDF\u8E2A\u4E3A\u63A2\u7D22\u3001\u6B63\u5178\u3001\u5DF2\u653E\u5F03\u6216\u5DF2\u5408\u5E76",tutorialTimelineViewForks:"<strong>\u67E5\u770B\u5206\u652F\uFF1A</strong>\u5728\u65F6\u95F4\u7EBF\u89C6\u56FE\u4E2D\u4F7F\u7528\u5206\u652F\u9009\u62E9\u4E0B\u62C9\u83DC\u5355",tutorialTimelineCausality:"\u56E0\u679C\u5173\u7CFB\u94FE\u63A5\uFF08\u539F\u56E0\u548C\u7ED3\u679C\uFF09\uFF1A",tutorialTimelineAddLink:'<strong>\u6DFB\u52A0\u94FE\u63A5\uFF1A</strong>\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u6DFB\u52A0\u56E0\u679C\u5173\u7CFB\u94FE\u63A5"',tutorialTimelineLinkTypes:"<strong>\u94FE\u63A5\u7C7B\u578B\uFF1A</strong>\u76F4\u63A5\u3001\u95F4\u63A5\u3001\u6761\u4EF6\u6216\u50AC\u5316\u5242",tutorialTimelineStrength:"<strong>\u5F3A\u5EA6\u7EA7\u522B\uFF1A</strong>\u5F31\u3001\u4E2D\u7B49\u3001\u5F3A\u6216\u7EDD\u5BF9",tutorialTimelineLinksHelp:"\u94FE\u63A5\u6709\u52A9\u4E8E\u8DDF\u8E2A\u4E8B\u4EF6\u5982\u4F55\u76F8\u4E92\u5F71\u54CD",tutorialTimelineConflict:"\u51B2\u7A81\u68C0\u6D4B\uFF1A",tutorialTimelineRunDetection:'<strong>\u8FD0\u884C\u68C0\u6D4B\uFF1A</strong>\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u68C0\u6D4B\u65F6\u95F4\u7EBF\u51B2\u7A81"',tutorialTimelineDetects:"<strong>\u68C0\u6D4B\uFF1A</strong>\u5730\u70B9\u51B2\u7A81\uFF08\u89D2\u8272\u5728\u591A\u4E2A\u5730\u65B9\uFF09\u3001\u6B7B\u4EA1\u51B2\u7A81\uFF08\u5DF2\u6B7B\u4EA1\u89D2\u8272\u540E\u6765\u51FA\u73B0\uFF09\u3001\u56E0\u679C\u5173\u7CFB\u8FDD\u53CD\uFF08\u539F\u56E0\u4E4B\u524D\u7684\u7ED3\u679C\uFF09",tutorialTimelineBadge:"<strong>\u51B2\u7A81\u5FBD\u7AE0\uFF1A</strong>\u5728\u65F6\u95F4\u7EBF\u5DE5\u5177\u680F\u4E2D\u663E\u793A\u8BA1\u6570 - \u70B9\u51FB\u4EE5\u67E5\u770B",tutorialTimelineActionable:"<strong>\u53EF\u64CD\u4F5C\uFF1A</strong>\u6BCF\u4E2A\u51B2\u7A81\u90FD\u5305\u542B\u89E3\u51B3\u5EFA\u8BAE",tutorialTemplatesTitle:"\u5B9E\u4F53\u6A21\u677F",tutorialTemplatesCreate:"\u521B\u5EFA\u53EF\u91CD\u7528\u6A21\u677F\uFF1A",tutorialTemplatesSave:"<strong>\u53E6\u5B58\u4E3A\u6A21\u677F\uFF1A</strong>\u7F16\u8F91\u4EFB\u4F55\u5B9E\u4F53\u65F6\uFF0C\u5C06\u5176\u53E6\u5B58\u4E3A\u53EF\u91CD\u7528\u6A21\u677F",tutorialTemplatesLibrary:'<strong>\u6A21\u677F\u5E93\uFF1A</strong>\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u6253\u5F00\u5B9E\u4F53\u6A21\u677F\u5E93"',tutorialTemplatesDashboard:"<strong>\u4EEA\u8868\u677F\u6807\u7B7E\uFF1A</strong>\u4ECE\u4EEA\u8868\u677F\u4E2D\u7684\u6A21\u677F\u6807\u7B7E\u8BBF\u95EE\u6A21\u677F",tutorialTemplatesBuiltIn:"\u5185\u7F6E\u6A21\u677F\uFF1A",tutorialTemplatesArchetypes:"\u89D2\u8272\u539F\u578B\uFF1A\u4E2D\u4E16\u7EAA\u56FD\u738B\u3001\u9152\u9986\u8001\u677F\u3001\u667A\u6167\u5BFC\u5E08\u3001\u8D5B\u535A\u670B\u514B\u9ED1\u5BA2\u3001\u4FA6\u63A2",tutorialTemplatesMore:"\u66F4\u591A\u6A21\u677F\u53EF\u7528\u4E8E\u5FEB\u901F\u521B\u5EFA\u89D2\u8272",tutorialTemplatesFeatures:"\u6A21\u677F\u529F\u80FD\uFF1A",tutorialTemplatesBrowse:"<strong>\u6D4F\u89C8\uFF1A</strong>\u6309\u7C7B\u578B\u3001\u7C7B\u522B\u3001\u5B9E\u4F53\u7C7B\u578B\u641C\u7D22\u548C\u7B5B\u9009\u6A21\u677F",tutorialTemplatesSort:"<strong>\u6392\u5E8F\uFF1A</strong>\u6309\u540D\u79F0\u3001\u4F7F\u7528\u6B21\u6570\u6216\u6700\u8FD1\u4F7F\u7528",tutorialTemplatesUsage:"<strong>\u4F7F\u7528\u8DDF\u8E2A\uFF1A</strong>\u67E5\u770B\u60A8\u6700\u5E38\u4F7F\u7528\u7684\u6A21\u677F",tutorialTemplatesCustomize:"<strong>\u81EA\u5B9A\u4E49\uFF1A</strong>\u590D\u5236\u5E76\u4FEE\u6539\u6A21\u677F\u4EE5\u6EE1\u8DB3\u60A8\u7684\u9700\u6C42",tutorialDiscoveryTitle:"\u6545\u4E8B\u53D1\u73B0\u548C\u5BFC\u5165",tutorialDiscoveryAutomatic:"\u81EA\u52A8\u53D1\u73B0\uFF1A",tutorialDiscoveryDetects:"\u63D2\u4EF6\u81EA\u52A8\u68C0\u6D4B\u73B0\u6709\u7684 <code>StorytellerSuite/Stories/</code> \u6587\u4EF6\u5939",tutorialDiscoveryManual:'<strong>\u624B\u52A8\u5237\u65B0\uFF1A</strong>\u547D\u4EE4\u9762\u677F \u2192 "Storyteller: \u5237\u65B0\u6545\u4E8B\u53D1\u73B0"',tutorialDiscoveryImport:"\u5BFC\u5165\u73B0\u6709\u6545\u4E8B\u6587\u4EF6\u5939\u800C\u4E0D\u4E22\u5931\u6570\u636E",tutorialDiscoveryUseful:"\u5728\u5E93\u4E4B\u95F4\u79FB\u52A8\u6545\u4E8B\u65F6\u5F88\u6709\u7528",tutorialCustomTitle:"\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939\uFF1A\u63A8\u8350\u7684\u624B\u52A8\u5DE5\u4F5C\u6D41\u7A0B",tutorialCustomSimple:"\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939\u7684\u7B80\u5355\u53EF\u9760\u8BBE\u7F6E\uFF1A",tutorialCustomStep1:"<strong>\u5728\u60A8\u7684\u5E93\u4E2D\u624B\u52A8\u521B\u5EFA\u6545\u4E8B\u6587\u4EF6\u5939\u548C\u5B50\u6587\u4EF6\u5939</strong>\uFF08\u4F8B\u5982 <code>Creative/Writing/\u6211\u7684\u6545\u4E8B/Characters</code>\u3001<code>Locations</code>\u3001<code>Events</code> \u7B49\uFF09\u3002",tutorialCustomStep2:"\u5728\u8BBE\u7F6E \u2192 Storyteller Suite \u2192 \u542F\u7528<strong>\u4F7F\u7528\u81EA\u5B9A\u4E49\u5B9E\u4F53\u6587\u4EF6\u5939</strong>\u3002\u53EF\u9009\u5730\u8BBE\u7F6E<strong>\u6545\u4E8B\u6839\u6587\u4EF6\u5939</strong>\u6A21\u677F\u4EE5\u4FBF\u4F7F\u7528\u3002",tutorialCustomStep3:'\u6253\u5F00\u4EEA\u8868\u677F\u5E76\u4F7F\u7528<strong>"\u521B\u5EFA\u65B0\u6545\u4E8B"</strong>\u3002\u521B\u5EFA\u540E\uFF0C<strong>\u5237\u65B0/\u6FC0\u6D3B</strong>\u4EEA\u8868\u677F\u3002\u63D2\u4EF6\u5C06\u8BC6\u522B\u60A8\u7684\u624B\u52A8\u6545\u4E8B\u6587\u4EF6\u5939\u4E3A\u6D3B\u52A8\u6545\u4E8B\u3002',tutorialCustomStep4:"\u5728\u8BBE\u7F6E\u4E2D\u4F7F\u7528<strong>\u9884\u89C8\u5DF2\u89E3\u6790\u6587\u4EF6\u5939</strong>\u4EE5\u786E\u8BA4\u63D2\u4EF6\u5C06\u4F7F\u7528\u7684\u786E\u5207\u8DEF\u5F84\u3002",tutorialCustomSwitching:"\u5728\u81EA\u5B9A\u4E49\u6587\u4EF6\u5939\u6A21\u5F0F\u4E0B\u5207\u6362\u6545\u4E8B\uFF1A\u4F7F\u7528<em>\u4EEA\u8868\u677F\u9876\u90E8\u7684\u6545\u4E8B\u4E0B\u62C9\u83DC\u5355</em>\u66F4\u6539\u6D3B\u52A8\u6545\u4E8B\u3002\u7136\u540E\u8F6C\u5230<em>\u8BBE\u7F6E \u2192 Storyteller Suite</em>\u5E76<strong>\u624B\u52A8\u4E3A\u8BE5\u6545\u4E8B\u5206\u914D\u6BCF\u4E2A\u5B9E\u4F53\u6587\u4EF6\u5939</strong>\u3002\u62B1\u6B49\uFF0C\u6211\u77E5\u9053\u8FD9\u6709\u70B9\u9EBB\u70E6\u3002",tutorialShortcutsTitle:"\u952E\u76D8\u5FEB\u6377\u952E\u548C\u547D\u4EE4",tutorialShortcutsCore:"\u6838\u5FC3\u547D\u4EE4\uFF08\u901A\u8FC7 Ctrl/Cmd + P\uFF09\uFF1A",tutorialShortcutsOpen:"<strong>Storyteller: \u6253\u5F00\u4EEA\u8868\u677F</strong> - \u4E3B\u754C\u9762",tutorialShortcutsNewStory:"<strong>Storyteller: \u521B\u5EFA\u65B0\u6545\u4E8B</strong> - \u5F00\u59CB\u65B0\u7684\u6545\u4E8B\u9879\u76EE",tutorialShortcutsCreate:"<strong>Storyteller: \u521B\u5EFA\u65B0\u89D2\u8272/\u5730\u70B9/\u4E8B\u4EF6/\u60C5\u8282\u7269\u54C1</strong>",tutorialShortcutsView:"<strong>Storyteller: \u67E5\u770B\u89D2\u8272/\u5730\u70B9/\u65F6\u95F4\u7EBF/\u60C5\u8282\u7269\u54C1</strong>",tutorialShortcutsGallery:"<strong>Storyteller: \u6253\u5F00\u56FE\u5E93</strong> - \u56FE\u7247\u7BA1\u7406",tutorialShortcutsGroup:"<strong>Storyteller: \u521B\u5EFA/\u91CD\u547D\u540D/\u5220\u9664\u7EC4</strong> - \u7EC4\u7EC7",tutorialShortcutsRefresh:"<strong>Storyteller: \u5237\u65B0\u6545\u4E8B\u53D1\u73B0</strong> - \u5BFC\u5165\u73B0\u6709\u6587\u4EF6\u5939",tutorialShortcutsWorld:"\u4E16\u754C\u6784\u5EFA\u547D\u4EE4\uFF1A",tutorialShortcutsWorldCreate:"<strong>Storyteller: \u521B\u5EFA\u65B0\u6587\u5316/\u6D3E\u7CFB/\u7ECF\u6D4E/\u9B54\u6CD5\u7CFB\u7EDF/\u65E5\u5386</strong>",tutorialShortcutsWorldView:"<strong>Storyteller: \u67E5\u770B\u6587\u5316/\u6D3E\u7CFB/\u7ECF\u6D4E/\u9B54\u6CD5\u7CFB\u7EDF/\u65E5\u5386</strong>",tutorialShortcutsTimeline:"\u65F6\u95F4\u7EBF\u548C\u56E0\u679C\u5173\u7CFB\u547D\u4EE4\uFF1A",tutorialShortcutsTimelineFork:"<strong>Storyteller: \u521B\u5EFA\u65F6\u95F4\u7EBF\u5206\u652F</strong> - \u521B\u5EFA\u66FF\u4EE3\u65F6\u95F4\u7EBF",tutorialShortcutsTimelineViewForks:"<strong>Storyteller: \u67E5\u770B\u65F6\u95F4\u7EBF\u5206\u652F</strong> - \u5217\u51FA\u6240\u6709\u5206\u652F",tutorialShortcutsTimelineLink:"<strong>Storyteller: \u6DFB\u52A0\u56E0\u679C\u5173\u7CFB\u94FE\u63A5</strong> - \u94FE\u63A5\u539F\u56E0\u548C\u7ED3\u679C\u4E8B\u4EF6",tutorialShortcutsTimelineViewLinks:"<strong>Storyteller: \u67E5\u770B\u56E0\u679C\u5173\u7CFB\u94FE\u63A5</strong> - \u5217\u51FA\u6240\u6709\u56E0\u679C\u5173\u7CFB",tutorialShortcutsTimelineDetect:"<strong>Storyteller: \u68C0\u6D4B\u65F6\u95F4\u7EBF\u51B2\u7A81</strong> - \u67E5\u627E\u4E0D\u4E00\u81F4",tutorialShortcutsTimelineViewConflicts:"<strong>Storyteller: \u67E5\u770B\u65F6\u95F4\u7EBF\u51B2\u7A81</strong> - \u67E5\u770B\u73B0\u6709\u51B2\u7A81",tutorialShortcutsTemplate:"\u6A21\u677F\u547D\u4EE4\uFF1A",tutorialShortcutsTemplateLibrary:"<strong>Storyteller: \u6253\u5F00\u5B9E\u4F53\u6A21\u677F\u5E93</strong> - \u6D4F\u89C8\u548C\u7BA1\u7406\u6A21\u677F",tutorialShortcutsTip:"\u63D0\u793A\uFF1A\u60A8\u53EF\u4EE5\u5728 Obsidian \u7684\u5FEB\u6377\u952E\u8BBE\u7F6E\u4E2D\u4E3A\u8FD9\u4E9B\u547D\u4EE4\u4E2D\u7684\u4EFB\u4F55\u4E00\u4E2A\u5206\u914D\u81EA\u5B9A\u4E49\u5FEB\u6377\u952E\uFF01",tutorialFileTitle:"\u6587\u4EF6\u7ED3\u6784\u548C\u96C6\u6210",tutorialFileOrganized:"\u60A8\u7684\u6587\u4EF6\u7EC4\u7EC7\u65B9\u5F0F\uFF1A",tutorialFileDefault:"\u9ED8\u8BA4\uFF08\u591A\u6545\u4E8B\uFF09\uFF1A",tutorialFileOneMode:"\u5355\u4E00\u6545\u4E8B\u6A21\u5F0F\uFF08\u6241\u5E73\u5316\uFF09\uFF1A",tutorialFileIntegration:"Obsidian \u96C6\u6210\uFF1A",tutorialFileMarkdown:"\u6240\u6709\u6570\u636E\u5B58\u50A8\u4E3A\u5E26\u6709\u524D\u7F6E\u5143\u6570\u636E\u7684<strong>markdown \u6587\u4EF6</strong>",tutorialFileDataview:"\u4E0E<strong>Dataview \u63D2\u4EF6</strong>\u5B8C\u5168\u517C\u5BB9\uFF0C\u7528\u4E8E\u81EA\u5B9A\u4E49\u67E5\u8BE2",tutorialFileWikiLinks:"\u4F7F\u7528<strong>[[wiki \u94FE\u63A5]]</strong>\u8FDE\u63A5\u89D2\u8272\u3001\u5730\u70B9\u3001\u4E8B\u4EF6",tutorialFileReadable:"\u5373\u4F7F\u6CA1\u6709\u63D2\u4EF6\uFF0C\u6587\u4EF6\u4E5F\u662F<strong>\u53EF\u8BFB\u548C\u53EF\u7F16\u8F91\u7684</strong>",tutorialFileBackup:"<strong>\u5907\u4EFD\u5B89\u5168\uFF1A</strong>\u60A8\u7684\u6570\u636E\u6C38\u8FDC\u4E0D\u4F1A\u88AB\u9501\u5B9A\u5728\u4E13\u6709\u683C\u5F0F\u4E2D",tutorialFileTip:"\u63D0\u793A\uFF1A\u5728\u8BBE\u7F6E \u2192 Storyteller Suite \u4E0B\u7684<em>\u4F7F\u7528\u81EA\u5B9A\u4E49\u5B9E\u4F53\u6587\u4EF6\u5939</em>\u548C<em>\u5355\u4E00\u6545\u4E8B\u6A21\u5F0F</em>\u4E2D\u914D\u7F6E\u8FD9\u4E9B\u6A21\u5F0F\u3002\u5728\u5355\u4E00\u6545\u4E8B\u6A21\u5F0F\u4E0B\uFF0C<em>\u65B0\u6545\u4E8B</em>\u6309\u94AE\u4F1A\u81EA\u52A8\u9690\u85CF\u3002"}});var PI,DI=_e(()=>{PI={dashboardTitle:"Suite de narrador",openDashboard:"Abrir panel de control",createNew:"Crear nuevo",uploadImage:"Subir imagen",image:"Imagen",storyCreated:'Historia "{0}" creada y activada.',created:'{0} "{1}" creado.',updated:'{0} "{1}" actualizado.',movedToTrash:'{0} "{1}" movido a la papelera.',imageUploaded:"Imagen subida: {0}",errorUploadingImage:"Error al subir la imagen. Por favor, int\xE9ntalo de nuevo.",noteCreatedWithSections:"Nota creada con secciones est\xE1ndar para facilitar la edici\xF3n.",workspaceLeafCreateError:"Error al abrir el panel de control: No se pudo crear la hoja del espacio de trabajo.",workspaceLeafRevealError:"Error al mostrar el panel de control: No se encontr\xF3 la hoja del espacio de trabajo.",errorCannotDeleteWithoutFilePath:"Error: No se puede eliminar {0} sin la ruta del archivo.",errorCannotOpenNoteWithoutFilePath:"Error: No se puede abrir la nota {0} sin la ruta del archivo.",remoteImagesBlocked:"Las im\xE1genes remotas est\xE1n bloqueadas por la configuraci\xF3n. Importa la imagen a tu galer\xEDa para usarla de forma segura.",importImage:"Importar imagen",language:"Idioma",selectLanguage:"Seleccionar idioma",english:"Ingl\xE9s",chinese:"Chino (\u4E2D\u6587)",languageChanged:"Idioma cambiado. Recarga el complemento para que surta efecto completo.",name:"Nombre",description:"Descripci\xF3n",backstory:"Historia de fondo",history:"Historia",location:"Ubicaci\xF3n",character:"Personaje",event:"Evento",item:"Objeto",reference:"Referencia",chapter:"Cap\xEDtulo",scene:"Escena",group:"Grupo",characters:"Personajes",locations:"Ubicaciones",events:"Eventos",items:"Objetos",references:"Referencias",chapters:"Cap\xEDtulos",scenes:"Escenas",groups:"Grupos",gallery:"Galer\xEDa",timeline:"L\xEDnea de tiempo",create:"Crear",edit:"Editar",delete:"Eliminar",save:"Guardar",cancel:"Cancelar",view:"Ver",upload:"Subir",import:"Importar",export:"Exportar",refresh:"Actualizar",createNewCharacter:"Crear nuevo personaje",editCharacter:"Editar personaje",createNewLocation:"Crear nueva ubicaci\xF3n",editLocation:"Editar ubicaci\xF3n",createNewEvent:"Crear nuevo evento",editEvent:"Editar evento",createNewItem:"Crear nuevo objeto",editItem:"Editar objeto",createNewReference:"Crear nueva referencia",editReference:"Editar referencia",createNewChapter:"Crear nuevo cap\xEDtulo",editChapter:"Editar cap\xEDtulo",createNewScene:"Crear nueva escena",editScene:"Editar escena",createNewGroup:"Crear nuevo grupo",editGroup:"Editar grupo",tags:"Etiquetas",summary:"Resumen",content:"Contenido",number:"N\xFAmero",orderingNumber:"N\xFAmero de orden (opcional)",category:"Categor\xEDa",createCharacter:"Crear personaje",createLocation:"Crear ubicaci\xF3n",createEvent:"Crear evento",createItem:"Crear objeto",createReference:"Crear referencia",createChapter:"Crear cap\xEDtulo",createScene:"Crear escena",createGroup:"Crear grupo",saveChanges:"Guardar cambios",deleteCharacter:"Eliminar personaje",deleteLocation:"Eliminar ubicaci\xF3n",deleteEvent:"Eliminar evento",deleteItem:"Eliminar objeto",deleteReference:"Eliminar referencia",deleteChapter:"Eliminar cap\xEDtulo",deleteScene:"Eliminar escena",deleteGroup:"Eliminar grupo",add:"A\xF1adir",clear:"Limpiar",ok:"OK",confirm:"Confirmar",selectBtn:"Seleccionar",previewBtn:"Vista previa",editBtn:"Editar",openNoteBtn:"Abrir nota",flattenCustomFields:"Aplanar a claves nativas (recomendado)",nestedCustomFields:"Anidado bajo customFields (mapa YAML)",noGrouping:"Sin agrupaci\xF3n",byLocation:"Por ubicaci\xF3n",byGroup:"Por grupo",noneOption:"Ninguno",fitOption:"Ajustar",decadeOption:"D\xE9cada",centuryOption:"Siglo",customFoldersPlaceholderWarning:'Las carpetas personalizadas usan marcadores {story*}. Selecciona o crea una historia activa, luego haz clic en "Reescanear carpetas personalizadas".',openNote:"Abrir nota",createGroupBtn:"Crear grupo",createChapterBtn:"Crear cap\xEDtulo",createSceneBtn:"Crear escena",createReferenceBtn:"Crear referencia",viewCharacters:"Ver personajes",viewLocations:"Ver ubicaciones",viewEvents:"Ver eventos",viewItems:"Ver objetos",viewReferences:"Ver referencias",viewChapters:"Ver cap\xEDtulos",viewScenes:"Ver escenas",viewGroups:"Ver grupos",viewTimeline:"Ver l\xEDnea de tiempo",openTimelinePanel:"Abrir panel de l\xEDnea de tiempo",viewGallery:"Ver galer\xEDa",selectOrCreateStoryFirst:"Selecciona o crea una historia primero.",selectGroupPlaceholder:"-- Seleccionar grupo --",affiliation:"Afiliaci\xF3n",groupsHelpCharacter:"Asigna este personaje a uno o m\xE1s grupos.",members:"Miembros",noCustomFields:"No hay campos personalizados definidos.",selectFromGallery:"Seleccionar de la galer\xEDa",clearImage:"Limpiar imagen",addImage:"A\xF1adir imagen",imageGallery:"Galer\xEDa de im\xE1genes",filter:"Filtrar",search:"Buscar",storyName:"Nombre de la historia",createNewStory:"Crear nueva historia",plotItems:"Elementos de la trama",title:"T\xEDtulo",caption:"Leyenda",fit:"Ajustar",decade:"D\xE9cada",century:"Siglo",today:"Hoy",copyRange:"Copiar rango",stackItems:"Apilar elementos",goToChapter:"Ir al cap\xEDtulo",unassigned:"Sin asignar",chapterTitlePh:"T\xEDtulo del cap\xEDtulo",sceneTitlePh:"T\xEDtulo de la escena",numberEg:"p. ej., 1",tagsPh:"etiqueta1, etiqueta2",briefChapterSummaryPh:"Resumen breve de este cap\xEDtulo...",writeYourScenePh:"Escribe tu escena...",beatSheet:"Hoja de ritmo (uno por l\xEDnea)",beatSheetExample:"- Conocer al mentor\\n- La negativa",stories:"Historias",active:"Activo",setActive:"Establecer como activo",editStory:"Editar historia",storyDiscovery:"Descubrimiento de historias",refreshDiscovery:"Actualizar descubrimiento",galleryUploadFolder:"Carpeta de subida de galer\xEDa",timelineAndParsing:"L\xEDnea de tiempo y an\xE1lisis",customFieldsSerialization:"Serializaci\xF3n de campos personalizados",forwardDateBias:"Sesgo de fecha futura para an\xE1lisis de lenguaje natural",customToday:"Hoy personalizado (referencia de l\xEDnea de tiempo)",defaultTimelineGrouping:"Agrupaci\xF3n predeterminada de l\xEDnea de tiempo",defaultZoomPreset:"Ajuste de zoom predeterminado",defaultStacking:"Apilado predeterminado",defaultDensity:"Densidad predeterminada",showLegendByDefault:"Mostrar leyenda por defecto",timelineDefaultHeight:"Altura predeterminada de l\xEDnea de tiempo",useCustomEntityFolders:"Usar carpetas de entidades personalizadas",previewResolvedFolders:"Vista previa de carpetas resueltas",storyRootFolderOptional:"Carpeta ra\xEDz de historia (opcional)",charactersFolder:"Carpeta de personajes",locationsFolder:"Carpeta de ubicaciones",eventsFolder:"Carpeta de eventos",itemsFolder:"Carpeta de objetos",referencesFolder:"Carpeta de referencias",scenesFolder:"Carpeta de escenas",chaptersFolder:"Carpeta de cap\xEDtulos",oneStoryMode:"Modo de una historia",oneStoryBaseFolder:"Carpeta base de una historia",showTutorialSection:"Mostrar secci\xF3n de tutorial",support:"Soporte",supportDevelopment:"Apoyar el desarrollo",about:"Acerca de",pluginInformation:"Informaci\xF3n del complemento",buyMeACoffee:"C\xF3mprame un caf\xE9",github:"GitHub",preview:"Vista previa",clearCustomToday:"Limpiar hoy personalizado",enterCharacterName:"Introduce el nombre del personaje",characterDescriptionPh:"Una breve descripci\xF3n del personaje...",traitsPlaceholder:"p. ej., Valiente, Curioso, Obstinado",characterHistoryPh:"La historia del personaje...",statusPlaceholderCharacter:"p. ej., Vivo, Fallecido, Desaparecido",enterItemName:"Introduce el nombre del objeto",itemDescriptionPh:"Una descripci\xF3n visual del objeto...",itemHistoryPh:"El origen, pasado e importancia del objeto...",enterLocationName:"Introduce el nombre de la ubicaci\xF3n",locationDescriptionPh:"Una breve descripci\xF3n de la ubicaci\xF3n...",locationHistoryPh:"La historia de la ubicaci\xF3n y eventos pasados...",statusPlaceholderLocation:"p. ej., Activo, Ruinas, Abandonado",enterEventName:"Introduce el nombre del evento",eventDescriptionPh:"Una descripci\xF3n del evento...",eventOutcomePh:"El resultado o consecuencias del evento...",enterDateTime:"Introduce fecha/hora",statusPlaceholderEvent:"p. ej., Pr\xF3ximo, Completado, En curso, punto clave de la trama",dateTime:"Fecha/hora",outcome:"Resultado",status:"Estado",charactersInvolved:"Personajes involucrados",associatedImages:"Im\xE1genes asociadas",links:"Enlaces",relationships:"Relaciones y ubicaci\xF3n",currentOwner:"Propietario actual",currentLocation:"Ubicaci\xF3n actual",plotCritical:"Cr\xEDtico para la trama",traits:"Rasgos",profileImage:"Imagen de perfil",itemImage:"Imagen del objeto",selectOwner:"Seleccionar propietario",selectLocation:"Seleccionar ubicaci\xF3n",changeLocation:"Cambiar ubicaci\xF3n",clearLocation:"Limpiar ubicaci\xF3n (establecer a ninguna)",parentLocation:"Ubicaci\xF3n padre",selectParentLocation:"Seleccionar ubicaci\xF3n padre",clearParentLocation:"Limpiar ubicaci\xF3n padre",addCharacter:"A\xF1adir personaje",addCustomField:"A\xF1adir campo personalizado",fieldName:"Nombre del campo",fieldValue:"Valor del campo",customFieldValueTitle:"Valor del campo personalizado",newCustomFieldTitle:"Nuevo campo personalizado",valueForX:'Valor para "{0}"',fieldNameCannotBeEmpty:"El nombre del campo no puede estar vac\xEDo",thatNameIsReserved:"Ese nombre est\xE1 reservado",fieldAlreadyExists:"Ya existe un campo con ese nombre",characterNameRequired:"El nombre del personaje no puede estar vac\xEDo.",eventNameRequired:"El nombre del evento no puede estar vac\xEDo.",itemNameRequired:"El nombre del objeto no puede estar vac\xEDo.",customFields:"Campos personalizados",select:"Seleccionar",current:"Actual",none:"Ninguno",removeX:"Eliminar {0}",removeFieldX:'Eliminar campo "{0}"',filterX:"Filtrar {0}",searchX:"Buscar {0}...",networkGraph:"Gr\xE1fico de red",relationshipType:"Tipo de relaci\xF3n",relationshipTypes:"Tipos de relaci\xF3n",relationshipTypeDesc:"Elige el tipo de relaci\xF3n",relationshipLabelDesc:"Etiqueta personalizada opcional para esta relaci\xF3n",exampleRelationshipLabel:"p. ej., Mejor amigo, Hermano, Socio comercial",addRelationship:"A\xF1adir relaci\xF3n",editRelationship:"Editar relaci\xF3n",targetEntity:"Entidad objetivo",pleaseSelectTarget:"Por favor, selecciona una entidad objetivo",ally:"Aliado",enemy:"Enemigo",family:"Familia",rival:"Rival",romantic:"Rom\xE1ntico",mentor:"Mentor",acquaintance:"Conocido",neutral:"Neutral",custom:"Personalizado",filterByGroup:"Filtrar por grupo",filterByTimeline:"Filtrar por l\xEDnea de tiempo",filterByEntityTypes:"Filtrar por tipos de entidad",exportGraph:"Exportar gr\xE1fico",toggleEdgeLabels:"Alternar etiquetas de aristas",showLegend:"Mostrar leyenda",legend:"Leyenda",noRelationshipsFound:"No se encontraron relaciones. A\xF1ade conexiones entre entidades para visualizarlas en el gr\xE1fico de red.",storyBoard:"Tablero de historia",createStoryBoard:"Crear tablero de historia",updateStoryBoard:"Actualizar tablero de historia",openStoryBoard:"Abrir tablero de historia",storyBoardCreated:"\xA1Tablero de historia creado!",storyBoardUpdated:"\xA1Tablero de historia actualizado!",storyBoardUpdatedPreserved:"\xA1Tablero de historia actualizado! Ediciones manuales preservadas.",overwriteStoryBoard:"\xBFSobrescribir tablero de historia?",createStoryBoardPrompt:"\xBFCrear tablero de historia?",createStoryBoardMessage:"No se encontr\xF3 ning\xFAn tablero de historia. \xBFTe gustar\xEDa crear uno?",storyBoardExistsMessage:"Ya existe un tablero de historia. \xBFQuieres sobrescribirlo?",noScenesForStoryBoard:"No se encontraron escenas. \xA1Crea algunas escenas primero!",noStoryBoardFound:'No se encontr\xF3 ning\xFAn tablero de historia. Crea uno primero usando "Crear tablero de historia".',errorOpeningStoryBoard:"Error al abrir el tablero de historia. Consulta la consola para m\xE1s detalles.",storyBoardEmpty:"No se encontraron escenas. El tablero de historia estar\xE1 vac\xEDo.",errorReadingStoryBoard:"Error al leer el tablero de historia existente. Puede estar corrupto.",errorUpdatingStoryBoard:"Error al actualizar el tablero de historia. Consulta la consola para m\xE1s detalles.",storyBoardLayout:"Dise\xF1o del tablero de historia",storyBoardLayoutDesc:"Elige c\xF3mo organizar las escenas en el lienzo",layoutByChapters:"Por cap\xEDtulos",layoutByTimeline:"Por l\xEDnea de tiempo",layoutByStatus:"Por estado (Kanban)",storyBoardColorBy:"Colorear escenas por",storyBoardColorByDesc:"Elige qu\xE9 determina los colores de las tarjetas de escena",colorByStatus:"Estado (Borrador, En progreso, etc.)",colorByChapter:"Cap\xEDtulo",colorByNone:"Ninguno",storyBoardShowEdges:"Mostrar flechas de flujo de escenas",storyBoardShowEdgesDesc:"Mostrar flechas que conectan escenas en secuencia",storyBoardCardSize:"Tama\xF1o de tarjeta",storyBoardCardWidth:"Ancho de tarjeta",storyBoardCardHeight:"Alto de tarjeta",graphFilters:"Filtros de gr\xE1fico",timelineStart:"Inicio de l\xEDnea de tiempo",timelineEnd:"Fin de l\xEDnea de tiempo",selectEntityTypes:"Seleccionar tipos de entidad",applyFilters:"Aplicar filtros",resetFilters:"Restablecer filtros",exportAsPNG:"Exportar como PNG",exportAsJPG:"Exportar como JPG",graphExported:"Gr\xE1fico exportado.",connections:"Conexiones",searchEntities:"Buscar entidades...",zoomIn:"Acercar",zoomOut:"Alejar",fitToView:"Ajustar a la vista",layout:"Dise\xF1o",forceDirected:"Dirigido por fuerza",circle:"C\xEDrculo",grid:"Cuadr\xEDcula",concentric:"Conc\xE9ntrico",nodeTypes:"Tipos de nodo",interactions:"Interacciones",addConnection:"A\xF1adir conexi\xF3n",noConnectionsYet:"A\xFAn no hay conexiones.",label:"Etiqueta",optional:"(Opcional)",all:"Todos",milestone:"Hito",milestoneDesc:"Marcar este evento como un momento clave de la historia",progress:"Progreso",progressDesc:"Porcentaje de finalizaci\xF3n (0-100)",dependencies:"Dependencias",dependenciesDesc:"Eventos que deben ocurrir antes de este",addDependency:"A\xF1adir dependencia",editMode:"Modo de edici\xF3n",lockMode:"Modo de bloqueo",editModeTooltip:"Modo de edici\xF3n (arrastra para reprogramar)",filters:"Filtros",milestonesOnly:"Solo hitos",milestonesOnlyDesc:"Mostrar solo eventos hito",filterByCharacter:"Filtrar por personaje",filterByLocation:"Filtrar por ubicaci\xF3n",clearAllFilters:"Limpiar todos los filtros",selectCharacterFilter:"Seleccionar personaje...",selectLocationFilter:"Seleccionar ubicaci\xF3n...",selectGroupFilter:"Seleccionar grupo...",characterFilter:"Personaje:",locationFilter:"Ubicaci\xF3n:",groupFilter:"Grupo:",eventRescheduled:'Evento "{0}" reprogramado',editModeEnabled:"Modo de edici\xF3n habilitado - arrastra eventos para reprogramar",editModeDisabled:"Modo de edici\xF3n deshabilitado",dependencyAdded:'Dependencia "{0}" ya a\xF1adida',byCharacter:"Por personaje",ganttView:"Vista de Gantt",timelineView:"Vista de l\xEDnea de tiempo",switchedToGantt:"Cambiado a vista de Gantt",switchedToTimeline:"Cambiado a vista de l\xEDnea de tiempo",entityTypes:"Tipos de entidad",openInPanel:"Abrir en panel",openInModal:"Abrir en modal",close:"Cerrar",manageTimelineEras:"Gestionar eras y per\xEDodos de l\xEDnea de tiempo",addEra:"A\xF1adir era",eraType:"Tipo de era",startDate:"Fecha de inicio",endDate:"Fecha de fin",eraColor:"Color de era",manageTimelineTracks:"Gestionar pistas de l\xEDnea de tiempo",addTrack:"A\xF1adir pista",trackType:"Tipo de pista",trackColor:"Color de pista",newStory:"+ Nueva historia",noCharactersFound:'No se encontraron personajes. Haz clic en "Crear nuevo" para a\xF1adir tu primer personaje.',noLocationsFound:"No se encontraron ubicaciones.",noEventsFound:"No se encontraron eventos.",noItemsFound:"No se encontraron objetos.",noImagesFound:"No se encontraron im\xE1genes.",noGroupsFound:"No se encontraron grupos.",noReferencesFound:"No se encontraron referencias.",noChaptersFound:"No se encontraron cap\xEDtulos.",noScenesFound:"No se encontraron escenas.",matchingFilter:" Coincide con el filtro.",filterItems:"Filtrar objetos",filterGroups:"Filtrar grupos",noMembers:"No hay miembros.",enterGroupName:"Introduce el nombre del grupo",describeGroupPh:"Describe este grupo...",color:"Color",colorPlaceholder:"#RRGGBB o nombre de color",groupNameRequired:"El nombre del grupo es obligatorio.",groupNameExists:"Ya existe un grupo con este nombre. Por favor, elige un nombre diferente.",addImageDetails:"A\xF1adir detalles de imagen",editImageDetails:"Editar detalles de imagen",commaSeparatedTags:"Etiquetas separadas por comas.",commaSeparatedCharacterNames:"Nombres de personajes separados por comas.",commaSeparatedLocationNames:"Nombres de ubicaciones separados por comas.",commaSeparatedEventNames:"Nombres de eventos separados por comas.",saveDetails:"Guardar detalles",removeFromGallery:"Eliminar de la galer\xEDa",imageDetailsSaved:'Detalles de imagen para "{0}" guardados.',imageRemovedFromGallery:'Imagen "{0}" eliminada de la galer\xEDa.',confirmDeleteScene:'\xBFEliminar escena "{0}"?',confirmDeleteReference:'\xBFEliminar referencia "{0}"?',confirmDeleteChapter:'\xBFEliminar cap\xEDtulo "{0}"?',confirmDeleteGroup:'\xBFEst\xE1s seguro de que quieres eliminar el grupo "{0}"?',confirmDeleteCharacter:'\xBFEst\xE1s seguro de que quieres eliminar "{0}"?',confirmDeleteEvent:'\xBFEst\xE1s seguro de que quieres eliminar el evento "{0}"? Esto mover\xE1 la nota a la papelera del sistema.',confirmDeleteLocation:'\xBFEst\xE1s seguro de que quieres eliminar "{0}"?',confirmDeleteItem:'\xBFEst\xE1s seguro de que quieres eliminar "{0}"?',confirmDeleteStory:'\xBFEliminar historia "{0}"? Esto no se puede deshacer.',confirmRemoveImageFromGallery:'\xBFEst\xE1s seguro de que quieres eliminar "{0}" de la galer\xEDa? Esto no elimina el archivo en s\xED.',confirmDeleteCharacterTrash:'\xBFEst\xE1s seguro de que quieres eliminar "{0}"? Esto mover\xE1 el archivo a la papelera del sistema.',confirmDeleteItemTrash:'\xBFEst\xE1s seguro de que quieres eliminar "{0}"? Esto mover\xE1 el archivo a la papelera del sistema.',sceneCreated:'Escena "{0}" creada.',sceneUpdated:'Escena "{0}" actualizada.',chapterCreated:'Cap\xEDtulo "{0}" creado.',chapterUpdated:'Cap\xEDtulo "{0}" actualizado.',referenceCreated:'Referencia "{0}" creada.',referenceUpdated:'Referencia "{0}" actualizada.',groupCreated:'Grupo "{0}" creado.',groupRenamed:'Grupo renombrado a "{0}".',groupDeleted:'Grupo "{0}" eliminado.',characterDeleted:'Personaje "{0}" eliminado.',locationDeleted:'Ubicaci\xF3n "{0}" eliminada.',itemDeleted:'Objeto "{0}" eliminado.',fileMovedToTrash:"Archivo {0} movido a la papelera.",characterLinkedAlready:'El personaje "{0}" ya est\xE1 vinculado.',failedToDelete:"Error al eliminar {0}.",failedToSave:"Error al guardar {0}.",customFieldError:"El nombre del campo personalizado debe ser \xFAnico, no vac\xEDo y no reservado.",sceneNameRequired:"El t\xEDtulo de la escena es obligatorio.",chapterNameRequired:"El t\xEDtulo del cap\xEDtulo es obligatorio.",locationNameRequired:"El nombre de la ubicaci\xF3n no puede estar vac\xEDo.",circularLocationError:"No se puede establecer la ubicaci\xF3n padre: Esto crear\xEDa una referencia circular.",errorLoadingCharacters:"Error al cargar personajes. Consulta la consola.",errorLoadingLocations:"Error al cargar ubicaciones. Consulta la consola.",errorLoadingEvents:"Error al cargar eventos. Consulta la consola.",errorLoadingItems:"Error al cargar objetos. Consulta la consola.",groupNotFound:"Grupo no encontrado.",noGroupsToRename:"No hay grupos para renombrar.",noGroupsToDelete:"No hay grupos para eliminar.",couldNotFindNote:"No se pudo encontrar el archivo de la nota.",autoDetectedStories:"Narrador: Detectadas e importadas autom\xE1ticamente {0} nueva(s) carpeta(s) de historia.",errorDiscoveringStories:"Suite de narrador: Error al descubrir historias: {0}",storiesRefreshed:"Narrador: Encontradas e importadas {0} nueva(s) carpeta(s) de historia.",noNewStoriesFound:"Narrador: No se encontraron nuevas carpetas de historia.",errorRefreshingStories:"Suite de narrador: Error al actualizar historias: {0}",errorScanningFolders:"Suite de narrador: Error al escanear carpetas personalizadas: {0}",couldNotAutoDetect:"Narrador: No se pudo detectar autom\xE1ticamente una ra\xEDz de historia. Por favor, establece las carpetas manualmente.",autoDetectedFolders:'Narrador: Carpetas personalizadas detectadas autom\xE1ticamente bajo "{0}" (coincidencias: {1}).',uploadedToVault:'Subido "{0}" a la b\xF3veda.',errorUploadingFile:"Error al subir el archivo. Consulta la consola para m\xE1s detalles.",errorParsingFile:"Error al analizar el archivo: {0}",currentValue:"Actual: {0}",ownerValue:"Propietario: {0}",noImagesFoundFilter:"No se encontraron im\xE1genes. Coincide con el filtro.",tutorialGettingStarted:"Tutorial e introducci\xF3n",type:"Tipo",region:"Regi\xF3n",storyNameField:"Nombre de la historia",descriptionField:"Descripci\xF3n",beatSheetPh:`- Conocer al mentor
- La negativa`,categoryPh:"Idioma, Profec\xEDa, Inspiraci\xF3n, Varios, ...",fieldNamePh:"Nombre del campo",fieldValuePh:"Valor del campo",galleryUploadFolderPh:"StorytellerSuite/GalleryUploads",customTodayPh:"AAAA-MM-DD o ISO completo (admite fechas a.C.)",timelineHeightPh:"p. ej., 380px",storyRootFolderPh:"Creative/Writing/{storyName}",charactersFolderPh:"MyStory/Characters",locationsFolderPh:"MyStory/Locations",eventsFolderPh:"MyStory/Events",itemsFolderPh:"MyStory/Items",referencesFolderPh:"MyStory/References",scenesFolderPh:"MyStory/Scenes",chaptersFolderPh:"MyStory/Chapters",oneStoryBaseFolderPh:"StorytellerSuite",enterStoryNamePh:"Introduce el nombre de la historia",describeStoryPh:"Describe tu historia (opcional)",selectImageFilePh:"Selecciona un archivo de imagen...",filterImagesPh:"Filtrar por t\xEDtulo, etiqueta, enlace...",selectItemPh:"Selecciona un objeto para vincular...",selectEventLocationPh:"Selecciona la ubicaci\xF3n del evento...",selectParentLocationPh:"Selecciona una ubicaci\xF3n padre...",selectGroupPh:"Selecciona un grupo\u2026",filterFoldersPh:"Escribe para filtrar carpetas\u2026",selectGalleryImagePh:"Selecciona una imagen de la galer\xEDa...",selectEventPh:"Selecciona un evento para vincular...",selectCharacterPh:"Selecciona un personaje para vincular...",priorityInChapter:"Prioridad en el cap\xEDtulo",priorityEg:"p. ej., 1",beatSheetOneLine:"Hoja de ritmo una l\xEDnea",writeScenePh:"Escribe tu escena...",scanVaultDesc:"Escanea tu b\xF3veda en busca de historias de Narrador existentes e imp\xF3rtalas. \xDAtil despu\xE9s de mover carpetas o cambiar la estructura.",galleryFolderDesc:"Carpeta donde se almacenar\xE1n las im\xE1genes subidas a la galer\xEDa",customFieldsDesc:"Elige c\xF3mo se almacenan los campos personalizados en el frontmatter",forwardDateBiasDesc:'Preferir interpretaci\xF3n futura para fechas relativas (p. ej., "Viernes")',customTodayDesc:"Fecha opcional utilizada para el bot\xF3n Hoy y el an\xE1lisis relativo. Admite fechas a.C. (p. ej., 2024-01-15 para d.C., o -00499-01-01 para 500 a.C.). D\xE9jalo vac\xEDo para usar el hoy del sistema.",timelineHeightDesc:"Ajustar la altura del modal de l\xEDnea de tiempo",useCustomFoldersDesc:"Cuando est\xE1 habilitado, usa las rutas de carpetas a continuaci\xF3n. Puedes incluir {storyName}, {storySlug}, o {storyId} para crear carpetas por historia (p. ej., Creative/Writing/{storyName}/Characters).",previewFoldersDesc:"Ver la ruta de carpeta resuelta de cada entidad seg\xFAn la configuraci\xF3n actual y la historia activa",storyRootDesc:"Plantilla de ruta base para todas las entidades. Admite {storyName}, {storySlug}, {storyId}. Ejemplo: Creative/Writing/{storyName}",charactersFolderDesc:"Ruta para archivos markdown de personajes (se permiten marcadores: {storyName}, {storySlug}, {storyId})",locationsFolderDesc:"Ruta para archivos markdown de ubicaciones (se permiten marcadores: {storyName}, {storySlug}, {storyId})",eventsFolderDesc:"Ruta para archivos markdown de eventos (se permiten marcadores: {storyName}, {storySlug}, {storyId})",itemsFolderDesc:"Ruta para archivos markdown de objetos (se permiten marcadores: {storyName}, {storySlug}, {storyId})",referencesFolderDesc:"Ruta para archivos markdown de referencias (se permiten marcadores: {storyName}, {storySlug}, {storyId})",scenesFolderDesc:"Ruta para archivos markdown de escenas (se permiten marcadores: {storyName}, {storySlug}, {storyId})",chaptersFolderDesc:"Ruta para archivos markdown de cap\xEDtulos (se permiten marcadores: {storyName}, {storySlug}, {storyId})",oneStoryModeDesc:"Aplanar la estructura de carpetas a una sola historia. Cuando est\xE1 habilitado (y las carpetas personalizadas deshabilitadas), el contenido va bajo una sola carpeta base sin Stories/StoryName.",oneStoryBaseFolderDesc:"Carpeta base para Personajes/Ubicaciones/Eventos/Objetos/Referencias/Cap\xEDtulos",showTutorialDesc:"Mostrar la secci\xF3n de tutorial e introducci\xF3n en la configuraci\xF3n",supportDevDesc:"Si encuentras \xFAtil este complemento, considera apoyar su desarrollo",pluginInfoDesc:"Suite de narrador - Una suite completa para gestionar personajes, ubicaciones, eventos y galer\xEDas para tus historias.",storyNameDesc:"Obligatorio. Debe ser \xFAnico.",descriptionOptionalDesc:"Opcional",locationNameDesc:"El nombre de la ubicaci\xF3n.",locationTypeDesc:"p. ej., Ciudad, Bosque, Castillo, Taberna",locationRegionDesc:"\xC1rea geogr\xE1fica m\xE1s amplia.",locationStatusDesc:"p. ej., Activo, Ruinas, Abandonado",parentLocationDesc:"Selecciona una ubicaci\xF3n padre que contenga esta ubicaci\xF3n.",assignToGroupsDesc:"Asigna esta ubicaci\xF3n a uno o m\xE1s grupos.",manageGroupsDesc:"Gestiona tus grupos. Compartidos entre todos los tipos de entidad.",searchGroupsDesc:"Buscar por nombre o descripci\xF3n del grupo.",manageCharactersDesc:"Gestiona los personajes de tu historia.",manageLocationsDesc:"Gestiona las ubicaciones de tu historia.",manageEventsDesc:"Gestiona los eventos de tu historia.",manageImagesDesc:"Gestiona las im\xE1genes de tu historia.",assignEventToGroupsDesc:"Asigna este evento a uno o m\xE1s grupos.",assignItemToGroupsDesc:"Asigna este objeto a uno o m\xE1s grupos.",assignCharacterToGroupsDesc:"Asigna este personaje a uno o m\xE1s grupos.",nodesLabel:"Nodos",edgesLabel:"Aristas",filteredLabel:"Filtrado",loadingNodes:"Cargando nodos",emptyGraphTitle:"No hay entidades para mostrar",emptyGraphMessage:"Crea personajes, ubicaciones, eventos u objetos para verlos en el gr\xE1fico de red.",emptyGraphTip:"A\xF1ade relaciones entre entidades para ver las conexiones visualizadas aqu\xED.",keyboardShortcuts:"Atajos de teclado",graphUpdated:"Gr\xE1fico actualizado",filterApplied:"Filtro aplicado",layoutChanged:"Dise\xF1o cambiado",graphFitToView:"Ajustar gr\xE1fico a la vista",showingXNodes:"Mostrando {0} nodo",showingXEdges:"{0} arista",noNodesVisible:"No hay nodos visibles con los filtros actuales",createNewEconomy:"Crear nueva econom\xEDa",createEconomy:"Crear econom\xEDa",editEconomy:"Editar econom\xEDa",deleteEconomy:"Eliminar econom\xEDa",viewEconomies:"Ver econom\xEDas",economies:"Econom\xEDas",economy:"Econom\xEDa",economicSystem:"Sistema econ\xF3mico",economicSystemDesc:"Tipo de organizaci\xF3n econ\xF3mica",economyNameDesc:'Nombre del sistema econ\xF3mico (p. ej., "Econom\xEDa del Reino de Eldoria")',industries:"Industrias",industriesDesc:"Principales industrias, producci\xF3n y actividades econ\xF3micas",taxation:"Impuestos y pol\xEDtica comercial",taxationDesc:"Sistema fiscal, regulaciones comerciales y pol\xEDticas econ\xF3micas",representativeImage:"Imagen representativa",barterEconomy:"Econom\xEDa de trueque",marketEconomy:"Econom\xEDa de mercado",commandEconomy:"Econom\xEDa planificada",mixedEconomy:"Econom\xEDa mixta",feudalEconomy:"Econom\xEDa feudal",giftEconomy:"Econom\xEDa del don",booming:"En auge",growing:"En crecimiento",recession:"Recesi\xF3n",depression:"Depresi\xF3n",recovering:"En recuperaci\xF3n",economyNameRequired:"El nombre de la econom\xEDa es obligatorio",economyStatusDesc:"Estado actual de salud econ\xF3mica",economyDescriptionDesc:"Resumen y caracter\xEDsticas del sistema econ\xF3mico",noEconomiesFound:"No se encontraron econom\xEDas",searchEconomies:"Buscar econom\xEDas...",confirmDeleteEconomy:'\xBFEst\xE1s seguro de que quieres eliminar la econom\xEDa "{0}"? Esto mover\xE1 la nota a la papelera del sistema.',economyCreated:'Econom\xEDa "{0}" creada.',economyUpdated:'Econom\xEDa "{0}" actualizada.',economyDeleted:'Econom\xEDa "{0}" eliminada.',createNewCulture:"Crear nueva cultura",createCulture:"Crear cultura",editCulture:"Editar cultura",deleteCulture:"Eliminar cultura",viewCultures:"Ver culturas",cultures:"Culturas",culture:"Cultura",cultureNameDesc:"Nombre de la cultura o sociedad",techLevel:"Nivel tecnol\xF3gico",techLevelDesc:"Avance tecnol\xF3gico de la cultura",governmentType:"Tipo de gobierno",governmentTypeDesc:"Sistema pol\xEDtico y estructura de liderazgo",languages:"Idiomas",languagesDesc:"Lista separada por comas de idiomas hablados (p. ej., Com\xFAn, \xC9lfico, Enano)",population:"Poblaci\xF3n",populationDesc:'Tama\xF1o estimado de la poblaci\xF3n (p. ej., "10,000" o "Grande")',valuesBeliefs:"Valores y creencias",valuesBeliefsDesc:"Valores culturales fundamentales, cosmovisi\xF3n y creencias filos\xF3ficas",religion:"Religi\xF3n",religionDesc:"Creencias religiosas, pr\xE1cticas y deidades adoradas",socialStructure:"Estructura social",socialStructureDesc:"Jerarqu\xEDa de clases, organizaci\xF3n social y sistemas de castas",namingConventions:"Convenciones de nombres",namingConventionsDesc:"C\xF3mo los miembros de esta cultura nombran personas, lugares y cosas",customsTraditions:"Costumbres y tradiciones",customsTraditionsDesc:"Pr\xE1cticas culturales, ceremonias, festividades y tradiciones",cultureStatusDesc:"Estado actual de la cultura",cultureDescriptionDesc:"Resumen y caracter\xEDsticas clave de la cultura",cultureHistoryDesc:"Or\xEDgenes, eventos hist\xF3ricos importantes y evoluci\xF3n cultural",stoneAge:"Edad de Piedra",bronzeAge:"Edad de Bronce",ironAge:"Edad de Hierro",medieval:"Medieval",renaissance:"Renacimiento",industrial:"Industrial",modern:"Moderno",futuristic:"Futurista",monarchy:"Monarqu\xEDa",democracy:"Democracia",republic:"Rep\xFAblica",theocracy:"Teocracia",tribal:"Tribal",empire:"Imperio",feudal:"Feudal",oligarchy:"Oligarqu\xEDa",anarchy:"Anarqu\xEDa",thriving:"Pr\xF3spera",stable:"Estable",declining:"En declive",extinct:"Extinta",emerging:"Emergente",cultureNameRequired:"El nombre de la cultura es obligatorio",noCulturesFound:"No se encontraron culturas",searchCultures:"Buscar culturas...",confirmDeleteCulture:'\xBFEliminar cultura "{0}"? Esto mover\xE1 la nota a la papelera del sistema.',cultureCreated:'Cultura "{0}" creada.',cultureUpdated:'Cultura "{0}" actualizada.',cultureDeleted:'Cultura "{0}" eliminada.',createNewMagicSystem:"Crear nuevo sistema de magia",createMagicSystem:"Crear sistema de magia",editMagicSystem:"Editar sistema de magia",deleteMagicSystem:"Eliminar sistema de magia",viewMagicSystems:"Ver sistemas de magia",magicSystems:"Sistemas de magia",magicSystem:"Sistema de magia",magicSystemNameDesc:'Nombre del sistema de magia (p. ej., "Artes Arcanas", "Magia Divina")',systemType:"Tipo de sistema",systemTypeDesc:"Fuente o categor\xEDa de poder m\xE1gico",rarity:"Rareza",rarityDesc:"\xBFQu\xE9 tan com\xFAn es la magia en el mundo?",powerLevel:"Nivel de poder",powerLevelDesc:"Potencia general de este sistema de magia",rulesMechanics:"Reglas y mec\xE1nicas",rulesMechanicsDesc:"C\xF3mo se usa, lanza o canaliza la magia",source:"Fuente",sourceDesc:"\xBFDe d\xF3nde proviene el poder m\xE1gico?",costsConsequences:"Costos y consecuencias",costsConsequencesDesc:"\xBFQu\xE9 le cuesta al lanzador usar la magia?",limitations:"Limitaciones",limitationsDesc:"\xBFCu\xE1les son los l\xEDmites y restricciones de esta magia?",trainingLearning:"Entrenamiento y aprendizaje",trainingLearningDesc:"\xBFC\xF3mo se aprende y domina la magia?",arcane:"Arcano (Aprendido)",divine:"Divino (Basado en fe)",natural:"Natural (Naturaleza/Dru\xEDdico)",psionic:"Psi\xF3nico (Poderes mentales)",bloodMagic:"Magia de sangre",elemental:"Elemental",necromancy:"Nigromancia",alchemy:"Alquimia",runeMagic:"Magia r\xFAnica",ubiquitous:"Ubicua (Todos la tienen)",common:"Com\xFAn (Muchos la tienen)",uncommon:"Poco com\xFAn (Algunos la tienen)",rare:"Rara (Pocos la tienen)",legendary:"Legendaria (Casi nadie)",low:"Bajo (Efectos sutiles)",moderate:"Moderado (Efectos notables)",high:"Alto (Efectos poderosos)",godlike:"Divino (Deformaci\xF3n de la realidad)",forbidden:"Prohibida",lostKnowledge:"Conocimiento perdido",resurgent:"Resurgente",magicSystemNameRequired:"El nombre del sistema de magia es obligatorio",noMagicSystemsFound:"No se encontraron sistemas de magia",searchMagicSystems:"Buscar sistemas de magia...",confirmDeleteMagicSystem:'\xBFEliminar sistema de magia "{0}"? Esto mover\xE1 la nota a la papelera del sistema.',magicSystemCreated:'Sistema de magia "{0}" creado.',magicSystemUpdated:'Sistema de magia "{0}" actualizado.',magicSystemDeleted:'Sistema de magia "{0}" eliminado.',magicSystemStatusDesc:"Estado actual del sistema de magia",magicSystemDescriptionDesc:"Resumen y explicaci\xF3n del sistema de magia",magicSystemHistoryDesc:"Or\xEDgenes, descubrimiento y evoluci\xF3n del sistema de magia",startFromTemplate:"Comenzar desde plantilla",startFromTemplateDesc:"Opcionalmente comenzar con una plantilla preconfigurada",chooseTemplate:"Elegir plantilla",selectTemplate:"Seleccionar una plantilla",templateApplied:'Plantilla "{0}" aplicada',noTemplatesAvailable:"Esta plantilla no contiene ning\xFAn elemento",cannotDeleteWithoutPath:"No se puede eliminar sin la ruta del archivo.",cannotOpenWithoutPath:"No se puede abrir la nota sin la ruta del archivo.",templates:"Plantillas",entityTemplates:"Plantillas de entidad",browseManageTemplates:"Explorar y gestionar plantillas reutilizables para personajes, ubicaciones y otras entidades.",createNewTemplate:"Crear nueva plantilla",templateCreated:'\xA1Plantilla "{0}" creada!',searchTemplates:"Buscar",searchTemplatesPlaceholder:"Buscar plantillas por nombre, descripci\xF3n o etiquetas...",genre:"G\xE9nero",allGenres:"Todos los g\xE9neros",templateCategory:"Categor\xEDa",allTemplateCategories:"Todas las categor\xEDas",singleEntity:"Entidad \xFAnica",entitySet:"Conjunto de entidades",fullWorld:"Mundo completo",sortBy:"Ordenar por",sortByName:"Nombre",sortByUsage:"Recuento de uso",sortByRecent:"Usado recientemente",showBuiltIn:"Mostrar integradas",showCustom:"Mostrar personalizadas",noTemplatesFound:"No se encontraron plantillas. Intenta ajustar tus filtros o crear una nueva plantilla.",foundXTemplates:"Encontrada {0} plantilla",builtIn:"Integrada",usedXTimes:"Usada: {0}x",contains:"Contiene: ",useTemplate:"Usar plantilla",duplicate:"Duplicar",templateSelected:'Plantilla "{0}" seleccionada. Aplica esta plantilla desde el modal de creaci\xF3n de entidad.',templateDeleted:'Plantilla "{0}" eliminada.',failedToDeleteTemplate:"Error al eliminar la plantilla: {0}",templateCopySuffix:" (Copia)",templateDuplicated:'Plantilla duplicada como "{0}"',failedToDuplicateTemplate:"Error al duplicar la plantilla: {0}",deleteTemplate:"\xBFEliminar plantilla?",confirmDeleteTemplate:'\xBFEst\xE1s seguro de que quieres eliminar la plantilla "{0}"? Esta acci\xF3n no se puede deshacer.',dashboardTabVisibility:"Visibilidad de pesta\xF1as del panel de control",dashboardTabVisibilityDesc:"Elige qu\xE9 pesta\xF1as mostrar en la barra lateral del panel de control. Las pesta\xF1as ocultas no aparecer\xE1n en la barra de pesta\xF1as.",tabIsVisible:"La pesta\xF1a es visible",tabIsHidden:"La pesta\xF1a est\xE1 oculta",tabShown:"Pesta\xF1a {0} mostrada",tabHidden:"Pesta\xF1a {0} oculta",refreshDashboardToSeeChanges:". Actualiza el panel de control para ver los cambios.",ganttViewSettings:"Configuraci\xF3n de vista de Gantt",showProgressBarsInGantt:"Mostrar barras de progreso en la vista de Gantt",showProgressBarsInGanttDesc:"Mostrar superposiciones de barras de progreso en las barras de Gantt para visualizar la finalizaci\xF3n del evento.",defaultGanttDuration:"Duraci\xF3n predeterminada de Gantt (d\xEDas)",defaultGanttDurationDesc:"Duraci\xF3n predeterminada en d\xEDas para eventos sin fecha de fin cuando se muestran en la vista de Gantt.",dependencyArrowStyle:"Estilo de flecha de dependencia",dependencyArrowStyleDesc:"Estilo visual para flechas de dependencia entre eventos en la vista de Gantt.",solid:"S\xF3lido",dashed:"Discontinuo",dotted:"Punteado",mapSettings:"Configuraci\xF3n de mapa",enableFrontmatterMarkers:"Habilitar marcadores de frontmatter",enableFrontmatterMarkersDesc:"Generar autom\xE1ticamente marcadores desde notas con ubicaci\xF3n o mapmarkers en frontmatter",enableDataViewMarkers:"Habilitar marcadores de DataView",enableDataViewMarkersDesc:"Generar autom\xE1ticamente marcadores desde consultas de DataView (requiere el complemento DataView)",tutorialWelcome:"\xA1Bienvenido a Storyteller Suite!",tutorialWelcomeDesc:"Este complemento te ayuda a organizar y gestionar todos los aspectos de tus historias. Aqu\xED te explicamos c\xF3mo empezar:",tutorialTip:"Consejo: Haz clic en cualquier secci\xF3n a continuaci\xF3n para expandir instrucciones detalladas y ejemplos.",tutorialDashboardTitle:"Panel de control e icono de la cinta",tutorialDashboardAccess:"Acceder al panel de control:",tutorialDashboardRibbon:"Haz clic en el <strong>icono de libro abierto</strong> en la cinta izquierda (barra lateral)",tutorialDashboardCommand:'Usa la paleta de comandos: <kbd>Ctrl/Cmd + P</kbd> \u2192 "Storyteller: Abrir panel de control"',tutorialDashboardHub:"El panel de control es tu centro para gestionar todos los elementos de la historia",tutorialStoryTitle:"Gesti\xF3n de historias",tutorialStoryCreating:"Crear tu primera historia:",tutorialStoryButton:'Usa el bot\xF3n <strong>"Crear nueva historia"</strong> a continuaci\xF3n (oculto cuando el <em>Modo una sola historia</em> est\xE1 habilitado)',tutorialStoryCommand:'O desde la paleta de comandos: "Storyteller: Crear nueva historia"',tutorialStoryName:"Dale un nombre y descripci\xF3n a tu historia",tutorialStoryDefault:"Por defecto, el complemento crea carpetas en <code>StorytellerSuite/Stories/NombreDeTuHistoria/</code>",tutorialStoryManaging:"Gestionar historias:",tutorialStorySwitch:'Cambia entre historias usando el bot\xF3n <strong>"Establecer como activa"</strong>',tutorialStoryEdit:"Edita los detalles de la historia con el icono de l\xE1piz",tutorialStoryDelete:"Elimina historias con el icono de papelera (esto solo las elimina del complemento, no tus archivos)",tutorialStoryActivation:'Consejo de activaci\xF3n inmediata: Crear una historia desde <em>Configuraci\xF3n</em> actualiza la lista de configuraci\xF3n inmediatamente, pero el men\xFA desplegable de historias del panel de control puede no actualizarse hasta que vuelvas a abrir el panel de control. Para una activaci\xF3n instant\xE1nea y actualizaci\xF3n de la interfaz, usa la acci\xF3n del panel de control/paleta de comandos <em>"Storyteller: Crear nueva historia"</em>, o cierra/vuelve a abrir el panel de control mediante <em>"Storyteller: Abrir panel de control"</em>.',tutorialStoryOneMode:"Modo una sola historia: Cuando est\xE1 habilitado en la configuraci\xF3n, la interfaz se simplifica a un dise\xF1o de una sola historia y el bot\xF3n <em>Nueva historia</em> est\xE1 oculto. El contenido se organiza bajo una sola carpeta base.",tutorialCharacterTitle:"Gesti\xF3n de personajes",tutorialCharacterCreating:"Crear personajes:",tutorialCharacterDashboard:'<strong>Panel de control:</strong> Haz clic en el bot\xF3n "Crear personaje"',tutorialCharacterCommand:'<strong>Paleta de comandos:</strong> "Storyteller: Crear nuevo personaje"',tutorialCharacterDetails:"Completa los detalles del personaje, historia de fondo, relaciones",tutorialCharacterImages:"A\xF1ade im\xE1genes de perfil desde tu b\xF3veda",tutorialCharacterManaging:"Gestionar personajes:",tutorialCharacterView:'<strong>Ver todos:</strong> Panel de control \u2192 "Ver personajes" o Paleta de comandos \u2192 "Storyteller: Ver personajes"',tutorialCharacterEdit:"<strong>Editar:</strong> Haz clic en el nombre del personaje en el panel de control o lista de personajes",tutorialCharacterDelete:"<strong>Eliminar:</strong> Usa el icono de papelera (mueve a la papelera de Obsidian)",tutorialCharacterStorage:"Los personajes se almacenan como archivos markdown en la carpeta <code>Characters/</code>",tutorialLocationTitle:"Gesti\xF3n de ubicaciones",tutorialLocationCreating:"Crear ubicaciones:",tutorialLocationDashboard:'<strong>Panel de control:</strong> Haz clic en el bot\xF3n "Crear ubicaci\xF3n"',tutorialLocationCommand:'<strong>Paleta de comandos:</strong> "Storyteller: Crear nueva ubicaci\xF3n"',tutorialLocationDetails:"A\xF1ade descripciones, historia, regi\xF3n, tipo de ubicaci\xF3n",tutorialLocationLink:"Vincula a personajes y eventos relacionados",tutorialLocationManaging:"Gestionar ubicaciones:",tutorialLocationView:'<strong>Ver todas:</strong> Panel de control \u2192 "Ver ubicaciones" o Paleta de comandos \u2192 "Storyteller: Ver ubicaciones"',tutorialLocationStorage:"Las ubicaciones se almacenan en la carpeta <code>Locations/</code> como archivos markdown",tutorialLocationEdit:"Edita haciendo clic en el nombre de la ubicaci\xF3n, elimina con el icono de papelera",tutorialEventTitle:"Gesti\xF3n de eventos y l\xEDnea de tiempo",tutorialEventCreating:"Crear eventos:",tutorialEventDashboard:'<strong>Panel de control:</strong> Haz clic en el bot\xF3n "Crear evento"',tutorialEventCommand:'<strong>Paleta de comandos:</strong> "Storyteller: Crear nuevo evento"',tutorialEventDetails:"Establece fecha/hora, a\xF1ade descripciones, resultados",tutorialEventLink:"Vincula a personajes y ubicaciones involucrados",tutorialEventNew:"<strong>Nuevo:</strong> Marca eventos como hitos, establece progreso (0-100%), a\xF1ade dependencias",tutorialEventTimeline:"Vista de l\xEDnea de tiempo:",tutorialEventTimelineDashboard:'<strong>Panel de control:</strong> Haz clic en el bot\xF3n "Ver l\xEDnea de tiempo"',tutorialEventTimelineCommand:'<strong>Paleta de comandos:</strong> "Storyteller: Ver l\xEDnea de tiempo"',tutorialEventTimelineSee:"Ve todos los eventos ordenados cronol\xF3gicamente",tutorialEventStorage:"Los eventos se almacenan en la carpeta <code>Events/</code>",tutorialGanttTitle:"Caracter\xEDsticas de l\xEDnea de tiempo estilo Gantt",tutorialGanttEnhanced:"Vista de l\xEDnea de tiempo mejorada:",tutorialGanttToggle:"<strong>Alternar vista:</strong> Cambia entre la vista de l\xEDnea de tiempo cl\xE1sica y Gantt usando el bot\xF3n de alternancia",tutorialGanttMilestones:"<strong>Hitos:</strong> Marca eventos importantes como hitos (estilo dorado con icono de estrella)",tutorialGanttProgress:"<strong>Seguimiento de progreso:</strong> Establece el porcentaje de finalizaci\xF3n (0-100%) en eventos con barras de progreso visuales",tutorialGanttDependencies:"<strong>Dependencias:</strong> Vincula eventos para mostrar relaciones de causa y efecto con flechas",tutorialGanttDrag:"Reagendamiento por arrastrar y soltar:",tutorialGanttLock:"Haz clic en el <strong>icono de candado/l\xE1piz</strong> en la barra de herramientas para habilitar el modo de edici\xF3n",tutorialGanttDragEvents:"Arrastra eventos a nuevas fechas - los cambios se guardan autom\xE1ticamente",tutorialGanttDisable:"Haz clic en el icono nuevamente para deshabilitar la edici\xF3n y bloquear la l\xEDnea de tiempo",tutorialGanttFiltering:"Filtrado y agrupaci\xF3n:",tutorialGanttFilterPanel:'<strong>Panel de filtros:</strong> Haz clic en "Filtros" para abrir el panel de filtros plegable',tutorialGanttFilterBy:"<strong>Filtrar por:</strong> Personaje, ubicaci\xF3n, grupo o solo hitos",tutorialGanttFilterChips:'<strong>Fichas de filtro:</strong> Haz clic en las fichas para eliminar filtros individuales, o "Limpiar todo"',tutorialGanttSwimlanes:"<strong>Carriles:</strong> Agrupa eventos por ubicaci\xF3n, grupo o personaje",tutorialPlotTitle:"Gesti\xF3n de elementos de trama",tutorialPlotManaging:"Gestionar objetos importantes:",tutorialPlotCreate:'<strong>Crear:</strong> Panel de control \u2192 "Crear elemento de trama" o Paleta de comandos \u2192 "Storyteller: Crear nuevo elemento de trama"',tutorialPlotCritical:'<strong>Marcar cr\xEDtico:</strong> Usa la casilla "Cr\xEDtico para la trama" para elementos clave de la historia',tutorialPlotOwnership:"<strong>Rastrear propiedad:</strong> Vincula propietario actual, propietarios anteriores y ubicaci\xF3n",tutorialPlotView:'<strong>Ver todos:</strong> Panel de control \u2192 "Ver elementos de trama" o Paleta de comandos \u2192 "Storyteller: Ver elementos de trama"',tutorialPlotStorage:"Los objetos se almacenan en la carpeta <code>Items/</code>",tutorialGalleryTitle:"Gesti\xF3n de galer\xEDa",tutorialGalleryOrganization:"Organizaci\xF3n de im\xE1genes:",tutorialGalleryAccess:'<strong>Acceder:</strong> Panel de control \u2192 Bot\xF3n "Galer\xEDa" o Paleta de comandos \u2192 "Storyteller: Abrir galer\xEDa"',tutorialGalleryUpload:"<strong>Subir:</strong> Arrastra y suelta im\xE1genes directamente en la galer\xEDa",tutorialGalleryOrganize:"<strong>Organizar:</strong> A\xF1ade etiquetas, categor\xEDas, descripciones a las im\xE1genes",tutorialGalleryLink:"<strong>Vincular:</strong> Referencia f\xE1cilmente im\xE1genes de la galer\xEDa en perfiles de personajes/ubicaciones",tutorialGalleryConfig:"Configura la carpeta de subida a continuaci\xF3n (predeterminado: <code>StorytellerSuite/GalleryUploads</code>)",tutorialGroupsTitle:"Grupos y organizaci\xF3n",tutorialGroupsOrganizing:"Organizar con grupos:",tutorialGroupsCreate:'<strong>Crear grupos:</strong> Paleta de comandos \u2192 "Storyteller: Crear grupo"',tutorialGroupsAdd:"<strong>A\xF1adir miembros:</strong> Personajes, ubicaciones, eventos y objetos pueden agruparse",tutorialGroupsManage:'<strong>Gestionar:</strong> Renombra con "Storyteller: Renombrar grupo", elimina con "Storyteller: Eliminar grupo"',tutorialGroupsUseCases:"<strong>Casos de uso:</strong> Familia real, reinos espec\xEDficos, arcos de trama, etc.",tutorialWorldTitle:"Entidades de construcci\xF3n de mundo",tutorialWorldFive:"Cinco tipos de entidades para construcci\xF3n de mundo completa:",tutorialWorldCultures:"<strong>Culturas:</strong> Nivel tecnol\xF3gico, tipo de gobierno, idiomas, valores, costumbres, estructura social",tutorialWorldFactions:"<strong>Facciones:</strong> Organizaciones con tipo, nivel de poder, colores, lema, objetivos, recursos",tutorialWorldEconomies:"<strong>Econom\xEDas:</strong> Tipo de sistema (trueque, mercado, feudal), industrias, pol\xEDtica comercial",tutorialWorldMagic:"<strong>Sistemas m\xE1gicos:</strong> Tipo (arcano, divino, natural), rareza, nivel de poder, reglas, costos",tutorialWorldCalendars:"<strong>Calendarios:</strong> Tipo de calendario (solar, lunar), configuraci\xF3n de d\xEDas, d\xEDas de la semana",tutorialWorldCreating:"Crear entidades de construcci\xF3n de mundo:",tutorialWorldCommand:'<strong>Paleta de comandos:</strong> "Storyteller: Crear nueva cultura/facci\xF3n/econom\xEDa/sistema m\xE1gico/calendario"',tutorialWorldView:'<strong>Ver todos:</strong> "Storyteller: Ver culturas/facciones/econom\xEDas/sistemas m\xE1gicos/calendarios"',tutorialWorldModals:"Cada entidad tiene ventanas modales dedicadas con campos relevantes",tutorialWorldStorage:"Las entidades se almacenan en sus carpetas respectivas (ej.: <code>Cultures/</code>, <code>Factions/</code>)",tutorialTimelineTitle:"Bifurcaciones de l\xEDnea de tiempo y causalidad",tutorialTimelineAlternate:"L\xEDneas de tiempo alternativas (escenarios qu\xE9 pasar\xEDa si):",tutorialTimelineCreateFork:'<strong>Crear bifurcaci\xF3n:</strong> Paleta de comandos \u2192 "Storyteller: Crear bifurcaci\xF3n de l\xEDnea de tiempo"',tutorialTimelineDivergence:"<strong>Punto de divergencia:</strong> Selecciona el evento donde la l\xEDnea de tiempo se divide",tutorialTimelineForkStatus:"<strong>Estado de bifurcaci\xF3n:</strong> Rastrea como explorando, can\xF3nico, abandonado o fusionado",tutorialTimelineViewForks:"<strong>Ver bifurcaciones:</strong> Usa el men\xFA desplegable selector de bifurcaci\xF3n en la vista de l\xEDnea de tiempo",tutorialTimelineCausality:"Enlaces de causalidad (Causa y efecto):",tutorialTimelineAddLink:'<strong>A\xF1adir enlace:</strong> Paleta de comandos \u2192 "Storyteller: A\xF1adir enlace de causalidad"',tutorialTimelineLinkTypes:"<strong>Tipos de enlace:</strong> Directo, indirecto, condicional o catalizador",tutorialTimelineStrength:"<strong>Niveles de fuerza:</strong> D\xE9bil, moderado, fuerte o absoluto",tutorialTimelineLinksHelp:"Los enlaces ayudan a rastrear c\xF3mo los eventos se influyen entre s\xED",tutorialTimelineConflict:"Detecci\xF3n de conflictos:",tutorialTimelineRunDetection:'<strong>Ejecutar detecci\xF3n:</strong> Paleta de comandos \u2192 "Storyteller: Detectar conflictos de l\xEDnea de tiempo"',tutorialTimelineDetects:"<strong>Detecta:</strong> Conflictos de ubicaci\xF3n (personaje en m\xFAltiples lugares), conflictos de muerte (personajes muertos apareciendo despu\xE9s), violaciones de causalidad (efectos antes de causas)",tutorialTimelineBadge:"<strong>Insignia de conflicto:</strong> Muestra el conteo en la barra de herramientas de l\xEDnea de tiempo - haz clic para revisar",tutorialTimelineActionable:"<strong>Accionable:</strong> Cada conflicto incluye sugerencias para resoluci\xF3n",tutorialTemplatesTitle:"Plantillas de entidades",tutorialTemplatesCreate:"Crear plantillas reutilizables:",tutorialTemplatesSave:"<strong>Guardar como plantilla:</strong> Al editar cualquier entidad, gu\xE1rdala como plantilla reutilizable",tutorialTemplatesLibrary:'<strong>Biblioteca de plantillas:</strong> Paleta de comandos \u2192 "Storyteller: Abrir biblioteca de plantillas de entidades"',tutorialTemplatesDashboard:"<strong>Pesta\xF1a del panel de control:</strong> Accede a plantillas desde la pesta\xF1a Plantillas en el panel de control",tutorialTemplatesBuiltIn:"Plantillas integradas:",tutorialTemplatesArchetypes:"Arquetipos de personajes: Rey medieval, Tabernero, Mentor sabio, Hacker cyberpunk, Detective",tutorialTemplatesMore:"M\xE1s plantillas disponibles para creaci\xF3n r\xE1pida de personajes",tutorialTemplatesFeatures:"Caracter\xEDsticas de plantillas:",tutorialTemplatesBrowse:"<strong>Navegar:</strong> Busca y filtra plantillas por g\xE9nero, categor\xEDa, tipo de entidad",tutorialTemplatesSort:"<strong>Ordenar:</strong> Por nombre, conteo de uso o usado recientemente",tutorialTemplatesUsage:"<strong>Seguimiento de uso:</strong> Ve qu\xE9 plantillas usas con m\xE1s frecuencia",tutorialTemplatesCustomize:"<strong>Personalizar:</strong> Duplica y modifica plantillas para tus necesidades",tutorialDiscoveryTitle:"Descubrimiento e importaci\xF3n de historias",tutorialDiscoveryAutomatic:"Descubrimiento autom\xE1tico:",tutorialDiscoveryDetects:"El complemento detecta autom\xE1ticamente las carpetas <code>StorytellerSuite/Stories/</code> existentes",tutorialDiscoveryManual:'<strong>Actualizar manualmente:</strong> Paleta de comandos \u2192 "Storyteller: Actualizar descubrimiento de historias"',tutorialDiscoveryImport:"Importa carpetas de historias existentes sin perder datos",tutorialDiscoveryUseful:"\xDAtil al mover historias entre b\xF3vedas",tutorialCustomTitle:"Carpetas personalizadas: flujo de trabajo manual recomendado",tutorialCustomSimple:"Configuraci\xF3n simple y confiable para carpetas personalizadas:",tutorialCustomStep1:"<strong>Crea tu carpeta de historia y subcarpetas manualmente</strong> en tu b\xF3veda (ej.: <code>Creative/Writing/Mi_Historia/Characters</code>, <code>Locations</code>, <code>Events</code>, etc.).",tutorialCustomStep2:"En Configuraci\xF3n \u2192 Storyteller Suite \u2192 habilita <strong>Usar carpetas de entidades personalizadas</strong>. Opcionalmente establece una plantilla de <strong>Carpeta ra\xEDz de historia</strong> para conveniencia.",tutorialCustomStep3:'Abre el panel de control y usa <strong>"Crear nueva historia"</strong>. Despu\xE9s de la creaci\xF3n, <strong>actualiza/activa</strong> el panel de control. El complemento reconocer\xE1 tu carpeta de historia manual como la historia activa.',tutorialCustomStep4:"Usa <strong>Vista previa de carpetas resueltas</strong> en la configuraci\xF3n para confirmar las rutas exactas que el complemento usar\xE1.",tutorialCustomSwitching:"Cambiar historias en modo carpeta personalizada: Usa el <em>men\xFA desplegable de historia en la parte superior del panel de control</em> para cambiar la historia activa. Luego ve a <em>Configuraci\xF3n \u2192 Storyteller Suite</em> y <strong>asigna manualmente carpetas por entidad</strong> para esa historia. Lo siento, s\xE9 que esto es un poco complicado.",tutorialShortcutsTitle:"Atajos de teclado y comandos",tutorialShortcutsCore:"Comandos principales (v\xEDa Ctrl/Cmd + P):",tutorialShortcutsOpen:"<strong>Storyteller: Abrir panel de control</strong> - Interfaz principal",tutorialShortcutsNewStory:"<strong>Storyteller: Crear nueva historia</strong> - Iniciar un nuevo proyecto de historia",tutorialShortcutsCreate:"<strong>Storyteller: Crear nuevo personaje/ubicaci\xF3n/evento/elemento de trama</strong>",tutorialShortcutsView:"<strong>Storyteller: Ver personajes/ubicaciones/l\xEDnea de tiempo/elementos de trama</strong>",tutorialShortcutsGallery:"<strong>Storyteller: Abrir galer\xEDa</strong> - Gesti\xF3n de im\xE1genes",tutorialShortcutsGroup:"<strong>Storyteller: Crear/Renombrar/Eliminar grupo</strong> - Organizaci\xF3n",tutorialShortcutsRefresh:"<strong>Storyteller: Actualizar descubrimiento de historias</strong> - Importar carpetas existentes",tutorialShortcutsWorld:"Comandos de construcci\xF3n de mundo:",tutorialShortcutsWorldCreate:"<strong>Storyteller: Crear nueva cultura/facci\xF3n/econom\xEDa/sistema m\xE1gico/calendario</strong>",tutorialShortcutsWorldView:"<strong>Storyteller: Ver culturas/facciones/econom\xEDas/sistemas m\xE1gicos/calendarios</strong>",tutorialShortcutsTimeline:"Comandos de l\xEDnea de tiempo y causalidad:",tutorialShortcutsTimelineFork:"<strong>Storyteller: Crear bifurcaci\xF3n de l\xEDnea de tiempo</strong> - Crear l\xEDnea de tiempo alternativa",tutorialShortcutsTimelineViewForks:"<strong>Storyteller: Ver bifurcaciones de l\xEDnea de tiempo</strong> - Listar todas las bifurcaciones",tutorialShortcutsTimelineLink:"<strong>Storyteller: A\xF1adir enlace de causalidad</strong> - Vincular eventos de causa y efecto",tutorialShortcutsTimelineViewLinks:"<strong>Storyteller: Ver enlaces de causalidad</strong> - Listar todas las relaciones causales",tutorialShortcutsTimelineDetect:"<strong>Storyteller: Detectar conflictos de l\xEDnea de tiempo</strong> - Encontrar inconsistencias",tutorialShortcutsTimelineViewConflicts:"<strong>Storyteller: Ver conflictos de l\xEDnea de tiempo</strong> - Revisar conflictos existentes",tutorialShortcutsTemplate:"Comandos de plantillas:",tutorialShortcutsTemplateLibrary:"<strong>Storyteller: Abrir biblioteca de plantillas de entidades</strong> - Navegar y gestionar plantillas",tutorialShortcutsTip:"Consejo: \xA1Puedes asignar atajos personalizados a cualquiera de estos comandos en la configuraci\xF3n de Atajos de Obsidian!",tutorialFileTitle:"Estructura de archivos e integraci\xF3n",tutorialFileOrganized:"C\xF3mo est\xE1n organizados tus archivos:",tutorialFileDefault:"Predeterminado (m\xFAltiples historias):",tutorialFileOneMode:"Modo una sola historia (aplanado):",tutorialFileIntegration:"Integraci\xF3n Obsidian:",tutorialFileMarkdown:"Todos los datos almacenados como <strong>archivos markdown</strong> con frontmatter",tutorialFileDataview:"Totalmente compatible con el <strong>complemento Dataview</strong> para consultas personalizadas",tutorialFileWikiLinks:"Usa <strong>[[enlaces wiki]]</strong> para conectar personajes, ubicaciones, eventos",tutorialFileReadable:"Los archivos son <strong>legibles y editables</strong> incluso sin el complemento",tutorialFileBackup:"<strong>Seguro para respaldo:</strong> Tus datos nunca est\xE1n bloqueados en un formato propietario",tutorialFileTip:"Consejo: Configura estos modos en Configuraci\xF3n \u2192 Storyteller Suite bajo <em>Usar carpetas de entidades personalizadas</em> y <em>Modo una sola historia</em>. El bot\xF3n <em>Nueva historia</em> est\xE1 oculto autom\xE1ticamente en Modo una sola historia."}});var MI,LI=_e(()=>{MI={dashboardTitle:"Suite Storyteller",openDashboard:"Ouvrir le tableau de bord",createNew:"Cr\xE9er nouveau",uploadImage:"T\xE9l\xE9charger une image",image:"Image",storyCreated:'Histoire "{0}" cr\xE9\xE9e et activ\xE9e.',created:'{0} "{1}" cr\xE9\xE9(e).',updated:'{0} "{1}" mis(e) \xE0 jour.',movedToTrash:'{0} "{1}" d\xE9plac\xE9(e) dans la corbeille.',imageUploaded:"Image t\xE9l\xE9charg\xE9e : {0}",errorUploadingImage:"Erreur lors du t\xE9l\xE9chargement de l'image. Veuillez r\xE9essayer.",noteCreatedWithSections:"Note cr\xE9\xE9e avec des sections standard pour faciliter l'\xE9dition.",workspaceLeafCreateError:"Erreur lors de l'ouverture du tableau de bord : Impossible de cr\xE9er une feuille de l'espace de travail.",workspaceLeafRevealError:"Erreur lors de l'affichage du tableau de bord : Feuille de l'espace de travail introuvable.",errorCannotDeleteWithoutFilePath:"Erreur : Impossible de supprimer {0} sans chemin de fichier.",errorCannotOpenNoteWithoutFilePath:"Erreur : Impossible d'ouvrir la note {0} sans chemin de fichier.",remoteImagesBlocked:"Les images distantes sont bloqu\xE9es par les param\xE8tres. Importez l'image dans votre galerie pour l'utiliser en toute s\xE9curit\xE9.",importImage:"Importer une image",language:"Langue",selectLanguage:"S\xE9lectionner la langue",english:"Anglais",chinese:"Chinois (\u4E2D\u6587)",languageChanged:"Langue modifi\xE9e. Rechargez le plugin pour que les changements prennent effet.",name:"Nom",description:"Description",backstory:"Histoire de fond",history:"Historique",location:"Lieu",character:"Personnage",event:"\xC9v\xE9nement",item:"Objet",reference:"R\xE9f\xE9rence",chapter:"Chapitre",scene:"Sc\xE8ne",group:"Groupe",characters:"Personnages",locations:"Lieux",events:"\xC9v\xE9nements",items:"Objets",references:"R\xE9f\xE9rences",chapters:"Chapitres",scenes:"Sc\xE8nes",groups:"Groupes",gallery:"Galerie",timeline:"Chronologie",create:"Cr\xE9er",edit:"Modifier",delete:"Supprimer",save:"Enregistrer",cancel:"Annuler",view:"Voir",upload:"T\xE9l\xE9charger",import:"Importer",export:"Exporter",refresh:"Actualiser",createNewCharacter:"Cr\xE9er un nouveau personnage",editCharacter:"Modifier le personnage",createNewLocation:"Cr\xE9er un nouveau lieu",editLocation:"Modifier le lieu",createNewEvent:"Cr\xE9er un nouvel \xE9v\xE9nement",editEvent:"Modifier l'\xE9v\xE9nement",createNewItem:"Cr\xE9er un nouvel objet",editItem:"Modifier l'objet",createNewReference:"Cr\xE9er une nouvelle r\xE9f\xE9rence",editReference:"Modifier la r\xE9f\xE9rence",createNewChapter:"Cr\xE9er un nouveau chapitre",editChapter:"Modifier le chapitre",createNewScene:"Cr\xE9er une nouvelle sc\xE8ne",editScene:"Modifier la sc\xE8ne",createNewGroup:"Cr\xE9er un nouveau groupe",editGroup:"Modifier le groupe",tags:"\xC9tiquettes",summary:"R\xE9sum\xE9",content:"Contenu",number:"Num\xE9ro",orderingNumber:"Num\xE9ro d'ordre (optionnel)",category:"Cat\xE9gorie",createCharacter:"Cr\xE9er un personnage",createLocation:"Cr\xE9er un lieu",createEvent:"Cr\xE9er un \xE9v\xE9nement",createItem:"Cr\xE9er un objet",createReference:"Cr\xE9er une r\xE9f\xE9rence",createChapter:"Cr\xE9er un chapitre",createScene:"Cr\xE9er une sc\xE8ne",createGroup:"Cr\xE9er un groupe",saveChanges:"Enregistrer les modifications",deleteCharacter:"Supprimer le personnage",deleteLocation:"Supprimer le lieu",deleteEvent:"Supprimer l'\xE9v\xE9nement",deleteItem:"Supprimer l'objet",deleteReference:"Supprimer la r\xE9f\xE9rence",deleteChapter:"Supprimer le chapitre",deleteScene:"Supprimer la sc\xE8ne",deleteGroup:"Supprimer le groupe",add:"Ajouter",clear:"Effacer",ok:"OK",confirm:"Confirmer",selectBtn:"S\xE9lectionner",previewBtn:"Aper\xE7u",editBtn:"Modifier",openNoteBtn:"Ouvrir la note",flattenCustomFields:"Aplatir vers les cl\xE9s natives (recommand\xE9)",nestedCustomFields:"Imbriqu\xE9 sous customFields (carte YAML)",noGrouping:"Aucun regroupement",byLocation:"Par lieu",byGroup:"Par groupe",noneOption:"Aucun",fitOption:"Ajuster",decadeOption:"D\xE9cennie",centuryOption:"Si\xE8cle",customFoldersPlaceholderWarning:'Les dossiers personnalis\xE9s utilisent des espaces r\xE9serv\xE9s {story*}. S\xE9lectionnez ou cr\xE9ez une histoire active, puis cliquez sur "Rescanner les dossiers personnalis\xE9s".',openNote:"Ouvrir la note",createGroupBtn:"Cr\xE9er un groupe",createChapterBtn:"Cr\xE9er un chapitre",createSceneBtn:"Cr\xE9er une sc\xE8ne",createReferenceBtn:"Cr\xE9er une r\xE9f\xE9rence",viewCharacters:"Voir les personnages",viewLocations:"Voir les lieux",viewEvents:"Voir les \xE9v\xE9nements",viewItems:"Voir les objets",viewReferences:"Voir les r\xE9f\xE9rences",viewChapters:"Voir les chapitres",viewScenes:"Voir les sc\xE8nes",viewGroups:"Voir les groupes",viewTimeline:"Voir la chronologie",openTimelinePanel:"Ouvrir le panneau de chronologie",viewGallery:"Voir la galerie",selectOrCreateStoryFirst:"S\xE9lectionnez ou cr\xE9ez d'abord une histoire.",selectGroupPlaceholder:"-- S\xE9lectionner un groupe --",affiliation:"Affiliation",groupsHelpCharacter:"Assignez ce personnage \xE0 un ou plusieurs groupes.",members:"Membres",noCustomFields:"Aucun champ personnalis\xE9 d\xE9fini.",selectFromGallery:"S\xE9lectionner dans la galerie",clearImage:"Effacer l'image",addImage:"Ajouter une image",imageGallery:"Galerie d'images",filter:"Filtrer",search:"Rechercher",storyName:"Nom de l'histoire",createNewStory:"Cr\xE9er une nouvelle histoire",plotItems:"\xC9l\xE9ments de l'intrigue",title:"Titre",caption:"L\xE9gende",fit:"Ajuster",decade:"D\xE9cennie",century:"Si\xE8cle",today:"Aujourd'hui",copyRange:"Copier la plage",stackItems:"Empiler les \xE9l\xE9ments",goToChapter:"Aller au chapitre",unassigned:"Non assign\xE9",chapterTitlePh:"Titre du chapitre",sceneTitlePh:"Titre de la sc\xE8ne",numberEg:"ex. : 1",tagsPh:"tag1, tag2",briefChapterSummaryPh:"R\xE9sum\xE9 bref pour ce chapitre...",writeYourScenePh:"\xC9crivez votre sc\xE8ne...",beatSheet:"Feuille de rythme (une par ligne)",beatSheetExample:"- Rencontrer le mentor\\n- Le refus",stories:"Histoires",active:"Actif",setActive:"D\xE9finir comme actif",editStory:"Modifier l'histoire",storyDiscovery:"D\xE9couverte d'histoires",refreshDiscovery:"Actualiser la d\xE9couverte",galleryUploadFolder:"Dossier de t\xE9l\xE9chargement de la galerie",timelineAndParsing:"Chronologie et analyse",customFieldsSerialization:"S\xE9rialisation des champs personnalis\xE9s",forwardDateBias:"Biais de date future pour l'analyse du langage naturel",customToday:"Aujourd'hui personnalis\xE9 (r\xE9f\xE9rence de chronologie)",defaultTimelineGrouping:"Regroupement de chronologie par d\xE9faut",defaultZoomPreset:"Pr\xE9r\xE9glage de zoom par d\xE9faut",defaultStacking:"Empilement par d\xE9faut",defaultDensity:"Densit\xE9 par d\xE9faut",showLegendByDefault:"Afficher la l\xE9gende par d\xE9faut",timelineDefaultHeight:"Hauteur par d\xE9faut de la chronologie",useCustomEntityFolders:"Utiliser des dossiers d'entit\xE9s personnalis\xE9s",previewResolvedFolders:"Aper\xE7u des dossiers r\xE9solus",storyRootFolderOptional:"Dossier racine de l'histoire (optionnel)",charactersFolder:"Dossier des personnages",locationsFolder:"Dossier des lieux",eventsFolder:"Dossier des \xE9v\xE9nements",itemsFolder:"Dossier des objets",referencesFolder:"Dossier des r\xE9f\xE9rences",scenesFolder:"Dossier des sc\xE8nes",chaptersFolder:"Dossier des chapitres",oneStoryMode:"Mode une seule histoire",oneStoryBaseFolder:"Dossier de base d'une seule histoire",showTutorialSection:"Afficher la section tutoriel",support:"Support",supportDevelopment:"Soutenir le d\xE9veloppement",about:"\xC0 propos",pluginInformation:"Informations sur le plugin",buyMeACoffee:"Offrez-moi un caf\xE9",github:"GitHub",preview:"Aper\xE7u",clearCustomToday:"Effacer l'aujourd'hui personnalis\xE9",enterCharacterName:"Entrez le nom du personnage",characterDescriptionPh:"Une br\xE8ve description du personnage...",traitsPlaceholder:"ex. : Courageux, Curieux, T\xEAtu",characterHistoryPh:"L'historique du personnage...",statusPlaceholderCharacter:"ex. : Vivant, D\xE9c\xE9d\xE9, Disparu",enterItemName:"Entrez le nom de l'objet",itemDescriptionPh:"Une description visuelle de l'objet...",itemHistoryPh:"L'origine, le pass\xE9 et l'importance de l'objet...",enterLocationName:"Entrez le nom du lieu",locationDescriptionPh:"Une br\xE8ve description du lieu...",locationHistoryPh:"L'historique du lieu et les \xE9v\xE9nements pass\xE9s...",statusPlaceholderLocation:"ex. : Actif, Ruines, Abandonn\xE9",enterEventName:"Entrez le nom de l'\xE9v\xE9nement",eventDescriptionPh:"Une description de l'\xE9v\xE9nement...",eventOutcomePh:"Le r\xE9sultat ou les cons\xE9quences de l'\xE9v\xE9nement...",enterDateTime:"Entrez la date/heure",statusPlaceholderEvent:"ex. : \xC0 venir, Termin\xE9, En cours, point cl\xE9 de l'intrigue",dateTime:"Date/heure",outcome:"R\xE9sultat",status:"Statut",charactersInvolved:"Personnages impliqu\xE9s",associatedImages:"Images associ\xE9es",links:"Liens",relationships:"Relations et lieu",currentOwner:"Propri\xE9taire actuel",currentLocation:"Lieu actuel",plotCritical:"Critique pour l'intrigue",traits:"Traits",profileImage:"Image de profil",itemImage:"Image de l'objet",selectOwner:"S\xE9lectionner le propri\xE9taire",selectLocation:"S\xE9lectionner le lieu",changeLocation:"Changer de lieu",clearLocation:"Effacer le lieu (d\xE9finir sur aucun)",parentLocation:"Lieu parent",selectParentLocation:"S\xE9lectionner le lieu parent",clearParentLocation:"Effacer le lieu parent",addCharacter:"Ajouter un personnage",addCustomField:"Ajouter un champ personnalis\xE9",fieldName:"Nom du champ",fieldValue:"Valeur du champ",customFieldValueTitle:"Valeur du champ personnalis\xE9",newCustomFieldTitle:"Nouveau champ personnalis\xE9",valueForX:'Valeur pour "{0}"',fieldNameCannotBeEmpty:"Le nom du champ ne peut pas \xEAtre vide",thatNameIsReserved:"Ce nom est r\xE9serv\xE9",fieldAlreadyExists:"Un champ avec ce nom existe d\xE9j\xE0",characterNameRequired:"Le nom du personnage ne peut pas \xEAtre vide.",eventNameRequired:"Le nom de l'\xE9v\xE9nement ne peut pas \xEAtre vide.",itemNameRequired:"Le nom de l'objet ne peut pas \xEAtre vide.",customFields:"Champs personnalis\xE9s",select:"S\xE9lectionner",current:"Actuel",none:"Aucun",removeX:"Supprimer {0}",removeFieldX:'Supprimer le champ "{0}"',filterX:"Filtrer {0}",searchX:"Rechercher {0}...",networkGraph:"Graphe de r\xE9seau",relationshipType:"Type de relation",relationshipTypes:"Types de relations",relationshipTypeDesc:"Choisissez le type de relation",relationshipLabelDesc:"Libell\xE9 personnalis\xE9 optionnel pour cette relation",exampleRelationshipLabel:"ex. : Meilleur ami, Fr\xE8re/S\u0153ur, Partenaire commercial",addRelationship:"Ajouter une relation",editRelationship:"Modifier la relation",targetEntity:"Entit\xE9 cible",pleaseSelectTarget:"Veuillez s\xE9lectionner une entit\xE9 cible",ally:"Alli\xE9",enemy:"Ennemi",family:"Famille",rival:"Rival",romantic:"Romantique",mentor:"Mentor",acquaintance:"Connaissance",neutral:"Neutre",custom:"Personnalis\xE9",filterByGroup:"Filtrer par groupe",filterByTimeline:"Filtrer par chronologie",filterByEntityTypes:"Filtrer par types d'entit\xE9s",exportGraph:"Exporter le graphe",toggleEdgeLabels:"Basculer les libell\xE9s des ar\xEAtes",showLegend:"Afficher la l\xE9gende",legend:"L\xE9gende",noRelationshipsFound:"Aucune relation trouv\xE9e. Ajoutez des connexions entre les entit\xE9s pour les visualiser dans le graphe de r\xE9seau.",storyBoard:"Tableau de bord de l'histoire",createStoryBoard:"Cr\xE9er le tableau de bord de l'histoire",updateStoryBoard:"Mettre \xE0 jour le tableau de bord de l'histoire",openStoryBoard:"Ouvrir le tableau de bord de l'histoire",storyBoardCreated:"Tableau de bord de l'histoire cr\xE9\xE9 !",storyBoardUpdated:"Tableau de bord de l'histoire mis \xE0 jour !",storyBoardUpdatedPreserved:"Tableau de bord de l'histoire mis \xE0 jour ! Modifications manuelles pr\xE9serv\xE9es.",overwriteStoryBoard:"\xC9craser le tableau de bord de l'histoire ?",createStoryBoardPrompt:"Cr\xE9er le tableau de bord de l'histoire ?",createStoryBoardMessage:"Aucun tableau de bord de l'histoire trouv\xE9. Souhaitez-vous en cr\xE9er un ?",storyBoardExistsMessage:"Un tableau de bord de l'histoire existe d\xE9j\xE0. Voulez-vous l'\xE9craser ?",noScenesForStoryBoard:"Aucune sc\xE8ne trouv\xE9e. Cr\xE9ez d'abord des sc\xE8nes !",noStoryBoardFound:`Aucun tableau de bord de l'histoire trouv\xE9. Cr\xE9ez-en d'abord un en utilisant "Cr\xE9er le tableau de bord de l'histoire".`,errorOpeningStoryBoard:"Erreur lors de l'ouverture du tableau de bord de l'histoire. Consultez la console pour plus de d\xE9tails.",storyBoardEmpty:"Aucune sc\xE8ne trouv\xE9e. Le tableau de bord de l'histoire sera vide.",errorReadingStoryBoard:"Erreur lors de la lecture du tableau de bord de l'histoire existant. Il peut \xEAtre corrompu.",errorUpdatingStoryBoard:"Erreur lors de la mise \xE0 jour du tableau de bord de l'histoire. Consultez la console pour plus de d\xE9tails.",storyBoardLayout:"Disposition du tableau de bord de l'histoire",storyBoardLayoutDesc:"Choisissez comment organiser les sc\xE8nes sur le canevas",layoutByChapters:"Par chapitres",layoutByTimeline:"Par chronologie",layoutByStatus:"Par statut (Kanban)",storyBoardColorBy:"Colorer les sc\xE8nes par",storyBoardColorByDesc:"Choisissez ce qui d\xE9termine les couleurs des cartes de sc\xE8ne",colorByStatus:"Statut (Brouillon, En cours, etc.)",colorByChapter:"Chapitre",colorByNone:"Aucun",storyBoardShowEdges:"Afficher les fl\xE8ches de flux des sc\xE8nes",storyBoardShowEdgesDesc:"Afficher les fl\xE8ches reliant les sc\xE8nes en s\xE9quence",storyBoardCardSize:"Taille de la carte",storyBoardCardWidth:"Largeur de la carte",storyBoardCardHeight:"Hauteur de la carte",graphFilters:"Filtres du graphe",timelineStart:"D\xE9but de la chronologie",timelineEnd:"Fin de la chronologie",selectEntityTypes:"S\xE9lectionner les types d'entit\xE9s",applyFilters:"Appliquer les filtres",resetFilters:"R\xE9initialiser les filtres",exportAsPNG:"Exporter en PNG",exportAsJPG:"Exporter en JPG",graphExported:"Graphe export\xE9.",connections:"Connexions",searchEntities:"Rechercher des entit\xE9s...",zoomIn:"Zoom avant",zoomOut:"Zoom arri\xE8re",fitToView:"Ajuster \xE0 la vue",layout:"Disposition",forceDirected:"Dirig\xE9 par force",circle:"Cercle",grid:"Grille",concentric:"Concentrique",nodeTypes:"Types de n\u0153uds",interactions:"Interactions",addConnection:"Ajouter une connexion",noConnectionsYet:"Aucune connexion pour le moment.",label:"Libell\xE9",optional:"(Optionnel)",all:"Tous",milestone:"Jalon",milestoneDesc:"Marquer cet \xE9v\xE9nement comme un moment cl\xE9 de l'histoire",progress:"Progression",progressDesc:"Pourcentage d'ach\xE8vement (0-100)",dependencies:"D\xE9pendances",dependenciesDesc:"\xC9v\xE9nements qui doivent se produire avant celui-ci",addDependency:"Ajouter une d\xE9pendance",editMode:"Mode \xE9dition",lockMode:"Mode verrouillage",editModeTooltip:"Mode \xE9dition (glisser pour reprogrammer)",filters:"Filtres",milestonesOnly:"Jalons uniquement",milestonesOnlyDesc:"Afficher uniquement les \xE9v\xE9nements jalons",filterByCharacter:"Filtrer par personnage",filterByLocation:"Filtrer par lieu",clearAllFilters:"Effacer tous les filtres",selectCharacterFilter:"S\xE9lectionner un personnage...",selectLocationFilter:"S\xE9lectionner un lieu...",selectGroupFilter:"S\xE9lectionner un groupe...",characterFilter:"Personnage :",locationFilter:"Lieu :",groupFilter:"Groupe :",eventRescheduled:'\xC9v\xE9nement "{0}" reprogramm\xE9',editModeEnabled:"Mode \xE9dition activ\xE9 - glissez les \xE9v\xE9nements pour les reprogrammer",editModeDisabled:"Mode \xE9dition d\xE9sactiv\xE9",dependencyAdded:'D\xE9pendance "{0}" d\xE9j\xE0 ajout\xE9e',byCharacter:"Par personnage",ganttView:"Vue Gantt",timelineView:"Vue chronologie",switchedToGantt:"Pass\xE9 \xE0 la vue Gantt",switchedToTimeline:"Pass\xE9 \xE0 la vue chronologie",entityTypes:"Types d'entit\xE9s",openInPanel:"Ouvrir dans un panneau",openInModal:"Ouvrir dans une fen\xEAtre modale",close:"Fermer",manageTimelineEras:"G\xE9rer les \xE8res et p\xE9riodes de la chronologie",addEra:"Ajouter une \xE8re",eraType:"Type d'\xE8re",startDate:"Date de d\xE9but",endDate:"Date de fin",eraColor:"Couleur de l'\xE8re",manageTimelineTracks:"G\xE9rer les pistes de la chronologie",addTrack:"Ajouter une piste",trackType:"Type de piste",trackColor:"Couleur de la piste",newStory:"+ Nouvelle histoire",noCharactersFound:'Aucun personnage trouv\xE9. Cliquez sur "Cr\xE9er nouveau" pour ajouter votre premier personnage.',noLocationsFound:"Aucun lieu trouv\xE9.",noEventsFound:"Aucun \xE9v\xE9nement trouv\xE9.",noItemsFound:"Aucun objet trouv\xE9.",noImagesFound:"Aucune image trouv\xE9e.",noGroupsFound:"Aucun groupe trouv\xE9.",noReferencesFound:"Aucune r\xE9f\xE9rence trouv\xE9e.",noChaptersFound:"Aucun chapitre trouv\xE9.",noScenesFound:"Aucune sc\xE8ne trouv\xE9e.",matchingFilter:" Correspond au filtre.",filterItems:"Filtrer les objets",filterGroups:"Filtrer les groupes",noMembers:"Aucun membre.",enterGroupName:"Entrez le nom du groupe",describeGroupPh:"D\xE9crivez ce groupe...",color:"Couleur",colorPlaceholder:"#RRGGBB ou nom de couleur",groupNameRequired:"Le nom du groupe est requis.",groupNameExists:"Un groupe avec ce nom existe d\xE9j\xE0. Veuillez choisir un nom diff\xE9rent.",addImageDetails:"Ajouter les d\xE9tails de l'image",editImageDetails:"Modifier les d\xE9tails de l'image",commaSeparatedTags:"\xC9tiquettes s\xE9par\xE9es par des virgules.",commaSeparatedCharacterNames:"Noms de personnages s\xE9par\xE9s par des virgules.",commaSeparatedLocationNames:"Noms de lieux s\xE9par\xE9s par des virgules.",commaSeparatedEventNames:"Noms d'\xE9v\xE9nements s\xE9par\xE9s par des virgules.",saveDetails:"Enregistrer les d\xE9tails",removeFromGallery:"Retirer de la galerie",imageDetailsSaved:`D\xE9tails de l'image pour "{0}" enregistr\xE9s.`,imageRemovedFromGallery:'Image "{0}" retir\xE9e de la galerie.',confirmDeleteScene:'Supprimer la sc\xE8ne "{0}" ?',confirmDeleteReference:'Supprimer la r\xE9f\xE9rence "{0}" ?',confirmDeleteChapter:'Supprimer le chapitre "{0}" ?',confirmDeleteGroup:'\xCAtes-vous s\xFBr de vouloir supprimer le groupe "{0}" ?',confirmDeleteCharacter:'\xCAtes-vous s\xFBr de vouloir supprimer "{0}" ?',confirmDeleteEvent:`\xCAtes-vous s\xFBr de vouloir supprimer l'\xE9v\xE9nement "{0}" ? Cela d\xE9placera la note dans la corbeille syst\xE8me.`,confirmDeleteLocation:'\xCAtes-vous s\xFBr de vouloir supprimer "{0}" ?',confirmDeleteItem:'\xCAtes-vous s\xFBr de vouloir supprimer "{0}" ?',confirmDeleteStory:`Supprimer l'histoire "{0}" ? Cette action ne peut pas \xEAtre annul\xE9e.`,confirmRemoveImageFromGallery:'\xCAtes-vous s\xFBr de vouloir retirer "{0}" de la galerie ? Cela ne supprime pas le fichier lui-m\xEAme.',confirmDeleteCharacterTrash:'\xCAtes-vous s\xFBr de vouloir supprimer "{0}" ? Cela d\xE9placera le fichier dans la corbeille syst\xE8me.',confirmDeleteItemTrash:'\xCAtes-vous s\xFBr de vouloir supprimer "{0}" ? Cela d\xE9placera le fichier dans la corbeille syst\xE8me.',sceneCreated:'Sc\xE8ne "{0}" cr\xE9\xE9e.',sceneUpdated:'Sc\xE8ne "{0}" mise \xE0 jour.',chapterCreated:'Chapitre "{0}" cr\xE9\xE9.',chapterUpdated:'Chapitre "{0}" mis \xE0 jour.',referenceCreated:'R\xE9f\xE9rence "{0}" cr\xE9\xE9e.',referenceUpdated:'R\xE9f\xE9rence "{0}" mise \xE0 jour.',groupCreated:'Groupe "{0}" cr\xE9\xE9.',groupRenamed:'Groupe renomm\xE9 en "{0}".',groupDeleted:'Groupe "{0}" supprim\xE9.',characterDeleted:'Personnage "{0}" supprim\xE9.',locationDeleted:'Lieu "{0}" supprim\xE9.',itemDeleted:'Objet "{0}" supprim\xE9.',fileMovedToTrash:"Fichier {0} d\xE9plac\xE9 dans la corbeille.",characterLinkedAlready:'Le personnage "{0}" est d\xE9j\xE0 li\xE9.',failedToDelete:"\xC9chec de la suppression de {0}.",failedToSave:"\xC9chec de l'enregistrement de {0}.",customFieldError:"Le nom du champ personnalis\xE9 doit \xEAtre unique, non vide et non r\xE9serv\xE9.",sceneNameRequired:"Le titre de la sc\xE8ne est requis.",chapterNameRequired:"Le titre du chapitre est requis.",locationNameRequired:"Le nom du lieu ne peut pas \xEAtre vide.",circularLocationError:"Impossible de d\xE9finir le lieu parent : cela cr\xE9erait une r\xE9f\xE9rence circulaire.",errorLoadingCharacters:"Erreur lors du chargement des personnages. V\xE9rifiez la console.",errorLoadingLocations:"Erreur lors du chargement des lieux. V\xE9rifiez la console.",errorLoadingEvents:"Erreur lors du chargement des \xE9v\xE9nements. V\xE9rifiez la console.",errorLoadingItems:"Erreur lors du chargement des objets. V\xE9rifiez la console.",groupNotFound:"Groupe introuvable.",noGroupsToRename:"Aucun groupe \xE0 renommer.",noGroupsToDelete:"Aucun groupe \xE0 supprimer.",couldNotFindNote:"Impossible de trouver le fichier de note.",autoDetectedStories:"Storyteller : {0} nouveau(x) dossier(s) d'histoire d\xE9tect\xE9(s) et import\xE9(s) automatiquement.",errorDiscoveringStories:"Storyteller Suite : Erreur lors de la d\xE9couverte d'histoires : {0}",storiesRefreshed:"Storyteller : {0} nouveau(x) dossier(s) d'histoire trouv\xE9(s) et import\xE9(s).",noNewStoriesFound:"Storyteller : Aucun nouveau dossier d'histoire trouv\xE9.",errorRefreshingStories:"Storyteller Suite : Erreur lors de l'actualisation des histoires : {0}",errorScanningFolders:"Storyteller Suite : Erreur lors du balayage des dossiers personnalis\xE9s : {0}",couldNotAutoDetect:"Storyteller : Impossible de d\xE9tecter automatiquement une racine d'histoire. Veuillez d\xE9finir les dossiers manuellement.",autoDetectedFolders:'Storyteller : Dossiers personnalis\xE9s d\xE9tect\xE9s automatiquement sous "{0}" (correspondances : {1}).',uploadedToVault:'"{0}" t\xE9l\xE9charg\xE9 dans le coffre.',errorUploadingFile:"Erreur lors du t\xE9l\xE9chargement du fichier. V\xE9rifiez la console pour plus de d\xE9tails.",errorParsingFile:"Erreur lors de l'analyse du fichier : {0}",currentValue:"Actuel : {0}",ownerValue:"Propri\xE9taire : {0}",noImagesFoundFilter:"Aucune image trouv\xE9e. Correspond au filtre.",tutorialGettingStarted:"Tutoriel et prise en main",type:"Type",region:"R\xE9gion",storyNameField:"Nom de l'histoire",descriptionField:"Description",beatSheetPh:`- Rencontrer le mentor
- Le refus`,categoryPh:"Langue, Proph\xE9tie, Inspiration, Divers, ...",fieldNamePh:"Nom du champ",fieldValuePh:"Valeur du champ",galleryUploadFolderPh:"StorytellerSuite/GalleryUploads",customTodayPh:"AAAA-MM-JJ ou ISO complet (prend en charge les dates AEC)",timelineHeightPh:"ex. : 380px",storyRootFolderPh:"Creative/Writing/{storyName}",charactersFolderPh:"MyStory/Characters",locationsFolderPh:"MyStory/Locations",eventsFolderPh:"MyStory/Events",itemsFolderPh:"MyStory/Items",referencesFolderPh:"MyStory/References",scenesFolderPh:"MyStory/Scenes",chaptersFolderPh:"MyStory/Chapters",oneStoryBaseFolderPh:"StorytellerSuite",enterStoryNamePh:"Entrez le nom de l'histoire",describeStoryPh:"D\xE9crivez votre histoire (optionnel)",selectImageFilePh:"S\xE9lectionnez un fichier image...",filterImagesPh:"Filtrer par titre, \xE9tiquette, lien...",selectItemPh:"S\xE9lectionnez un objet \xE0 lier...",selectEventLocationPh:"S\xE9lectionnez le lieu de l'\xE9v\xE9nement...",selectParentLocationPh:"S\xE9lectionnez un lieu parent...",selectGroupPh:"S\xE9lectionnez un groupe\u2026",filterFoldersPh:"Tapez pour filtrer les dossiers\u2026",selectGalleryImagePh:"S\xE9lectionnez une image de la galerie...",selectEventPh:"S\xE9lectionnez un \xE9v\xE9nement \xE0 lier...",selectCharacterPh:"S\xE9lectionnez un personnage \xE0 lier...",priorityInChapter:"Priorit\xE9 dans le chapitre",priorityEg:"ex. : 1",beatSheetOneLine:"Feuille de rythme une ligne",writeScenePh:"\xC9crivez votre sc\xE8ne...",scanVaultDesc:"Scannez votre coffre pour les histoires Storyteller existantes et importez-les. Utile apr\xE8s avoir d\xE9plac\xE9 des dossiers ou chang\xE9 la structure.",galleryFolderDesc:"Dossier o\xF9 les images de la galerie t\xE9l\xE9charg\xE9es seront stock\xE9es",customFieldsDesc:"Choisissez comment les champs personnalis\xE9s sont stock\xE9s dans le frontmatter",forwardDateBiasDesc:`Pr\xE9f\xE9rer l'interpr\xE9tation future pour les dates relatives (ex. : "Vendredi")`,customTodayDesc:"Date optionnelle utilis\xE9e pour le bouton Aujourd'hui et l'analyse relative. Prend en charge les dates AEC (ex. : 2024-01-15 pour EC, ou -00499-01-01 pour 500 AEC). Laissez vide pour utiliser l'aujourd'hui syst\xE8me.",timelineHeightDesc:"Ajuster la hauteur de la fen\xEAtre modale de chronologie",useCustomFoldersDesc:"Lorsqu'il est activ\xE9, utilisez les chemins de dossiers ci-dessous. Vous pouvez inclure {storyName}, {storySlug} ou {storyId} pour cr\xE9er des dossiers par histoire (ex. : Creative/Writing/{storyName}/Characters).",previewFoldersDesc:"Voir le chemin de dossier r\xE9solu de chaque entit\xE9 bas\xE9 sur les param\xE8tres actuels et l'histoire active",storyRootDesc:"Mod\xE8le de chemin de base pour toutes les entit\xE9s. Prend en charge {storyName}, {storySlug}, {storyId}. Exemple : Creative/Writing/{storyName}",charactersFolderDesc:"Chemin pour les fichiers markdown des personnages (espaces r\xE9serv\xE9s autoris\xE9s : {storyName}, {storySlug}, {storyId})",locationsFolderDesc:"Chemin pour les fichiers markdown des lieux (espaces r\xE9serv\xE9s autoris\xE9s : {storyName}, {storySlug}, {storyId})",eventsFolderDesc:"Chemin pour les fichiers markdown des \xE9v\xE9nements (espaces r\xE9serv\xE9s autoris\xE9s : {storyName}, {storySlug}, {storyId})",itemsFolderDesc:"Chemin pour les fichiers markdown des objets (espaces r\xE9serv\xE9s autoris\xE9s : {storyName}, {storySlug}, {storyId})",referencesFolderDesc:"Chemin pour les fichiers markdown des r\xE9f\xE9rences (espaces r\xE9serv\xE9s autoris\xE9s : {storyName}, {storySlug}, {storyId})",scenesFolderDesc:"Chemin pour les fichiers markdown des sc\xE8nes (espaces r\xE9serv\xE9s autoris\xE9s : {storyName}, {storySlug}, {storyId})",chaptersFolderDesc:"Chemin pour les fichiers markdown des chapitres (espaces r\xE9serv\xE9s autoris\xE9s : {storyName}, {storySlug}, {storyId})",oneStoryModeDesc:"Aplatir la structure des dossiers en une seule histoire. Lorsqu'il est activ\xE9 (et les dossiers personnalis\xE9s d\xE9sactiv\xE9s), le contenu va sous un seul dossier de base sans Stories/StoryName.",oneStoryBaseFolderDesc:"Dossier de base pour Characters/Locations/Events/Items/References/Chapters",showTutorialDesc:"Afficher la section tutoriel et prise en main dans les param\xE8tres",supportDevDesc:"Si vous trouvez ce plugin utile, envisagez de soutenir son d\xE9veloppement",pluginInfoDesc:"Storyteller Suite - Une suite compl\xE8te pour g\xE9rer les personnages, les lieux, les \xE9v\xE9nements et les galeries pour vos histoires.",storyNameDesc:"Requis. Doit \xEAtre unique.",descriptionOptionalDesc:"Optionnel",locationNameDesc:"Le nom du lieu.",locationTypeDesc:"ex. : Ville, For\xEAt, Ch\xE2teau, Taverne",locationRegionDesc:"Zone g\xE9ographique plus large.",locationStatusDesc:"ex. : Actif, Ruines, Abandonn\xE9",parentLocationDesc:"S\xE9lectionnez un lieu parent qui contient ce lieu.",assignToGroupsDesc:"Assignez ce lieu \xE0 un ou plusieurs groupes.",manageGroupsDesc:"G\xE9rez vos groupes. Partag\xE9s entre tous les types d'entit\xE9s.",searchGroupsDesc:"Rechercher par nom de groupe ou description.",manageCharactersDesc:"G\xE9rez les personnages de votre histoire.",manageLocationsDesc:"G\xE9rez les lieux de votre histoire.",manageEventsDesc:"G\xE9rez les \xE9v\xE9nements de votre histoire.",manageImagesDesc:"G\xE9rez les images de votre histoire.",assignEventToGroupsDesc:"Assignez cet \xE9v\xE9nement \xE0 un ou plusieurs groupes.",assignItemToGroupsDesc:"Assignez cet objet \xE0 un ou plusieurs groupes.",assignCharacterToGroupsDesc:"Assignez ce personnage \xE0 un ou plusieurs groupes.",nodesLabel:"N\u0153uds",edgesLabel:"Ar\xEAtes",filteredLabel:"Filtr\xE9",loadingNodes:"Chargement des n\u0153uds",emptyGraphTitle:"Aucune entit\xE9 \xE0 afficher",emptyGraphMessage:"Cr\xE9ez des personnages, des lieux, des \xE9v\xE9nements ou des objets pour les voir dans le graphe de r\xE9seau.",emptyGraphTip:"Ajoutez des relations entre les entit\xE9s pour voir les connexions visualis\xE9es ici.",keyboardShortcuts:"Raccourcis clavier",graphUpdated:"Graphe mis \xE0 jour",filterApplied:"Filtre appliqu\xE9",layoutChanged:"Disposition modifi\xE9e",graphFitToView:"Ajuster le graphe \xE0 la vue",showingXNodes:"Affichage de {0} n\u0153ud",showingXEdges:"{0} ar\xEAte",noNodesVisible:"Aucun n\u0153ud visible avec les filtres actuels",createNewEconomy:"Cr\xE9er une nouvelle \xE9conomie",createEconomy:"Cr\xE9er une \xE9conomie",editEconomy:"Modifier l'\xE9conomie",deleteEconomy:"Supprimer l'\xE9conomie",viewEconomies:"Voir les \xE9conomies",economies:"\xC9conomies",economy:"\xC9conomie",economicSystem:"Syst\xE8me \xE9conomique",economicSystemDesc:"Type d'organisation \xE9conomique",economyNameDesc:`Nom du syst\xE8me \xE9conomique (ex. : "\xC9conomie du Royaume d'Eldoria")`,industries:"Industries",industriesDesc:"Industries majeures, production et activit\xE9s \xE9conomiques",taxation:"Fiscalit\xE9 et politique commerciale",taxationDesc:"Syst\xE8me fiscal, r\xE9glementations commerciales et politiques \xE9conomiques",representativeImage:"Image repr\xE9sentative",barterEconomy:"\xC9conomie de troc",marketEconomy:"\xC9conomie de march\xE9",commandEconomy:"\xC9conomie planifi\xE9e",mixedEconomy:"\xC9conomie mixte",feudalEconomy:"\xC9conomie f\xE9odale",giftEconomy:"\xC9conomie du don",booming:"En plein essor",growing:"Croissante",recession:"R\xE9cession",depression:"D\xE9pression",recovering:"En reprise",economyNameRequired:"Le nom de l'\xE9conomie est requis",economyStatusDesc:"\xC9tat de sant\xE9 \xE9conomique actuel",economyDescriptionDesc:"Aper\xE7u et caract\xE9ristiques du syst\xE8me \xE9conomique",noEconomiesFound:"Aucune \xE9conomie trouv\xE9e",searchEconomies:"Rechercher des \xE9conomies...",confirmDeleteEconomy:`\xCAtes-vous s\xFBr de vouloir supprimer l'\xE9conomie "{0}" ? Cela d\xE9placera la note dans la corbeille syst\xE8me.`,economyCreated:'\xC9conomie "{0}" cr\xE9\xE9e.',economyUpdated:'\xC9conomie "{0}" mise \xE0 jour.',economyDeleted:'\xC9conomie "{0}" supprim\xE9e.',createNewCulture:"Cr\xE9er une nouvelle culture",createCulture:"Cr\xE9er une culture",editCulture:"Modifier la culture",deleteCulture:"Supprimer la culture",viewCultures:"Voir les cultures",cultures:"Cultures",culture:"Culture",cultureNameDesc:"Nom de la culture ou de la soci\xE9t\xE9",techLevel:"Niveau technologique",techLevelDesc:"Avancement technologique de la culture",governmentType:"Type de gouvernement",governmentTypeDesc:"Syst\xE8me politique et structure de leadership",languages:"Langues",languagesDesc:"Liste de langues parl\xE9es s\xE9par\xE9es par des virgules (ex. : Commun, Elfique, Nain)",population:"Population",populationDesc:'Taille estim\xE9e de la population (ex. : "10 000" ou "Grande")',valuesBeliefs:"Valeurs et croyances",valuesBeliefsDesc:"Valeurs culturelles fondamentales, vision du monde et croyances philosophiques",religion:"Religion",religionDesc:"Croyances religieuses, pratiques et divinit\xE9s v\xE9n\xE9r\xE9es",socialStructure:"Structure sociale",socialStructureDesc:"Hi\xE9rarchie des classes, organisation sociale et syst\xE8mes de castes",namingConventions:"Conventions de d\xE9nomination",namingConventionsDesc:"Comment les membres de cette culture nomment les personnes, les lieux et les choses",customsTraditions:"Coutumes et traditions",customsTraditionsDesc:"Pratiques culturelles, c\xE9r\xE9monies, f\xEAtes et traditions",cultureStatusDesc:"\xC9tat actuel de la culture",cultureDescriptionDesc:"Aper\xE7u et caract\xE9ristiques cl\xE9s de la culture",cultureHistoryDesc:"Origines, \xE9v\xE9nements historiques majeurs et \xE9volution culturelle",stoneAge:"\xC2ge de pierre",bronzeAge:"\xC2ge de bronze",ironAge:"\xC2ge de fer",medieval:"M\xE9di\xE9val",renaissance:"Renaissance",industrial:"Industriel",modern:"Moderne",futuristic:"Futuriste",monarchy:"Monarchie",democracy:"D\xE9mocratie",republic:"R\xE9publique",theocracy:"Th\xE9ocratie",tribal:"Tribal",empire:"Empire",feudal:"F\xE9odal",oligarchy:"Oligarchie",anarchy:"Anarchie",thriving:"Prosp\xE8re",stable:"Stable",declining:"En d\xE9clin",extinct:"\xC9teinte",emerging:"\xC9mergente",cultureNameRequired:"Le nom de la culture est requis",noCulturesFound:"Aucune culture trouv\xE9e",searchCultures:"Rechercher des cultures...",confirmDeleteCulture:'Supprimer la culture "{0}" ? Cela d\xE9placera la note dans la corbeille syst\xE8me.',cultureCreated:'Culture "{0}" cr\xE9\xE9e.',cultureUpdated:'Culture "{0}" mise \xE0 jour.',cultureDeleted:'Culture "{0}" supprim\xE9e.',createNewMagicSystem:"Cr\xE9er un nouveau syst\xE8me de magie",createMagicSystem:"Cr\xE9er un syst\xE8me de magie",editMagicSystem:"Modifier le syst\xE8me de magie",deleteMagicSystem:"Supprimer le syst\xE8me de magie",viewMagicSystems:"Voir les syst\xE8mes de magie",magicSystems:"Syst\xE8mes de magie",magicSystem:"Syst\xE8me de magie",magicSystemNameDesc:'Nom du syst\xE8me de magie (ex. : "Arts arcanes", "Magie divine")',systemType:"Type de syst\xE8me",systemTypeDesc:"Source ou cat\xE9gorie de pouvoir magique",rarity:"Raret\xE9",rarityDesc:"\xC0 quel point la magie est-elle commune dans le monde ?",powerLevel:"Niveau de puissance",powerLevelDesc:"Puissance globale de ce syst\xE8me de magie",rulesMechanics:"R\xE8gles et m\xE9caniques",rulesMechanicsDesc:"Comment la magie est utilis\xE9e, lanc\xE9e ou canalis\xE9e",source:"Source",sourceDesc:"D'o\xF9 vient le pouvoir magique ?",costsConsequences:"Co\xFBts et cons\xE9quences",costsConsequencesDesc:"Quel est le co\xFBt de l'utilisation de la magie pour le lanceur ?",limitations:"Limitations",limitationsDesc:"Quelles sont les limites et restrictions de cette magie ?",trainingLearning:"Formation et apprentissage",trainingLearningDesc:"Comment la magie est-elle apprise et ma\xEEtris\xE9e ?",arcane:"Arcanes (Appris)",divine:"Divin (Bas\xE9 sur la foi)",natural:"Naturel (Nature/Druidique)",psionic:"Psionique (Pouvoirs mentaux)",bloodMagic:"Magie du sang",elemental:"\xC9l\xE9mentaire",necromancy:"N\xE9cromancie",alchemy:"Alchimie",runeMagic:"Magie runique",ubiquitous:"Ubiquitaire (Tout le monde l'a)",common:"Commun (Beaucoup l'ont)",uncommon:"Peu commun (Certains l'ont)",rare:"Rare (Peu l'ont)",legendary:"L\xE9gendaire (Presque personne)",low:"Faible (Effets subtils)",moderate:"Mod\xE9r\xE9 (Effets notables)",high:"\xC9lev\xE9 (Effets puissants)",godlike:"Divin (D\xE9formation de la r\xE9alit\xE9)",forbidden:"Interdit",lostKnowledge:"Connaissance perdue",resurgent:"Renaissant",magicSystemNameRequired:"Le nom du syst\xE8me de magie est requis",noMagicSystemsFound:"Aucun syst\xE8me de magie trouv\xE9",searchMagicSystems:"Rechercher des syst\xE8mes de magie...",confirmDeleteMagicSystem:'Supprimer le syst\xE8me de magie "{0}" ? Cela d\xE9placera la note dans la corbeille syst\xE8me.',magicSystemCreated:'Syst\xE8me de magie "{0}" cr\xE9\xE9.',magicSystemUpdated:'Syst\xE8me de magie "{0}" mis \xE0 jour.',magicSystemDeleted:'Syst\xE8me de magie "{0}" supprim\xE9.',magicSystemStatusDesc:"\xC9tat actuel du syst\xE8me de magie",magicSystemDescriptionDesc:"Aper\xE7u et explication du syst\xE8me de magie",magicSystemHistoryDesc:"Origines, d\xE9couverte et \xE9volution du syst\xE8me de magie",startFromTemplate:"Commencer \xE0 partir d'un mod\xE8le",startFromTemplateDesc:"Optionnellement commencer avec un mod\xE8le pr\xE9configur\xE9",chooseTemplate:"Choisir un mod\xE8le",selectTemplate:"S\xE9lectionner un mod\xE8le",templateApplied:'Mod\xE8le "{0}" appliqu\xE9',noTemplatesAvailable:"Ce mod\xE8le ne contient aucun \xE9l\xE9ment",cannotDeleteWithoutPath:"Impossible de supprimer sans chemin de fichier.",cannotOpenWithoutPath:"Impossible d'ouvrir la note sans chemin de fichier.",templates:"Mod\xE8les",entityTemplates:"Mod\xE8les d'entit\xE9s",browseManageTemplates:"Parcourir et g\xE9rer des mod\xE8les r\xE9utilisables pour les personnages, les lieux et d'autres entit\xE9s.",createNewTemplate:"Cr\xE9er un nouveau mod\xE8le",templateCreated:'Mod\xE8le "{0}" cr\xE9\xE9 !',searchTemplates:"Rechercher",searchTemplatesPlaceholder:"Rechercher des mod\xE8les par nom, description ou \xE9tiquettes...",genre:"Genre",allGenres:"Tous les genres",templateCategory:"Cat\xE9gorie",allTemplateCategories:"Toutes les cat\xE9gories",singleEntity:"Entit\xE9 unique",entitySet:"Ensemble d'entit\xE9s",fullWorld:"Monde complet",sortBy:"Trier par",sortByName:"Nom",sortByUsage:"Nombre d'utilisations",sortByRecent:"R\xE9cemment utilis\xE9",showBuiltIn:"Afficher les int\xE9gr\xE9s",showCustom:"Afficher les personnalis\xE9s",noTemplatesFound:"Aucun mod\xE8le trouv\xE9. Essayez d'ajuster vos filtres ou cr\xE9ez un nouveau mod\xE8le.",foundXTemplates:"Trouv\xE9 {0} mod\xE8le",builtIn:"Int\xE9gr\xE9",usedXTimes:"Utilis\xE9 : {0}x",contains:"Contient : ",useTemplate:"Utiliser le mod\xE8le",duplicate:"Dupliquer",templateSelected:`Mod\xE8le "{0}" s\xE9lectionn\xE9. Appliquez ce mod\xE8le depuis la fen\xEAtre modale de cr\xE9ation d'entit\xE9.`,templateDeleted:'Mod\xE8le "{0}" supprim\xE9.',failedToDeleteTemplate:"\xC9chec de la suppression du mod\xE8le : {0}",templateCopySuffix:" (Copie)",templateDuplicated:'Mod\xE8le dupliqu\xE9 en "{0}"',failedToDuplicateTemplate:"\xC9chec de la duplication du mod\xE8le : {0}",deleteTemplate:"Supprimer le mod\xE8le ?",confirmDeleteTemplate:'\xCAtes-vous s\xFBr de vouloir supprimer le mod\xE8le "{0}" ? Cette action ne peut pas \xEAtre annul\xE9e.',dashboardTabVisibility:"Visibilit\xE9 des onglets du tableau de bord",dashboardTabVisibilityDesc:"Choisissez quels onglets afficher dans la barre lat\xE9rale du tableau de bord. Les onglets masqu\xE9s n'appara\xEEtront pas dans la barre d'onglets.",tabIsVisible:"L'onglet est visible",tabIsHidden:"L'onglet est masqu\xE9",tabShown:"Onglet {0} affich\xE9",tabHidden:"Onglet {0} masqu\xE9",refreshDashboardToSeeChanges:". Actualisez le tableau de bord pour voir les changements.",ganttViewSettings:"Param\xE8tres de la vue Gantt",showProgressBarsInGantt:"Afficher les barres de progression dans la vue Gantt",showProgressBarsInGanttDesc:"Afficher les superpositions de barres de progression sur les barres Gantt pour visualiser l'ach\xE8vement des \xE9v\xE9nements.",defaultGanttDuration:"Dur\xE9e Gantt par d\xE9faut (jours)",defaultGanttDurationDesc:"Dur\xE9e par d\xE9faut en jours pour les \xE9v\xE9nements sans date de fin lorsqu'ils sont affich\xE9s en vue Gantt.",dependencyArrowStyle:"Style de fl\xE8che de d\xE9pendance",dependencyArrowStyleDesc:"Style visuel pour les fl\xE8ches de d\xE9pendance entre les \xE9v\xE9nements en vue Gantt.",solid:"Plein",dashed:"Tirets",dotted:"Pointill\xE9",mapSettings:"Param\xE8tres de la carte",enableFrontmatterMarkers:"Activer les marqueurs frontmatter",enableFrontmatterMarkersDesc:"G\xE9n\xE9rer automatiquement des marqueurs \xE0 partir de notes avec location ou mapmarkers dans le frontmatter",enableDataViewMarkers:"Activer les marqueurs DataView",enableDataViewMarkersDesc:"G\xE9n\xE9rer automatiquement des marqueurs \xE0 partir de requ\xEAtes DataView (n\xE9cessite le plugin DataView)",tutorialWelcome:"Bienvenue dans Storyteller Suite !",tutorialWelcomeDesc:"Ce plugin vous aide \xE0 organiser et g\xE9rer tous les aspects de vos histoires. Voici comment commencer :",tutorialTip:"Astuce : Cliquez sur n'importe quelle section ci-dessous pour d\xE9velopper les instructions d\xE9taill\xE9es et les exemples.",tutorialDashboardTitle:"Tableau de bord et ic\xF4ne du ruban",tutorialDashboardAccess:"Acc\xE9der au tableau de bord :",tutorialDashboardRibbon:"Cliquez sur l'<strong>ic\xF4ne livre ouvert</strong> dans le ruban de gauche (barre lat\xE9rale)",tutorialDashboardCommand:'Utilisez la palette de commandes : <kbd>Ctrl/Cmd + P</kbd> \u2192 "Storyteller : Ouvrir le tableau de bord"',tutorialDashboardHub:"Le tableau de bord est votre centre n\xE9vralgique pour g\xE9rer tous les \xE9l\xE9ments de l'histoire",tutorialStoryTitle:"Gestion des histoires",tutorialStoryCreating:"Cr\xE9er votre premi\xE8re histoire :",tutorialStoryButton:'Utilisez le bouton <strong>"Cr\xE9er une nouvelle histoire"</strong> ci-dessous (masqu\xE9 lorsque le <em>Mode une seule histoire</em> est activ\xE9)',tutorialStoryCommand:'Ou depuis la palette de commandes : "Storyteller : Cr\xE9er une nouvelle histoire"',tutorialStoryName:"Donnez un nom et une description \xE0 votre histoire",tutorialStoryDefault:"Par d\xE9faut, le plugin cr\xE9e des dossiers \xE0 <code>StorytellerSuite/Stories/VotreNomHistoire/</code>",tutorialStoryManaging:"G\xE9rer les histoires :",tutorialStorySwitch:'Basculez entre les histoires en utilisant le bouton <strong>"D\xE9finir comme actif"</strong>',tutorialStoryEdit:"Modifiez les d\xE9tails de l'histoire avec l'ic\xF4ne crayon",tutorialStoryDelete:"Supprimez les histoires avec l'ic\xF4ne corbeille (cela ne supprime que du plugin, pas vos fichiers)",tutorialStoryActivation:`Astuce d'activation imm\xE9diate : Cr\xE9er une histoire depuis <em>Param\xE8tres</em> met \xE0 jour la liste des param\xE8tres imm\xE9diatement, mais le menu d\xE9roulant de l'histoire du tableau de bord peut ne pas s'actualiser jusqu'\xE0 ce que vous rouvriez le tableau de bord. Pour une activation instantan\xE9e et un rafra\xEEchissement de l'interface, utilisez l'action du tableau de bord/palette de commandes <em>"Storyteller : Cr\xE9er une nouvelle histoire"</em>, ou fermez/rouvrez le tableau de bord via <em>"Storyteller : Ouvrir le tableau de bord"</em>.`,tutorialStoryOneMode:"Mode une seule histoire : Lorsqu'il est activ\xE9 dans les param\xE8tres, l'interface est simplifi\xE9e en une mise en page \xE0 une seule histoire et le bouton <em>Nouvelle histoire</em> est masqu\xE9. Le contenu est organis\xE9 sous un seul dossier de base.",tutorialCharacterTitle:"Gestion des personnages",tutorialCharacterCreating:"Cr\xE9er des personnages :",tutorialCharacterDashboard:'<strong>Tableau de bord :</strong> Cliquez sur le bouton "Cr\xE9er un personnage"',tutorialCharacterCommand:'<strong>Palette de commandes :</strong> "Storyteller : Cr\xE9er un nouveau personnage"',tutorialCharacterDetails:"Remplissez les d\xE9tails du personnage, l'histoire de fond, les relations",tutorialCharacterImages:"Ajoutez des images de profil depuis votre coffre",tutorialCharacterManaging:"G\xE9rer les personnages :",tutorialCharacterView:'<strong>Voir tout :</strong> Tableau de bord \u2192 "Voir les personnages" ou Palette de commandes \u2192 "Storyteller : Voir les personnages"',tutorialCharacterEdit:"<strong>Modifier :</strong> Cliquez sur le nom du personnage dans le tableau de bord ou la liste des personnages",tutorialCharacterDelete:"<strong>Supprimer :</strong> Utilisez l'ic\xF4ne corbeille (d\xE9place vers la corbeille Obsidian)",tutorialCharacterStorage:"Les personnages sont stock\xE9s sous forme de fichiers markdown dans le dossier <code>Characters/</code>",tutorialLocationTitle:"Gestion des lieux",tutorialLocationCreating:"Cr\xE9er des lieux :",tutorialLocationDashboard:'<strong>Tableau de bord :</strong> Cliquez sur le bouton "Cr\xE9er un lieu"',tutorialLocationCommand:'<strong>Palette de commandes :</strong> "Storyteller : Cr\xE9er un nouveau lieu"',tutorialLocationDetails:"Ajoutez des descriptions, l'historique, la r\xE9gion, le type de lieu",tutorialLocationLink:"Liez aux personnages et \xE9v\xE9nements associ\xE9s",tutorialLocationManaging:"G\xE9rer les lieux :",tutorialLocationView:'<strong>Voir tout :</strong> Tableau de bord \u2192 "Voir les lieux" ou Palette de commandes \u2192 "Storyteller : Voir les lieux"',tutorialLocationStorage:"Les lieux sont stock\xE9s dans le dossier <code>Locations/</code> sous forme de fichiers markdown",tutorialLocationEdit:"Modifiez en cliquant sur le nom du lieu, supprimez avec l'ic\xF4ne corbeille",tutorialEventTitle:"Gestion des \xE9v\xE9nements et de la chronologie",tutorialEventCreating:"Cr\xE9er des \xE9v\xE9nements :",tutorialEventDashboard:'<strong>Tableau de bord :</strong> Cliquez sur le bouton "Cr\xE9er un \xE9v\xE9nement"',tutorialEventCommand:'<strong>Palette de commandes :</strong> "Storyteller : Cr\xE9er un nouvel \xE9v\xE9nement"',tutorialEventDetails:"D\xE9finissez la date/heure, ajoutez des descriptions, des r\xE9sultats",tutorialEventLink:"Liez aux personnages et lieux impliqu\xE9s",tutorialEventNew:"<strong>Nouveau :</strong> Marquez les \xE9v\xE9nements comme jalons, d\xE9finissez la progression (0-100%), ajoutez des d\xE9pendances",tutorialEventTimeline:"Vue chronologie :",tutorialEventTimelineDashboard:'<strong>Tableau de bord :</strong> Cliquez sur le bouton "Voir la chronologie"',tutorialEventTimelineCommand:'<strong>Palette de commandes :</strong> "Storyteller : Voir la chronologie"',tutorialEventTimelineSee:"Voir tous les \xE9v\xE9nements ordonn\xE9s chronologiquement",tutorialEventStorage:"Les \xE9v\xE9nements sont stock\xE9s dans le dossier <code>Events/</code>",tutorialGanttTitle:"Fonctionnalit\xE9s de chronologie style Gantt",tutorialGanttEnhanced:"Vue chronologie am\xE9lior\xE9e :",tutorialGanttToggle:"<strong>Basculer la vue :</strong> Basculez entre la chronologie classique et la vue Gantt en utilisant le bouton de bascule",tutorialGanttMilestones:"<strong>Jalons :</strong> Marquez les \xE9v\xE9nements importants comme jalons (style dor\xE9 avec ic\xF4ne \xE9toile)",tutorialGanttProgress:"<strong>Suivi de progression :</strong> D\xE9finissez le pourcentage d'ach\xE8vement (0-100%) sur les \xE9v\xE9nements avec des barres de progression visuelles",tutorialGanttDependencies:"<strong>D\xE9pendances :</strong> Liez les \xE9v\xE9nements pour montrer les relations de cause \xE0 effet avec des fl\xE8ches",tutorialGanttDrag:"Reprogrammation par glisser-d\xE9poser :",tutorialGanttLock:"Cliquez sur l'<strong>ic\xF4ne cadenas/crayon</strong> dans la barre d'outils pour activer le mode \xE9dition",tutorialGanttDragEvents:"Glissez les \xE9v\xE9nements vers de nouvelles dates - les modifications s'enregistrent automatiquement",tutorialGanttDisable:"Cliquez \xE0 nouveau sur l'ic\xF4ne pour d\xE9sactiver l'\xE9dition et verrouiller la chronologie",tutorialGanttFiltering:"Filtrage et regroupement :",tutorialGanttFilterPanel:'<strong>Panneau de filtres :</strong> Cliquez sur "Filtres" pour ouvrir le panneau de filtres r\xE9tractable',tutorialGanttFilterBy:"<strong>Filtrer par :</strong> Personnage, lieu, groupe, ou uniquement les jalons",tutorialGanttFilterChips:'<strong>Puces de filtre :</strong> Cliquez sur les puces pour supprimer les filtres individuels, ou "Tout effacer"',tutorialGanttSwimlanes:"<strong>Couloirs :</strong> Regroupez les \xE9v\xE9nements par lieu, groupe ou personnage",tutorialPlotTitle:"Gestion des \xE9l\xE9ments de l'intrigue",tutorialPlotManaging:"G\xE9rer les objets importants :",tutorialPlotCreate:`<strong>Cr\xE9er :</strong> Tableau de bord \u2192 "Cr\xE9er un \xE9l\xE9ment d'intrigue" ou Palette de commandes \u2192 "Storyteller : Cr\xE9er un nouvel \xE9l\xE9ment d'intrigue"`,tutorialPlotCritical:`<strong>Marquer comme critique :</strong> Utilisez la case \xE0 cocher "Critique pour l'intrigue" pour les \xE9l\xE9ments cl\xE9s de l'histoire`,tutorialPlotOwnership:"<strong>Suivre la propri\xE9t\xE9 :</strong> Liez le propri\xE9taire actuel, les anciens propri\xE9taires et le lieu",tutorialPlotView:`<strong>Voir tout :</strong> Tableau de bord \u2192 "Voir les \xE9l\xE9ments d'intrigue" ou Palette de commandes \u2192 "Storyteller : Voir les \xE9l\xE9ments d'intrigue"`,tutorialPlotStorage:"Les objets sont stock\xE9s dans le dossier <code>Items/</code>",tutorialGalleryTitle:"Gestion de la galerie",tutorialGalleryOrganization:"Organisation des images :",tutorialGalleryAccess:'<strong>Acc\xE9der :</strong> Tableau de bord \u2192 Bouton "Galerie" ou Palette de commandes \u2192 "Storyteller : Ouvrir la galerie"',tutorialGalleryUpload:"<strong>T\xE9l\xE9charger :</strong> Glissez-d\xE9posez les images directement dans la galerie",tutorialGalleryOrganize:"<strong>Organiser :</strong> Ajoutez des \xE9tiquettes, des cat\xE9gories, des descriptions aux images",tutorialGalleryLink:"<strong>Lier :</strong> R\xE9f\xE9rencez facilement les images de la galerie dans les profils de personnages/lieux",tutorialGalleryConfig:"Configurez le dossier de t\xE9l\xE9chargement ci-dessous (par d\xE9faut : <code>StorytellerSuite/GalleryUploads</code>)",tutorialGroupsTitle:"Groupes et organisation",tutorialGroupsOrganizing:"Organiser avec des groupes :",tutorialGroupsCreate:'<strong>Cr\xE9er des groupes :</strong> Palette de commandes \u2192 "Storyteller : Cr\xE9er un groupe"',tutorialGroupsAdd:"<strong>Ajouter des membres :</strong> Les personnages, lieux, \xE9v\xE9nements et objets peuvent \xEAtre regroup\xE9s",tutorialGroupsManage:'<strong>G\xE9rer :</strong> Renommez avec "Storyteller : Renommer le groupe", supprimez avec "Storyteller : Supprimer le groupe"',tutorialGroupsUseCases:"<strong>Cas d'utilisation :</strong> Famille royale, royaumes sp\xE9cifiques, arcs d'intrigue, etc.",tutorialWorldTitle:"Entit\xE9s de construction du monde",tutorialWorldFive:"Cinq types d'entit\xE9s pour une construction du monde compl\xE8te :",tutorialWorldCultures:"<strong>Cultures :</strong> Niveau technologique, type de gouvernement, langues, valeurs, coutumes, structure sociale",tutorialWorldFactions:"<strong>Factions :</strong> Organisations avec type, niveau de puissance, couleurs, devise, objectifs, ressources",tutorialWorldEconomies:"<strong>\xC9conomies :</strong> Type de syst\xE8me (troc, march\xE9, f\xE9odal), industries, politique commerciale",tutorialWorldMagic:"<strong>Syst\xE8mes de magie :</strong> Type (arcanes, divin, naturel), raret\xE9, niveau de puissance, r\xE8gles, co\xFBts",tutorialWorldCalendars:"<strong>Calendriers :</strong> Type de calendrier (solaire, lunaire), configuration des jours, jours de la semaine",tutorialWorldCreating:"Cr\xE9er des entit\xE9s de construction du monde :",tutorialWorldCommand:'<strong>Palette de commandes :</strong> "Storyteller : Cr\xE9er une nouvelle culture/faction/\xE9conomie/syst\xE8me de magie/calendrier"',tutorialWorldView:'<strong>Voir tout :</strong> "Storyteller : Voir les cultures/factions/\xE9conomies/syst\xE8mes de magie/calendriers"',tutorialWorldModals:"Chaque entit\xE9 a des fen\xEAtres modales d\xE9di\xE9es avec des champs pertinents",tutorialWorldStorage:"Les entit\xE9s sont stock\xE9es dans leurs dossiers respectifs (ex. : <code>Cultures/</code>, <code>Factions/</code>)",tutorialTimelineTitle:"Fourches de chronologie et causalit\xE9",tutorialTimelineAlternate:"Chronologies alternatives (sc\xE9narios et si) :",tutorialTimelineCreateFork:'<strong>Cr\xE9er une fourche :</strong> Palette de commandes \u2192 "Storyteller : Cr\xE9er une fourche de chronologie"',tutorialTimelineDivergence:"<strong>Point de divergence :</strong> S\xE9lectionnez l'\xE9v\xE9nement o\xF9 la chronologie se divise",tutorialTimelineForkStatus:"<strong>Statut de la fourche :</strong> Suivez comme exploration, canon, abandonn\xE9e ou fusionn\xE9e",tutorialTimelineViewForks:"<strong>Voir les fourches :</strong> Utilisez le menu d\xE9roulant de s\xE9lection de fourche dans la vue chronologie",tutorialTimelineCausality:"Liens de causalit\xE9 (Cause et effet) :",tutorialTimelineAddLink:'<strong>Ajouter un lien :</strong> Palette de commandes \u2192 "Storyteller : Ajouter un lien de causalit\xE9"',tutorialTimelineLinkTypes:"<strong>Types de liens :</strong> Direct, indirect, conditionnel ou catalyseur",tutorialTimelineStrength:"<strong>Niveaux de force :</strong> Faible, mod\xE9r\xE9, fort ou absolu",tutorialTimelineLinksHelp:"Les liens aident \xE0 suivre comment les \xE9v\xE9nements s'influencent mutuellement",tutorialTimelineConflict:"D\xE9tection des conflits :",tutorialTimelineRunDetection:'<strong>Ex\xE9cuter la d\xE9tection :</strong> Palette de commandes \u2192 "Storyteller : D\xE9tecter les conflits de chronologie"',tutorialTimelineDetects:"<strong>D\xE9tecte :</strong> Conflits de lieu (personnage \xE0 plusieurs endroits), conflits de mort (personnages morts apparaissant plus tard), violations de causalit\xE9 (effets avant causes)",tutorialTimelineBadge:"<strong>Badge de conflit :</strong> Affiche le nombre dans la barre d'outils de la chronologie - cliquez pour examiner",tutorialTimelineActionable:"<strong>Actionnable :</strong> Chaque conflit inclut des suggestions de r\xE9solution",tutorialTemplatesTitle:"Mod\xE8les d'entit\xE9s",tutorialTemplatesCreate:"Cr\xE9er des mod\xE8les r\xE9utilisables :",tutorialTemplatesSave:"<strong>Enregistrer comme mod\xE8le :</strong> Lors de la modification de toute entit\xE9, enregistrez-la comme mod\xE8le r\xE9utilisable",tutorialTemplatesLibrary:`<strong>Biblioth\xE8que de mod\xE8les :</strong> Palette de commandes \u2192 "Storyteller : Ouvrir la biblioth\xE8que de mod\xE8les d'entit\xE9s"`,tutorialTemplatesDashboard:"<strong>Onglet du tableau de bord :</strong> Acc\xE9dez aux mod\xE8les depuis l'onglet Mod\xE8les du tableau de bord",tutorialTemplatesBuiltIn:"Mod\xE8les int\xE9gr\xE9s :",tutorialTemplatesArchetypes:"Arch\xE9types de personnages : Roi m\xE9di\xE9val, Tenancier de taverne, Mentor sage, Hacker cyberpunk, D\xE9tective",tutorialTemplatesMore:"Plus de mod\xE8les disponibles pour une cr\xE9ation rapide de personnages",tutorialTemplatesFeatures:"Fonctionnalit\xE9s des mod\xE8les :",tutorialTemplatesBrowse:"<strong>Parcourir :</strong> Recherchez et filtrez les mod\xE8les par genre, cat\xE9gorie, type d'entit\xE9",tutorialTemplatesSort:"<strong>Trier :</strong> Par nom, nombre d'utilisations ou r\xE9cemment utilis\xE9",tutorialTemplatesUsage:"<strong>Suivi d'utilisation :</strong> Voyez quels mod\xE8les vous utilisez le plus souvent",tutorialTemplatesCustomize:"<strong>Personnaliser :</strong> Dupliquez et modifiez les mod\xE8les selon vos besoins",tutorialDiscoveryTitle:"D\xE9couverte et importation d'histoires",tutorialDiscoveryAutomatic:"D\xE9couverte automatique :",tutorialDiscoveryDetects:"Le plugin d\xE9tecte automatiquement les dossiers <code>StorytellerSuite/Stories/</code> existants",tutorialDiscoveryManual:`<strong>Actualisation manuelle :</strong> Palette de commandes \u2192 "Storyteller : Actualiser la d\xE9couverte d'histoires"`,tutorialDiscoveryImport:"Importez les dossiers d'histoires existants sans perdre de donn\xE9es",tutorialDiscoveryUseful:"Utile lors du d\xE9placement d'histoires entre coffres",tutorialCustomTitle:"Dossiers personnalis\xE9s : workflow manuel recommand\xE9",tutorialCustomSimple:"Configuration simple et fiable pour les dossiers personnalis\xE9s :",tutorialCustomStep1:"<strong>Cr\xE9ez votre dossier d'histoire et sous-dossiers manuellement</strong> dans votre coffre (ex. : <code>Creative/Writing/Ma_Histoire/Characters</code>, <code>Locations</code>, <code>Events</code>, etc.).",tutorialCustomStep2:"Dans Param\xE8tres \u2192 Storyteller Suite \u2192 activez <strong>Utiliser des dossiers d'entit\xE9s personnalis\xE9s</strong>. Optionnellement, d\xE9finissez un mod\xE8le de <strong>Dossier racine de l'histoire</strong> pour plus de commodit\xE9.",tutorialCustomStep3:`Ouvrez le tableau de bord et utilisez <strong>"Cr\xE9er une nouvelle histoire"</strong>. Apr\xE8s la cr\xE9ation, <strong>actualisez/activez</strong> le tableau de bord. Le plugin reconna\xEEtra votre dossier d'histoire manuel comme l'histoire active.`,tutorialCustomStep4:"Utilisez <strong>Aper\xE7u des dossiers r\xE9solus</strong> dans les param\xE8tres pour confirmer les chemins exacts que le plugin utilisera.",tutorialCustomSwitching:"Changer d'histoire en mode dossier personnalis\xE9 : Utilisez le <em>menu d\xE9roulant d'histoire en haut du tableau de bord</em> pour changer l'histoire active. Ensuite, allez dans <em>Param\xE8tres \u2192 Storyteller Suite</em> et <strong>assignez manuellement les dossiers par entit\xE9</strong> pour cette histoire. D\xE9sol\xE9, je sais que c'est un peu bancal.",tutorialShortcutsTitle:"Raccourcis clavier et commandes",tutorialShortcutsCore:"Commandes principales (via Ctrl/Cmd + P) :",tutorialShortcutsOpen:"<strong>Storyteller : Ouvrir le tableau de bord</strong> - Interface principale",tutorialShortcutsNewStory:"<strong>Storyteller : Cr\xE9er une nouvelle histoire</strong> - D\xE9marrer un nouveau projet d'histoire",tutorialShortcutsCreate:"<strong>Storyteller : Cr\xE9er un nouveau personnage/lieu/\xE9v\xE9nement/\xE9l\xE9ment d'intrigue</strong>",tutorialShortcutsView:"<strong>Storyteller : Voir les personnages/lieux/chronologie/\xE9l\xE9ments d'intrigue</strong>",tutorialShortcutsGallery:"<strong>Storyteller : Ouvrir la galerie</strong> - Gestion des images",tutorialShortcutsGroup:"<strong>Storyteller : Cr\xE9er/Renommer/Supprimer un groupe</strong> - Organisation",tutorialShortcutsRefresh:"<strong>Storyteller : Actualiser la d\xE9couverte d'histoires</strong> - Importer les dossiers existants",tutorialShortcutsWorld:"Commandes de construction du monde :",tutorialShortcutsWorldCreate:"<strong>Storyteller : Cr\xE9er une nouvelle culture/faction/\xE9conomie/syst\xE8me de magie/calendrier</strong>",tutorialShortcutsWorldView:"<strong>Storyteller : Voir les cultures/factions/\xE9conomies/syst\xE8mes de magie/calendriers</strong>",tutorialShortcutsTimeline:"Commandes de chronologie et causalit\xE9 :",tutorialShortcutsTimelineFork:"<strong>Storyteller : Cr\xE9er une fourche de chronologie</strong> - Cr\xE9er une chronologie alternative",tutorialShortcutsTimelineViewForks:"<strong>Storyteller : Voir les fourches de chronologie</strong> - Lister toutes les fourches",tutorialShortcutsTimelineLink:"<strong>Storyteller : Ajouter un lien de causalit\xE9</strong> - Lier les \xE9v\xE9nements de cause \xE0 effet",tutorialShortcutsTimelineViewLinks:"<strong>Storyteller : Voir les liens de causalit\xE9</strong> - Lister toutes les relations causales",tutorialShortcutsTimelineDetect:"<strong>Storyteller : D\xE9tecter les conflits de chronologie</strong> - Trouver les incoh\xE9rences",tutorialShortcutsTimelineViewConflicts:"<strong>Storyteller : Voir les conflits de chronologie</strong> - Examiner les conflits existants",tutorialShortcutsTemplate:"Commandes de mod\xE8les :",tutorialShortcutsTemplateLibrary:"<strong>Storyteller : Ouvrir la biblioth\xE8que de mod\xE8les d'entit\xE9s</strong> - Parcourir et g\xE9rer les mod\xE8les",tutorialShortcutsTip:"Astuce : Vous pouvez attribuer des raccourcis personnalis\xE9s \xE0 n'importe laquelle de ces commandes dans les param\xE8tres Raccourcis d'Obsidian !",tutorialFileTitle:"Structure de fichiers et int\xE9gration",tutorialFileOrganized:"Comment vos fichiers sont organis\xE9s :",tutorialFileDefault:"Par d\xE9faut (multi-histoires) :",tutorialFileOneMode:"Mode une seule histoire (aplati) :",tutorialFileIntegration:"Int\xE9gration Obsidian :",tutorialFileMarkdown:"Toutes les donn\xE9es stock\xE9es sous forme de <strong>fichiers markdown</strong> avec frontmatter",tutorialFileDataview:"Enti\xE8rement compatible avec le <strong>plugin Dataview</strong> pour les requ\xEAtes personnalis\xE9es",tutorialFileWikiLinks:"Utilisez les <strong>[[liens wiki]]</strong> pour connecter les personnages, lieux, \xE9v\xE9nements",tutorialFileReadable:"Les fichiers sont <strong>lisibles et modifiables</strong> m\xEAme sans le plugin",tutorialFileBackup:"<strong>S\xE9curit\xE9 de sauvegarde :</strong> Vos donn\xE9es ne sont jamais verrouill\xE9es dans un format propri\xE9taire",tutorialFileTip:"Astuce : Configurez ces modes dans Param\xE8tres \u2192 Storyteller Suite sous <em>Utiliser des dossiers d'entit\xE9s personnalis\xE9s</em> et <em>Mode une seule histoire</em>. Le bouton <em>Nouvelle histoire</em> est masqu\xE9 automatiquement en Mode une seule histoire."}});function Uy(a){a in bm||a==="en"?Wy=a:(console.warn(`Language "${a}" not found, falling back to English`),Wy="en")}function OI(){return Object.keys(bm).filter(a=>a in AI)}function FI(a){return AI[a]||a.toUpperCase()}function RI(a){return a in bm}function Vy(a,...t){let e=a;return t.forEach((r,n)=>{let s=`{${n}}`;e=e.replace(new RegExp(s.replace(/[{}]/g,"\\$&"),"g"),String(r))}),e}function II(a,t,...e){if(Wy==="en"){if(a==="showingXNodes"&&e.length>0&&typeof e[0]=="number"){let r=e[0];return Vy(t,r)+(r!==1?"s":"")}if(a==="showingXEdges"&&e.length>0&&typeof e[0]=="number"){let r=e[0];return Vy(t,r)+(r!==1?"s":"")}if(a==="foundXTemplates"&&e.length>0&&typeof e[0]=="number"){let r=e[0];return Vy(t,r)+(r!==1?"s":"")}}return Vy(t,...e)}function w(a,...t){var n;let e=bm[Wy],r;if(e&&(r=e[a]),!r){let s=(n=bm.en)==null?void 0:n[a];return s?II(a,s,...t):(console.warn(`Translation key "${String(a)}" not found in any locale`),String(a))}return II(a,r,...t)}var Y8,AI,bm,Wy,St=_e(()=>{_I();xI();DI();LI();Y8={en:SI,zh:kI,es:PI,fr:MI},AI={en:"English",zh:"Chinese (\u4E2D\u6587)",es:"Spanish (Espa\xF1ol)",fr:"French (Fran\xE7ais)",de:"German (Deutsch)",pt:"Portuguese (Portugu\xEAs)",ja:"Japanese (\u65E5\u672C\u8A9E)",ko:"Korean (\uD55C\uAD6D\uC5B4)",it:"Italian (Italiano)",ru:"Russian (\u0420\u0443\u0441\u0441\u043A\u0438\u0439)",nl:"Dutch (Nederlands)",pl:"Polish (Polski)",tr:"Turkish (T\xFCrk\xE7e)",ar:"Arabic (\u0627\u0644\u0639\u0631\u0628\u064A\u0629)",sv:"Swedish (Svenska)",no:"Norwegian (Norsk)",da:"Danish (Dansk)",fi:"Finnish (Suomi)",cs:"Czech (\u010Ce\u0161tina)",hu:"Hungarian (Magyar)",el:"Greek (\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC)",he:"Hebrew (\u05E2\u05D1\u05E8\u05D9\u05EA)"},bm=Y8,Wy="en"});var wm,Qr,Nl=_e(()=>{wm=require("obsidian");St();Qr=class extends wm.Modal{constructor(t,e){var r;super(t),this.titleText=e.title,this.labelText=e.label,this.defaultValue=(r=e.defaultValue)!=null?r:"",this.validator=e.validator,this.onSubmit=e.onSubmit}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h3",{text:this.titleText});let e=null,r=null;new wm.Setting(t).setName(this.labelText).addText(o=>{e=o.setValue(this.defaultValue)}),r=t.createDiv({cls:"mod-warning"}),r.style.display="none";let n=()=>{var l;let o=((l=e==null?void 0:e.getValue())!=null?l:"").trim();if(this.validator){let c=this.validator(o);if(c){r.style.display="",r.setText(c);return}}this.onSubmit(o),this.close()},s=new wm.Setting(t);s.addButton(o=>o.setButtonText(w("ok")).setCta().onClick(n)),s.addButton(o=>o.setButtonText(w("cancel")).onClick(()=>this.close())),this.contentEl.addEventListener("keydown",o=>{o.key==="Enter"&&n()})}}});var NC={};At(NC,{ConfirmModal:()=>Em});var qy,Em,Zy=_e(()=>{qy=require("obsidian");St();Em=class extends qy.Modal{constructor(t,e){var r;super(t),this.titleText=e.title,this.bodyText=e.body,this.confirmText=(r=e.confirmText)!=null?r:w("confirm"),this.onConfirm=e.onConfirm}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h3",{text:this.titleText}),t.createEl("p",{text:this.bodyText});let e=new qy.Setting(t);e.addButton(r=>r.setButtonText(this.confirmText).setCta().onClick(()=>{this.onConfirm(),this.close()})),e.addButton(r=>r.setButtonText(w("cancel")).onClick(()=>this.close()))}}});var Ky,zr,Qa=_e(()=>{Ky=require("obsidian");St();zr=class extends Ky.FuzzySuggestModal{constructor(t,e,r){super(t),this.plugin=e,this.onChoose=r,this.setPlaceholder(w("selectGalleryImagePh")),this.setInstructions([{command:"Shift + Enter",purpose:"Clear selection"}])}async onOpen(){super.onOpen(),setTimeout(()=>{var t,e;if(this.inputEl){try{(t=this.setQuery)==null||t.call(this,"")}catch(r){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(r){}}try{(e=this.onInputChanged)==null||e.call(this)}catch(r){}},0),setTimeout(()=>{var t,e;if(this.inputEl){try{(t=this.setQuery)==null||t.call(this,"")}catch(r){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(r){}}try{(e=this.onInputChanged)==null||e.call(this)}catch(r){}},50)}getSuggestions(t){let e=this.getItems();if(!t)return e.map(n=>({item:n,match:{score:0,matches:[]}}));let r=(0,Ky.prepareFuzzySearch)(t);return e.map(n=>{let s=this.getItemText(n),o=r(s);return o?{item:n,match:o}:null}).filter(n=>!!n)}getItems(){return this.plugin.getGalleryImages()}getItemText(t){return t.title||t.filePath}onChooseItem(t,e){e.shiftKey?this.onChoose(null):this.onChoose(t)}}});var Tm,Et,Xy=_e(()=>{Tm=require("obsidian"),Et=class{static isMobile(){return Tm.Platform.isAndroidApp||Tm.Platform.isIosApp}static isIOS(){return Tm.Platform.isIosApp}static isAndroid(){return Tm.Platform.isAndroidApp}static isDesktop(){return!this.isMobile()}static getTouchTargetSize(){return this.isMobile()?44:32}static getModalPadding(){return this.isMobile()?"0.5rem":"1rem"}static getFontScaling(){return this.isMobile()?1.1:1}static shouldUseFullScreenModals(){return this.isMobile()}static getSearchDebounceDelay(){return this.isMobile()?300:150}static getMaxDisplayItems(){return this.isMobile()?50:100}static getMobileCssClasses(){let t=[];return this.isMobile()&&t.push("is-mobile"),this.isIOS()&&t.push("is-ios"),this.isAndroid()&&t.push("is-android"),this.isDesktop()&&t.push("is-desktop"),t}static isTablet(){if(!this.isMobile())return!1;let t=window.innerWidth,e=window.innerHeight,r=Math.min(t,e),n=Math.max(t,e),s=Math.sqrt(t*t+e*e),o=r>=600||s>=900,l=n/r,c=l>=1.3&&l<=2;return o&&c}static getGridColumns(){return this.isMobile()?this.isTablet()?2:1:3}static shouldUseSimplifiedUI(){return this.isMobile()&&!this.isTablet()}static getAnimationDuration(){return this.isMobile()?200:300}static shouldUseHapticFeedback(){return this.isMobile()}static allowRemoteImages(t){return!!t()}}});var ah,hr,ea=_e(()=>{ah=require("obsidian");Xy();hr=class extends ah.Modal{constructor(e){super(e);this.isFullScreen=!1;this.setupMobileAdaptations()}setupMobileAdaptations(){Et.getMobileCssClasses().forEach(r=>{this.modalEl.addClass(r)}),this.modalEl.addClass("storyteller-responsive-modal"),Et.shouldUseFullScreenModals()&&(this.isFullScreen=!0,this.modalEl.addClass("mobile-fullscreen")),Et.isMobile()&&this.modalEl.addClass("mobile-optimized"),Et.isTablet()&&this.modalEl.addClass("tablet-optimized"),this.setupPointerEvents()}setupPointerEvents(){Et.isMobile()&&(this.modalEl.addEventListener("pointerdown",e=>{e.pointerType==="pen"&&this.triggerHapticFeedback("light")}),this.modalEl.addEventListener("pointermove",e=>{e.pointerType}),this.modalEl.addEventListener("touchstart",e=>{e.touches.length},{passive:!0}))}onOpen(){this.setupMobileLayout(),super.onOpen()}setupMobileLayout(){let{contentEl:e}=this;Et.isMobile()&&(e.style.padding=Et.getModalPadding()),Et.isMobile()&&(e.style.overflowY="auto"),Et.isIOS()&&(e.style.paddingTop="env(safe-area-inset-top, 0)",e.style.paddingBottom="env(safe-area-inset-bottom, 0)")}createMobileSetting(e,r,n){let s=new ah.Setting(e).setName(r).setDesc(n);if(Et.isMobile()){s.settingEl.addClass("mobile-setting");let o=Et.getTouchTargetSize();s.settingEl.style.minHeight=`${o}px`}return s}createMobileButton(e,r,n=!1){let s=new ah.ButtonComponent(document.createElement("button")).setButtonText(e).onClick(r);if(Et.isMobile()){let o=Et.getTouchTargetSize();s.buttonEl.style.minHeight=`${o}px`,s.buttonEl.style.minWidth=`${o}px`,s.buttonEl.style.fontSize=`${1.1*Et.getFontScaling()}rem`,s.buttonEl.addClass("mobile-button"),n&&s.buttonEl.addClass("mobile-button-primary")}return s}createMobileTextArea(e,r,n,s){let o=e.createEl("textarea",{attr:{placeholder:r},value:n});return Et.isMobile()&&(o.addClass("mobile-textarea"),o.style.fontSize=`${1.1*Et.getFontScaling()}rem`,o.style.minHeight="120px",o.style.padding="12px",o.setAttribute("autocapitalize","sentences"),o.setAttribute("spellcheck","true")),o.addEventListener("input",()=>s(o.value)),o}createMobileInput(e,r,n,s,o){let l=e.createEl("input",{type:r,attr:{placeholder:n},value:s});if(Et.isMobile()){l.addClass("mobile-input");let c=Et.getTouchTargetSize();l.style.minHeight=`${c}px`,l.style.fontSize=`${1.1*Et.getFontScaling()}rem`,l.style.padding="12px"}return l.addEventListener("input",()=>o(l.value)),l}createMobileButtonBar(e){let r=this.contentEl.createEl("div",{cls:"mobile-button-bar"});return Et.isMobile()&&!Et.isTablet()?r.addClass("vertical-button-bar"):r.addClass("horizontal-button-bar"),e.forEach(n=>{let s=this.createMobileButton(n.text,n.callback,n.isPrimary);n.isDestructive&&s.buttonEl.addClass("mod-warning"),r.appendChild(s.buttonEl)}),r}triggerHapticFeedback(e="light"){if(Et.shouldUseHapticFeedback()&&"vibrate"in navigator&&typeof navigator.vibrate=="function"){let r=e==="light"?10:e==="medium"?20:50;navigator.vibrate(r)}}handleMobileKeyboard(e){if(Et.isMobile()&&e.key==="Enter"){if(e.target instanceof HTMLTextAreaElement)return;this.triggerHapticFeedback("light")}}showMobileLoading(e){e?this.contentEl.addClass("mobile-loading"):this.contentEl.removeClass("mobile-loading")}}});var NI,Gr,es=_e(()=>{NI=require("obsidian"),Gr=class extends NI.SuggestModal{constructor(t,e,r,n){super(t),this.plugin=e,this.entityType=n,this.onSelect=r,this.setPlaceholder(n?`Search ${n} templates...`:"Search templates...")}getSuggestions(t){let e=this.entityType?this.plugin.templateManager.getTemplatesByEntityType(this.entityType):this.plugin.templateManager.getAllTemplates();if(!t){let n=this.plugin.templateManager.getRecentlyUsedTemplates(5).filter(l=>!this.entityType||l.entityTypes&&l.entityTypes.includes(this.entityType)),s=this.plugin.templateManager.getMostPopularTemplates(5).filter(l=>!this.entityType||l.entityTypes&&l.entityTypes.includes(this.entityType)),o=[...n];return s.forEach(l=>{o.find(c=>c.id===l.id)||o.push(l)}),o.length>0?(e.forEach(l=>{o.find(c=>c.id===l.id)||o.push(l)}),o.slice(0,20)):e.slice(0,20)}let r=t.toLowerCase();return e.filter(n=>n.name.toLowerCase().includes(r)||n.description.toLowerCase().includes(r)||n.tags.some(s=>s.toLowerCase().includes(r))).slice(0,20)}renderSuggestion(t,e){e.addClass("template-suggestion");let r=e.createDiv({cls:"template-suggestion-title"});if(r.createSpan({text:t.name}),t.isBuiltIn&&r.createEl("span",{text:"Built-in",cls:"template-badge template-badge-builtin"}),e.createDiv({text:t.description,cls:"template-suggestion-description"}),t.usageCount&&t.usageCount>0&&e.createDiv({text:`Used ${t.usageCount} times`,cls:"template-suggestion-meta"}),t.entityTypes&&t.entityTypes.length>0){let n=e.createDiv({cls:"template-suggestion-meta"});n.createSpan({text:"Contains: "}),t.entityTypes.slice(0,3).forEach(s=>{n.createEl("span",{text:s,cls:"template-entity-type-badge-small"})}),t.entityTypes.length>3&&n.createSpan({text:` +${t.entityTypes.length-3} more`})}if(t.tags&&t.tags.length>0){let n=e.createDiv({cls:"template-suggestion-tags"});t.tags.slice(0,3).forEach(s=>{n.createEl("span",{text:s,cls:"template-tag-small"})})}}onChooseSuggestion(t){this.onSelect(t)}}});var sh,Fn,ru=_e(()=>{sh=require("obsidian");St();Fn=class extends sh.FuzzySuggestModal{constructor(e,r,n){super(e);this.characters=[];this.plugin=r,this.onChoose=n,this.setPlaceholder(w("selectCharacterPh"))}async onOpen(){super.onOpen();try{this.characters=await this.plugin.listCharacters()}catch(e){console.error("Storyteller Suite: Error fetching characters for suggester:",e),new sh.Notice(w("errorLoadingCharacters")),this.characters=[]}setTimeout(()=>{var e,r;if(this.inputEl){try{(e=this.setQuery)==null||e.call(this,"")}catch(n){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(n){}}try{(r=this.onInputChanged)==null||r.call(this)}catch(n){}},0),setTimeout(()=>{var e,r;if(this.inputEl){try{(e=this.setQuery)==null||e.call(this,"")}catch(n){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(n){}}try{(r=this.onInputChanged)==null||r.call(this)}catch(n){}},50)}getSuggestions(e){if(!e)return this.characters.map(n=>({item:n,match:{score:0,matches:[]}}));let r=(0,sh.prepareFuzzySearch)(e);return this.characters.map(n=>{let s=r(this.getItemText(n));return s?{item:n,match:s}:null}).filter(n=>!!n)}getItems(){return this.characters}getItemText(e){return e.name||"Unnamed character"}onChooseItem(e,r){this.onChoose(e)}}});var oh,fn,Bl=_e(()=>{oh=require("obsidian");St();fn=class extends oh.FuzzySuggestModal{constructor(e,r,n){super(e);this.locations=[];this.plugin=r,this.onChoose=n,this.setPlaceholder(w("selectEventLocationPh")),this.setInstructions([{command:"Shift + Enter",purpose:"Clear selection (No Location)"}])}async onOpen(){super.onOpen();try{this.locations=await this.plugin.listLocations()}catch(e){console.error("Storyteller Suite: Error fetching locations for suggester:",e),new oh.Notice(w("errorLoadingLocations")),this.locations=[]}setTimeout(()=>{var e,r;if(this.inputEl){try{(e=this.setQuery)==null||e.call(this,"")}catch(n){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(n){}}try{(r=this.onInputChanged)==null||r.call(this)}catch(n){}},0),setTimeout(()=>{var e,r;if(this.inputEl){try{(e=this.setQuery)==null||e.call(this,"")}catch(n){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(n){}}try{(r=this.onInputChanged)==null||r.call(this)}catch(n){}},50)}getSuggestions(e){let r=this.getItems();if(!e)return r.map(s=>({item:s,match:{score:0,matches:[]}}));let n=(0,oh.prepareFuzzySearch)(e);return r.map(s=>{let o=n(this.getItemText(s));return o?{item:s,match:o}:null}).filter(s=>!!s)}getItems(){return this.locations}getItemText(e){return e.name||"Unnamed location"}onChooseItem(e,r){r.shiftKey?this.onChoose(null):this.onChoose(e)}}});var lh,Rn,iu=_e(()=>{lh=require("obsidian");St();Rn=class extends lh.FuzzySuggestModal{constructor(e,r,n){super(e);this.events=[];this.plugin=r,this.onChoose=n,this.setPlaceholder(w("selectEventPh"))}getSuggestions(e){let r=this.getItems();if(!e)return r.map(s=>({item:s,match:{score:0,matches:[]}}));let n=(0,lh.prepareFuzzySearch)(e);return r.map(s=>{let o=n(this.getItemText(s));return o?{item:s,match:o}:null}).filter(s=>!!s)}async onOpen(){super.onOpen();try{this.events=await this.plugin.listEvents()}catch(e){console.error("Storyteller Suite: Error fetching events for suggester:",e),new lh.Notice(w("errorLoadingEvents")),this.events=[]}setTimeout(()=>{var e,r;if(this.inputEl){try{(e=this.setQuery)==null||e.call(this,"")}catch(n){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(n){}}try{(r=this.onInputChanged)==null||r.call(this)}catch(n){}},0),setTimeout(()=>{var e,r;if(this.inputEl){try{(e=this.setQuery)==null||e.call(this,"")}catch(n){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(n){}}try{(r=this.onInputChanged)==null||r.call(this)}catch(n){}},50)}getItems(){return this.events}getItemText(e){return e.name||"Unnamed event"}onChooseItem(e,r){this.onChoose(e)}}});var BC={};At(BC,{PlotItemSuggestModal:()=>nu});var ch,nu,Cm=_e(()=>{ch=require("obsidian");St();nu=class extends ch.FuzzySuggestModal{constructor(e,r,n){super(e);this.items=[];this.plugin=r,this.onChoose=n,this.setPlaceholder(w("selectItemPh"))}async onOpen(){super.onOpen();try{this.items=await this.plugin.listPlotItems()}catch(e){console.error("Storyteller Suite: Error fetching items for suggester:",e),new ch.Notice(w("errorLoadingItems")),this.items=[]}setTimeout(()=>{var e,r;if(this.inputEl){try{(e=this.setQuery)==null||e.call(this,"")}catch(n){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(n){}}try{(r=this.onInputChanged)==null||r.call(this)}catch(n){}},0),setTimeout(()=>{var e,r;if(this.inputEl){try{(e=this.setQuery)==null||e.call(this,"")}catch(n){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(n){}}try{(r=this.onInputChanged)==null||r.call(this)}catch(n){}},50)}getSuggestions(e){let r=this.getItems();if(!e)return r.map(s=>({item:s,match:{score:0,matches:[]}}));let n=(0,ch.prepareFuzzySearch)(e);return r.map(s=>{let o=n(this.getItemText(s));return o?{item:s,match:o}:null}).filter(s=>!!s)}getItems(){return this.items}getItemText(e){return e.name||"Unnamed item"}onChooseItem(e,r){this.onChoose(e)}}});var BI={};At(BI,{RelationshipEditorModal:()=>$C});var Oo,$C,$I=_e(()=>{Oo=require("obsidian");ru();Bl();iu();Cm();St();$C=class extends Oo.Modal{constructor(t,e,r,n="any",s){super(t),this.plugin=e,this.isNew=r===null,this.entityType=n,this.relationship=r?{...r}:{target:"",type:"neutral",label:void 0},this.onSubmit=s,this.modalEl.addClass("storyteller-relationship-editor-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?w("addRelationship"):w("editRelationship")});let e;new Oo.Setting(t).setName(w("targetEntity")).setDesc("").then(r=>{e=r.descEl.createEl("small",{text:this.relationship.target||w("none")})}).addButton(r=>r.setButtonText(w("select")).onClick(async()=>{this.entityType==="any"?new Fn(this.app,this.plugin,n=>{n&&(this.relationship.target=n.id||n.name,e.setText(n.name))}).open():this.entityType==="character"?new Fn(this.app,this.plugin,n=>{n&&(this.relationship.target=n.id||n.name,e.setText(n.name))}).open():this.entityType==="location"?new fn(this.app,this.plugin,n=>{n&&(this.relationship.target=n.id||n.name,e.setText(n.name))}).open():this.entityType==="event"?new Rn(this.app,this.plugin,n=>{n&&(this.relationship.target=n.id||n.name,e.setText(n.name))}).open():this.entityType==="item"&&new nu(this.app,this.plugin,n=>{n&&(this.relationship.target=n.id||n.name,e.setText(n.name))}).open()})),new Oo.Setting(t).setName(w("relationshipType")).setDesc(w("relationshipTypeDesc")).addDropdown(r=>{r.addOption("ally",w("ally")).addOption("enemy",w("enemy")).addOption("family",w("family")).addOption("rival",w("rival")).addOption("romantic",w("romantic")).addOption("mentor",w("mentor")).addOption("acquaintance",w("acquaintance")).addOption("neutral",w("neutral")).addOption("custom",w("custom")).setValue(this.relationship.type).onChange(n=>{this.relationship.type=n})}),new Oo.Setting(t).setName(w("label")+" "+w("optional")).setDesc(w("relationshipLabelDesc")).addText(r=>r.setPlaceholder(w("exampleRelationshipLabel")).setValue(this.relationship.label||"").onChange(n=>{this.relationship.label=n||void 0})),new Oo.Setting(t).addButton(r=>r.setButtonText(w("cancel")).onClick(()=>{this.close()})).addButton(r=>r.setButtonText(this.isNew?w("add"):w("save")).setCta().onClick(()=>{if(!this.relationship.target){new Oo.Notice(w("pleaseSelectTarget"));return}this.onSubmit(this.relationship),this.close()}))}onClose(){let{contentEl:t}=this;t.empty()}}});var zI={};At(zI,{CharacterModal:()=>Ts});var kr,Ts,_m=_e(()=>{kr=require("obsidian");oi();St();Qa();ea();Nl();es();Ts=class extends hr{constructor(e,r,n,s,o){super(e);this._groupRefreshInterval=null;this.groupSelectorContainer=null;this.workingCustomFields={};this.plugin=r,this.isNew=n===null;let l=n?{...n}:{name:"",description:"",backstory:"",profileImagePath:void 0,relationships:[],associatedLocations:[],associatedEvents:[],customFields:{},filePath:void 0};l.customFields||(l.customFields={}),l.relationships||(l.relationships=[]),n&&n.filePath&&(l.filePath=n.filePath),this.character=l,this.onSubmit=s,this.onDelete=o,this.modalEl.addClass("storyteller-character-modal")}onOpen(){super.onOpen();let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:this.isNew?w("createNewCharacter"):`${w("edit")} ${this.character.name}`}),this.isNew&&new kr.Setting(e).setName("Start from Template").setDesc("Optionally start with a pre-configured character template").addButton(l=>l.setButtonText("Choose Template").setTooltip("Select a character template").onClick(()=>{new Gr(this.app,this.plugin,async c=>{await this.applyTemplateToCharacter(c),this.refresh(),new kr.Notice(`Template "${c.name}" applied`)},"character").open()})),new kr.Setting(e).setName(w("name")).setDesc(w("name")).addText(l=>l.setPlaceholder(w("enterCharacterName")).setValue(this.character.name).onChange(c=>{this.character.name=c}).inputEl.addClass("storyteller-modal-input-large"));let r;new kr.Setting(e).setName(w("profileImage")).setDesc("").then(l=>{r=l.descEl.createEl("small",{text:w("currentValue",this.character.profileImagePath||w("none"))}),l.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(l=>l.setButtonText(w("select")).setTooltip(w("selectFromGallery")).onClick(()=>{new zr(this.app,this.plugin,c=>{let u=c?c.filePath:"";this.character.profileImagePath=u||void 0,r.setText(`Current: ${this.character.profileImagePath||"None"}`)}).open()})).addButton(l=>l.setButtonText(w("upload")).setTooltip(w("uploadImage")).onClick(async()=>{let c=document.createElement("input");c.type="file",c.accept="image/*",c.onchange=async()=>{var d;let u=(d=c.files)==null?void 0:d[0];if(u)try{await this.plugin.ensureFolder(this.plugin.settings.galleryUploadFolder);let h=Date.now(),f=u.name.replace(/[^\w\s.-]/g,"").replace(/\s+/g,"_"),m=`${h}_${f}`,g=`${this.plugin.settings.galleryUploadFolder}/${m}`,y=await u.arrayBuffer();await this.app.vault.createBinary(g,y),this.character.profileImagePath=g,r.setText(`Current: ${g}`),new kr.Notice(w("imageUploaded",m))}catch(h){console.error("Error uploading image:",h),new kr.Notice(w("errorUploadingImage"))}},c.click()})).addButton(l=>l.setIcon("cross").setTooltip(w("clearImage")).setClass("mod-warning").onClick(()=>{this.character.profileImagePath=void 0,r.setText(`Current: ${this.character.profileImagePath||"None"}`)})),new kr.Setting(e).setName(w("description")).setClass("storyteller-modal-setting-vertical").addTextArea(l=>{l.setPlaceholder(w("characterDescriptionPh")).setValue(this.character.description||"").onChange(c=>{this.character.description=c}),l.inputEl.rows=4,l.inputEl.addClass("storyteller-modal-textarea")}),new kr.Setting(e).setName(w("traits")).setDesc(w("traitsPlaceholder")).addText(l=>l.setPlaceholder(w("traitsPlaceholder")).setValue((this.character.traits||[]).join(", ")).onChange(c=>{this.character.traits=c.split(",").map(u=>u.trim()).filter(u=>u.length>0)})),new kr.Setting(e).setName(w("backstory")).setClass("storyteller-modal-setting-vertical").addTextArea(l=>{l.setPlaceholder(w("characterHistoryPh")).setValue(this.character.backstory||"").onChange(c=>{this.character.backstory=c}),l.inputEl.rows=6,l.inputEl.addClass("storyteller-modal-textarea")}),new kr.Setting(e).setName(w("status")).setDesc(w("statusPlaceholderCharacter")).addText(l=>l.setValue(this.character.status||"").onChange(c=>{this.character.status=c||void 0})),new kr.Setting(e).setName(w("affiliation")).setDesc(w("affiliation")).addText(l=>l.setValue(this.character.affiliation||"").onChange(c=>{this.character.affiliation=c||void 0})),this.groupSelectorContainer=e.createDiv("storyteller-group-selector-container"),this.renderGroupSelector(this.groupSelectorContainer),e.createEl("h3",{text:w("connections")}),this.character.connections||(this.character.connections=[]);let n=e.createDiv("storyteller-modal-linked-entities");this.renderConnectionsList(n),new kr.Setting(e).addButton(l=>l.setButtonText(w("addConnection")).setIcon("plus").onClick(async()=>{let{RelationshipEditorModal:c}=await Promise.resolve().then(()=>($I(),BI));new c(this.app,this.plugin,null,"any",u=>{this.character.connections||(this.character.connections=[]),this.character.connections.push(u),this.renderConnectionsList(n)}).open()})),this.workingCustomFields={...this.character.customFields||{}},e.createEl("h3",{text:w("customFields")});let s=e.createDiv("storyteller-custom-fields-container");this.renderCustomFields(s,this.workingCustomFields),this._groupRefreshInterval=window.setInterval(()=>{this.modalEl.isShown()&&this.groupSelectorContainer&&this.renderGroupSelector(this.groupSelectorContainer)},2e3),new kr.Setting(e).addButton(l=>l.setButtonText(w("addCustomField")).setIcon("plus").onClick(()=>{this.workingCustomFields||(this.workingCustomFields={});let c=this.workingCustomFields,u=new Set([...Vi("character"),"customFields","filePath","id","sections"]),d=h=>{new Qr(this.app,{title:w("customFieldValueTitle"),label:w("valueForX",h),defaultValue:"",onSubmit:f=>{c[h]=f}}).open()};new Qr(this.app,{title:w("newCustomFieldTitle"),label:w("fieldName"),defaultValue:"",validator:h=>{let f=h.trim();return f?u.has(f)?w("thatNameIsReserved"):Object.keys(c).some(g=>g.toLowerCase()===f.toLowerCase())?w("fieldAlreadyExists"):null:w("fieldNameCannotBeEmpty")},onSubmit:h=>d(h.trim())}).open()}));let o=new kr.Setting(e).setClass("storyteller-modal-buttons");!this.isNew&&this.onDelete&&o.addButton(l=>l.setButtonText(w("deleteCharacter")).setClass("mod-warning").onClick(async()=>{if(confirm(w("confirmDeleteCharacter",this.character.name))&&this.onDelete)try{await this.onDelete(this.character),new kr.Notice(w("characterDeleted",this.character.name)),this.close()}catch(c){console.error("Error deleting character:",c),new kr.Notice(w("failedToDelete",w("character")))}})),o.controlEl.createDiv({cls:"storyteller-modal-button-spacer"}),o.addButton(l=>l.setButtonText(w("cancel")).onClick(()=>{this.close()})),o.addButton(l=>l.setButtonText(this.isNew?w("createCharacter"):w("saveChanges")).setCta().onClick(async()=>{var c;if(!((c=this.character.name)!=null&&c.trim())){new kr.Notice(w("characterNameRequired"));return}try{this.character.customFields=this.workingCustomFields,await this.onSubmit(this.character),this.close()}catch(u){console.error("Error saving character:",u),new kr.Notice(w("failedToSave",w("character")))}}))}renderConnectionsList(e){e.empty();let r=this.character.connections||[];if(r.length===0){e.createEl("p",{text:w("noConnectionsYet")||"No connections yet.",cls:"storyteller-modal-list-empty"});return}r.forEach((n,s)=>{let o=e.createDiv("storyteller-modal-list-item"),l=o.createSpan();l.setText(`${n.target} (${w(n.type)})`),n.label&&l.appendText(` - ${n.label}`),new kr.ButtonComponent(o).setClass("storyteller-modal-list-remove").setTooltip(w("removeX",n.target)).setIcon("cross").onClick(()=>{var c;(c=this.character.connections)==null||c.splice(s,1),this.renderConnectionsList(e)})})}renderList(e,r,n){if(e.empty(),!r||r.length===0){e.createEl("span",{text:w("none"),cls:"storyteller-modal-list-empty"});return}r.forEach((s,o)=>{let l=s,c=e.createDiv("storyteller-modal-list-item");c.createSpan({text:l}),new kr.ButtonComponent(c).setClass("storyteller-modal-list-remove").setTooltip(w("removeX",l)).setIcon("cross").onClick(()=>{var u;n==="relationship"&&((u=this.character.relationships)==null||u.splice(o,1)),this.renderList(e,r,n)})})}renderCustomFields(e,r){e.empty(),r=r||{};let n=Object.keys(r);if(n.length===0){e.createEl("p",{text:w("noCustomFields"),cls:"storyteller-modal-list-empty"});return}let s=new Set([...Vi("character"),"customFields","filePath","id","sections"]);n.forEach(o=>{let l=o;new kr.Setting(e).addText(u=>u.setValue(l).setPlaceholder(w("fieldName")).onChange(d=>{let h=d.trim(),f=!Object.keys(r).some(g=>g.toLowerCase()===h.toLowerCase()),m=s.has(h);h&&h!==l&&f&&!m?(r[h]=r[l],delete r[l],l=h):h!==l&&(u.setValue(l),new kr.Notice(w("fieldNameCannotBeEmpty")))})).addText(u=>{var d;return u.setValue(((d=r[l])==null?void 0:d.toString())||"").setPlaceholder(w("fieldValue")).onChange(h=>{r[l]=h})}).addButton(u=>u.setIcon("trash").setTooltip(w("removeFieldX",l)).setClass("mod-warning").onClick(()=>{delete r[l],this.renderCustomFields(e,r)})).controlEl.addClass("storyteller-custom-field-row")})}renderGroupSelector(e){e.empty();let r=this.plugin.getGroups(),n=async()=>{let s=this.character.id||this.character.name,l=(await this.plugin.listCharacters()).find(u=>(u.id||u.name)===s),c=new Set((l==null?void 0:l.groups)||this.character.groups||[]);return this.character.groups=Array.from(c),c};(async()=>{let s=await n();if(new kr.Setting(e).setName(w("groups")).setDesc(w("groupsHelpCharacter")).addDropdown(o=>{o.addOption("",w("selectGroupPlaceholder")),r.forEach(l=>{o.addOption(l.id,l.name)}),o.setValue(""),o.onChange(async l=>{l&&!s.has(l)&&(s.add(l),this.character.groups=Array.from(s),await this.plugin.addMemberToGroup(l,"character",this.character.id||this.character.name),this.renderGroupSelector(e))})}),s.size>0){let o=e.createDiv("selected-groups");r.filter(l=>s.has(l.id)).forEach(l=>{let u=o.createSpan({text:l.name,cls:"group-tag"}).createSpan({text:" \xD7",cls:"remove-group-btn"});u.onclick=async()=>{s.delete(l.id),this.character.groups=Array.from(s),await this.plugin.removeMemberFromGroup(l.id,"character",this.character.id||this.character.name),this.renderGroupSelector(e)}})}})()}async applyTemplateToCharacter(e){if(!e.entities.characters||e.entities.characters.length===0){new kr.Notice("This template does not contain any characters");return}let r=e.entities.characters[0],{templateId:n,sectionContent:s,customYamlFields:o,id:l,filePath:c,...u}=r;if(Object.assign(this.character,u),o&&Object.assign(this.character,o),s)for(let[d,h]of Object.entries(s)){let f=d.toLowerCase().replace(/\s+/g,"");this.character[f]=h}this.character.relationships=[],this.character.connections=[],this.character.groups=[]}refresh(){this.onOpen()}onClose(){this.contentEl.empty(),this._groupRefreshInterval&&clearInterval(this._groupRefreshInterval)}}});var HI={};At(HI,{LocationModal:()=>Cs});var Dr,Cs,Sm=_e(()=>{Dr=require("obsidian");oi();St();Qa();Bl();ea();Nl();es();Cs=class extends hr{constructor(e,r,n,s,o){super(e);this._groupRefreshInterval=null;this.groupSelectorContainer=null;this.plugin=r,this.isNew=n===null;let l=n?{...n}:{name:"",description:"",history:"",locationType:void 0,region:void 0,status:void 0,profileImagePath:void 0,parentLocation:void 0,customFields:{},filePath:void 0,mapId:void 0,relatedMapIds:[],markerIds:[]};l.customFields||(l.customFields={}),l.relatedMapIds||(l.relatedMapIds=[]),l.markerIds||(l.markerIds=[]),n&&n.filePath&&(l.filePath=n.filePath),this.location=l,this.onSubmit=s,this.onDelete=o,this.modalEl.addClass("storyteller-location-modal")}onOpen(){super.onOpen();let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:this.isNew?w("createNewLocation"):`${w("edit")} ${this.location.name}`}),this.isNew&&new Dr.Setting(e).setName("Start from Template").setDesc("Optionally start with a pre-configured location template").addButton(l=>l.setButtonText("Choose Template").setTooltip("Select a location template").onClick(()=>{new Gr(this.app,this.plugin,async c=>{await this.applyTemplateToLocation(c),this.refresh(),new Dr.Notice(`Template "${c.name}" applied`)},"location").open()})),new Dr.Setting(e).setName(w("name")).setDesc(w("locationNameDesc")).addText(l=>l.setPlaceholder(w("enterLocationName")).setValue(this.location.name).onChange(c=>{this.location.name=c}).inputEl.addClass("storyteller-modal-input-large")),new Dr.Setting(e).setName(w("description")).setClass("storyteller-modal-setting-vertical").addTextArea(l=>{l.setPlaceholder(w("locationDescriptionPh")).setValue(this.location.description||"").onChange(c=>{this.location.description=c||void 0}),l.inputEl.rows=4,l.inputEl.addClass("storyteller-modal-textarea")}),new Dr.Setting(e).setName(w("history")).setClass("storyteller-modal-setting-vertical").addTextArea(l=>{l.setPlaceholder(w("locationHistoryPh")).setValue(this.location.history||"").onChange(c=>{this.location.history=c||void 0}),l.inputEl.rows=4,l.inputEl.addClass("storyteller-modal-textarea")}),new Dr.Setting(e).setName(w("type")).setDesc(w("locationTypeDesc")).addText(l=>l.setValue(this.location.locationType||"").onChange(c=>{this.location.locationType=c||void 0})),new Dr.Setting(e).setName(w("region")).setDesc(w("locationRegionDesc")).addText(l=>l.setValue(this.location.region||"").onChange(c=>{this.location.region=c||void 0})),new Dr.Setting(e).setName(w("status")).setDesc(w("locationStatusDesc")).addText(l=>l.setValue(this.location.status||"").onChange(c=>{this.location.status=c||void 0}));let r;new Dr.Setting(e).setName(w("parentLocation")).setDesc("").then(l=>{r=l.descEl.createEl("small",{text:w("currentValue",this.location.parentLocation||w("none"))}),l.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(l=>l.setButtonText(w("selectParentLocation")).setTooltip(w("parentLocationDesc")).onClick(()=>{new fn(this.app,this.plugin,async c=>{if(c){if(await this.wouldCreateCircularReference(c.name)){new Dr.Notice(w("circularLocationError"));return}this.location.parentLocation=c.name}else this.location.parentLocation=void 0;r.setText(`Current: ${this.location.parentLocation||"None"}`)}).open()})).addButton(l=>l.setIcon("cross").setTooltip(w("clearParentLocation")).setClass("mod-warning").onClick(()=>{this.location.parentLocation=void 0,r.setText(`Current: ${this.location.parentLocation||"None"}`)}));let n;new Dr.Setting(e).setName(w("image")).setDesc("").then(l=>{n=l.descEl.createEl("small",{text:w("currentValue",this.location.profileImagePath||w("none"))}),l.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(l=>l.setButtonText(w("selectBtn")).setTooltip("Select from gallery").onClick(()=>{new zr(this.app,this.plugin,c=>{let u=c?c.filePath:"";this.location.profileImagePath=u||void 0,n.setText(`Current: ${this.location.profileImagePath||"None"}`)}).open()})).addButton(l=>l.setButtonText(w("upload")).setTooltip(w("uploadImage")).onClick(async()=>{let c=document.createElement("input");c.type="file",c.accept="image/*",c.onchange=async()=>{var d;let u=(d=c.files)==null?void 0:d[0];if(u)try{await this.plugin.ensureFolder(this.plugin.settings.galleryUploadFolder);let h=Date.now(),f=u.name.replace(/[^\w\s.-]/g,"").replace(/\s+/g,"_"),m=`${h}_${f}`,g=`${this.plugin.settings.galleryUploadFolder}/${m}`,y=await u.arrayBuffer();await this.app.vault.createBinary(g,y),this.location.profileImagePath=g,n.setText(`Current: ${g}`),new Dr.Notice(w("imageUploaded",m))}catch(h){console.error("Error uploading image:",h),new Dr.Notice(w("errorUploadingImage"))}},c.click()})).addButton(l=>l.setIcon("cross").setTooltip("Clear image").setClass("mod-warning").onClick(()=>{this.location.profileImagePath=void 0,n.setText(`Current: ${this.location.profileImagePath||"None"}`)})),e.createEl("h3",{text:w("customFields")});let s=e.createDiv("storyteller-custom-fields-container");this.location.customFields||(this.location.customFields={}),this.renderCustomFields(s,this.location.customFields),new Dr.Setting(e).addButton(l=>l.setButtonText(w("addCustomField")).setIcon("plus").onClick(()=>{this.location.customFields||(this.location.customFields={});let c=this.location.customFields,u=new Set([...Vi("location"),"customFields","filePath","id","sections"]),d=h=>{new Qr(this.app,{title:"Custom field value",label:`Value for "${h}"`,defaultValue:"",onSubmit:f=>{c[h]=f}}).open()};new Qr(this.app,{title:"New custom field",label:"Field name",defaultValue:"",validator:h=>{let f=h.trim();return f?u.has(f)?"That name is reserved":Object.keys(c).some(g=>g.toLowerCase()===f.toLowerCase())?"A field with that name already exists":null:"Field name cannot be empty"},onSubmit:h=>d(h.trim())}).open()})),this.groupSelectorContainer=e.createDiv("storyteller-group-selector-container"),this.renderGroupSelector(this.groupSelectorContainer),this._groupRefreshInterval=window.setInterval(()=>{this.modalEl.isShown()&&this.groupSelectorContainer&&this.renderGroupSelector(this.groupSelectorContainer)},2e3);let o=new Dr.Setting(e).setClass("storyteller-modal-buttons");!this.isNew&&this.onDelete&&o.addButton(l=>l.setButtonText(w("deleteLocation")).setClass("mod-warning").onClick(async()=>{if(confirm(w("confirmDeleteLocation",this.location.name))&&this.onDelete)try{await this.onDelete(this.location),new Dr.Notice(w("locationDeleted",this.location.name)),this.close()}catch(c){console.error("Error deleting location:",c),new Dr.Notice(w("failedToDelete",w("location")))}})),o.controlEl.createDiv({cls:"storyteller-modal-button-spacer"}),o.addButton(l=>l.setButtonText(w("cancel")).onClick(()=>{this.close()})),o.addButton(l=>l.setButtonText(this.isNew?"Create location":"Save changes").setCta().onClick(async()=>{var c;if(!((c=this.location.name)!=null&&c.trim())){new Dr.Notice(w("locationNameRequired"));return}this.location.description=this.location.description||"",this.location.history=this.location.history||"";try{await this.onSubmit(this.location),this.close()}catch(u){console.error("Error saving location:",u),new Dr.Notice(w("failedToSave",w("location")))}}))}renderCustomFields(e,r){e.empty(),r=r||{};let n=Object.keys(r);if(n.length===0){e.createEl("p",{text:w("noCustomFields"),cls:"storyteller-modal-list-empty"});return}let s=new Set([...Vi("location"),"customFields","filePath","id","sections"]);n.forEach(o=>{let l=o;new Dr.Setting(e).addText(u=>u.setValue(l).setPlaceholder(w("fieldNamePh")).onChange(d=>{let h=d.trim(),f=!Object.keys(r).some(g=>g.toLowerCase()===h.toLowerCase()),m=s.has(h);h&&h!==l&&f&&!m?(r[h]=r[l],delete r[l],l=h):h!==l&&(u.setValue(l),new Dr.Notice(w("customFieldError")))})).addText(u=>{var d;return u.setValue(((d=r[l])==null?void 0:d.toString())||"").setPlaceholder(w("fieldValuePh")).onChange(h=>{r[l]=h})}).addButton(u=>u.setIcon("trash").setTooltip(`Remove field "${l}"`).setClass("mod-warning").onClick(()=>{delete r[l],this.renderCustomFields(e,r)})).controlEl.addClass("storyteller-custom-field-row")})}renderRelatedMapsList(e){e.empty();let r=this.location.relatedMapIds||[];if(r.length===0){e.createEl("p",{text:"No related maps",cls:"storyteller-modal-list-empty"});return}r.forEach((n,s)=>{let o=e.createDiv("storyteller-modal-list-item");o.createSpan().setText(n),new Dr.ButtonComponent(o).setClass("storyteller-modal-list-remove").setTooltip(`Remove ${n}`).setIcon("cross").onClick(()=>{var c;(c=this.location.relatedMapIds)==null||c.splice(s,1),this.renderRelatedMapsList(e)})})}renderGroupSelector(e){e.empty();let r=this.plugin.getGroups(),n=async()=>{let s=this.location.id||this.location.name,l=(await this.plugin.listLocations()).find(u=>(u.id||u.name)===s),c=new Set((l==null?void 0:l.groups)||this.location.groups||[]);return this.location.groups=Array.from(c),c};(async()=>{let s=await n();if(new Dr.Setting(e).setName(w("groups")).setDesc(w("assignToGroupsDesc")).addDropdown(o=>{o.addOption("",w("selectGroupPlaceholder")),r.forEach(l=>{o.addOption(l.id,l.name)}),o.setValue(""),o.onChange(async l=>{l&&!s.has(l)&&(s.add(l),this.location.groups=Array.from(s),await this.plugin.addMemberToGroup(l,"location",this.location.id||this.location.name),this.renderGroupSelector(e))})}),s.size>0){let o=e.createDiv("selected-groups");r.filter(l=>s.has(l.id)).forEach(l=>{let u=o.createSpan({text:l.name,cls:"group-tag"}).createSpan({text:" \xD7",cls:"remove-group-btn"});u.onclick=async()=>{s.delete(l.id),this.location.groups=Array.from(s),await this.plugin.removeMemberFromGroup(l.id,"location",this.location.id||this.location.name),this.renderGroupSelector(e)}})}})()}async wouldCreateCircularReference(e){if(e===this.location.name)return!0;let r=await this.plugin.listLocations(),n=new Map;r.forEach(l=>{n.set(l.name,l)});let s=n.get(e),o=new Set;for(;s&&s.parentLocation;){if(o.has(s.name)||(o.add(s.name),s.parentLocation===this.location.name))return!0;s=n.get(s.parentLocation)}return!1}async applyTemplateToLocation(e){if(!e.entities.locations||e.entities.locations.length===0){new Dr.Notice("This template does not contain any locations");return}let r=e.entities.locations[0],{templateId:n,sectionContent:s,customYamlFields:o,id:l,filePath:c,...u}=r;if(Object.assign(this.location,u),o&&Object.assign(this.location,o),s)for(let[d,h]of Object.entries(s)){let f=d.toLowerCase().replace(/\s+/g,"");this.location[f]=h}this.location.connections=[],this.location.groups=[]}refresh(){this.onOpen()}onClose(){this.contentEl.empty(),this._groupRefreshInterval&&clearInterval(this._groupRefreshInterval)}}});var GI={};At(GI,{EraManager:()=>tn});var tn,xm=_e(()=>{nh();tn=class a{constructor(t){this.plugin=t}async getEras(){return this.plugin.settings.timelineEras||[]}async saveEras(t){this.plugin.settings.timelineEras=t,await this.plugin.saveSettings()}async addEra(t){let e=await this.getEras(),r=a.validateEra(t);if(!r.valid)throw new Error(`Invalid era: ${r.errors.join(", ")}`);if(t.id||(t.id=`era-${Date.now()}`),e.find(n=>n.id===t.id)&&(t.id=`era-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),t.sortOrder===void 0){let n=Math.max(...e.map(s=>s.sortOrder||0),-1);t.sortOrder=n+1}return e.push(t),await this.saveEras(e),t}async updateEra(t,e){let r=await this.getEras(),n=r.findIndex(l=>l.id===t);if(n===-1)return null;let s={...r[n],...e,id:t},o=a.validateEra(s);if(!o.valid)throw new Error(`Invalid era: ${o.errors.join(", ")}`);return r[n]=s,await this.saveEras(r),s}async deleteEra(t){let e=await this.getEras();e.forEach(n=>{n.parentEraId===t&&(n.parentEraId=void 0)});let r=e.filter(n=>n.id!==t);return r.length===e.length-1?(await this.saveEras(r),!0):!1}async getEra(t){return(await this.getEras()).find(r=>r.id===t)||null}async getChildEras(t){return(await this.getEras()).filter(r=>r.parentEraId===t)}async getTopLevelEras(){return(await this.getEras()).filter(e=>!e.parentEraId)}async getEraHierarchy(){let t=await this.getEras();return t.filter(r=>!r.parentEraId).map(r=>({era:r,children:t.filter(n=>n.parentEraId===r.id)}))}async toggleEraVisibility(t){let e=await this.getEra(t);return e?(e.visible=!e.visible,await this.updateEra(t,{visible:e.visible}),e.visible):!1}async autoAssignEventsToAllEras(){let t=await this.getEras(),e=await this.plugin.listEvents(),r=a.autoAssignEventsToEras(e,t),n=0;for(let[s,o]of r){let l=await this.getEra(s);l&&(l.events=o,await this.updateEra(s,{events:o}),n+=o.length)}return n}async getEraStats(t){let e=await this.getEra(t);if(!e)return null;let r=await this.getChildEras(t),n=await this.plugin.listEvents();return{eventCount:a.getEventsInEra(e,n).length,duration:a.getEraDuration(e),childCount:r.length}}static getErasForDateRange(t,e,r){let n=Pt(e),s=Pt(r);return!n.start||!s.start?[]:t.filter(o=>{let l=Pt(o.startDate),c=Pt(o.endDate);return!l.start||!c.start?!1:l.start<=s.start&&c.start>=n.start})}static getEventsInEra(t,e){let r=Pt(t.startDate),n=Pt(t.endDate);return!r.start||!n.start?[]:e.filter(s=>{if(!s.dateTime)return!1;let o=Pt(s.dateTime);if(!o.start)return!1;let l=o.start,c=o.end||o.start;return l>=r.start&&c<=n.start})}static detectEraOverlaps(t){let e=[];for(let r=0;r<t.length;r++)for(let n=r+1;n<t.length;n++){let s=t[r],o=t[n],l=Pt(s.startDate),c=Pt(s.endDate),u=Pt(o.startDate),d=Pt(o.endDate);if(!(!l.start||!c.start||!u.start||!d.start)&&l.start<=d.start&&c.start>=u.start){let h;l.start<=u.start&&c.start>=d.start||u.start<=l.start&&d.start>=c.start?h="nested":l.start.equals(u.start)&&c.start.equals(d.start)?h="complete":h="partial",e.push({era1:s,era2:o,overlapType:h})}}return e}static autoAssignEventsToEras(t,e){let r=new Map;for(let n of e){let o=this.getEventsInEra(n,t).map(l=>l.id||l.name).filter(l=>l);r.set(n.id,o)}return r}static getVisibleEras(t){return t.filter(e=>e.visible!==!1).sort((e,r)=>{if(e.sortOrder!==void 0&&r.sortOrder!==void 0)return e.sortOrder-r.sortOrder;if(e.sortOrder!==void 0)return-1;if(r.sortOrder!==void 0)return 1;let n=Pt(e.startDate),s=Pt(r.startDate);return!n.start||!s.start?0:n.start<s.start?-1:1})}static findErasForEvent(t,e){if(!t.dateTime)return[];let r=Pt(t.dateTime);return r.start?e.filter(n=>{let s=Pt(n.startDate),o=Pt(n.endDate);if(!s.start||!o.start)return!1;let l=r.start,c=r.end||r.start;return l>=s.start&&c<=o.start}):[]}static generateEraColor(){let t=Math.floor(Math.random()*360),e=60+Math.floor(Math.random()*20),r=85+Math.floor(Math.random()*10),n=t/360,s=e/100,o=r/100,l=(m,g,y)=>(y<0&&(y+=1),y>1&&(y-=1),y<1/6?m+(g-m)*6*y:y<1/2?g:y<2/3?m+(g-m)*(2/3-y)*6:m),c=o<.5?o*(1+s):o+s-o*s,u=2*o-c,d=Math.round(l(u,c,n+1/3)*255),h=Math.round(l(u,c,n)*255),f=Math.round(l(u,c,n-1/3)*255);return`#${d.toString(16).padStart(2,"0")}${h.toString(16).padStart(2,"0")}${f.toString(16).padStart(2,"0")}`}static validateEra(t){let e=[];(!t.name||t.name.trim()==="")&&e.push("Era name is required"),(!t.startDate||t.startDate.trim()==="")&&e.push("Start date is required"),(!t.endDate||t.endDate.trim()==="")&&e.push("End date is required");let r=Pt(t.startDate),n=Pt(t.endDate);return r.error&&e.push(`Invalid start date: ${r.error}`),n.error&&e.push(`Invalid end date: ${n.error}`),r.start&&n.start&&r.start>n.start&&e.push("Start date must be before or equal to end date"),{valid:e.length===0,errors:e}}static getEraDuration(t){let e=Pt(t.startDate),r=Pt(t.endDate);if(!e.start||!r.start)return"Unknown duration";let n=r.start.diff(e.start,["years","months","days"]);if(n.years>0){let s=Math.round(n.months);return`${Math.round(n.years)} year${n.years!==1?"s":""}${s>0?`, ${s} month${s!==1?"s":""}`:""}`}else if(n.months>0){let s=Math.round(n.days);return`${Math.round(n.months)} month${n.months!==1?"s":""}${s>0?`, ${s} day${s!==1?"s":""}`:""}`}else return`${Math.round(n.days)} day${n.days!==1?"s":""}`}}});var VI={};At(VI,{EventModal:()=>ts});var xt,ts,uh=_e(()=>{xt=require("obsidian");oi();St();Qa();Nl();ru();Bl();iu();es();ts=class extends xt.Modal{constructor(e,r,n,s,o){super(e);this._groupRefreshInterval=null;this.groupSelectorContainer=null;this.forkSelectorContainer=null;this.plugin=r,this.isNew=n===null;let l=n?{...n}:{name:"",dateTime:"",description:"",outcome:"",status:void 0,profileImagePath:void 0,characters:[],location:void 0,images:[],customFields:{},groups:[],isMilestone:!1,dependencies:[],progress:0};l.customFields||(l.customFields={}),l.characters||(l.characters=[]),l.images||(l.images=[]),l.groups||(l.groups=[]),l.dependencies||(l.dependencies=[]),l.isMilestone===void 0&&(l.isMilestone=!1),l.progress===void 0&&(l.progress=0),this.event=l,this.onSubmit=s,this.onDelete=o,this.modalEl.addClass("storyteller-event-modal")}onOpen(){var _;let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:this.isNew?w("createNewEvent"):`${w("edit")} ${this.event.name}`}),this.isNew&&new xt.Setting(e).setName("Start from Template").setDesc("Optionally start with a pre-configured event template").addButton(x=>x.setButtonText("Choose Template").setTooltip("Select an event template").onClick(()=>{new Gr(this.app,this.plugin,async P=>{await this.applyTemplateToEvent(P),this.refresh(),new xt.Notice(`Template "${P.name}" applied`)},"event").open()})),new xt.Setting(e).setName(w("name")).setDesc(w("name")).addText(x=>x.setPlaceholder(w("enterEventName")).setValue(this.event.name).onChange(P=>{this.event.name=P}).inputEl.addClass("storyteller-modal-input-large"));let r=new xt.Setting(e).setName(w("dateTime")).setDesc(w("statusPlaceholderEvent")).addText(x=>x.setPlaceholder(w("enterDateTime")).setValue(this.event.dateTime||"").onChange(P=>{this.event.dateTime=P||void 0}));new xt.Setting(e).setName(w("description")).setClass("storyteller-modal-setting-vertical").addTextArea(x=>{x.setPlaceholder(w("eventDescriptionPh")).setValue(this.event.description||"").onChange(P=>{this.event.description=P||void 0}),x.inputEl.rows=4,x.inputEl.addClass("storyteller-modal-textarea")}),new xt.Setting(e).setName(w("outcome")).setClass("storyteller-modal-setting-vertical").addTextArea(x=>{x.setPlaceholder(w("eventOutcomePh")).setValue(this.event.outcome||"").onChange(P=>{this.event.outcome=P||void 0}),x.inputEl.rows=3,x.inputEl.addClass("storyteller-modal-textarea")}),new xt.Setting(e).setName(w("status")).setDesc(w("statusPlaceholderEvent")).addText(x=>x.setValue(this.event.status||"").onChange(P=>{this.event.status=P||void 0})),new xt.Setting(e).setName("Milestone").setDesc("Mark this event as a key story moment").addToggle(x=>x.setValue(this.event.isMilestone||!1).onChange(P=>{this.event.isMilestone=P})),new xt.Setting(e).setName("Progress").setDesc("Completion percentage (0-100)").addSlider(x=>x.setLimits(0,100,5).setValue(this.event.progress||0).setDynamicTooltip().onChange(P=>{this.event.progress=P}));let n=new xt.Setting(e).setName("Dependencies").setDesc("Events that must occur before this one"),s=n.controlEl.createDiv("storyteller-modal-list"),o=()=>{s.empty(),!this.event.dependencies||this.event.dependencies.length===0?s.createEl("span",{text:w("none"),cls:"storyteller-modal-list-empty"}):this.event.dependencies.forEach((x,P)=>{let I=s.createDiv("storyteller-modal-list-item");I.createSpan({text:x}),new xt.ButtonComponent(I).setClass("storyteller-modal-list-remove").setTooltip(`Remove ${x}`).setIcon("cross").onClick(()=>{var M;(M=this.event.dependencies)==null||M.splice(P,1),o()})})};o(),n.addButton(x=>x.setButtonText("Add Dependency").setTooltip("Add event dependency").setCta().onClick(()=>{new Rn(this.app,this.plugin,P=>{P&&P.name&&(this.event.dependencies||(this.event.dependencies=[]),this.event.dependencies.includes(P.name)?new xt.Notice(`Dependency "${P.name}" already added.`):(this.event.dependencies.push(P.name),o()))}).open()})),this.event.narrativeMarkers||(this.event.narrativeMarkers={}),new xt.Setting(e).setName("Flashback").setDesc("Mark this event as a flashback (occurs earlier than narrated)").addToggle(x=>{var P;return x.setValue(((P=this.event.narrativeMarkers)==null?void 0:P.isFlashback)||!1).onChange(I=>{this.event.narrativeMarkers||(this.event.narrativeMarkers={}),this.event.narrativeMarkers.isFlashback=I})}),new xt.Setting(e).setName("Flash-forward").setDesc("Mark this event as a flash-forward (occurs later than narrated)").addToggle(x=>{var P;return x.setValue(((P=this.event.narrativeMarkers)==null?void 0:P.isFlashforward)||!1).onChange(I=>{this.event.narrativeMarkers||(this.event.narrativeMarkers={}),this.event.narrativeMarkers.isFlashforward=I})}),new xt.Setting(e).setName("Narrative Date").setDesc("When this event is narrated in the story (if different from chronological date)").addText(x=>{var P;return x.setValue(((P=this.event.narrativeMarkers)==null?void 0:P.narrativeDate)||"").setPlaceholder("e.g., 2024-01-15").onChange(I=>{this.event.narrativeMarkers||(this.event.narrativeMarkers={}),this.event.narrativeMarkers.narrativeDate=I||void 0})});let l=new xt.Setting(e).setName("Frame Event").setDesc("The event from which this flashback/flash-forward is told"),c=l.controlEl.createSpan({text:((_=this.event.narrativeMarkers)==null?void 0:_.targetEvent)||"None",cls:"storyteller-modal-target-event"});l.addButton(x=>x.setButtonText("Select Event").onClick(()=>{new Rn(this.app,this.plugin,P=>{P&&P.name&&(this.event.narrativeMarkers||(this.event.narrativeMarkers={}),this.event.narrativeMarkers.targetEvent=P.name,c.setText(P.name))}).open()})).addButton(x=>x.setButtonText("Clear").onClick(()=>{this.event.narrativeMarkers||(this.event.narrativeMarkers={}),this.event.narrativeMarkers.targetEvent=void 0,c.setText("None")})),new xt.Setting(e).setName("Narrative Context").setDesc("Description of how this event is narrated or framed in the story").addTextArea(x=>{var P;x.setValue(((P=this.event.narrativeMarkers)==null?void 0:P.narrativeContext)||"").setPlaceholder('e.g., "Told by the protagonist in a fever dream"').onChange(I=>{this.event.narrativeMarkers||(this.event.narrativeMarkers={}),this.event.narrativeMarkers.narrativeContext=I||void 0}),x.inputEl.rows=3});let u;new xt.Setting(e).setName(w("image")).setDesc("").then(x=>{u=x.descEl.createEl("small",{text:w("currentValue",this.event.profileImagePath||w("none"))}),x.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(x=>x.setButtonText(w("select")).setTooltip(w("selectFromGallery")).onClick(()=>{new zr(this.app,this.plugin,P=>{let I=P?P.filePath:"";this.event.profileImagePath=I||void 0,u.setText(`Current: ${this.event.profileImagePath||"None"}`)}).open()})).addButton(x=>x.setButtonText(w("upload")).setTooltip(w("uploadImage")).onClick(async()=>{let P=document.createElement("input");P.type="file",P.accept="image/*",P.onchange=async()=>{var M;let I=(M=P.files)==null?void 0:M[0];if(I)try{await this.plugin.ensureFolder(this.plugin.settings.galleryUploadFolder);let O=Date.now(),R=I.name.replace(/[^\w\s.-]/g,"").replace(/\s+/g,"_"),F=`${O}_${R}`,$=`${this.plugin.settings.galleryUploadFolder}/${F}`,k=await I.arrayBuffer();await this.app.vault.createBinary($,k),this.event.profileImagePath=$,u.setText(`Current: ${$}`),new xt.Notice(w("imageUploaded",F))}catch(O){console.error("Error uploading image:",O),new xt.Notice(w("errorUploadingImage"))}},P.click()})).addButton(x=>x.setIcon("cross").setTooltip(w("clearImage")).setClass("mod-warning").onClick(()=>{this.event.profileImagePath=void 0,u.setText(`Current: ${this.event.profileImagePath||"None"}`)})),e.createEl("h3",{text:w("links")});let d=new xt.Setting(e).setName(w("charactersInvolved")).setDesc(w("characters"));this.charactersListEl=d.controlEl.createDiv("storyteller-modal-list"),this.renderList(this.charactersListEl,this.event.characters||[],"character"),d.addButton(x=>x.setButtonText(w("addCharacter")).setTooltip(w("addCharacter")).setCta().onClick(()=>{new Fn(this.app,this.plugin,P=>{P&&P.name&&(this.event.characters||(this.event.characters=[]),this.event.characters.includes(P.name)?new xt.Notice(w("characterLinkedAlready",P.name)):(this.event.characters.push(P.name),this.renderList(this.charactersListEl,this.event.characters,"character")))}).open()})),this.locationSetting=new xt.Setting(e).setName(w("location")).setDesc(w("currentValue",this.event.location||w("none"))),this.locationSetting.addButton(x=>{this.selectLocationButton=x,x.setTooltip(w("selectLocation")).onClick(()=>{new fn(this.app,this.plugin,P=>{let I=P?P.name:void 0;this.event.location=I,this.locationSetting.setDesc(`${w("current")}: ${this.event.location||w("none")}`),this.updateLocationClearButton(),this.renderList(this.charactersListEl,this.event.characters||[],"character")}).open()})}),this.updateLocationClearButton();let h=new xt.Setting(e).setName(w("associatedImages")).setDesc(w("imageGallery"));this.imagesListEl=h.controlEl.createDiv("storyteller-modal-list"),this.renderList(this.imagesListEl,this.event.images||[],"image"),h.addButton(x=>x.setButtonText(w("addImage")).setTooltip(w("selectFromGallery")).setCta().onClick(()=>{new zr(this.app,this.plugin,P=>{if(P&&P.filePath){let I=P.filePath;this.event.images||(this.event.images=[]),this.event.images.includes(I)||(this.event.images.push(I),this.renderList(this.imagesListEl,this.event.images,"image"))}}).open()})),e.createEl("h3",{text:"Tags"});let f=new xt.Setting(e).setName("Event Tags").setDesc("Tags for categorization and filtering"),m=f.controlEl.createDiv("storyteller-modal-list"),g=()=>{m.empty(),!this.event.tags||this.event.tags.length===0?m.createEl("span",{text:"No tags",cls:"storyteller-modal-list-empty"}):this.event.tags.forEach((x,P)=>{let I=m.createDiv("storyteller-modal-list-item");I.createSpan({text:x}),new xt.ButtonComponent(I).setClass("storyteller-modal-list-remove").setTooltip(`Remove tag: ${x}`).setIcon("cross").onClick(()=>{var M;(M=this.event.tags)==null||M.splice(P,1),g()})})};g(),f.addButton(x=>x.setButtonText("Add Tag").setTooltip("Add a tag to this event").setCta().onClick(()=>{new Qr(this.app,{title:"Add Tag",label:"Tag name",defaultValue:"",onSubmit:P=>{let I=P.trim();I&&(this.event.tags||(this.event.tags=[]),this.event.tags.includes(I)?new xt.Notice(`Tag "${I}" already added.`):(this.event.tags.push(I),g()))}}).open()})),e.createEl("h3",{text:"Timeline Eras"});let y=this.plugin.settings.timelineEras||[];if(y.length>0){e.createEl("p",{text:"This event belongs to the following timeline eras based on its date:",cls:"storyteller-modal-description"});let x=e.createDiv("storyteller-era-badges-container");Promise.resolve().then(()=>(xm(),GI)).then(({EraManager:P})=>{let I=P.findErasForEvent(this.event,y);if(I.length===0)x.createEl("span",{text:"None (event date does not fall within any era)",cls:"storyteller-era-no-match"});else for(let M of I){let O=x.createDiv("storyteller-era-badge");M.color&&(O.style.borderLeftColor=M.color),O.createEl("strong",{text:M.name}),O.createEl("span",{text:` (${M.startDate} \u2192 ${M.endDate})`,cls:"storyteller-era-badge-dates"})}})}else e.createEl("p",{text:'No timeline eras have been created yet. Use the "Manage timeline eras" command to create eras.',cls:"storyteller-modal-description storyteller-era-empty-state"});e.createEl("h3",{text:w("customFields")});let v=e.createDiv("storyteller-custom-fields-container");this.event.customFields||(this.event.customFields={}),this.renderCustomFields(v,this.event.customFields),new xt.Setting(e).addButton(x=>x.setButtonText(w("addCustomField")).setIcon("plus").onClick(()=>{this.event.customFields||(this.event.customFields={});let P=this.event.customFields,I=new Set([...Vi("event"),"customFields","filePath","id","sections"]),M=O=>{new Qr(this.app,{title:"Custom field value",label:`Value for "${O}"`,defaultValue:"",onSubmit:R=>{P[O]=R}}).open()};new Qr(this.app,{title:"New custom field",label:"Field name",defaultValue:"",validator:O=>{let R=O.trim();return R?I.has(R)?"That name is reserved":Object.keys(P).some($=>$.toLowerCase()===R.toLowerCase())?"A field with that name already exists":null:"Field name cannot be empty"},onSubmit:O=>M(O.trim())}).open()})),e.createEl("h3",{text:w("groups")}),this.groupSelectorContainer=e.createDiv("storyteller-group-selector-container"),this.renderGroupSelector(this.groupSelectorContainer),this._groupRefreshInterval=window.setInterval(()=>{this.modalEl.isShown()&&this.groupSelectorContainer&&this.renderGroupSelector(this.groupSelectorContainer)},2e3),this.plugin.getTimelineForks().length>0&&(e.createEl("h3",{text:"Timeline Forks"}),e.createEl("p",{text:"Assign this event to alternate timeline forks",cls:"storyteller-modal-description"}),this.forkSelectorContainer=e.createDiv("storyteller-fork-selector-container"),this.renderForkSelector(this.forkSelectorContainer));let C=new xt.Setting(e).setClass("storyteller-modal-buttons");!this.isNew&&this.onDelete&&C.addButton(x=>x.setButtonText(w("deleteEvent")).setClass("mod-warning").onClick(async()=>{if(confirm(w("confirmDeleteEvent",this.event.name))&&this.onDelete)try{await this.onDelete(this.event),this.close()}catch(P){console.error("Error deleting event:",P),new xt.Notice(w("workspaceLeafCreateError"))}})),C.controlEl.createDiv({cls:"storyteller-modal-button-spacer"}),C.addButton(x=>x.setButtonText(w("cancel")).onClick(()=>{this.close()})),C.addButton(x=>x.setButtonText(this.isNew?w("createNewEvent"):w("saveChanges")).setCta().onClick(async()=>{var P;if(!((P=this.event.name)!=null&&P.trim())){new xt.Notice(w("eventNameRequired"));return}this.event.description=this.event.description||"",this.event.outcome=this.event.outcome||"";try{await this.onSubmit(this.event),this.close()}catch(I){console.error("Error saving event:",I),new xt.Notice(w("workspaceLeafRevealError"))}}))}updateLocationClearButton(){if(!this.locationSetting||!this.locationSetting.controlEl)return;let r=this.locationSetting.controlEl.querySelector(".storyteller-clear-location-button");this.selectLocationButton&&this.selectLocationButton.setButtonText(this.event.location?"Change location":"Select location"),this.event.location&&!r?this.locationSetting.addButton(n=>n.setIcon("cross").setTooltip("Clear location (set to none)").setClass("mod-warning").setClass("storyteller-clear-location-button").onClick(()=>{this.event.location=void 0,this.locationSetting.setDesc(w("currentValue",this.event.location||w("none"))),this.updateLocationClearButton()})):!this.event.location&&r&&r.remove()}renderList(e,r,n){if(e.empty(),!r||r.length===0){e.createEl("span",{text:w("none"),cls:"storyteller-modal-list-empty"});return}r.forEach((s,o)=>{let l=e.createDiv("storyteller-modal-list-item");l.createSpan({text:s}),new xt.ButtonComponent(l).setClass("storyteller-modal-list-remove").setTooltip(`Remove ${s}`).setIcon("cross").onClick(()=>{n==="character"&&this.event.characters?this.event.characters.splice(o,1):n==="image"&&this.event.images&&this.event.images.splice(o,1),this.renderList(e,r,n)})})}renderCustomFields(e,r){e.empty(),r=r||{};let n=Object.keys(r);if(n.length===0){e.createEl("p",{text:w("noCustomFields"),cls:"storyteller-modal-list-empty"});return}let s=new Set([...Vi("event"),"customFields","filePath","id","sections"]);n.forEach(o=>{let l=o,c=new xt.Setting(e).addText(u=>u.setValue(l).setPlaceholder(w("fieldNamePh")).onChange(d=>{let h=d.trim(),f=!Object.keys(r).some(g=>g.toLowerCase()===h.toLowerCase()),m=s.has(h);h&&h!==l&&f&&!m?(r[h]=r[l],delete r[l],l=h):h!==l&&(u.setValue(l),new xt.Notice(w("customFieldError")))})).addText(u=>{var d;return u.setValue(((d=r[l])==null?void 0:d.toString())||"").setPlaceholder(w("fieldValuePh")).onChange(h=>{r[l]=h})}).addButton(u=>u.setIcon("trash").setTooltip(`Remove field "${l}"`).setClass("mod-warning").onClick(()=>{delete r[l],this.renderCustomFields(e,r)}));c.controlEl.addClass("storyteller-custom-field-row"),c.infoEl.addClass("storyteller-custom-field-key")})}renderGroupSelector(e){e.empty();let r=this.plugin.getGroups(),n=async()=>{let s=this.event.id||this.event.name,l=(await this.plugin.listEvents()).find(u=>(u.id||u.name)===s),c=new Set((l==null?void 0:l.groups)||this.event.groups||[]);return this.event.groups=Array.from(c),c};(async()=>{let s=await n();if(new xt.Setting(e).setName(w("groups")).setDesc(w("assignEventToGroupsDesc")).addDropdown(o=>{o.addOption("",w("selectGroupPlaceholder")),r.forEach(l=>{o.addOption(l.id,l.name)}),o.setValue(""),o.onChange(async l=>{l&&!s.has(l)&&(s.add(l),this.event.groups=Array.from(s),await this.plugin.addMemberToGroup(l,"event",this.event.id||this.event.name),this.renderGroupSelector(e))})}),s.size>0){let o=e.createDiv("selected-groups");r.filter(l=>s.has(l.id)).forEach(l=>{let u=o.createSpan({text:l.name,cls:"group-tag"}).createSpan({text:" \u251C\xF9",cls:"remove-group-btn"});u.onclick=async()=>{s.delete(l.id),this.event.groups=Array.from(s),await this.plugin.removeMemberFromGroup(l.id,"event",this.event.id||this.event.name),this.renderGroupSelector(e)}})}})()}renderForkSelector(e){e.empty();let r=this.plugin.getTimelineForks(),n=this.event.id||this.event.name,s=new Set;if(r.forEach(o=>{var l;(l=o.forkEvents)!=null&&l.includes(n)&&s.add(o.id)}),new xt.Setting(e).setName("Timeline Forks").setDesc("Add this event to alternate timelines").addDropdown(o=>{o.addOption("","-- Select a fork --"),r.forEach(l=>{s.has(l.id)||o.addOption(l.id,l.name)}),o.setValue(""),o.onChange(async l=>{l&&(await this.plugin.addEventToFork(l,n),s.add(l),this.renderForkSelector(e))})}),s.size>0){let o=e.createDiv("selected-forks");o.style.marginTop="8px",r.filter(l=>s.has(l.id)).forEach(l=>{let c=o.createSpan({cls:"fork-tag"});c.style.display="inline-flex",c.style.alignItems="center",c.style.padding="2px 8px",c.style.marginRight="4px",c.style.marginBottom="4px",c.style.borderRadius="4px",c.style.backgroundColor=l.color||"#666",c.style.color="#fff",c.style.fontSize="12px",c.createSpan({text:l.name});let u=c.createSpan({text:" x",cls:"remove-fork-btn"});u.style.cursor="pointer",u.style.marginLeft="4px",u.style.fontWeight="bold",u.onclick=async()=>{await this.plugin.removeEventFromFork(l.id,n),s.delete(l.id),this.renderForkSelector(e)}})}}async applyTemplateToEvent(e){if(!e.entities.events||e.entities.events.length===0){new xt.Notice("This template does not contain any events");return}let r=e.entities.events[0],{templateId:n,sectionContent:s,customYamlFields:o,id:l,filePath:c,...u}=r;if(Object.assign(this.event,u),o&&Object.assign(this.event,o),s)for(let[d,h]of Object.entries(s)){let f=d.toLowerCase().replace(/\s+/g,"");this.event[f]=h}this.event.characters=[],this.event.connections=[],this.event.groups=[],this.event.dependencies=[]}refresh(){this.onOpen()}onClose(){this.contentEl.empty(),this._groupRefreshInterval&&clearInterval(this._groupRefreshInterval)}}});var Vr,au=_e(()=>{gC();nh();Vr=class{static detectAllConflicts(t){let e=[];return e.push(...this.detectCharacterLocationConflicts(t)),e.push(...this.detectDeathConflicts(t)),e.push(...this.detectDependencyConflicts(t)),e.push(...this.detectTemporalConflicts(t)),e}static detectCharacterLocationConflicts(t){let e=[],r=new Set;t.forEach(n=>{var s;(s=n.characters)==null||s.forEach(o=>r.add(o))});for(let n of r){let o=t.filter(l=>{var c;return((c=l.characters)==null?void 0:c.includes(n))&&l.dateTime&&l.location}).sort((l,c)=>{let u=Pt(l.dateTime),d=Pt(c.dateTime);return!u.start||!d.start?0:u.start<d.start?-1:1});for(let l=0;l<o.length;l++)for(let c=l+1;c<o.length;c++){let u=o[l],d=o[c];if(u.location===d.location)continue;let h=this.checkEventOverlap(u,d);if(h){let f=u.id||u.name.replace(/[^a-zA-Z0-9]/g,""),m=d.id||d.name.replace(/[^a-zA-Z0-9]/g,"");e.push({id:`conflict-${n}-${f}-${m}`,type:"location",severity:h.approximate?"warning":"error",message:`${n} is in two different locations at the same time`,events:[u,d],character:n,details:{timeOverlap:h.overlap,locations:[u.location,d.location],description:`${n} cannot be at two different locations simultaneously. Events: "${u.name}" and "${d.name}"`}})}}}return e}static detectDeathConflicts(t){let e=[],r=new Map;return t.forEach(n=>{var o,l,c,u;if(!n.characters||!n.dateTime)return;if(n.name.toLowerCase().includes("death")||((o=n.description)==null?void 0:o.toLowerCase().includes("dies"))||((l=n.description)==null?void 0:l.toLowerCase().includes("died"))||((c=n.description)==null?void 0:c.toLowerCase().includes("killed"))||((u=n.tags)==null?void 0:u.some(d=>d.toLowerCase().includes("death")))){let d=Pt(n.dateTime);d.start&&n.characters.forEach(h=>{let f=r.get(h);(!f||d.start<f.date)&&r.set(h,{event:n,date:d.start})})}}),r.forEach((n,s)=>{let o=t.filter(l=>{var u;if(!((u=l.characters)!=null&&u.includes(s))||!l.dateTime||l===n.event)return!1;let c=Pt(l.dateTime);return c.start&&c.start>n.date});if(o.length>0){let l=n.event.id||n.event.name.replace(/[^a-zA-Z0-9]/g,"");e.push({id:`conflict-death-${s}-${l}`,type:"character",severity:"error",message:`${s} appears in events after their death`,events:[n.event,...o],character:s,details:{description:`${s} died in "${n.event.name}" (${n.event.dateTime}) but appears in ${o.length} event(s) after death: ${o.map(c=>c.name).join(", ")}`}})}}),e}static detectDependencyConflicts(t){let e=[],r=new Map(t.map(n=>[n.name,n]));for(let n of t){if(!n.dependencies||n.dependencies.length===0)continue;let s=n.dependencies.filter(l=>!r.has(l));s.length>0&&e.push({id:`conflict-dep-missing-${n.name}`,type:"dependency",severity:"warning",message:`Event "${n.name}" has missing dependencies`,events:[n],details:{description:`Missing dependencies: ${s.join(", ")}`}});for(let l of n.dependencies){let c=r.get(l);if(!c||!c.dateTime||!n.dateTime)continue;let u=Pt(n.dateTime),d=Pt(c.dateTime);!u.start||!d.start||u.start<d.start&&e.push({id:`conflict-dep-temporal-${n.name}-${l}`,type:"dependency",severity:"error",message:`Event "${n.name}" occurs before its dependency "${l}"`,events:[n,c],details:{description:`"${n.name}" (${n.dateTime}) depends on "${l}" (${c.dateTime}), but occurs earlier`}})}let o=this.detectCircularDependencies(n,r,new Set);if(o.length>0){let l=o.map(c=>r.get(c)).filter(c=>c);e.push({id:`conflict-dep-circular-${n.name}`,type:"dependency",severity:"error",message:`Circular dependency detected involving "${n.name}"`,events:l,details:{description:`Circular dependency chain: ${o.join(" \u2192 ")}`}})}}return e}static detectTemporalConflicts(t){let e=[],r=t.filter(n=>n.isMilestone&&n.dateTime);for(let n=0;n<r.length;n++)for(let s=n+1;s<r.length;s++){let o=r[n],l=r[s],c=Pt(o.dateTime),u=Pt(l.dateTime);if(!c.start||!u.start)continue;if(Math.abs(u.start.diff(c.start,"minutes").minutes)<1){let h=o.id||o.name.replace(/[^a-zA-Z0-9]/g,""),f=l.id||l.name.replace(/[^a-zA-Z0-9]/g,"");e.push({id:`conflict-temporal-milestone-${h}-${f}`,type:"temporal",severity:"info",message:"Multiple milestones at the same time",events:[o,l],details:{description:`Milestones "${o.name}" and "${l.name}" occur at the same time (${o.dateTime})`}})}}return e}static checkEventOverlap(t,e){if(!t.dateTime||!e.dateTime)return null;let r=Pt(t.dateTime),n=Pt(e.dateTime);if(!r.start||!n.start)return null;let s=d=>{let h=d.start,f=d.end;return d.precision==="day"?(h=h.startOf("day"),f?f=f.startOf("day").plus({days:1}):f=h.plus({days:1})):d.precision==="month"?(h=h.startOf("month"),f?f=f.startOf("month").plus({months:1}):f=h.plus({months:1})):d.precision==="year"?(h=h.startOf("year"),f?f=f.startOf("year").plus({years:1}):f=h.plus({years:1})):f||(f=h.plus({hours:1})),{start:h,end:f}},o=s(r),l=s(n),c=gt.max(o.start,l.start),u=gt.min(o.end,l.end);return c<u?{overlap:{start:c,end:u},approximate:r.approximate||n.approximate||!1}:null}static detectCircularDependencies(t,e,r,n=[]){if(!t.name)return[];if(n.includes(t.name))return[...n,t.name];if(r.has(t.name))return[];r.add(t.name);let s=[...n,t.name];for(let o of t.dependencies||[]){let l=e.get(o);if(!l)continue;let c=this.detectCircularDependencies(l,e,r,s);if(c.length>0)return c}return[]}static getConflictsForCharacter(t,e){return e.filter(r=>r.character===t)}static getConflictsForEvent(t,e){return e.filter(r=>r.events.some(n=>n.name===t))}static getConflictsBySeverity(t,e){return e.filter(r=>r.severity===t)}static getConflictsByType(t,e){return e.filter(r=>r.type===t)}static toStorageFormat(t){return t.map(e=>{let r=[];e.character&&r.push({entityId:e.character,entityType:"character",entityName:e.character});let n=e.severity==="error"?"critical":e.severity==="warning"?"moderate":"minor",s;switch(e.type){case"location":s="location";break;case"temporal":case"dependency":s="causality";break;case"character":s="age";break;default:s="custom"}return{id:e.id,type:s,severity:n,entities:r,events:e.events.map(o=>o.id||o.name),description:e.message,dismissed:!1,detected:new Date().toISOString()}})}static getSeverityDescription(t){switch(t){case"error":return"Error - Major timeline inconsistency that breaks narrative logic";case"warning":return"Warning - Potential issue that should be reviewed";case"info":return"Info - Minor inconsistency or suggestion for improvement";default:return"Unknown severity level"}}static getConflictIcon(t){switch(t){case"location":return"\u{1F4CD}";case"character":case"death":return"\u{1F480}";case"temporal":case"age":return"\u{1F4C5}";case"dependency":case"causality":return"\u{1F517}";default:return"\u26A0\uFE0F"}}static generateConflictReport(t){let e=t.filter(o=>o.severity==="error"),r=t.filter(o=>o.severity==="warning"),n=t.filter(o=>o.severity==="info"),s=`# Timeline Conflict Report

`;return s+=`**Total Conflicts:** ${t.length}
`,s+=`- Errors: ${e.length}
`,s+=`- Warnings: ${r.length}
`,s+=`- Info: ${n.length}

`,e.length>0&&(s+=`## Errors

`,e.forEach((o,l)=>{s+=`${l+1}. **${o.message}**
`,s+=`   - Type: ${o.type}
`,s+=`   - Events: ${o.events.map(c=>c.name).join(", ")}
`,s+=`   - ${o.details.description}

`})),r.length>0&&(s+=`## Warnings

`,r.forEach((o,l)=>{s+=`${l+1}. **${o.message}**
`,s+=`   - Type: ${o.type}
`,s+=`   - Events: ${o.events.map(c=>c.name).join(", ")}
`,s+=`   - ${o.details.description}

`})),s}}});var km,WI=_e(()=>{km=class{constructor(t,e,r){var n,s;this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._timeline=t,this._followRelationships=r==null?void 0:r.followRelationships,this._tooltipConfig=r==null?void 0:r.tooltipConfig,this._arrowsColor=r!=null&&r.color?r.color:"#9c0000",this._arrowsStrokeWidth=(n=r==null?void 0:r.strokeWidth)!=null?n:3,this._hideWhenItemsNotVisible=(s=r==null?void 0:r.hideWhenItemsNotVisible)!=null?s:!0,this._colorMarkers=new Map,this._dependency=[...e],this._dependencyPath=[],this._arrowHeadId=`arrowhead-${Math.random().toString(36).substring(2)}`,this._initialize()}_initialize(){this._svg.style.position="absolute",this._svg.style.top="0px",this._svg.style.height="100%",this._svg.style.width="100%",this._svg.style.display="block",this._svg.style.zIndex="1",this._svg.style.pointerEvents="none",this._timeline.dom.center.appendChild(this._svg);for(let t=0;t<this._dependency.length;t++)this._createPath(this._dependency[t].color,this._dependency[t].line);this._timeline.on("changed",()=>{this._drawDependencies()})}_getOrCreateMarker(t){let e=t||this._arrowsColor;if(!this._colorMarkers.has(e)){let r=`arrowhead-${e.replace("#","")}-${Math.random().toString(36).substring(2)}`,n=document.createElementNS("http://www.w3.org/2000/svg","marker");n.setAttribute("id",r),n.setAttribute("viewBox","-10 -5 10 10"),n.setAttribute("refX","-7"),n.setAttribute("refY","0"),n.setAttribute("markerUnits","strokeWidth"),n.setAttribute("markerWidth","3"),n.setAttribute("markerHeight","3"),n.setAttribute("orient","auto-start-reverse");let s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d","M 0 0 L -10 -5 L -7.5 0 L -10 5 z"),s.style.fill=e,n.appendChild(s),this._svg.appendChild(n),this._colorMarkers.set(e,r)}return this._colorMarkers.get(e)}_createPath(t,e){let r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d","M 0 0"),r.style.stroke=t||this._arrowsColor,r.style.strokeWidth=this._arrowsStrokeWidth+"px",r.style.fill="none",r.style.pointerEvents="auto";let n=e!==void 0?e:0;n===0?r.style.strokeDasharray="none":n===1&&(r.style.strokeDasharray="7,5"),this._dependencyPath.push(r),this._svg.appendChild(r)}_drawDependencies(){for(let t=0;t<this._dependency.length;t++)this._drawArrows(this._dependency[t],t)}_drawArrows(t,e){var d;let r=this._timeline.itemsData.get(t.id_item_1)!==null&&this._timeline.itemsData.get(t.id_item_2)!==null,n=!1,s=!1,o=!1;if(r){let h=this._timeline.getVisibleItems();for(let f=0;f<h.length;f++)t.id_item_1==h[f]&&(n=!0),t.id_item_2==h[f]&&(n=!0);if(this._timeline.groupsData){let f=this._timeline.itemsData.get(t.id_item_1).group,m=this._timeline.itemsData.get(t.id_item_2).group;this._timeline.groupsData.get(f)&&(s=!0),this._timeline.groupsData.get(m)&&(o=!0),f==null&&(s=!1),m==null&&(o=!1)}else s=!0,o=!0}if(s&&o&&(n||!this._hideWhenItemsNotVisible)&&r){var l=this._getItemPos(this._timeline.itemSet.items[t.id_item_1]),c=this._getItemPos(this._timeline.itemSet.items[t.id_item_2]);let h=t.type!==void 0?t.type:0,f=h===0&&!t.align,m=!1;f&&!this._followRelationships&&c.mid_x<l.mid_x&&([l,c]=[c,l],m=!0);var u=l.height*2;let g=this._getOrCreateMarker(t.color),y=t.direction!==void 0?t.direction:1,v="",E="";y===0?(v="",E=""):y===1?f&&m?(v=`url(#${g})`,E=""):(v="",E=`url(#${g})`):y===2?f&&m?(v="",E=`url(#${g})`):(v=`url(#${g})`,E=""):y===3&&(v=`url(#${g})`,E=`url(#${g})`);let C;if(h===1){let _=l.mid_x,x=l.mid_y,P=c.mid_x,I=c.mid_y,M=(k,N,G,W,Y,U=0)=>{let Z=W-N,q=Y-G,X=[];if(Z!==0){let j=(k.left-N)/Z;if(j>0&&j<1){let K=G+j*q;K>=k.top&&K<=k.bottom&&X.push({x:k.left,y:K,t:j})}}if(Z!==0){let j=(k.right-N)/Z;if(j>0&&j<1){let K=G+j*q;K>=k.top&&K<=k.bottom&&X.push({x:k.right,y:K,t:j})}}if(q!==0){let j=(k.top-G)/q;if(j>0&&j<1){let K=N+j*Z;K>=k.left&&K<=k.right&&X.push({x:K,y:k.top,t:j})}}if(q!==0){let j=(k.bottom-G)/q;if(j>0&&j<1){let K=N+j*Z;K>=k.left&&K<=k.right&&X.push({x:K,y:k.bottom,t:j})}}if(X.length===0)return{x:N,y:G};X.sort((j,K)=>Math.hypot(j.x-N,j.y-G)-Math.hypot(K.x-N,K.y-G));let ie=X[0];if(U>0){let j=Math.hypot(Z,q);j>0&&(ie.x+=Z/j*U,ie.y+=q/j*U)}return ie},O=0,R=0;y===1&&(R=10),y===2&&(O=10),y===3&&(O=10,R=10);let F=M(l,_,x,P,I,O),$=M(c,P,I,_,x,R);C=`M ${F.x} ${F.y} L ${$.x} ${$.y}`}else if(h===2){let x,P,I;l.mid_x<c.mid_x?(x={x:l.right,y:l.mid_y},P={x:c.left,y:c.mid_y},I=1):(x={x:l.left,y:l.mid_y},P={x:c.right,y:c.mid_y},I=-1),(y===1||y===3)&&(P.x-=10*I),(y===2||y===3)&&(x.x+=10*I);let M=l.left<c.right&&l.right>c.left,O=Math.abs(P.x-x.x)<20;if(M||O){let R=x.x+10*I,F=P.x-10*I,$=(x.y+P.y)/2;C=`M ${x.x} ${x.y} L ${R} ${x.y} L ${R} ${$} L ${F} ${$} L ${F} ${P.y} L ${P.x} ${P.y}`}else{let R=x.x+10*I;C=`M ${x.x} ${x.y} L ${R} ${x.y} L ${R} ${P.y} L ${P.x} ${P.y}`}}else if(t.align==="center"){let _=l.mid_x,x=l.mid_y,P=c.mid_x,I=c.mid_y,M=(k,N,G,W,Y,U=0)=>{let Z=W-N,q=Y-G,X=[];if(Z!==0){let j=(k.left-N)/Z;if(j>0&&j<1){let K=G+j*q;K>=k.top&&K<=k.bottom&&X.push({x:k.left,y:K,t:j})}}if(Z!==0){let j=(k.right-N)/Z;if(j>0&&j<1){let K=G+j*q;K>=k.top&&K<=k.bottom&&X.push({x:k.right,y:K,t:j})}}if(q!==0){let j=(k.top-G)/q;if(j>0&&j<1){let K=N+j*Z;K>=k.left&&K<=k.right&&X.push({x:K,y:k.top,t:j})}}if(q!==0){let j=(k.bottom-G)/q;if(j>0&&j<1){let K=N+j*Z;K>=k.left&&K<=k.right&&X.push({x:K,y:k.bottom,t:j})}}if(X.length===0)return{x:N,y:G};X.sort((j,K)=>Math.hypot(j.x-N,j.y-G)-Math.hypot(K.x-N,K.y-G));let ie=X[0];if(U>0){let j=Math.hypot(Z,q);j>0&&(ie.x+=Z/j*U,ie.y+=q/j*U)}return ie},O=0,R=0;y===1&&(R=10),y===2&&(O=10),y===3&&(O=10,R=10);let F=M(l,_,x,P,I,O),$=M(c,P,I,_,x,R);C=`M ${F.x} ${F.y} L ${$.x} ${$.y}`}else this._followRelationships&&c.mid_x<l.mid_x?(v!==""&&(c.right+=10),E!==""&&(l.left-=10),C="M "+c.right+" "+c.mid_y+" C "+(c.right+u)+" "+c.mid_y+" "+(l.left-u)+" "+l.mid_y+" "+l.left+" "+l.mid_y):(E!==""&&(c.left-=10),v!==""&&(l.right+=10),C="M "+l.right+" "+l.mid_y+" C "+(l.right+u)+" "+l.mid_y+" "+(c.left-u)+" "+c.mid_y+" "+c.left+" "+c.mid_y);this._followRelationships&&c.mid_x<l.mid_x?(this._dependencyPath[e].setAttribute("marker-start",v),this._dependencyPath[e].setAttribute("marker-end",E),this._dependencyPath[e].setAttribute("d",C)):(this._dependencyPath[e].setAttribute("marker-end",E),this._dependencyPath[e].setAttribute("marker-start",v),this._dependencyPath[e].setAttribute("d",C)),t.hasOwnProperty("title")&&(this._tooltipConfig?this._tooltipConfig(this._dependencyPath[e],(d=t.title)!=null?d:""):this._dependencyPath[e].innerHTML="<title>"+t.title+"</title>")}else this._dependencyPath[e].setAttribute("marker-end",""),this._dependencyPath[e].setAttribute("d","M 0 0")}_getItemPos(t){let e=t.left,r;return this._timeline.options.orientation.item=="top"?r=t.parent.top+t.top:r=t.parent.top+t.parent.height-t.top-t.height,{left:e,top:r,right:e+t.width,bottom:r+t.height,mid_x:e+t.width/2,mid_y:r+t.height/2,width:t.width,height:t.height}}addArrow(t){this._dependency.push(t),this._createPath(t.color,t.line),this._timeline.redraw()}getArrow(t){var e;return(e=this._dependency.find(r=>r.id===t))!=null?e:null}getIdArrows(){return this._dependency.map(t=>t.id)}removeArrow(t){var r;let e=this._dependency.findIndex(n=>n.id===t);if(e>=0){let n=document.querySelectorAll("#"+this._timeline.dom.container.id+" path");this._dependency.splice(e,1),this._dependencyPath.splice(e,1),(r=n[e].parentNode)==null||r.removeChild(n[e])}}removeItemArrows(t){let e=[];for(let r=0;r<this._dependency.length;r++)(this._dependency[r].id_item_1==t||this._dependency[r].id_item_2==t)&&(e.push(this._dependency[r].id),this.removeArrow(this._dependency[r].id),r--);return e}removeArrowsBetweenItems(t,e){let r=[];return this._dependency.filter(s=>s.id_item_1==t&&s.id_item_2==e).forEach(s=>{r.push(s.id),this.removeArrow(s.id)}),r}removeArrowbyItemId(t){this.removeItemArrows(t)}}});function tt(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function ao(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function Ls(){return UI||(UI=1,(function(a,t){(function(e,r){a.exports=r()})(as,function(){var e;function r(){return e.apply(null,arguments)}function n(T){e=T}function s(T){return T instanceof Array||Object.prototype.toString.call(T)==="[object Array]"}function o(T){return T!=null&&Object.prototype.toString.call(T)==="[object Object]"}function l(T,D){return Object.prototype.hasOwnProperty.call(T,D)}function c(T){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(T).length===0;var D;for(D in T)if(l(T,D))return!1;return!0}function u(T){return T===void 0}function d(T){return typeof T=="number"||Object.prototype.toString.call(T)==="[object Number]"}function h(T){return T instanceof Date||Object.prototype.toString.call(T)==="[object Date]"}function f(T,D){var z=[],V,Q=T.length;for(V=0;V<Q;++V)z.push(D(T[V],V));return z}function m(T,D){for(var z in D)l(D,z)&&(T[z]=D[z]);return l(D,"toString")&&(T.toString=D.toString),l(D,"valueOf")&&(T.valueOf=D.valueOf),T}function g(T,D,z,V){return Nv(T,D,z,V,!0).utc()}function y(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function v(T){return T._pf==null&&(T._pf=y()),T._pf}var E;Array.prototype.some?E=Array.prototype.some:E=function(T){var D=Object(this),z=D.length>>>0,V;for(V=0;V<z;V++)if(V in D&&T.call(this,D[V],V,D))return!0;return!1};function C(T){if(T._isValid==null){var D=v(T),z=E.call(D.parsedDateParts,function(Q){return Q!=null}),V=!isNaN(T._d.getTime())&&D.overflow<0&&!D.empty&&!D.invalidEra&&!D.invalidMonth&&!D.invalidWeekday&&!D.weekdayMismatch&&!D.nullInput&&!D.invalidFormat&&!D.userInvalidated&&(!D.meridiem||D.meridiem&&z);if(T._strict&&(V=V&&D.charsLeftOver===0&&D.unusedTokens.length===0&&D.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(T))T._isValid=V;else return V}return T._isValid}function _(T){var D=g(NaN);return T!=null?m(v(D),T):v(D).userInvalidated=!0,D}var x=r.momentProperties=[],P=!1;function I(T,D){var z,V,Q,fe=x.length;if(u(D._isAMomentObject)||(T._isAMomentObject=D._isAMomentObject),u(D._i)||(T._i=D._i),u(D._f)||(T._f=D._f),u(D._l)||(T._l=D._l),u(D._strict)||(T._strict=D._strict),u(D._tzm)||(T._tzm=D._tzm),u(D._isUTC)||(T._isUTC=D._isUTC),u(D._offset)||(T._offset=D._offset),u(D._pf)||(T._pf=v(D)),u(D._locale)||(T._locale=D._locale),fe>0)for(z=0;z<fe;z++)V=x[z],Q=D[V],u(Q)||(T[V]=Q);return T}function M(T){I(this,T),this._d=new Date(T._d!=null?T._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),P===!1&&(P=!0,r.updateOffset(this),P=!1)}function O(T){return T instanceof M||T!=null&&T._isAMomentObject!=null}function R(T){r.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+T)}function F(T,D){var z=!0;return m(function(){if(r.deprecationHandler!=null&&r.deprecationHandler(null,T),z){var V=[],Q,fe,Ae,st=arguments.length;for(fe=0;fe<st;fe++){if(Q="",typeof arguments[fe]=="object"){Q+=`
[`+fe+"] ";for(Ae in arguments[0])l(arguments[0],Ae)&&(Q+=Ae+": "+arguments[0][Ae]+", ");Q=Q.slice(0,-2)}else Q=arguments[fe];V.push(Q)}R(T+`
Arguments: `+Array.prototype.slice.call(V).join("")+`
`+new Error().stack),z=!1}return D.apply(this,arguments)},D)}var $={};function k(T,D){r.deprecationHandler!=null&&r.deprecationHandler(T,D),$[T]||(R(D),$[T]=!0)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null;function N(T){return typeof Function!="undefined"&&T instanceof Function||Object.prototype.toString.call(T)==="[object Function]"}function G(T){var D,z;for(z in T)l(T,z)&&(D=T[z],N(D)?this[z]=D:this["_"+z]=D);this._config=T,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function W(T,D){var z=m({},T),V;for(V in D)l(D,V)&&(o(T[V])&&o(D[V])?(z[V]={},m(z[V],T[V]),m(z[V],D[V])):D[V]!=null?z[V]=D[V]:delete z[V]);for(V in T)l(T,V)&&!l(D,V)&&o(T[V])&&(z[V]=m({},z[V]));return z}function Y(T){T!=null&&this.set(T)}var U;Object.keys?U=Object.keys:U=function(T){var D,z=[];for(D in T)l(T,D)&&z.push(D);return z};var Z={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function q(T,D,z){var V=this._calendar[T]||this._calendar.sameElse;return N(V)?V.call(D,z):V}function X(T,D,z){var V=""+Math.abs(T),Q=D-V.length,fe=T>=0;return(fe?z?"+":"":"-")+Math.pow(10,Math.max(0,Q)).toString().substr(1)+V}var ie=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,j=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,K={},se={};function ne(T,D,z,V){var Q=V;typeof V=="string"&&(Q=function(){return this[V]()}),T&&(se[T]=Q),D&&(se[D[0]]=function(){return X(Q.apply(this,arguments),D[1],D[2])}),z&&(se[z]=function(){return this.localeData().ordinal(Q.apply(this,arguments),T)})}function ge(T){return T.match(/\[[\s\S]/)?T.replace(/^\[|\]$/g,""):T.replace(/\\/g,"")}function ve(T){var D=T.match(ie),z,V;for(z=0,V=D.length;z<V;z++)se[D[z]]?D[z]=se[D[z]]:D[z]=ge(D[z]);return function(Q){var fe="",Ae;for(Ae=0;Ae<V;Ae++)fe+=N(D[Ae])?D[Ae].call(Q,T):D[Ae];return fe}}function Se(T,D){return T.isValid()?(D=Te(D,T.localeData()),K[D]=K[D]||ve(D),K[D](T)):T.localeData().invalidDate()}function Te(T,D){var z=5;function V(Q){return D.longDateFormat(Q)||Q}for(j.lastIndex=0;z>=0&&j.test(T);)T=T.replace(j,V),j.lastIndex=0,z-=1;return T}var me={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function pe(T){var D=this._longDateFormat[T],z=this._longDateFormat[T.toUpperCase()];return D||!z?D:(this._longDateFormat[T]=z.match(ie).map(function(V){return V==="MMMM"||V==="MM"||V==="DD"||V==="dddd"?V.slice(1):V}).join(""),this._longDateFormat[T])}var B="Invalid date";function oe(){return this._invalidDate}var he="%d",te=/\d{1,2}/;function re(T){return this._ordinal.replace("%d",T)}var ce={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Ee(T,D,z,V){var Q=this._relativeTime[z];return N(Q)?Q(T,D,z,V):Q.replace(/%d/i,T)}function Ce(T,D){var z=this._relativeTime[T>0?"future":"past"];return N(z)?z(D):z.replace(/%s/i,D)}var le={};function we(T,D){var z=T.toLowerCase();le[z]=le[z+"s"]=le[D]=T}function Le(T){return typeof T=="string"?le[T]||le[T.toLowerCase()]:void 0}function Me(T){var D={},z,V;for(V in T)l(T,V)&&(z=Le(V),z&&(D[z]=T[V]));return D}var Ne={};function Ge(T,D){Ne[T]=D}function Ye(T){var D=[],z;for(z in T)l(T,z)&&D.push({unit:z,priority:Ne[z]});return D.sort(function(V,Q){return V.priority-Q.priority}),D}function ft(T){return T%4===0&&T%100!==0||T%400===0}function ct(T){return T<0?Math.ceil(T)||0:Math.floor(T)}function Ve(T){var D=+T,z=0;return D!==0&&isFinite(D)&&(z=ct(D)),z}function et(T,D){return function(z){return z!=null?(Ie(this,T,z),r.updateOffset(this,D),this):$e(this,T)}}function $e(T,D){return T.isValid()?T._d["get"+(T._isUTC?"UTC":"")+D]():NaN}function Ie(T,D,z){T.isValid()&&!isNaN(z)&&(D==="FullYear"&&ft(T.year())&&T.month()===1&&T.date()===29?(z=Ve(z),T._d["set"+(T._isUTC?"UTC":"")+D](z,T.month(),cl(z,T.month()))):T._d["set"+(T._isUTC?"UTC":"")+D](z))}function ee(T){return T=Le(T),N(this[T])?this[T]():this}function ye(T,D){if(typeof T=="object"){T=Me(T);var z=Ye(T),V,Q=z.length;for(V=0;V<Q;V++)this[z[V].unit](T[z[V].unit])}else if(T=Le(T),N(this[T]))return this[T](D);return this}var Pe=/\d/,xe=/\d\d/,Fe=/\d{3}/,qe=/\d{4}/,Re=/[+-]?\d{6}/,ze=/\d\d?/,Ze=/\d\d\d\d?/,rt=/\d\d\d\d\d\d?/,Ct=/\d{1,3}/,bt=/\d{1,4}/,Xe=/[+-]?\d{1,6}/,wt=/\d+/,vt=/[+-]?\d+/,Kr=/Z|[+-]\d\d:?\d\d/gi,ur=/Z|[+-]\d\d(?::?\d\d)?/gi,Si=/[+-]?\d+(\.\d{1,3})?/,mr=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Wt;Wt={};function De(T,D,z){Wt[T]=N(D)?D:function(V,Q){return V&&z?z:D}}function ri(T,D){return l(Wt,T)?Wt[T](D._strict,D._locale):new RegExp(va(T))}function va(T){return Nt(T.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(D,z,V,Q,fe){return z||V||Q||fe}))}function Nt(T){return T.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var un={};function Dt(T,D){var z,V=D,Q;for(typeof T=="string"&&(T=[T]),d(D)&&(V=function(fe,Ae){Ae[D]=Ve(fe)}),Q=T.length,z=0;z<Q;z++)un[T[z]]=V}function Dn(T,D){Dt(T,function(z,V,Q,fe){Q._w=Q._w||{},D(z,Q._w,Q,fe)})}function ya(T,D,z){D!=null&&l(un,T)&&un[T](D,z._a,z,T)}var Sr=0,Lr=1,dr=2,zt=3,xi=4,Rr=5,$a=6,ll=7,Rf=8;function Nf(T,D){return(T%D+D)%D}var Nr;Array.prototype.indexOf?Nr=Array.prototype.indexOf:Nr=function(T){var D;for(D=0;D<this.length;++D)if(this[D]===T)return D;return-1};function cl(T,D){if(isNaN(T)||isNaN(D))return NaN;var z=Nf(D,12);return T+=(D-z)/12,z===1?ft(T)?29:28:31-z%7%2}ne("M",["MM",2],"Mo",function(){return this.month()+1}),ne("MMM",0,0,function(T){return this.localeData().monthsShort(this,T)}),ne("MMMM",0,0,function(T){return this.localeData().months(this,T)}),we("month","M"),Ge("month",8),De("M",ze),De("MM",ze,xe),De("MMM",function(T,D){return D.monthsShortRegex(T)}),De("MMMM",function(T,D){return D.monthsRegex(T)}),Dt(["M","MM"],function(T,D){D[Lr]=Ve(T)-1}),Dt(["MMM","MMMM"],function(T,D,z,V){var Q=z._locale.monthsParse(T,V,z._strict);Q!=null?D[Lr]=Q:v(z).invalidMonth=T});var Bf="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ul="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),qn=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,dl=mr,wo=mr;function Ws(T,D){return T?s(this._months)?this._months[T.month()]:this._months[(this._months.isFormat||qn).test(D)?"format":"standalone"][T.month()]:s(this._months)?this._months:this._months.standalone}function Bt(T,D){return T?s(this._monthsShort)?this._monthsShort[T.month()]:this._monthsShort[qn.test(D)?"format":"standalone"][T.month()]:s(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function xr(T,D,z){var V,Q,fe,Ae=T.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],V=0;V<12;++V)fe=g([2e3,V]),this._shortMonthsParse[V]=this.monthsShort(fe,"").toLocaleLowerCase(),this._longMonthsParse[V]=this.months(fe,"").toLocaleLowerCase();return z?D==="MMM"?(Q=Nr.call(this._shortMonthsParse,Ae),Q!==-1?Q:null):(Q=Nr.call(this._longMonthsParse,Ae),Q!==-1?Q:null):D==="MMM"?(Q=Nr.call(this._shortMonthsParse,Ae),Q!==-1?Q:(Q=Nr.call(this._longMonthsParse,Ae),Q!==-1?Q:null)):(Q=Nr.call(this._longMonthsParse,Ae),Q!==-1?Q:(Q=Nr.call(this._shortMonthsParse,Ae),Q!==-1?Q:null))}function $i(T,D,z){var V,Q,fe;if(this._monthsParseExact)return xr.call(this,T,D,z);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),V=0;V<12;V++){if(Q=g([2e3,V]),z&&!this._longMonthsParse[V]&&(this._longMonthsParse[V]=new RegExp("^"+this.months(Q,"").replace(".","")+"$","i"),this._shortMonthsParse[V]=new RegExp("^"+this.monthsShort(Q,"").replace(".","")+"$","i")),!z&&!this._monthsParse[V]&&(fe="^"+this.months(Q,"")+"|^"+this.monthsShort(Q,""),this._monthsParse[V]=new RegExp(fe.replace(".",""),"i")),z&&D==="MMMM"&&this._longMonthsParse[V].test(T))return V;if(z&&D==="MMM"&&this._shortMonthsParse[V].test(T))return V;if(!z&&this._monthsParse[V].test(T))return V}}function ba(T,D){var z;if(!T.isValid())return T;if(typeof D=="string"){if(/^\d+$/.test(D))D=Ve(D);else if(D=T.localeData().monthsParse(D),!d(D))return T}return z=Math.min(T.date(),cl(T.year(),D)),T._d["set"+(T._isUTC?"UTC":"")+"Month"](D,z),T}function za(T){return T!=null?(ba(this,T),r.updateOffset(this,!0),this):$e(this,"Month")}function ds(){return cl(this.year(),this.month())}function ot(T){return this._monthsParseExact?(l(this,"_monthsRegex")||Lc.call(this),T?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=dl),this._monthsShortStrictRegex&&T?this._monthsShortStrictRegex:this._monthsShortRegex)}function Br(T){return this._monthsParseExact?(l(this,"_monthsRegex")||Lc.call(this),T?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=wo),this._monthsStrictRegex&&T?this._monthsStrictRegex:this._monthsRegex)}function Lc(){function T(Ae,st){return st.length-Ae.length}var D=[],z=[],V=[],Q,fe;for(Q=0;Q<12;Q++)fe=g([2e3,Q]),D.push(this.monthsShort(fe,"")),z.push(this.months(fe,"")),V.push(this.months(fe,"")),V.push(this.monthsShort(fe,""));for(D.sort(T),z.sort(T),V.sort(T),Q=0;Q<12;Q++)D[Q]=Nt(D[Q]),z[Q]=Nt(z[Q]);for(Q=0;Q<24;Q++)V[Q]=Nt(V[Q]);this._monthsRegex=new RegExp("^("+V.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+z.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+D.join("|")+")","i")}ne("Y",0,0,function(){var T=this.year();return T<=9999?X(T,4):"+"+T}),ne(0,["YY",2],0,function(){return this.year()%100}),ne(0,["YYYY",4],0,"year"),ne(0,["YYYYY",5],0,"year"),ne(0,["YYYYYY",6,!0],0,"year"),we("year","y"),Ge("year",1),De("Y",vt),De("YY",ze,xe),De("YYYY",bt,qe),De("YYYYY",Xe,Re),De("YYYYYY",Xe,Re),Dt(["YYYYY","YYYYYY"],Sr),Dt("YYYY",function(T,D){D[Sr]=T.length===2?r.parseTwoDigitYear(T):Ve(T)}),Dt("YY",function(T,D){D[Sr]=r.parseTwoDigitYear(T)}),Dt("Y",function(T,D){D[Sr]=parseInt(T,10)});function Ha(T){return ft(T)?366:365}r.parseTwoDigitYear=function(T){return Ve(T)+(Ve(T)>68?1900:2e3)};var Pn=et("FullYear",!0);function GE(){return ft(this.year())}function od(T,D,z,V,Q,fe,Ae){var st;return T<100&&T>=0?(st=new Date(T+400,D,z,V,Q,fe,Ae),isFinite(st.getFullYear())&&st.setFullYear(T)):st=new Date(T,D,z,V,Q,fe,Ae),st}function wa(T){var D,z;return T<100&&T>=0?(z=Array.prototype.slice.call(arguments),z[0]=T+400,D=new Date(Date.UTC.apply(null,z)),isFinite(D.getUTCFullYear())&&D.setUTCFullYear(T)):D=new Date(Date.UTC.apply(null,arguments)),D}function $r(T,D,z){var V=7+D-z,Q=(7+wa(T,0,V).getUTCDay()-D)%7;return-Q+V-1}function Us(T,D,z,V,Q){var fe=(7+z-V)%7,Ae=$r(T,V,Q),st=1+7*(D-1)+fe+Ae,Ft,yr;return st<=0?(Ft=T-1,yr=Ha(Ft)+st):st>Ha(T)?(Ft=T+1,yr=st-Ha(T)):(Ft=T,yr=st),{year:Ft,dayOfYear:yr}}function hs(T,D,z){var V=$r(T.year(),D,z),Q=Math.floor((T.dayOfYear()-V-1)/7)+1,fe,Ae;return Q<1?(Ae=T.year()-1,fe=Q+Ln(Ae,D,z)):Q>Ln(T.year(),D,z)?(fe=Q-Ln(T.year(),D,z),Ae=T.year()+1):(Ae=T.year(),fe=Q),{week:fe,year:Ae}}function Ln(T,D,z){var V=$r(T,D,z),Q=$r(T+1,D,z);return(Ha(T)-V+Q)/7}ne("w",["ww",2],"wo","week"),ne("W",["WW",2],"Wo","isoWeek"),we("week","w"),we("isoWeek","W"),Ge("week",5),Ge("isoWeek",5),De("w",ze),De("ww",ze,xe),De("W",ze),De("WW",ze,xe),Dn(["w","ww","W","WW"],function(T,D,z,V){D[V.substr(0,1)]=Ve(T)});function $f(T){return hs(T,this._week.dow,this._week.doy).week}var Mc={dow:0,doy:6};function zf(){return this._week.dow}function Hf(){return this._week.doy}function ld(T){var D=this.localeData().week(this);return T==null?D:this.add((T-D)*7,"d")}function Gf(T){var D=hs(this,1,4).week;return T==null?D:this.add((T-D)*7,"d")}ne("d",0,"do","day"),ne("dd",0,0,function(T){return this.localeData().weekdaysMin(this,T)}),ne("ddd",0,0,function(T){return this.localeData().weekdaysShort(this,T)}),ne("dddd",0,0,function(T){return this.localeData().weekdays(this,T)}),ne("e",0,0,"weekday"),ne("E",0,0,"isoWeekday"),we("day","d"),we("weekday","e"),we("isoWeekday","E"),Ge("day",11),Ge("weekday",11),Ge("isoWeekday",11),De("d",ze),De("e",ze),De("E",ze),De("dd",function(T,D){return D.weekdaysMinRegex(T)}),De("ddd",function(T,D){return D.weekdaysShortRegex(T)}),De("dddd",function(T,D){return D.weekdaysRegex(T)}),Dn(["dd","ddd","dddd"],function(T,D,z,V){var Q=z._locale.weekdaysParse(T,V,z._strict);Q!=null?D.d=Q:v(z).invalidWeekday=T}),Dn(["d","e","E"],function(T,D,z,V){D[V]=Ve(T)});function Vf(T,D){return typeof T!="string"?T:isNaN(T)?(T=D.weekdaysParse(T),typeof T=="number"?T:null):parseInt(T,10)}function cd(T,D){return typeof T=="string"?D.weekdaysParse(T)%7||7:isNaN(T)?null:T}function ud(T,D){return T.slice(D,7).concat(T.slice(0,D))}var Wf="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Cv="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),_t="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ga=mr,gr=mr,_v=mr;function Uf(T,D){var z=s(this._weekdays)?this._weekdays:this._weekdays[T&&T!==!0&&this._weekdays.isFormat.test(D)?"format":"standalone"];return T===!0?ud(z,this._week.dow):T?z[T.day()]:z}function jf(T){return T===!0?ud(this._weekdaysShort,this._week.dow):T?this._weekdaysShort[T.day()]:this._weekdaysShort}function Yf(T){return T===!0?ud(this._weekdaysMin,this._week.dow):T?this._weekdaysMin[T.day()]:this._weekdaysMin}function Eo(T,D,z){var V,Q,fe,Ae=T.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],V=0;V<7;++V)fe=g([2e3,1]).day(V),this._minWeekdaysParse[V]=this.weekdaysMin(fe,"").toLocaleLowerCase(),this._shortWeekdaysParse[V]=this.weekdaysShort(fe,"").toLocaleLowerCase(),this._weekdaysParse[V]=this.weekdays(fe,"").toLocaleLowerCase();return z?D==="dddd"?(Q=Nr.call(this._weekdaysParse,Ae),Q!==-1?Q:null):D==="ddd"?(Q=Nr.call(this._shortWeekdaysParse,Ae),Q!==-1?Q:null):(Q=Nr.call(this._minWeekdaysParse,Ae),Q!==-1?Q:null):D==="dddd"?(Q=Nr.call(this._weekdaysParse,Ae),Q!==-1||(Q=Nr.call(this._shortWeekdaysParse,Ae),Q!==-1)?Q:(Q=Nr.call(this._minWeekdaysParse,Ae),Q!==-1?Q:null)):D==="ddd"?(Q=Nr.call(this._shortWeekdaysParse,Ae),Q!==-1||(Q=Nr.call(this._weekdaysParse,Ae),Q!==-1)?Q:(Q=Nr.call(this._minWeekdaysParse,Ae),Q!==-1?Q:null)):(Q=Nr.call(this._minWeekdaysParse,Ae),Q!==-1||(Q=Nr.call(this._weekdaysParse,Ae),Q!==-1)?Q:(Q=Nr.call(this._shortWeekdaysParse,Ae),Q!==-1?Q:null))}function qf(T,D,z){var V,Q,fe;if(this._weekdaysParseExact)return Eo.call(this,T,D,z);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),V=0;V<7;V++){if(Q=g([2e3,1]).day(V),z&&!this._fullWeekdaysParse[V]&&(this._fullWeekdaysParse[V]=new RegExp("^"+this.weekdays(Q,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[V]=new RegExp("^"+this.weekdaysShort(Q,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[V]=new RegExp("^"+this.weekdaysMin(Q,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[V]||(fe="^"+this.weekdays(Q,"")+"|^"+this.weekdaysShort(Q,"")+"|^"+this.weekdaysMin(Q,""),this._weekdaysParse[V]=new RegExp(fe.replace(".",""),"i")),z&&D==="dddd"&&this._fullWeekdaysParse[V].test(T))return V;if(z&&D==="ddd"&&this._shortWeekdaysParse[V].test(T))return V;if(z&&D==="dd"&&this._minWeekdaysParse[V].test(T))return V;if(!z&&this._weekdaysParse[V].test(T))return V}}function Ic(T){if(!this.isValid())return T!=null?this:NaN;var D=this._isUTC?this._d.getUTCDay():this._d.getDay();return T!=null?(T=Vf(T,this.localeData()),this.add(T-D,"d")):D}function ki(T){if(!this.isValid())return T!=null?this:NaN;var D=(this.day()+7-this.localeData()._week.dow)%7;return T==null?D:this.add(T-D,"d")}function To(T){if(!this.isValid())return T!=null?this:NaN;if(T!=null){var D=cd(T,this.localeData());return this.day(this.day()%7?D:D-7)}else return this.day()||7}function Sv(T){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||dd.call(this),T?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=Ga),this._weekdaysStrictRegex&&T?this._weekdaysStrictRegex:this._weekdaysRegex)}function xv(T){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||dd.call(this),T?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=gr),this._weekdaysShortStrictRegex&&T?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function VE(T){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||dd.call(this),T?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=_v),this._weekdaysMinStrictRegex&&T?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function dd(){function T(In,ko){return ko.length-In.length}var D=[],z=[],V=[],Q=[],fe,Ae,st,Ft,yr;for(fe=0;fe<7;fe++)Ae=g([2e3,1]).day(fe),st=Nt(this.weekdaysMin(Ae,"")),Ft=Nt(this.weekdaysShort(Ae,"")),yr=Nt(this.weekdays(Ae,"")),D.push(st),z.push(Ft),V.push(yr),Q.push(st),Q.push(Ft),Q.push(yr);D.sort(T),z.sort(T),V.sort(T),Q.sort(T),this._weekdaysRegex=new RegExp("^("+Q.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+V.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+z.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+D.join("|")+")","i")}function Ac(){return this.hours()%12||12}function WE(){return this.hours()||24}ne("H",["HH",2],0,"hour"),ne("h",["hh",2],0,Ac),ne("k",["kk",2],0,WE),ne("hmm",0,0,function(){return""+Ac.apply(this)+X(this.minutes(),2)}),ne("hmmss",0,0,function(){return""+Ac.apply(this)+X(this.minutes(),2)+X(this.seconds(),2)}),ne("Hmm",0,0,function(){return""+this.hours()+X(this.minutes(),2)}),ne("Hmmss",0,0,function(){return""+this.hours()+X(this.minutes(),2)+X(this.seconds(),2)});function Zf(T,D){ne(T,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),D)})}Zf("a",!0),Zf("A",!1),we("hour","h"),Ge("hour",13);function $t(T,D){return D._meridiemParse}De("a",$t),De("A",$t),De("H",ze),De("h",ze),De("k",ze),De("HH",ze,xe),De("hh",ze,xe),De("kk",ze,xe),De("hmm",Ze),De("hmmss",rt),De("Hmm",Ze),De("Hmmss",rt),Dt(["H","HH"],zt),Dt(["k","kk"],function(T,D,z){var V=Ve(T);D[zt]=V===24?0:V}),Dt(["a","A"],function(T,D,z){z._isPm=z._locale.isPM(T),z._meridiem=T}),Dt(["h","hh"],function(T,D,z){D[zt]=Ve(T),v(z).bigHour=!0}),Dt("hmm",function(T,D,z){var V=T.length-2;D[zt]=Ve(T.substr(0,V)),D[xi]=Ve(T.substr(V)),v(z).bigHour=!0}),Dt("hmmss",function(T,D,z){var V=T.length-4,Q=T.length-2;D[zt]=Ve(T.substr(0,V)),D[xi]=Ve(T.substr(V,2)),D[Rr]=Ve(T.substr(Q)),v(z).bigHour=!0}),Dt("Hmm",function(T,D,z){var V=T.length-2;D[zt]=Ve(T.substr(0,V)),D[xi]=Ve(T.substr(V))}),Dt("Hmmss",function(T,D,z){var V=T.length-4,Q=T.length-2;D[zt]=Ve(T.substr(0,V)),D[xi]=Ve(T.substr(V,2)),D[Rr]=Ve(T.substr(Q))});function UE(T){return(T+"").toLowerCase().charAt(0)==="p"}var Ea=/[ap]\.?m?\.?/i,Oc=et("Hours",!0);function kv(T,D,z){return T>11?z?"pm":"PM":z?"am":"AM"}var Dv={calendar:Z,longDateFormat:me,invalidDate:B,ordinal:he,dayOfMonthOrdinalParse:te,relativeTime:ce,months:Bf,monthsShort:ul,week:Mc,weekdays:Wf,weekdaysMin:_t,weekdaysShort:Cv,meridiemParse:Ea},vr={},Fc={},hl;function jE(T,D){var z,V=Math.min(T.length,D.length);for(z=0;z<V;z+=1)if(T[z]!==D[z])return z;return V}function Pv(T){return T&&T.toLowerCase().replace("_","-")}function Kf(T){for(var D=0,z,V,Q,fe;D<T.length;){for(fe=Pv(T[D]).split("-"),z=fe.length,V=Pv(T[D+1]),V=V?V.split("-"):null;z>0;){if(Q=Mn(fe.slice(0,z).join("-")),Q)return Q;if(V&&V.length>=z&&jE(fe,V)>=z-1)break;z--}D++}return hl}function YE(T){return T.match("^[^/\\\\]*$")!=null}function Mn(T){var D=null,z;if(vr[T]===void 0&&a&&a.exports&&YE(T))try{D=hl._abbr,z=ao,z("./locale/"+T),js(D)}catch(V){vr[T]=null}return vr[T]}function js(T,D){var z;return T&&(u(D)?z=Va(T):z=hd(T,D),z?hl=z:typeof console!="undefined"&&console.warn&&console.warn("Locale "+T+" not found. Did you forget to load it?")),hl._abbr}function hd(T,D){if(D!==null){var z,V=Dv;if(D.abbr=T,vr[T]!=null)k("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),V=vr[T]._config;else if(D.parentLocale!=null)if(vr[D.parentLocale]!=null)V=vr[D.parentLocale]._config;else if(z=Mn(D.parentLocale),z!=null)V=z._config;else return Fc[D.parentLocale]||(Fc[D.parentLocale]=[]),Fc[D.parentLocale].push({name:T,config:D}),null;return vr[T]=new Y(W(V,D)),Fc[T]&&Fc[T].forEach(function(Q){hd(Q.name,Q.config)}),js(T),vr[T]}else return delete vr[T],null}function Ys(T,D){if(D!=null){var z,V,Q=Dv;vr[T]!=null&&vr[T].parentLocale!=null?vr[T].set(W(vr[T]._config,D)):(V=Mn(T),V!=null&&(Q=V._config),D=W(Q,D),V==null&&(D.abbr=T),z=new Y(D),z.parentLocale=vr[T],vr[T]=z),js(T)}else vr[T]!=null&&(vr[T].parentLocale!=null?(vr[T]=vr[T].parentLocale,T===js()&&js(T)):vr[T]!=null&&delete vr[T]);return vr[T]}function Va(T){var D;if(T&&T._locale&&T._locale._abbr&&(T=T._locale._abbr),!T)return hl;if(!s(T)){if(D=Mn(T),D)return D;T=[T]}return Kf(T)}function Lv(){return U(vr)}function Rc(T){var D,z=T._a;return z&&v(T).overflow===-2&&(D=z[Lr]<0||z[Lr]>11?Lr:z[dr]<1||z[dr]>cl(z[Sr],z[Lr])?dr:z[zt]<0||z[zt]>24||z[zt]===24&&(z[xi]!==0||z[Rr]!==0||z[$a]!==0)?zt:z[xi]<0||z[xi]>59?xi:z[Rr]<0||z[Rr]>59?Rr:z[$a]<0||z[$a]>999?$a:-1,v(T)._overflowDayOfYear&&(D<Sr||D>dr)&&(D=dr),v(T)._overflowWeeks&&D===-1&&(D=ll),v(T)._overflowWeekday&&D===-1&&(D=Rf),v(T).overflow=D),T}var qE=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Mv=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Iv=/Z|[+-]\d\d(?::?\d\d)?/,fd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Xf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Jf=/^\/?Date\((-?\d+)/i,ZE=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Av={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Qf(T){var D,z,V=T._i,Q=qE.exec(V)||Mv.exec(V),fe,Ae,st,Ft,yr=fd.length,In=Xf.length;if(Q){for(v(T).iso=!0,D=0,z=yr;D<z;D++)if(fd[D][1].exec(Q[1])){Ae=fd[D][0],fe=fd[D][2]!==!1;break}if(Ae==null){T._isValid=!1;return}if(Q[3]){for(D=0,z=In;D<z;D++)if(Xf[D][1].exec(Q[3])){st=(Q[2]||" ")+Xf[D][0];break}if(st==null){T._isValid=!1;return}}if(!fe&&st!=null){T._isValid=!1;return}if(Q[4])if(Iv.exec(Q[4]))Ft="Z";else{T._isValid=!1;return}T._f=Ae+(st||"")+(Ft||""),rp(T)}else T._isValid=!1}function pd(T,D,z,V,Q,fe){var Ae=[Co(T),ul.indexOf(D),parseInt(z,10),parseInt(V,10),parseInt(Q,10)];return fe&&Ae.push(parseInt(fe,10)),Ae}function Co(T){var D=parseInt(T,10);return D<=49?2e3+D:D<=999?1900+D:D}function KE(T){return T.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Nc(T,D,z){if(T){var V=Cv.indexOf(T),Q=new Date(D[0],D[1],D[2]).getDay();if(V!==Q)return v(z).weekdayMismatch=!0,z._isValid=!1,!1}return!0}function Zn(T,D,z){if(T)return Av[T];if(D)return 0;var V=parseInt(z,10),Q=V%100,fe=(V-Q)/100;return fe*60+Q}function ep(T){var D=ZE.exec(KE(T._i)),z;if(D){if(z=pd(D[4],D[3],D[2],D[5],D[6],D[7]),!Nc(D[1],z,T))return;T._a=z,T._tzm=Zn(D[8],D[9],D[10]),T._d=wa.apply(null,T._a),T._d.setUTCMinutes(T._d.getUTCMinutes()-T._tzm),v(T).rfc2822=!0}else T._isValid=!1}function Ov(T){var D=Jf.exec(T._i);if(D!==null){T._d=new Date(+D[1]);return}if(Qf(T),T._isValid===!1)delete T._isValid;else return;if(ep(T),T._isValid===!1)delete T._isValid;else return;T._strict?T._isValid=!1:r.createFromInputFallback(T)}r.createFromInputFallback=F("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(T){T._d=new Date(T._i+(T._useUTC?" UTC":""))});function fl(T,D,z){return T!=null?T:D!=null?D:z}function tp(T){var D=new Date(r.now());return T._useUTC?[D.getUTCFullYear(),D.getUTCMonth(),D.getUTCDate()]:[D.getFullYear(),D.getMonth(),D.getDate()]}function Bc(T){var D,z,V=[],Q,fe,Ae;if(!T._d){for(Q=tp(T),T._w&&T._a[dr]==null&&T._a[Lr]==null&&XE(T),T._dayOfYear!=null&&(Ae=fl(T._a[Sr],Q[Sr]),(T._dayOfYear>Ha(Ae)||T._dayOfYear===0)&&(v(T)._overflowDayOfYear=!0),z=wa(Ae,0,T._dayOfYear),T._a[Lr]=z.getUTCMonth(),T._a[dr]=z.getUTCDate()),D=0;D<3&&T._a[D]==null;++D)T._a[D]=V[D]=Q[D];for(;D<7;D++)T._a[D]=V[D]=T._a[D]==null?D===2?1:0:T._a[D];T._a[zt]===24&&T._a[xi]===0&&T._a[Rr]===0&&T._a[$a]===0&&(T._nextDay=!0,T._a[zt]=0),T._d=(T._useUTC?wa:od).apply(null,V),fe=T._useUTC?T._d.getUTCDay():T._d.getDay(),T._tzm!=null&&T._d.setUTCMinutes(T._d.getUTCMinutes()-T._tzm),T._nextDay&&(T._a[zt]=24),T._w&&typeof T._w.d!="undefined"&&T._w.d!==fe&&(v(T).weekdayMismatch=!0)}}function XE(T){var D,z,V,Q,fe,Ae,st,Ft,yr;D=T._w,D.GG!=null||D.W!=null||D.E!=null?(fe=1,Ae=4,z=fl(D.GG,T._a[Sr],hs(Kt(),1,4).year),V=fl(D.W,1),Q=fl(D.E,1),(Q<1||Q>7)&&(Ft=!0)):(fe=T._locale._week.dow,Ae=T._locale._week.doy,yr=hs(Kt(),fe,Ae),z=fl(D.gg,T._a[Sr],yr.year),V=fl(D.w,yr.week),D.d!=null?(Q=D.d,(Q<0||Q>6)&&(Ft=!0)):D.e!=null?(Q=D.e+fe,(D.e<0||D.e>6)&&(Ft=!0)):Q=fe),V<1||V>Ln(z,fe,Ae)?v(T)._overflowWeeks=!0:Ft!=null?v(T)._overflowWeekday=!0:(st=Us(z,V,Q,fe,Ae),T._a[Sr]=st.year,T._dayOfYear=st.dayOfYear)}r.ISO_8601=function(){},r.RFC_2822=function(){};function rp(T){if(T._f===r.ISO_8601){Qf(T);return}if(T._f===r.RFC_2822){ep(T);return}T._a=[],v(T).empty=!0;var D=""+T._i,z,V,Q,fe,Ae,st=D.length,Ft=0,yr,In;for(Q=Te(T._f,T._locale).match(ie)||[],In=Q.length,z=0;z<In;z++)fe=Q[z],V=(D.match(ri(fe,T))||[])[0],V&&(Ae=D.substr(0,D.indexOf(V)),Ae.length>0&&v(T).unusedInput.push(Ae),D=D.slice(D.indexOf(V)+V.length),Ft+=V.length),se[fe]?(V?v(T).empty=!1:v(T).unusedTokens.push(fe),ya(fe,V,T)):T._strict&&!V&&v(T).unusedTokens.push(fe);v(T).charsLeftOver=st-Ft,D.length>0&&v(T).unusedInput.push(D),T._a[zt]<=12&&v(T).bigHour===!0&&T._a[zt]>0&&(v(T).bigHour=void 0),v(T).parsedDateParts=T._a.slice(0),v(T).meridiem=T._meridiem,T._a[zt]=Fv(T._locale,T._a[zt],T._meridiem),yr=v(T).era,yr!==null&&(T._a[Sr]=T._locale.erasConvertYear(yr,T._a[Sr])),Bc(T),Rc(T)}function Fv(T,D,z){var V;return z==null?D:T.meridiemHour!=null?T.meridiemHour(D,z):(T.isPM!=null&&(V=T.isPM(z),V&&D<12&&(D+=12),!V&&D===12&&(D=0)),D)}function JE(T){var D,z,V,Q,fe,Ae,st=!1,Ft=T._f.length;if(Ft===0){v(T).invalidFormat=!0,T._d=new Date(NaN);return}for(Q=0;Q<Ft;Q++)fe=0,Ae=!1,D=I({},T),T._useUTC!=null&&(D._useUTC=T._useUTC),D._f=T._f[Q],rp(D),C(D)&&(Ae=!0),fe+=v(D).charsLeftOver,fe+=v(D).unusedTokens.length*10,v(D).score=fe,st?fe<V&&(V=fe,z=D):(V==null||fe<V||Ae)&&(V=fe,z=D,Ae&&(st=!0));m(T,z||D)}function Ta(T){if(!T._d){var D=Me(T._i),z=D.day===void 0?D.date:D.day;T._a=f([D.year,D.month,z,D.hour,D.minute,D.second,D.millisecond],function(V){return V&&parseInt(V,10)}),Bc(T)}}function pl(T){var D=new M(Rc(Rv(T)));return D._nextDay&&(D.add(1,"d"),D._nextDay=void 0),D}function Rv(T){var D=T._i,z=T._f;return T._locale=T._locale||Va(T._l),D===null||z===void 0&&D===""?_({nullInput:!0}):(typeof D=="string"&&(T._i=D=T._locale.preparse(D)),O(D)?new M(Rc(D)):(h(D)?T._d=D:s(z)?JE(T):z?rp(T):fs(T),C(T)||(T._d=null),T))}function fs(T){var D=T._i;u(D)?T._d=new Date(r.now()):h(D)?T._d=new Date(D.valueOf()):typeof D=="string"?Ov(T):s(D)?(T._a=f(D.slice(0),function(z){return parseInt(z,10)}),Bc(T)):o(D)?Ta(T):d(D)?T._d=new Date(D):r.createFromInputFallback(T)}function Nv(T,D,z,V,Q){var fe={};return(D===!0||D===!1)&&(V=D,D=void 0),(z===!0||z===!1)&&(V=z,z=void 0),(o(T)&&c(T)||s(T)&&T.length===0)&&(T=void 0),fe._isAMomentObject=!0,fe._useUTC=fe._isUTC=Q,fe._l=z,fe._i=T,fe._f=D,fe._strict=V,pl(fe)}function Kt(T,D,z,V){return Nv(T,D,z,V,!1)}var QE=F("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var T=Kt.apply(null,arguments);return this.isValid()&&T.isValid()?T<this?this:T:_()}),$c=F("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var T=Kt.apply(null,arguments);return this.isValid()&&T.isValid()?T>this?this:T:_()});function ip(T,D){var z,V;if(D.length===1&&s(D[0])&&(D=D[0]),!D.length)return Kt();for(z=D[0],V=1;V<D.length;++V)(!D[V].isValid()||D[V][T](z))&&(z=D[V]);return z}function md(){var T=[].slice.call(arguments,0);return ip("isBefore",T)}function eT(){var T=[].slice.call(arguments,0);return ip("isAfter",T)}var qs=function(){return Date.now?Date.now():+new Date},Zs=["year","quarter","month","week","day","hour","minute","second","millisecond"];function tT(T){var D,z=!1,V,Q=Zs.length;for(D in T)if(l(T,D)&&!(Nr.call(Zs,D)!==-1&&(T[D]==null||!isNaN(T[D]))))return!1;for(V=0;V<Q;++V)if(T[Zs[V]]){if(z)return!1;parseFloat(T[Zs[V]])!==Ve(T[Zs[V]])&&(z=!0)}return!0}function np(){return this._isValid}function rT(){return ii(NaN)}function Kn(T){var D=Me(T),z=D.year||0,V=D.quarter||0,Q=D.month||0,fe=D.week||D.isoWeek||0,Ae=D.day||0,st=D.hour||0,Ft=D.minute||0,yr=D.second||0,In=D.millisecond||0;this._isValid=tT(D),this._milliseconds=+In+yr*1e3+Ft*6e4+st*1e3*60*60,this._days=+Ae+fe*7,this._months=+Q+V*3+z*12,this._data={},this._locale=Va(),this._bubble()}function gd(T){return T instanceof Kn}function Ks(T){return T<0?Math.round(-1*T)*-1:Math.round(T)}function iT(T,D,z){var V=Math.min(T.length,D.length),Q=Math.abs(T.length-D.length),fe=0,Ae;for(Ae=0;Ae<V;Ae++)(z&&T[Ae]!==D[Ae]||!z&&Ve(T[Ae])!==Ve(D[Ae]))&&fe++;return fe+Q}function Wa(T,D){ne(T,0,0,function(){var z=this.utcOffset(),V="+";return z<0&&(z=-z,V="-"),V+X(~~(z/60),2)+D+X(~~z%60,2)})}Wa("Z",":"),Wa("ZZ",""),De("Z",ur),De("ZZ",ur),Dt(["Z","ZZ"],function(T,D,z){z._useUTC=!0,z._tzm=yd(ur,T)});var vd=/([\+\-]|\d\d)/gi;function yd(T,D){var z=(D||"").match(T),V,Q,fe;return z===null?null:(V=z[z.length-1]||[],Q=(V+"").match(vd)||["-",0,0],fe=+(Q[1]*60)+Ve(Q[2]),fe===0?0:Q[0]==="+"?fe:-fe)}function zc(T,D){var z,V;return D._isUTC?(z=D.clone(),V=(O(T)||h(T)?T.valueOf():Kt(T).valueOf())-z.valueOf(),z._d.setTime(z._d.valueOf()+V),r.updateOffset(z,!1),z):Kt(T).local()}function ml(T){return-Math.round(T._d.getTimezoneOffset())}r.updateOffset=function(){};function ap(T,D,z){var V=this._offset||0,Q;if(!this.isValid())return T!=null?this:NaN;if(T!=null){if(typeof T=="string"){if(T=yd(ur,T),T===null)return this}else Math.abs(T)<16&&!z&&(T=T*60);return!this._isUTC&&D&&(Q=ml(this)),this._offset=T,this._isUTC=!0,Q!=null&&this.add(Q,"m"),V!==T&&(!D||this._changeInProgress?op(this,ii(T-V,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?V:ml(this)}function bd(T,D){return T!=null?(typeof T!="string"&&(T=-T),this.utcOffset(T,D),this):-this.utcOffset()}function gl(T){return this.utcOffset(0,T)}function wd(T){return this._isUTC&&(this.utcOffset(0,T),this._isUTC=!1,T&&this.subtract(ml(this),"m")),this}function sp(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var T=yd(Kr,this._i);T!=null?this.utcOffset(T):this.utcOffset(0,!0)}return this}function Bv(T){return this.isValid()?(T=T?Kt(T).utcOffset():0,(this.utcOffset()-T)%60===0):!1}function nT(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ed(){if(!u(this._isDSTShifted))return this._isDSTShifted;var T={},D;return I(T,this),T=Rv(T),T._a?(D=T._isUTC?g(T._a):Kt(T._a),this._isDSTShifted=this.isValid()&&iT(T._a,D.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function aT(){return this.isValid()?!this._isUTC:!1}function $v(){return this.isValid()?this._isUTC:!1}function zv(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Hv=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,sT=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ii(T,D){var z=T,V=null,Q,fe,Ae;return gd(T)?z={ms:T._milliseconds,d:T._days,M:T._months}:d(T)||!isNaN(+T)?(z={},D?z[D]=+T:z.milliseconds=+T):(V=Hv.exec(T))?(Q=V[1]==="-"?-1:1,z={y:0,d:Ve(V[dr])*Q,h:Ve(V[zt])*Q,m:Ve(V[xi])*Q,s:Ve(V[Rr])*Q,ms:Ve(Ks(V[$a]*1e3))*Q}):(V=sT.exec(T))?(Q=V[1]==="-"?-1:1,z={y:Ua(V[2],Q),M:Ua(V[3],Q),w:Ua(V[4],Q),d:Ua(V[5],Q),h:Ua(V[6],Q),m:Ua(V[7],Q),s:Ua(V[8],Q)}):z==null?z={}:typeof z=="object"&&("from"in z||"to"in z)&&(Ae=Td(Kt(z.from),Kt(z.to)),z={},z.ms=Ae.milliseconds,z.M=Ae.months),fe=new Kn(z),gd(T)&&l(T,"_locale")&&(fe._locale=T._locale),gd(T)&&l(T,"_isValid")&&(fe._isValid=T._isValid),fe}ii.fn=Kn.prototype,ii.invalid=rT;function Ua(T,D){var z=T&&parseFloat(T.replace(",","."));return(isNaN(z)?0:z)*D}function Gv(T,D){var z={};return z.months=D.month()-T.month()+(D.year()-T.year())*12,T.clone().add(z.months,"M").isAfter(D)&&--z.months,z.milliseconds=+D-+T.clone().add(z.months,"M"),z}function Td(T,D){var z;return T.isValid()&&D.isValid()?(D=zc(D,T),T.isBefore(D)?z=Gv(T,D):(z=Gv(D,T),z.milliseconds=-z.milliseconds,z.months=-z.months),z):{milliseconds:0,months:0}}function Vv(T,D){return function(z,V){var Q,fe;return V!==null&&!isNaN(+V)&&(k(D,"moment()."+D+"(period, number) is deprecated. Please use moment()."+D+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),fe=z,z=V,V=fe),Q=ii(z,V),op(this,Q,T),this}}function op(T,D,z,V){var Q=D._milliseconds,fe=Ks(D._days),Ae=Ks(D._months);T.isValid()&&(V=V==null?!0:V,Ae&&ba(T,$e(T,"Month")+Ae*z),fe&&Ie(T,"Date",$e(T,"Date")+fe*z),Q&&T._d.setTime(T._d.valueOf()+Q*z),V&&r.updateOffset(T,fe||Ae))}var oT=Vv(1,"add"),Hc=Vv(-1,"subtract");function Wv(T){return typeof T=="string"||T instanceof String}function vl(T){return O(T)||h(T)||Wv(T)||d(T)||jv(T)||Uv(T)||T===null||T===void 0}function Uv(T){var D=o(T)&&!c(T),z=!1,V=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],Q,fe,Ae=V.length;for(Q=0;Q<Ae;Q+=1)fe=V[Q],z=z||l(T,fe);return D&&z}function jv(T){var D=s(T),z=!1;return D&&(z=T.filter(function(V){return!d(V)&&Wv(T)}).length===0),D&&z}function lT(T){var D=o(T)&&!c(T),z=!1,V=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],Q,fe;for(Q=0;Q<V.length;Q+=1)fe=V[Q],z=z||l(T,fe);return D&&z}function ps(T,D){var z=T.diff(D,"days",!0);return z<-6?"sameElse":z<-1?"lastWeek":z<0?"lastDay":z<1?"sameDay":z<2?"nextDay":z<7?"nextWeek":"sameElse"}function Yv(T,D){arguments.length===1&&(arguments[0]?vl(arguments[0])?(T=arguments[0],D=void 0):lT(arguments[0])&&(D=arguments[0],T=void 0):(T=void 0,D=void 0));var z=T||Kt(),V=zc(z,this).startOf("day"),Q=r.calendarFormat(this,V)||"sameElse",fe=D&&(N(D[Q])?D[Q].call(this,z):D[Q]);return this.format(fe||this.localeData().calendar(Q,this,Kt(z)))}function qv(){return new M(this)}function Gc(T,D){var z=O(T)?T:Kt(T);return this.isValid()&&z.isValid()?(D=Le(D)||"millisecond",D==="millisecond"?this.valueOf()>z.valueOf():z.valueOf()<this.clone().startOf(D).valueOf()):!1}function cT(T,D){var z=O(T)?T:Kt(T);return this.isValid()&&z.isValid()?(D=Le(D)||"millisecond",D==="millisecond"?this.valueOf()<z.valueOf():this.clone().endOf(D).valueOf()<z.valueOf()):!1}function Cd(T,D,z,V){var Q=O(T)?T:Kt(T),fe=O(D)?D:Kt(D);return this.isValid()&&Q.isValid()&&fe.isValid()?(V=V||"()",(V[0]==="("?this.isAfter(Q,z):!this.isBefore(Q,z))&&(V[1]===")"?this.isBefore(fe,z):!this.isAfter(fe,z))):!1}function Vc(T,D){var z=O(T)?T:Kt(T),V;return this.isValid()&&z.isValid()?(D=Le(D)||"millisecond",D==="millisecond"?this.valueOf()===z.valueOf():(V=z.valueOf(),this.clone().startOf(D).valueOf()<=V&&V<=this.clone().endOf(D).valueOf())):!1}function Zv(T,D){return this.isSame(T,D)||this.isAfter(T,D)}function Kv(T,D){return this.isSame(T,D)||this.isBefore(T,D)}function uT(T,D,z){var V,Q,fe;if(!this.isValid())return NaN;if(V=zc(T,this),!V.isValid())return NaN;switch(Q=(V.utcOffset()-this.utcOffset())*6e4,D=Le(D),D){case"year":fe=Wc(this,V)/12;break;case"month":fe=Wc(this,V);break;case"quarter":fe=Wc(this,V)/3;break;case"second":fe=(this-V)/1e3;break;case"minute":fe=(this-V)/6e4;break;case"hour":fe=(this-V)/36e5;break;case"day":fe=(this-V-Q)/864e5;break;case"week":fe=(this-V-Q)/6048e5;break;default:fe=this-V}return z?fe:ct(fe)}function Wc(T,D){if(T.date()<D.date())return-Wc(D,T);var z=(D.year()-T.year())*12+(D.month()-T.month()),V=T.clone().add(z,"months"),Q,fe;return D-V<0?(Q=T.clone().add(z-1,"months"),fe=(D-V)/(V-Q)):(Q=T.clone().add(z+1,"months"),fe=(D-V)/(Q-V)),-(z+fe)||0}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Xv(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Jv(T){if(!this.isValid())return null;var D=T!==!0,z=D?this.clone().utc():this;return z.year()<0||z.year()>9999?Se(z,D?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):N(Date.prototype.toISOString)?D?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Se(z,"Z")):Se(z,D?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Qv(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var T="moment",D="",z,V,Q,fe;return this.isLocal()||(T=this.utcOffset()===0?"moment.utc":"moment.parseZone",D="Z"),z="["+T+'("]',V=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",Q="-MM-DD[T]HH:mm:ss.SSS",fe=D+'[")]',this.format(z+V+Q+fe)}function ey(T){T||(T=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var D=Se(this,T);return this.localeData().postformat(D)}function dT(T,D){return this.isValid()&&(O(T)&&T.isValid()||Kt(T).isValid())?ii({to:this,from:T}).locale(this.locale()).humanize(!D):this.localeData().invalidDate()}function ty(T){return this.from(Kt(),T)}function ry(T,D){return this.isValid()&&(O(T)&&T.isValid()||Kt(T).isValid())?ii({from:this,to:T}).locale(this.locale()).humanize(!D):this.localeData().invalidDate()}function hT(T){return this.to(Kt(),T)}function p(T){var D;return T===void 0?this._locale._abbr:(D=Va(T),D!=null&&(this._locale=D),this)}var b=F("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(T){return T===void 0?this.localeData():this.locale(T)});function S(){return this._locale}var A=1e3,H=60*A,J=60*H,de=(365*400+97)*24*J;function be(T,D){return(T%D+D)%D}function ke(T,D,z){return T<100&&T>=0?new Date(T+400,D,z)-de:new Date(T,D,z).valueOf()}function Be(T,D,z){return T<100&&T>=0?Date.UTC(T+400,D,z)-de:Date.UTC(T,D,z)}function Ke(T){var D,z;if(T=Le(T),T===void 0||T==="millisecond"||!this.isValid())return this;switch(z=this._isUTC?Be:ke,T){case"year":D=z(this.year(),0,1);break;case"quarter":D=z(this.year(),this.month()-this.month()%3,1);break;case"month":D=z(this.year(),this.month(),1);break;case"week":D=z(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":D=z(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":D=z(this.year(),this.month(),this.date());break;case"hour":D=this._d.valueOf(),D-=be(D+(this._isUTC?0:this.utcOffset()*H),J);break;case"minute":D=this._d.valueOf(),D-=be(D,H);break;case"second":D=this._d.valueOf(),D-=be(D,A);break}return this._d.setTime(D),r.updateOffset(this,!0),this}function dt(T){var D,z;if(T=Le(T),T===void 0||T==="millisecond"||!this.isValid())return this;switch(z=this._isUTC?Be:ke,T){case"year":D=z(this.year()+1,0,1)-1;break;case"quarter":D=z(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":D=z(this.year(),this.month()+1,1)-1;break;case"week":D=z(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":D=z(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":D=z(this.year(),this.month(),this.date()+1)-1;break;case"hour":D=this._d.valueOf(),D+=J-be(D+(this._isUTC?0:this.utcOffset()*H),J)-1;break;case"minute":D=this._d.valueOf(),D+=H-be(D,H)-1;break;case"second":D=this._d.valueOf(),D+=A-be(D,A)-1;break}return this._d.setTime(D),r.updateOffset(this,!0),this}function Ot(){return this._d.valueOf()-(this._offset||0)*6e4}function Ji(){return Math.floor(this.valueOf()/1e3)}function pi(){return new Date(this.valueOf())}function Xn(){var T=this;return[T.year(),T.month(),T.date(),T.hour(),T.minute(),T.second(),T.millisecond()]}function dn(){var T=this;return{years:T.year(),months:T.month(),date:T.date(),hours:T.hours(),minutes:T.minutes(),seconds:T.seconds(),milliseconds:T.milliseconds()}}function yl(){return this.isValid()?this.toISOString():null}function fT(){return C(this)}function pT(){return m({},v(this))}function mT(){return v(this).overflow}function iy(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ne("N",0,0,"eraAbbr"),ne("NN",0,0,"eraAbbr"),ne("NNN",0,0,"eraAbbr"),ne("NNNN",0,0,"eraName"),ne("NNNNN",0,0,"eraNarrow"),ne("y",["y",1],"yo","eraYear"),ne("y",["yy",2],0,"eraYear"),ne("y",["yyy",3],0,"eraYear"),ne("y",["yyyy",4],0,"eraYear"),De("N",ET),De("NN",ET),De("NNN",ET),De("NNNN",nW),De("NNNNN",aW),Dt(["N","NN","NNN","NNNN","NNNNN"],function(T,D,z,V){var Q=z._locale.erasParse(T,V,z._strict);Q?v(z).era=Q:v(z).invalidEra=T}),De("y",wt),De("yy",wt),De("yyy",wt),De("yyyy",wt),De("yo",sW),Dt(["y","yy","yyy","yyyy"],Sr),Dt(["yo"],function(T,D,z,V){var Q;z._locale._eraYearOrdinalRegex&&(Q=T.match(z._locale._eraYearOrdinalRegex)),z._locale.eraYearOrdinalParse?D[Sr]=z._locale.eraYearOrdinalParse(T,Q):D[Sr]=parseInt(T,10)});function gT(T,D){var z,V,Q,fe=this._eras||Va("en")._eras;for(z=0,V=fe.length;z<V;++z){switch(typeof fe[z].since){case"string":Q=r(fe[z].since).startOf("day"),fe[z].since=Q.valueOf();break}switch(typeof fe[z].until){case"undefined":fe[z].until=1/0;break;case"string":Q=r(fe[z].until).startOf("day").valueOf(),fe[z].until=Q.valueOf();break}}return fe}function ny(T,D,z){var V,Q,fe=this.eras(),Ae,st,Ft;for(T=T.toUpperCase(),V=0,Q=fe.length;V<Q;++V)if(Ae=fe[V].name.toUpperCase(),st=fe[V].abbr.toUpperCase(),Ft=fe[V].narrow.toUpperCase(),z)switch(D){case"N":case"NN":case"NNN":if(st===T)return fe[V];break;case"NNNN":if(Ae===T)return fe[V];break;case"NNNNN":if(Ft===T)return fe[V];break}else if([Ae,st,Ft].indexOf(T)>=0)return fe[V]}function ni(T,D){var z=T.since<=T.until?1:-1;return D===void 0?r(T.since).year():r(T.since).year()+(D-T.offset)*z}function _d(){var T,D,z,V=this.localeData().eras();for(T=0,D=V.length;T<D;++T)if(z=this.clone().startOf("day").valueOf(),V[T].since<=z&&z<=V[T].until||V[T].until<=z&&z<=V[T].since)return V[T].name;return""}function vT(){var T,D,z,V=this.localeData().eras();for(T=0,D=V.length;T<D;++T)if(z=this.clone().startOf("day").valueOf(),V[T].since<=z&&z<=V[T].until||V[T].until<=z&&z<=V[T].since)return V[T].narrow;return""}function yT(){var T,D,z,V=this.localeData().eras();for(T=0,D=V.length;T<D;++T)if(z=this.clone().startOf("day").valueOf(),V[T].since<=z&&z<=V[T].until||V[T].until<=z&&z<=V[T].since)return V[T].abbr;return""}function bT(){var T,D,z,V,Q=this.localeData().eras();for(T=0,D=Q.length;T<D;++T)if(z=Q[T].since<=Q[T].until?1:-1,V=this.clone().startOf("day").valueOf(),Q[T].since<=V&&V<=Q[T].until||Q[T].until<=V&&V<=Q[T].since)return(this.year()-r(Q[T].since).year())*z+Q[T].offset;return this.year()}function lp(T){return l(this,"_erasNameRegex")||TT.call(this),T?this._erasNameRegex:this._erasRegex}function ay(T){return l(this,"_erasAbbrRegex")||TT.call(this),T?this._erasAbbrRegex:this._erasRegex}function wT(T){return l(this,"_erasNarrowRegex")||TT.call(this),T?this._erasNarrowRegex:this._erasRegex}function ET(T,D){return D.erasAbbrRegex(T)}function nW(T,D){return D.erasNameRegex(T)}function aW(T,D){return D.erasNarrowRegex(T)}function sW(T,D){return D._eraYearOrdinalRegex||wt}function TT(){var T=[],D=[],z=[],V=[],Q,fe,Ae=this.eras();for(Q=0,fe=Ae.length;Q<fe;++Q)D.push(Nt(Ae[Q].name)),T.push(Nt(Ae[Q].abbr)),z.push(Nt(Ae[Q].narrow)),V.push(Nt(Ae[Q].name)),V.push(Nt(Ae[Q].abbr)),V.push(Nt(Ae[Q].narrow));this._erasRegex=new RegExp("^("+V.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+D.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+T.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+z.join("|")+")","i")}ne(0,["gg",2],0,function(){return this.weekYear()%100}),ne(0,["GG",2],0,function(){return this.isoWeekYear()%100});function sy(T,D){ne(0,[T,T.length],0,D)}sy("gggg","weekYear"),sy("ggggg","weekYear"),sy("GGGG","isoWeekYear"),sy("GGGGG","isoWeekYear"),we("weekYear","gg"),we("isoWeekYear","GG"),Ge("weekYear",1),Ge("isoWeekYear",1),De("G",vt),De("g",vt),De("GG",ze,xe),De("gg",ze,xe),De("GGGG",bt,qe),De("gggg",bt,qe),De("GGGGG",Xe,Re),De("ggggg",Xe,Re),Dn(["gggg","ggggg","GGGG","GGGGG"],function(T,D,z,V){D[V.substr(0,2)]=Ve(T)}),Dn(["gg","GG"],function(T,D,z,V){D[V]=r.parseTwoDigitYear(T)});function oW(T){return SP.call(this,T,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function lW(T){return SP.call(this,T,this.isoWeek(),this.isoWeekday(),1,4)}function cW(){return Ln(this.year(),1,4)}function uW(){return Ln(this.isoWeekYear(),1,4)}function dW(){var T=this.localeData()._week;return Ln(this.year(),T.dow,T.doy)}function hW(){var T=this.localeData()._week;return Ln(this.weekYear(),T.dow,T.doy)}function SP(T,D,z,V,Q){var fe;return T==null?hs(this,V,Q).year:(fe=Ln(T,V,Q),D>fe&&(D=fe),fW.call(this,T,D,z,V,Q))}function fW(T,D,z,V,Q){var fe=Us(T,D,z,V,Q),Ae=wa(fe.year,0,fe.dayOfYear);return this.year(Ae.getUTCFullYear()),this.month(Ae.getUTCMonth()),this.date(Ae.getUTCDate()),this}ne("Q",0,"Qo","quarter"),we("quarter","Q"),Ge("quarter",7),De("Q",Pe),Dt("Q",function(T,D){D[Lr]=(Ve(T)-1)*3});function pW(T){return T==null?Math.ceil((this.month()+1)/3):this.month((T-1)*3+this.month()%3)}ne("D",["DD",2],"Do","date"),we("date","D"),Ge("date",9),De("D",ze),De("DD",ze,xe),De("Do",function(T,D){return T?D._dayOfMonthOrdinalParse||D._ordinalParse:D._dayOfMonthOrdinalParseLenient}),Dt(["D","DD"],dr),Dt("Do",function(T,D){D[dr]=Ve(T.match(ze)[0])});var xP=et("Date",!0);ne("DDD",["DDDD",3],"DDDo","dayOfYear"),we("dayOfYear","DDD"),Ge("dayOfYear",4),De("DDD",Ct),De("DDDD",Fe),Dt(["DDD","DDDD"],function(T,D,z){z._dayOfYear=Ve(T)});function mW(T){var D=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return T==null?D:this.add(T-D,"d")}ne("m",["mm",2],0,"minute"),we("minute","m"),Ge("minute",14),De("m",ze),De("mm",ze,xe),Dt(["m","mm"],xi);var gW=et("Minutes",!1);ne("s",["ss",2],0,"second"),we("second","s"),Ge("second",15),De("s",ze),De("ss",ze,xe),Dt(["s","ss"],Rr);var vW=et("Seconds",!1);ne("S",0,0,function(){return~~(this.millisecond()/100)}),ne(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),ne(0,["SSS",3],0,"millisecond"),ne(0,["SSSS",4],0,function(){return this.millisecond()*10}),ne(0,["SSSSS",5],0,function(){return this.millisecond()*100}),ne(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),ne(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),ne(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),ne(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),we("millisecond","ms"),Ge("millisecond",16),De("S",Ct,Pe),De("SS",Ct,xe),De("SSS",Ct,Fe);var bl,kP;for(bl="SSSS";bl.length<=9;bl+="S")De(bl,wt);function yW(T,D){D[$a]=Ve(("0."+T)*1e3)}for(bl="S";bl.length<=9;bl+="S")Dt(bl,yW);kP=et("Milliseconds",!1),ne("z",0,0,"zoneAbbr"),ne("zz",0,0,"zoneName");function bW(){return this._isUTC?"UTC":""}function wW(){return this._isUTC?"Coordinated Universal Time":""}var He=M.prototype;He.add=oT,He.calendar=Yv,He.clone=qv,He.diff=uT,He.endOf=dt,He.format=ey,He.from=dT,He.fromNow=ty,He.to=ry,He.toNow=hT,He.get=ee,He.invalidAt=mT,He.isAfter=Gc,He.isBefore=cT,He.isBetween=Cd,He.isSame=Vc,He.isSameOrAfter=Zv,He.isSameOrBefore=Kv,He.isValid=fT,He.lang=b,He.locale=p,He.localeData=S,He.max=$c,He.min=QE,He.parsingFlags=pT,He.set=ye,He.startOf=Ke,He.subtract=Hc,He.toArray=Xn,He.toObject=dn,He.toDate=pi,He.toISOString=Jv,He.inspect=Qv,typeof Symbol!="undefined"&&Symbol.for!=null&&(He[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),He.toJSON=yl,He.toString=Xv,He.unix=Ji,He.valueOf=Ot,He.creationData=iy,He.eraName=_d,He.eraNarrow=vT,He.eraAbbr=yT,He.eraYear=bT,He.year=Pn,He.isLeapYear=GE,He.weekYear=oW,He.isoWeekYear=lW,He.quarter=He.quarters=pW,He.month=za,He.daysInMonth=ds,He.week=He.weeks=ld,He.isoWeek=He.isoWeeks=Gf,He.weeksInYear=dW,He.weeksInWeekYear=hW,He.isoWeeksInYear=cW,He.isoWeeksInISOWeekYear=uW,He.date=xP,He.day=He.days=Ic,He.weekday=ki,He.isoWeekday=To,He.dayOfYear=mW,He.hour=He.hours=Oc,He.minute=He.minutes=gW,He.second=He.seconds=vW,He.millisecond=He.milliseconds=kP,He.utcOffset=ap,He.utc=gl,He.local=wd,He.parseZone=sp,He.hasAlignedHourOffset=Bv,He.isDST=nT,He.isLocal=aT,He.isUtcOffset=$v,He.isUtc=zv,He.isUTC=zv,He.zoneAbbr=bW,He.zoneName=wW,He.dates=F("dates accessor is deprecated. Use date instead.",xP),He.months=F("months accessor is deprecated. Use month instead",za),He.years=F("years accessor is deprecated. Use year instead",Pn),He.zone=F("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",bd),He.isDSTShifted=F("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Ed);function EW(T){return Kt(T*1e3)}function TW(){return Kt.apply(null,arguments).parseZone()}function DP(T){return T}var Xt=Y.prototype;Xt.calendar=q,Xt.longDateFormat=pe,Xt.invalidDate=oe,Xt.ordinal=re,Xt.preparse=DP,Xt.postformat=DP,Xt.relativeTime=Ee,Xt.pastFuture=Ce,Xt.set=G,Xt.eras=gT,Xt.erasParse=ny,Xt.erasConvertYear=ni,Xt.erasAbbrRegex=ay,Xt.erasNameRegex=lp,Xt.erasNarrowRegex=wT,Xt.months=Ws,Xt.monthsShort=Bt,Xt.monthsParse=$i,Xt.monthsRegex=Br,Xt.monthsShortRegex=ot,Xt.week=$f,Xt.firstDayOfYear=Hf,Xt.firstDayOfWeek=zf,Xt.weekdays=Uf,Xt.weekdaysMin=Yf,Xt.weekdaysShort=jf,Xt.weekdaysParse=qf,Xt.weekdaysRegex=Sv,Xt.weekdaysShortRegex=xv,Xt.weekdaysMinRegex=VE,Xt.isPM=UE,Xt.meridiem=kv;function oy(T,D,z,V){var Q=Va(),fe=g().set(V,D);return Q[z](fe,T)}function PP(T,D,z){if(d(T)&&(D=T,T=void 0),T=T||"",D!=null)return oy(T,D,z,"month");var V,Q=[];for(V=0;V<12;V++)Q[V]=oy(T,V,z,"month");return Q}function CT(T,D,z,V){typeof T=="boolean"?(d(D)&&(z=D,D=void 0),D=D||""):(D=T,z=D,T=!1,d(D)&&(z=D,D=void 0),D=D||"");var Q=Va(),fe=T?Q._week.dow:0,Ae,st=[];if(z!=null)return oy(D,(z+fe)%7,V,"day");for(Ae=0;Ae<7;Ae++)st[Ae]=oy(D,(Ae+fe)%7,V,"day");return st}function CW(T,D){return PP(T,D,"months")}function _W(T,D){return PP(T,D,"monthsShort")}function SW(T,D,z){return CT(T,D,z,"weekdays")}function xW(T,D,z){return CT(T,D,z,"weekdaysShort")}function kW(T,D,z){return CT(T,D,z,"weekdaysMin")}js("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(T){var D=T%10,z=Ve(T%100/10)===1?"th":D===1?"st":D===2?"nd":D===3?"rd":"th";return T+z}}),r.lang=F("moment.lang is deprecated. Use moment.locale instead.",js),r.langData=F("moment.langData is deprecated. Use moment.localeData instead.",Va);var _o=Math.abs;function DW(){var T=this._data;return this._milliseconds=_o(this._milliseconds),this._days=_o(this._days),this._months=_o(this._months),T.milliseconds=_o(T.milliseconds),T.seconds=_o(T.seconds),T.minutes=_o(T.minutes),T.hours=_o(T.hours),T.months=_o(T.months),T.years=_o(T.years),this}function LP(T,D,z,V){var Q=ii(D,z);return T._milliseconds+=V*Q._milliseconds,T._days+=V*Q._days,T._months+=V*Q._months,T._bubble()}function PW(T,D){return LP(this,T,D,1)}function LW(T,D){return LP(this,T,D,-1)}function MP(T){return T<0?Math.floor(T):Math.ceil(T)}function MW(){var T=this._milliseconds,D=this._days,z=this._months,V=this._data,Q,fe,Ae,st,Ft;return T>=0&&D>=0&&z>=0||T<=0&&D<=0&&z<=0||(T+=MP(_T(z)+D)*864e5,D=0,z=0),V.milliseconds=T%1e3,Q=ct(T/1e3),V.seconds=Q%60,fe=ct(Q/60),V.minutes=fe%60,Ae=ct(fe/60),V.hours=Ae%24,D+=ct(Ae/24),Ft=ct(IP(D)),z+=Ft,D-=MP(_T(Ft)),st=ct(z/12),z%=12,V.days=D,V.months=z,V.years=st,this}function IP(T){return T*4800/146097}function _T(T){return T*146097/4800}function IW(T){if(!this.isValid())return NaN;var D,z,V=this._milliseconds;if(T=Le(T),T==="month"||T==="quarter"||T==="year")switch(D=this._days+V/864e5,z=this._months+IP(D),T){case"month":return z;case"quarter":return z/3;case"year":return z/12}else switch(D=this._days+Math.round(_T(this._months)),T){case"week":return D/7+V/6048e5;case"day":return D+V/864e5;case"hour":return D*24+V/36e5;case"minute":return D*1440+V/6e4;case"second":return D*86400+V/1e3;case"millisecond":return Math.floor(D*864e5)+V;default:throw new Error("Unknown unit "+T)}}function AW(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ve(this._months/12)*31536e6:NaN}function So(T){return function(){return this.as(T)}}var OW=So("ms"),FW=So("s"),RW=So("m"),NW=So("h"),BW=So("d"),$W=So("w"),zW=So("M"),HW=So("Q"),GW=So("y");function VW(){return ii(this)}function WW(T){return T=Le(T),this.isValid()?this[T+"s"]():NaN}function Uc(T){return function(){return this.isValid()?this._data[T]:NaN}}var UW=Uc("milliseconds"),jW=Uc("seconds"),YW=Uc("minutes"),qW=Uc("hours"),ZW=Uc("days"),KW=Uc("months"),XW=Uc("years");function JW(){return ct(this.days()/7)}var xo=Math.round,Sd={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function QW(T,D,z,V,Q){return Q.relativeTime(D||1,!!z,T,V)}function eU(T,D,z,V){var Q=ii(T).abs(),fe=xo(Q.as("s")),Ae=xo(Q.as("m")),st=xo(Q.as("h")),Ft=xo(Q.as("d")),yr=xo(Q.as("M")),In=xo(Q.as("w")),ko=xo(Q.as("y")),wl=fe<=z.ss&&["s",fe]||fe<z.s&&["ss",fe]||Ae<=1&&["m"]||Ae<z.m&&["mm",Ae]||st<=1&&["h"]||st<z.h&&["hh",st]||Ft<=1&&["d"]||Ft<z.d&&["dd",Ft];return z.w!=null&&(wl=wl||In<=1&&["w"]||In<z.w&&["ww",In]),wl=wl||yr<=1&&["M"]||yr<z.M&&["MM",yr]||ko<=1&&["y"]||["yy",ko],wl[2]=D,wl[3]=+T>0,wl[4]=V,QW.apply(null,wl)}function tU(T){return T===void 0?xo:typeof T=="function"?(xo=T,!0):!1}function rU(T,D){return Sd[T]===void 0?!1:D===void 0?Sd[T]:(Sd[T]=D,T==="s"&&(Sd.ss=D-1),!0)}function iU(T,D){if(!this.isValid())return this.localeData().invalidDate();var z=!1,V=Sd,Q,fe;return typeof T=="object"&&(D=T,T=!1),typeof T=="boolean"&&(z=T),typeof D=="object"&&(V=Object.assign({},Sd,D),D.s!=null&&D.ss==null&&(V.ss=D.s-1)),Q=this.localeData(),fe=eU(this,!z,V,Q),z&&(fe=Q.pastFuture(+this,fe)),Q.postformat(fe)}var ST=Math.abs;function xd(T){return(T>0)-(T<0)||+T}function ly(){if(!this.isValid())return this.localeData().invalidDate();var T=ST(this._milliseconds)/1e3,D=ST(this._days),z=ST(this._months),V,Q,fe,Ae,st=this.asSeconds(),Ft,yr,In,ko;return st?(V=ct(T/60),Q=ct(V/60),T%=60,V%=60,fe=ct(z/12),z%=12,Ae=T?T.toFixed(3).replace(/\.?0+$/,""):"",Ft=st<0?"-":"",yr=xd(this._months)!==xd(st)?"-":"",In=xd(this._days)!==xd(st)?"-":"",ko=xd(this._milliseconds)!==xd(st)?"-":"",Ft+"P"+(fe?yr+fe+"Y":"")+(z?yr+z+"M":"")+(D?In+D+"D":"")+(Q||V||T?"T":"")+(Q?ko+Q+"H":"")+(V?ko+V+"M":"")+(T?ko+Ae+"S":"")):"P0D"}var Ut=Kn.prototype;Ut.isValid=np,Ut.abs=DW,Ut.add=PW,Ut.subtract=LW,Ut.as=IW,Ut.asMilliseconds=OW,Ut.asSeconds=FW,Ut.asMinutes=RW,Ut.asHours=NW,Ut.asDays=BW,Ut.asWeeks=$W,Ut.asMonths=zW,Ut.asQuarters=HW,Ut.asYears=GW,Ut.valueOf=AW,Ut._bubble=MW,Ut.clone=VW,Ut.get=WW,Ut.milliseconds=UW,Ut.seconds=jW,Ut.minutes=YW,Ut.hours=qW,Ut.days=ZW,Ut.weeks=JW,Ut.months=KW,Ut.years=XW,Ut.humanize=iU,Ut.toISOString=ly,Ut.toString=ly,Ut.toJSON=ly,Ut.locale=p,Ut.localeData=S,Ut.toIsoString=F("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ly),Ut.lang=b,ne("X",0,0,"unix"),ne("x",0,0,"valueOf"),De("x",vt),De("X",Si),Dt("X",function(T,D,z){z._d=new Date(parseFloat(T)*1e3)}),Dt("x",function(T,D,z){z._d=new Date(Ve(T))});return r.version="2.29.4",n(Kt),r.fn=He,r.min=md,r.max=eT,r.now=qs,r.utc=g,r.unix=EW,r.months=CW,r.isDate=h,r.locale=js,r.invalid=_,r.duration=ii,r.isMoment=O,r.weekdays=SW,r.parseZone=TW,r.localeData=Va,r.isDuration=gd,r.monthsShort=_W,r.weekdaysMin=kW,r.defineLocale=hd,r.updateLocale=Ys,r.locales=Lv,r.weekdaysShort=xW,r.normalizeUnits=Le,r.relativeTimeRounding=tU,r.relativeTimeThreshold=rU,r.calendarFormat=ps,r.prototype=He,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r})})(zC)),zC.exports}function Gt(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function QA(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),m0(a,r.key,r)}}function Vt(a,t,e){return t&&QA(a.prototype,t),e&&QA(a,e),m0(a,"prototype",{writable:!1}),a}function Ht(a,t,e){return t in a?m0(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function xX(a){if(GR(a))return a}function EJ(a,t){var e=a==null?null:typeof Th!="undefined"&&oo(a)||a["@@iterator"];if(e!=null){var r=[],n=!0,s=!1,o,l;try{for(e=e.call(a);!(n=(o=e.next()).done)&&(r.push(o.value),!(t&&r.length===t));n=!0);}catch(c){s=!0,l=c}finally{try{!n&&e.return!=null&&e.return()}finally{if(s)throw l}}return r}}function TS(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function qR(a,t){var e;if(a){if(typeof a=="string")return TS(a,t);var r=jJ(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return YR(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TS(a,t)}}function XJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nn(a,t){return xX(a)||EJ(a,t)||qR(a,t)||XJ()}function yt(a){"@babel/helpers - typeof";return yt=typeof Th=="function"&&typeof aQ=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Th=="function"&&t.constructor===Th&&t!==Th.prototype?"symbol":typeof t},yt(a)}function sQ(a){if(GR(a))return TS(a)}function oQ(a){if(typeof Th!="undefined"&&oo(a)!=null||a["@@iterator"]!=null)return YR(a)}function lQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ur(a){return sQ(a)||oQ(a)||qR(a)||lQ()}function Ps(){return Ps=Object.assign||function(a){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a[r]=e[r])}return a},Ps.apply(this,arguments)}function os(a,t){a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.__proto__=t}function ub(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function y0(a,t){for(var e,r,n=t[0].toUpperCase()+t.slice(1),s=0;s<LO.length;){if(e=LO[s],r=e?e+n:t,r in a)return r;s++}}function cne(){if(!$N)return!1;var a={},t=Bo.CSS&&Bo.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(e){return a[e]=t?Bo.CSS.supports("touch-action",e):!0}),a}function $o(a,t,e){var r;if(a)if(a.forEach)a.forEach(t,e);else if(a.length!==void 0)for(r=0;r<a.length;)t.call(e,a[r],r,a),r++;else for(r in a)a.hasOwnProperty(r)&&t.call(e,a[r],r,a)}function b0(a,t){return typeof a===lne?a.apply(t&&t[0]||void 0,t):a}function du(a,t){return a.indexOf(t)>-1}function gne(a){if(du(a,fu))return fu;var t=du(a,Ym),e=du(a,qm);return t&&e?fu:t||e?t?Ym:qm:du(a,kS)?kS:HN}function Ix(a,t){for(;a;){if(a===t)return!0;a=a.parentNode}return!1}function jN(a){var t=a.length;if(t===1)return{x:Ch(a[0].clientX),y:Ch(a[0].clientY)};for(var e=0,r=0,n=0;n<t;)e+=a[n].clientX,r+=a[n].clientY,n++;return{x:Ch(e/t),y:Ch(r/t)}}function MO(a){for(var t=[],e=0;e<a.pointers.length;)t[e]={clientX:Ch(a.pointers[e].clientX),clientY:Ch(a.pointers[e].clientY)},e++;return{timeStamp:Lx(),pointers:t,center:jN(t),deltaX:a.deltaX,deltaY:a.deltaY}}function Bb(a,t,e){e||(e=WN);var r=t[e[0]]-a[e[0]],n=t[e[1]]-a[e[1]];return Math.sqrt(r*r+n*n)}function DS(a,t,e){e||(e=WN);var r=t[e[0]]-a[e[0]],n=t[e[1]]-a[e[1]];return Math.atan2(n,r)*180/Math.PI}function YN(a,t){return a===t?Rb:wu(a)>=wu(t)?a<0?xg:kg:t<0?Dg:Ah}function vne(a,t){var e=t.center,r=a.offsetDelta||{},n=a.prevDelta||{},s=a.prevInput||{};(t.eventType===zn||s.eventType===yi)&&(n=a.prevDelta={x:s.deltaX||0,y:s.deltaY||0},r=a.offsetDelta={x:e.x,y:e.y}),t.deltaX=n.x+(e.x-r.x),t.deltaY=n.y+(e.y-r.y)}function qN(a,t,e){return{x:t/a||0,y:e/a||0}}function yne(a,t){return Bb(t[0],t[1],Nb)/Bb(a[0],a[1],Nb)}function bne(a,t){return DS(t[1],t[0],Nb)+DS(a[1],a[0],Nb)}function wne(a,t){var e=a.lastInterval||t,r=t.timeStamp-e.timeStamp,n,s,o,l;if(t.eventType!==aa&&(r>mne||e.velocity===void 0)){var c=t.deltaX-e.deltaX,u=t.deltaY-e.deltaY,d=qN(r,c,u);s=d.x,o=d.y,n=wu(d.x)>wu(d.y)?d.x:d.y,l=YN(c,u),a.lastInterval=t}else n=e.velocity,s=e.velocityX,o=e.velocityY,l=e.direction;t.velocity=n,t.velocityX=s,t.velocityY=o,t.direction=l}function Ene(a,t){var e=a.session,r=t.pointers,n=r.length;e.firstInput||(e.firstInput=MO(t)),n>1&&!e.firstMultiple?e.firstMultiple=MO(t):n===1&&(e.firstMultiple=!1);var s=e.firstInput,o=e.firstMultiple,l=o?o.center:s.center,c=t.center=jN(r);t.timeStamp=Lx(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=DS(l,c),t.distance=Bb(l,c),vne(e,t),t.offsetDirection=YN(t.deltaX,t.deltaY);var u=qN(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=wu(u.x)>wu(u.y)?u.x:u.y,t.scale=o?yne(o.pointers,r):1,t.rotation=o?bne(o.pointers,r):0,t.maxPointers=e.prevInput?t.pointers.length>e.prevInput.maxPointers?t.pointers.length:e.prevInput.maxPointers:t.pointers.length,wne(e,t);var d=a.element,h=t.srcEvent,f;h.composedPath?f=h.composedPath()[0]:h.path?f=h.path[0]:f=h.target,Ix(f,d)&&(d=f),t.target=d}function Tne(a,t,e){var r=e.pointers.length,n=e.changedPointers.length,s=t&zn&&r-n===0,o=t&(yi|aa)&&r-n===0;e.isFirst=!!s,e.isFinal=!!o,s&&(a.session={}),e.eventType=t,Ene(a,e),a.emit("hammer.input",e),a.recognize(e),a.session.prevInput=e}function Zm(a){return a.trim().split(/\s+/g)}function Bm(a,t,e){$o(Zm(t),function(r){a.addEventListener(r,e,!1)})}function $m(a,t,e){$o(Zm(t),function(r){a.removeEventListener(r,e,!1)})}function IO(a){var t=a.ownerDocument||a;return t.defaultView||t.parentWindow||window}function Eu(a,t,e){if(a.indexOf&&!e)return a.indexOf(t);for(var r=0;r<a.length;){if(e&&a[r][e]==t||!e&&a[r]===t)return r;r++}return-1}function Km(a){return Array.prototype.slice.call(a,0)}function Ax(a,t,e){for(var r=[],n=[],s=0;s<a.length;){var o=t?a[s][t]:a[s];Eu(n,o)<0&&r.push(a[s]),n[s]=o,s++}return e&&(t?r=r.sort(function(l,c){return l[t]>c[t]}):r=r.sort()),r}function kne(a,t){var e=Km(a.touches),r=this.targetIds;if(t&(zn|Iu)&&e.length===1)return r[e[0].identifier]=!0,[e,e];var n,s,o=Km(a.changedTouches),l=[],c=this.target;if(s=e.filter(function(u){return Ix(u.target,c)}),t===zn)for(n=0;n<s.length;)r[s[n].identifier]=!0,n++;for(n=0;n<o.length;)r[o[n].identifier]&&l.push(o[n]),t&(yi|aa)&&delete r[o[n].identifier],n++;if(l.length)return[Ax(s.concat(l),"identifier",!0),l]}function OO(a){var t=a.changedPointers,e=t[0];if(e.identifier===this.primaryTouch){var r={x:e.clientX,y:e.clientY},n=this.lastTouches;this.lastTouches.push(r);var s=function(){var l=n.indexOf(r);l>-1&&n.splice(l,1)};setTimeout(s,Mne)}}function Ine(a,t){a&zn?(this.primaryTouch=t.changedPointers[0].identifier,OO.call(this,t)):a&(yi|aa)&&OO.call(this,t)}function Ane(a){for(var t=a.srcEvent.clientX,e=a.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var n=this.lastTouches[r],s=Math.abs(t-n.x),o=Math.abs(e-n.y);if(s<=AO&&o<=AO)return!0}return!1}function One(a){var t,e=a.options.inputClass;return e?t=e:dne?t=XN:hne?t=Ox:GN?t=JN:t=Fx,new t(a,Tne)}function _h(a,t,e){return Array.isArray(a)?($o(a,e[t],e),!0):!1}function Rne(){return Fne++}function hb(a,t){var e=t.manager;return e?e.get(a):a}function FO(a){return a&Xm?"cancel":a&ql?"end":a&Oh?"move":a&is?"start":""}function QN(a){return a===Ah?"down":a===Dg?"up":a===xg?"left":a===kg?"right":""}function BO(a,t){var e=a.element;if(e.style){var r;$o(a.options.cssProps,function(n,s){r=y0(e.style,s),t?(a.oldCssProps[r]=e.style[r],e.style[r]=n):e.style[r]=a.oldCssProps[r]||""}),t||(a.oldCssProps={})}}function Bne(a,t){var e=document.createEvent("Event");e.initEvent(a,!0,!0),e.gesture=t,t.target.dispatchEvent(e)}function Vne(a,t){var e=Km(a.touches),r=Km(a.changedTouches);return t&(yi|aa)&&(e=Ax(e.concat(r),"identifier",!0)),[e,r]}function aB(a,t,e){var r="DEPRECATED METHOD: "+t+`
`+e+` AT 
`;return function(){var n=new Error("get-stack-trace"),s=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=window.console&&(window.console.warn||window.console.log);return o&&o.call(window.console,r,s),a.apply(this,arguments)}}function Une(a,t,e){var r=t.prototype,n;n=a.prototype=Object.create(r),n.constructor=a,n._super=r,e&&bu(n,e)}function zO(a,t){return function(){return a.apply(t,arguments)}}function HO(a,t){var e=bi(a);if(Mh){var r=Mh(a);t&&(r=lt(r).call(r,function(n){return jh(a,n).enumerable})),e.push.apply(e,r)}return e}function GO(a){for(var t=1;t<arguments.length;t++){var e,r,n=arguments[t]!=null?arguments[t]:{};t%2?Ue(e=HO(Object(n),!0)).call(e,function(s){Ht(a,s,n[s])}):Ih?Cx(a,Ih(n)):Ue(r=HO(Object(n))).call(r,function(s){Eg(a,s,jh(n,s))})}return a}function Bx(a,t){var e=typeof qo!="undefined"&&oo(a)||a["@@iterator"];if(!e){if(Tt(a)||(e=jne(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return s=u.done,u},e:function(u){o=!0,l=u},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function jne(a,t){var e;if(a){if(typeof a=="string")return VO(a,t);var r=En(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return rc(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VO(a,t)}}function VO(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function oB(a){for(var t,e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return zx.apply(void 0,Ir(t=[{},a]).call(t,r))}function zx(){var a=$b.apply(void 0,arguments);return cB(a),a}function $b(){for(var a=arguments.length,t=new Array(a),e=0;e<a;e++)t[e]=arguments[e];if(t.length<2)return t[0];if(t.length>2){var r;return $b.apply(void 0,Ir(r=[zx(t[0],t[1])]).call(r,Ur(En(t).call(t,2))))}var n=t[0],s=t[1],o=Bx(eN(s)),l;try{for(o.s();!(l=o.n()).done;){var c=l.value;Object.prototype.propertyIsEnumerable.call(s,c)&&(s[c]===$x?delete n[c]:n[c]!==null&&s[c]!==null&&yt(n[c])==="object"&&yt(s[c])==="object"&&!Tt(n[c])&&!Tt(s[c])?n[c]=$b(n[c],s[c]):n[c]=lB(s[c]))}}catch(u){o.e(u)}finally{o.f()}return n}function lB(a){return Tt(a)?sr(a).call(a,function(t){return lB(t)}):yt(a)==="object"&&a!==null?$b({},a):a}function cB(a){for(var t=0,e=bi(a);t<e.length;t++){var r=e[t];a[r]===$x?delete a[r]:yt(a[r])==="object"&&a[r]!==null&&cB(a[r])}}function Yne(){for(var a=arguments.length,t=new Array(a),e=0;e<a;e++)t[e]=arguments[e];return qne(t.length?t:[Pa()])}function qne(a){var t=Zne(a),e=Nn(t,3),r=e[0],n=e[1],s=e[2],o=1,l=function(){var u=2091639*r+o*23283064365386963e-26;return r=n,n=s,s=u-(o=u|0)};return l.uint32=function(){return l()*4294967296},l.fract53=function(){return l()+(l()*2097152|0)*11102230246251565e-32},l.algorithm="Alea",l.seed=a,l.version="0.9",l}function Zne(){for(var a=Kne(),t=a(" "),e=a(" "),r=a(" "),n=0;n<arguments.length;n++)t-=a(n<0||arguments.length<=n?void 0:arguments[n]),t<0&&(t+=1),e-=a(n<0||arguments.length<=n?void 0:arguments[n]),e<0&&(e+=1),r-=a(n<0||arguments.length<=n?void 0:arguments[n]),r<0&&(r+=1);return[t,e,r]}function Kne(){var a=4022871197;return function(t){for(var e=t.toString(),r=0;r<e.length;r++){a+=e.charCodeAt(r);var n=.02519603282416938*a;a=n>>>0,n-=a,n*=a,a=n>>>0,n-=a,a+=n*4294967296}return(a>>>0)*23283064365386963e-26}}function Xne(){var a=function(){};return{on:a,off:a,destroy:a,emit:a,get:function(){return{set:a}}}}function io(a){var t=this,e;this._cleanupQueue=[],this.active=!1,this._dom={container:a,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push(function(){t._dom.overlay.parentNode.removeChild(t._dom.overlay)});var r=Hx(this._dom.overlay);r.on("tap",Oe(e=this._onTapOverlay).call(e,this)),this._cleanupQueue.push(function(){r.destroy()});var n=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];Ue(n).call(n,function(s){r.on(s,function(o){o.srcEvent.stopPropagation()})}),document&&document.body&&(this._onClick=function(s){Jne(s.target,a)||t.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push(function(){document.body.removeEventListener("click",t._onClick)})),this._escListener=function(s){("key"in s?s.key==="Escape":s.keyCode===27)&&t.deactivate()}}function Jne(a,t){for(;a;){if(a===t)return!0;a=a.parentNode}return!1}function zm(a){return a instanceof Number||typeof a=="number"}function uB(a){if(a)for(;a.hasChildNodes()===!0;){var t=a.firstChild;t&&(uB(t),a.removeChild(t))}}function Ma(a){return a instanceof String||typeof a=="string"}function LS(a){return yt(a)==="object"&&a!==null}function nae(a){if(a instanceof Date)return!0;if(Ma(a)){var t=Qne.exec(a);if(t)return!0;if(!isNaN(Date.parse(a)))return!0}return!1}function Tu(a,t,e,r){var n=!1;r===!0&&(n=t[e]===null&&a[e]!==void 0),n?delete a[e]:a[e]=t[e]}function dB(a,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;for(var r in a)if(t[r]!==void 0)if(t[r]===null||yt(t[r])!=="object")Tu(a,t,r,e);else{var n=a[r],s=t[r];LS(n)&&LS(s)&&dB(n,s,e)}}function sae(a,t){if(!Tt(a))throw new Error("Array with property names expected as first argument");for(var e=arguments.length,r=new Array(e>2?e-2:0),n=2;n<e;n++)r[n-2]=arguments[n];for(var s=0,o=r;s<o.length;s++)for(var l=o[s],c=0;c<a.length;c++){var u=a[c];l&&Object.prototype.hasOwnProperty.call(l,u)&&(t[u]=l[u])}return t}function oae(a,t,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(Tt(e))throw new TypeError("Arrays are not supported by deepExtend");for(var n=0;n<a.length;n++){var s=a[n];if(Object.prototype.hasOwnProperty.call(e,s))if(e[s]&&e[s].constructor===Object)t[s]===void 0&&(t[s]={}),t[s].constructor===Object?Jm(t[s],e[s],!1,r):Tu(t,e,s,r);else{if(Tt(e[s]))throw new TypeError("Arrays are not supported by deepExtend");Tu(t,e,s,r)}}return t}function lae(a,t,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(Tt(e))throw new TypeError("Arrays are not supported by deepExtend");for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!Kl(a).call(a,n))if(e[n]&&e[n].constructor===Object)t[n]===void 0&&(t[n]={}),t[n].constructor===Object?Jm(t[n],e[n]):Tu(t,e,n,r);else if(Tt(e[n])){t[n]=[];for(var s=0;s<e[n].length;s++)t[n].push(e[n][s])}else Tu(t,e,n,r);return t}function Jm(a,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)||e===!0)if(yt(t[n])==="object"&&t[n]!==null&&mO(t[n])===Object.prototype)a[n]===void 0?a[n]=Jm({},t[n],e):yt(a[n])==="object"&&a[n]!==null&&mO(a[n])===Object.prototype?Jm(a[n],t[n],e):Tu(a,t,n,r);else if(Tt(t[n])){var s;a[n]=En(s=t[n]).call(s)}else Tu(a,t,n,r);return a}function cae(a,t){if(a.length!==t.length)return!1;for(var e=0,r=a.length;e<r;e++)if(a[e]!=t[e])return!1;return!0}function Rm(a){var t=yt(a);return t==="object"?a===null?"null":a instanceof Boolean?"Boolean":a instanceof Number?"Number":a instanceof String?"String":Tt(a)?"Array":a instanceof Date?"Date":"Object":t==="number"?"Number":t==="boolean"?"Boolean":t==="string"?"String":t===void 0?"undefined":t}function Qm(a,t){var e;return Ir(e=[]).call(e,Ur(a),[t])}function hB(a){return En(a).call(a)}function uae(a){return a.getBoundingClientRect().left}function dae(a){return a.getBoundingClientRect().right}function hae(a){return a.getBoundingClientRect().top}function fae(a,t){var e=a.className.split(" "),r=t.split(" ");e=Ir(e).call(e,lt(r).call(r,function(n){return!Kl(e).call(e,n)})),a.className=e.join(" ")}function pae(a,t){var e=a.className.split(" "),r=t.split(" ");e=lt(e).call(e,function(n){return!Kl(r).call(r,n)}),a.className=e.join(" ")}function mae(a,t){if(Tt(a))for(var e=a.length,r=0;r<e;r++)t(a[r],r,a);else for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t(a[n],n,a)}function vae(a,t,e){return a[t]!==e?(a[t]=e,!0):!1}function yae(a){var t=!1;return function(){t||(t=!0,requestAnimationFrame(function(){t=!1,a()}))}}function bae(a,t,e,r){if(a.addEventListener){var n;r===void 0&&(r=!1),t==="mousewheel"&&Kl(n=navigator.userAgent).call(n,"Firefox")&&(t="DOMMouseScroll"),a.addEventListener(t,e,r)}else a.attachEvent("on"+t,e)}function wae(a,t,e,r){if(a.removeEventListener){var n;r===void 0&&(r=!1),t==="mousewheel"&&Kl(n=navigator.userAgent).call(n,"Firefox")&&(t="DOMMouseScroll"),a.removeEventListener(t,e,r)}else a.detachEvent("on"+t,e)}function Eae(a){a||(a=window.event),a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}function Tae(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event,t=null;return a&&(a.target?t=a.target:a.srcElement&&(t=a.srcElement)),!(t instanceof Element)||t.nodeType!=null&&t.nodeType==3&&(t=t.parentNode,!(t instanceof Element))?null:t}function Cae(a,t){for(var e=a;e;){if(e===t)return!0;if(e.parentNode)e=e.parentNode;else return!1}return!1}function w0(a){var t;switch(a.length){case 3:case 4:return t=tae.exec(a),t?{r:La(t[1]+t[1],16),g:La(t[2]+t[2],16),b:La(t[3]+t[3],16)}:null;case 6:case 7:return t=eae.exec(a),t?{r:La(t[1],16),g:La(t[2],16),b:La(t[3],16)}:null;default:return null}}function Sae(a,t){if(Kl(a).call(a,"rgba"))return a;if(Kl(a).call(a,"rgb")){var e=a.substr(Er(a).call(a,"(")+1).replace(")","").split(",");return"rgba("+e[0]+","+e[1]+","+e[2]+","+t+")"}else{var r=w0(a);return r==null?a:"rgba("+r.r+","+r.g+","+r.b+","+t+")"}}function Gx(a,t,e){var r;return"#"+En(r=((1<<24)+(a<<16)+(t<<8)+e).toString(16)).call(r,1)}function xae(a,t){if(Ma(a)){var e=a;if(Wx(e)){var r,n=sr(r=e.substr(4).substr(0,e.length-5).split(",")).call(r,function(f){return La(f)});e=Gx(n[0],n[1],n[2])}if(Vx(e)===!0){var s=fB(e),o={h:s.h,s:s.s*.8,v:Math.min(1,s.v*1.02)},l={h:s.h,s:Math.min(1,s.s*1.25),v:s.v*.8},c=MS(l.h,l.s,l.v),u=MS(o.h,o.s,o.v);return{background:e,border:c,highlight:{background:u,border:c},hover:{background:u,border:c}}}else return{background:e,border:e,highlight:{background:e,border:e},hover:{background:e,border:e}}}else if(t){var d={background:a.background||t.background,border:a.border||t.border,highlight:Ma(a.highlight)?{border:a.highlight,background:a.highlight}:{background:a.highlight&&a.highlight.background||t.highlight.background,border:a.highlight&&a.highlight.border||t.highlight.border},hover:Ma(a.hover)?{border:a.hover,background:a.hover}:{border:a.hover&&a.hover.border||t.hover.border,background:a.hover&&a.hover.background||t.hover.background}};return d}else{var h={background:a.background||void 0,border:a.border||void 0,highlight:Ma(a.highlight)?{border:a.highlight,background:a.highlight}:{background:a.highlight&&a.highlight.background||void 0,border:a.highlight&&a.highlight.border||void 0},hover:Ma(a.hover)?{border:a.hover,background:a.hover}:{border:a.hover&&a.hover.border||void 0,background:a.hover&&a.hover.background||void 0}};return h}}function Sh(a,t,e){a=a/255,t=t/255,e=e/255;var r=Math.min(a,Math.min(t,e)),n=Math.max(a,Math.max(t,e));if(r===n)return{h:0,s:0,v:r};var s=a===r?t-e:e===r?a-t:e-a,o=a===r?3:e===r?1:5,l=60*(o-s/(n-r))/360,c=(n-r)/n,u=n;return{h:l,s:c,v:u}}function kae(a,t){var e=kh.split(a.style.cssText),r=kh.split(t),n=GO(GO({},e),r);a.style.cssText=kh.join(n)}function Dae(a,t){var e=kh.split(a.style.cssText),r=kh.split(t);for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&delete e[n];a.style.cssText=kh.join(e)}function Hm(a,t,e){var r,n,s,o=Math.floor(a*6),l=a*6-o,c=e*(1-t),u=e*(1-l*t),d=e*(1-(1-l)*t);switch(o%6){case 0:r=e,n=d,s=c;break;case 1:r=u,n=e,s=c;break;case 2:r=c,n=e,s=d;break;case 3:r=c,n=u,s=e;break;case 4:r=d,n=c,s=e;break;case 5:r=e,n=c,s=u;break}return{r:Math.floor(r*255),g:Math.floor(n*255),b:Math.floor(s*255)}}function MS(a,t,e){var r=Hm(a,t,e);return Gx(r.r,r.g,r.b)}function fB(a){var t=w0(a);if(!t)throw new TypeError("'".concat(a,"' is not a valid color."));return Sh(t.r,t.g,t.b)}function Vx(a){var t=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a);return t}function Wx(a){return rae.test(a)}function pB(a){return iae.test(a)}function Pae(a,t){if(t!==null&&yt(t)==="object"){for(var e=Cg(t),r=0;r<a.length;r++)Object.prototype.hasOwnProperty.call(t,a[r])&&yt(t[a[r]])=="object"&&(e[a[r]]=Ux(t[a[r]]));return e}else return null}function Ux(a){if(a===null||yt(a)!=="object")return null;if(a instanceof Element)return a;var t=Cg(a);for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&yt(a[e])=="object"&&(t[e]=Ux(a[e]));return t}function Lae(a,t){for(var e=0;e<a.length;e++){var r=a[e],n=void 0;for(n=e;n>0&&t(r,a[n-1])<0;n--)a[n]=a[n-1];a[n]=r}return a}function Mae(a,t,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},n=function(g){return g!=null},s=function(g){return g!==null&&yt(g)==="object"},o=function(g){for(var y in g)if(Object.prototype.hasOwnProperty.call(g,y))return!1;return!0};if(!s(a))throw new Error("Parameter mergeTarget must be an object");if(!s(t))throw new Error("Parameter options must be an object");if(!n(e))throw new Error("Parameter option must have a value");if(!s(r))throw new Error("Parameter globalOptions must be an object");var l=function(g,y,v){s(g[v])||(g[v]={});var E=y[v],C=g[v];for(var _ in E)Object.prototype.hasOwnProperty.call(E,_)&&(C[_]=E[_])},c=t[e],u=s(r)&&!o(r),d=u?r[e]:void 0,h=d?d.enabled:void 0;if(c!==void 0){if(typeof c=="boolean"){s(a[e])||(a[e]={}),a[e].enabled=c;return}if(c===null&&!s(a[e]))if(n(d))a[e]=Cg(d);else return;if(s(c)){var f=!0;c.enabled!==void 0?f=c.enabled:h!==void 0&&(f=d.enabled),l(a,t,e),a[e].enabled=f}}}function Iae(a,t,e,r){for(var n=1e4,s=0,o=0,l=a.length-1;o<=l&&s<n;){var c=Math.floor((o+l)/2),u=a[c],d=r===void 0?u[e]:u[e][r],h=t(d);if(h==0)return c;h==-1?o=c+1:l=c-1,s++}return-1}function Aae(a,t,e,r,n){var s=1e4,o=0,l=0,c=a.length-1,u,d,h,f;for(n=n!=null?n:function(m,g){return m==g?0:m<g?-1:1};l<=c&&o<s;){if(f=Math.floor(.5*(c+l)),u=a[Math.max(0,f-1)][e],d=a[f][e],h=a[Math.min(a.length-1,f+1)][e],n(d,t)==0)return f;if(n(u,t)<0&&n(d,t)>0)return r=="before"?Math.max(0,f-1):f;if(n(d,t)<0&&n(h,t)>0)return r=="before"?f:Math.min(a.length-1,f+1);n(d,t)<0?l=f+1:c=f-1,o++}return-1}function Fae(){var a=document.createElement("p");a.style.width="100%",a.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(a),document.body.appendChild(t);var e=a.offsetWidth;t.style.overflow="scroll";var r=a.offsetWidth;return e==r&&(r=t.clientWidth),document.body.removeChild(t),e-r}function Rae(a,t){var e;Tt(t)||(t=[t]);var r=Bx(a),n;try{for(r.s();!(n=r.n()).done;){var s=n.value;if(s){e=s[t[0]];for(var o=1;o<t.length;o++)e&&(e=e[t[o]]);if(typeof e!="undefined")break}}}catch(l){r.e(l)}finally{r.f()}return e}function IS(){for(var a=arguments.length,t=new Array(a),e=0;e<a;e++)t[e]=arguments[e];if(t.length<1)throw new TypeError("Invalid arguments.");if(t.length===1)return document.createTextNode(t[0]);var r=document.createElement(t[0]);return r.appendChild(IS.apply(void 0,Ur(En(t).call(t,1)))),r}function Fo(a){for(var t in a)a.hasOwnProperty(t)&&(a[t].redundant=a[t].used,a[t].used=[])}function Da(a){for(var t in a)if(a.hasOwnProperty(t)&&a[t].redundant){for(var e=0;e<a[t].redundant.length;e++)a[t].redundant[e].parentNode.removeChild(a[t].redundant[e]);a[t].redundant=[]}}function vB(a){Fo(a),Da(a),Fo(a)}function ns(a,t,e){var r;return t.hasOwnProperty(a)?t[a].redundant.length>0?(r=t[a].redundant[0],t[a].redundant.shift()):(r=document.createElementNS("http://www.w3.org/2000/svg",a),e.appendChild(r)):(r=document.createElementNS("http://www.w3.org/2000/svg",a),t[a]={used:[],redundant:[]},e.appendChild(r)),t[a].used.push(r),r}function Sb(a,t,e,r){var n;return t.hasOwnProperty(a)?t[a].redundant.length>0?(n=t[a].redundant[0],t[a].redundant.shift()):(n=document.createElement(a),r!==void 0?e.insertBefore(n,r):e.appendChild(n)):(n=document.createElement(a),t[a]={used:[],redundant:[]},r!==void 0?e.insertBefore(n,r):e.appendChild(n)),t[a].used.push(n),n}function Cu(a,t,e,r,n,s){var o;if(e.style=="circle"?(o=ns("circle",r,n),o.setAttributeNS(null,"cx",a),o.setAttributeNS(null,"cy",t),o.setAttributeNS(null,"r",.5*e.size)):(o=ns("rect",r,n),o.setAttributeNS(null,"x",a-.5*e.size),o.setAttributeNS(null,"y",t-.5*e.size),o.setAttributeNS(null,"width",e.size),o.setAttributeNS(null,"height",e.size)),e.styles!==void 0&&o.setAttributeNS(null,"style",e.styles),o.setAttributeNS(null,"class",e.className+" vis-point"),s){var l=ns("text",r,n);s.xOffset&&(a=a+s.xOffset),s.yOffset&&(t=t+s.yOffset),s.content&&(l.textContent=s.content),s.className&&l.setAttributeNS(null,"class",s.className+" vis-label"),l.setAttributeNS(null,"x",a),l.setAttributeNS(null,"y",t)}return o}function zb(a,t,e,r,n,s,o,l){if(r!=0){r<0&&(r*=-1,t-=r);var c=ns("rect",s,o);c.setAttributeNS(null,"x",a-.5*e),c.setAttributeNS(null,"y",t),c.setAttributeNS(null,"width",e),c.setAttributeNS(null,"height",r),c.setAttributeNS(null,"class",n),l&&c.setAttributeNS(null,"style",l)}}function yB(){try{return navigator?navigator.languages&&navigator.languages.length?navigator.languages:navigator.userLanguage||navigator.language||navigator.browserLanguage||"en":"en"}catch(a){return"en"}}function wr(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function FS(a,t){var e;return FS=OS?SB(e=OS).call(e):function(n,s){return n.__proto__=s,n},FS(a,t)}function Hn(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=pse(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),m0(a,"prototype",{writable:!1}),t&&FS(a,t)}function ca(a,t){if(t&&(yt(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wr(a)}function or(a){var t;return or=OS?SB(t=qO).call(t):function(r){return r.__proto__||qO(r)},or(a)}function Rhe(){if(!HF)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return HF(Fhe)}function w$(a,t){var e=t||0,r=b$;return[r[a[e++]],r[a[e++]],r[a[e++]],r[a[e++]],"-",r[a[e++]],r[a[e++]],"-",r[a[e++]],r[a[e++]],"-",r[a[e++]],r[a[e++]],"-",r[a[e++]],r[a[e++]],r[a[e++]],r[a[e++]],r[a[e++]],r[a[e++]]].join("")}function Nhe(a){var t=[];return a.replace(/[a-fA-F0-9]{2}/g,function(e){t.push(parseInt(e,16))}),t}function Bhe(a){a=unescape(encodeURIComponent(a));for(var t=new Array(a.length),e=0;e<a.length;e++)t[e]=a.charCodeAt(e);return t}function E$(a,t,e){var r=function(s,o,l,c){var u=l&&c||0;if(typeof s=="string"&&(s=Bhe(s)),typeof o=="string"&&(o=Nhe(o)),!Array.isArray(s))throw TypeError("value must be an array of bytes");if(!Array.isArray(o)||o.length!==16)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var d=e(o.concat(s));if(d[6]=d[6]&15|t,d[8]=d[8]&63|128,l)for(var h=0;h<16;++h)l[u+h]=d[h];return l||w$(d)};try{r.name=a}catch(n){}return r.DNS=$he,r.URL=zhe,r}function Hhe(a){if(typeof a=="string"){var t=unescape(encodeURIComponent(a));a=new Array(t.length);for(var e=0;e<t.length;e++)a[e]=t.charCodeAt(e)}return Ghe(Vhe(Whe(a),a.length*8))}function Ghe(a){var t,e,r=[],n=a.length*32,s="0123456789abcdef",o;for(t=0;t<n;t+=8)e=a[t>>5]>>>t%32&255,o=parseInt(s.charAt(e>>>4&15)+s.charAt(e&15),16),r.push(o);return r}function Vhe(a,t){a[t>>5]|=128<<t%32,a[(t+64>>>9<<4)+14]=t;var e,r,n,s,o,l=1732584193,c=-271733879,u=-1732584194,d=271733878;for(e=0;e<a.length;e+=16)r=l,n=c,s=u,o=d,l=pn(l,c,u,d,a[e],7,-680876936),d=pn(d,l,c,u,a[e+1],12,-389564586),u=pn(u,d,l,c,a[e+2],17,606105819),c=pn(c,u,d,l,a[e+3],22,-1044525330),l=pn(l,c,u,d,a[e+4],7,-176418897),d=pn(d,l,c,u,a[e+5],12,1200080426),u=pn(u,d,l,c,a[e+6],17,-1473231341),c=pn(c,u,d,l,a[e+7],22,-45705983),l=pn(l,c,u,d,a[e+8],7,1770035416),d=pn(d,l,c,u,a[e+9],12,-1958414417),u=pn(u,d,l,c,a[e+10],17,-42063),c=pn(c,u,d,l,a[e+11],22,-1990404162),l=pn(l,c,u,d,a[e+12],7,1804603682),d=pn(d,l,c,u,a[e+13],12,-40341101),u=pn(u,d,l,c,a[e+14],17,-1502002290),c=pn(c,u,d,l,a[e+15],22,1236535329),l=mn(l,c,u,d,a[e+1],5,-165796510),d=mn(d,l,c,u,a[e+6],9,-1069501632),u=mn(u,d,l,c,a[e+11],14,643717713),c=mn(c,u,d,l,a[e],20,-373897302),l=mn(l,c,u,d,a[e+5],5,-701558691),d=mn(d,l,c,u,a[e+10],9,38016083),u=mn(u,d,l,c,a[e+15],14,-660478335),c=mn(c,u,d,l,a[e+4],20,-405537848),l=mn(l,c,u,d,a[e+9],5,568446438),d=mn(d,l,c,u,a[e+14],9,-1019803690),u=mn(u,d,l,c,a[e+3],14,-187363961),c=mn(c,u,d,l,a[e+8],20,1163531501),l=mn(l,c,u,d,a[e+13],5,-1444681467),d=mn(d,l,c,u,a[e+2],9,-51403784),u=mn(u,d,l,c,a[e+7],14,1735328473),c=mn(c,u,d,l,a[e+12],20,-1926607734),l=gn(l,c,u,d,a[e+5],4,-378558),d=gn(d,l,c,u,a[e+8],11,-2022574463),u=gn(u,d,l,c,a[e+11],16,1839030562),c=gn(c,u,d,l,a[e+14],23,-35309556),l=gn(l,c,u,d,a[e+1],4,-1530992060),d=gn(d,l,c,u,a[e+4],11,1272893353),u=gn(u,d,l,c,a[e+7],16,-155497632),c=gn(c,u,d,l,a[e+10],23,-1094730640),l=gn(l,c,u,d,a[e+13],4,681279174),d=gn(d,l,c,u,a[e],11,-358537222),u=gn(u,d,l,c,a[e+3],16,-722521979),c=gn(c,u,d,l,a[e+6],23,76029189),l=gn(l,c,u,d,a[e+9],4,-640364487),d=gn(d,l,c,u,a[e+12],11,-421815835),u=gn(u,d,l,c,a[e+15],16,530742520),c=gn(c,u,d,l,a[e+2],23,-995338651),l=vn(l,c,u,d,a[e],6,-198630844),d=vn(d,l,c,u,a[e+7],10,1126891415),u=vn(u,d,l,c,a[e+14],15,-1416354905),c=vn(c,u,d,l,a[e+5],21,-57434055),l=vn(l,c,u,d,a[e+12],6,1700485571),d=vn(d,l,c,u,a[e+3],10,-1894986606),u=vn(u,d,l,c,a[e+10],15,-1051523),c=vn(c,u,d,l,a[e+1],21,-2054922799),l=vn(l,c,u,d,a[e+8],6,1873313359),d=vn(d,l,c,u,a[e+15],10,-30611744),u=vn(u,d,l,c,a[e+6],15,-1560198380),c=vn(c,u,d,l,a[e+13],21,1309151649),l=vn(l,c,u,d,a[e+4],6,-145523070),d=vn(d,l,c,u,a[e+11],10,-1120210379),u=vn(u,d,l,c,a[e+2],15,718787259),c=vn(c,u,d,l,a[e+9],21,-343485551),l=Yl(l,r),c=Yl(c,n),u=Yl(u,s),d=Yl(d,o);return[l,c,u,d]}function Whe(a){var t,e=[];for(e[(a.length>>2)-1]=void 0,t=0;t<e.length;t+=1)e[t]=0;var r=a.length*8;for(t=0;t<r;t+=8)e[t>>5]|=(a[t/8]&255)<<t%32;return e}function Yl(a,t){var e=(a&65535)+(t&65535),r=(a>>16)+(t>>16)+(e>>16);return r<<16|e&65535}function Uhe(a,t){return a<<t|a>>>32-t}function x0(a,t,e,r,n,s){return Yl(Uhe(Yl(Yl(t,a),Yl(r,s)),n),e)}function pn(a,t,e,r,n,s,o){return x0(t&e|~t&r,a,t,n,s,o)}function mn(a,t,e,r,n,s,o){return x0(t&r|e&~r,a,t,n,s,o)}function gn(a,t,e,r,n,s,o){return x0(t^e^r,a,t,n,s,o)}function vn(a,t,e,r,n,s,o){return x0(e^(t|~r),a,t,n,s,o)}function gu(a,t,e){var r=t&&e||0;typeof a=="string"&&(t=a==="binary"?new Array(16):null,a=null),a=a||{};var n=a.random||(a.rng||Rhe)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t)for(var s=0;s<16;++s)t[r+s]=n[s];return t||w$(n)}function jhe(a,t,e,r){switch(a){case 0:return t&e^~t&r;case 1:return t^e^r;case 2:return t&e^t&r^e&r;case 3:return t^e^r}}function J_(a,t){return a<<t|a>>>32-t}function Yhe(a){var t=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof a=="string"){var r=unescape(encodeURIComponent(a));a=new Array(r.length);for(var n=0;n<r.length;n++)a[n]=r.charCodeAt(n)}a.push(128);for(var s=a.length/4+2,o=Math.ceil(s/16),l=new Array(o),n=0;n<o;n++){l[n]=new Array(16);for(var c=0;c<16;c++)l[n][c]=a[n*64+c*4]<<24|a[n*64+c*4+1]<<16|a[n*64+c*4+2]<<8|a[n*64+c*4+3]}l[o-1][14]=(a.length-1)*8/Math.pow(2,32),l[o-1][14]=Math.floor(l[o-1][14]),l[o-1][15]=(a.length-1)*8&4294967295;for(var n=0;n<o;n++){for(var u=new Array(80),d=0;d<16;d++)u[d]=l[n][d];for(var d=16;d<80;d++)u[d]=J_(u[d-3]^u[d-8]^u[d-14]^u[d-16],1);for(var h=e[0],f=e[1],m=e[2],g=e[3],y=e[4],d=0;d<80;d++){var v=Math.floor(d/20),E=J_(h,5)+jhe(v,f,m,g)+y+t[v]+u[d]>>>0;y=g,g=m,m=J_(f,30)>>>0,f=h,h=E}e[0]=e[0]+h>>>0,e[1]=e[1]+f>>>0,e[2]=e[2]+m>>>0,e[3]=e[3]+g>>>0,e[4]=e[4]+y>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,e[0]&255,e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,e[1]&255,e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,e[2]&255,e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,e[3]&255,e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,e[4]&255]}function GF(a,t){var e=bi(a);if(Mh){var r=Mh(a);t&&(r=lt(r).call(r,function(n){return jh(a,n).enumerable})),e.push.apply(e,r)}return e}function VF(a){for(var t=1;t<arguments.length;t++){var e,r,n=arguments[t]!=null?arguments[t]:{};t%2?Ue(e=GF(Object(n),!0)).call(e,function(s){Ht(a,s,n[s])}):Ih?Cx(a,Ih(n)):Ue(r=GF(Object(n))).call(r,function(s){Eg(a,s,jh(n,s))})}return a}function C$(a){var t=qhe();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function qhe(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function ra(a,t){var e=typeof qo!="undefined"&&oo(a)||a["@@iterator"];if(!e){if(Tt(a)||(e=Zhe(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return s=u.done,u},e:function(u){o=!0,l=u},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function Zhe(a,t){var e;if(a){if(typeof a=="string")return WF(a,t);var r=En(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return rc(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WF(a,t)}}function WF(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Khe(a){return new Jhe(a)}function WS(a){return typeof a=="string"||typeof a=="number"}function Qhe(a,t){return a[t]==null&&(a[t]=gu()),a}function efe(a,t){return yt(t)==="object"&&t!==null&&a===t.idProp&&typeof t.add=="function"&&typeof t.clear=="function"&&typeof t.distinct=="function"&&typeof Ue(t)=="function"&&typeof t.get=="function"&&typeof t.getDataSet=="function"&&typeof t.getIds=="function"&&typeof t.length=="number"&&typeof sr(t)=="function"&&typeof t.max=="function"&&typeof t.min=="function"&&typeof t.off=="function"&&typeof t.on=="function"&&typeof t.remove=="function"&&typeof t.setOptions=="function"&&typeof t.stream=="function"&&typeof t.update=="function"&&typeof t.updateOnly=="function"}function tfe(a,t){return yt(t)==="object"&&t!==null&&a===t.idProp&&typeof Ue(t)=="function"&&typeof t.get=="function"&&typeof t.getDataSet=="function"&&typeof t.getIds=="function"&&typeof t.length=="number"&&typeof sr(t)=="function"&&typeof t.off=="function"&&typeof t.on=="function"&&typeof t.stream=="function"&&efe(a,t.getDataSet())}function k$(){var a={};return a["align-content"]=!1,a["align-items"]=!1,a["align-self"]=!1,a["alignment-adjust"]=!1,a["alignment-baseline"]=!1,a.all=!1,a["anchor-point"]=!1,a.animation=!1,a["animation-delay"]=!1,a["animation-direction"]=!1,a["animation-duration"]=!1,a["animation-fill-mode"]=!1,a["animation-iteration-count"]=!1,a["animation-name"]=!1,a["animation-play-state"]=!1,a["animation-timing-function"]=!1,a.azimuth=!1,a["backface-visibility"]=!1,a.background=!0,a["background-attachment"]=!0,a["background-clip"]=!0,a["background-color"]=!0,a["background-image"]=!0,a["background-origin"]=!0,a["background-position"]=!0,a["background-repeat"]=!0,a["background-size"]=!0,a["baseline-shift"]=!1,a.binding=!1,a.bleed=!1,a["bookmark-label"]=!1,a["bookmark-level"]=!1,a["bookmark-state"]=!1,a.border=!0,a["border-bottom"]=!0,a["border-bottom-color"]=!0,a["border-bottom-left-radius"]=!0,a["border-bottom-right-radius"]=!0,a["border-bottom-style"]=!0,a["border-bottom-width"]=!0,a["border-collapse"]=!0,a["border-color"]=!0,a["border-image"]=!0,a["border-image-outset"]=!0,a["border-image-repeat"]=!0,a["border-image-slice"]=!0,a["border-image-source"]=!0,a["border-image-width"]=!0,a["border-left"]=!0,a["border-left-color"]=!0,a["border-left-style"]=!0,a["border-left-width"]=!0,a["border-radius"]=!0,a["border-right"]=!0,a["border-right-color"]=!0,a["border-right-style"]=!0,a["border-right-width"]=!0,a["border-spacing"]=!0,a["border-style"]=!0,a["border-top"]=!0,a["border-top-color"]=!0,a["border-top-left-radius"]=!0,a["border-top-right-radius"]=!0,a["border-top-style"]=!0,a["border-top-width"]=!0,a["border-width"]=!0,a.bottom=!1,a["box-decoration-break"]=!0,a["box-shadow"]=!0,a["box-sizing"]=!0,a["box-snap"]=!0,a["box-suppress"]=!0,a["break-after"]=!0,a["break-before"]=!0,a["break-inside"]=!0,a["caption-side"]=!1,a.chains=!1,a.clear=!0,a.clip=!1,a["clip-path"]=!1,a["clip-rule"]=!1,a.color=!0,a["color-interpolation-filters"]=!0,a["column-count"]=!1,a["column-fill"]=!1,a["column-gap"]=!1,a["column-rule"]=!1,a["column-rule-color"]=!1,a["column-rule-style"]=!1,a["column-rule-width"]=!1,a["column-span"]=!1,a["column-width"]=!1,a.columns=!1,a.contain=!1,a.content=!1,a["counter-increment"]=!1,a["counter-reset"]=!1,a["counter-set"]=!1,a.crop=!1,a.cue=!1,a["cue-after"]=!1,a["cue-before"]=!1,a.cursor=!1,a.direction=!1,a.display=!0,a["display-inside"]=!0,a["display-list"]=!0,a["display-outside"]=!0,a["dominant-baseline"]=!1,a.elevation=!1,a["empty-cells"]=!1,a.filter=!1,a.flex=!1,a["flex-basis"]=!1,a["flex-direction"]=!1,a["flex-flow"]=!1,a["flex-grow"]=!1,a["flex-shrink"]=!1,a["flex-wrap"]=!1,a.float=!1,a["float-offset"]=!1,a["flood-color"]=!1,a["flood-opacity"]=!1,a["flow-from"]=!1,a["flow-into"]=!1,a.font=!0,a["font-family"]=!0,a["font-feature-settings"]=!0,a["font-kerning"]=!0,a["font-language-override"]=!0,a["font-size"]=!0,a["font-size-adjust"]=!0,a["font-stretch"]=!0,a["font-style"]=!0,a["font-synthesis"]=!0,a["font-variant"]=!0,a["font-variant-alternates"]=!0,a["font-variant-caps"]=!0,a["font-variant-east-asian"]=!0,a["font-variant-ligatures"]=!0,a["font-variant-numeric"]=!0,a["font-variant-position"]=!0,a["font-weight"]=!0,a.grid=!1,a["grid-area"]=!1,a["grid-auto-columns"]=!1,a["grid-auto-flow"]=!1,a["grid-auto-rows"]=!1,a["grid-column"]=!1,a["grid-column-end"]=!1,a["grid-column-start"]=!1,a["grid-row"]=!1,a["grid-row-end"]=!1,a["grid-row-start"]=!1,a["grid-template"]=!1,a["grid-template-areas"]=!1,a["grid-template-columns"]=!1,a["grid-template-rows"]=!1,a["hanging-punctuation"]=!1,a.height=!0,a.hyphens=!1,a.icon=!1,a["image-orientation"]=!1,a["image-resolution"]=!1,a["ime-mode"]=!1,a["initial-letters"]=!1,a["inline-box-align"]=!1,a["justify-content"]=!1,a["justify-items"]=!1,a["justify-self"]=!1,a.left=!1,a["letter-spacing"]=!0,a["lighting-color"]=!0,a["line-box-contain"]=!1,a["line-break"]=!1,a["line-grid"]=!1,a["line-height"]=!1,a["line-snap"]=!1,a["line-stacking"]=!1,a["line-stacking-ruby"]=!1,a["line-stacking-shift"]=!1,a["line-stacking-strategy"]=!1,a["list-style"]=!0,a["list-style-image"]=!0,a["list-style-position"]=!0,a["list-style-type"]=!0,a.margin=!0,a["margin-bottom"]=!0,a["margin-left"]=!0,a["margin-right"]=!0,a["margin-top"]=!0,a["marker-offset"]=!1,a["marker-side"]=!1,a.marks=!1,a.mask=!1,a["mask-box"]=!1,a["mask-box-outset"]=!1,a["mask-box-repeat"]=!1,a["mask-box-slice"]=!1,a["mask-box-source"]=!1,a["mask-box-width"]=!1,a["mask-clip"]=!1,a["mask-image"]=!1,a["mask-origin"]=!1,a["mask-position"]=!1,a["mask-repeat"]=!1,a["mask-size"]=!1,a["mask-source-type"]=!1,a["mask-type"]=!1,a["max-height"]=!0,a["max-lines"]=!1,a["max-width"]=!0,a["min-height"]=!0,a["min-width"]=!0,a["move-to"]=!1,a["nav-down"]=!1,a["nav-index"]=!1,a["nav-left"]=!1,a["nav-right"]=!1,a["nav-up"]=!1,a["object-fit"]=!1,a["object-position"]=!1,a.opacity=!1,a.order=!1,a.orphans=!1,a.outline=!1,a["outline-color"]=!1,a["outline-offset"]=!1,a["outline-style"]=!1,a["outline-width"]=!1,a.overflow=!1,a["overflow-wrap"]=!1,a["overflow-x"]=!1,a["overflow-y"]=!1,a.padding=!0,a["padding-bottom"]=!0,a["padding-left"]=!0,a["padding-right"]=!0,a["padding-top"]=!0,a.page=!1,a["page-break-after"]=!1,a["page-break-before"]=!1,a["page-break-inside"]=!1,a["page-policy"]=!1,a.pause=!1,a["pause-after"]=!1,a["pause-before"]=!1,a.perspective=!1,a["perspective-origin"]=!1,a.pitch=!1,a["pitch-range"]=!1,a["play-during"]=!1,a.position=!1,a["presentation-level"]=!1,a.quotes=!1,a["region-fragment"]=!1,a.resize=!1,a.rest=!1,a["rest-after"]=!1,a["rest-before"]=!1,a.richness=!1,a.right=!1,a.rotation=!1,a["rotation-point"]=!1,a["ruby-align"]=!1,a["ruby-merge"]=!1,a["ruby-position"]=!1,a["shape-image-threshold"]=!1,a["shape-outside"]=!1,a["shape-margin"]=!1,a.size=!1,a.speak=!1,a["speak-as"]=!1,a["speak-header"]=!1,a["speak-numeral"]=!1,a["speak-punctuation"]=!1,a["speech-rate"]=!1,a.stress=!1,a["string-set"]=!1,a["tab-size"]=!1,a["table-layout"]=!1,a["text-align"]=!0,a["text-align-last"]=!0,a["text-combine-upright"]=!0,a["text-decoration"]=!0,a["text-decoration-color"]=!0,a["text-decoration-line"]=!0,a["text-decoration-skip"]=!0,a["text-decoration-style"]=!0,a["text-emphasis"]=!0,a["text-emphasis-color"]=!0,a["text-emphasis-position"]=!0,a["text-emphasis-style"]=!0,a["text-height"]=!0,a["text-indent"]=!0,a["text-justify"]=!0,a["text-orientation"]=!0,a["text-overflow"]=!0,a["text-shadow"]=!0,a["text-space-collapse"]=!0,a["text-transform"]=!0,a["text-underline-position"]=!0,a["text-wrap"]=!0,a.top=!1,a.transform=!1,a["transform-origin"]=!1,a["transform-style"]=!1,a.transition=!1,a["transition-delay"]=!1,a["transition-duration"]=!1,a["transition-property"]=!1,a["transition-timing-function"]=!1,a["unicode-bidi"]=!1,a["vertical-align"]=!1,a.visibility=!1,a["voice-balance"]=!1,a["voice-duration"]=!1,a["voice-family"]=!1,a["voice-pitch"]=!1,a["voice-range"]=!1,a["voice-rate"]=!1,a["voice-stress"]=!1,a["voice-volume"]=!1,a.volume=!1,a["white-space"]=!1,a.widows=!1,a.width=!0,a["will-change"]=!1,a["word-break"]=!0,a["word-spacing"]=!0,a["word-wrap"]=!0,a["wrap-flow"]=!1,a["wrap-through"]=!1,a["writing-mode"]=!1,a["z-index"]=!1,a}function rfe(a,t,e){}function ife(a,t,e){}function afe(a,t){return nfe.test(t)?"":t}function ofe(a,t){a=Om.trimRight(a),a[a.length-1]!==";"&&(a+=";");var e=a.length,r=!1,n=0,s=0,o="";function l(){if(!r){var d=Om.trim(a.slice(n,s)),h=d.indexOf(":");if(h!==-1){var f=Om.trim(d.slice(0,h)),m=Om.trim(d.slice(h+1));if(f){var g=t(n,o.length,f,m,d);g&&(o+=g+"; ")}}}n=s+1}for(;s<e;s++){var c=a[s];if(c==="/"&&a[s+1]==="*"){var u=a.indexOf("*/",s+2);if(u===-1)break;s=u+1,n=s+1,r=!1}else c==="("?r=!0:c===")"?r=!1:c===";"?r||l():c===`
`&&l()}return Om.trim(o)}function jF(a){return a==null}function ufe(a){var t={};for(var e in a)t[e]=a[e];return t}function D$(a){a=ufe(a||{}),a.whiteList=a.whiteList||vb.whiteList,a.onAttr=a.onAttr||vb.onAttr,a.onIgnoreAttr=a.onIgnoreAttr||vb.onIgnoreAttr,a.safeAttrValue=a.safeAttrValue||vb.safeAttrValue,this.options=a}function P$(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}function pfe(a,t,e){}function mfe(a,t,e){}function gfe(a,t,e){}function vfe(a,t,e){}function M$(a){return a.replace(bfe,"&lt;").replace(wfe,"&gt;")}function yfe(a,t,e,r){if(e=N$(e),t==="href"||t==="src"){if(e=Ub.trim(e),e==="#")return"#";if(!(e.substr(0,7)==="http://"||e.substr(0,8)==="https://"||e.substr(0,7)==="mailto:"||e.substr(0,4)==="tel:"||e.substr(0,11)==="data:image/"||e.substr(0,6)==="ftp://"||e.substr(0,2)==="./"||e.substr(0,3)==="../"||e[0]==="#"||e[0]==="/"))return""}else if(t==="background"){if(yb.lastIndex=0,yb.test(e))return""}else if(t==="style"){if(YF.lastIndex=0,YF.test(e)||(qF.lastIndex=0,qF.test(e)&&(yb.lastIndex=0,yb.test(e))))return"";r!==!1&&(r=r||L$,e=r.process(e))}return e=B$(e),e}function I$(a){return a.replace(Efe,"&quot;")}function A$(a){return a.replace(Tfe,'"')}function O$(a){return a.replace(Cfe,function(e,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function F$(a){return a.replace(_fe,":").replace(Sfe," ")}function R$(a){for(var t="",e=0,r=a.length;e<r;e++)t+=a.charCodeAt(e)<32?" ":a.charAt(e);return Ub.trim(t)}function N$(a){return a=A$(a),a=O$(a),a=F$(a),a=R$(a),a}function B$(a){return a=I$(a),a=M$(a),a}function xfe(){return""}function kfe(a,t){typeof t!="function"&&(t=function(){});var e=!Array.isArray(a);function r(o){return e?!0:Ub.indexOf(a,o)!==-1}var n=[],s=!1;return{onIgnoreTag:function(o,l,c){if(r(o))if(c.isClosing){var u="[/removed]",d=c.position+u.length;return n.push([s!==!1?s:c.position,d]),s=!1,u}else return s||(s=c.position),"[removed]";else return t(o,l,c)},remove:function(o){var l="",c=0;return Ub.forEach(n,function(u){l+=o.slice(c,u[0]),c=u[1]}),l+=o.slice(c),l}}}function Dfe(a){for(var t="",e=0;e<a.length;){var r=a.indexOf("<!--",e);if(r===-1){t+=a.slice(e);break}t+=a.slice(e,r);var n=a.indexOf("-->",r);if(n===-1)break;e=n+3}return t}function Pfe(a){var t=a.split("");return t=t.filter(function(e){var r=e.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),t.join("")}function Lfe(a){var t=Gl.spaceIndex(a),e;return t===-1?e=a.slice(1,-1):e=a.slice(1,t+1),e=Gl.trim(e).toLowerCase(),e.slice(0,1)==="/"&&(e=e.slice(1)),e.slice(-1)==="/"&&(e=e.slice(0,-1)),e}function Mfe(a){return a.slice(0,2)==="</"}function Ife(a,t,e){var r="",n=0,s=!1,o=!1,l=0,c=a.length,u="",d="";e:for(l=0;l<c;l++){var h=a.charAt(l);if(s===!1){if(h==="<"){s=l;continue}}else if(o===!1){if(h==="<"){r+=e(a.slice(n,l)),s=l,n=l;continue}if(h===">"){r+=e(a.slice(n,s)),d=a.slice(s,l+1),u=Lfe(d),r+=t(s,r.length,u,d,Mfe(d)),n=l+1,s=!1;continue}if(h==='"'||h==="'")for(var f=1,m=a.charAt(l-f);m.trim()===""||m==="=";){if(m==="="){o=h;continue e}m=a.charAt(l-++f)}}else if(h===o){o=!1;continue}}return n<a.length&&(r+=e(a.substr(n))),r}function Ofe(a,t){var e=0,r=0,n=[],s=!1,o=a.length;function l(f,m){if(f=Gl.trim(f),f=f.replace(Afe,"").toLowerCase(),!(f.length<1)){var g=t(f,m||"");g&&n.push(g)}}for(var c=0;c<o;c++){var u=a.charAt(c),d,h;if(s===!1&&u==="="){s=a.slice(e,c),e=c+1,r=a.charAt(e)==='"'||a.charAt(e)==="'"?e:Rfe(a,c+1);continue}if(s!==!1&&c===r){if(h=a.indexOf(u,c+1),h===-1)break;d=Gl.trim(a.slice(r+1,h)),l(s,d),s=!1,c=h,e=c+1;continue}if(/\s|\n|\t/.test(u))if(a=a.replace(/\s|\n|\t/g," "),s===!1)if(h=Ffe(a,c),h===-1){d=Gl.trim(a.slice(e,c)),l(d),s=!1,e=c+1;continue}else{c=h-1;continue}else if(h=Nfe(a,c-1),h===-1){d=Gl.trim(a.slice(e,c)),d=ZF(d),l(s,d),s=!1,e=c+1;continue}else continue}return e<a.length&&(s===!1?l(a.slice(e)):l(s,ZF(Gl.trim(a.slice(e))))),Gl.trim(n.join(" "))}function Ffe(a,t){for(;t<a.length;t++){var e=a[t];if(e!==" ")return e==="="?t:-1}}function Rfe(a,t){for(;t<a.length;t++){var e=a[t];if(e!==" ")return e==="'"||e==='"'?t:-1}}function Nfe(a,t){for(;t>0;t--){var e=a[t];if(e!==" ")return e==="="?t:-1}}function Bfe(a){return a[0]==='"'&&a[a.length-1]==='"'||a[0]==="'"&&a[a.length-1]==="'"}function ZF(a){return Bfe(a)?a.substr(1,a.length-2):a}function bb(a){return a==null}function Gfe(a){var t=Lb.spaceIndex(a);if(t===-1)return{html:"",closing:a[a.length-2]==="/"};a=Lb.trim(a.slice(t+1,-1));var e=a[a.length-1]==="/";return e&&(a=Lb.trim(a.slice(0,-1))),{html:a,closing:e}}function Vfe(a){var t={};for(var e in a)t[e]=a[e];return t}function Wfe(a){var t={};for(var e in a)Array.isArray(a[e])?t[e.toLowerCase()]=a[e].map(function(r){return r.toLowerCase()}):t[e.toLowerCase()]=a[e];return t}function z$(a){a=Vfe(a||{}),a.stripIgnoreTag&&(a.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),a.onIgnoreTag=Ss.onIgnoreTagStripAll),a.whiteList||a.allowList?a.whiteList=Wfe(a.whiteList||a.allowList):a.whiteList=Ss.whiteList,a.onTag=a.onTag||Ss.onTag,a.onTagAttr=a.onTagAttr||Ss.onTagAttr,a.onIgnoreTag=a.onIgnoreTag||Ss.onIgnoreTag,a.onIgnoreTagAttr=a.onIgnoreTagAttr||Ss.onIgnoreTagAttr,a.safeAttrValue=a.safeAttrValue||Ss.safeAttrValue,a.escapeHtml=a.escapeHtml||Ss.escapeHtml,this.options=a,a.css===!1?this.cssFilter=!1:(a.css=a.css||{},this.cssFilter=new $fe(a.css))}function KF(a,t){var e=bi(a);if(Mh){var r=Mh(a);t&&(r=lt(r).call(r,function(n){return jh(a,n).enumerable})),e.push.apply(e,r)}return e}function XF(a){for(var t=1;t<arguments.length;t++){var e,r,n=arguments[t]!=null?arguments[t]:{};t%2?Ue(e=KF(Object(n),!0)).call(e,function(s){Ht(a,s,n[s])}):Ih?Cx(a,Ih(n)):Ue(r=KF(Object(n))).call(r,function(s){Eg(a,s,jh(n,s))})}return a}function Uo(a){var t;if(!a)return!1;var e=(t=a.idProp)!==null&&t!==void 0?t:a._idProp;return e?tfe(e,a):!1}function uk(a,t){var e;if(a!==void 0){if(a===null)return null;if(!t)return a;if(typeof t!="string"&&!(t instanceof String))throw new Error("Type must be a string");switch(t){case"boolean":case"Boolean":return!!a;case"number":case"Number":return Ma(a)&&!isNaN(Date.parse(a))?_s(a).valueOf():Number(a.valueOf());case"string":case"String":return String(a);case"Date":try{return uk(a,"Moment").toDate()}catch(n){throw n instanceof TypeError?new TypeError("Cannot convert object of type "+Rm(a)+" to type "+t):n}case"Moment":if(zm(a))return _s(a);if(a instanceof Date)return _s(a.valueOf());if(_s.isMoment(a))return _s(a);if(Ma(a))return e=Q_.exec(a),e?_s(Number(e[1])):(e=Yfe.exec(a),_s(e?Number(a):a));throw new TypeError("Cannot convert object of type "+Rm(a)+" to type "+t);case"ISODate":if(zm(a))return new Date(a);if(a instanceof Date)return a.toISOString();if(_s.isMoment(a))return a.toDate().toISOString();if(Ma(a))return e=Q_.exec(a),e?new Date(Number(e[1])).toISOString():_s(a).format();throw new Error("Cannot convert object of type "+Rm(a)+" to type ISODate");case"ASPDate":if(zm(a))return"/Date("+a+")/";if(a instanceof Date||_s.isMoment(a))return"/Date("+a.valueOf()+")/";if(Ma(a)){e=Q_.exec(a);var r;return e?r=new Date(Number(e[1])).valueOf():r=new Date(a).valueOf(),"/Date("+r+")/"}else throw new Error("Cannot convert object of type "+Rm(a)+" to type ASPDate");default:throw new Error("Unknown type ".concat(t))}}}function Nh(a){var t,e,r,n,s,o,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{start:"Date",end:"Date"},c=a._idProp,u=new Su({fieldId:c}),d=sr(t=Khe(a)).call(t,function(h){var f;return S0(f=bi(h)).call(f,function(m,g){return m[g]=uk(h[g],l[g]),m},{})}).to(u);return d.all().start(),{add:function(){var f;return(f=a.getDataSet()).add.apply(f,arguments)},remove:function(){var f;return(f=a.getDataSet()).remove.apply(f,arguments)},update:function(){var f;return(f=a.getDataSet()).update.apply(f,arguments)},updateOnly:function(){var f;return(f=a.getDataSet()).updateOnly.apply(f,arguments)},clear:function(){var f;return(f=a.getDataSet()).clear.apply(f,arguments)},forEach:Oe(e=Ue(u)).call(e,u),get:Oe(r=u.get).call(r,u),getIds:Oe(n=u.getIds).call(n,u),off:Oe(s=u.off).call(s,u),on:Oe(o=u.on).call(o,u),get length(){return u.length},idProp:c,type:l,rawDS:a,coercedDS:u,dispose:function(){return d.stop()}}}function D0(a,t,e){if(e&&!Tt(e))return D0(a,t,[e]);if(t.hiddenDates=[],e&&Tt(e)==!0){for(var r,n=0;n<e.length;n++)if(Eh(e[n])===void 0){var s={};s.start=a(e[n].start).toDate().valueOf(),s.end=a(e[n].end).toDate().valueOf(),t.hiddenDates.push(s)}ci(r=t.hiddenDates).call(r,function(o,l){return o.start-l.start})}}function ig(a,t,e){if(e&&!Tt(e))return ig(a,t,[e]);if(e&&t.domProps.centerContainer.width!==void 0){D0(a,t,e);for(var r=a(t.range.start),n=a(t.range.end),s=t.range.end-t.range.start,o=s/t.domProps.centerContainer.width,l=0;l<e.length;l++)if(Eh(e[l])!==void 0){var c=a(e[l].start),u=a(e[l].end);if(c._d=="Invalid Date")throw new Error("Supplied start date is not valid: ".concat(e[l].start));if(u._d=="Invalid Date")throw new Error("Supplied end date is not valid: ".concat(e[l].end));var d=u-c;if(d>=4*o){var h=0,f=n.clone();switch(Eh(e[l])){case"daily":c.day()!=u.day()&&(h=1),c.dayOfYear(r.dayOfYear()),c.year(r.year()),c.subtract(7,"days"),u.dayOfYear(r.dayOfYear()),u.year(r.year()),u.subtract(7-h,"days"),f.add(1,"weeks");break;case"weekly":{var m=u.diff(c,"days"),g=c.day();c.date(r.date()),c.month(r.month()),c.year(r.year()),u=c.clone(),c.day(g),u.day(g),u.add(m,"days"),c.subtract(1,"weeks"),u.subtract(1,"weeks"),f.add(1,"weeks");break}case"monthly":c.month()!=u.month()&&(h=1),c.month(r.month()),c.year(r.year()),c.subtract(1,"months"),u.month(r.month()),u.year(r.year()),u.subtract(1,"months"),u.add(h,"months"),f.add(1,"months");break;case"yearly":c.year()!=u.year()&&(h=1),c.year(r.year()),c.subtract(1,"years"),u.year(r.year()),u.subtract(1,"years"),u.add(h,"years"),f.add(1,"years");break;default:console.log("Wrong repeat format, allowed are: daily, weekly, monthly, yearly. Given:",Eh(e[l]));return}for(;c<f;)switch(t.hiddenDates.push({start:c.valueOf(),end:u.valueOf()}),Eh(e[l])){case"daily":c.add(1,"days"),u.add(1,"days");break;case"weekly":c.add(1,"weeks"),u.add(1,"weeks");break;case"monthly":c.add(1,"months"),u.add(1,"months");break;case"yearly":c.add(1,"y"),u.add(1,"y");break;default:console.log("Wrong repeat format, allowed are: daily, weekly, monthly, yearly. Given:",Eh(e[l]));return}t.hiddenDates.push({start:c.valueOf(),end:u.valueOf()})}}U$(t);var y=ag(t.range.start,t.hiddenDates),v=ag(t.range.end,t.hiddenDates),E=t.range.start,C=t.range.end;y.hidden==!0&&(E=t.range.startToFront==!0?y.startDate-1:y.endDate+1),v.hidden==!0&&(C=t.range.endToFront==!0?v.startDate-1:v.endDate+1),(y.hidden==!0||v.hidden==!0)&&t.range._applyRange(E,C)}}function U$(a){for(var t,e=a.hiddenDates,r=[],n=0;n<e.length;n++)for(var s=0;s<e.length;s++)n!=s&&e[s].remove!=!0&&e[n].remove!=!0&&(e[s].start>=e[n].start&&e[s].end<=e[n].end?e[s].remove=!0:e[s].start>=e[n].start&&e[s].start<=e[n].end?(e[n].end=e[s].end,e[s].remove=!0):e[s].end>=e[n].start&&e[s].end<=e[n].end&&(e[n].start=e[s].start,e[s].remove=!0));for(n=0;n<e.length;n++)e[n].remove!==!0&&r.push(e[n]);a.hiddenDates=r,ci(t=a.hiddenDates).call(t,function(o,l){return o.start-l.start})}function _pe(a){for(var t=0;t<a.length;t++)console.log(t,new Date(a[t].start),new Date(a[t].end),a[t].start,a[t].end,a[t].remove)}function j$(a,t,e){for(var r=!1,n=t.current.valueOf(),s=0;s<t.hiddenDates.length;s++){var o=t.hiddenDates[s].start,l=t.hiddenDates[s].end;if(n>=o&&n<l){r=!0;break}}if(r==!0&&n<t._end.valueOf()&&n!=e){var c=a(e),u=a(l);c.year()!=u.year()?t.switchedYear=!0:c.month()!=u.month()?t.switchedMonth=!0:c.dayOfYear()!=u.dayOfYear()&&(t.switchedDay=!0),t.current=u}}function YS(a,t,e){var r;if(a.body.hiddenDates.length==0)return r=a.range.conversion(e),(t.valueOf()-r.offset)*r.scale;var n=ag(t,a.body.hiddenDates);n.hidden==!0&&(t=n.startDate);var s=Ph(a.body.hiddenDates,a.range.start,a.range.end);if(t<a.range.start){r=a.range.conversion(e,s);var o=Y$(a.body.hiddenDates,t,r.offset);return t=a.options.moment(t).toDate().valueOf(),t=t+o,-(r.offset-t.valueOf())*r.scale}else if(t>a.range.end){var l={start:a.range.start,end:t};return t=ZS(a.options.moment,a.body.hiddenDates,l,t),r=a.range.conversion(e,s),(t.valueOf()-r.offset)*r.scale}else return t=ZS(a.options.moment,a.body.hiddenDates,a.range,t),r=a.range.conversion(e,s),(t.valueOf()-r.offset)*r.scale}function qS(a,t,e){if(a.body.hiddenDates.length==0){var r=a.range.conversion(e);return new Date(t/r.scale+r.offset)}else{var n=Ph(a.body.hiddenDates,a.range.start,a.range.end),s=a.range.end-a.range.start-n,o=s*t/e,l=q$(a.body.hiddenDates,a.range,o);return new Date(l+o+a.range.start)}}function Ph(a,t,e){for(var r=0,n=0;n<a.length;n++){var s=a[n].start,o=a[n].end;s>=t&&o<e&&(r+=o-s)}return r}function Y$(a,t,e){for(var r=0,n=0;n<a.length;n++){var s=a[n].start,o=a[n].end;s>=t&&o<=e&&(r+=o-s)}return r}function ZS(a,t,e,r){return r=a(r).toDate().valueOf(),r-=ng(a,t,e,r),r}function ng(a,t,e,r){var n=0;r=a(r).toDate().valueOf();for(var s=0;s<t.length;s++){var o=t[s].start,l=t[s].end;o>=e.start&&l<e.end&&r>=l&&(n+=l-o)}return n}function q$(a,t,e){for(var r=0,n=0,s=t.start,o=0;o<a.length;o++){var l=a[o].start,c=a[o].end;if(l>=t.start&&c<t.end){if(n+=l-s,s=c,n>=e)break;r+=c-l}}return r}function Vl(a,t,e,r){var n=ag(t,a);return n.hidden==!0?e<0?r==!0?n.startDate-(n.endDate-t)-1:n.startDate-1:r==!0?n.endDate+(t-n.startDate)+1:n.endDate+1:t}function ag(a,t){for(var e=0;e<t.length;e++){var r=t[e].start,n=t[e].end;if(a>=r&&a<n)return{hidden:!0,startDate:r,endDate:n}}return{hidden:!1,startDate:r,endDate:n}}function xpe(a){var t=kpe();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function kpe(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function t2(a){if(a!="horizontal"&&a!="vertical")throw new TypeError('Unknown direction "'.concat(a,'". Choose "horizontal" or "vertical".'))}function KS(a,t){var e=t||{preventDefault:!1};if(a.Manager){var r=a,n=function(u,d){var h=Object.create(e);return d&&r.assign(h,d),KS(new r(u,h),h)};return r.assign(n,r),n.Manager=function(u,d){var h=Object.create(e);return d&&r.assign(h,d),KS(new r.Manager(u,h),h)},n}var s=Object.create(a),o=a.element;o.hammer||(o.hammer=[]),o.hammer.push(s),a.on("hammer.input",function(u){(e.preventDefault===!0||e.preventDefault===u.pointerType)&&u.preventDefault(),u.isFirst&&(wb=u.target)}),s._handlers={},s.on=function(u,d){return l(u).forEach(function(h){var f=s._handlers[h];f||(s._handlers[h]=f=[],a.on(h,c)),f.push(d)}),s},s.off=function(u,d){return l(u).forEach(function(h){var f=s._handlers[h];f&&(f=d?f.filter(function(m){return m!==d}):[],f.length>0?s._handlers[h]=f:(a.off(h,c),delete s._handlers[h]))}),s},s.emit=function(u,d){wb=d.target,a.emit(u,d)},s.destroy=function(){var u=a.element.hammer,d=u.indexOf(s);d!==-1&&u.splice(d,1),u.length||delete a.element.hammer,s._handlers={},a.destroy()};function l(u){return u.match(/[^ ]+/g)}function c(u){if(u.type!=="hammer.input"){if(u.srcEvent._handled||(u.srcEvent._handled={}),u.srcEvent._handled[u.type])return;u.srcEvent._handled[u.type]=!0}var d=!1;u.stopPropagation=function(){d=!0};var h=u.srcEvent.stopPropagation.bind(u.srcEvent);typeof h=="function"&&(u.srcEvent.stopPropagation=function(){h(),u.stopPropagation()}),u.firstTarget=wb;for(var f=wb;f&&!d;){var m=f.hammer;if(m){for(var g,y=0;y<m.length;y++)if(g=m[y]._handlers[u.type],g)for(var v=0;v<g.length&&!d;v++)g[v](u)}f=f.parentNode}}return s}function Mpe(){var a=function(){};return{on:a,off:a,destroy:a,emit:a,get:function(e){return{set:a}}}}function K$(a,t){t.inputHandler=function(e){e.isFirst&&t(e)},a.on("hammer.input",t.inputHandler)}function Ipe(a,t){return t.inputHandler=function(e){e.isFinal&&t(e)},a.on("hammer.input",t.inputHandler)}function Ape(a){var t="pan-y";return a.getTouchAction=function(){return[t]},a}function Gn(a,t){t===void 0&&(t={});var e=t.insertAt;if(!(!a||typeof document=="undefined")){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=a:n.appendChild(document.createTextNode(a))}}function Fpe(a){var t=Rpe();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function Rpe(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function X$(a){var t=a&&a.preventDefault||!1,e=a&&a.container||window,r={},n={keydown:{},keyup:{}},s={},o;for(o=97;o<=122;o++)s[String.fromCharCode(o)]={code:65+(o-97),shift:!1};for(o=65;o<=90;o++)s[String.fromCharCode(o)]={code:o,shift:!0};for(o=0;o<=9;o++)s[""+o]={code:48+o,shift:!1};for(o=1;o<=12;o++)s["F"+o]={code:111+o,shift:!1};for(o=0;o<=9;o++)s["num"+o]={code:96+o,shift:!1};s["num*"]={code:106,shift:!1},s["num+"]={code:107,shift:!1},s["num-"]={code:109,shift:!1},s["num/"]={code:111,shift:!1},s["num."]={code:110,shift:!1},s.left={code:37,shift:!1},s.up={code:38,shift:!1},s.right={code:39,shift:!1},s.down={code:40,shift:!1},s.space={code:32,shift:!1},s.enter={code:13,shift:!1},s.shift={code:16,shift:void 0},s.esc={code:27,shift:!1},s.backspace={code:8,shift:!1},s.tab={code:9,shift:!1},s.ctrl={code:17,shift:!1},s.alt={code:18,shift:!1},s.delete={code:46,shift:!1},s.pageup={code:33,shift:!1},s.pagedown={code:34,shift:!1},s["="]={code:187,shift:!1},s["-"]={code:189,shift:!1},s["]"]={code:221,shift:!1},s["["]={code:219,shift:!1};var l=function(d){u(d,"keydown")},c=function(d){u(d,"keyup")},u=function(d,h){if(n[h][d.keyCode]!==void 0){for(var f=n[h][d.keyCode],m=0;m<f.length;m++)(f[m].shift===void 0||f[m].shift==!0&&d.shiftKey==!0||f[m].shift==!1&&d.shiftKey==!1)&&f[m].fn(d);t==!0&&d.preventDefault()}};return r.bind=function(d,h,f){if(f===void 0&&(f="keydown"),s[d]===void 0)throw new Error("unsupported key: "+d);n[f][s[d].code]===void 0&&(n[f][s[d].code]=[]),n[f][s[d].code].push({fn:h,shift:s[d].shift})},r.bindAll=function(d,h){h===void 0&&(h="keydown");for(var f in s)s.hasOwnProperty(f)&&r.bind(f,d,h)},r.getKey=function(d){for(var h in s)if(s.hasOwnProperty(h)){if(d.shiftKey==!0&&s[h].shift==!0&&d.keyCode==s[h].code)return h;if(d.shiftKey==!1&&s[h].shift==!1&&d.keyCode==s[h].code)return h;if(d.keyCode==s[h].code&&h=="shift")return h}return"unknown key, currently not supported"},r.unbind=function(d,h,f){if(f===void 0&&(f="keydown"),s[d]===void 0)throw new Error("unsupported key: "+d);if(h!==void 0){var m=[],g=n[f][s[d].code];if(g!==void 0)for(var y=0;y<g.length;y++)g[y].fn==h&&g[y].shift==s[d].shift||m.push(n[f][s[d].code][y]);n[f][s[d].code]=m}else n[f][s[d].code]=[]},r.reset=function(){n={keydown:{},keyup:{}}},r.destroy=function(){n={keydown:{},keyup:{}},e.removeEventListener("keydown",l,!0),e.removeEventListener("keyup",c,!0)},e.addEventListener("keydown",l,!0),e.addEventListener("keyup",c,!0),r}function rs(a){var t,e;this.active=!1,this.dom={container:a},this.dom.overlay=document.createElement("div"),this.dom.overlay.className="vis-overlay",this.dom.container.appendChild(this.dom.overlay),this.hammer=yn(this.dom.overlay),this.hammer.on("tap",Oe(t=this._onTapOverlay).call(t,this));var r=this,n=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];Ue(n).call(n,function(s){r.hammer.on(s,function(o){o.stopPropagation()})}),document&&document.body&&(this.onClick=function(s){Bpe(s.target,a)||r.deactivate()},document.body.addEventListener("click",this.onClick)),this.keycharm!==void 0&&this.keycharm.destroy(),this.keycharm=X$(),this.escListener=Oe(e=this.deactivate).call(e,this)}function Bpe(a,t){for(;a;){if(a===t)return!0;a=a.parentNode}return!1}function lme(a){var t=cme();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function cme(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function gme(a){var t=vme();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function vme(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function Bme(a,t){var e=typeof qo!="undefined"&&oo(a)||a["@@iterator"];if(!e){if(Tt(a)||(e=$me(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return s=u.done,u},e:function(u){o=!0,l=u},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function $me(a,t){var e;if(a){if(typeof a=="string")return s2(a,t);var r=En(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return rc(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s2(a,t)}}function s2(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function uz(a){ci(a).call(a,function(t,e){return t.data.start-e.data.start})}function dz(a){ci(a).call(a,function(t,e){var r="end"in t.data?t.data.end:t.data.start,n="end"in e.data?e.data.end:e.data.start;return r-n})}function JS(a,t,e,r){var n=vk(a,t.item,!1,function(s){return s.stack&&(e||s.top===null)},function(s){return s.stack},function(s){return t.axis},r);return n===null}function hz(a,t,e){var r=vk(a,t.item,!1,function(n){return n.stack},function(n){return!0},function(n){return n.baseTop});e.height=r-e.top+.5*t.item.vertical}function fz(a,t,e,r){for(var n=0;n<a.length;n++)if(a[n].data.subgroup==null)a[n].top=t.item.vertical;else if(a[n].data.subgroup!==void 0&&r){var s=0;for(var o in e)e.hasOwnProperty(o)&&e[o].visible==!0&&e[o].index<e[a[n].data.subgroup].index&&(s+=e[o].height,e[a[n].data.subgroup].top=s);a[n].top=s+.5*t.item.vertical}r||pz(a,t,e)}function pz(a,t,e){var r;vk(ci(r=kx(e)).call(r,function(s,o){return s.index>o.index?1:s.index<o.index?-1:0}),{vertical:0},!0,function(s){return!0},function(s){return!0},function(s){return 0});for(var n=0;n<a.length;n++)a[n].data.subgroup!==void 0&&(a[n].top=e[a[n].data.subgroup].top+.5*t.item.vertical)}function QS(a,t,e){var r=!1,n=[];for(var s in e)e[s].hasOwnProperty("index")?n[e[s].index]=s:n.push(s);for(var o=0;o<n.length;o++)if(s=n[o],e.hasOwnProperty(s)){r=r||e[s].stack,e[s].top=0;for(var l in e)e[l].visible&&e[s].index>e[l].index&&(e[s].top+=e[l].height);for(var c=a[s],u=0;u<c.length;u++)c[u].data.subgroup!==void 0&&(c[u].top=e[c[u].data.subgroup].top+.5*t.item.vertical,e[s].stack&&(c[u].baseTop=c[u].top));r&&e[s].stack&&hz(a[s],t,e[s])}}function vk(a,t,e,r,n,s,o){var l=function(O){return O.start},c=function(O){return O.end};if(!e){var u=!!(a[0]&&a[0].options.rtl);u?l=function(O){return O.right}:l=function(O){return O.left},c=function(O){return l(O)+O.width+t.horizontal}}var d=[],h=[],f=null,m=0,g=Bme(a),y;try{for(g.s();!(y=g.n()).done;){var v=y.value;r(v)?d.push(v):n(v)&&(function(){var M=l(v);f!==null&&M<f-ka&&(m=0),f=M,m=Eb(h,function(O){return l(O)-ka>M},m),Bn(h).call(h,m,0,v),m++})()}}catch(M){g.e(M)}finally{g.f()}f=null;var E=null;m=0;for(var C=0,_=0,x=0,P=function(){var O,R,F=d.shift();F.top=s(F);var $=l(F),k=c(F);f!==null&&$<f-ka&&(C=0,_=0,m=0,E=null),f=$,C=Eb(h,function(U){return $<c(U)-ka},C),(E===null||E<k-ka)&&(_=Eb(h,function(U){return k<l(U)-ka},Math.max(C,_))),E!==null&&E-ka>k&&(_=Hme(h,function(U){return k+ka>=l(U)},C,horizontalOVerlapEndIndex)+1);for(var N=ci(O=lt(R=En(h).call(h,C,_)).call(R,function(U){return $<c(U)-ka&&k-ka>l(U)})).call(O,function(U,Z){return U.top-Z.top}),G=0;G<N.length;G++){var W=N[G];zme(F,W,t)&&(F.top=W.top+W.height+t.vertical)}n(F)&&(m=Eb(h,function(U){return l(U)-ka>$},m),Bn(h).call(h,m,0,F),m++);var Y=F.top+F.height;if(Y>x&&(x=Y),o&&o())return{v:null}};d.length>0;){var I=P();if(yt(I)==="object")return I.v}return x}function zme(a,t,e){return a.top-e.vertical+ka<t.top+t.height&&a.top+a.height+e.vertical-ka>t.top}function Eb(a,t,e){var r;e||(e=0);var n=Nme(r=En(a).call(a,e)).call(r,t);return n===-1?a.length:n+e}function Hme(a,t,e,r){for(e||(e=0),r||(r=a.length),i=r-1;i>=e;i--)if(t(a[i]))return i;return e-1}function Ume(a){var t=jme();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function jme(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function qme(a,t){var e=typeof qo!="undefined"&&oo(a)||a["@@iterator"];if(!e){if(Tt(a)||(e=Zme(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return s=u.done,u},e:function(u){o=!0,l=u},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function Zme(a,t){var e;if(a){if(typeof a=="string")return l2(a,t);var r=En(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return rc(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l2(a,t)}}function l2(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Kme(a){var t=Xme();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function Xme(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function Jme(a){var t=Qme();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function Qme(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function ege(a){var t=tge();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function tge(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function rge(a){var t=ige();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function ige(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function c2(a,t){var e=typeof qo!="undefined"&&oo(a)||a["@@iterator"];if(!e){if(Tt(a)||(e=yge(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return s=u.done,u},e:function(u){o=!0,l=u},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function yge(a,t){var e;if(a){if(typeof a=="string")return u2(a,t);var r=En(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return rc(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u2(a,t)}}function u2(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function bge(a){var t=wge();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function wge(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function Ege(a,t){var e=typeof qo!="undefined"&&oo(a)||a["@@iterator"];if(!e){if(Tt(a)||(e=Tge(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return s=u.done,u},e:function(u){o=!0,l=u},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function Tge(a,t){var e;if(a){if(typeof a=="string")return d2(a,t);var r=En(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return rc(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d2(a,t)}}function d2(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function lu(a,t){var e=typeof qo!="undefined"&&oo(a)||a["@@iterator"];if(!e){if(Tt(a)||(e=Pge(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return s=u.done,u},e:function(u){o=!0,l=u},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function Pge(a,t){var e;if(a){if(typeof a=="string")return h2(a,t);var r=En(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return rc(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h2(a,t)}}function h2(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Lge(a){var t=Mge();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function Mge(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function Bge(a){var t=$ge();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function $ge(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function nS(a){return ae.convert(a.data.start,"Date").valueOf()}function aS(a){var t=a.data.end!=null?a.data.end:a.data.start;return ae.convert(t,"Date").valueOf()}function g2(a,t){if(!t.parent)return!1;var e=a.options.rtl?a.props.rightContainer.height:a.props.leftContainer.height,r=a.props.center.height,n=t.parent,s=n.top,o=!0,l=a.timeAxis.options.orientation.axis,c=function(){return l=="bottom"?n.height-t.top-t.height:t.top},u=a._getScrollTop()*-1,d=s+c(),h=t.height;return d<u?s+e<=s+c()+h&&(s+=c()-a.itemSet.options.margin.item.vertical):d+h>u+e?s+=c()+h-e+a.itemSet.options.margin.item.vertical:o=!1,s=Math.min(s,r-e),{shouldScroll:o,scrollOffset:s,itemTop:d}}function Gge(a,t){var e=typeof qo!="undefined"&&oo(a)||a["@@iterator"];if(!e){if(Tt(a)||(e=Vge(a))||t&&a&&typeof a.length=="number"){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,l;return{s:function(){e=e.call(a)},n:function(){var u=e.next();return s=u.done,u},e:function(u){o=!0,l=u},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(o)throw l}}}}function Vge(a,t){var e;if(a){if(typeof a=="string")return v2(a,t);var r=En(e=Object.prototype.toString.call(a)).call(e,8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return rc(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v2(a,t)}}function v2(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=a[e];return r}function Wge(a){var t=Uge();return function(){var r=or(a),n;if(t){var s=or(this).constructor;n=it(r,arguments,s)}else n=r.apply(this,arguments);return ca(this,n)}}function Uge(){if(typeof Reflect=="undefined"||!it||it.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(it(Boolean,[],function(){})),!0}catch(a){return!1}}function Lg(a,t){}function tx(a,t){return t=typeof t=="undefined"?{}:t,{style:t.style||a.options.drawPoints.style,styles:t.styles||a.options.drawPoints.styles,size:t.size||a.options.drawPoints.size,className:t.className||a.className}}function jge(a,t){var e=void 0;return a.options&&a.options.drawPoints&&a.options.drawPoints.onRender&&typeof a.options.drawPoints.onRender=="function"&&(e=a.options.drawPoints.onRender),t.group.options&&t.group.options.drawPoints&&t.group.options.drawPoints.onRender&&typeof t.group.options.drawPoints.onRender=="function"&&(e=t.group.options.drawPoints.onRender),e}function $n(a,t){}function rn(a,t){}function Ko(a,t,e,r){this.id=t;var n=["sampling","style","sort","yAxisOrientation","barChart","drawPoints","shaded","interpolation","zIndex","excludeFromStacking","excludeFromLegend"];this.options=ae.selectiveBridgeObject(n,e),this.usingDefaultStyle=a.className===void 0,this.groupsUsingDefaultStyles=r,this.zeroPosition=0,this.update(a),this.usingDefaultStyle==!0&&(this.groupsUsingDefaultStyles[0]+=1),this.itemsData=[],this.visible=a.visible===void 0?!0:a.visible}function sa(a,t,e,r){this.body=a,this.defaultOptions={enabled:!1,icons:!0,iconSize:20,iconSpacing:6,left:{visible:!0,position:"top-left"},right:{visible:!0,position:"top-right"}},this.side=e,this.options=ae.extend({},this.defaultOptions),this.linegraphOptions=r,this.svgElements={},this.dom={},this.groups={},this.amountOfGroups=0,this._create(),this.framework={svg:this.svg,svgElements:this.svgElements,options:this.options,groups:this.groups},this.setOptions(t)}function pr(a,t){this.id=gu(),this.body=a,this.defaultOptions={yAxisOrientation:"left",defaultGroup:"default",sort:!0,sampling:!0,stack:!1,graphHeight:"400px",shaded:{enabled:!1,orientation:"bottom"},style:"line",barChart:{width:50,sideBySide:!1,align:"center"},interpolation:{enabled:!0,parametrization:"centripetal",alpha:.5},drawPoints:{enabled:!0,size:6,style:"square"},dataAxis:{},legend:{},groups:{visibility:{}}},this.options=ae.extend({},this.defaultOptions),this.dom={},this.props={},this.hammer=null,this.groups={},this.abortedGraphUpdate=!1,this.updateSVGheight=!1,this.updateSVGheightOnResize=!1,this.forceGraphUpdate=!0;var e=this;this.itemsData=null,this.groupsData=null,this.itemListeners={add:function(n,s,o){e._onAdd(s.items)},update:function(n,s,o){e._onUpdate(s.items)},remove:function(n,s,o){e._onRemove(s.items)}},this.groupListeners={add:function(n,s,o){e._onAddGroups(s.items)},update:function(n,s,o){e._onUpdateGroups(s.items)},remove:function(n,s,o){e._onRemoveGroups(s.items)}},this.items={},this.selection=[],this.lastStart=this.body.range.start,this.touchParams={},this.svgElements={},this.setOptions(t),this.groupsUsingDefaultStyles=[0],this.body.emitter.on("rangechanged",function(){e.svg.style.left=ae.option.asSize(-e.props.width),e.forceGraphUpdate=!0,e.redraw.call(e)}),this._create(),this.framework={svg:this.svg,svgElements:this.svgElements,options:this.options,groups:this.groups}}function co(a,t,e,r){var n,s,o,l,c,u,d;if(!(Tt(e)||Uo(e))&&e instanceof Object){var h=r;r=e,e=h}r&&r.throttleRedraw&&console.warn('Graph2d option "throttleRedraw" is DEPRICATED and no longer supported. It will be removed in the next MAJOR release.');var f=this;this.defaultOptions={start:null,end:null,autoResize:!0,orientation:{axis:"bottom",item:"bottom"},moment:bn,width:null,height:null,maxHeight:null,minHeight:null},this.options=ae.deepExtend({},this.defaultOptions),this._create(a),this.components=[],this.body={dom:this.dom,domProps:this.props,emitter:{on:Oe(n=this.on).call(n,this),off:Oe(s=this.off).call(s,this),emit:Oe(o=this.emit).call(o,this)},hiddenDates:[],util:{getScale:function(){return f.timeAxis.step.scale},getStep:function(){return f.timeAxis.step.step},toScreen:Oe(l=f._toScreen).call(l,f),toGlobalScreen:Oe(c=f._toGlobalScreen).call(c,f),toTime:Oe(u=f._toTime).call(u,f),toGlobalTime:Oe(d=f._toGlobalTime).call(d,f)}},this.range=new dk(this.body),this.components.push(this.range),this.body.range=this.range,this.timeAxis=new og(this.body),this.components.push(this.timeAxis),this.currentTime=new gk(this.body),this.components.push(this.currentTime),this.linegraph=new pr(this.body),this.components.push(this.linegraph),this.itemsData=null,this.groupsData=null,this.on("tap",function(m){f.emit("click",f.getEventProperties(m))}),this.on("doubletap",function(m){f.emit("doubleClick",f.getEventProperties(m))}),this.dom.root.oncontextmenu=function(m){f.emit("contextmenu",f.getEventProperties(m))},this.initialFitDone=!1,this.on("changed",function(){if(f.itemsData!=null){if(!f.initialFitDone&&!f.options.rollingMode)if(f.initialFitDone=!0,f.options.start!=null||f.options.end!=null){if(f.options.start==null||f.options.end==null)var m=f.getItemRange();var g=f.options.start!=null?f.options.start:m.min,y=f.options.end!=null?f.options.end:m.max;f.setWindow(g,y,{animation:!1})}else f.fit({animation:!1});!f.initialDrawDone&&(f.initialRangeChangeDone||!f.options.start&&!f.options.end||f.options.rollingMode)&&(f.initialDrawDone=!0,f.dom.root.style.visibility="visible",f.dom.loadingScreen.parentNode.removeChild(f.dom.loadingScreen),f.options.onInitialDrawComplete&&wn(function(){return f.options.onInitialDrawComplete()},0))}}),r&&this.setOptions(r),e&&this.setGroups(e),t&&this.setItems(t),this._redraw()}var as,zC,UI,b2,rr,q8,cg,w2,E2,Z8,sS,K8,ir,X8,J8,ug,eb,nt,Xb,Q8,jI,ej,tj,rj,ij,YI,nj,rx,qI,aj,sj,$h,oj,lj,cj,oa,uj,dj,hj,Wi,fj,pj,mj,gj,Jb,fr,wi,HC,GC,vj,ZI,ss,yj,Ql,T2,VC,KI,XI,JI,QI,xs,Mb,zh,eA,bj,ix,wj,C2,Ej,Tj,tA,Cj,rA,_2,dh,hu,iA,_j,ai,Sj,xj,S2,nx,x2,kj,Dj,xu,Pj,Lj,Mj,Tb,Ij,Aj,Oj,Fj,Rj,jo,Nj,Bj,$j,so,ax,zj,Hj,Gj,Vj,nA,Wj,aA,Uj,jj,Yj,oS,qj,sx,Zj,Kj,Xj,sA,Jj,Qj,Ui,eY,ji,la,tY,oA,lS,rY,ox,iY,nY,aY,k2,sY,oY,D2,P2,lY,cY,uY,Aa,dY,tb,Oa,hY,Tr,fY,pY,mY,gY,vY,yY,lx,bY,wY,Qb,EY,TY,CY,_Y,Ms,SY,cx,xY,WC,UC,jC,kY,DY,PY,LY,lA,cA,MY,IY,AY,OY,FY,RY,NY,BY,e0,$Y,zY,HY,GY,rb,uA,VY,YC,WY,qC,ZC,KC,ku,UY,jY,YY,ec,qY,ZY,dA,t0,dg,KY,L2,XC,XY,JY,JC,QC,QY,eq,hA,cS,tq,Ib,Wm,Ab,rq,iq,$l,fA,e_,pA,su,Hh,nq,M2,mA,gA,Du,Pu,hg,I2,A2,aq,sq,oq,lq,cq,t_,uq,r0,dq,hq,Is,fq,pq,mq,gq,vq,yq,bq,wq,vA,Eq,Tq,Cq,fg,_q,Sq,xq,kq,O2,yA,Dq,Pq,Lq,tc,ib,Mq,Iq,Aq,Oq,Fq,hh,Rq,fh,bA,Nq,pt,uS,Bq,F2,$q,ux,zq,Hq,R2,i0,Gq,Vq,Wq,pg,Uq,jq,Yq,qq,Fa,Zq,Kq,Xq,wA,dx,Jq,r_,Qq,e9,t9,EA,N2,hx,r9,i9,mg,n9,a9,s9,o9,l9,c9,u9,B2,d9,h9,TA,f9,p9,m9,g9,CA,_A,dS,hS,$2,i_,z2,SA,v9,nb,Cb,Lu,y9,H2,b9,w9,E9,T9,C9,_9,xA,fS,S9,n0,x9,a0,k9,D9,P9,kA,L9,M9,pS,G2,Ro,n_,a_,I9,V2,A9,O9,F9,R9,N9,B9,$9,z9,H9,DA,Gh,Vh,G9,V9,W9,U9,j9,Y9,q9,W2,Z9,K9,X9,J9,Q9,eZ,tZ,U2,rZ,iZ,nZ,aZ,sZ,oZ,PA,lZ,LA,cZ,uZ,ab,s_,MA,sb,IA,dZ,fx,hZ,fZ,j2,pZ,Y2,mZ,gZ,vZ,AA,yZ,q2,bZ,wZ,EZ,TZ,CZ,_Z,SZ,Z2,xZ,kZ,K2,DZ,PZ,LZ,X2,MZ,J2,px,IZ,AZ,Dm,Q2,s0,OZ,FZ,RZ,Wh,NZ,OA,BZ,$Z,zZ,o0,HZ,GZ,VZ,WZ,UZ,jZ,YZ,mx,qZ,ZZ,KZ,XZ,JZ,QZ,e7,t7,FA,r7,i7,RA,n7,a7,eR,tR,NA,o_,rR,s7,o7,l7,c7,u7,d7,h7,iR,rc,nR,f7,BA,aR,p7,sR,m7,g7,v7,y7,b7,w7,E7,T7,C7,$A,_7,zA,l_,lb,ob,S7,x7,k7,D7,P7,L7,oo,oR,M7,Mu,gg,I7,A7,O7,gx,F7,HA,R7,N7,B7,$7,lR,z7,H7,cR,G7,uR,V7,l0,W7,vg,c0,U7,GA,j7,Y7,q7,ui,Z7,VA,K7,X7,J7,Q7,WA,eK,tK,u0,rK,iK,nK,aK,sK,oK,UA,zl,Yo,Uh,vx,lK,cK,yg,uK,Lh,yu,yx,vi,dK,hK,fK,pK,mS,gS,mK,d0,bx,dR,vS,Um,hR,gK,fR,yS,pR,mR,vK,gR,yK,bS,bg,bK,vR,jA,yR,wK,EK,TK,bR,h0,ia,f0,jm,YA,CK,qA,ks,No,Ul,wR,c_,Pm,ER,Wl,TR,_K,CR,Ho,wg,u_,d_,SK,wS,ES,h_,p0,wx,xK,_R,SR,xR,Ex,ZA,KA,kK,DK,PK,LK,Mh,kR,DR,MK,IK,AK,PR,LR,OK,FK,RK,MR,NK,BK,$K,jh,IR,zK,HK,GK,VK,WK,UK,Tx,jK,YK,qK,ZK,KK,XK,JK,QK,eX,tX,Ih,AR,OR,rX,iX,XA,nX,FR,aX,sX,oX,Cx,RR,NR,lX,cX,JA,uX,BR,dX,hX,$R,Eg,_x,fX,pX,mX,gX,m0,zR,vX,yX,bX,wX,EX,HR,TX,CX,_X,SX,GR,g0,kX,DX,PX,LX,Tg,MX,IX,AX,OX,FX,RX,NX,eO,BX,$X,zX,HX,VR,tO,rO,iO,GX,VX,WX,UX,jX,YX,qX,ZX,KX,XX,JX,QX,eJ,tJ,rJ,iJ,nJ,aJ,sJ,oJ,lJ,cJ,WR,uJ,dJ,hJ,fJ,pJ,mJ,gJ,vJ,yJ,bJ,wJ,Th,Sx,TJ,CJ,nO,_J,SJ,aO,xJ,kJ,DJ,PJ,LJ,MJ,IJ,AJ,f_,OJ,FJ,jr,RJ,NJ,BJ,$J,p_,zJ,HJ,UR,GJ,VJ,WJ,UJ,jJ,jR,YJ,qJ,ZJ,KJ,YR,xx,JJ,QJ,eQ,ZR,tQ,rQ,iQ,nQ,aQ,KR,qo,XR,cQ,uQ,dQ,hQ,m_,fQ,pQ,mQ,Ir,JR,En,QR,gQ,vQ,yQ,bQ,wQ,EQ,eN,tN,Tt,rN,TQ,CQ,_Q,SQ,xQ,kQ,DQ,PQ,g_,LQ,MQ,IQ,sr,iN,AQ,OQ,nN,FQ,RQ,NQ,BQ,$Q,zQ,bi,aN,HQ,GQ,VQ,sN,WQ,UQ,jQ,YQ,qQ,Pa,oN,ZQ,lN,KQ,XQ,JQ,sO,QQ,cN,eee,tee,v_,ree,uN,iee,oO,nee,aee,see,oee,y_,lee,cee,dN,Oe,hN,uee,Yh,dee,hee,fee,pee,mee,lO,gee,vee,yee,bee,wee,Eee,Tee,Cee,b_,_ee,fN,Ue,pN,See,xee,kee,Dee,cO,Pee,Lee,Mee,Iee,w_,Aee,Oee,mN,Fee,gN,Ree,Nee,Bee,$ee,zee,Hee,Gee,Vee,Wee,Uee,jee,Yee,qee,Zee,Kee,Xee,Jee,Qee,ete,E_,tte,rte,ite,Bn,vN,uO,nte,ate,ste,T_,ote,lte,cte,ute,ph,dO,dte,hte,fte,hO,pte,mte,gte,vte,Go,yN,yte,bte,wte,Ete,Tte,Cte,_te,Ste,xte,kte,Dte,Pte,Lte,Mte,Ite,Ate,Ote,Fte,Rte,Nte,fO,Bte,$te,zte,Hte,pO,Gte,Vte,C_,__,Wte,Ute,jte,Kl,bN,Yte,qte,Zte,wN,Kte,Xte,Jte,Qte,ere,EN,mO,TN,tre,rre,ire,nre,are,sre,ore,lre,S_,cre,ure,dre,lt,CN,hre,_N,fre,pre,mre,gre,vre,gO,yre,bre,wre,Ere,Tre,Cre,_re,kx,SN,v0,Sre,xre,kre,Dre,vO,Ob,Pre,Lre,x_,Dx,xN,Mre,Ire,Are,Ore,yO,Nm,bO,wO,kN,Fre,Rre,Nre,Bre,EO,$re,zre,Hre,Gre,La,DN,Vre,Wre,Ure,jre,CS,TO,Yre,qre,Zre,Kre,Xre,k_,Jre,Qre,eie,Er,PN,tie,rie,CO,_O,iie,nie,aie,sie,oie,lie,cie,uie,D_,die,hie,fie,P_,LN,pie,mie,gie,vie,yie,bie,wie,MN,Cg,IN,Eie,Tie,Cie,_ie,_g,Sie,xie,Fb,cb,SO,kie,Die,Pie,Lie,xO,kO,Mie,Iie,_S,Aie,Oie,Fie,Rie,na,AN,Nie,Bie,ON,$ie,SS,zie,Hie,Gie,Vie,Wie,Uie,jie,DO,Yie,qie,wn,FN,Zie,PO,Kie,Xie,Jie,Qie,ene,tne,rne,ine,L_,nne,ane,sne,RN,NN,Px,xS,bu,LO,one,lne,Ch,wu,Lx,Bo,BN,$N,zN,HN,kS,fu,Ym,qm,db,une,GN,dne,hne,Sg,fne,Mx,pne,mne,zn,Iu,yi,aa,Rb,xg,kg,Dg,Ah,no,pu,VN,WN,Nb,UN,qh,Cne,_ne,ZN,KN,XN,Sne,xne,Ox,Dne,Pne,Lne,Fx,Mne,AO,JN,_b,is,Oh,ql,zo,Xm,ro,Fne,Pg,PS,Fh,Rx,eB,tB,rB,iB,nB,RO,Nne,NO,$O,$ne,zne,Hne,Gne,sB,Wne,Nx,$x,Hx,Qne,eae,tae,rae,iae,aae,gae,_ae,kh,Oae,Nae,mB,Bae,$ae,Lm,WO,AS,zae,Hae,Gae,Vae,Wae,Uae,jae,Yae,gB,qae,bB,Zae,Kae,Xae,Jae,wB,Qae,ese,M_,tse,UO,rse,jO,ise,EB,jx,nse,ase,TB,CB,YO,sse,ose,lse,cse,it,Yx,use,dse,hse,fse,pse,qx,mse,gse,vse,yse,bse,wse,Ese,Tse,Cse,_se,OS,_B,Sse,xse,kse,Dse,SB,Zx,Pse,Lse,Mse,Ise,qO,xB,kB,DB,Ase,Ose,Fse,Rse,PB,ZO,Nse,Bse,$se,zse,Hse,Gse,Vse,LB,Wse,Use,jse,Yse,qse,Zse,Kse,Xse,Jse,Qse,eoe,toe,KO,roe,ioe,XO,noe,xb,JO,Zh,aoe,soe,ooe,loe,coe,uoe,doe,hoe,foe,Hb,poe,MB,fb,I_,moe,goe,voe,yoe,boe,woe,Eoe,Gb,Toe,eg,A_,Coe,IB,_oe,AB,Soe,xoe,koe,Doe,QO,OB,Poe,Loe,Moe,Kx,eF,Ioe,Aoe,Ooe,FB,Foe,RB,Roe,Noe,E0,Ia,Boe,$oe,tF,zoe,Hoe,rF,Goe,iF,Voe,Woe,Uoe,RS,NS,joe,O_,Yoe,nF,qoe,F_,Gm,aF,tg,ou,R_,N_,Xx,B_,sF,oF,NB,Zoe,Koe,Xoe,Joe,Qoe,_u,lF,ele,$_,tle,rle,ile,z_,cF,uF,dF,pb,hF,BB,Mm,uu,Vm,wh,H_,G_,mb,fF,nle,Kh,pF,ale,sle,ole,lle,$B,cle,ule,T0,zB,dle,hle,C0,fle,Vo,ple,Xl,BS,mle,gle,vle,$S,Vb,yle,ble,wle,mF,Ele,Tle,HB,Jx,Cle,_le,GB,zS,Sle,Qx,xle,kle,Dle,Wb,gF,Ple,lo,vF,Lle,Mle,Ile,Ds,kb,VB,HS,ek,Rh,Ale,Ole,WB,UB,Fle,yF,jB,Rle,tk,YB,bF,gb,wF,rk,_0,Nle,qB,ZB,KB,XB,Ble,EF,$le,xh,Dh,GS,zle,Hle,Gle,Vle,Wle,Ule,jle,Yle,qle,Zle,Kle,Xle,Jle,TF,Qle,CF,ece,tce,rce,ice,_F,nce,ace,sce,oce,lce,cce,uce,dce,hce,fce,pce,mce,JB,gce,vce,yce,bce,Db,ta,QB,wce,Ece,Tce,Cce,_ce,Sce,SF,xce,kce,Dce,Pce,xF,Lce,Mce,Ice,Ace,Oce,Fce,Rce,V_,Nce,Bce,$ce,S0,e$,zce,Hce,Gce,Vce,Wce,t$,Uce,jce,Yce,qce,Zce,Kce,Xce,Jce,Qce,eue,tue,W_,rue,iue,nue,aue,r$,ik,sue,oue,lue,cue,uue,kF,Pb,due,hue,fue,pue,mue,gue,vue,yue,nk,bue,DF,wue,ak,Eue,Tue,i$,Wo,Cue,sk,_ue,Sue,xue,kue,Due,Pue,Lue,Mue,Iue,Aue,Oue,Fue,Rue,Nue,Bue,$ue,zue,Hue,n$,Gue,Vue,a$,Wue,Uue,PF,jue,Yue,que,Zue,Kue,Im,LF,s$,MF,U_,o$,Xue,Jue,Que,ede,tde,rde,l$,c$,ide,nde,ade,sde,ode,lde,Zl,u$,mu,d$,cde,ude,dde,hde,fde,pde,mde,gde,j_,h$,IF,vde,VS,yde,bde,wde,Ede,AF,Tde,Cde,_de,Sde,OF,xde,kde,f$,Dde,Pde,Lde,FF,ok,Mde,Ide,RF,Ade,NF,BF,jl,$F,Ode,Fde,Rde,Nde,p$,Bde,$de,zde,Hde,Gde,Vde,Y_,Wde,Ude,jde,ci,m$,Yde,qde,Zde,Kde,Xde,Jde,Qde,ehe,q_,the,rhe,ihe,lk,g$,nhe,ahe,she,ohe,lhe,che,uhe,dhe,Z_,hhe,fhe,cu,v$,phe,mhe,ghe,vhe,yhe,bhe,whe,Ehe,K_,The,Che,zF,y$,_he,She,xhe,khe,Dhe,Phe,Lhe,Mhe,X_,Ihe,Ahe,Ohe,HF,Fhe,b$,Am,$he,zhe,T$,Xhe,Jhe,_$,S$,UF,Su,x$,bn,_s,US,ei,rg,Au,nfe,sfe,Om,lfe,vb,cfe,dfe,ck,hfe,ffe,Ub,L$,bfe,wfe,Efe,Tfe,Cfe,_fe,Sfe,yb,YF,qF,k0,Gl,Afe,$fe,Ss,$$,zfe,Hfe,Lb,Ufe,jfe,Q_,Yfe,H$,qfe,jS,Zfe,ae,G$,V$,Kfe,Xfe,Jfe,Qfe,epe,tpe,jb,JF,QF,rpe,ipe,npe,e2,ape,spe,ope,lpe,Yb,Zo,W$,cpe,upe,dpe,hpe,fpe,ppe,mpe,gpe,vpe,ype,bpe,wpe,eS,Epe,Tpe,Cpe,Eh,Spe,dk,Z$,Dpe,Ppe,Lpe,wb,XS,r2,yn,sg,Ope,og,i2,Npe,hk,$pe,zpe,fk,Hpe,Gpe,pk,Vpe,Wpe,J$,Upe,P0,jpe,Ype,qpe,Q$,Zpe,ez,Kpe,tz,Xpe,rz,Jpe,mk,Qpe,eme,iz,tme,nz,rme,L0,ime,nme,ame,az,sme,Bh,ome,M0,ume,dme,hme,fme,pme,mme,vu,gk,sz,yme,bme,n2,oz,wme,Eme,Tme,Cme,tS,_me,Sme,xme,kme,lz,Dme,Pme,a2,cz,Lme,Mme,Ime,Ame,rS,Ome,Fme,Rme,Nme,ka,Gme,Vme,Wme,o2,qb,yk,Yme,Ou,mz,gz,Jl,ic,nge,age,vz,sge,oge,lge,cge,uge,dge,hge,fge,iS,pge,mge,gge,vge,bk,Cge,_ge,Sge,xge,kge,Dge,mh,Hl,lg,Fm,f2,Zb,yz,Lt,kt,Mr,p2,gh,li,Ige,vh,m2,Age,Oge,Fge,Rge,Nge,bz,zge,wz,Hge,ex,Kb,Mt,Yt,br,Yge,yh,Wr,qge,bh,y2,Zge,Kge,Xge,Jge,Ez=_e(()=>{as=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};zC={exports:{}};(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){function r(s,o,l,c){var u={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[s+" Tage",s+" Tagen"],w:["eine Woche","einer Woche"],M:["ein Monat","einem Monat"],MM:[s+" Monate",s+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[s+" Jahre",s+" Jahren"]};return o?u[l][0]:u[l][1]}var n=e.defineLocale("de",{months:"Januar_Februar_M\xE4rz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._M\xE4rz_Apr._Mai_Juni_Juli_Aug._Sep._Okt._Nov._Dez.".split("_"),monthsParseExact:!0,weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},calendar:{sameDay:"[heute um] LT [Uhr]",sameElse:"L",nextDay:"[morgen um] LT [Uhr]",nextWeek:"dddd [um] LT [Uhr]",lastDay:"[gestern um] LT [Uhr]",lastWeek:"[letzten] dddd [um] LT [Uhr]"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",ss:"%d Sekunden",m:r,mm:"%d Minuten",h:r,hh:"%d Stunden",d:r,dd:r,w:r,ww:"%d Wochen",M:r,MM:r,y:r,yy:r},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return n})})();(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){var r="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),n="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),s=[/^ene/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i],o=/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre|ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,l=e.defineLocale("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(c,u){return c?/-MMM-/.test(u)?n[c.month()]:r[c.month()]:r},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,monthsShortStrictRegex:/^(ene\.?|feb\.?|mar\.?|abr\.?|may\.?|jun\.?|jul\.?|ago\.?|sep\.?|oct\.?|nov\.?|dic\.?)/i,monthsParse:s,longMonthsParse:s,shortMonthsParse:s,weekdays:"domingo_lunes_martes_mi\xE9rcoles_jueves_viernes_s\xE1bado".split("_"),weekdaysShort:"dom._lun._mar._mi\xE9._jue._vie._s\xE1b.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s\xE1".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},calendar:{sameDay:function(){return"[hoy a la"+(this.hours()!==1?"s":"")+"] LT"},nextDay:function(){return"[ma\xF1ana a la"+(this.hours()!==1?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(this.hours()!==1?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(this.hours()!==1?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(this.hours()!==1?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",ss:"%d segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un d\xEDa",dd:"%d d\xEDas",w:"una semana",ww:"%d semanas",M:"un mes",MM:"%d meses",y:"un a\xF1o",yy:"%d a\xF1os"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d\xBA",week:{dow:1,doy:4},invalidDate:"Fecha inv\xE1lida"});return l})})();(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){var r=/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i,n=/(janv\.?|fvr\.?|mars|avr\.?|mai|juin|juil\.?|aot|sept\.?|oct\.?|nov\.?|dc\.?)/i,s=/(janv\.?|fvr\.?|mars|avr\.?|mai|juin|juil\.?|aot|sept\.?|oct\.?|nov\.?|dc\.?|janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i,o=[/^janv/i,/^fvr/i,/^mars/i,/^avr/i,/^mai/i,/^juin/i,/^juil/i,/^aot/i,/^sept/i,/^oct/i,/^nov/i,/^dc/i],l=e.defineLocale("fr",{months:"janvier_f\xE9vrier_mars_avril_mai_juin_juillet_ao\xFBt_septembre_octobre_novembre_d\xE9cembre".split("_"),monthsShort:"janv._f\xE9vr._mars_avr._mai_juin_juil._ao\xFBt_sept._oct._nov._d\xE9c.".split("_"),monthsRegex:s,monthsShortRegex:s,monthsStrictRegex:r,monthsShortStrictRegex:n,monthsParse:o,longMonthsParse:o,shortMonthsParse:o,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd\u2019hui \xE0] LT",nextDay:"[Demain \xE0] LT",nextWeek:"dddd [\xE0] LT",lastDay:"[Hier \xE0] LT",lastWeek:"dddd [dernier \xE0] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",w:"une semaine",ww:"%d semaines",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(c,u){switch(u){case"D":return c+(c===1?"er":"");default:case"M":case"Q":case"DDD":case"d":return c+(c===1?"er":"e");case"w":case"W":return c+(c===1?"re":"e")}},week:{dow:1,doy:4}});return l})})();(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){var r=e.defineLocale("it",{months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),weekdays:"domenica_luned\xEC_marted\xEC_mercoled\xEC_gioved\xEC_venerd\xEC_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:function(){return"[Oggi a"+(this.hours()>1?"lle ":this.hours()===0?" ":"ll'")+"]LT"},nextDay:function(){return"[Domani a"+(this.hours()>1?"lle ":this.hours()===0?" ":"ll'")+"]LT"},nextWeek:function(){return"dddd [a"+(this.hours()>1?"lle ":this.hours()===0?" ":"ll'")+"]LT"},lastDay:function(){return"[Ieri a"+(this.hours()>1?"lle ":this.hours()===0?" ":"ll'")+"]LT"},lastWeek:function(){switch(this.day()){case 0:return"[La scorsa] dddd [a"+(this.hours()>1?"lle ":this.hours()===0?" ":"ll'")+"]LT";default:return"[Lo scorso] dddd [a"+(this.hours()>1?"lle ":this.hours()===0?" ":"ll'")+"]LT"}},sameElse:"L"},relativeTime:{future:"tra %s",past:"%s fa",s:"alcuni secondi",ss:"%d secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",w:"una settimana",ww:"%d settimane",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:"%d\xBA",week:{dow:1,doy:4}});return r})})();(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){var r=e.defineLocale("ja",{eras:[{since:"2019-05-01",offset:1,name:"\u4EE4\u548C",narrow:"\u32FF",abbr:"R"},{since:"1989-01-08",until:"2019-04-30",offset:1,name:"\u5E73\u6210",narrow:"\u337B",abbr:"H"},{since:"1926-12-25",until:"1989-01-07",offset:1,name:"\u662D\u548C",narrow:"\u337C",abbr:"S"},{since:"1912-07-30",until:"1926-12-24",offset:1,name:"\u5927\u6B63",narrow:"\u337D",abbr:"T"},{since:"1873-01-01",until:"1912-07-29",offset:6,name:"\u660E\u6CBB",narrow:"\u337E",abbr:"M"},{since:"0001-01-01",until:"1873-12-31",offset:1,name:"\u897F\u66A6",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"\u7D00\u5143\u524D",narrow:"BC",abbr:"BC"}],eraYearOrdinalRegex:/(|\d+)/,eraYearOrdinalParse:function(n,s){return s[1]==="\u5143"?1:parseInt(s[1]||n,10)},months:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),weekdays:"\u65E5\u66DC\u65E5_\u6708\u66DC\u65E5_\u706B\u66DC\u65E5_\u6C34\u66DC\u65E5_\u6728\u66DC\u65E5_\u91D1\u66DC\u65E5_\u571F\u66DC\u65E5".split("_"),weekdaysShort:"\u65E5_\u6708_\u706B_\u6C34_\u6728_\u91D1_\u571F".split("_"),weekdaysMin:"\u65E5_\u6708_\u706B_\u6C34_\u6728_\u91D1_\u571F".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY\u5E74M\u6708D\u65E5",LLL:"YYYY\u5E74M\u6708D\u65E5 HH:mm",LLLL:"YYYY\u5E74M\u6708D\u65E5 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY\u5E74M\u6708D\u65E5",lll:"YYYY\u5E74M\u6708D\u65E5 HH:mm",llll:"YYYY\u5E74M\u6708D\u65E5(ddd) HH:mm"},meridiemParse:/|/i,isPM:function(n){return n==="\u5348\u5F8C"},meridiem:function(n,s,o){return n<12?"\u5348\u524D":"\u5348\u5F8C"},calendar:{sameDay:"[\u4ECA\u65E5] LT",nextDay:"[\u660E\u65E5] LT",nextWeek:function(n){return n.week()!==this.week()?"[\u6765\u9031]dddd LT":"dddd LT"},lastDay:"[\u6628\u65E5] LT",lastWeek:function(n){return this.week()!==n.week()?"[\u5148\u9031]dddd LT":"dddd LT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}/,ordinal:function(n,s){switch(s){case"y":return n===1?"\u5143\u5E74":n+"\u5E74";case"d":case"D":case"DDD":return n+"\u65E5";default:return n}},relativeTime:{future:"%s\u5F8C",past:"%s\u524D",s:"\u6570\u79D2",ss:"%d\u79D2",m:"1\u5206",mm:"%d\u5206",h:"1\u6642\u9593",hh:"%d\u6642\u9593",d:"1\u65E5",dd:"%d\u65E5",M:"1\u30F6\u6708",MM:"%d\u30F6\u6708",y:"1\u5E74",yy:"%d\u5E74"}});return r})})();(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){var r="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),n="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),s=[/^jan/i,/^feb/i,/^maart|mrt.?$/i,/^apr/i,/^mei$/i,/^jun[i.]?$/i,/^jul[i.]?$/i,/^aug/i,/^sep/i,/^okt/i,/^nov/i,/^dec/i],o=/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december|jan\.?|feb\.?|mrt\.?|apr\.?|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,l=e.defineLocale("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(c,u){return c?/-MMM-/.test(u)?n[c.month()]:r[c.month()]:r},monthsRegex:o,monthsShortRegex:o,monthsStrictRegex:/^(januari|februari|maart|april|mei|ju[nl]i|augustus|september|oktober|november|december)/i,monthsShortStrictRegex:/^(jan\.?|feb\.?|mrt\.?|apr\.?|mei|ju[nl]\.?|aug\.?|sep\.?|okt\.?|nov\.?|dec\.?)/i,monthsParse:s,longMonthsParse:s,shortMonthsParse:s,weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",ss:"%d seconden",m:"\xE9\xE9n minuut",mm:"%d minuten",h:"\xE9\xE9n uur",hh:"%d uur",d:"\xE9\xE9n dag",dd:"%d dagen",w:"\xE9\xE9n week",ww:"%d weken",M:"\xE9\xE9n maand",MM:"%d maanden",y:"\xE9\xE9n jaar",yy:"%d jaar"},dayOfMonthOrdinalParse:/\d{1,2}(ste|de)/,ordinal:function(c){return c+(c===1||c===8||c>=20?"ste":"de")},week:{dow:1,doy:4}});return l})})();(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){var r="stycze\u0144_luty_marzec_kwiecie\u0144_maj_czerwiec_lipiec_sierpie\u0144_wrzesie\u0144_pa\u017Adziernik_listopad_grudzie\u0144".split("_"),n="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrze\u015Bnia_pa\u017Adziernika_listopada_grudnia".split("_"),s=[/^sty/i,/^lut/i,/^mar/i,/^kwi/i,/^maj/i,/^cze/i,/^lip/i,/^sie/i,/^wrz/i,/^pa/i,/^lis/i,/^gru/i];function o(u){return u%10<5&&u%10>1&&~~(u/10)%10!==1}function l(u,d,h){var f=u+" ";switch(h){case"ss":return f+(o(u)?"sekundy":"sekund");case"m":return d?"minuta":"minut\u0119";case"mm":return f+(o(u)?"minuty":"minut");case"h":return d?"godzina":"godzin\u0119";case"hh":return f+(o(u)?"godziny":"godzin");case"ww":return f+(o(u)?"tygodnie":"tygodni");case"MM":return f+(o(u)?"miesi\u0105ce":"miesi\u0119cy");case"yy":return f+(o(u)?"lata":"lat")}}var c=e.defineLocale("pl",{months:function(u,d){return u?/D MMMM/.test(d)?n[u.month()]:r[u.month()]:r},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa\u017A_lis_gru".split("_"),monthsParse:s,longMonthsParse:s,shortMonthsParse:s,weekdays:"niedziela_poniedzia\u0142ek_wtorek_\u015Broda_czwartek_pi\u0105tek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_\u015Br_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_\u015Ar_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dzi\u015B o] LT",nextDay:"[Jutro o] LT",nextWeek:function(){switch(this.day()){case 0:return"[W niedziel\u0119 o] LT";case 2:return"[We wtorek o] LT";case 3:return"[W \u015Brod\u0119 o] LT";case 6:return"[W sobot\u0119 o] LT";default:return"[W] dddd [o] LT"}},lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zesz\u0142\u0105 niedziel\u0119 o] LT";case 3:return"[W zesz\u0142\u0105 \u015Brod\u0119 o] LT";case 6:return"[W zesz\u0142\u0105 sobot\u0119 o] LT";default:return"[W zesz\u0142y] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",ss:l,m:l,mm:l,h:l,hh:l,d:"1 dzie\u0144",dd:"%d dni",w:"tydzie\u0144",ww:l,M:"miesi\u0105c",MM:l,y:"rok",yy:l},dayOfMonthOrdinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return c})})();(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){function r(l,c){var u=l.split("_");return c%10===1&&c%100!==11?u[0]:c%10>=2&&c%10<=4&&(c%100<10||c%100>=20)?u[1]:u[2]}function n(l,c,u){var d={ss:c?"\u0441\u0435\u043A\u0443\u043D\u0434\u0430_\u0441\u0435\u043A\u0443\u043D\u0434\u044B_\u0441\u0435\u043A\u0443\u043D\u0434":"\u0441\u0435\u043A\u0443\u043D\u0434\u0443_\u0441\u0435\u043A\u0443\u043D\u0434\u044B_\u0441\u0435\u043A\u0443\u043D\u0434",mm:c?"\u043C\u0438\u043D\u0443\u0442\u0430_\u043C\u0438\u043D\u0443\u0442\u044B_\u043C\u0438\u043D\u0443\u0442":"\u043C\u0438\u043D\u0443\u0442\u0443_\u043C\u0438\u043D\u0443\u0442\u044B_\u043C\u0438\u043D\u0443\u0442",hh:"\u0447\u0430\u0441_\u0447\u0430\u0441\u0430_\u0447\u0430\u0441\u043E\u0432",dd:"\u0434\u0435\u043D\u044C_\u0434\u043D\u044F_\u0434\u043D\u0435\u0439",ww:"\u043D\u0435\u0434\u0435\u043B\u044F_\u043D\u0435\u0434\u0435\u043B\u0438_\u043D\u0435\u0434\u0435\u043B\u044C",MM:"\u043C\u0435\u0441\u044F\u0446_\u043C\u0435\u0441\u044F\u0446\u0430_\u043C\u0435\u0441\u044F\u0446\u0435\u0432",yy:"\u0433\u043E\u0434_\u0433\u043E\u0434\u0430_\u043B\u0435\u0442"};return u==="m"?c?"\u043C\u0438\u043D\u0443\u0442\u0430":"\u043C\u0438\u043D\u0443\u0442\u0443":l+" "+r(d[u],+l)}var s=[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],o=e.defineLocale("ru",{months:{format:"\u044F\u043D\u0432\u0430\u0440\u044F_\u0444\u0435\u0432\u0440\u0430\u043B\u044F_\u043C\u0430\u0440\u0442\u0430_\u0430\u043F\u0440\u0435\u043B\u044F_\u043C\u0430\u044F_\u0438\u044E\u043D\u044F_\u0438\u044E\u043B\u044F_\u0430\u0432\u0433\u0443\u0441\u0442\u0430_\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F_\u043E\u043A\u0442\u044F\u0431\u0440\u044F_\u043D\u043E\u044F\u0431\u0440\u044F_\u0434\u0435\u043A\u0430\u0431\u0440\u044F".split("_"),standalone:"\u044F\u043D\u0432\u0430\u0440\u044C_\u0444\u0435\u0432\u0440\u0430\u043B\u044C_\u043C\u0430\u0440\u0442_\u0430\u043F\u0440\u0435\u043B\u044C_\u043C\u0430\u0439_\u0438\u044E\u043D\u044C_\u0438\u044E\u043B\u044C_\u0430\u0432\u0433\u0443\u0441\u0442_\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044C_\u043E\u043A\u0442\u044F\u0431\u0440\u044C_\u043D\u043E\u044F\u0431\u0440\u044C_\u0434\u0435\u043A\u0430\u0431\u0440\u044C".split("_")},monthsShort:{format:"\u044F\u043D\u0432._\u0444\u0435\u0432\u0440._\u043C\u0430\u0440._\u0430\u043F\u0440._\u043C\u0430\u044F_\u0438\u044E\u043D\u044F_\u0438\u044E\u043B\u044F_\u0430\u0432\u0433._\u0441\u0435\u043D\u0442._\u043E\u043A\u0442._\u043D\u043E\u044F\u0431._\u0434\u0435\u043A.".split("_"),standalone:"\u044F\u043D\u0432._\u0444\u0435\u0432\u0440._\u043C\u0430\u0440\u0442_\u0430\u043F\u0440._\u043C\u0430\u0439_\u0438\u044E\u043D\u044C_\u0438\u044E\u043B\u044C_\u0430\u0432\u0433._\u0441\u0435\u043D\u0442._\u043E\u043A\u0442._\u043D\u043E\u044F\u0431._\u0434\u0435\u043A.".split("_")},weekdays:{standalone:"\u0432\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435_\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A_\u0432\u0442\u043E\u0440\u043D\u0438\u043A_\u0441\u0440\u0435\u0434\u0430_\u0447\u0435\u0442\u0432\u0435\u0440\u0433_\u043F\u044F\u0442\u043D\u0438\u0446\u0430_\u0441\u0443\u0431\u0431\u043E\u0442\u0430".split("_"),format:"\u0432\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435_\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A_\u0432\u0442\u043E\u0440\u043D\u0438\u043A_\u0441\u0440\u0435\u0434\u0443_\u0447\u0435\u0442\u0432\u0435\u0440\u0433_\u043F\u044F\u0442\u043D\u0438\u0446\u0443_\u0441\u0443\u0431\u0431\u043E\u0442\u0443".split("_"),isFormat:/\[ ?[] ?(?:||)? ?] ?dddd/},weekdaysShort:"\u0432\u0441_\u043F\u043D_\u0432\u0442_\u0441\u0440_\u0447\u0442_\u043F\u0442_\u0441\u0431".split("_"),weekdaysMin:"\u0432\u0441_\u043F\u043D_\u0432\u0442_\u0441\u0440_\u0447\u0442_\u043F\u0442_\u0441\u0431".split("_"),monthsParse:s,longMonthsParse:s,shortMonthsParse:s,monthsRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsShortRegex:/^([]|\.?|[]|?\.?|?|\.?|[]|\.?|[]|[]|\.?|[]|\.?|?|\.?|[]|?\.?|[]|\.?|[]|?\.?|[]|\.?)/i,monthsStrictRegex:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[])/i,monthsShortStrictRegex:/^(\.|?\.|[.]|\.|[]|[.]|[.]|\.|?\.|\.|?\.|\.)/i,longDateFormat:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY \u0433.",LLL:"D MMMM YYYY \u0433., H:mm",LLLL:"dddd, D MMMM YYYY \u0433., H:mm"},calendar:{sameDay:"[\u0421\u0435\u0433\u043E\u0434\u043D\u044F, \u0432] LT",nextDay:"[\u0417\u0430\u0432\u0442\u0440\u0430, \u0432] LT",lastDay:"[\u0412\u0447\u0435\u0440\u0430, \u0432] LT",nextWeek:function(l){if(l.week()!==this.week())switch(this.day()){case 0:return"[\u0412 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u0435] dddd, [\u0432] LT";case 1:case 2:case 4:return"[\u0412 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439] dddd, [\u0432] LT";case 3:case 5:case 6:return"[\u0412 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0443\u044E] dddd, [\u0432] LT"}else return this.day()===2?"[\u0412\u043E] dddd, [\u0432] LT":"[\u0412] dddd, [\u0432] LT"},lastWeek:function(l){if(l.week()!==this.week())switch(this.day()){case 0:return"[\u0412 \u043F\u0440\u043E\u0448\u043B\u043E\u0435] dddd, [\u0432] LT";case 1:case 2:case 4:return"[\u0412 \u043F\u0440\u043E\u0448\u043B\u044B\u0439] dddd, [\u0432] LT";case 3:case 5:case 6:return"[\u0412 \u043F\u0440\u043E\u0448\u043B\u0443\u044E] dddd, [\u0432] LT"}else return this.day()===2?"[\u0412\u043E] dddd, [\u0432] LT":"[\u0412] dddd, [\u0432] LT"},sameElse:"L"},relativeTime:{future:"\u0447\u0435\u0440\u0435\u0437 %s",past:"%s \u043D\u0430\u0437\u0430\u0434",s:"\u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u0441\u0435\u043A\u0443\u043D\u0434",ss:n,m:n,mm:n,h:"\u0447\u0430\u0441",hh:n,d:"\u0434\u0435\u043D\u044C",dd:n,w:"\u043D\u0435\u0434\u0435\u043B\u044F",ww:n,M:"\u043C\u0435\u0441\u044F\u0446",MM:n,y:"\u0433\u043E\u0434",yy:n},meridiemParse:/|||/i,isPM:function(l){return/^(|)$/.test(l)},meridiem:function(l,c,u){return l<4?"\u043D\u043E\u0447\u0438":l<12?"\u0443\u0442\u0440\u0430":l<17?"\u0434\u043D\u044F":"\u0432\u0435\u0447\u0435\u0440\u0430"},dayOfMonthOrdinalParse:/\d{1,2}-(||)/,ordinal:function(l,c){switch(c){case"M":case"d":case"DDD":return l+"-\u0439";case"D":return l+"-\u0433\u043E";case"w":case"W":return l+"-\u044F";default:return l}},week:{dow:1,doy:4}});return o})})();(function(a,t){(function(e,r){r(typeof ao=="function"?Ls():e.moment)})(as,function(e){function r(c,u){var d=c.split("_");return u%10===1&&u%100!==11?d[0]:u%10>=2&&u%10<=4&&(u%100<10||u%100>=20)?d[1]:d[2]}function n(c,u,d){var h={ss:u?"\u0441\u0435\u043A\u0443\u043D\u0434\u0430_\u0441\u0435\u043A\u0443\u043D\u0434\u0438_\u0441\u0435\u043A\u0443\u043D\u0434":"\u0441\u0435\u043A\u0443\u043D\u0434\u0443_\u0441\u0435\u043A\u0443\u043D\u0434\u0438_\u0441\u0435\u043A\u0443\u043D\u0434",mm:u?"\u0445\u0432\u0438\u043B\u0438\u043D\u0430_\u0445\u0432\u0438\u043B\u0438\u043D\u0438_\u0445\u0432\u0438\u043B\u0438\u043D":"\u0445\u0432\u0438\u043B\u0438\u043D\u0443_\u0445\u0432\u0438\u043B\u0438\u043D\u0438_\u0445\u0432\u0438\u043B\u0438\u043D",hh:u?"\u0433\u043E\u0434\u0438\u043D\u0430_\u0433\u043E\u0434\u0438\u043D\u0438_\u0433\u043E\u0434\u0438\u043D":"\u0433\u043E\u0434\u0438\u043D\u0443_\u0433\u043E\u0434\u0438\u043D\u0438_\u0433\u043E\u0434\u0438\u043D",dd:"\u0434\u0435\u043D\u044C_\u0434\u043D\u0456_\u0434\u043D\u0456\u0432",MM:"\u043C\u0456\u0441\u044F\u0446\u044C_\u043C\u0456\u0441\u044F\u0446\u0456_\u043C\u0456\u0441\u044F\u0446\u0456\u0432",yy:"\u0440\u0456\u043A_\u0440\u043E\u043A\u0438_\u0440\u043E\u043A\u0456\u0432"};return d==="m"?u?"\u0445\u0432\u0438\u043B\u0438\u043D\u0430":"\u0445\u0432\u0438\u043B\u0438\u043D\u0443":d==="h"?u?"\u0433\u043E\u0434\u0438\u043D\u0430":"\u0433\u043E\u0434\u0438\u043D\u0443":c+" "+r(h[d],+c)}function s(c,u){var d={nominative:"\u043D\u0435\u0434\u0456\u043B\u044F_\u043F\u043E\u043D\u0435\u0434\u0456\u043B\u043E\u043A_\u0432\u0456\u0432\u0442\u043E\u0440\u043E\u043A_\u0441\u0435\u0440\u0435\u0434\u0430_\u0447\u0435\u0442\u0432\u0435\u0440_\u043F\u2019\u044F\u0442\u043D\u0438\u0446\u044F_\u0441\u0443\u0431\u043E\u0442\u0430".split("_"),accusative:"\u043D\u0435\u0434\u0456\u043B\u044E_\u043F\u043E\u043D\u0435\u0434\u0456\u043B\u043E\u043A_\u0432\u0456\u0432\u0442\u043E\u0440\u043E\u043A_\u0441\u0435\u0440\u0435\u0434\u0443_\u0447\u0435\u0442\u0432\u0435\u0440_\u043F\u2019\u044F\u0442\u043D\u0438\u0446\u044E_\u0441\u0443\u0431\u043E\u0442\u0443".split("_"),genitive:"\u043D\u0435\u0434\u0456\u043B\u0456_\u043F\u043E\u043D\u0435\u0434\u0456\u043B\u043A\u0430_\u0432\u0456\u0432\u0442\u043E\u0440\u043A\u0430_\u0441\u0435\u0440\u0435\u0434\u0438_\u0447\u0435\u0442\u0432\u0435\u0440\u0433\u0430_\u043F\u2019\u044F\u0442\u043D\u0438\u0446\u0456_\u0441\u0443\u0431\u043E\u0442\u0438".split("_")},h;return c===!0?d.nominative.slice(1,7).concat(d.nominative.slice(0,1)):c?(h=/(\[[]\]) ?dddd/.test(u)?"accusative":/\[?(?:|)? ?\] ?dddd/.test(u)?"genitive":"nominative",d[h][c.day()]):d.nominative}function o(c){return function(){return c+"\u043E"+(this.hours()===11?"\u0431":"")+"] LT"}}var l=e.defineLocale("uk",{months:{format:"\u0441\u0456\u0447\u043D\u044F_\u043B\u044E\u0442\u043E\u0433\u043E_\u0431\u0435\u0440\u0435\u0437\u043D\u044F_\u043A\u0432\u0456\u0442\u043D\u044F_\u0442\u0440\u0430\u0432\u043D\u044F_\u0447\u0435\u0440\u0432\u043D\u044F_\u043B\u0438\u043F\u043D\u044F_\u0441\u0435\u0440\u043F\u043D\u044F_\u0432\u0435\u0440\u0435\u0441\u043D\u044F_\u0436\u043E\u0432\u0442\u043D\u044F_\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434\u0430_\u0433\u0440\u0443\u0434\u043D\u044F".split("_"),standalone:"\u0441\u0456\u0447\u0435\u043D\u044C_\u043B\u044E\u0442\u0438\u0439_\u0431\u0435\u0440\u0435\u0437\u0435\u043D\u044C_\u043A\u0432\u0456\u0442\u0435\u043D\u044C_\u0442\u0440\u0430\u0432\u0435\u043D\u044C_\u0447\u0435\u0440\u0432\u0435\u043D\u044C_\u043B\u0438\u043F\u0435\u043D\u044C_\u0441\u0435\u0440\u043F\u0435\u043D\u044C_\u0432\u0435\u0440\u0435\u0441\u0435\u043D\u044C_\u0436\u043E\u0432\u0442\u0435\u043D\u044C_\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434_\u0433\u0440\u0443\u0434\u0435\u043D\u044C".split("_")},monthsShort:"\u0441\u0456\u0447_\u043B\u044E\u0442_\u0431\u0435\u0440_\u043A\u0432\u0456\u0442_\u0442\u0440\u0430\u0432_\u0447\u0435\u0440\u0432_\u043B\u0438\u043F_\u0441\u0435\u0440\u043F_\u0432\u0435\u0440_\u0436\u043E\u0432\u0442_\u043B\u0438\u0441\u0442_\u0433\u0440\u0443\u0434".split("_"),weekdays:s,weekdaysShort:"\u043D\u0434_\u043F\u043D_\u0432\u0442_\u0441\u0440_\u0447\u0442_\u043F\u0442_\u0441\u0431".split("_"),weekdaysMin:"\u043D\u0434_\u043F\u043D_\u0432\u0442_\u0441\u0440_\u0447\u0442_\u043F\u0442_\u0441\u0431".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY \u0440.",LLL:"D MMMM YYYY \u0440., HH:mm",LLLL:"dddd, D MMMM YYYY \u0440., HH:mm"},calendar:{sameDay:o("[\u0421\u044C\u043E\u0433\u043E\u0434\u043D\u0456 "),nextDay:o("[\u0417\u0430\u0432\u0442\u0440\u0430 "),lastDay:o("[\u0412\u0447\u043E\u0440\u0430 "),nextWeek:o("[\u0423] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return o("[\u041C\u0438\u043D\u0443\u043B\u043E\u0457] dddd [").call(this);case 1:case 2:case 4:return o("[\u041C\u0438\u043D\u0443\u043B\u043E\u0433\u043E] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:"\u0437\u0430 %s",past:"%s \u0442\u043E\u043C\u0443",s:"\u0434\u0435\u043A\u0456\u043B\u044C\u043A\u0430 \u0441\u0435\u043A\u0443\u043D\u0434",ss:n,m:n,mm:n,h:"\u0433\u043E\u0434\u0438\u043D\u0443",hh:n,d:"\u0434\u0435\u043D\u044C",dd:n,M:"\u043C\u0456\u0441\u044F\u0446\u044C",MM:n,y:"\u0440\u0456\u043A",yy:n},meridiemParse:/|||/,isPM:function(c){return/^(|)$/.test(c)},meridiem:function(c,u,d){return c<4?"\u043D\u043E\u0447\u0456":c<12?"\u0440\u0430\u043D\u043A\u0443":c<17?"\u0434\u043D\u044F":"\u0432\u0435\u0447\u043E\u0440\u0430"},dayOfMonthOrdinalParse:/\d{1,2}-(|)/,ordinal:function(c,u){switch(u){case"M":case"d":case"DDD":case"w":case"W":return c+"-\u0439";case"D":return c+"-\u0433\u043E";default:return c}},week:{dow:1,doy:7}});return l})})();b2={exports:{}},rr=function(a){try{return!!a()}catch(t){return!0}},q8=rr,cg=!q8(function(){var a=function(){}.bind();return typeof a!="function"||a.hasOwnProperty("prototype")}),w2=cg,E2=Function.prototype,Z8=E2.bind,sS=E2.call,K8=w2&&Z8.bind(sS,sS),ir=w2?function(a){return a&&K8(a)}:function(a){return a&&function(){return sS.apply(a,arguments)}},X8=Math.ceil,J8=Math.floor,ug=function(a){var t=+a;return t!==t||t===0?0:(t>0?J8:X8)(t)},eb=function(a){return a&&a.Math==Math&&a},nt=eb(typeof globalThis=="object"&&globalThis)||eb(typeof window=="object"&&window)||eb(typeof self=="object"&&self)||eb(typeof as=="object"&&as)||(function(){return this})()||Function("return this")(),Xb={exports:{}},Q8=!0,jI=nt,ej=Object.defineProperty,tj=function(a,t){try{ej(jI,a,{value:t,configurable:!0,writable:!0})}catch(e){jI[a]=t}return t},rj=nt,ij=tj,YI="__core-js_shared__",nj=rj[YI]||ij(YI,{}),rx=nj,qI=rx;(Xb.exports=function(a,t){return qI[a]||(qI[a]=t!==void 0?t:{})})("versions",[]).push({version:"3.21.1",mode:"pure",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"});aj=nt,sj=aj.TypeError,$h=function(a){if(a==null)throw sj("Can't call method on "+a);return a},oj=nt,lj=$h,cj=oj.Object,oa=function(a){return cj(lj(a))},uj=ir,dj=oa,hj=uj({}.hasOwnProperty),Wi=Object.hasOwn||function(t,e){return hj(dj(t),e)},fj=ir,pj=0,mj=Math.random(),gj=fj(1 .toString),Jb=function(a){return"Symbol("+(a===void 0?"":a)+")_"+gj(++pj+mj,36)},fr={},wi=function(a){return typeof a=="function"},HC=fr,GC=nt,vj=wi,ZI=function(a){return vj(a)?a:void 0},ss=function(a,t){return arguments.length<2?ZI(HC[a])||ZI(GC[a]):HC[a]&&HC[a][t]||GC[a]&&GC[a][t]},yj=ss,Ql=yj("navigator","userAgent")||"",T2=nt,VC=Ql,KI=T2.process,XI=T2.Deno,JI=KI&&KI.versions||XI&&XI.version,QI=JI&&JI.v8;QI&&(xs=QI.split("."),Mb=xs[0]>0&&xs[0]<4?1:+(xs[0]+xs[1]));!Mb&&VC&&(xs=VC.match(/Edge\/(\d+)/),(!xs||xs[1]>=74)&&(xs=VC.match(/Chrome\/(\d+)/),xs&&(Mb=+xs[1])));zh=Mb,eA=zh,bj=rr,ix=!!Object.getOwnPropertySymbols&&!bj(function(){var a=Symbol();return!String(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&eA&&eA<41}),wj=ix,C2=wj&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ej=nt,Tj=Xb.exports,tA=Wi,Cj=Jb,rA=ix,_2=C2,dh=Tj("wks"),hu=Ej.Symbol,iA=hu&&hu.for,_j=_2?hu:hu&&hu.withoutSetter||Cj,ai=function(a){if(!tA(dh,a)||!(rA||typeof dh[a]=="string")){var t="Symbol."+a;rA&&tA(hu,a)?dh[a]=hu[a]:_2&&iA?dh[a]=iA(t):dh[a]=_j(t)}return dh[a]},Sj=ai,xj=Sj("toStringTag"),S2={};S2[xj]="z";nx=String(S2)==="[object z]",x2=ir,kj=x2({}.toString),Dj=x2("".slice),xu=function(a){return Dj(kj(a),8,-1)},Pj=nt,Lj=nx,Mj=wi,Tb=xu,Ij=ai,Aj=Ij("toStringTag"),Oj=Pj.Object,Fj=Tb((function(){return arguments})())=="Arguments",Rj=function(a,t){try{return a[t]}catch(e){}},jo=Lj?Tb:function(a){var t,e,r;return a===void 0?"Undefined":a===null?"Null":typeof(e=Rj(t=Oj(a),Aj))=="string"?e:Fj?Tb(t):(r=Tb(t))=="Object"&&Mj(t.callee)?"Arguments":r},Nj=nt,Bj=jo,$j=Nj.String,so=function(a){if(Bj(a)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return $j(a)},ax=ir,zj=ug,Hj=so,Gj=$h,Vj=ax("".charAt),nA=ax("".charCodeAt),Wj=ax("".slice),aA=function(a){return function(t,e){var r=Hj(Gj(t)),n=zj(e),s=r.length,o,l;return n<0||n>=s?a?"":void 0:(o=nA(r,n),o<55296||o>56319||n+1===s||(l=nA(r,n+1))<56320||l>57343?a?Vj(r,n):o:a?Wj(r,n,n+2):(o-55296<<10)+(l-56320)+65536)}},Uj={codeAt:aA(!1),charAt:aA(!0)},jj=ir,Yj=wi,oS=rx,qj=jj(Function.toString);Yj(oS.inspectSource)||(oS.inspectSource=function(a){return qj(a)});sx=oS.inspectSource,Zj=nt,Kj=wi,Xj=sx,sA=Zj.WeakMap,Jj=Kj(sA)&&/native code/.test(Xj(sA)),Qj=wi,Ui=function(a){return typeof a=="object"?a!==null:Qj(a)},eY=rr,ji=!eY(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),la={},tY=nt,oA=Ui,lS=tY.document,rY=oA(lS)&&oA(lS.createElement),ox=function(a){return rY?lS.createElement(a):{}},iY=ji,nY=rr,aY=ox,k2=!iY&&!nY(function(){return Object.defineProperty(aY("div"),"a",{get:function(){return 7}}).a!=7}),sY=ji,oY=rr,D2=sY&&oY(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),P2=nt,lY=Ui,cY=P2.String,uY=P2.TypeError,Aa=function(a){if(lY(a))return a;throw uY(cY(a)+" is not an object")},dY=cg,tb=Function.prototype.call,Oa=dY?tb.bind(tb):function(){return tb.apply(tb,arguments)},hY=ir,Tr=hY({}.isPrototypeOf),fY=nt,pY=ss,mY=wi,gY=Tr,vY=C2,yY=fY.Object,lx=vY?function(a){return typeof a=="symbol"}:function(a){var t=pY("Symbol");return mY(t)&&gY(t.prototype,yY(a))},bY=nt,wY=bY.String,Qb=function(a){try{return wY(a)}catch(t){return"Object"}},EY=nt,TY=wi,CY=Qb,_Y=EY.TypeError,Ms=function(a){if(TY(a))return a;throw _Y(CY(a)+" is not a function")},SY=Ms,cx=function(a,t){var e=a[t];return e==null?void 0:SY(e)},xY=nt,WC=Oa,UC=wi,jC=Ui,kY=xY.TypeError,DY=function(a,t){var e,r;if(t==="string"&&UC(e=a.toString)&&!jC(r=WC(e,a))||UC(e=a.valueOf)&&!jC(r=WC(e,a))||t!=="string"&&UC(e=a.toString)&&!jC(r=WC(e,a)))return r;throw kY("Can't convert object to primitive value")},PY=nt,LY=Oa,lA=Ui,cA=lx,MY=cx,IY=DY,AY=ai,OY=PY.TypeError,FY=AY("toPrimitive"),RY=function(a,t){if(!lA(a)||cA(a))return a;var e=MY(a,FY),r;if(e){if(t===void 0&&(t="default"),r=LY(e,a,t),!lA(r)||cA(r))return r;throw OY("Can't convert object to primitive value")}return t===void 0&&(t="number"),IY(a,t)},NY=RY,BY=lx,e0=function(a){var t=NY(a,"string");return BY(t)?t:t+""},$Y=nt,zY=ji,HY=k2,GY=D2,rb=Aa,uA=e0,VY=$Y.TypeError,YC=Object.defineProperty,WY=Object.getOwnPropertyDescriptor,qC="enumerable",ZC="configurable",KC="writable";la.f=zY?GY?function(t,e,r){if(rb(t),e=uA(e),rb(r),typeof t=="function"&&e==="prototype"&&"value"in r&&KC in r&&!r[KC]){var n=WY(t,e);n&&n[KC]&&(t[e]=r.value,r={configurable:ZC in r?r[ZC]:n[ZC],enumerable:qC in r?r[qC]:n[qC],writable:!1})}return YC(t,e,r)}:YC:function(t,e,r){if(rb(t),e=uA(e),rb(r),HY)try{return YC(t,e,r)}catch(n){}if("get"in r||"set"in r)throw VY("Accessors not supported");return"value"in r&&(t[e]=r.value),t};ku=function(a,t){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:t}},UY=ji,jY=la,YY=ku,ec=UY?function(a,t,e){return jY.f(a,t,YY(1,e))}:function(a,t,e){return a[t]=e,a},qY=Xb.exports,ZY=Jb,dA=qY("keys"),t0=function(a){return dA[a]||(dA[a]=ZY(a))},dg={},KY=Jj,L2=nt,XC=ir,XY=Ui,JY=ec,JC=Wi,QC=rx,QY=t0,eq=dg,hA="Object already initialized",cS=L2.TypeError,tq=L2.WeakMap,rq=function(a){return Ab(a)?Wm(a):Ib(a,{})},iq=function(a){return function(t){var e;if(!XY(t)||(e=Wm(t)).type!==a)throw cS("Incompatible receiver, "+a+" required");return e}};KY||QC.state?($l=QC.state||(QC.state=new tq),fA=XC($l.get),e_=XC($l.has),pA=XC($l.set),Ib=function(a,t){if(e_($l,a))throw new cS(hA);return t.facade=a,pA($l,a,t),t},Wm=function(a){return fA($l,a)||{}},Ab=function(a){return e_($l,a)}):(su=QY("state"),eq[su]=!0,Ib=function(a,t){if(JC(a,su))throw new cS(hA);return t.facade=a,JY(a,su,t),t},Wm=function(a){return JC(a,su)?a[su]:{}},Ab=function(a){return JC(a,su)});Hh={set:Ib,get:Wm,has:Ab,enforce:rq,getterFor:iq},nq=cg,M2=Function.prototype,mA=M2.apply,gA=M2.call,Du=typeof Reflect=="object"&&Reflect.apply||(nq?gA.bind(mA):function(){return gA.apply(mA,arguments)}),Pu={},hg={},I2={}.propertyIsEnumerable,A2=Object.getOwnPropertyDescriptor,aq=A2&&!I2.call({1:2},1);hg.f=aq?function(t){var e=A2(this,t);return!!e&&e.enumerable}:I2;sq=nt,oq=ir,lq=rr,cq=xu,t_=sq.Object,uq=oq("".split),r0=lq(function(){return!t_("z").propertyIsEnumerable(0)})?function(a){return cq(a)=="String"?uq(a,""):t_(a)}:t_,dq=r0,hq=$h,Is=function(a){return dq(hq(a))},fq=ji,pq=Oa,mq=hg,gq=ku,vq=Is,yq=e0,bq=Wi,wq=k2,vA=Object.getOwnPropertyDescriptor;Pu.f=fq?vA:function(t,e){if(t=vq(t),e=yq(e),wq)try{return vA(t,e)}catch(r){}if(bq(t,e))return gq(!pq(mq.f,t,e),t[e])};Eq=rr,Tq=wi,Cq=/#|\.prototype\./,fg=function(a,t){var e=Sq[_q(a)];return e==kq?!0:e==xq?!1:Tq(t)?Eq(t):!!t},_q=fg.normalize=function(a){return String(a).replace(Cq,".").toLowerCase()},Sq=fg.data={},xq=fg.NATIVE="N",kq=fg.POLYFILL="P",O2=fg,yA=ir,Dq=Ms,Pq=cg,Lq=yA(yA.bind),tc=function(a,t){return Dq(a),t===void 0?a:Pq?Lq(a,t):function(){return a.apply(t,arguments)}},ib=nt,Mq=Du,Iq=ir,Aq=wi,Oq=Pu.f,Fq=O2,hh=fr,Rq=tc,fh=ec,bA=Wi,Nq=function(a){var t=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new a;case 1:return new a(e);case 2:return new a(e,r)}return new a(e,r,n)}return Mq(a,this,arguments)};return t.prototype=a.prototype,t},pt=function(a,t){var e=a.target,r=a.global,n=a.stat,s=a.proto,o=r?ib:n?ib[e]:(ib[e]||{}).prototype,l=r?hh:hh[e]||fh(hh,e,{})[e],c=l.prototype,u,d,h,f,m,g,y,v,E;for(f in t)u=Fq(r?f:e+(n?".":"#")+f,a.forced),d=!u&&o&&bA(o,f),g=l[f],d&&(a.noTargetGet?(E=Oq(o,f),y=E&&E.value):y=o[f]),m=d&&y?y:t[f],!(d&&typeof g==typeof m)&&(a.bind&&d?v=Rq(m,ib):a.wrap&&d?v=Nq(m):s&&Aq(m)?v=Iq(m):v=m,(a.sham||m&&m.sham||g&&g.sham)&&fh(v,"sham",!0),fh(l,f,v),s&&(h=e+"Prototype",bA(hh,h)||fh(hh,h,{}),fh(hh[h],f,m),a.real&&c&&!c[f]&&fh(c,f,m)))},uS=ji,Bq=Wi,F2=Function.prototype,$q=uS&&Object.getOwnPropertyDescriptor,ux=Bq(F2,"name"),zq=ux&&function(){}.name==="something",Hq=ux&&(!uS||uS&&$q(F2,"name").configurable),R2={EXISTS:ux,PROPER:zq,CONFIGURABLE:Hq},i0={},Gq=ug,Vq=Math.max,Wq=Math.min,pg=function(a,t){var e=Gq(a);return e<0?Vq(e+t,0):Wq(e,t)},Uq=ug,jq=Math.min,Yq=function(a){return a>0?jq(Uq(a),9007199254740991):0},qq=Yq,Fa=function(a){return qq(a.length)},Zq=Is,Kq=pg,Xq=Fa,wA=function(a){return function(t,e,r){var n=Zq(t),s=Xq(n),o=Kq(r,s),l;if(a&&e!=e){for(;s>o;)if(l=n[o++],l!=l)return!0}else for(;s>o;o++)if((a||o in n)&&n[o]===e)return a||o||0;return!a&&-1}},dx={includes:wA(!0),indexOf:wA(!1)},Jq=ir,r_=Wi,Qq=Is,e9=dx.indexOf,t9=dg,EA=Jq([].push),N2=function(a,t){var e=Qq(a),r=0,n=[],s;for(s in e)!r_(t9,s)&&r_(e,s)&&EA(n,s);for(;t.length>r;)r_(e,s=t[r++])&&(~e9(n,s)||EA(n,s));return n},hx=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],r9=N2,i9=hx,mg=Object.keys||function(t){return r9(t,i9)},n9=ji,a9=D2,s9=la,o9=Aa,l9=Is,c9=mg;i0.f=n9&&!a9?Object.defineProperties:function(t,e){o9(t);for(var r=l9(e),n=c9(e),s=n.length,o=0,l;s>o;)s9.f(t,l=n[o++],r[l]);return t};u9=ss,B2=u9("document","documentElement"),d9=Aa,h9=i0,TA=hx,f9=dg,p9=B2,m9=ox,g9=t0,CA=">",_A="<",dS="prototype",hS="script",$2=g9("IE_PROTO"),i_=function(){},z2=function(a){return _A+hS+CA+a+_A+"/"+hS+CA},SA=function(a){a.write(z2("")),a.close();var t=a.parentWindow.Object;return a=null,t},v9=function(){var a=m9("iframe"),t="java"+hS+":",e;return a.style.display="none",p9.appendChild(a),a.src=String(t),e=a.contentWindow.document,e.open(),e.write(z2("document.F=Object")),e.close(),e.F},Cb=function(){try{nb=new ActiveXObject("htmlfile")}catch(t){}Cb=typeof document!="undefined"?document.domain&&nb?SA(nb):v9():SA(nb);for(var a=TA.length;a--;)delete Cb[dS][TA[a]];return Cb()};f9[$2]=!0;Lu=Object.create||function(t,e){var r;return t!==null?(i_[dS]=d9(t),r=new i_,i_[dS]=null,r[$2]=t):r=Cb(),e===void 0?r:h9.f(r,e)},y9=rr,H2=!y9(function(){function a(){}return a.prototype.constructor=null,Object.getPrototypeOf(new a)!==a.prototype}),b9=nt,w9=Wi,E9=wi,T9=oa,C9=t0,_9=H2,xA=C9("IE_PROTO"),fS=b9.Object,S9=fS.prototype,n0=_9?fS.getPrototypeOf:function(a){var t=T9(a);if(w9(t,xA))return t[xA];var e=t.constructor;return E9(e)&&t instanceof e?e.prototype:t instanceof fS?S9:null},x9=ec,a0=function(a,t,e,r){r&&r.enumerable?a[t]=e:x9(a,t,e)},k9=rr,D9=wi,P9=Lu,kA=n0,L9=a0,M9=ai,pS=M9("iterator"),G2=!1;[].keys&&(a_=[].keys(),"next"in a_?(n_=kA(kA(a_)),n_!==Object.prototype&&(Ro=n_)):G2=!0);I9=Ro==null||k9(function(){var a={};return Ro[pS].call(a)!==a});I9?Ro={}:Ro=P9(Ro);D9(Ro[pS])||L9(Ro,pS,function(){return this});V2={IteratorPrototype:Ro,BUGGY_SAFARI_ITERATORS:G2},A9=nx,O9=jo,F9=A9?{}.toString:function(){return"[object "+O9(this)+"]"},R9=nx,N9=la.f,B9=ec,$9=Wi,z9=F9,H9=ai,DA=H9("toStringTag"),Gh=function(a,t,e,r){if(a){var n=e?a:a.prototype;$9(n,DA)||N9(n,DA,{configurable:!0,value:t}),r&&!R9&&B9(n,"toString",z9)}},Vh={},G9=V2.IteratorPrototype,V9=Lu,W9=ku,U9=Gh,j9=Vh,Y9=function(){return this},q9=function(a,t,e,r){var n=t+" Iterator";return a.prototype=V9(G9,{next:W9(+!r,e)}),U9(a,n,!1,!0),j9[n]=Y9,a},W2=nt,Z9=wi,K9=W2.String,X9=W2.TypeError,J9=function(a){if(typeof a=="object"||Z9(a))return a;throw X9("Can't set "+K9(a)+" as a prototype")},Q9=ir,eZ=Aa,tZ=J9,U2=Object.setPrototypeOf||("__proto__"in{}?(function(){var a=!1,t={},e;try{e=Q9(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(t,[]),a=t instanceof Array}catch(r){}return function(n,s){return eZ(n),tZ(s),a?e(n,s):n.__proto__=s,n}})():void 0),rZ=pt,iZ=Oa,nZ=R2,aZ=q9,sZ=n0,oZ=Gh,PA=a0,lZ=ai,LA=Vh,cZ=V2,uZ=nZ.PROPER,ab=cZ.BUGGY_SAFARI_ITERATORS,s_=lZ("iterator"),MA="keys",sb="values",IA="entries",dZ=function(){return this},fx=function(a,t,e,r,n,s,o){aZ(e,t,r);var l=function(E){if(E===n&&f)return f;if(!ab&&E in d)return d[E];switch(E){case MA:return function(){return new e(this,E)};case sb:return function(){return new e(this,E)};case IA:return function(){return new e(this,E)}}return function(){return new e(this)}},c=t+" Iterator",u=!1,d=a.prototype,h=d[s_]||d["@@iterator"]||n&&d[n],f=!ab&&h||l(n),m=t=="Array"&&d.entries||h,g,y,v;if(m&&(g=sZ(m.call(new a)),g!==Object.prototype&&g.next&&(oZ(g,c,!0,!0),LA[c]=dZ)),uZ&&n==sb&&h&&h.name!==sb&&(u=!0,f=function(){return iZ(h,this)}),n)if(y={values:l(sb),keys:s?f:l(MA),entries:l(IA)},o)for(v in y)(ab||u||!(v in d))&&PA(d,v,y[v]);else rZ({target:t,proto:!0,forced:ab||u},y);return o&&d[s_]!==f&&PA(d,s_,f,{name:n}),LA[t]=f,y},hZ=Uj.charAt,fZ=so,j2=Hh,pZ=fx,Y2="String Iterator",mZ=j2.set,gZ=j2.getterFor(Y2);pZ(String,"String",function(a){mZ(this,{type:Y2,string:fZ(a),index:0})},function(){var t=gZ(this),e=t.string,r=t.index,n;return r>=e.length?{value:void 0,done:!0}:(n=hZ(e,r),t.index+=n.length,{value:n,done:!1})});vZ=Oa,AA=Aa,yZ=cx,q2=function(a,t,e){var r,n;AA(a);try{if(r=yZ(a,"return"),!r){if(t==="throw")throw e;return e}r=vZ(r,a)}catch(s){n=!0,r=s}if(t==="throw")throw e;if(n)throw r;return AA(r),e},bZ=Aa,wZ=q2,EZ=function(a,t,e,r){try{return r?t(bZ(e)[0],e[1]):t(e)}catch(n){wZ(a,"throw",n)}},TZ=ai,CZ=Vh,_Z=TZ("iterator"),SZ=Array.prototype,Z2=function(a){return a!==void 0&&(CZ.Array===a||SZ[_Z]===a)},xZ=ir,kZ=rr,K2=wi,DZ=jo,PZ=ss,LZ=sx,X2=function(){},MZ=[],J2=PZ("Reflect","construct"),px=/^\s*(?:class|function)\b/,IZ=xZ(px.exec),AZ=!px.exec(X2),Dm=function(t){if(!K2(t))return!1;try{return J2(X2,MZ,t),!0}catch(e){return!1}},Q2=function(t){if(!K2(t))return!1;switch(DZ(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return AZ||!!IZ(px,LZ(t))}catch(e){return!0}};Q2.sham=!0;s0=!J2||kZ(function(){var a;return Dm(Dm.call)||!Dm(Object)||!Dm(function(){a=!0})||a})?Q2:Dm,OZ=e0,FZ=la,RZ=ku,Wh=function(a,t,e){var r=OZ(t);r in a?FZ.f(a,r,RZ(0,e)):a[r]=e},NZ=jo,OA=cx,BZ=Vh,$Z=ai,zZ=$Z("iterator"),o0=function(a){if(a!=null)return OA(a,zZ)||OA(a,"@@iterator")||BZ[NZ(a)]},HZ=nt,GZ=Oa,VZ=Ms,WZ=Aa,UZ=Qb,jZ=o0,YZ=HZ.TypeError,mx=function(a,t){var e=arguments.length<2?jZ(a):t;if(VZ(e))return WZ(GZ(e,a));throw YZ(UZ(a)+" is not iterable")},qZ=nt,ZZ=tc,KZ=Oa,XZ=oa,JZ=EZ,QZ=Z2,e7=s0,t7=Fa,FA=Wh,r7=mx,i7=o0,RA=qZ.Array,n7=function(t){var e=XZ(t),r=e7(this),n=arguments.length,s=n>1?arguments[1]:void 0,o=s!==void 0;o&&(s=ZZ(s,n>2?arguments[2]:void 0));var l=i7(e),c=0,u,d,h,f,m,g;if(l&&!(this==RA&&QZ(l)))for(f=r7(e,l),m=f.next,d=r?new this:[];!(h=KZ(m,f)).done;c++)g=o?JZ(f,s,[h.value,c],!0):h.value,FA(d,c,g);else for(u=t7(e),d=r?new this(u):RA(u);u>c;c++)g=o?s(e[c],c):e[c],FA(d,c,g);return d.length=c,d},a7=ai,eR=a7("iterator"),tR=!1;try{NA=0,o_={next:function(){return{done:!!NA++}},return:function(){tR=!0}},o_[eR]=function(){return this},Array.from(o_,function(){throw 2})}catch(a){}rR=function(a,t){if(!t&&!tR)return!1;var e=!1;try{var r={};r[eR]=function(){return{next:function(){return{done:e=!0}}}},a(r)}catch(n){}return e},s7=pt,o7=n7,l7=rR,c7=!l7(function(a){Array.from(a)});s7({target:"Array",stat:!0,forced:c7},{from:o7});u7=fr,d7=u7.Array.from,h7=d7,iR=h7;(function(a){a.exports=iR})(b2);rc=tt(b2.exports),nR={exports:{}},f7=Is,BA=Vh,aR=Hh;la.f;p7=fx,sR="Array Iterator",m7=aR.set,g7=aR.getterFor(sR);p7(Array,"Array",function(a,t){m7(this,{type:sR,target:f7(a),index:0,kind:t})},function(){var a=g7(this),t=a.target,e=a.kind,r=a.index++;return!t||r>=t.length?(a.target=void 0,{value:void 0,done:!0}):e=="keys"?{value:r,done:!1}:e=="values"?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");BA.Arguments=BA.Array;v7=o0,y7=v7,b7={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},w7=b7,E7=nt,T7=jo,C7=ec,$A=Vh,_7=ai,zA=_7("toStringTag");for(ob in w7)l_=E7[ob],lb=l_&&l_.prototype,lb&&T7(lb)!==zA&&C7(lb,zA,ob),$A[ob]=$A.Array;S7=y7,x7=S7,k7=x7,D7=k7,P7=D7,L7=P7;(function(a){a.exports=L7})(nR);oo=tt(nR.exports),oR={exports:{}},M7=xu,Mu=Array.isArray||function(t){return M7(t)=="Array"},gg={},I7=N2,A7=hx,O7=A7.concat("length","prototype");gg.f=Object.getOwnPropertyNames||function(t){return I7(t,O7)};gx={},F7=nt,HA=pg,R7=Fa,N7=Wh,B7=F7.Array,$7=Math.max,lR=function(a,t,e){for(var r=R7(a),n=HA(t,r),s=HA(e===void 0?r:e,r),o=B7($7(s-n,0)),l=0;n<s;n++,l++)N7(o,l,a[n]);return o.length=l,o},z7=xu,H7=Is,cR=gg.f,G7=lR,uR=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],V7=function(a){try{return cR(a)}catch(t){return G7(uR)}};gx.f=function(t){return uR&&z7(t)=="Window"?V7(t):cR(H7(t))};l0={};l0.f=Object.getOwnPropertySymbols;W7=ir,vg=W7([].slice),c0={},U7=ai;c0.f=U7;GA=fr,j7=Wi,Y7=c0,q7=la.f,ui=function(a){var t=GA.Symbol||(GA.Symbol={});j7(t,a)||q7(t,a,{value:Y7.f(a)})},Z7=nt,VA=Mu,K7=s0,X7=Ui,J7=ai,Q7=J7("species"),WA=Z7.Array,eK=function(a){var t;return VA(a)&&(t=a.constructor,K7(t)&&(t===WA||VA(t.prototype))?t=void 0:X7(t)&&(t=t[Q7],t===null&&(t=void 0))),t===void 0?WA:t},tK=eK,u0=function(a,t){return new(tK(a))(t===0?0:t)},rK=tc,iK=ir,nK=r0,aK=oa,sK=Fa,oK=u0,UA=iK([].push),zl=function(a){var t=a==1,e=a==2,r=a==3,n=a==4,s=a==6,o=a==7,l=a==5||s;return function(c,u,d,h){for(var f=aK(c),m=nK(f),g=rK(u,d),y=sK(m),v=0,E=h||oK,C=t?E(c,y):e||o?E(c,0):void 0,_,x;y>v;v++)if((l||v in m)&&(_=m[v],x=g(_,v,f),a))if(t)C[v]=x;else if(x)switch(a){case 3:return!0;case 5:return _;case 6:return v;case 2:UA(C,_)}else switch(a){case 4:return!1;case 7:UA(C,_)}return s?-1:r||n?n:C}},Yo={forEach:zl(0),map:zl(1),filter:zl(2),some:zl(3),every:zl(4),find:zl(5),findIndex:zl(6),filterReject:zl(7)},Uh=pt,vx=nt,lK=ss,cK=Du,yg=Oa,uK=ir,Lh=ji,yu=ix,yx=rr,vi=Wi,dK=Mu,hK=wi,fK=Ui,pK=Tr,mS=lx,gS=Aa,mK=oa,d0=Is,bx=e0,dR=so,vS=ku,Um=Lu,hR=mg,gK=gg,fR=gx,yS=l0,pR=Pu,mR=la,vK=i0,gR=hg,yK=vg,bS=a0,bg=Xb.exports,bK=t0,vR=dg,jA=Jb,yR=ai,wK=c0,EK=ui,TK=Gh,bR=Hh,h0=Yo.forEach,ia=bK("hidden"),f0="Symbol",jm="prototype",YA=yR("toPrimitive"),CK=bR.set,qA=bR.getterFor(f0),ks=Object[jm],No=vx.Symbol,Ul=No&&No[jm],wR=vx.TypeError,c_=vx.QObject,Pm=lK("JSON","stringify"),ER=pR.f,Wl=mR.f,TR=fR.f,_K=gR.f,CR=uK([].push),Ho=bg("symbols"),wg=bg("op-symbols"),u_=bg("string-to-symbol-registry"),d_=bg("symbol-to-string-registry"),SK=bg("wks"),wS=!c_||!c_[jm]||!c_[jm].findChild,ES=Lh&&yx(function(){return Um(Wl({},"a",{get:function(){return Wl(this,"a",{value:7}).a}})).a!=7})?function(a,t,e){var r=ER(ks,t);r&&delete ks[t],Wl(a,t,e),r&&a!==ks&&Wl(ks,t,r)}:Wl,h_=function(a,t){var e=Ho[a]=Um(Ul);return CK(e,{type:f0,tag:a,description:t}),Lh||(e.description=t),e},p0=function(t,e,r){t===ks&&p0(wg,e,r),gS(t);var n=bx(e);return gS(r),vi(Ho,n)?(r.enumerable?(vi(t,ia)&&t[ia][n]&&(t[ia][n]=!1),r=Um(r,{enumerable:vS(0,!1)})):(vi(t,ia)||Wl(t,ia,vS(1,{})),t[ia][n]=!0),ES(t,n,r)):Wl(t,n,r)},wx=function(t,e){gS(t);var r=d0(e),n=hR(r).concat(Ex(r));return h0(n,function(s){(!Lh||yg(_R,r,s))&&p0(t,s,r[s])}),t},xK=function(t,e){return e===void 0?Um(t):wx(Um(t),e)},_R=function(t){var e=bx(t),r=yg(_K,this,e);return this===ks&&vi(Ho,e)&&!vi(wg,e)?!1:r||!vi(this,e)||!vi(Ho,e)||vi(this,ia)&&this[ia][e]?r:!0},SR=function(t,e){var r=d0(t),n=bx(e);if(!(r===ks&&vi(Ho,n)&&!vi(wg,n))){var s=ER(r,n);return s&&vi(Ho,n)&&!(vi(r,ia)&&r[ia][n])&&(s.enumerable=!0),s}},xR=function(t){var e=TR(d0(t)),r=[];return h0(e,function(n){!vi(Ho,n)&&!vi(vR,n)&&CR(r,n)}),r},Ex=function(t){var e=t===ks,r=TR(e?wg:d0(t)),n=[];return h0(r,function(s){vi(Ho,s)&&(!e||vi(ks,s))&&CR(n,Ho[s])}),n};yu||(No=function(){if(pK(Ul,this))throw wR("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:dR(arguments[0]),e=jA(t),r=function(n){this===ks&&yg(r,wg,n),vi(this,ia)&&vi(this[ia],e)&&(this[ia][e]=!1),ES(this,e,vS(1,n))};return Lh&&wS&&ES(ks,e,{configurable:!0,set:r}),h_(e,t)},Ul=No[jm],bS(Ul,"toString",function(){return qA(this).tag}),bS(No,"withoutSetter",function(a){return h_(jA(a),a)}),gR.f=_R,mR.f=p0,vK.f=wx,pR.f=SR,gK.f=fR.f=xR,yS.f=Ex,wK.f=function(a){return h_(yR(a),a)},Lh&&Wl(Ul,"description",{configurable:!0,get:function(){return qA(this).description}}));Uh({global:!0,wrap:!0,forced:!yu,sham:!yu},{Symbol:No});h0(hR(SK),function(a){EK(a)});Uh({target:f0,stat:!0,forced:!yu},{for:function(a){var t=dR(a);if(vi(u_,t))return u_[t];var e=No(t);return u_[t]=e,d_[e]=t,e},keyFor:function(t){if(!mS(t))throw wR(t+" is not a symbol");if(vi(d_,t))return d_[t]},useSetter:function(){wS=!0},useSimple:function(){wS=!1}});Uh({target:"Object",stat:!0,forced:!yu,sham:!Lh},{create:xK,defineProperty:p0,defineProperties:wx,getOwnPropertyDescriptor:SR});Uh({target:"Object",stat:!0,forced:!yu},{getOwnPropertyNames:xR,getOwnPropertySymbols:Ex});Uh({target:"Object",stat:!0,forced:yx(function(){yS.f(1)})},{getOwnPropertySymbols:function(t){return yS.f(mK(t))}});Pm&&(ZA=!yu||yx(function(){var a=No();return Pm([a])!="[null]"||Pm({a})!="{}"||Pm(Object(a))!="{}"}),Uh({target:"JSON",stat:!0,forced:ZA},{stringify:function(t,e,r){var n=yK(arguments),s=e;if(!(!fK(e)&&t===void 0||mS(t)))return dK(e)||(e=function(o,l){if(hK(s)&&(l=yg(s,this,o,l)),!mS(l))return l}),n[1]=e,cK(Pm,null,n)}}));Ul[YA]||(KA=Ul.valueOf,bS(Ul,YA,function(a){return yg(KA,this)}));TK(No,f0);vR[ia]=!0;kK=fr,DK=kK.Object.getOwnPropertySymbols,PK=DK,LK=PK;(function(a){a.exports=LK})(oR);Mh=tt(oR.exports),kR={exports:{}},DR={exports:{}},MK=pt,IK=rr,AK=Is,PR=Pu.f,LR=ji,OK=IK(function(){PR(1)}),FK=!LR||OK;MK({target:"Object",stat:!0,forced:FK,sham:!LR},{getOwnPropertyDescriptor:function(t,e){return PR(AK(t),e)}});RK=fr,MR=RK.Object,NK=DR.exports=function(t,e){return MR.getOwnPropertyDescriptor(t,e)};MR.getOwnPropertyDescriptor.sham&&(NK.sham=!0);BK=DR.exports,$K=BK;(function(a){a.exports=$K})(kR);jh=tt(kR.exports),IR={exports:{}},zK=ss,HK=ir,GK=gg,VK=l0,WK=Aa,UK=HK([].concat),Tx=zK("Reflect","ownKeys")||function(t){var e=GK.f(WK(t)),r=VK.f;return r?UK(e,r(t)):e},jK=pt,YK=ji,qK=Tx,ZK=Is,KK=Pu,XK=Wh;jK({target:"Object",stat:!0,sham:!YK},{getOwnPropertyDescriptors:function(t){for(var e=ZK(t),r=KK.f,n=qK(e),s={},o=0,l,c;n.length>o;)c=r(e,l=n[o++]),c!==void 0&&XK(s,l,c);return s}});JK=fr,QK=JK.Object.getOwnPropertyDescriptors,eX=QK,tX=eX;(function(a){a.exports=tX})(IR);Ih=tt(IR.exports),AR={exports:{}},OR={exports:{}},rX=pt,iX=ji,XA=i0.f;rX({target:"Object",stat:!0,forced:Object.defineProperties!==XA,sham:!iX},{defineProperties:XA});nX=fr,FR=nX.Object,aX=OR.exports=function(t,e){return FR.defineProperties(t,e)};FR.defineProperties.sham&&(aX.sham=!0);sX=OR.exports,oX=sX;(function(a){a.exports=oX})(AR);Cx=tt(AR.exports),RR={exports:{}},NR={exports:{}},lX=pt,cX=ji,JA=la.f;lX({target:"Object",stat:!0,forced:Object.defineProperty!==JA,sham:!cX},{defineProperty:JA});uX=fr,BR=uX.Object,dX=NR.exports=function(t,e,r){return BR.defineProperty(t,e,r)};BR.defineProperty.sham&&(dX.sham=!0);hX=NR.exports,$R=hX;(function(a){a.exports=$R})(RR);Eg=tt(RR.exports);_x={exports:{}},fX=$R,pX=fX,mX=pX,gX=mX;(function(a){a.exports=gX})(_x);m0=tt(_x.exports);zR={exports:{}},vX=pt,yX=Mu;vX({target:"Array",stat:!0},{isArray:yX});bX=fr,wX=bX.Array.isArray,EX=wX,HR=EX,TX=HR,CX=TX,_X=CX,SX=_X;(function(a){a.exports=SX})(zR);GR=tt(zR.exports);g0={exports:{}},kX=rr,DX=ai,PX=zh,LX=DX("species"),Tg=function(a){return PX>=51||!kX(function(){var t=[],e=t.constructor={};return e[LX]=function(){return{foo:1}},t[a](Boolean).foo!==1})},MX=pt,IX=nt,AX=rr,OX=Mu,FX=Ui,RX=oa,NX=Fa,eO=Wh,BX=u0,$X=Tg,zX=ai,HX=zh,VR=zX("isConcatSpreadable"),tO=9007199254740991,rO="Maximum allowed index exceeded",iO=IX.TypeError,GX=HX>=51||!AX(function(){var a=[];return a[VR]=!1,a.concat()[0]!==a}),VX=$X("concat"),WX=function(a){if(!FX(a))return!1;var t=a[VR];return t!==void 0?!!t:OX(a)},UX=!GX||!VX;MX({target:"Array",proto:!0,forced:UX},{concat:function(t){var e=RX(this),r=BX(e,0),n=0,s,o,l,c,u;for(s=-1,l=arguments.length;s<l;s++)if(u=s===-1?e:arguments[s],WX(u)){if(c=NX(u),n+c>tO)throw iO(rO);for(o=0;o<c;o++,n++)o in u&&eO(r,n,u[o])}else{if(n>=tO)throw iO(rO);eO(r,n++,u)}return r.length=n,r}});jX=ui;jX("asyncIterator");YX=ui;YX("hasInstance");qX=ui;qX("isConcatSpreadable");ZX=ui;ZX("iterator");KX=ui;KX("match");XX=ui;XX("matchAll");JX=ui;JX("replace");QX=ui;QX("search");eJ=ui;eJ("species");tJ=ui;tJ("split");rJ=ui;rJ("toPrimitive");iJ=ui;iJ("toStringTag");nJ=ui;nJ("unscopables");aJ=nt,sJ=Gh;sJ(aJ.JSON,"JSON",!0);oJ=fr,lJ=oJ.Symbol,cJ=lJ,WR=cJ,uJ=WR,dJ=uJ,hJ=ui;hJ("asyncDispose");fJ=ui;fJ("dispose");pJ=ui;pJ("matcher");mJ=ui;mJ("metadata");gJ=ui;gJ("observable");vJ=ui;vJ("patternMatch");yJ=ui;yJ("replaceAll");bJ=dJ,wJ=bJ;(function(a){a.exports=wJ})(g0);Th=tt(g0.exports);Sx={exports:{}},TJ=pt,CJ=nt,nO=Mu,_J=s0,SJ=Ui,aO=pg,xJ=Fa,kJ=Is,DJ=Wh,PJ=ai,LJ=Tg,MJ=vg,IJ=LJ("slice"),AJ=PJ("species"),f_=CJ.Array,OJ=Math.max;TJ({target:"Array",proto:!0,forced:!IJ},{slice:function(t,e){var r=kJ(this),n=xJ(r),s=aO(t,n),o=aO(e===void 0?n:e,n),l,c,u;if(nO(r)&&(l=r.constructor,_J(l)&&(l===f_||nO(l.prototype))?l=void 0:SJ(l)&&(l=l[AJ],l===null&&(l=void 0)),l===f_||l===void 0))return MJ(r,s,o);for(c=new(l===void 0?f_:l)(OJ(o-s,0)),u=0;s<o;s++,u++)s in r&&DJ(c,u,r[s]);return c.length=u,c}});FJ=fr,jr=function(a){return FJ[a+"Prototype"]},RJ=jr,NJ=RJ("Array").slice,BJ=Tr,$J=NJ,p_=Array.prototype,zJ=function(a){var t=a.slice;return a===p_||BJ(p_,a)&&t===p_.slice?$J:t},HJ=zJ,UR=HJ,GJ=UR,VJ=GJ,WJ=VJ,UJ=WJ;(function(a){a.exports=UJ})(Sx);jJ=tt(Sx.exports),jR={exports:{}},YJ=iR,qJ=YJ,ZJ=qJ,KJ=ZJ;(function(a){a.exports=KJ})(jR);YR=tt(jR.exports);xx={exports:{}},JJ=c0,QJ=JJ.f("iterator"),eQ=QJ,ZR=eQ,tQ=ZR,rQ=tQ,iQ=rQ,nQ=iQ;(function(a){a.exports=nQ})(xx);aQ=tt(xx.exports);KR={exports:{}};(function(a){a.exports=WR})(KR);qo=tt(KR.exports),XR={exports:{}},cQ=jr,uQ=cQ("Array").concat,dQ=Tr,hQ=uQ,m_=Array.prototype,fQ=function(a){var t=a.concat;return a===m_||dQ(m_,a)&&t===m_.concat?hQ:t},pQ=fQ,mQ=pQ;(function(a){a.exports=mQ})(XR);Ir=tt(XR.exports),JR={exports:{}};(function(a){a.exports=UR})(JR);En=tt(JR.exports),QR={exports:{}},gQ=pt,vQ=Tx;gQ({target:"Reflect",stat:!0},{ownKeys:vQ});yQ=fr,bQ=yQ.Reflect.ownKeys,wQ=bQ,EQ=wQ;(function(a){a.exports=EQ})(QR);eN=tt(QR.exports),tN={exports:{}};(function(a){a.exports=HR})(tN);Tt=tt(tN.exports),rN={exports:{}},TQ=pt,CQ=Yo.map,_Q=Tg,SQ=_Q("map");TQ({target:"Array",proto:!0,forced:!SQ},{map:function(t){return CQ(this,t,arguments.length>1?arguments[1]:void 0)}});xQ=jr,kQ=xQ("Array").map,DQ=Tr,PQ=kQ,g_=Array.prototype,LQ=function(a){var t=a.map;return a===g_||DQ(g_,a)&&t===g_.map?PQ:t},MQ=LQ,IQ=MQ;(function(a){a.exports=IQ})(rN);sr=tt(rN.exports),iN={exports:{}},AQ=pt,OQ=oa,nN=mg,FQ=rr,RQ=FQ(function(){nN(1)});AQ({target:"Object",stat:!0,forced:RQ},{keys:function(t){return nN(OQ(t))}});NQ=fr,BQ=NQ.Object.keys,$Q=BQ,zQ=$Q;(function(a){a.exports=zQ})(iN);bi=tt(iN.exports),aN={exports:{}},HQ=pt,GQ=nt,VQ=ir,sN=GQ.Date,WQ=VQ(sN.prototype.getTime);HQ({target:"Date",stat:!0},{now:function(){return WQ(new sN)}});UQ=fr,jQ=UQ.Date.now,YQ=jQ,qQ=YQ;(function(a){a.exports=qQ})(aN);Pa=tt(aN.exports),oN={exports:{}},ZQ=nt,lN=ir,KQ=Ms,XQ=Ui,JQ=Wi,sO=vg,QQ=cg,cN=ZQ.Function,eee=lN([].concat),tee=lN([].join),v_={},ree=function(a,t,e){if(!JQ(v_,t)){for(var r=[],n=0;n<t;n++)r[n]="a["+n+"]";v_[t]=cN("C,a","return new C("+tee(r,",")+")")}return v_[t](a,e)},uN=QQ?cN.bind:function(t){var e=KQ(this),r=e.prototype,n=sO(arguments,1),s=function(){var l=eee(n,sO(arguments));return this instanceof s?ree(e,l.length,l):e.apply(t,l)};return XQ(r)&&(s.prototype=r),s},iee=pt,oO=uN;iee({target:"Function",proto:!0,forced:Function.bind!==oO},{bind:oO});nee=jr,aee=nee("Function").bind,see=Tr,oee=aee,y_=Function.prototype,lee=function(a){var t=a.bind;return a===y_||see(y_,a)&&t===y_.bind?oee:t},cee=lee,dN=cee;(function(a){a.exports=dN})(oN);Oe=tt(oN.exports),hN={exports:{}},uee=rr,Yh=function(a,t){var e=[][a];return!!e&&uee(function(){e.call(null,t||function(){return 1},1)})},dee=Yo.forEach,hee=Yh,fee=hee("forEach"),pee=fee?[].forEach:function(t){return dee(this,t,arguments.length>1?arguments[1]:void 0)},mee=pt,lO=pee;mee({target:"Array",proto:!0,forced:[].forEach!=lO},{forEach:lO});gee=jr,vee=gee("Array").forEach,yee=vee,bee=yee,wee=jo,Eee=Wi,Tee=Tr,Cee=bee,b_=Array.prototype,_ee={DOMTokenList:!0,NodeList:!0},fN=function(a){var t=a.forEach;return a===b_||Tee(b_,a)&&t===b_.forEach||Eee(_ee,wee(a))?Cee:t};(function(a){a.exports=fN})(hN);Ue=tt(hN.exports),pN={exports:{}},See=pt,xee=ir,kee=Mu,Dee=xee([].reverse),cO=[1,2];See({target:"Array",proto:!0,forced:String(cO)===String(cO.reverse())},{reverse:function(){return kee(this)&&(this.length=this.length),Dee(this)}});Pee=jr,Lee=Pee("Array").reverse,Mee=Tr,Iee=Lee,w_=Array.prototype,Aee=function(a){var t=a.reverse;return a===w_||Mee(w_,a)&&t===w_.reverse?Iee:t},Oee=Aee,mN=Oee;(function(a){a.exports=mN})(pN);Fee=tt(pN.exports),gN={exports:{}},Ree=pt,Nee=nt,Bee=pg,$ee=ug,zee=Fa,Hee=oa,Gee=u0,Vee=Wh,Wee=Tg,Uee=Wee("splice"),jee=Nee.TypeError,Yee=Math.max,qee=Math.min,Zee=9007199254740991,Kee="Maximum allowed length exceeded";Ree({target:"Array",proto:!0,forced:!Uee},{splice:function(t,e){var r=Hee(this),n=zee(r),s=Bee(t,n),o=arguments.length,l,c,u,d,h,f;if(o===0?l=c=0:o===1?(l=0,c=n-s):(l=o-2,c=qee(Yee($ee(e),0),n-s)),n+l-c>Zee)throw jee(Kee);for(u=Gee(r,c),d=0;d<c;d++)h=s+d,h in r&&Vee(u,d,r[h]);if(u.length=c,l<c){for(d=s;d<n-c;d++)h=d+c,f=d+l,h in r?r[f]=r[h]:delete r[f];for(d=n;d>n-c+l;d--)delete r[d-1]}else if(l>c)for(d=n-c;d>s;d--)h=d+c-1,f=d+l-1,h in r?r[f]=r[h]:delete r[f];for(d=0;d<l;d++)r[d+s]=arguments[d+2];return r.length=n-c+l,u}});Xee=jr,Jee=Xee("Array").splice,Qee=Tr,ete=Jee,E_=Array.prototype,tte=function(a){var t=a.splice;return a===E_||Qee(E_,a)&&t===E_.splice?ete:t},rte=tte,ite=rte;(function(a){a.exports=ite})(gN);Bn=tt(gN.exports),vN={exports:{}},uO=ji,nte=ir,ate=Oa,ste=rr,T_=mg,ote=l0,lte=hg,cte=oa,ute=r0,ph=Object.assign,dO=Object.defineProperty,dte=nte([].concat),hte=!ph||ste(function(){if(uO&&ph({b:1},ph(dO({},"a",{enumerable:!0,get:function(){dO(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var a={},t={},e=Symbol(),r="abcdefghijklmnopqrst";return a[e]=7,r.split("").forEach(function(n){t[n]=n}),ph({},a)[e]!=7||T_(ph({},t)).join("")!=r})?function(t,e){for(var r=cte(t),n=arguments.length,s=1,o=ote.f,l=lte.f;n>s;)for(var c=ute(arguments[s++]),u=o?dte(T_(c),o(c)):T_(c),d=u.length,h=0,f;d>h;)f=u[h++],(!uO||ate(l,c,f))&&(r[f]=c[f]);return r}:ph,fte=pt,hO=hte;fte({target:"Object",stat:!0,forced:Object.assign!==hO},{assign:hO});pte=fr,mte=pte.Object.assign,gte=mte,vte=gte;(function(a){a.exports=vte})(vN);Go=tt(vN.exports),yN={exports:{}},yte=pt,bte=dx.includes;yte({target:"Array",proto:!0},{includes:function(t){return bte(this,t,arguments.length>1?arguments[1]:void 0)}});wte=jr,Ete=wte("Array").includes,Tte=Ui,Cte=xu,_te=ai,Ste=_te("match"),xte=function(a){var t;return Tte(a)&&((t=a[Ste])!==void 0?!!t:Cte(a)=="RegExp")},kte=nt,Dte=xte,Pte=kte.TypeError,Lte=function(a){if(Dte(a))throw Pte("The method doesn't accept regular expressions");return a},Mte=ai,Ite=Mte("match"),Ate=function(a){var t=/./;try{"/./"[a](t)}catch(e){try{return t[Ite]=!1,"/./"[a](t)}catch(r){}}return!1},Ote=pt,Fte=ir,Rte=Lte,Nte=$h,fO=so,Bte=Ate,$te=Fte("".indexOf);Ote({target:"String",proto:!0,forced:!Bte("includes")},{includes:function(t){return!!~$te(fO(Nte(this)),fO(Rte(t)),arguments.length>1?arguments[1]:void 0)}});zte=jr,Hte=zte("String").includes,pO=Tr,Gte=Ete,Vte=Hte,C_=Array.prototype,__=String.prototype,Wte=function(a){var t=a.includes;return a===C_||pO(C_,a)&&t===C_.includes?Gte:typeof a=="string"||a===__||pO(__,a)&&t===__.includes?Vte:t},Ute=Wte,jte=Ute;(function(a){a.exports=jte})(yN);Kl=tt(yN.exports),bN={exports:{}},Yte=pt,qte=rr,Zte=oa,wN=n0,Kte=H2,Xte=qte(function(){wN(1)});Yte({target:"Object",stat:!0,forced:Xte,sham:!Kte},{getPrototypeOf:function(t){return wN(Zte(t))}});Jte=fr,Qte=Jte.Object.getPrototypeOf,ere=Qte,EN=ere;(function(a){a.exports=EN})(bN);mO=tt(bN.exports),TN={exports:{}},tre=pt,rre=Yo.filter,ire=Tg,nre=ire("filter");tre({target:"Array",proto:!0,forced:!nre},{filter:function(t){return rre(this,t,arguments.length>1?arguments[1]:void 0)}});are=jr,sre=are("Array").filter,ore=Tr,lre=sre,S_=Array.prototype,cre=function(a){var t=a.filter;return a===S_||ore(S_,a)&&t===S_.filter?lre:t},ure=cre,dre=ure;(function(a){a.exports=dre})(TN);lt=tt(TN.exports),CN={exports:{}},hre=ji,_N=ir,fre=mg,pre=Is,mre=hg.f,gre=_N(mre),vre=_N([].push),gO=function(a){return function(t){for(var e=pre(t),r=fre(e),n=r.length,s=0,o=[],l;n>s;)l=r[s++],(!hre||gre(e,l))&&vre(o,a?[l,e[l]]:e[l]);return o}},yre={entries:gO(!0),values:gO(!1)},bre=pt,wre=yre.values;bre({target:"Object",stat:!0},{values:function(t){return wre(t)}});Ere=fr,Tre=Ere.Object.values,Cre=Tre,_re=Cre;(function(a){a.exports=_re})(CN);kx=tt(CN.exports),SN={exports:{}},v0=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,Sre=ir,xre=$h,kre=so,Dre=v0,vO=Sre("".replace),Ob="["+Dre+"]",Pre=RegExp("^"+Ob+Ob+"*"),Lre=RegExp(Ob+Ob+"*$"),x_=function(a){return function(t){var e=kre(xre(t));return a&1&&(e=vO(e,Pre,"")),a&2&&(e=vO(e,Lre,"")),e}},Dx={start:x_(1),end:x_(2),trim:x_(3)},xN=nt,Mre=rr,Ire=ir,Are=so,Ore=Dx.trim,yO=v0,Nm=xN.parseInt,bO=xN.Symbol,wO=bO&&bO.iterator,kN=/^[+-]?0x/i,Fre=Ire(kN.exec),Rre=Nm(yO+"08")!==8||Nm(yO+"0x16")!==22||wO&&!Mre(function(){Nm(Object(wO))}),Nre=Rre?function(t,e){var r=Ore(Are(t));return Nm(r,e>>>0||(Fre(kN,r)?16:10))}:Nm,Bre=pt,EO=Nre;Bre({global:!0,forced:parseInt!=EO},{parseInt:EO});$re=fr,zre=$re.parseInt,Hre=zre,Gre=Hre;(function(a){a.exports=Gre})(SN);La=tt(SN.exports),DN={exports:{}},Vre=pt,Wre=ir,Ure=dx.indexOf,jre=Yh,CS=Wre([].indexOf),TO=!!CS&&1/CS([1],1,-0)<0,Yre=jre("indexOf");Vre({target:"Array",proto:!0,forced:TO||!Yre},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return TO?CS(this,t,e)||0:Ure(this,t,e)}});qre=jr,Zre=qre("Array").indexOf,Kre=Tr,Xre=Zre,k_=Array.prototype,Jre=function(a){var t=a.indexOf;return a===k_||Kre(k_,a)&&t===k_.indexOf?Xre:t},Qre=Jre,eie=Qre;(function(a){a.exports=eie})(DN);Er=tt(DN.exports),PN={exports:{}},tie=R2.PROPER,rie=rr,CO=v0,_O="\u200B\x85\u180E",iie=function(a){return rie(function(){return!!CO[a]()||_O[a]()!==_O||tie&&CO[a].name!==a})},nie=pt,aie=Dx.trim,sie=iie;nie({target:"String",proto:!0,forced:sie("trim")},{trim:function(){return aie(this)}});oie=jr,lie=oie("String").trim,cie=Tr,uie=lie,D_=String.prototype,die=function(a){var t=a.trim;return typeof a=="string"||a===D_||cie(D_,a)&&t===D_.trim?uie:t},hie=die,fie=hie;(function(a){a.exports=fie})(PN);P_=tt(PN.exports),LN={exports:{}},pie=pt,mie=ji,gie=Lu;pie({target:"Object",stat:!0,sham:!mie},{create:gie});vie=fr,yie=vie.Object,bie=function(t,e){return yie.create(t,e)},wie=bie,MN=wie;(function(a){a.exports=MN})(LN);Cg=tt(LN.exports),IN={exports:{}},Eie=pt,Tie=nt,Cie=ss,_ie=Du,_g=ir,Sie=rr,xie=Tie.Array,Fb=Cie("JSON","stringify"),cb=_g(/./.exec),SO=_g("".charAt),kie=_g("".charCodeAt),Die=_g("".replace),Pie=_g(1 .toString),Lie=/[\uD800-\uDFFF]/g,xO=/^[\uD800-\uDBFF]$/,kO=/^[\uDC00-\uDFFF]$/,Mie=function(a,t,e){var r=SO(e,t-1),n=SO(e,t+1);return cb(xO,a)&&!cb(kO,n)||cb(kO,a)&&!cb(xO,r)?"\\u"+Pie(kie(a,0),16):a},Iie=Sie(function(){return Fb("\uDF06\uD834")!=='"\\udf06\\ud834"'||Fb("\uDEAD")!=='"\\udead"'});Fb&&Eie({target:"JSON",stat:!0,forced:Iie},{stringify:function(t,e,r){for(var n=0,s=arguments.length,o=xie(s);n<s;n++)o[n]=arguments[n];var l=_ie(Fb,null,o);return typeof l=="string"?Die(l,Lie,Mie):l}});_S=fr,Aie=Du;_S.JSON||(_S.JSON={stringify:JSON.stringify});Oie=function(t,e,r){return Aie(_S.JSON.stringify,null,arguments)},Fie=Oie,Rie=Fie;(function(a){a.exports=Rie})(IN);na=tt(IN.exports),AN={exports:{}},Nie=nt,Bie=Nie.TypeError,ON=function(a,t){if(a<t)throw Bie("Not enough arguments");return a},$ie=pt,SS=nt,zie=Du,Hie=wi,Gie=Ql,Vie=vg,Wie=ON,Uie=/MSIE .\./.test(Gie),jie=SS.Function,DO=function(a){return function(t,e){var r=Wie(arguments.length,1)>2,n=Hie(t)?t:jie(t),s=r?Vie(arguments,2):void 0;return a(r?function(){zie(n,this,s)}:n,e)}};$ie({global:!0,bind:!0,forced:Uie},{setTimeout:DO(SS.setTimeout),setInterval:DO(SS.setInterval)});Yie=fr,qie=Yie.setTimeout;(function(a){a.exports=qie})(AN);wn=tt(AN.exports),FN={exports:{}},Zie=oa,PO=pg,Kie=Fa,Xie=function(t){for(var e=Zie(this),r=Kie(e),n=arguments.length,s=PO(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,l=o===void 0?r:PO(o,r);l>s;)e[s++]=t;return e},Jie=pt,Qie=Xie;Jie({target:"Array",proto:!0},{fill:Qie});ene=jr,tne=ene("Array").fill,rne=Tr,ine=tne,L_=Array.prototype,nne=function(a){var t=a.fill;return a===L_||rne(L_,a)&&t===L_.fill?ine:t},ane=nne,sne=ane;(function(a){a.exports=sne})(FN);RN=tt(FN.exports),NN={exports:{}};(function(a){a.exports=t;function t(r){if(r)return e(r)}function e(r){for(var n in t.prototype)r[n]=t.prototype[n];return r}t.prototype.on=t.prototype.addEventListener=function(r,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(n),this},t.prototype.once=function(r,n){function s(){this.off(r,s),n.apply(this,arguments)}return s.fn=n,this.on(r,s),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(r,n){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+r];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var o,l=0;l<s.length;l++)if(o=s[l],o===n||o.fn===n){s.splice(l,1);break}return s.length===0&&delete this._callbacks["$"+r],this},t.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var n=new Array(arguments.length-1),s=this._callbacks["$"+r],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(s){s=s.slice(0);for(var o=0,l=s.length;o<l;++o)s[o].apply(this,n)}return this},t.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]},t.prototype.hasListeners=function(r){return!!this.listeners(r).length}})(NN);Px=NN.exports;typeof Object.assign!="function"?xS=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(n!=null)for(var s in n)n.hasOwnProperty(s)&&(e[s]=n[s])}return e}:xS=Object.assign;bu=xS,LO=["","webkit","Moz","MS","ms","o"],one=typeof document=="undefined"?{style:{}}:document.createElement("div"),lne="function",Ch=Math.round,wu=Math.abs,Lx=Date.now;typeof window=="undefined"?Bo={}:Bo=window;BN=y0(one.style,"touchAction"),$N=BN!==void 0;zN="compute",HN="auto",kS="manipulation",fu="none",Ym="pan-x",qm="pan-y",db=cne(),une=/mobile|tablet|ip(ad|hone|od)|android/i,GN="ontouchstart"in Bo,dne=y0(Bo,"PointerEvent")!==void 0,hne=GN&&une.test(navigator.userAgent),Sg="touch",fne="pen",Mx="mouse",pne="kinect",mne=25,zn=1,Iu=2,yi=4,aa=8,Rb=1,xg=2,kg=4,Dg=8,Ah=16,no=xg|kg,pu=Dg|Ah,VN=no|pu,WN=["x","y"],Nb=["clientX","clientY"];UN=(function(){function a(e,r){this.manager=e,this.set(r)}var t=a.prototype;return t.set=function(r){r===zN&&(r=this.compute()),$N&&this.manager.element.style&&db[r]&&(this.manager.element.style[BN]=r),this.actions=r.toLowerCase().trim()},t.update=function(){this.set(this.manager.options.touchAction)},t.compute=function(){var r=[];return $o(this.manager.recognizers,function(n){b0(n.options.enable,[n])&&(r=r.concat(n.getTouchAction()))}),gne(r.join(" "))},t.preventDefaults=function(r){var n=r.srcEvent,s=r.offsetDirection;if(this.manager.session.prevented){n.preventDefault();return}var o=this.actions,l=du(o,fu)&&!db[fu],c=du(o,qm)&&!db[qm],u=du(o,Ym)&&!db[Ym];if(l){var d=r.pointers.length===1,h=r.distance<2,f=r.deltaTime<250;if(d&&h&&f)return}if(!(u&&c)&&(l||c&&s&no||u&&s&pu))return this.preventSrc(n)},t.preventSrc=function(r){this.manager.session.prevented=!0,r.preventDefault()},a})();qh=(function(){function a(e,r){var n=this;this.manager=e,this.callback=r,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(s){b0(e.options.enable,[e])&&n.handler(s)},this.init()}var t=a.prototype;return t.handler=function(){},t.init=function(){this.evEl&&Bm(this.element,this.evEl,this.domHandler),this.evTarget&&Bm(this.target,this.evTarget,this.domHandler),this.evWin&&Bm(IO(this.element),this.evWin,this.domHandler)},t.destroy=function(){this.evEl&&$m(this.element,this.evEl,this.domHandler),this.evTarget&&$m(this.target,this.evTarget,this.domHandler),this.evWin&&$m(IO(this.element),this.evWin,this.domHandler)},a})();Cne={pointerdown:zn,pointermove:Iu,pointerup:yi,pointercancel:aa,pointerout:aa},_ne={2:Sg,3:fne,4:Mx,5:pne},ZN="pointerdown",KN="pointermove pointerup pointercancel";Bo.MSPointerEvent&&!Bo.PointerEvent&&(ZN="MSPointerDown",KN="MSPointerMove MSPointerUp MSPointerCancel");XN=(function(a){os(t,a);function t(){var r,n=t.prototype;return n.evEl=ZN,n.evWin=KN,r=a.apply(this,arguments)||this,r.store=r.manager.session.pointerEvents=[],r}var e=t.prototype;return e.handler=function(n){var s=this.store,o=!1,l=n.type.toLowerCase().replace("ms",""),c=Cne[l],u=_ne[n.pointerType]||n.pointerType,d=u===Sg,h=Eu(s,n.pointerId,"pointerId");c&zn&&(n.button===0||d)?h<0&&(s.push(n),h=s.length-1):c&(yi|aa)&&(o=!0),!(h<0)&&(s[h]=n,this.callback(this.manager,c,{pointers:s,changedPointers:[n],pointerType:u,srcEvent:n}),o&&s.splice(h,1))},t})(qh);Sne={touchstart:zn,touchmove:Iu,touchend:yi,touchcancel:aa},xne="touchstart touchmove touchend touchcancel",Ox=(function(a){os(t,a);function t(){var r;return t.prototype.evTarget=xne,r=a.apply(this,arguments)||this,r.targetIds={},r}var e=t.prototype;return e.handler=function(n){var s=Sne[n.type],o=kne.call(this,n,s);o&&this.callback(this.manager,s,{pointers:o[0],changedPointers:o[1],pointerType:Sg,srcEvent:n})},t})(qh);Dne={mousedown:zn,mousemove:Iu,mouseup:yi},Pne="mousedown",Lne="mousemove mouseup",Fx=(function(a){os(t,a);function t(){var r,n=t.prototype;return n.evEl=Pne,n.evWin=Lne,r=a.apply(this,arguments)||this,r.pressed=!1,r}var e=t.prototype;return e.handler=function(n){var s=Dne[n.type];s&zn&&n.button===0&&(this.pressed=!0),s&Iu&&n.which!==1&&(s=yi),this.pressed&&(s&yi&&(this.pressed=!1),this.callback(this.manager,s,{pointers:[n],changedPointers:[n],pointerType:Mx,srcEvent:n}))},t})(qh),Mne=2500,AO=25;JN=(function(){var a=(function(t){os(e,t);function e(n,s){var o;return o=t.call(this,n,s)||this,o.handler=function(l,c,u){var d=u.pointerType===Sg,h=u.pointerType===Mx;if(!(h&&u.sourceCapabilities&&u.sourceCapabilities.firesTouchEvents)){if(d)Ine.call(ub(ub(o)),c,u);else if(h&&Ane.call(ub(ub(o)),u))return;o.callback(l,c,u)}},o.touch=new Ox(o.manager,o.handler),o.mouse=new Fx(o.manager,o.handler),o.primaryTouch=null,o.lastTouches=[],o}var r=e.prototype;return r.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e})(qh);return a})();_b=1,is=2,Oh=4,ql=8,zo=ql,Xm=16,ro=32,Fne=1;Pg=(function(){function a(e){e===void 0&&(e={}),this.options=Ps({enable:!0},e),this.id=Rne(),this.manager=null,this.state=_b,this.simultaneous={},this.requireFail=[]}var t=a.prototype;return t.set=function(r){return bu(this.options,r),this.manager&&this.manager.touchAction.update(),this},t.recognizeWith=function(r){if(_h(r,"recognizeWith",this))return this;var n=this.simultaneous;return r=hb(r,this),n[r.id]||(n[r.id]=r,r.recognizeWith(this)),this},t.dropRecognizeWith=function(r){return _h(r,"dropRecognizeWith",this)?this:(r=hb(r,this),delete this.simultaneous[r.id],this)},t.requireFailure=function(r){if(_h(r,"requireFailure",this))return this;var n=this.requireFail;return r=hb(r,this),Eu(n,r)===-1&&(n.push(r),r.requireFailure(this)),this},t.dropRequireFailure=function(r){if(_h(r,"dropRequireFailure",this))return this;r=hb(r,this);var n=Eu(this.requireFail,r);return n>-1&&this.requireFail.splice(n,1),this},t.hasRequireFailures=function(){return this.requireFail.length>0},t.canRecognizeWith=function(r){return!!this.simultaneous[r.id]},t.emit=function(r){var n=this,s=this.state;function o(l){n.manager.emit(l,r)}s<ql&&o(n.options.event+FO(s)),o(n.options.event),r.additionalEvent&&o(r.additionalEvent),s>=ql&&o(n.options.event+FO(s))},t.tryEmit=function(r){if(this.canEmit())return this.emit(r);this.state=ro},t.canEmit=function(){for(var r=0;r<this.requireFail.length;){if(!(this.requireFail[r].state&(ro|_b)))return!1;r++}return!0},t.recognize=function(r){var n=bu({},r);if(!b0(this.options.enable,[this,n])){this.reset(),this.state=ro;return}this.state&(zo|Xm|ro)&&(this.state=_b),this.state=this.process(n),this.state&(is|Oh|ql|Xm)&&this.tryEmit(n)},t.process=function(r){},t.getTouchAction=function(){},t.reset=function(){},a})(),PS=(function(a){os(t,a);function t(r){var n;return r===void 0&&(r={}),n=a.call(this,Ps({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},r))||this,n.pTime=!1,n.pCenter=!1,n._timer=null,n._input=null,n.count=0,n}var e=t.prototype;return e.getTouchAction=function(){return[kS]},e.process=function(n){var s=this,o=this.options,l=n.pointers.length===o.pointers,c=n.distance<o.threshold,u=n.deltaTime<o.time;if(this.reset(),n.eventType&zn&&this.count===0)return this.failTimeout();if(c&&u&&l){if(n.eventType!==yi)return this.failTimeout();var d=this.pTime?n.timeStamp-this.pTime<o.interval:!0,h=!this.pCenter||Bb(this.pCenter,n.center)<o.posThreshold;this.pTime=n.timeStamp,this.pCenter=n.center,!h||!d?this.count=1:this.count+=1,this._input=n;var f=this.count%o.taps;if(f===0)return this.hasRequireFailures()?(this._timer=setTimeout(function(){s.state=zo,s.tryEmit()},o.interval),is):zo}return ro},e.failTimeout=function(){var n=this;return this._timer=setTimeout(function(){n.state=ro},this.options.interval),ro},e.reset=function(){clearTimeout(this._timer)},e.emit=function(){this.state===zo&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},t})(Pg),Fh=(function(a){os(t,a);function t(r){return r===void 0&&(r={}),a.call(this,Ps({pointers:1},r))||this}var e=t.prototype;return e.attrTest=function(n){var s=this.options.pointers;return s===0||n.pointers.length===s},e.process=function(n){var s=this.state,o=n.eventType,l=s&(is|Oh),c=this.attrTest(n);return l&&(o&aa||!c)?s|Xm:l||c?o&yi?s|ql:s&is?s|Oh:is:ro},t})(Pg);Rx=(function(a){os(t,a);function t(r){var n;return r===void 0&&(r={}),n=a.call(this,Ps({event:"pan",threshold:10,pointers:1,direction:VN},r))||this,n.pX=null,n.pY=null,n}var e=t.prototype;return e.getTouchAction=function(){var n=this.options.direction,s=[];return n&no&&s.push(qm),n&pu&&s.push(Ym),s},e.directionTest=function(n){var s=this.options,o=!0,l=n.distance,c=n.direction,u=n.deltaX,d=n.deltaY;return c&s.direction||(s.direction&no?(c=u===0?Rb:u<0?xg:kg,o=u!==this.pX,l=Math.abs(n.deltaX)):(c=d===0?Rb:d<0?Dg:Ah,o=d!==this.pY,l=Math.abs(n.deltaY))),n.direction=c,o&&l>s.threshold&&c&s.direction},e.attrTest=function(n){return Fh.prototype.attrTest.call(this,n)&&(this.state&is||!(this.state&is)&&this.directionTest(n))},e.emit=function(n){this.pX=n.deltaX,this.pY=n.deltaY;var s=QN(n.direction);s&&(n.additionalEvent=this.options.event+s),a.prototype.emit.call(this,n)},t})(Fh),eB=(function(a){os(t,a);function t(r){return r===void 0&&(r={}),a.call(this,Ps({event:"swipe",threshold:10,velocity:.3,direction:no|pu,pointers:1},r))||this}var e=t.prototype;return e.getTouchAction=function(){return Rx.prototype.getTouchAction.call(this)},e.attrTest=function(n){var s=this.options.direction,o;return s&(no|pu)?o=n.overallVelocity:s&no?o=n.overallVelocityX:s&pu&&(o=n.overallVelocityY),a.prototype.attrTest.call(this,n)&&s&n.offsetDirection&&n.distance>this.options.threshold&&n.maxPointers===this.options.pointers&&wu(o)>this.options.velocity&&n.eventType&yi},e.emit=function(n){var s=QN(n.offsetDirection);s&&this.manager.emit(this.options.event+s,n),this.manager.emit(this.options.event,n)},t})(Fh),tB=(function(a){os(t,a);function t(r){return r===void 0&&(r={}),a.call(this,Ps({event:"pinch",threshold:0,pointers:2},r))||this}var e=t.prototype;return e.getTouchAction=function(){return[fu]},e.attrTest=function(n){return a.prototype.attrTest.call(this,n)&&(Math.abs(n.scale-1)>this.options.threshold||this.state&is)},e.emit=function(n){if(n.scale!==1){var s=n.scale<1?"in":"out";n.additionalEvent=this.options.event+s}a.prototype.emit.call(this,n)},t})(Fh),rB=(function(a){os(t,a);function t(r){return r===void 0&&(r={}),a.call(this,Ps({event:"rotate",threshold:0,pointers:2},r))||this}var e=t.prototype;return e.getTouchAction=function(){return[fu]},e.attrTest=function(n){return a.prototype.attrTest.call(this,n)&&(Math.abs(n.rotation)>this.options.threshold||this.state&is)},t})(Fh),iB=(function(a){os(t,a);function t(r){var n;return r===void 0&&(r={}),n=a.call(this,Ps({event:"press",pointers:1,time:251,threshold:9},r))||this,n._timer=null,n._input=null,n}var e=t.prototype;return e.getTouchAction=function(){return[HN]},e.process=function(n){var s=this,o=this.options,l=n.pointers.length===o.pointers,c=n.distance<o.threshold,u=n.deltaTime>o.time;if(this._input=n,!c||!l||n.eventType&(yi|aa)&&!u)this.reset();else if(n.eventType&zn)this.reset(),this._timer=setTimeout(function(){s.state=zo,s.tryEmit()},o.time);else if(n.eventType&yi)return zo;return ro},e.reset=function(){clearTimeout(this._timer)},e.emit=function(n){this.state===zo&&(n&&n.eventType&yi?this.manager.emit(this.options.event+"up",n):(this._input.timeStamp=Lx(),this.manager.emit(this.options.event,this._input)))},t})(Pg),nB={domEvents:!1,touchAction:zN,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},RO=[[rB,{enable:!1}],[tB,{enable:!1},["rotate"]],[eB,{direction:no}],[Rx,{direction:no},["swipe"]],[PS],[PS,{event:"doubletap",taps:2},["tap"]],[iB]],Nne=1,NO=2;$O=(function(){function a(e,r){var n=this;this.options=bu({},nB,r||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=One(this),this.touchAction=new UN(this,this.options.touchAction),BO(this,!0),$o(this.options.recognizers,function(s){var o=n.add(new s[0](s[1]));s[2]&&o.recognizeWith(s[2]),s[3]&&o.requireFailure(s[3])},this)}var t=a.prototype;return t.set=function(r){return bu(this.options,r),r.touchAction&&this.touchAction.update(),r.inputTarget&&(this.input.destroy(),this.input.target=r.inputTarget,this.input.init()),this},t.stop=function(r){this.session.stopped=r?NO:Nne},t.recognize=function(r){var n=this.session;if(!n.stopped){this.touchAction.preventDefaults(r);var s,o=this.recognizers,l=n.curRecognizer;(!l||l&&l.state&zo)&&(n.curRecognizer=null,l=null);for(var c=0;c<o.length;)s=o[c],n.stopped!==NO&&(!l||s===l||s.canRecognizeWith(l))?s.recognize(r):s.reset(),!l&&s.state&(is|Oh|ql)&&(n.curRecognizer=s,l=s),c++}},t.get=function(r){if(r instanceof Pg)return r;for(var n=this.recognizers,s=0;s<n.length;s++)if(n[s].options.event===r)return n[s];return null},t.add=function(r){if(_h(r,"add",this))return this;var n=this.get(r.options.event);return n&&this.remove(n),this.recognizers.push(r),r.manager=this,this.touchAction.update(),r},t.remove=function(r){if(_h(r,"remove",this))return this;var n=this.get(r);if(r){var s=this.recognizers,o=Eu(s,n);o!==-1&&(s.splice(o,1),this.touchAction.update())}return this},t.on=function(r,n){if(r===void 0||n===void 0)return this;var s=this.handlers;return $o(Zm(r),function(o){s[o]=s[o]||[],s[o].push(n)}),this},t.off=function(r,n){if(r===void 0)return this;var s=this.handlers;return $o(Zm(r),function(o){n?s[o]&&s[o].splice(Eu(s[o],n),1):delete s[o]}),this},t.emit=function(r,n){this.options.domEvents&&Bne(r,n);var s=this.handlers[r]&&this.handlers[r].slice();if(!(!s||!s.length)){n.type=r,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var o=0;o<s.length;)s[o](n),o++}},t.destroy=function(){this.element&&BO(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},a})(),$ne={touchstart:zn,touchmove:Iu,touchend:yi,touchcancel:aa},zne="touchstart",Hne="touchstart touchmove touchend touchcancel",Gne=(function(a){os(t,a);function t(){var r,n=t.prototype;return n.evTarget=zne,n.evWin=Hne,r=a.apply(this,arguments)||this,r.started=!1,r}var e=t.prototype;return e.handler=function(n){var s=$ne[n.type];if(s===zn&&(this.started=!0),!!this.started){var o=Vne.call(this,n,s);s&(yi|aa)&&o[0].length-o[1].length===0&&(this.started=!1),this.callback(this.manager,s,{pointers:o[0],changedPointers:o[1],pointerType:Sg,srcEvent:n})}},t})(qh);sB=aB(function(a,t,e){for(var r=Object.keys(t),n=0;n<r.length;)(!e||e&&a[r[n]]===void 0)&&(a[r[n]]=t[r[n]]),n++;return a},"extend","Use `assign`."),Wne=aB(function(a,t){return sB(a,t,!0)},"merge","Use `assign`.");Nx=(function(){var a=function(e,r){return r===void 0&&(r={}),new $O(e,Ps({recognizers:RO.concat()},r))};return a.VERSION="2.0.17-rc",a.DIRECTION_ALL=VN,a.DIRECTION_DOWN=Ah,a.DIRECTION_LEFT=xg,a.DIRECTION_RIGHT=kg,a.DIRECTION_UP=Dg,a.DIRECTION_HORIZONTAL=no,a.DIRECTION_VERTICAL=pu,a.DIRECTION_NONE=Rb,a.DIRECTION_DOWN=Ah,a.INPUT_START=zn,a.INPUT_MOVE=Iu,a.INPUT_END=yi,a.INPUT_CANCEL=aa,a.STATE_POSSIBLE=_b,a.STATE_BEGAN=is,a.STATE_CHANGED=Oh,a.STATE_ENDED=ql,a.STATE_RECOGNIZED=zo,a.STATE_CANCELLED=Xm,a.STATE_FAILED=ro,a.Manager=$O,a.Input=qh,a.TouchAction=UN,a.TouchInput=Ox,a.MouseInput=Fx,a.PointerEventInput=XN,a.TouchMouseInput=JN,a.SingleTouchInput=Gne,a.Recognizer=Pg,a.AttrRecognizer=Fh,a.Tap=PS,a.Pan=Rx,a.Swipe=eB,a.Pinch=tB,a.Rotate=rB,a.Press=iB,a.on=Bm,a.off=$m,a.each=$o,a.merge=Wne,a.extend=sB,a.bindFn=zO,a.assign=bu,a.inherit=Une,a.bindFn=zO,a.prefixed=y0,a.toArray=Km,a.inArray=Eu,a.uniqueArray=Ax,a.splitStr=Zm,a.boolOrFn=b0,a.hasParent=Ix,a.addEventListeners=Bm,a.removeEventListeners=$m,a.defaults=bu({},nB,{preset:RO}),a})();Nx.defaults;$x=qo("DELETE");Hx=typeof window!="undefined"?window.Hammer||Nx:function(){return Xne()};Px(io.prototype);io.current=null;io.prototype.destroy=function(){var a,t;this.deactivate();var e=Bx(Fee(a=Bn(t=this._cleanupQueue).call(t,0)).call(a)),r;try{for(e.s();!(r=e.n()).done;){var n=r.value;n()}}catch(s){e.e(s)}finally{e.f()}};io.prototype.activate=function(){io.current&&io.current.deactivate(),io.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)};io.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")};io.prototype._onTapOverlay=function(a){this.activate(),a.srcEvent.stopPropagation()};Qne=/^\/?Date\((-?\d+)/i,eae=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,tae=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,rae=/^rgb\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *\)$/i,iae=/^rgba\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *([01]|0?\.\d+) *\)$/i;aae=Go;gae=kx;_ae={asBoolean:function(t,e){return typeof t=="function"&&(t=t()),t!=null?t!=!1:e||null},asNumber:function(t,e){return typeof t=="function"&&(t=t()),t!=null?Number(t)||e||null:e||null},asString:function(t,e){return typeof t=="function"&&(t=t()),t!=null?String(t):e||null},asSize:function(t,e){return typeof t=="function"&&(t=t()),Ma(t)?t:zm(t)?t+"px":e||null},asElement:function(t,e){return typeof t=="function"&&(t=t()),t||e||null}};kh={split:function(t){var e,r={};return Ue(e=t.split(";")).call(e,function(n){if(P_(n).call(n)!=""){var s,o,l=n.split(":"),c=P_(s=l[0]).call(s),u=P_(o=l[1]).call(o);r[c]=u}}),r},join:function(t){var e;return sr(e=bi(t)).call(e,function(r){return r+": "+t[r]}).join("; ")}};Oae={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:-1+(4-2*t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}};Nae={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},mB=(function(){function a(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;Gt(this,a),this.pixelRatio=t,this.generated=!1,this.centerCoordinates={x:289/2,y:289/2},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return Vt(a,[{key:"insertTo",value:function(e){this.hammer!==void 0&&(this.hammer.destroy(),this.hammer=void 0),this.container=e,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(e){if(typeof e=="function")this.updateCallback=e;else throw new Error("Function attempted to set as colorPicker update callback is not a function.")}},{key:"setCloseCallback",value:function(e){if(typeof e=="function")this.closeCallback=e;else throw new Error("Function attempted to set as colorPicker closing callback is not a function.")}},{key:"_isColorString",value:function(e){if(typeof e=="string")return Nae[e]}},{key:"setColor",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e!=="none"){var n,s=this._isColorString(e);if(s!==void 0&&(e=s),Ma(e)===!0){if(Wx(e)===!0){var o=e.substr(4).substr(0,e.length-5).split(",");n={r:o[0],g:o[1],b:o[2],a:1}}else if(pB(e)===!0){var l=e.substr(5).substr(0,e.length-6).split(",");n={r:l[0],g:l[1],b:l[2],a:l[3]}}else if(Vx(e)===!0){var c=w0(e);n={r:c.r,g:c.g,b:c.b,a:1}}}else if(e instanceof Object&&e.r!==void 0&&e.g!==void 0&&e.b!==void 0){var u=e.a!==void 0?e.a:"1.0";n={r:e.r,g:e.g,b:e.b,a:u}}if(n===void 0)throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+na(e));this._setColor(n,r)}}},{key:"show",value:function(){this.closeCallback!==void 0&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r===!0&&(this.previousColor=Go({},this.color)),this.applied===!0&&this.updateCallback(this.initialColor),this.frame.style.display="none",wn(function(){e.closeCallback!==void 0&&(e.closeCallback(),e.closeCallback=void 0)},0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){this.previousColor!==void 0?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r===!0&&(this.initialColor=Go({},e)),this.color=e;var n=Sh(e.r,e.g,e.b),s=2*Math.PI,o=this.r*n.s,l=this.centerCoordinates.x+o*Math.sin(s*n.h),c=this.centerCoordinates.y+o*Math.cos(s*n.h);this.colorPickerSelector.style.left=l-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=c-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(e)}},{key:"_setOpacity",value:function(e){this.color.a=e/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(e){var r=Sh(this.color.r,this.color.g,this.color.b);r.v=e/100;var n=Hm(r.h,r.s,r.v);n.a=this.color.a,this.color=n,this._updatePicker()}},{key:"_updatePicker",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.color,r=Sh(e.r,e.g,e.b),n=this.colorPickerCanvas.getContext("2d");this.pixelRation===void 0&&(this.pixelRatio=(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1)),n.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var s=this.colorPickerCanvas.clientWidth,o=this.colorPickerCanvas.clientHeight;n.clearRect(0,0,s,o),n.putImageData(this.hueCircle,0,0),n.fillStyle="rgba(0,0,0,"+(1-r.v)+")",n.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),RN(n).call(n),this.brightnessRange.value=100*r.v,this.opacityRange.value=100*e.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){var e,r,n,s;if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var l=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var o=document.createElement("DIV");o.style.color="red",o.style.fontWeight="bold",o.style.padding="10px",o.innerText="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(o)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(u){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(u){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var c=this;this.opacityRange.onchange=function(){c._setOpacity(this.value)},this.opacityRange.oninput=function(){c._setOpacity(this.value)},this.brightnessRange.onchange=function(){c._setBrightness(this.value)},this.brightnessRange.oninput=function(){c._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerText="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerText="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerText="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerText="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerText="cancel",this.cancelButton.onclick=Oe(e=this._hide).call(e,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerText="apply",this.applyButton.onclick=Oe(r=this._apply).call(r,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerText="save",this.saveButton.onclick=Oe(n=this._save).call(n,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerText="load last",this.loadButton.onclick=Oe(s=this._loadLast).call(s,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var e=this;this.drag={},this.pinch={},this.hammer=new Hx(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("hammer.input",function(r){r.isFirst&&e._moveSelector(r)}),this.hammer.on("tap",function(r){e._moveSelector(r)}),this.hammer.on("panstart",function(r){e._moveSelector(r)}),this.hammer.on("panmove",function(r){e._moveSelector(r)}),this.hammer.on("panend",function(r){e._moveSelector(r)})}},{key:"_generateHueCircle",value:function(){if(this.generated===!1){var e=this.colorPickerCanvas.getContext("2d");this.pixelRation===void 0&&(this.pixelRatio=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)),e.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var r=this.colorPickerCanvas.clientWidth,n=this.colorPickerCanvas.clientHeight;e.clearRect(0,0,r,n);var s,o,l,c;this.centerCoordinates={x:r*.5,y:n*.5},this.r=.49*r;var u=2*Math.PI/360,d=1/360,h=1/this.r,f;for(l=0;l<360;l++)for(c=0;c<this.r;c++)s=this.centerCoordinates.x+c*Math.sin(u*l),o=this.centerCoordinates.y+c*Math.cos(u*l),f=Hm(l*d,c*h,1),e.fillStyle="rgb("+f.r+","+f.g+","+f.b+")",e.fillRect(s-.5,o-.5,2,2);e.strokeStyle="rgba(0,0,0,1)",e.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),e.stroke(),this.hueCircle=e.getImageData(0,0,r,n)}this.generated=!0}},{key:"_moveSelector",value:function(e){var r=this.colorPickerDiv.getBoundingClientRect(),n=e.center.x-r.left,s=e.center.y-r.top,o=.5*this.colorPickerDiv.clientHeight,l=.5*this.colorPickerDiv.clientWidth,c=n-l,u=s-o,d=Math.atan2(c,u),h=.98*Math.min(Math.sqrt(c*c+u*u),l),f=Math.cos(d)*h+o,m=Math.sin(d)*h+l;this.colorPickerSelector.style.top=f-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=m-.5*this.colorPickerSelector.clientWidth+"px";var g=d/(2*Math.PI);g=g<0?g+1:g;var y=h/this.r,v=Sh(this.color.r,this.color.g,this.color.b);v.h=g,v.s=y;var E=Hm(v.h,v.s,v.v);E.a=this.color.a,this.color=E,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),a})();Bae=(function(){function a(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:function(){return!1};Gt(this,a),this.parent=t,this.changedOptions=[],this.container=e,this.allowCreation=!1,this.hideOption=s,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},Go(this.options,this.defaultOptions),this.configureOptions=r,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new mB(n),this.wrapper=void 0}return Vt(a,[{key:"setOptions",value:function(e){if(e!==void 0){this.popupHistory={},this._removePopup();var r=!0;if(typeof e=="string")this.options.filter=e;else if(Tt(e))this.options.filter=e.join();else if(yt(e)==="object"){if(e==null)throw new TypeError("options cannot be null");e.container!==void 0&&(this.options.container=e.container),lt(e)!==void 0&&(this.options.filter=lt(e)),e.showButton!==void 0&&(this.options.showButton=e.showButton),e.enabled!==void 0&&(r=e.enabled)}else typeof e=="boolean"?(this.options.filter=!0,r=e):typeof e=="function"&&(this.options.filter=e,r=!0);lt(this.options)===!1&&(r=!1),this.options.enabled=r}this._clean()}},{key:"setModuleOptions",value:function(e){this.moduleOptions=e,this.options.enabled===!0&&(this._clean(),this.options.container!==void 0&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var e=lt(this.options),r=0,n=!1;for(var s in this.configureOptions)Object.prototype.hasOwnProperty.call(this.configureOptions,s)&&(this.allowCreation=!1,n=!1,typeof e=="function"?(n=e(s,[]),n=n||this._handleObject(this.configureOptions[s],[s],!0)):(e===!0||Er(e).call(e,s)!==-1)&&(n=!0),n!==!1&&(this.allowCreation=!0,r>0&&this._makeItem([]),this._makeHeader(s),this._handleObject(this.configureOptions[s],[s])),r++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var e=0;e<this.domElements.length;e++)this.wrapper.appendChild(this.domElements[e]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var e=0;e<this.domElements.length;e++)this.wrapper.removeChild(this.domElements[e]);this.wrapper!==void 0&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(e){for(var r=this.moduleOptions,n=0;n<e.length;n++)if(r[e[n]]!==void 0)r=r[e[n]];else{r=void 0;break}return r}},{key:"_makeItem",value:function(e){if(this.allowCreation===!0){var r=document.createElement("div");r.className="vis-configuration vis-config-item vis-config-s"+e.length;for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return Ue(s).call(s,function(l){r.appendChild(l)}),this.domElements.push(r),this.domElements.length}return 0}},{key:"_makeHeader",value:function(e){var r=document.createElement("div");r.className="vis-configuration vis-config-header",r.innerText=e,this._makeItem([],r)}},{key:"_makeLabel",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=document.createElement("div");if(s.className="vis-configuration vis-config-label vis-config-s"+r.length,n===!0){for(;s.firstChild;)s.removeChild(s.firstChild);s.appendChild(IS("i","b",e))}else s.innerText=e+":";return s}},{key:"_makeDropdown",value:function(e,r,n){var s=document.createElement("select");s.className="vis-configuration vis-config-select";var o=0;r!==void 0&&Er(e).call(e,r)!==-1&&(o=Er(e).call(e,r));for(var l=0;l<e.length;l++){var c=document.createElement("option");c.value=e[l],l===o&&(c.selected="selected"),c.innerText=e[l],s.appendChild(c)}var u=this;s.onchange=function(){u._update(this.value,n)};var d=this._makeLabel(n[n.length-1],n);this._makeItem(n,d,s)}},{key:"_makeRange",value:function(e,r,n){var s=e[0],o=e[1],l=e[2],c=e[3],u=document.createElement("input");u.className="vis-configuration vis-config-range";try{u.type="range",u.min=o,u.max=l}catch(E){}u.step=c;var d="",h=0;if(r!==void 0){var f=1.2;r<0&&r*f<o?(u.min=Math.ceil(r*f),h=u.min,d="range increased"):r/f<o&&(u.min=Math.ceil(r/f),h=u.min,d="range increased"),r*f>l&&l!==1&&(u.max=Math.ceil(r*f),h=u.max,d="range increased"),u.value=r}else u.value=s;var m=document.createElement("input");m.className="vis-configuration vis-config-rangeinput",m.value=u.value;var g=this;u.onchange=function(){m.value=this.value,g._update(Number(this.value),n)},u.oninput=function(){m.value=this.value};var y=this._makeLabel(n[n.length-1],n),v=this._makeItem(n,y,u,m);d!==""&&this.popupHistory[v]!==h&&(this.popupHistory[v]=h,this._setupPopup(d,v))}},{key:"_makeButton",value:function(){var e=this;if(this.options.showButton===!0){var r=document.createElement("div");r.className="vis-configuration vis-config-button",r.innerText="generate options",r.onclick=function(){e._printOptions()},r.onmouseover=function(){r.className="vis-configuration vis-config-button hover"},r.onmouseout=function(){r.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(r)}}},{key:"_setupPopup",value:function(e,r){var n=this;if(this.initialized===!0&&this.allowCreation===!0&&this.popupCounter<this.popupLimit){var s=document.createElement("div");s.id="vis-configuration-popup",s.className="vis-configuration-popup",s.innerText=e,s.onclick=function(){n._removePopup()},this.popupCounter+=1,this.popupDiv={html:s,index:r}}}},{key:"_removePopup",value:function(){this.popupDiv.html!==void 0&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var e=this;if(this.popupDiv.html!==void 0){var r=this.domElements[this.popupDiv.index],n=r.getBoundingClientRect();this.popupDiv.html.style.left=n.left+"px",this.popupDiv.html.style.top=n.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=wn(function(){e.popupDiv.html.style.opacity=0},1500),this.popupDiv.deleteTimeout=wn(function(){e._removePopup()},1800)}}},{key:"_makeCheckbox",value:function(e,r,n){var s=document.createElement("input");s.type="checkbox",s.className="vis-configuration vis-config-checkbox",s.checked=e,r!==void 0&&(s.checked=r,r!==e&&(yt(e)==="object"?r!==e.enabled&&this.changedOptions.push({path:n,value:r}):this.changedOptions.push({path:n,value:r})));var o=this;s.onchange=function(){o._update(this.checked,n)};var l=this._makeLabel(n[n.length-1],n);this._makeItem(n,l,s)}},{key:"_makeTextInput",value:function(e,r,n){var s=document.createElement("input");s.type="text",s.className="vis-configuration vis-config-text",s.value=r,r!==e&&this.changedOptions.push({path:n,value:r});var o=this;s.onchange=function(){o._update(this.value,n)};var l=this._makeLabel(n[n.length-1],n);this._makeItem(n,l,s)}},{key:"_makeColorField",value:function(e,r,n){var s=this,o=e[1],l=document.createElement("div");r=r===void 0?o:r,r!=="none"?(l.className="vis-configuration vis-config-colorBlock",l.style.backgroundColor=r):l.className="vis-configuration vis-config-colorBlock none",r=r===void 0?o:r,l.onclick=function(){s._showColorPicker(r,l,n)};var c=this._makeLabel(n[n.length-1],n);this._makeItem(n,c,l)}},{key:"_showColorPicker",value:function(e,r,n){var s=this;r.onclick=function(){},this.colorPicker.insertTo(r),this.colorPicker.show(),this.colorPicker.setColor(e),this.colorPicker.setUpdateCallback(function(o){var l="rgba("+o.r+","+o.g+","+o.b+","+o.a+")";r.style.backgroundColor=l,s._update(l,n)}),this.colorPicker.setCloseCallback(function(){r.onclick=function(){s._showColorPicker(e,r,n)}})}},{key:"_handleObject",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,o=lt(this.options),l=!1;for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){s=!0;var u=e[c],d=Qm(r,c);if(typeof o=="function"&&(s=o(c,r),s===!1&&!Tt(u)&&typeof u!="string"&&typeof u!="boolean"&&u instanceof Object&&(this.allowCreation=!1,s=this._handleObject(u,d,!0),this.allowCreation=n===!1)),s!==!1){l=!0;var h=this._getValue(d);if(Tt(u))this._handleArray(u,h,d);else if(typeof u=="string")this._makeTextInput(u,h,d);else if(typeof u=="boolean")this._makeCheckbox(u,h,d);else if(u instanceof Object){if(!this.hideOption(r,c,this.moduleOptions))if(u.enabled!==void 0){var f=Qm(d,"enabled"),m=this._getValue(f);if(m===!0){var g=this._makeLabel(c,d,!0);this._makeItem(d,g),l=this._handleObject(u,d)||l}else this._makeCheckbox(u,m,d)}else{var y=this._makeLabel(c,d,!0);this._makeItem(d,y),l=this._handleObject(u,d)||l}}else console.error("dont know how to handle",u,c,d)}}return l}},{key:"_handleArray",value:function(e,r,n){typeof e[0]=="string"&&e[0]==="color"?(this._makeColorField(e,r,n),e[1]!==r&&this.changedOptions.push({path:n,value:r})):typeof e[0]=="string"?(this._makeDropdown(e,r,n),e[0]!==r&&this.changedOptions.push({path:n,value:r})):typeof e[0]=="number"&&(this._makeRange(e,r,n),e[0]!==r&&this.changedOptions.push({path:n,value:Number(r)}))}},{key:"_update",value:function(e,r){var n=this._constructOptions(e,r);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",n),this.initialized=!0,this.parent.setOptions(n)}},{key:"_constructOptions",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=n;e=e==="true"?!0:e,e=e==="false"?!1:e;for(var o=0;o<r.length;o++)r[o]!=="global"&&(s[r[o]]===void 0&&(s[r[o]]={}),o!==r.length-1?s=s[r[o]]:s[r[o]]=e);return n}},{key:"_printOptions",value:function(){for(var e=this.getOptions();this.optionsContainer.firstChild;)this.optionsContainer.removeChild(this.optionsContainer.firstChild);this.optionsContainer.appendChild(IS("pre","const options = "+na(e,null,2)))}},{key:"getOptions",value:function(){for(var e={},r=0;r<this.changedOptions.length;r++)this._constructOptions(this.changedOptions[r].value,this.changedOptions[r].path,e);return e}}]),a})(),$ae=(function(){function a(t,e){Gt(this,a),this.container=t,this.overflowMethod=e||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return Vt(a,[{key:"setPosition",value:function(e,r){this.x=La(e),this.y=La(r)}},{key:"setText",value:function(e){if(e instanceof Element){for(;this.frame.firstChild;)this.frame.removeChild(this.frame.firstChild);this.frame.appendChild(e)}else this.frame.innerText=e}},{key:"show",value:function(e){if(e===void 0&&(e=!0),e===!0){var r=this.frame.clientHeight,n=this.frame.clientWidth,s=this.frame.parentNode.clientHeight,o=this.frame.parentNode.clientWidth,l=0,c=0;if(this.overflowMethod=="flip"){var u=!1,d=!0;this.y-r<this.padding&&(d=!1),this.x+n>o-this.padding&&(u=!0),u?l=this.x-n:l=this.x,d?c=this.y-r:c=this.y}else c=this.y-r,c+r+this.padding>s&&(c=s-r-this.padding),c<this.padding&&(c=this.padding),l=this.x,l+n+this.padding>o&&(l=o-n-this.padding),l<this.padding&&(l=this.padding);this.frame.style.left=l+"px",this.frame.style.top=c+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),a})(),Lm=!1,AS="background: #FFeeee; color: #dd0000",zae=(function(){function a(){Gt(this,a)}return Vt(a,null,[{key:"validate",value:function(e,r,n){Lm=!1,WO=r;var s=r;return n!==void 0&&(s=r[n]),a.parse(e,s,[]),Lm}},{key:"parse",value:function(e,r,n){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.check(s,e,r,n)}},{key:"check",value:function(e,r,n,s){if(n[e]===void 0&&n.__any__===void 0){a.getSuggestion(e,n,s);return}var o=e,l=!0;n[e]===void 0&&n.__any__!==void 0&&(o="__any__",l=a.getType(r[e])==="object");var c=n[o];l&&c.__type__!==void 0&&(c=c.__type__),a.checkFields(e,r,n,o,c,s)}},{key:"checkFields",value:function(e,r,n,s,o,l){var c=function(f){console.error("%c"+f+a.printLocation(l,e),AS)},u=a.getType(r[e]),d=o[u];d!==void 0?a.getType(d)==="array"&&Er(d).call(d,r[e])===-1?(c('Invalid option detected in "'+e+'". Allowed values are:'+a.print(d)+' not "'+r[e]+'". '),Lm=!0):u==="object"&&s!=="__any__"&&(l=Qm(l,e),a.parse(r[e],n[s],l)):o.any===void 0&&(c('Invalid type received for "'+e+'". Expected: '+a.print(bi(o))+". Received ["+u+'] "'+r[e]+'"'),Lm=!0)}},{key:"getType",value:function(e){var r=yt(e);return r==="object"?e===null?"null":e instanceof Boolean?"boolean":e instanceof Number?"number":e instanceof String?"string":Tt(e)?"array":e instanceof Date?"date":e.nodeType!==void 0?"dom":e._isAMomentObject===!0?"moment":"object":r==="number"?"number":r==="boolean"?"boolean":r==="string"?"string":r===void 0?"undefined":r}},{key:"getSuggestion",value:function(e,r,n){var s=a.findInOptions(e,r,n,!1),o=a.findInOptions(e,WO,[],!0),l=8,c=4,u;s.indexMatch!==void 0?u=" in "+a.printLocation(s.path,e,"")+'Perhaps it was incomplete? Did you mean: "'+s.indexMatch+`"?

`:o.distance<=c&&s.distance>o.distance?u=" in "+a.printLocation(s.path,e,"")+"Perhaps it was misplaced? Matching option found at: "+a.printLocation(o.path,o.closestMatch,""):s.distance<=l?u='. Did you mean "'+s.closestMatch+'"?'+a.printLocation(s.path,e):u=". Did you mean one of these: "+a.print(bi(r))+a.printLocation(n,e),console.error('%cUnknown option detected: "'+e+'"'+u,AS),Lm=!0}},{key:"findInOptions",value:function(e,r,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=1e9,l="",c=[],u=e.toLowerCase(),d=void 0;for(var h in r){var f=void 0;if(r[h].__type__!==void 0&&s===!0){var m=a.findInOptions(e,r[h],Qm(n,h));o>m.distance&&(l=m.closestMatch,c=m.path,o=m.distance,d=m.indexMatch)}else{var g;Er(g=h.toLowerCase()).call(g,u)!==-1&&(d=h),f=a.levenshteinDistance(e,h),o>f&&(l=h,c=hB(n),o=f)}}return{closestMatch:l,path:c,distance:o,indexMatch:d}}},{key:"printLocation",value:function(e,r){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:`Problem value found at: 
`,s=`

`+n+`options = {
`,o=0;o<e.length;o++){for(var l=0;l<o+1;l++)s+="  ";s+=e[o]+`: {
`}for(var c=0;c<e.length+1;c++)s+="  ";s+=r+`
`;for(var u=0;u<e.length+1;u++){for(var d=0;d<e.length-u;d++)s+="  ";s+=`}
`}return s+`

`}},{key:"print",value:function(e){return na(e).replace(/(")|(\[)|(\])|(,"__type__")/g,"").replace(/(,)/g,", ")}},{key:"levenshteinDistance",value:function(e,r){if(e.length===0)return r.length;if(r.length===0)return e.length;var n=[],s;for(s=0;s<=r.length;s++)n[s]=[s];var o;for(o=0;o<=e.length;o++)n[0][o]=o;for(s=1;s<=r.length;s++)for(o=1;o<=e.length;o++)r.charAt(s-1)==e.charAt(o-1)?n[s][o]=n[s-1][o-1]:n[s][o]=Math.min(n[s-1][o-1]+1,Math.min(n[s][o-1]+1,n[s-1][o]+1));return n[r.length][e.length]}}]),a})(),Hae=io,Gae=mB,Vae=Bae,Wae=Hx,Uae=$ae,jae=AS,Yae=zae,gB=Object.freeze({__proto__:null,Activator:Hae,Alea:Yne,ColorPicker:Gae,Configurator:Vae,DELETE:$x,HSVToHex:MS,HSVToRGB:Hm,Hammer:Wae,Popup:Uae,RGBToHSV:Sh,RGBToHex:Gx,VALIDATOR_PRINT_STYLE:jae,Validator:Yae,addClassName:fae,addCssText:kae,addEventListener:bae,binarySearchCustom:Iae,binarySearchValue:Aae,bridgeObject:Ux,copyAndExtendArray:Qm,copyArray:hB,deepExtend:Jm,deepObjectAssign:zx,easingFunctions:Oae,equalArray:cae,extend:aae,fillIfDefined:dB,forEach:mae,getAbsoluteLeft:uae,getAbsoluteRight:dae,getAbsoluteTop:hae,getScrollBarWidth:Fae,getTarget:Tae,getType:Rm,hasParent:Cae,hexToHSV:fB,hexToRGB:w0,insertSort:Lae,isDate:nae,isNumber:zm,isObject:LS,isString:Ma,isValidHex:Vx,isValidRGB:Wx,isValidRGBA:pB,mergeOptions:Mae,option:_ae,overrideOpacity:Sae,parseColor:xae,preventDefault:Eae,pureDeepObjectAssign:oB,recursiveDOMDelete:uB,removeClassName:pae,removeCssText:Dae,removeEventListener:wae,selectiveBridgeObject:Pae,selectiveDeepExtend:oae,selectiveExtend:sae,selectiveNotDeepExtend:lae,throttle:yae,toArray:gae,topMost:Rae,updateProperty:vae});qae=Object.freeze({__proto__:null,prepareElements:Fo,cleanupElements:Da,resetElements:vB,getSVGElement:ns,getDOMElement:Sb,drawPoint:Cu,drawBar:zb,getNavigatorLanguage:yB}),bB={exports:{}},Zae=nt,Kae=s0,Xae=Qb,Jae=Zae.TypeError,wB=function(a){if(Kae(a))return a;throw Jae(Xae(a)+" is not a constructor")},Qae=pt,ese=ss,M_=Du,tse=uN,UO=wB,rse=Aa,jO=Ui,ise=Lu,EB=rr,jx=ese("Reflect","construct"),nse=Object.prototype,ase=[].push,TB=EB(function(){function a(){}return!(jx(function(){},[],a)instanceof a)}),CB=!EB(function(){jx(function(){})}),YO=TB||CB;Qae({target:"Reflect",stat:!0,forced:YO,sham:YO},{construct:function(t,e){UO(t),rse(e);var r=arguments.length<3?t:UO(arguments[2]);if(CB&&!TB)return jx(t,e,r);if(t==r){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return M_(ase,n,e),new(M_(tse,t,n))}var s=r.prototype,o=ise(jO(s)?s:nse),l=M_(t,o,e);return jO(l)?l:o}});sse=fr,ose=sse.Reflect.construct,lse=ose,cse=lse;(function(a){a.exports=cse})(bB);it=tt(bB.exports);Yx={exports:{}},use=MN,dse=use,hse=dse,fse=hse;(function(a){a.exports=fse})(Yx);pse=tt(Yx.exports),qx={exports:{}},mse=pt,gse=U2;mse({target:"Object",stat:!0},{setPrototypeOf:gse});vse=fr,yse=vse.Object.setPrototypeOf,bse=yse,wse=bse,Ese=wse,Tse=Ese,Cse=Tse,_se=Cse;(function(a){a.exports=_se})(qx);OS=tt(qx.exports),_B={exports:{}},Sse=dN,xse=Sse,kse=xse,Dse=kse;(function(a){a.exports=Dse})(_B);SB=tt(_B.exports);Zx={exports:{}},Pse=EN,Lse=Pse,Mse=Lse,Ise=Mse;(function(a){a.exports=Ise})(Zx);qO=tt(Zx.exports);xB={exports:{}},kB={exports:{}};(function(a){var t=g0.exports,e=xx.exports;function r(n){"@babel/helpers - typeof";return a.exports=r=typeof t=="function"&&typeof e=="symbol"?function(s){return typeof s}:function(s){return s&&typeof t=="function"&&s.constructor===t&&s!==t.prototype?"symbol":typeof s},a.exports.__esModule=!0,a.exports.default=a.exports,r(n)}a.exports=r,a.exports.__esModule=!0,a.exports.default=a.exports})(kB);DB={exports:{}},Ase=fN,Ose=Ase,Fse=Ose,Rse=Fse;(function(a){a.exports=Rse})(DB);PB={exports:{}},ZO=Wi,Nse=Tx,Bse=Pu,$se=la,zse=function(a,t,e){for(var r=Nse(t),n=$se.f,s=Bse.f,o=0;o<r.length;o++){var l=r[o];!ZO(a,l)&&!(e&&ZO(e,l))&&n(a,l,s(t,l))}},Hse=ir,Gse=Hse("".replace),Vse=(function(a){return String(Error(a).stack)})("zxcasd"),LB=/\n\s*at [^:]*:[^\n]*/,Wse=LB.test(Vse),Use=function(a,t){if(Wse&&typeof a=="string")for(;t--;)a=Gse(a,LB,"");return a},jse=Ui,Yse=ec,qse=function(a,t){jse(t)&&"cause"in t&&Yse(a,"cause",t.cause)},Zse=nt,Kse=tc,Xse=Oa,Jse=Aa,Qse=Qb,eoe=Z2,toe=Fa,KO=Tr,roe=mx,ioe=o0,XO=q2,noe=Zse.TypeError,xb=function(a,t){this.stopped=a,this.result=t},JO=xb.prototype,Zh=function(a,t,e){var r=e&&e.that,n=!!(e&&e.AS_ENTRIES),s=!!(e&&e.IS_ITERATOR),o=!!(e&&e.INTERRUPTED),l=Kse(t,r),c,u,d,h,f,m,g,y=function(E){return c&&XO(c,"normal",E),new xb(!0,E)},v=function(E){return n?(Jse(E),o?l(E[0],E[1],y):l(E[0],E[1])):o?l(E,y):l(E)};if(s)c=a;else{if(u=ioe(a),!u)throw noe(Qse(a)+" is not iterable");if(eoe(u)){for(d=0,h=toe(a);h>d;d++)if(f=v(a[d]),f&&KO(JO,f))return f;return new xb(!1)}c=roe(a,u)}for(m=c.next;!(g=Xse(m,c)).done;){try{f=v(g.value)}catch(E){XO(c,"throw",E)}if(typeof f=="object"&&f&&KO(JO,f))return f}return new xb(!1)},aoe=so,soe=function(a,t){return a===void 0?arguments.length<2?"":t:aoe(a)},ooe=rr,loe=ku,coe=!ooe(function(){var a=Error("a");return"stack"in a?(Object.defineProperty(a,"stack",loe(1,7)),a.stack!==7):!0}),uoe=pt,doe=nt,hoe=Tr,foe=n0,Hb=U2,poe=zse,MB=Lu,fb=ec,I_=ku,moe=Use,goe=qse,voe=Zh,yoe=soe,boe=ai,woe=coe,Eoe=boe("toStringTag"),Gb=doe.Error,Toe=[].push,eg=function(t,e){var r=arguments.length>2?arguments[2]:void 0,n=hoe(A_,this),s;Hb?s=Hb(new Gb,n?foe(this):A_):(s=n?this:MB(A_),fb(s,Eoe,"Error")),e!==void 0&&fb(s,"message",yoe(e)),woe&&fb(s,"stack",moe(s.stack,1)),goe(s,r);var o=[];return voe(t,Toe,{that:o}),fb(s,"errors",o),s};Hb?Hb(eg,Gb):poe(eg,Gb,{name:!0});A_=eg.prototype=MB(Gb.prototype,{constructor:I_(1,eg),message:I_(1,""),name:I_(1,"AggregateError")});uoe({global:!0},{AggregateError:eg});Coe=nt,IB=Coe.Promise,_oe=a0,AB=function(a,t,e){for(var r in t)e&&e.unsafe&&a[r]?a[r]=t[r]:_oe(a,r,t[r],e);return a},Soe=ss,xoe=la,koe=ai,Doe=ji,QO=koe("species"),OB=function(a){var t=Soe(a),e=xoe.f;Doe&&t&&!t[QO]&&e(t,QO,{configurable:!0,get:function(){return this}})},Poe=nt,Loe=Tr,Moe=Poe.TypeError,Kx=function(a,t){if(Loe(t,a))return a;throw Moe("Incorrect invocation")},eF=Aa,Ioe=wB,Aoe=ai,Ooe=Aoe("species"),FB=function(a,t){var e=eF(a).constructor,r;return e===void 0||(r=eF(e)[Ooe])==null?t:Ioe(r)},Foe=Ql,RB=/(?:ipad|iphone|ipod).*applewebkit/i.test(Foe),Roe=xu,Noe=nt,E0=Roe(Noe.process)=="process",Ia=nt,Boe=Du,$oe=tc,tF=wi,zoe=Wi,Hoe=rr,rF=B2,Goe=vg,iF=ox,Voe=ON,Woe=RB,Uoe=E0,RS=Ia.setImmediate,NS=Ia.clearImmediate,joe=Ia.process,O_=Ia.Dispatch,Yoe=Ia.Function,nF=Ia.MessageChannel,qoe=Ia.String,F_=0,Gm={},aF="onreadystatechange";try{tg=Ia.location}catch(a){}Xx=function(a){if(zoe(Gm,a)){var t=Gm[a];delete Gm[a],t()}},B_=function(a){return function(){Xx(a)}},sF=function(a){Xx(a.data)},oF=function(a){Ia.postMessage(qoe(a),tg.protocol+"//"+tg.host)};(!RS||!NS)&&(RS=function(t){Voe(arguments.length,1);var e=tF(t)?t:Yoe(t),r=Goe(arguments,1);return Gm[++F_]=function(){Boe(e,void 0,r)},ou(F_),F_},NS=function(t){delete Gm[t]},Uoe?ou=function(a){joe.nextTick(B_(a))}:O_&&O_.now?ou=function(a){O_.now(B_(a))}:nF&&!Woe?(R_=new nF,N_=R_.port2,R_.port1.onmessage=sF,ou=$oe(N_.postMessage,N_)):Ia.addEventListener&&tF(Ia.postMessage)&&!Ia.importScripts&&tg&&tg.protocol!=="file:"&&!Hoe(oF)?(ou=oF,Ia.addEventListener("message",sF,!1)):aF in iF("script")?ou=function(a){rF.appendChild(iF("script"))[aF]=function(){rF.removeChild(this),Xx(a)}}:ou=function(a){setTimeout(B_(a),0)});NB={set:RS,clear:NS},Zoe=Ql,Koe=nt,Xoe=/ipad|iphone|ipod/i.test(Zoe)&&Koe.Pebble!==void 0,Joe=Ql,Qoe=/web0s(?!.*chrome)/i.test(Joe),_u=nt,lF=tc,ele=Pu.f,$_=NB.set,tle=RB,rle=Xoe,ile=Qoe,z_=E0,cF=_u.MutationObserver||_u.WebKitMutationObserver,uF=_u.document,dF=_u.process,pb=_u.Promise,hF=ele(_u,"queueMicrotask"),BB=hF&&hF.value;BB||(Mm=function(){var a,t;for(z_&&(a=dF.domain)&&a.exit();uu;){t=uu.fn,uu=uu.next;try{t()}catch(e){throw uu?wh():Vm=void 0,e}}Vm=void 0,a&&a.enter()},!tle&&!z_&&!ile&&cF&&uF?(H_=!0,G_=uF.createTextNode(""),new cF(Mm).observe(G_,{characterData:!0}),wh=function(){G_.data=H_=!H_}):!rle&&pb&&pb.resolve?(mb=pb.resolve(void 0),mb.constructor=pb,fF=lF(mb.then,mb),wh=function(){fF(Mm)}):z_?wh=function(){dF.nextTick(Mm)}:($_=lF($_,_u),wh=function(){$_(Mm)}));nle=BB||function(a){var t={fn:a,next:void 0};Vm&&(Vm.next=t),uu||(uu=t,wh()),Vm=t},Kh={},pF=Ms,ale=function(a){var t,e;this.promise=new a(function(r,n){if(t!==void 0||e!==void 0)throw TypeError("Bad Promise constructor");t=r,e=n}),this.resolve=pF(t),this.reject=pF(e)};Kh.f=function(a){return new ale(a)};sle=Aa,ole=Ui,lle=Kh,$B=function(a,t){if(sle(a),ole(t)&&t.constructor===a)return t;var e=lle.f(a),r=e.resolve;return r(t),e.promise},cle=nt,ule=function(a,t){var e=cle.console;e&&e.error&&(arguments.length==1?e.error(a):e.error(a,t))},T0=function(a){try{return{error:!1,value:a()}}catch(t){return{error:!0,value:t}}},zB=function(){this.head=null,this.tail=null};zB.prototype={add:function(a){var t={item:a,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var a=this.head;if(a)return this.head=a.next,this.tail===a&&(this.tail=null),a.item}};dle=zB,hle=typeof window=="object",C0=pt,fle=Q8,Vo=nt,ple=ss,Xl=Oa,BS=IB,mle=AB,gle=Gh,vle=OB,$S=Ms,Vb=wi,yle=Ui,ble=Kx,wle=sx,mF=Zh,Ele=rR,Tle=FB,HB=NB.set,Jx=nle,Cle=$B,_le=ule,GB=Kh,zS=T0,Sle=dle,Qx=Hh,xle=O2,kle=ai,Dle=hle,Wb=E0,gF=zh,Ple=kle("species"),lo="Promise",vF=Qx.getterFor(lo),Lle=Qx.set,Mle=Qx.getterFor(lo),Ile=BS&&BS.prototype,Ds=BS,kb=Ile,VB=Vo.TypeError,HS=Vo.document,ek=Vo.process,Rh=GB.f,Ale=Rh,Ole=!!(HS&&HS.createEvent&&Vo.dispatchEvent),WB=Vb(Vo.PromiseRejectionEvent),UB="unhandledrejection",Fle="rejectionhandled",yF=0,jB=1,Rle=2,tk=1,YB=2,bF=!1,_0=xle(lo,function(){var a=wle(Ds),t=a!==String(Ds);if(!t&&gF===66||!kb.finally)return!0;if(gF>=51&&/native code/.test(a))return!1;var e=new Ds(function(s){s(1)}),r=function(s){s(function(){},function(){})},n=e.constructor={};return n[Ple]=r,bF=e.then(function(){})instanceof r,bF?!t&&Dle&&!WB:!0}),Nle=_0||!Ele(function(a){Ds.all(a).catch(function(){})}),qB=function(a){var t;return yle(a)&&Vb(t=a.then)?t:!1},ZB=function(a,t){var e=t.value,r=t.state==jB,n=r?a.ok:a.fail,s=a.resolve,o=a.reject,l=a.domain,c,u,d;try{n?(r||(t.rejection===YB&&$le(t),t.rejection=tk),n===!0?c=e:(l&&l.enter(),c=n(e),l&&(l.exit(),d=!0)),c===a.promise?o(VB("Promise-chain cycle")):(u=qB(c))?Xl(u,c,s,o):s(c)):o(e)}catch(h){l&&!d&&l.exit(),o(h)}},KB=function(a,t){a.notified||(a.notified=!0,Jx(function(){for(var e=a.reactions,r;r=e.get();)ZB(r,a);a.notified=!1,t&&!a.rejection&&Ble(a)}))},XB=function(a,t,e){var r,n;Ole?(r=HS.createEvent("Event"),r.promise=t,r.reason=e,r.initEvent(a,!1,!0),Vo.dispatchEvent(r)):r={promise:t,reason:e},!WB&&(n=Vo["on"+a])?n(r):a===UB&&_le("Unhandled promise rejection",e)},Ble=function(a){Xl(HB,Vo,function(){var t=a.facade,e=a.value,r=EF(a),n;if(r&&(n=zS(function(){Wb?ek.emit("unhandledRejection",e,t):XB(UB,t,e)}),a.rejection=Wb||EF(a)?YB:tk,n.error))throw n.value})},EF=function(a){return a.rejection!==tk&&!a.parent},$le=function(a){Xl(HB,Vo,function(){var t=a.facade;Wb?ek.emit("rejectionHandled",t):XB(Fle,t,a.value)})},xh=function(a,t,e){return function(r){a(t,r,e)}},Dh=function(a,t,e){a.done||(a.done=!0,e&&(a=e),a.value=t,a.state=Rle,KB(a,!0))},GS=function(a,t,e){if(!a.done){a.done=!0,e&&(a=e);try{if(a.facade===t)throw VB("Promise can't be resolved itself");var r=qB(t);r?Jx(function(){var n={done:!1};try{Xl(r,t,xh(GS,n,a),xh(Dh,n,a))}catch(s){Dh(n,s,a)}}):(a.value=t,a.state=jB,KB(a,!1))}catch(n){Dh({done:!1},n,a)}}};_0&&(Ds=function(t){ble(this,kb),$S(t),Xl(gb,this);var e=vF(this);try{t(xh(GS,e),xh(Dh,e))}catch(r){Dh(e,r)}},kb=Ds.prototype,gb=function(t){Lle(this,{type:lo,done:!1,notified:!1,parent:!1,reactions:new Sle,rejection:!1,state:yF,value:void 0})},gb.prototype=mle(kb,{then:function(t,e){var r=Mle(this),n=Rh(Tle(this,Ds));return r.parent=!0,n.ok=Vb(t)?t:!0,n.fail=Vb(e)&&e,n.domain=Wb?ek.domain:void 0,r.state==yF?r.reactions.add(n):Jx(function(){ZB(n,r)}),n.promise},catch:function(a){return this.then(void 0,a)}}),wF=function(){var a=new gb,t=vF(a);this.promise=a,this.resolve=xh(GS,t),this.reject=xh(Dh,t)},GB.f=Rh=function(a){return a===Ds||a===rk?new wF(a):Ale(a)});C0({global:!0,wrap:!0,forced:_0},{Promise:Ds});gle(Ds,lo,!1,!0);vle(lo);rk=ple(lo);C0({target:lo,stat:!0,forced:_0},{reject:function(t){var e=Rh(this);return Xl(e.reject,void 0,t),e.promise}});C0({target:lo,stat:!0,forced:fle},{resolve:function(t){return Cle(this===rk?Ds:this,t)}});C0({target:lo,stat:!0,forced:Nle},{all:function(t){var e=this,r=Rh(e),n=r.resolve,s=r.reject,o=zS(function(){var l=$S(e.resolve),c=[],u=0,d=1;mF(t,function(h){var f=u++,m=!1;d++,Xl(l,e,h).then(function(g){m||(m=!0,c[f]=g,--d||n(c))},s)}),--d||n(c)});return o.error&&s(o.value),r.promise},race:function(t){var e=this,r=Rh(e),n=r.reject,s=zS(function(){var o=$S(e.resolve);mF(t,function(l){Xl(o,e,l).then(r.resolve,n)})});return s.error&&n(s.value),r.promise}});zle=pt,Hle=Oa,Gle=Ms,Vle=Kh,Wle=T0,Ule=Zh;zle({target:"Promise",stat:!0},{allSettled:function(t){var e=this,r=Vle.f(e),n=r.resolve,s=r.reject,o=Wle(function(){var l=Gle(e.resolve),c=[],u=0,d=1;Ule(t,function(h){var f=u++,m=!1;d++,Hle(l,e,h).then(function(g){m||(m=!0,c[f]={status:"fulfilled",value:g},--d||n(c))},function(g){m||(m=!0,c[f]={status:"rejected",reason:g},--d||n(c))})}),--d||n(c)});return o.error&&s(o.value),r.promise}});jle=pt,Yle=Ms,qle=ss,Zle=Oa,Kle=Kh,Xle=T0,Jle=Zh,TF="No one promise resolved";jle({target:"Promise",stat:!0},{any:function(t){var e=this,r=qle("AggregateError"),n=Kle.f(e),s=n.resolve,o=n.reject,l=Xle(function(){var c=Yle(e.resolve),u=[],d=0,h=1,f=!1;Jle(t,function(m){var g=d++,y=!1;h++,Zle(c,e,m).then(function(v){y||f||(f=!0,s(v))},function(v){y||f||(y=!0,u[g]=v,--h||o(new r(u,TF)))})}),--h||o(new r(u,TF))});return l.error&&o(l.value),n.promise}});Qle=pt,CF=IB,ece=rr,tce=ss,rce=wi,ice=FB,_F=$B,nce=!!CF&&ece(function(){CF.prototype.finally.call({then:function(){}},function(){})});Qle({target:"Promise",proto:!0,real:!0,forced:nce},{finally:function(a){var t=ice(this,tce("Promise")),e=rce(a);return this.then(e?function(r){return _F(t,a()).then(function(){return r})}:a,e?function(r){return _F(t,a()).then(function(){throw r})}:a)}});ace=fr,sce=ace.Promise,oce=sce,lce=oce,cce=lce,uce=cce,dce=pt,hce=Kh,fce=T0;dce({target:"Promise",stat:!0,forced:!0},{try:function(a){var t=hce.f(this),e=fce(a);return(e.error?t.reject:t.resolve)(e.value),t.promise}});pce=uce,mce=pce;(function(a){a.exports=mce})(PB);JB={exports:{}},gce=mN,vce=gce,yce=vce,bce=yce;(function(a){a.exports=bce})(JB);(function(a){var t=kB.exports.default,e=g0.exports,r=_x.exports,n=Yx.exports,s=Zx.exports,o=DB.exports,l=qx.exports,c=PB.exports,u=JB.exports,d=Sx.exports;function h(){a.exports=h=function(){return f},a.exports.__esModule=!0,a.exports.default=a.exports;var f={},m=Object.prototype,g=m.hasOwnProperty,y=typeof e=="function"?e:{},v=y.iterator||"@@iterator",E=y.asyncIterator||"@@asyncIterator",C=y.toStringTag||"@@toStringTag";function _(j,K,se){return r(j,K,{value:se,enumerable:!0,configurable:!0,writable:!0}),j[K]}try{_({},"")}catch(j){_=function(se,ne,ge){return se[ne]=ge}}function x(j,K,se,ne){var ge=K&&K.prototype instanceof M?K:M,ve=n(ge.prototype),Se=new q(ne||[]);return ve._invoke=(function(Te,me,pe){var B="suspendedStart";return function(oe,he){if(B==="executing")throw new Error("Generator is already running");if(B==="completed"){if(oe==="throw")throw he;return ie()}for(pe.method=oe,pe.arg=he;;){var te=pe.delegate;if(te){var re=Y(te,pe);if(re){if(re===I)continue;return re}}if(pe.method==="next")pe.sent=pe._sent=pe.arg;else if(pe.method==="throw"){if(B==="suspendedStart")throw B="completed",pe.arg;pe.dispatchException(pe.arg)}else pe.method==="return"&&pe.abrupt("return",pe.arg);B="executing";var ce=P(Te,me,pe);if(ce.type==="normal"){if(B=pe.done?"completed":"suspendedYield",ce.arg===I)continue;return{value:ce.arg,done:pe.done}}ce.type==="throw"&&(B="completed",pe.method="throw",pe.arg=ce.arg)}}})(j,se,Se),ve}function P(j,K,se){try{return{type:"normal",arg:j.call(K,se)}}catch(ne){return{type:"throw",arg:ne}}}f.wrap=x;var I={};function M(){}function O(){}function R(){}var F={};_(F,v,function(){return this});var $=s,k=$&&$($(X([])));k&&k!==m&&g.call(k,v)&&(F=k);var N=R.prototype=M.prototype=n(F);function G(j){var K;o(K=["next","throw","return"]).call(K,function(se){_(j,se,function(ne){return this._invoke(se,ne)})})}function W(j,K){function se(ge,ve,Se,Te){var me=P(j[ge],j,ve);if(me.type!=="throw"){var pe=me.arg,B=pe.value;return B&&t(B)=="object"&&g.call(B,"__await")?K.resolve(B.__await).then(function(oe){se("next",oe,Se,Te)},function(oe){se("throw",oe,Se,Te)}):K.resolve(B).then(function(oe){pe.value=oe,Se(pe)},function(oe){return se("throw",oe,Se,Te)})}Te(me.arg)}var ne;this._invoke=function(ge,ve){function Se(){return new K(function(Te,me){se(ge,ve,Te,me)})}return ne=ne?ne.then(Se,Se):Se()}}function Y(j,K){var se=j.iterator[K.method];if(se===void 0){if(K.delegate=null,K.method==="throw"){if(j.iterator.return&&(K.method="return",K.arg=void 0,Y(j,K),K.method==="throw"))return I;K.method="throw",K.arg=new TypeError("The iterator does not provide a 'throw' method")}return I}var ne=P(se,j.iterator,K.arg);if(ne.type==="throw")return K.method="throw",K.arg=ne.arg,K.delegate=null,I;var ge=ne.arg;return ge?ge.done?(K[j.resultName]=ge.value,K.next=j.nextLoc,K.method!=="return"&&(K.method="next",K.arg=void 0),K.delegate=null,I):ge:(K.method="throw",K.arg=new TypeError("iterator result is not an object"),K.delegate=null,I)}function U(j){var K={tryLoc:j[0]};1 in j&&(K.catchLoc=j[1]),2 in j&&(K.finallyLoc=j[2],K.afterLoc=j[3]),this.tryEntries.push(K)}function Z(j){var K=j.completion||{};K.type="normal",delete K.arg,j.completion=K}function q(j){this.tryEntries=[{tryLoc:"root"}],o(j).call(j,U,this),this.reset(!0)}function X(j){if(j){var K=j[v];if(K)return K.call(j);if(typeof j.next=="function")return j;if(!isNaN(j.length)){var se=-1,ne=function ge(){for(;++se<j.length;)if(g.call(j,se))return ge.value=j[se],ge.done=!1,ge;return ge.value=void 0,ge.done=!0,ge};return ne.next=ne}}return{next:ie}}function ie(){return{value:void 0,done:!0}}return O.prototype=R,_(N,"constructor",R),_(R,"constructor",O),O.displayName=_(R,C,"GeneratorFunction"),f.isGeneratorFunction=function(j){var K=typeof j=="function"&&j.constructor;return!!K&&(K===O||(K.displayName||K.name)==="GeneratorFunction")},f.mark=function(j){return l?l(j,R):(j.__proto__=R,_(j,C,"GeneratorFunction")),j.prototype=n(N),j},f.awrap=function(j){return{__await:j}},G(W.prototype),_(W.prototype,E,function(){return this}),f.AsyncIterator=W,f.async=function(j,K,se,ne,ge){ge===void 0&&(ge=c);var ve=new W(x(j,K,se,ne),ge);return f.isGeneratorFunction(K)?ve:ve.next().then(function(Se){return Se.done?Se.value:ve.next()})},G(N),_(N,C,"Generator"),_(N,v,function(){return this}),_(N,"toString",function(){return"[object Generator]"}),f.keys=function(j){var K=[];for(var se in j)K.push(se);return u(K).call(K),function ne(){for(;K.length;){var ge=K.pop();if(ge in j)return ne.value=ge,ne.done=!1,ne}return ne.done=!0,ne}},f.values=X,q.prototype={constructor:q,reset:function(K){var se;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,o(se=this.tryEntries).call(se,Z),!K)for(var ne in this)ne.charAt(0)==="t"&&g.call(this,ne)&&!isNaN(+d(ne).call(ne,1))&&(this[ne]=void 0)},stop:function(){this.done=!0;var K=this.tryEntries[0].completion;if(K.type==="throw")throw K.arg;return this.rval},dispatchException:function(K){if(this.done)throw K;var se=this;function ne(pe,B){return Se.type="throw",Se.arg=K,se.next=pe,B&&(se.method="next",se.arg=void 0),!!B}for(var ge=this.tryEntries.length-1;ge>=0;--ge){var ve=this.tryEntries[ge],Se=ve.completion;if(ve.tryLoc==="root")return ne("end");if(ve.tryLoc<=this.prev){var Te=g.call(ve,"catchLoc"),me=g.call(ve,"finallyLoc");if(Te&&me){if(this.prev<ve.catchLoc)return ne(ve.catchLoc,!0);if(this.prev<ve.finallyLoc)return ne(ve.finallyLoc)}else if(Te){if(this.prev<ve.catchLoc)return ne(ve.catchLoc,!0)}else{if(!me)throw new Error("try statement without catch or finally");if(this.prev<ve.finallyLoc)return ne(ve.finallyLoc)}}}},abrupt:function(K,se){for(var ne=this.tryEntries.length-1;ne>=0;--ne){var ge=this.tryEntries[ne];if(ge.tryLoc<=this.prev&&g.call(ge,"finallyLoc")&&this.prev<ge.finallyLoc){var ve=ge;break}}ve&&(K==="break"||K==="continue")&&ve.tryLoc<=se&&se<=ve.finallyLoc&&(ve=null);var Se=ve?ve.completion:{};return Se.type=K,Se.arg=se,ve?(this.method="next",this.next=ve.finallyLoc,I):this.complete(Se)},complete:function(K,se){if(K.type==="throw")throw K.arg;return K.type==="break"||K.type==="continue"?this.next=K.arg:K.type==="return"?(this.rval=this.arg=K.arg,this.method="return",this.next="end"):K.type==="normal"&&se&&(this.next=se),I},finish:function(K){for(var se=this.tryEntries.length-1;se>=0;--se){var ne=this.tryEntries[se];if(ne.finallyLoc===K)return this.complete(ne.completion,ne.afterLoc),Z(ne),I}},catch:function(K){for(var se=this.tryEntries.length-1;se>=0;--se){var ne=this.tryEntries[se];if(ne.tryLoc===K){var ge=ne.completion;if(ge.type==="throw"){var ve=ge.arg;Z(ne)}return ve}}throw new Error("illegal catch attempt")},delegateYield:function(K,se,ne){return this.delegate={iterator:X(K),resultName:se,nextLoc:ne},this.method==="next"&&(this.arg=void 0),I}},f}a.exports=h,a.exports.__esModule=!0,a.exports.default=a.exports})(xB);Db=xB.exports(),ta=Db;try{regeneratorRuntime=Db}catch(a){typeof globalThis=="object"?globalThis.regeneratorRuntime=Db:Function("r","regeneratorRuntime = r")(Db)}QB={exports:{}},wce=nt,Ece=Ms,Tce=oa,Cce=r0,_ce=Fa,Sce=wce.TypeError,SF=function(a){return function(t,e,r,n){Ece(e);var s=Tce(t),o=Cce(s),l=_ce(s),c=a?l-1:0,u=a?-1:1;if(r<2)for(;;){if(c in o){n=o[c],c+=u;break}if(c+=u,a?c<0:l<=c)throw Sce("Reduce of empty array with no initial value")}for(;a?c>=0:l>c;c+=u)c in o&&(n=e(n,o[c],c,s));return n}},xce={left:SF(!1),right:SF(!0)},kce=pt,Dce=xce.left,Pce=Yh,xF=zh,Lce=E0,Mce=Pce("reduce"),Ice=!Lce&&xF>79&&xF<83;kce({target:"Array",proto:!0,forced:!Mce||Ice},{reduce:function(t){var e=arguments.length;return Dce(this,t,e,e>1?arguments[1]:void 0)}});Ace=jr,Oce=Ace("Array").reduce,Fce=Tr,Rce=Oce,V_=Array.prototype,Nce=function(a){var t=a.reduce;return a===V_||Fce(V_,a)&&t===V_.reduce?Rce:t},Bce=Nce,$ce=Bce;(function(a){a.exports=$ce})(QB);S0=tt(QB.exports),e$={exports:{}},zce=nt,Hce=Mu,Gce=Fa,Vce=tc,Wce=zce.TypeError,t$=function(a,t,e,r,n,s,o,l){for(var c=n,u=0,d=o?Vce(o,l):!1,h,f;u<r;){if(u in e){if(h=d?d(e[u],u,t):e[u],s>0&&Hce(h))f=Gce(h),c=t$(a,t,h,f,c,s-1)-1;else{if(c>=9007199254740991)throw Wce("Exceed the acceptable array length");a[c]=h}c++}u++}return c},Uce=t$,jce=pt,Yce=Uce,qce=Ms,Zce=oa,Kce=Fa,Xce=u0;jce({target:"Array",proto:!0},{flatMap:function(t){var e=Zce(this),r=Kce(e),n;return qce(t),n=Xce(e,0),n.length=Yce(n,e,e,r,0,1,t,arguments.length>1?arguments[1]:void 0),n}});Jce=jr,Qce=Jce("Array").flatMap,eue=Tr,tue=Qce,W_=Array.prototype,rue=function(a){var t=a.flatMap;return a===W_||eue(W_,a)&&t===W_.flatMap?tue:t},iue=rue,nue=iue;(function(a){a.exports=nue})(e$);aue=tt(e$.exports),r$={exports:{}},ik={exports:{}},sue=rr,oue=sue(function(){if(typeof ArrayBuffer=="function"){var a=new ArrayBuffer(8);Object.isExtensible(a)&&Object.defineProperty(a,"a",{value:8})}}),lue=rr,cue=Ui,uue=xu,kF=oue,Pb=Object.isExtensible,due=lue(function(){Pb(1)}),hue=due||kF?function(t){return!cue(t)||kF&&uue(t)=="ArrayBuffer"?!1:Pb?Pb(t):!0}:Pb,fue=rr,pue=!fue(function(){return Object.isExtensible(Object.preventExtensions({}))}),mue=pt,gue=ir,vue=dg,yue=Ui,nk=Wi,bue=la.f,DF=gg,wue=gx,ak=hue,Eue=Jb,Tue=pue,i$=!1,Wo=Eue("meta"),Cue=0,sk=function(a){bue(a,Wo,{value:{objectID:"O"+Cue++,weakData:{}}})},_ue=function(a,t){if(!yue(a))return typeof a=="symbol"?a:(typeof a=="string"?"S":"P")+a;if(!nk(a,Wo)){if(!ak(a))return"F";if(!t)return"E";sk(a)}return a[Wo].objectID},Sue=function(a,t){if(!nk(a,Wo)){if(!ak(a))return!0;if(!t)return!1;sk(a)}return a[Wo].weakData},xue=function(a){return Tue&&i$&&ak(a)&&!nk(a,Wo)&&sk(a),a},kue=function(){Due.enable=function(){},i$=!0;var a=DF.f,t=gue([].splice),e={};e[Wo]=1,a(e).length&&(DF.f=function(r){for(var n=a(r),s=0,o=n.length;s<o;s++)if(n[s]===Wo){t(n,s,1);break}return n},mue({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:wue.f}))},Due=ik.exports={enable:kue,fastKey:_ue,getWeakData:Sue,onFreeze:xue};vue[Wo]=!0;Pue=pt,Lue=nt,Mue=ik.exports,Iue=rr,Aue=ec,Oue=Zh,Fue=Kx,Rue=wi,Nue=Ui,Bue=Gh,$ue=la.f,zue=Yo.forEach,Hue=ji,n$=Hh,Gue=n$.set,Vue=n$.getterFor,a$=function(a,t,e){var r=a.indexOf("Map")!==-1,n=a.indexOf("Weak")!==-1,s=r?"set":"add",o=Lue[a],l=o&&o.prototype,c={},u;if(!Hue||!Rue(o)||!(n||l.forEach&&!Iue(function(){new o().entries().next()})))u=e.getConstructor(t,a,r,s),Mue.enable();else{u=t(function(f,m){Gue(Fue(f,d),{type:a,collection:new o}),m!=null&&Oue(m,f[s],{that:f,AS_ENTRIES:r})});var d=u.prototype,h=Vue(a);zue(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(f){var m=f=="add"||f=="set";f in l&&!(n&&f=="clear")&&Aue(d,f,function(g,y){var v=h(this).collection;if(!m&&n&&!Nue(g))return f=="get"?void 0:!1;var E=v[f](g===0?0:g,y);return m?this:E})}),n||$ue(d,"size",{configurable:!0,get:function(){return h(this).collection.size}})}return Bue(u,a,!1,!0),c[a]=u,Pue({global:!0,forced:!0},c),n||e.setStrong(u,a,r),u},Wue=la.f,Uue=Lu,PF=AB,jue=tc,Yue=Kx,que=Zh,Zue=fx,Kue=OB,Im=ji,LF=ik.exports.fastKey,s$=Hh,MF=s$.set,U_=s$.getterFor,o$={getConstructor:function(a,t,e,r){var n=a(function(u,d){Yue(u,s),MF(u,{type:t,index:Uue(null),first:void 0,last:void 0,size:0}),Im||(u.size=0),d!=null&&que(d,u[r],{that:u,AS_ENTRIES:e})}),s=n.prototype,o=U_(t),l=function(u,d,h){var f=o(u),m=c(u,d),g,y;return m?m.value=h:(f.last=m={index:y=LF(d,!0),key:d,value:h,previous:g=f.last,next:void 0,removed:!1},f.first||(f.first=m),g&&(g.next=m),Im?f.size++:u.size++,y!=="F"&&(f.index[y]=m)),u},c=function(u,d){var h=o(u),f=LF(d),m;if(f!=="F")return h.index[f];for(m=h.first;m;m=m.next)if(m.key==d)return m};return PF(s,{clear:function(){for(var d=this,h=o(d),f=h.index,m=h.first;m;)m.removed=!0,m.previous&&(m.previous=m.previous.next=void 0),delete f[m.index],m=m.next;h.first=h.last=void 0,Im?h.size=0:d.size=0},delete:function(u){var d=this,h=o(d),f=c(d,u);if(f){var m=f.next,g=f.previous;delete h.index[f.index],f.removed=!0,g&&(g.next=m),m&&(m.previous=g),h.first==f&&(h.first=m),h.last==f&&(h.last=g),Im?h.size--:d.size--}return!!f},forEach:function(d){for(var h=o(this),f=jue(d,arguments.length>1?arguments[1]:void 0),m;m=m?m.next:h.first;)for(f(m.value,m.key,this);m&&m.removed;)m=m.previous},has:function(d){return!!c(this,d)}}),PF(s,e?{get:function(d){var h=c(this,d);return h&&h.value},set:function(d,h){return l(this,d===0?0:d,h)}}:{add:function(d){return l(this,d=d===0?0:d,d)}}),Im&&Wue(s,"size",{get:function(){return o(this).size}}),n},setStrong:function(a,t,e){var r=t+" Iterator",n=U_(t),s=U_(r);Zue(a,t,function(o,l){MF(this,{type:r,target:o,state:n(o),kind:l,last:void 0})},function(){for(var o=s(this),l=o.kind,c=o.last;c&&c.removed;)c=c.previous;return!o.target||!(o.last=c=c?c.next:o.state.first)?(o.target=void 0,{value:void 0,done:!0}):l=="keys"?{value:c.key,done:!1}:l=="values"?{value:c.value,done:!1}:{value:[c.key,c.value],done:!1}},e?"entries":"values",!e,!0),Kue(t)}},Xue=a$,Jue=o$;Xue("Map",function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},Jue);Que=fr,ede=Que.Map,tde=ede,rde=tde;(function(a){a.exports=rde})(r$);l$=tt(r$.exports),c$={exports:{}},ide=a$,nde=o$;ide("Set",function(a){return function(){return a(this,arguments.length?arguments[0]:void 0)}},nde);ade=fr,sde=ade.Set,ode=sde,lde=ode;(function(a){a.exports=lde})(c$);Zl=tt(c$.exports),u$={exports:{}};(function(a){a.exports=ZR})(u$);mu=tt(u$.exports),d$={exports:{}},cde=mx,ude=cde,dde=ude,hde=dde,fde=hde,pde=fde,mde=pde,gde=mde;(function(a){a.exports=gde})(d$);j_=tt(d$.exports),h$={exports:{}},IF=lR,vde=Math.floor,VS=function(a,t){var e=a.length,r=vde(e/2);return e<8?yde(a,t):bde(a,VS(IF(a,0,r),t),VS(IF(a,r),t),t)},yde=function(a,t){for(var e=a.length,r=1,n,s;r<e;){for(s=r,n=a[r];s&&t(a[s-1],n)>0;)a[s]=a[--s];s!==r++&&(a[s]=n)}return a},bde=function(a,t,e,r){for(var n=t.length,s=e.length,o=0,l=0;o<n||l<s;)a[o+l]=o<n&&l<s?r(t[o],e[l])<=0?t[o++]:e[l++]:o<n?t[o++]:e[l++];return a},wde=VS,Ede=Ql,AF=Ede.match(/firefox\/(\d+)/i),Tde=!!AF&&+AF[1],Cde=Ql,_de=/MSIE|Trident/.test(Cde),Sde=Ql,OF=Sde.match(/AppleWebKit\/(\d+)\./),xde=!!OF&&+OF[1],kde=pt,f$=ir,Dde=Ms,Pde=oa,Lde=Fa,FF=so,ok=rr,Mde=wde,Ide=Yh,RF=Tde,Ade=_de,NF=zh,BF=xde,jl=[],$F=f$(jl.sort),Ode=f$(jl.push),Fde=ok(function(){jl.sort(void 0)}),Rde=ok(function(){jl.sort(null)}),Nde=Ide("sort"),p$=!ok(function(){if(NF)return NF<70;if(!(RF&&RF>3)){if(Ade)return!0;if(BF)return BF<603;var a="",t,e,r,n;for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)jl.push({k:e+n,v:r})}for(jl.sort(function(s,o){return o.v-s.v}),n=0;n<jl.length;n++)e=jl[n].k.charAt(0),a.charAt(a.length-1)!==e&&(a+=e);return a!=="DGBEFHACIJK"}}),Bde=Fde||!Rde||!Nde||!p$,$de=function(a){return function(t,e){return e===void 0?-1:t===void 0?1:a!==void 0?+a(t,e)||0:FF(t)>FF(e)?1:-1}};kde({target:"Array",proto:!0,forced:Bde},{sort:function(t){t!==void 0&&Dde(t);var e=Pde(this);if(p$)return t===void 0?$F(e):$F(e,t);var r=[],n=Lde(e),s,o;for(o=0;o<n;o++)o in e&&Ode(r,e[o]);for(Mde(r,$de(t)),s=r.length,o=0;o<s;)e[o]=r[o++];for(;o<n;)delete e[o++];return e}});zde=jr,Hde=zde("Array").sort,Gde=Tr,Vde=Hde,Y_=Array.prototype,Wde=function(a){var t=a.sort;return a===Y_||Gde(Y_,a)&&t===Y_.sort?Vde:t},Ude=Wde,jde=Ude;(function(a){a.exports=jde})(h$);ci=tt(h$.exports),m$={exports:{}},Yde=pt,qde=Yo.some,Zde=Yh,Kde=Zde("some");Yde({target:"Array",proto:!0,forced:!Kde},{some:function(t){return qde(this,t,arguments.length>1?arguments[1]:void 0)}});Xde=jr,Jde=Xde("Array").some,Qde=Tr,ehe=Jde,q_=Array.prototype,the=function(a){var t=a.some;return a===q_||Qde(q_,a)&&t===q_.some?ehe:t},rhe=the,ihe=rhe;(function(a){a.exports=ihe})(m$);lk=tt(m$.exports),g$={exports:{}},nhe=jr,ahe=nhe("Array").keys,she=ahe,ohe=she,lhe=jo,che=Wi,uhe=Tr,dhe=ohe,Z_=Array.prototype,hhe={DOMTokenList:!0,NodeList:!0},fhe=function(a){var t=a.keys;return a===Z_||uhe(Z_,a)&&t===Z_.keys||che(hhe,lhe(a))?dhe:t};(function(a){a.exports=fhe})(g$);cu=tt(g$.exports),v$={exports:{}},phe=jr,mhe=phe("Array").values,ghe=mhe,vhe=ghe,yhe=jo,bhe=Wi,whe=Tr,Ehe=vhe,K_=Array.prototype,The={DOMTokenList:!0,NodeList:!0},Che=function(a){var t=a.values;return a===K_||whe(K_,a)&&t===K_.values||bhe(The,yhe(a))?Ehe:t};(function(a){a.exports=Che})(v$);zF=tt(v$.exports),y$={exports:{}},_he=jr,She=_he("Array").entries,xhe=She,khe=xhe,Dhe=jo,Phe=Wi,Lhe=Tr,Mhe=khe,X_=Array.prototype,Ihe={DOMTokenList:!0,NodeList:!0},Ahe=function(a){var t=a.entries;return a===X_||Lhe(X_,a)&&t===X_.entries||Phe(Ihe,Dhe(a))?Mhe:t};(function(a){a.exports=Ahe})(y$);Ohe=tt(y$.exports),HF=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),Fhe=new Uint8Array(16);b$=[];for(Am=0;Am<256;++Am)b$[Am]=(Am+256).toString(16).substr(1);$he="6ba7b810-9dad-11d1-80b4-00c04fd430c8",zhe="6ba7b811-9dad-11d1-80b4-00c04fd430c8";E$("v3",48,Hhe);E$("v5",80,Yhe);Xhe=(function(){function a(t,e,r){var n,s,o;Gt(this,a),Ht(this,"_source",void 0),Ht(this,"_transformers",void 0),Ht(this,"_target",void 0),Ht(this,"_listeners",{add:Oe(n=this._add).call(n,this),remove:Oe(s=this._remove).call(s,this),update:Oe(o=this._update).call(o,this)}),this._source=t,this._transformers=e,this._target=r}return Vt(a,[{key:"all",value:function(){return this._target.update(this._transformItems(this._source.get())),this}},{key:"start",value:function(){return this._source.on("add",this._listeners.add),this._source.on("remove",this._listeners.remove),this._source.on("update",this._listeners.update),this}},{key:"stop",value:function(){return this._source.off("add",this._listeners.add),this._source.off("remove",this._listeners.remove),this._source.off("update",this._listeners.update),this}},{key:"_transformItems",value:function(e){var r;return S0(r=this._transformers).call(r,function(n,s){return s(n)},e)}},{key:"_add",value:function(e,r){r!=null&&this._target.add(this._transformItems(this._source.get(r.items)))}},{key:"_update",value:function(e,r){r!=null&&this._target.update(this._transformItems(this._source.get(r.items)))}},{key:"_remove",value:function(e,r){r!=null&&this._target.remove(this._transformItems(r.oldData))}}]),a})(),Jhe=(function(){function a(t){Gt(this,a),Ht(this,"_source",void 0),Ht(this,"_transformers",[]),this._source=t}return Vt(a,[{key:"filter",value:function(e){return this._transformers.push(function(r){return lt(r).call(r,e)}),this}},{key:"map",value:function(e){return this._transformers.push(function(r){return sr(r).call(r,e)}),this}},{key:"flatMap",value:function(e){return this._transformers.push(function(r){return aue(r).call(r,e)}),this}},{key:"to",value:function(e){return new Xhe(this._source,this._transformers,e)}}]),a})();_$=(function(){function a(t){Gt(this,a),Ht(this,"delay",void 0),Ht(this,"max",void 0),Ht(this,"_queue",[]),Ht(this,"_timeout",null),Ht(this,"_extended",null),this.delay=null,this.max=1/0,this.setOptions(t)}return Vt(a,[{key:"setOptions",value:function(e){e&&typeof e.delay!="undefined"&&(this.delay=e.delay),e&&typeof e.max!="undefined"&&(this.max=e.max),this._flushIfNeeded()}},{key:"destroy",value:function(){if(this.flush(),this._extended){for(var e=this._extended.object,r=this._extended.methods,n=0;n<r.length;n++){var s=r[n];s.original?e[s.name]=s.original:delete e[s.name]}this._extended=null}}},{key:"replace",value:function(e,r){var n=this,s=e[r];if(!s)throw new Error("Method "+r+" undefined");e[r]=function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];n.queue({args:l,fn:s,context:this})}}},{key:"queue",value:function(e){typeof e=="function"?this._queue.push({fn:e}):this._queue.push(e),this._flushIfNeeded()}},{key:"_flushIfNeeded",value:function(){var e=this;this._queue.length>this.max&&this.flush(),this._timeout!=null&&(clearTimeout(this._timeout),this._timeout=null),this.queue.length>0&&typeof this.delay=="number"&&(this._timeout=wn(function(){e.flush()},this.delay))}},{key:"flush",value:function(){var e,r;Ue(e=Bn(r=this._queue).call(r,0)).call(e,function(n){n.fn.apply(n.context||n.fn,n.args||[])})}}],[{key:"extend",value:function(e,r){var n=new a(r);if(e.flush!==void 0)throw new Error("Target object already has a property flush");e.flush=function(){n.flush()};var s=[{name:"flush",original:void 0}];if(r&&r.replace)for(var o=0;o<r.replace.length;o++){var l=r.replace[o];s.push({name:l,original:e[l]}),n.replace(e,l)}return n._extended={object:e,methods:s},n}}]),a})(),S$=(function(){function a(){Gt(this,a),Ht(this,"_subscribers",{"*":[],add:[],remove:[],update:[]}),Ht(this,"subscribe",a.prototype.on),Ht(this,"unsubscribe",a.prototype.off)}return Vt(a,[{key:"_trigger",value:function(e,r,n){var s,o;if(e==="*")throw new Error("Cannot trigger event *");Ue(s=Ir(o=[]).call(o,Ur(this._subscribers[e]),Ur(this._subscribers["*"]))).call(s,function(l){l(e,r,n!=null?n:null)})}},{key:"on",value:function(e,r){typeof r=="function"&&this._subscribers[e].push(r)}},{key:"off",value:function(e,r){var n;this._subscribers[e]=lt(n=this._subscribers[e]).call(n,function(s){return s!==r})}}]),a})();T$=mu;UF=(function(){function a(t){Gt(this,a),Ht(this,"_pairs",void 0),this._pairs=t}return Vt(a,[{key:T$,value:ta.mark(function t(){var e,r,n,s,o;return ta.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:e=ra(this._pairs),c.prev=1,e.s();case 3:if((r=e.n()).done){c.next=9;break}return n=Nn(r.value,2),s=n[0],o=n[1],c.next=7,[s,o];case 7:c.next=3;break;case 9:c.next=14;break;case 11:c.prev=11,c.t0=c.catch(1),e.e(c.t0);case 14:return c.prev=14,e.f(),c.finish(14);case 17:case"end":return c.stop()}},t,this,[[1,11,14,17]])})},{key:"entries",value:ta.mark(function t(){var e,r,n,s,o;return ta.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:e=ra(this._pairs),c.prev=1,e.s();case 3:if((r=e.n()).done){c.next=9;break}return n=Nn(r.value,2),s=n[0],o=n[1],c.next=7,[s,o];case 7:c.next=3;break;case 9:c.next=14;break;case 11:c.prev=11,c.t0=c.catch(1),e.e(c.t0);case 14:return c.prev=14,e.f(),c.finish(14);case 17:case"end":return c.stop()}},t,this,[[1,11,14,17]])})},{key:"keys",value:ta.mark(function t(){var e,r,n,s;return ta.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:e=ra(this._pairs),l.prev=1,e.s();case 3:if((r=e.n()).done){l.next=9;break}return n=Nn(r.value,1),s=n[0],l.next=7,s;case 7:l.next=3;break;case 9:l.next=14;break;case 11:l.prev=11,l.t0=l.catch(1),e.e(l.t0);case 14:return l.prev=14,e.f(),l.finish(14);case 17:case"end":return l.stop()}},t,this,[[1,11,14,17]])})},{key:"values",value:ta.mark(function t(){var e,r,n,s;return ta.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:e=ra(this._pairs),l.prev=1,e.s();case 3:if((r=e.n()).done){l.next=9;break}return n=Nn(r.value,2),s=n[1],l.next=7,s;case 7:l.next=3;break;case 9:l.next=14;break;case 11:l.prev=11,l.t0=l.catch(1),e.e(l.t0);case 14:return l.prev=14,e.f(),l.finish(14);case 17:case"end":return l.stop()}},t,this,[[1,11,14,17]])})},{key:"toIdArray",value:function(){var e;return sr(e=Ur(this._pairs)).call(e,function(r){return r[0]})}},{key:"toItemArray",value:function(){var e;return sr(e=Ur(this._pairs)).call(e,function(r){return r[1]})}},{key:"toEntryArray",value:function(){return Ur(this._pairs)}},{key:"toObjectMap",value:function(){var e=Cg(null),r=ra(this._pairs),n;try{for(r.s();!(n=r.n()).done;){var s=Nn(n.value,2),o=s[0],l=s[1];e[o]=l}}catch(c){r.e(c)}finally{r.f()}return e}},{key:"toMap",value:function(){return new l$(this._pairs)}},{key:"toIdSet",value:function(){return new Zl(this.toIdArray())}},{key:"toItemSet",value:function(){return new Zl(this.toItemArray())}},{key:"cache",value:function(){return new a(Ur(this._pairs))}},{key:"distinct",value:function(e){var r=new Zl,n=ra(this._pairs),s;try{for(n.s();!(s=n.n()).done;){var o=Nn(s.value,2),l=o[0],c=o[1];r.add(e(c,l))}}catch(u){n.e(u)}finally{n.f()}return r}},{key:"filter",value:function(e){var r=this._pairs;return new a(Ht({},mu,ta.mark(function n(){var s,o,l,c,u;return ta.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:s=ra(r),h.prev=1,s.s();case 3:if((o=s.n()).done){h.next=10;break}if(l=Nn(o.value,2),c=l[0],u=l[1],!e(u,c)){h.next=8;break}return h.next=8,[c,u];case 8:h.next=3;break;case 10:h.next=15;break;case 12:h.prev=12,h.t0=h.catch(1),s.e(h.t0);case 15:return h.prev=15,s.f(),h.finish(15);case 18:case"end":return h.stop()}},n,null,[[1,12,15,18]])})))}},{key:"forEach",value:function(e){var r=ra(this._pairs),n;try{for(r.s();!(n=r.n()).done;){var s=Nn(n.value,2),o=s[0],l=s[1];e(l,o)}}catch(c){r.e(c)}finally{r.f()}}},{key:"map",value:function(e){var r=this._pairs;return new a(Ht({},mu,ta.mark(function n(){var s,o,l,c,u;return ta.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:s=ra(r),h.prev=1,s.s();case 3:if((o=s.n()).done){h.next=9;break}return l=Nn(o.value,2),c=l[0],u=l[1],h.next=7,[c,e(u,c)];case 7:h.next=3;break;case 9:h.next=14;break;case 11:h.prev=11,h.t0=h.catch(1),s.e(h.t0);case 14:return h.prev=14,s.f(),h.finish(14);case 17:case"end":return h.stop()}},n,null,[[1,11,14,17]])})))}},{key:"max",value:function(e){var r=j_(this._pairs),n=r.next();if(n.done)return null;for(var s=n.value[1],o=e(n.value[1],n.value[0]);!(n=r.next()).done;){var l=Nn(n.value,2),c=l[0],u=l[1],d=e(u,c);d>o&&(o=d,s=u)}return s}},{key:"min",value:function(e){var r=j_(this._pairs),n=r.next();if(n.done)return null;for(var s=n.value[1],o=e(n.value[1],n.value[0]);!(n=r.next()).done;){var l=Nn(n.value,2),c=l[0],u=l[1],d=e(u,c);d<o&&(o=d,s=u)}return s}},{key:"reduce",value:function(e,r){var n=ra(this._pairs),s;try{for(n.s();!(s=n.n()).done;){var o=Nn(s.value,2),l=o[0],c=o[1];r=e(r,c,l)}}catch(u){n.e(u)}finally{n.f()}return r}},{key:"sort",value:function(e){var r=this;return new a(Ht({},mu,function(){var n;return j_(ci(n=Ur(r._pairs)).call(n,function(s,o){var l=Nn(s,2),c=l[0],u=l[1],d=Nn(o,2),h=d[0],f=d[1];return e(u,f,c,h)}))}))}}]),a})();Su=(function(a){Hn(e,a);var t=C$(e);function e(r,n){var s;return Gt(this,e),s=t.call(this),Ht(wr(s),"flush",void 0),Ht(wr(s),"length",void 0),Ht(wr(s),"_options",void 0),Ht(wr(s),"_data",void 0),Ht(wr(s),"_idProp",void 0),Ht(wr(s),"_queue",null),r&&!Tt(r)&&(n=r,r=[]),s._options=n||{},s._data=new l$,s.length=0,s._idProp=s._options.fieldId||"id",r&&r.length&&s.add(r),s.setOptions(n),s}return Vt(e,[{key:"idProp",get:function(){return this._idProp}},{key:"setOptions",value:function(n){n&&n.queue!==void 0&&(n.queue===!1?this._queue&&(this._queue.destroy(),this._queue=null):(this._queue||(this._queue=_$.extend(this,{replace:["add","update","remove"]})),n.queue&&yt(n.queue)==="object"&&this._queue.setOptions(n.queue)))}},{key:"add",value:function(n,s){var o=this,l=[],c;if(Tt(n)){var u=sr(n).call(n,function(f){return f[o._idProp]});if(lk(u).call(u,function(f){return o._data.has(f)}))throw new Error("A duplicate id was found in the parameter array.");for(var d=0,h=n.length;d<h;d++)c=this._addItem(n[d]),l.push(c)}else if(n&&yt(n)==="object")c=this._addItem(n),l.push(c);else throw new Error("Unknown dataType");return l.length&&this._trigger("add",{items:l},s),l}},{key:"update",value:function(n,s){var o=this,l=[],c=[],u=[],d=[],h=this._idProp,f=function(E){var C=E[h];if(C!=null&&o._data.has(C)){var _=E,x=Go({},o._data.get(C)),P=o._updateItem(_);c.push(P),d.push(_),u.push(x)}else{var I=o._addItem(E);l.push(I)}};if(Tt(n))for(var m=0,g=n.length;m<g;m++)n[m]&&yt(n[m])==="object"?f(n[m]):console.warn("Ignoring input item, which is not an object at index "+m);else if(n&&yt(n)==="object")f(n);else throw new Error("Unknown dataType");if(l.length&&this._trigger("add",{items:l},s),c.length){var y={items:c,oldData:u,data:d};this._trigger("update",y,s)}return Ir(l).call(l,c)}},{key:"updateOnly",value:function(n,s){var o,l=this;Tt(n)||(n=[n]);var c=sr(o=sr(n).call(n,function(d){var h=l._data.get(d[l._idProp]);if(h==null)throw new Error("Updating non-existent items is not allowed.");return{oldData:h,update:d}})).call(o,function(d){var h=d.oldData,f=d.update,m=h[l._idProp],g=oB(h,f);return l._data.set(m,g),{id:m,oldData:h,updatedData:g}});if(c.length){var u={items:sr(c).call(c,function(d){return d.id}),oldData:sr(c).call(c,function(d){return d.oldData}),data:sr(c).call(c,function(d){return d.updatedData})};return this._trigger("update",u,s),u.items}else return[]}},{key:"get",value:function(n,s){var o=void 0,l=void 0,c=void 0;WS(n)?(o=n,c=s):Tt(n)?(l=n,c=s):c=n;var u=c&&c.returnType==="Object"?"Object":"Array",d=c&&lt(c),h=[],f=void 0,m=void 0,g=void 0;if(o!=null)f=this._data.get(o),f&&d&&!d(f)&&(f=void 0);else if(l!=null)for(var y=0,v=l.length;y<v;y++)f=this._data.get(l[y]),f!=null&&(!d||d(f))&&h.push(f);else{var E;m=Ur(cu(E=this._data).call(E));for(var C=0,_=m.length;C<_;C++)g=m[C],f=this._data.get(g),f!=null&&(!d||d(f))&&h.push(f)}if(c&&c.order&&o==null&&this._sort(h,c.order),c&&c.fields){var x=c.fields;if(o!=null&&f!=null)f=this._filterFields(f,x);else for(var P=0,I=h.length;P<I;P++)h[P]=this._filterFields(h[P],x)}if(u=="Object"){for(var M={},O=0,R=h.length;O<R;O++){var F=h[O],$=F[this._idProp];M[$]=F}return M}else if(o!=null){var k;return(k=f)!==null&&k!==void 0?k:null}else return h}},{key:"getIds",value:function(n){var s=this._data,o=n&&lt(n),l=n&&n.order,c=Ur(cu(s).call(s)),u=[];if(o)if(l){for(var d=[],h=0,f=c.length;h<f;h++){var m=c[h],g=this._data.get(m);g!=null&&o(g)&&d.push(g)}this._sort(d,l);for(var y=0,v=d.length;y<v;y++)u.push(d[y][this._idProp])}else for(var E=0,C=c.length;E<C;E++){var _=c[E],x=this._data.get(_);x!=null&&o(x)&&u.push(x[this._idProp])}else if(l){for(var P=[],I=0,M=c.length;I<M;I++){var O=c[I];P.push(s.get(O))}this._sort(P,l);for(var R=0,F=P.length;R<F;R++)u.push(P[R][this._idProp])}else for(var $=0,k=c.length;$<k;$++){var N=c[$],G=s.get(N);G!=null&&u.push(G[this._idProp])}return u}},{key:"getDataSet",value:function(){return this}},{key:"forEach",value:function(n,s){var o=s&&lt(s),l=this._data,c=Ur(cu(l).call(l));if(s&&s.order)for(var u=this.get(s),d=0,h=u.length;d<h;d++){var f=u[d],m=f[this._idProp];n(f,m)}else for(var g=0,y=c.length;g<y;g++){var v=c[g],E=this._data.get(v);E!=null&&(!o||o(E))&&n(E,v)}}},{key:"map",value:function(n,s){for(var o=s&&lt(s),l=[],c=this._data,u=Ur(cu(c).call(c)),d=0,h=u.length;d<h;d++){var f=u[d],m=this._data.get(f);m!=null&&(!o||o(m))&&l.push(n(m,f))}return s&&s.order&&this._sort(l,s.order),l}},{key:"_filterFields",value:function(n,s){var o;return n&&S0(o=Tt(s)?s:bi(s)).call(o,function(l,c){return l[c]=n[c],l},{})}},{key:"_sort",value:function(n,s){if(typeof s=="string"){var o=s;ci(n).call(n,function(l,c){var u=l[o],d=c[o];return u>d?1:u<d?-1:0})}else if(typeof s=="function")ci(n).call(n,s);else throw new TypeError("Order must be a function or a string")}},{key:"remove",value:function(n,s){for(var o=[],l=[],c=Tt(n)?n:[n],u=0,d=c.length;u<d;u++){var h=this._remove(c[u]);if(h){var f=h[this._idProp];f!=null&&(o.push(f),l.push(h))}}return o.length&&this._trigger("remove",{items:o,oldData:l},s),o}},{key:"_remove",value:function(n){var s;if(WS(n)?s=n:n&&yt(n)==="object"&&(s=n[this._idProp]),s!=null&&this._data.has(s)){var o=this._data.get(s)||null;return this._data.delete(s),--this.length,o}return null}},{key:"clear",value:function(n){for(var s,o=Ur(cu(s=this._data).call(s)),l=[],c=0,u=o.length;c<u;c++)l.push(this._data.get(o[c]));return this._data.clear(),this.length=0,this._trigger("remove",{items:o,oldData:l},n),o}},{key:"max",value:function(n){var s,o=null,l=null,c=ra(zF(s=this._data).call(s)),u;try{for(c.s();!(u=c.n()).done;){var d=u.value,h=d[n];typeof h=="number"&&(l==null||h>l)&&(o=d,l=h)}}catch(f){c.e(f)}finally{c.f()}return o||null}},{key:"min",value:function(n){var s,o=null,l=null,c=ra(zF(s=this._data).call(s)),u;try{for(c.s();!(u=c.n()).done;){var d=u.value,h=d[n];typeof h=="number"&&(l==null||h<l)&&(o=d,l=h)}}catch(f){c.e(f)}finally{c.f()}return o||null}},{key:"distinct",value:function(n){for(var s=this._data,o=Ur(cu(s).call(s)),l=[],c=0,u=0,d=o.length;u<d;u++){for(var h=o[u],f=s.get(h),m=f[n],g=!1,y=0;y<c;y++)if(l[y]==m){g=!0;break}!g&&m!==void 0&&(l[c]=m,c++)}return l}},{key:"_addItem",value:function(n){var s=Qhe(n,this._idProp),o=s[this._idProp];if(this._data.has(o))throw new Error("Cannot add item: item with id "+o+" already exists");return this._data.set(o,s),++this.length,o}},{key:"_updateItem",value:function(n){var s=n[this._idProp];if(s==null)throw new Error("Cannot update item: item has no id (item: "+na(n)+")");var o=this._data.get(s);if(!o)throw new Error("Cannot update item: no item with id "+s+" found");return this._data.set(s,VF(VF({},o),n)),s}},{key:"stream",value:function(n){if(n){var s=this._data;return new UF(Ht({},mu,ta.mark(function l(){var c,u,d,h;return ta.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:c=ra(n),m.prev=1,c.s();case 3:if((u=c.n()).done){m.next=11;break}if(d=u.value,h=s.get(d),h==null){m.next=9;break}return m.next=9,[d,h];case 9:m.next=3;break;case 11:m.next=16;break;case 13:m.prev=13,m.t0=m.catch(1),c.e(m.t0);case 16:return m.prev=16,c.f(),m.finish(16);case 19:case"end":return m.stop()}},l,null,[[1,13,16,19]])})))}else{var o;return new UF(Ht({},mu,Oe(o=Ohe(this._data)).call(o,this._data)))}}}]),e})(S$),x$=(function(a){Hn(e,a);var t=C$(e);function e(r,n){var s,o;return Gt(this,e),o=t.call(this),Ht(wr(o),"length",0),Ht(wr(o),"_listener",void 0),Ht(wr(o),"_data",void 0),Ht(wr(o),"_ids",new Zl),Ht(wr(o),"_options",void 0),o._options=n||{},o._listener=Oe(s=o._onEvent).call(s,wr(o)),o.setData(r),o}return Vt(e,[{key:"idProp",get:function(){return this.getDataSet().idProp}},{key:"setData",value:function(n){if(this._data){this._data.off&&this._data.off("*",this._listener);var s=this._data.getIds({filter:lt(this._options)}),o=this._data.get(s);this._ids.clear(),this.length=0,this._trigger("remove",{items:s,oldData:o})}if(n!=null){this._data=n;for(var l=this._data.getIds({filter:lt(this._options)}),c=0,u=l.length;c<u;c++){var d=l[c];this._ids.add(d)}this.length=l.length,this._trigger("add",{items:l})}else this._data=new Su;this._data.on&&this._data.on("*",this._listener)}},{key:"refresh",value:function(){for(var n=this._data.getIds({filter:lt(this._options)}),s=Ur(this._ids),o={},l=[],c=[],u=[],d=0,h=n.length;d<h;d++){var f=n[d];o[f]=!0,this._ids.has(f)||(l.push(f),this._ids.add(f))}for(var m=0,g=s.length;m<g;m++){var y=s[m],v=this._data.get(y);v==null?console.error("If you see this, report it please."):o[y]||(c.push(y),u.push(v),this._ids.delete(y))}this.length+=l.length-c.length,l.length&&this._trigger("add",{items:l}),c.length&&this._trigger("remove",{items:c,oldData:u})}},{key:"get",value:function(n,s){if(this._data==null)return null;var o=null,l;WS(n)||Tt(n)?(o=n,l=s):l=n;var c=Go({},this._options,l),u=lt(this._options),d=l&&lt(l);return u&&d&&(c.filter=function(h){return u(h)&&d(h)}),o==null?this._data.get(c):this._data.get(o,c)}},{key:"getIds",value:function(n){if(this._data.length){var s=lt(this._options),o=n!=null?lt(n):null,l;return o?s?l=function(u){return s(u)&&o(u)}:l=o:l=s,this._data.getIds({filter:l,order:n&&n.order})}else return[]}},{key:"forEach",value:function(n,s){if(this._data){var o,l=lt(this._options),c=s&&lt(s),u;c?l?u=function(h){return l(h)&&c(h)}:u=c:u=l,Ue(o=this._data).call(o,n,{filter:u,order:s&&s.order})}}},{key:"map",value:function(n,s){if(this._data){var o,l=lt(this._options),c=s&&lt(s),u;return c?l?u=function(h){return l(h)&&c(h)}:u=c:u=l,sr(o=this._data).call(o,n,{filter:u,order:s&&s.order})}else return[]}},{key:"getDataSet",value:function(){return this._data.getDataSet()}},{key:"stream",value:function(n){var s;return this._data.stream(n||Ht({},mu,Oe(s=cu(this._ids)).call(s,this._ids)))}},{key:"dispose",value:function(){var n;(n=this._data)!==null&&n!==void 0&&n.off&&this._data.off("*",this._listener);var s="This data view has already been disposed of.",o={get:function(){throw new Error(s)},set:function(){throw new Error(s)},configurable:!1},l=ra(eN(e.prototype)),c;try{for(l.s();!(c=l.n()).done;){var u=c.value;Eg(this,u,o)}}catch(d){l.e(d)}finally{l.f()}}},{key:"_onEvent",value:function(n,s,o){if(!(!s||!s.items||!this._data)){var l=s.items,c=[],u=[],d=[],h=[],f=[],m=[];switch(n){case"add":for(var g=0,y=l.length;g<y;g++){var v=l[g],E=this.get(v);E&&(this._ids.add(v),c.push(v))}break;case"update":for(var C=0,_=l.length;C<_;C++){var x=l[C],P=this.get(x);P?this._ids.has(x)?(u.push(x),f.push(s.data[C]),h.push(s.oldData[C])):(this._ids.add(x),c.push(x)):this._ids.has(x)&&(this._ids.delete(x),d.push(x),m.push(s.oldData[C]))}break;case"remove":for(var I=0,M=l.length;I<M;I++){var O=l[I];this._ids.has(O)&&(this._ids.delete(O),d.push(O),m.push(s.oldData[I]))}break}this.length+=c.length-d.length,c.length&&this._trigger("add",{items:c},o),u.length&&this._trigger("update",{items:u,oldData:h,data:f},o),d.length&&this._trigger("remove",{items:d,oldData:m},o)}}}]),e})(S$);bn=typeof window!="undefined"&&window.moment||Ls(),_s=Ls(),US={exports:{}},ei={},rg={exports:{}},Au={};nfe=/javascript\s*\:/img;Au.whiteList=k$();Au.getDefaultWhiteList=k$;Au.onAttr=rfe;Au.onIgnoreAttr=ife;Au.safeAttrValue=afe;sfe={indexOf:function(a,t){var e,r;if(Array.prototype.indexOf)return a.indexOf(t);for(e=0,r=a.length;e<r;e++)if(a[e]===t)return e;return-1},forEach:function(a,t,e){var r,n;if(Array.prototype.forEach)return a.forEach(t,e);for(r=0,n=a.length;r<n;r++)t.call(e,a[r],r,a)},trim:function(a){return String.prototype.trim?a.trim():a.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(a){return String.prototype.trimRight?a.trimRight():a.replace(/(\s*$)/g,"")}},Om=sfe;lfe=ofe,vb=Au,cfe=lfe;D$.prototype.process=function(a){if(a=a||"",a=a.toString(),!a)return"";var t=this,e=t.options,r=e.whiteList,n=e.onAttr,s=e.onIgnoreAttr,o=e.safeAttrValue,l=cfe(a,function(c,u,d,h,f){var m=r[d],g=!1;if(m===!0?g=m:typeof m=="function"?g=m(h):m instanceof RegExp&&(g=m.test(h)),g!==!0&&(g=!1),h=o(d,h),!!h){var y={position:u,sourcePosition:c,source:f,isWhite:g};if(g){var v=n(d,h,y);return jF(v)?d+":"+h:v}else{var v=s(d,h,y);if(!jF(v))return v}}});return l};dfe=D$;(function(a,t){var e=Au,r=dfe;function n(o,l){var c=new r(l);return c.process(o)}t=a.exports=n,t.FilterCSS=r;for(var s in e)t[s]=e[s];typeof window!="undefined"&&(window.filterCSS=a.exports)})(rg,rg.exports);ck={indexOf:function(a,t){var e,r;if(Array.prototype.indexOf)return a.indexOf(t);for(e=0,r=a.length;e<r;e++)if(a[e]===t)return e;return-1},forEach:function(a,t,e){var r,n;if(Array.prototype.forEach)return a.forEach(t,e);for(r=0,n=a.length;r<n;r++)t.call(e,a[r],r,a)},trim:function(a){return String.prototype.trim?a.trim():a.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(a){var t=/\s|\n|\t/,e=t.exec(a);return e?e.index:-1}},hfe=rg.exports.FilterCSS,ffe=rg.exports.getDefaultWhiteList,Ub=ck;L$=new hfe;bfe=/</g,wfe=/>/g,Efe=/"/g,Tfe=/&quot;/g,Cfe=/&#([a-zA-Z0-9]*);?/gim,_fe=/&colon;?/gim,Sfe=/&newline;?/gim,yb=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,YF=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,qF=/u\s*r\s*l\s*\(.*/gi;ei.whiteList=P$();ei.getDefaultWhiteList=P$;ei.onTag=pfe;ei.onIgnoreTag=mfe;ei.onTagAttr=gfe;ei.onIgnoreTagAttr=vfe;ei.safeAttrValue=yfe;ei.escapeHtml=M$;ei.escapeQuote=I$;ei.unescapeQuote=A$;ei.escapeHtmlEntities=O$;ei.escapeDangerHtml5Entities=F$;ei.clearNonPrintableCharacter=R$;ei.friendlyAttrValue=N$;ei.escapeAttrValue=B$;ei.onIgnoreTagStripAll=xfe;ei.StripTagBody=kfe;ei.stripCommentTag=Dfe;ei.stripBlankChar=Pfe;ei.cssFilter=L$;ei.getDefaultCSSWhiteList=ffe;k0={},Gl=ck;Afe=/[^a-zA-Z0-9\\_:.-]/gim;k0.parseTag=Ife;k0.parseAttr=Ofe;$fe=rg.exports.FilterCSS,Ss=ei,$$=k0,zfe=$$.parseTag,Hfe=$$.parseAttr,Lb=ck;z$.prototype.process=function(a){if(a=a||"",a=a.toString(),!a)return"";var t=this,e=t.options,r=e.whiteList,n=e.onTag,s=e.onIgnoreTag,o=e.onTagAttr,l=e.onIgnoreTagAttr,c=e.safeAttrValue,u=e.escapeHtml,d=t.cssFilter;e.stripBlankChar&&(a=Ss.stripBlankChar(a)),e.allowCommentTag||(a=Ss.stripCommentTag(a));var h=!1;e.stripIgnoreTagBody&&(h=Ss.StripTagBody(e.stripIgnoreTagBody,s),s=h.onIgnoreTag);var f=zfe(a,function(m,g,y,v,E){var C={sourcePosition:m,position:g,isClosing:E,isWhite:Object.prototype.hasOwnProperty.call(r,y)},_=n(y,v,C);if(!bb(_))return _;if(C.isWhite){if(C.isClosing)return"</"+y+">";var x=Gfe(v),P=r[y],I=Hfe(x.html,function(M,O){var R=Lb.indexOf(P,M)!==-1,F=o(y,M,O,R);return bb(F)?R?(O=c(y,M,O,d),O?M+'="'+O+'"':M):(F=l(y,M,O,R),bb(F)?void 0:F):F});return v="<"+y,I&&(v+=" "+I),x.closing&&(v+=" /"),v+=">",v}else return _=s(y,v,C),bb(_)?u(v):_},u);return h&&(f=h.remove(f)),f};Ufe=z$;(function(a,t){var e=ei,r=k0,n=Ufe;function s(l,c){var u=new n(c);return u.process(l)}t=a.exports=s,t.filterXSS=s,t.FilterXSS=n,(function(){for(var l in e)t[l]=e[l];for(var c in r)t[c]=r[c]})(),typeof window!="undefined"&&(window.filterXSS=a.exports);function o(){return typeof self!="undefined"&&typeof DedicatedWorkerGlobalScope!="undefined"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=a.exports)})(US,US.exports);jfe=US.exports;Q_=/^\/?Date\((-?\d+)/i,Yfe=/^\d+$/;H$=function(t){var e=new jfe.FilterXSS(t);return function(r){return e.process(r)}},qfe=function(t){return t},jS=H$(),Zfe=function(t){t&&(t.disabled===!0?(jS=qfe,console.warn("You disabled XSS protection for vis-Timeline. I sure hope you know what you're doing!")):t.filterOptions&&(jS=H$(t.filterOptions)))},ae=XF(XF({},gB),{},{convert:uk,setupXSSProtection:Zfe});Eg(ae,"xss",{get:function(){return jS}});G$={exports:{}},V$=nt,Kfe=rr,Xfe=ir,Jfe=so,Qfe=Dx.trim,epe=v0,tpe=Xfe("".charAt),jb=V$.parseFloat,JF=V$.Symbol,QF=JF&&JF.iterator,rpe=1/jb(epe+"-0")!==-1/0||QF&&!Kfe(function(){jb(Object(QF))}),ipe=rpe?function(t){var e=Qfe(Jfe(t)),r=jb(e);return r===0&&tpe(e,0)=="-"?-0:r}:jb,npe=pt,e2=ipe;npe({global:!0,forced:parseFloat!=e2},{parseFloat:e2});ape=fr,spe=ape.parseFloat,ope=spe,lpe=ope;(function(a){a.exports=lpe})(G$);Yb=tt(G$.exports),Zo=(function(){function a(t,e){Gt(this,a),this.options=null,this.props=null}return Vt(a,[{key:"setOptions",value:function(e){e&&ae.extend(this.options,e)}},{key:"redraw",value:function(){return!1}},{key:"destroy",value:function(){}},{key:"_isResized",value:function(){var e=this.props._previousWidth!==this.props.width||this.props._previousHeight!==this.props.height;return this.props._previousWidth=this.props.width,this.props._previousHeight=this.props.height,e}}]),a})(),W$={exports:{}},cpe=nt,upe=ug,dpe=so,hpe=$h,fpe=cpe.RangeError,ppe=function(t){var e=dpe(hpe(this)),r="",n=upe(t);if(n<0||n==1/0)throw fpe("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))n&1&&(r+=e);return r},mpe=pt,gpe=ppe;mpe({target:"String",proto:!0},{repeat:gpe});vpe=jr,ype=vpe("String").repeat,bpe=Tr,wpe=ype,eS=String.prototype,Epe=function(a){var t=a.repeat;return typeof a=="string"||a===eS||bpe(eS,a)&&t===eS.repeat?wpe:t},Tpe=Epe,Cpe=Tpe;(function(a){a.exports=Cpe})(W$);Eh=tt(W$.exports);Spe=Object.freeze({__proto__:null,convertHiddenOptions:D0,updateHiddenDates:ig,removeDuplicates:U$,printDates:_pe,stepOverHiddenDates:j$,toScreen:YS,toTime:qS,getHiddenDurationBetween:Ph,getHiddenDurationBeforeStart:Y$,correctTimeForHidden:ZS,getHiddenDurationBefore:ng,getAccumulatedHiddenDuration:q$,snapAwayFromHidden:Vl,getIsHidden:ag});dk=(function(a){Hn(e,a);var t=xpe(e);function e(r,n){var s,o,l,c,u,d,h,f;Gt(this,e),f=t.call(this);var m=bn().hours(0).minutes(0).seconds(0).milliseconds(0),g=m.clone().add(-3,"days").valueOf(),y=m.clone().add(3,"days").valueOf();return f.millisecondsPerPixelCache=void 0,n===void 0?(f.start=g,f.end=y):(f.start=n.start||g,f.end=n.end||y),f.rolling=!1,f.body=r,f.deltaDifference=0,f.scaleOffset=0,f.startToFront=!1,f.endToFront=!0,f.defaultOptions={rtl:!1,start:null,end:null,moment:bn,direction:"horizontal",moveable:!0,zoomable:!0,min:null,max:null,zoomMin:10,zoomMax:1e3*60*60*24*365*1e4,rollingMode:{follow:!1,offset:.5}},f.options=ae.extend({},f.defaultOptions),f.props={touch:{}},f.animationTimer=null,f.body.emitter.on("panstart",Oe(s=f._onDragStart).call(s,wr(f))),f.body.emitter.on("panmove",Oe(o=f._onDrag).call(o,wr(f))),f.body.emitter.on("panend",Oe(l=f._onDragEnd).call(l,wr(f))),f.body.emitter.on("mousewheel",Oe(c=f._onMouseWheel).call(c,wr(f))),f.body.emitter.on("touch",Oe(u=f._onTouch).call(u,wr(f))),f.body.emitter.on("pinch",Oe(d=f._onPinch).call(d,wr(f))),f.body.dom.rollingModeBtn.addEventListener("click",Oe(h=f.startRolling).call(h,wr(f))),f.setOptions(n),f}return Vt(e,[{key:"setOptions",value:function(n){if(n){var s=["animation","direction","min","max","zoomMin","zoomMax","moveable","zoomable","moment","activate","hiddenDates","zoomKey","zoomFriction","rtl","showCurrentTime","rollingMode","horizontalScroll"];ae.selectiveExtend(s,this.options,n),n.rollingMode&&n.rollingMode.follow&&this.startRolling(),("start"in n||"end"in n)&&this.setRange(n.start,n.end)}}},{key:"startRolling",value:function(){var n=this;function s(){n.stopRolling(),n.rolling=!0;var o=n.end-n.start,l=ae.convert(new Date,"Date").valueOf(),c=n.options.rollingMode&&n.options.rollingMode.offset||.5,u=l-o*c,d=l+o*(1-c),h={animation:!1};n.setRange(u,d,h);var f=n.conversion(n.body.domProps.center.width).scale;o=1/f/10,o<30&&(o=30),o>1e3&&(o=1e3),n.body.dom.rollingModeBtn.style.visibility="hidden",n.currentTimeTimer=wn(s,o)}s()}},{key:"stopRolling",value:function(){this.currentTimeTimer!==void 0&&(clearTimeout(this.currentTimeTimer),this.rolling=!1,this.body.dom.rollingModeBtn.style.visibility="visible")}},{key:"setRange",value:function(n,s,o,l,c){o||(o={}),o.byUser!==!0&&(o.byUser=!1);var u=this,d=n!=null?ae.convert(n,"Date").valueOf():null,h=s!=null?ae.convert(s,"Date").valueOf():null;if(this._cancelAnimation(),this.millisecondsPerPixelCache=void 0,o.animation){var f=this.start,m=this.end,g=yt(o.animation)==="object"&&"duration"in o.animation?o.animation.duration:500,y=yt(o.animation)==="object"&&"easingFunction"in o.animation?o.animation.easingFunction:"easeInOutQuad",v=ae.easingFunctions[y];if(!v){var E;throw new Error(Ir(E="Unknown easing function ".concat(na(y),". Choose from: ")).call(E,bi(ae.easingFunctions).join(", ")))}var C=Pa(),_=!1,x=function M(){if(!u.props.touch.dragging){var O=Pa(),R=O-C,F=v(R/g),$=R>g,k=$||d===null?d:f+(d-f)*F,N=$||h===null?h:m+(h-m)*F;P=u._applyRange(k,N),ig(u.options.moment,u.body,u.options.hiddenDates),_=_||P;var G={start:new Date(u.start),end:new Date(u.end),byUser:o.byUser,event:o.event};if(c&&c(F,P,$),P&&u.body.emitter.emit("rangechange",G),$){if(_&&(u.body.emitter.emit("rangechanged",G),l))return l()}else u.animationTimer=wn(M,20)}};return x()}else{var P=this._applyRange(d,h);if(ig(this.options.moment,this.body,this.options.hiddenDates),P){var I={start:new Date(this.start),end:new Date(this.end),byUser:o.byUser,event:o.event};if(this.body.emitter.emit("rangechange",I),clearTimeout(u.timeoutID),u.timeoutID=wn(function(){u.body.emitter.emit("rangechanged",I)},200),l)return l()}}}},{key:"getMillisecondsPerPixel",value:function(){return this.millisecondsPerPixelCache===void 0&&(this.millisecondsPerPixelCache=(this.end-this.start)/this.body.dom.center.clientWidth),this.millisecondsPerPixelCache}},{key:"_cancelAnimation",value:function(){this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=null)}},{key:"_applyRange",value:function(n,s){var o=n!=null?ae.convert(n,"Date").valueOf():this.start,l=s!=null?ae.convert(s,"Date").valueOf():this.end,c=this.options.max!=null?ae.convert(this.options.max,"Date").valueOf():null,u=this.options.min!=null?ae.convert(this.options.min,"Date").valueOf():null,d;if(isNaN(o)||o===null)throw new Error('Invalid start "'.concat(n,'"'));if(isNaN(l)||l===null)throw new Error('Invalid end "'.concat(s,'"'));if(l<o&&(l=o),u!==null&&o<u&&(d=u-o,o+=d,l+=d,c!=null&&l>c&&(l=c)),c!==null&&l>c&&(d=l-c,o-=d,l-=d,u!=null&&o<u&&(o=u)),this.options.zoomMin!==null){var h=Yb(this.options.zoomMin);if(h<0&&(h=0),l-o<h){var f=.5;this.end-this.start===h&&o>=this.start-f&&l<=this.end?(o=this.start,l=this.end):(d=h-(l-o),o-=d/2,l+=d/2)}}if(this.options.zoomMax!==null){var m=Yb(this.options.zoomMax);m<0&&(m=0),l-o>m&&(this.end-this.start===m&&o<this.start&&l>this.end?(o=this.start,l=this.end):(d=l-o-m,o+=d/2,l-=d/2))}var g=this.start!=o||this.end!=l;return!(o>=this.start&&o<=this.end||l>=this.start&&l<=this.end)&&!(this.start>=o&&this.start<=l||this.end>=o&&this.end<=l)&&this.body.emitter.emit("checkRangedItems"),this.start=o,this.end=l,g}},{key:"getRange",value:function(){return{start:this.start,end:this.end}}},{key:"conversion",value:function(n,s){return e.conversion(this.start,this.end,n,s)}},{key:"_onDragStart",value:function(n){this.deltaDifference=0,this.previousDelta=0,this.options.moveable&&this._isInsideRange(n)&&this.props.touch.allowDragging&&(this.stopRolling(),this.props.touch.start=this.start,this.props.touch.end=this.end,this.props.touch.dragging=!0,this.body.dom.root&&(this.body.dom.root.style.cursor="move"))}},{key:"_onDrag",value:function(n){if(n&&this.props.touch.dragging&&this.options.moveable&&this.props.touch.allowDragging){var s=this.options.direction;t2(s);var o=s=="horizontal"?n.deltaX:n.deltaY;o-=this.deltaDifference;var l=this.props.touch.end-this.props.touch.start,c=Ph(this.body.hiddenDates,this.start,this.end);l-=c;var u=s=="horizontal"?this.body.domProps.center.width:this.body.domProps.center.height,d;this.options.rtl?d=o/u*l:d=-o/u*l;var h=this.props.touch.start+d,f=this.props.touch.end+d,m=Vl(this.body.hiddenDates,h,this.previousDelta-o,!0),g=Vl(this.body.hiddenDates,f,this.previousDelta-o,!0);if(m!=h||g!=f){this.deltaDifference+=o,this.props.touch.start=m,this.props.touch.end=g,this._onDrag(n);return}this.previousDelta=o,this._applyRange(h,f);var y=new Date(this.start),v=new Date(this.end);this.body.emitter.emit("rangechange",{start:y,end:v,byUser:!0,event:n}),this.body.emitter.emit("panmove")}}},{key:"_onDragEnd",value:function(n){this.props.touch.dragging&&this.options.moveable&&this.props.touch.allowDragging&&(this.props.touch.dragging=!1,this.body.dom.root&&(this.body.dom.root.style.cursor="auto"),this.body.emitter.emit("rangechanged",{start:new Date(this.start),end:new Date(this.end),byUser:!0,event:n}))}},{key:"_onMouseWheel",value:function(n){var s=0;if(n.wheelDelta?s=n.wheelDelta/120:n.detail?s=-n.detail/3:n.deltaY&&(s=-n.deltaY/3),!(this.options.zoomKey&&!n[this.options.zoomKey]&&this.options.zoomable||!this.options.zoomable&&this.options.moveable)&&this.options.zoomable&&this.options.moveable&&this._isInsideRange(n)&&s){var o=this.options.zoomFriction||5,l;s<0?l=1-s/o:l=1/(1+s/o);var c;if(this.rolling){var u=this.options.rollingMode&&this.options.rollingMode.offset||.5;c=this.start+(this.end-this.start)*u}else{var d=this.getPointer({x:n.clientX,y:n.clientY},this.body.dom.center);c=this._pointerToDate(d)}this.zoom(l,c,s,n),n.preventDefault()}}},{key:"_onTouch",value:function(n){this.props.touch.start=this.start,this.props.touch.end=this.end,this.props.touch.allowDragging=!0,this.props.touch.center=null,this.props.touch.centerDate=null,this.scaleOffset=0,this.deltaDifference=0,ae.preventDefault(n)}},{key:"_onPinch",value:function(n){if(this.options.zoomable&&this.options.moveable){ae.preventDefault(n),this.props.touch.allowDragging=!1,this.props.touch.center||(this.props.touch.center=this.getPointer(n.center,this.body.dom.center),this.props.touch.centerDate=this._pointerToDate(this.props.touch.center)),this.stopRolling();var s=1/(n.scale+this.scaleOffset),o=this.props.touch.centerDate,l=Ph(this.body.hiddenDates,this.start,this.end),c=ng(this.options.moment,this.body.hiddenDates,this,o),u=l-c,d=o-c+(this.props.touch.start-(o-c))*s,h=o+u+(this.props.touch.end-(o+u))*s;this.startToFront=1-s<=0,this.endToFront=s-1<=0;var f=Vl(this.body.hiddenDates,d,1-s,!0),m=Vl(this.body.hiddenDates,h,s-1,!0);(f!=d||m!=h)&&(this.props.touch.start=f,this.props.touch.end=m,this.scaleOffset=1-n.scale,d=f,h=m);var g={animation:!1,byUser:!0,event:n};this.setRange(d,h,g),this.startToFront=!1,this.endToFront=!0}}},{key:"_isInsideRange",value:function(n){var s=n.center?n.center.x:n.clientX,o=this.body.dom.centerContainer.getBoundingClientRect(),l=this.options.rtl?s-o.left:o.right-s,c=this.body.util.toTime(l);return c>=this.start&&c<=this.end}},{key:"_pointerToDate",value:function(n){var s,o=this.options.direction;if(t2(o),o=="horizontal")return this.body.util.toTime(n.x).valueOf();var l=this.body.domProps.center.height;return s=this.conversion(l),n.y/s.scale+s.offset}},{key:"getPointer",value:function(n,s){var o=s.getBoundingClientRect();return this.options.rtl?{x:o.right-n.x,y:n.y-o.top}:{x:n.x-o.left,y:n.y-o.top}}},{key:"zoom",value:function(n,s,o,l){s==null&&(s=(this.start+this.end)/2);var c=Ph(this.body.hiddenDates,this.start,this.end),u=ng(this.options.moment,this.body.hiddenDates,this,s),d=c-u,h=s-u+(this.start-(s-u))*n,f=s+d+(this.end-(s+d))*n;this.startToFront=!(o>0),this.endToFront=!(-o>0);var m=Vl(this.body.hiddenDates,h,o,!0),g=Vl(this.body.hiddenDates,f,-o,!0);(m!=h||g!=f)&&(h=m,f=g);var y={animation:!1,byUser:!0,event:l};this.setRange(h,f,y),this.startToFront=!1,this.endToFront=!0}},{key:"move",value:function(n){var s=this.end-this.start,o=this.start+s*n,l=this.end+s*n;this.start=o,this.end=l}},{key:"moveTo",value:function(n){var s=(this.start+this.end)/2,o=s-n,l=this.start-o,c=this.end-o,u={animation:!1,byUser:!0,event:null};this.setRange(l,c,u)}}],[{key:"conversion",value:function(n,s,o,l){return l===void 0&&(l=0),o!=0&&s-n!=0?{offset:n,scale:o/(s-n-l)}:{offset:0,scale:1}}}]),e})(Zo);Z$={exports:{}},Dpe=fr,Ppe=Dpe.setInterval;(function(a){a.exports=Ppe})(Z$);Lpe=tt(Z$.exports),wb=null;typeof window!="undefined"?(r2=window.Hammer||Nx,XS=KS(r2,{preventDefault:"mouse"})):XS=function(){return Mpe()};yn=XS;sg=(function(){function a(t,e,r,n,s){Gt(this,a),this.moment=s&&s.moment||bn,this.options=s||{},this.current=this.moment(),this._start=this.moment(),this._end=this.moment(),this.autoScale=!0,this.scale="day",this.step=1,this.setRange(t,e,r),this.switchedDay=!1,this.switchedMonth=!1,this.switchedYear=!1,Tt(n)?this.hiddenDates=n:n!=null?this.hiddenDates=[n]:this.hiddenDates=[],this.format=a.FORMAT}return Vt(a,[{key:"setMoment",value:function(e){this.moment=e,this.current=this.moment(this.current.valueOf()),this._start=this.moment(this._start.valueOf()),this._end=this.moment(this._end.valueOf())}},{key:"setFormat",value:function(e){var r=ae.deepExtend({},a.FORMAT);this.format=ae.deepExtend(r,e)}},{key:"setRange",value:function(e,r,n){if(!(e instanceof Date)||!(r instanceof Date))throw"No legal start or end date in method setRange";this._start=e!=null?this.moment(e.valueOf()):Pa(),this._end=r!=null?this.moment(r.valueOf()):Pa(),this.autoScale&&this.setMinimumStep(n)}},{key:"start",value:function(){this.current=this._start.clone(),this.roundToMinor()}},{key:"roundToMinor",value:function(){switch(this.scale=="week"&&this.current.weekday(0),this.scale){case"year":this.current.year(this.step*Math.floor(this.current.year()/this.step)),this.current.month(0);case"month":this.current.date(1);case"week":case"day":case"weekday":this.current.hours(0);case"hour":this.current.minutes(0);case"minute":this.current.seconds(0);case"second":this.current.milliseconds(0)}if(this.step!=1){var e=this.current.clone();switch(this.scale){case"millisecond":this.current.subtract(this.current.milliseconds()%this.step,"milliseconds");break;case"second":this.current.subtract(this.current.seconds()%this.step,"seconds");break;case"minute":this.current.subtract(this.current.minutes()%this.step,"minutes");break;case"hour":this.current.subtract(this.current.hours()%this.step,"hours");break;case"weekday":case"day":this.current.subtract((this.current.date()-1)%this.step,"day");break;case"week":this.current.subtract(this.current.week()%this.step,"week");break;case"month":this.current.subtract(this.current.month()%this.step,"month");break;case"year":this.current.subtract(this.current.year()%this.step,"year");break}e.isSame(this.current)||(this.current=this.moment(Vl(this.hiddenDates,this.current.valueOf(),-1,!0)))}}},{key:"hasNext",value:function(){return this.current.valueOf()<=this._end.valueOf()}},{key:"next",value:function(){var e=this.current.valueOf();switch(this.scale){case"millisecond":this.current.add(this.step,"millisecond");break;case"second":this.current.add(this.step,"second");break;case"minute":this.current.add(this.step,"minute");break;case"hour":this.current.add(this.step,"hour"),this.current.month()<6?this.current.subtract(this.current.hours()%this.step,"hour"):this.current.hours()%this.step!==0&&this.current.add(this.step-this.current.hours()%this.step,"hour");break;case"weekday":case"day":this.current.add(this.step,"day");break;case"week":if(this.current.weekday()!==0)this.current.weekday(0),this.current.add(this.step,"week");else if(this.options.showMajorLabels===!1)this.current.add(this.step,"week");else{var r=this.current.clone();r.add(1,"week"),r.isSame(this.current,"month")?this.current.add(this.step,"week"):(this.current.add(this.step,"week"),this.current.date(1))}break;case"month":this.current.add(this.step,"month");break;case"year":this.current.add(this.step,"year");break}if(this.step!=1)switch(this.scale){case"millisecond":this.current.milliseconds()>0&&this.current.milliseconds()<this.step&&this.current.milliseconds(0);break;case"second":this.current.seconds()>0&&this.current.seconds()<this.step&&this.current.seconds(0);break;case"minute":this.current.minutes()>0&&this.current.minutes()<this.step&&this.current.minutes(0);break;case"hour":this.current.hours()>0&&this.current.hours()<this.step&&this.current.hours(0);break;case"weekday":case"day":this.current.date()<this.step+1&&this.current.date(1);break;case"week":this.current.week()<this.step&&this.current.week(1);break;case"month":this.current.month()<this.step&&this.current.month(0);break}this.current.valueOf()==e&&(this.current=this._end.clone()),this.switchedDay=!1,this.switchedMonth=!1,this.switchedYear=!1,j$(this.moment,this,e)}},{key:"getCurrent",value:function(){return this.current.clone()}},{key:"setScale",value:function(e){e&&typeof e.scale=="string"&&(this.scale=e.scale,this.step=e.step>0?e.step:1,this.autoScale=!1)}},{key:"setAutoScale",value:function(e){this.autoScale=e}},{key:"setMinimumStep",value:function(e){if(e!=null){var r=1e3*60*60*24*30*12,n=1e3*60*60*24*30,s=1e3*60*60*24,o=1e3*60*60,l=1e3*60,c=1e3,u=1;r*1e3>e&&(this.scale="year",this.step=1e3),r*500>e&&(this.scale="year",this.step=500),r*100>e&&(this.scale="year",this.step=100),r*50>e&&(this.scale="year",this.step=50),r*10>e&&(this.scale="year",this.step=10),r*5>e&&(this.scale="year",this.step=5),r>e&&(this.scale="year",this.step=1),n*3>e&&(this.scale="month",this.step=3),n>e&&(this.scale="month",this.step=1),s*7>e&&this.options.showWeekScale&&(this.scale="week",this.step=1),s*2>e&&(this.scale="day",this.step=2),s>e&&(this.scale="day",this.step=1),s/2>e&&(this.scale="weekday",this.step=1),o*4>e&&(this.scale="hour",this.step=4),o>e&&(this.scale="hour",this.step=1),l*15>e&&(this.scale="minute",this.step=15),l*10>e&&(this.scale="minute",this.step=10),l*5>e&&(this.scale="minute",this.step=5),l>e&&(this.scale="minute",this.step=1),c*15>e&&(this.scale="second",this.step=15),c*10>e&&(this.scale="second",this.step=10),c*5>e&&(this.scale="second",this.step=5),c>e&&(this.scale="second",this.step=1),u*200>e&&(this.scale="millisecond",this.step=200),u*100>e&&(this.scale="millisecond",this.step=100),u*50>e&&(this.scale="millisecond",this.step=50),u*10>e&&(this.scale="millisecond",this.step=10),u*5>e&&(this.scale="millisecond",this.step=5),u>e&&(this.scale="millisecond",this.step=1)}}},{key:"isMajor",value:function(){if(this.switchedYear==!0)switch(this.scale){case"year":case"month":case"week":case"weekday":case"day":case"hour":case"minute":case"second":case"millisecond":return!0;default:return!1}else if(this.switchedMonth==!0)switch(this.scale){case"week":case"weekday":case"day":case"hour":case"minute":case"second":case"millisecond":return!0;default:return!1}else if(this.switchedDay==!0)switch(this.scale){case"millisecond":case"second":case"minute":case"hour":return!0;default:return!1}var e=this.moment(this.current);switch(this.scale){case"millisecond":return e.milliseconds()==0;case"second":return e.seconds()==0;case"minute":return e.hours()==0&&e.minutes()==0;case"hour":return e.hours()==0;case"weekday":case"day":return this.options.showWeekScale?e.isoWeekday()==1:e.date()==1;case"week":return e.date()==1;case"month":return e.month()==0;case"year":return!1;default:return!1}}},{key:"getLabelMinor",value:function(e){if(e==null&&(e=this.current),e instanceof Date&&(e=this.moment(e)),typeof this.format.minorLabels=="function")return this.format.minorLabels(e,this.scale,this.step);var r=this.format.minorLabels[this.scale];switch(this.scale){case"week":if(e.date()===1&&e.weekday()!==0)return"";default:return r&&r.length>0?this.moment(e).format(r):""}}},{key:"getLabelMajor",value:function(e){if(e==null&&(e=this.current),e instanceof Date&&(e=this.moment(e)),typeof this.format.majorLabels=="function")return this.format.majorLabels(e,this.scale,this.step);var r=this.format.majorLabels[this.scale];return r&&r.length>0?this.moment(e).format(r):""}},{key:"getClassName",value:function(){var e,r=this.moment,n=this.moment(this.current),s=n.locale?n.locale("en"):n.lang("en"),o=this.step,l=[];function c(m){return m/o%2==0?" vis-even":" vis-odd"}function u(m){return m.isSame(Pa(),"day")?" vis-today":m.isSame(r().add(1,"day"),"day")?" vis-tomorrow":m.isSame(r().add(-1,"day"),"day")?" vis-yesterday":""}function d(m){return m.isSame(Pa(),"week")?" vis-current-week":""}function h(m){return m.isSame(Pa(),"month")?" vis-current-month":""}function f(m){return m.isSame(Pa(),"year")?" vis-current-year":""}switch(this.scale){case"millisecond":l.push(u(s)),l.push(c(s.milliseconds()));break;case"second":l.push(u(s)),l.push(c(s.seconds()));break;case"minute":l.push(u(s)),l.push(c(s.minutes()));break;case"hour":l.push(Ir(e="vis-h".concat(s.hours())).call(e,this.step==4?"-h"+(s.hours()+4):"")),l.push(u(s)),l.push(c(s.hours()));break;case"weekday":l.push("vis-".concat(s.format("dddd").toLowerCase())),l.push(u(s)),l.push(d(s)),l.push(c(s.date()));break;case"day":l.push("vis-day".concat(s.date())),l.push("vis-".concat(s.format("MMMM").toLowerCase())),l.push(u(s)),l.push(h(s)),l.push(this.step<=2?u(s):""),l.push(this.step<=2?"vis-".concat(s.format("dddd").toLowerCase()):""),l.push(c(s.date()-1));break;case"week":l.push("vis-week".concat(s.format("w"))),l.push(d(s)),l.push(c(s.week()));break;case"month":l.push("vis-".concat(s.format("MMMM").toLowerCase())),l.push(h(s)),l.push(c(s.month()));break;case"year":l.push("vis-year".concat(s.year())),l.push(f(s)),l.push(c(s.year()));break}return lt(l).call(l,String).join(" ")}}],[{key:"snap",value:function(e,r,n){var s=bn(e);if(r=="year"){var o=s.year()+Math.round(s.month()/12);s.year(Math.round(o/n)*n),s.month(0),s.date(0),s.hours(0),s.minutes(0),s.seconds(0),s.milliseconds(0)}else if(r=="month")s.date()>15?(s.date(1),s.add(1,"month")):s.date(1),s.hours(0),s.minutes(0),s.seconds(0),s.milliseconds(0);else if(r=="week")s.weekday()>2?(s.weekday(0),s.add(1,"week")):s.weekday(0),s.hours(0),s.minutes(0),s.seconds(0),s.milliseconds(0);else if(r=="day"){switch(n){case 5:case 2:s.hours(Math.round(s.hours()/24)*24);break;default:s.hours(Math.round(s.hours()/12)*12);break}s.minutes(0),s.seconds(0),s.milliseconds(0)}else if(r=="weekday"){switch(n){case 5:case 2:s.hours(Math.round(s.hours()/12)*12);break;default:s.hours(Math.round(s.hours()/6)*6);break}s.minutes(0),s.seconds(0),s.milliseconds(0)}else if(r=="hour"){switch(n){case 4:s.minutes(Math.round(s.minutes()/60)*60);break;default:s.minutes(Math.round(s.minutes()/30)*30);break}s.seconds(0),s.milliseconds(0)}else if(r=="minute"){switch(n){case 15:case 10:s.minutes(Math.round(s.minutes()/5)*5),s.seconds(0);break;case 5:s.seconds(Math.round(s.seconds()/60)*60);break;default:s.seconds(Math.round(s.seconds()/30)*30);break}s.milliseconds(0)}else if(r=="second")switch(n){case 15:case 10:s.seconds(Math.round(s.seconds()/5)*5),s.milliseconds(0);break;case 5:s.milliseconds(Math.round(s.milliseconds()/1e3)*1e3);break;default:s.milliseconds(Math.round(s.milliseconds()/500)*500);break}else if(r=="millisecond"){var l=n>5?n/2:1;s.milliseconds(Math.round(s.milliseconds()/l)*l)}return s}}]),a})();sg.FORMAT={minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",week:"w",month:"MMM",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",week:"MMMM YYYY",month:"YYYY",year:""}};Ope=`.vis-time-axis {
  position: relative;
  overflow: hidden;
}

.vis-time-axis.vis-foreground {
  top: 0;
  left: 0;
  width: 100%;
}

.vis-time-axis.vis-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.vis-time-axis .vis-text {
  position: absolute;
  color: #4d4d4d;
  padding: 3px;
  overflow: hidden;
  box-sizing: border-box;

  white-space: nowrap;
}

.vis-time-axis .vis-text.vis-measure {
  position: absolute;
  padding-left: 0;
  padding-right: 0;
  margin-left: 0;
  margin-right: 0;
  visibility: hidden;
}

.vis-time-axis .vis-grid.vis-vertical {
  position: absolute;
  border-left: 1px solid;
}

.vis-time-axis .vis-grid.vis-vertical-rtl {
  position: absolute;
  border-right: 1px solid;
}

.vis-time-axis .vis-grid.vis-minor {
  border-color: #e5e5e5;
}

.vis-time-axis .vis-grid.vis-major {
  border-color: #bfbfbf;
}
`;Gn(Ope);og=(function(a){Hn(e,a);var t=Fpe(e);function e(r,n){var s;return Gt(this,e),s=t.call(this),s.dom={foreground:null,lines:[],majorTexts:[],minorTexts:[],redundant:{lines:[],majorTexts:[],minorTexts:[]}},s.props={range:{start:0,end:0,minimumStep:0},lineTop:0},s.defaultOptions={orientation:{axis:"bottom"},showMinorLabels:!0,showMajorLabels:!0,showWeekScale:!1,maxMinorChars:7,format:ae.extend({},sg.FORMAT),moment:bn,timeAxis:null},s.options=ae.extend({},s.defaultOptions),s.body=r,s._create(),s.setOptions(n),s}return Vt(e,[{key:"setOptions",value:function(n){n&&(ae.selectiveExtend(["showMinorLabels","showMajorLabels","showWeekScale","maxMinorChars","hiddenDates","timeAxis","moment","rtl"],this.options,n),ae.selectiveDeepExtend(["format"],this.options,n),"orientation"in n&&(typeof n.orientation=="string"?this.options.orientation.axis=n.orientation:yt(n.orientation)==="object"&&"axis"in n.orientation&&(this.options.orientation.axis=n.orientation.axis)),"locale"in n&&(typeof bn.locale=="function"?bn.locale(n.locale):bn.lang(n.locale)))}},{key:"_create",value:function(){this.dom.foreground=document.createElement("div"),this.dom.background=document.createElement("div"),this.dom.foreground.className="vis-time-axis vis-foreground",this.dom.background.className="vis-time-axis vis-background"}},{key:"destroy",value:function(){this.dom.foreground.parentNode&&this.dom.foreground.parentNode.removeChild(this.dom.foreground),this.dom.background.parentNode&&this.dom.background.parentNode.removeChild(this.dom.background),this.body=null}},{key:"redraw",value:function(){var n=this.props,s=this.dom.foreground,o=this.dom.background,l=this.options.orientation.axis=="top"?this.body.dom.top:this.body.dom.bottom,c=s.parentNode!==l;this._calculateCharSize();var u=this.options.showMinorLabels&&this.options.orientation.axis!=="none",d=this.options.showMajorLabels&&this.options.orientation.axis!=="none";n.minorLabelHeight=u?n.minorCharHeight:0,n.majorLabelHeight=d?n.majorCharHeight:0,n.height=n.minorLabelHeight+n.majorLabelHeight,n.width=s.offsetWidth,n.minorLineHeight=this.body.domProps.root.height-n.majorLabelHeight-(this.options.orientation.axis=="top"?this.body.domProps.bottom.height:this.body.domProps.top.height),n.minorLineWidth=1,n.majorLineHeight=n.minorLineHeight+n.majorLabelHeight,n.majorLineWidth=1;var h=s.nextSibling,f=o.nextSibling;return s.parentNode&&s.parentNode.removeChild(s),o.parentNode&&o.parentNode.removeChild(o),s.style.height="".concat(this.props.height,"px"),this._repaintLabels(),h?l.insertBefore(s,h):l.appendChild(s),f?this.body.dom.backgroundVertical.insertBefore(o,f):this.body.dom.backgroundVertical.appendChild(o),this._isResized()||c}},{key:"_repaintLabels",value:function(){var n=this.options.orientation.axis,s=ae.convert(this.body.range.start,"Number"),o=ae.convert(this.body.range.end,"Number"),l=this.body.util.toTime((this.props.minorCharWidth||10)*this.options.maxMinorChars).valueOf(),c=l-ng(this.options.moment,this.body.hiddenDates,this.body.range,l);c-=this.body.util.toTime(0).valueOf();var u=new sg(new Date(s),new Date(o),c,this.body.hiddenDates,this.options);u.setMoment(this.options.moment),this.options.format&&u.setFormat(this.options.format),this.options.timeAxis&&u.setScale(this.options.timeAxis),this.step=u;var d=this.dom;d.redundant.lines=d.lines,d.redundant.majorTexts=d.majorTexts,d.redundant.minorTexts=d.minorTexts,d.lines=[],d.majorTexts=[],d.minorTexts=[];var h,f,m,g,y,v,E=0,C,_,x=void 0,P=0,I=1e3,M;for(u.start(),f=u.getCurrent(),g=this.body.util.toScreen(f);u.hasNext()&&P<I;){switch(P++,y=u.isMajor(),M=u.getClassName(),h=f,m=g,u.next(),f=u.getCurrent(),g=this.body.util.toScreen(f),C=E,E=g-m,u.scale){case"week":v=!0;break;default:v=E>=C*.4;break}if(this.options.showMinorLabels&&v){var O=this._repaintMinorText(m,u.getLabelMinor(h),n,M);O.style.width="".concat(E,"px")}y&&this.options.showMajorLabels?(m>0&&(x==null&&(x=m),O=this._repaintMajorText(m,u.getLabelMajor(h),n,M)),_=this._repaintMajorLine(m,E,n,M)):v?_=this._repaintMinorLine(m,E,n,M):_&&(_.style.width="".concat(La(_.style.width)+E,"px"))}if(P===I&&!i2&&(console.warn("Something is wrong with the Timeline scale. Limited drawing of grid lines to ".concat(I," lines.")),i2=!0),this.options.showMajorLabels){var R=this.body.util.toTime(0),F=u.getLabelMajor(R),$=F.length*(this.props.majorCharWidth||10)+10;(x==null||$<x)&&this._repaintMajorText(0,F,n,M)}Ue(ae).call(ae,this.dom.redundant,function(k){for(;k.length;){var N=k.pop();N&&N.parentNode&&N.parentNode.removeChild(N)}})}},{key:"_repaintMinorText",value:function(n,s,o,l){var c=this.dom.redundant.minorTexts.shift();if(!c){var u=document.createTextNode("");c=document.createElement("div"),c.appendChild(u),this.dom.foreground.appendChild(c)}this.dom.minorTexts.push(c),c.innerHTML=ae.xss(s);var d=o=="top"?this.props.majorLabelHeight:0;return this._setXY(c,n,d),c.className="vis-text vis-minor ".concat(l),c}},{key:"_repaintMajorText",value:function(n,s,o,l){var c=this.dom.redundant.majorTexts.shift();if(!c){var u=document.createElement("div");c=document.createElement("div"),c.appendChild(u),this.dom.foreground.appendChild(c)}c.childNodes[0].innerHTML=ae.xss(s),c.className="vis-text vis-major ".concat(l);var d=o=="top"?0:this.props.minorLabelHeight;return this._setXY(c,n,d),this.dom.majorTexts.push(c),c}},{key:"_setXY",value:function(n,s,o){var l,c=this.options.rtl?s*-1:s;n.style.transform=Ir(l="translate(".concat(c,"px, ")).call(l,o,"px)")}},{key:"_repaintMinorLine",value:function(n,s,o,l){var c,u=this.dom.redundant.lines.shift();u||(u=document.createElement("div"),this.dom.background.appendChild(u)),this.dom.lines.push(u);var d=this.props;u.style.width="".concat(s,"px"),u.style.height="".concat(d.minorLineHeight,"px");var h=o=="top"?d.majorLabelHeight:this.body.domProps.top.height,f=n-d.minorLineWidth/2;return this._setXY(u,f,h),u.className=Ir(c="vis-grid ".concat(this.options.rtl?"vis-vertical-rtl":"vis-vertical"," vis-minor ")).call(c,l),u}},{key:"_repaintMajorLine",value:function(n,s,o,l){var c,u=this.dom.redundant.lines.shift();u||(u=document.createElement("div"),this.dom.background.appendChild(u)),this.dom.lines.push(u);var d=this.props;u.style.width="".concat(s,"px"),u.style.height="".concat(d.majorLineHeight,"px");var h=o=="top"?0:this.body.domProps.top.height,f=n-d.majorLineWidth/2;return this._setXY(u,f,h),u.className=Ir(c="vis-grid ".concat(this.options.rtl?"vis-vertical-rtl":"vis-vertical"," vis-major ")).call(c,l),u}},{key:"_calculateCharSize",value:function(){this.dom.measureCharMinor||(this.dom.measureCharMinor=document.createElement("DIV"),this.dom.measureCharMinor.className="vis-text vis-minor vis-measure",this.dom.measureCharMinor.style.position="absolute",this.dom.measureCharMinor.appendChild(document.createTextNode("0")),this.dom.foreground.appendChild(this.dom.measureCharMinor)),this.props.minorCharHeight=this.dom.measureCharMinor.clientHeight,this.props.minorCharWidth=this.dom.measureCharMinor.clientWidth,this.dom.measureCharMajor||(this.dom.measureCharMajor=document.createElement("DIV"),this.dom.measureCharMajor.className="vis-text vis-major vis-measure",this.dom.measureCharMajor.style.position="absolute",this.dom.measureCharMajor.appendChild(document.createTextNode("0")),this.dom.foreground.appendChild(this.dom.measureCharMajor)),this.props.majorCharHeight=this.dom.measureCharMajor.clientHeight,this.props.majorCharWidth=this.dom.measureCharMajor.clientWidth}}]),e})(Zo),i2=!1;Npe=`.vis .overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;

  /* Must be displayed above for example selected Timeline items */
  z-index: 10;
}

.vis-active {
  box-shadow: 0 0 10px #86d5f8;
}
`;Gn(Npe);Px(rs.prototype);rs.current=null;rs.prototype.destroy=function(){this.deactivate(),this.dom.overlay.parentNode.removeChild(this.dom.overlay),this.onClick&&document.body.removeEventListener("click",this.onClick),this.keycharm!==void 0&&this.keycharm.destroy(),this.keycharm=null,this.hammer.destroy(),this.hammer=null};rs.prototype.activate=function(){var a;rs.current&&rs.current.deactivate(),rs.current=this,this.active=!0,this.dom.overlay.style.display="none",ae.addClassName(this.dom.container,"vis-active"),this.emit("change"),this.emit("activate"),Oe(a=this.keycharm).call(a,"esc",this.escListener)};rs.prototype.deactivate=function(){rs.current===this&&(rs.current=null),this.active=!1,this.dom.overlay.style.display="",ae.removeClassName(this.dom.container,"vis-active"),this.keycharm.unbind("esc",this.escListener),this.emit("change"),this.emit("deactivate")};rs.prototype._onTapOverlay=function(a){this.activate(),a.stopPropagation()};hk={current:"current",time:"time",deleteSelected:"Delete selected"},$pe=hk,zpe=hk,fk={current:"attuale",time:"tempo",deleteSelected:"Cancella la selezione"},Hpe=fk,Gpe=fk,pk={current:"huidige",time:"tijd",deleteSelected:"Selectie verwijderen"},Vpe=pk,Wpe=pk,J$={current:"Aktuelle",time:"Zeit",deleteSelected:"L\xF6sche Auswahl"},Upe=J$,P0={current:"actuel",time:"heure",deleteSelected:"Effacer la selection"},jpe=P0,Ype=P0,qpe=P0,Q$={current:"corriente",time:"hora",deleteSelected:"Eliminar selecci\xF3n"},Zpe=Q$,ez={current:"\u043F\u043E\u0442\u043E\u0447\u043D\u0438\u0439",time:"\u0447\u0430\u0441",deleteSelected:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u043E\u0431\u0440\u0430\u043D\u0435"},Kpe=ez,tz={current:"\u0442\u0435\u043A\u0443\u0449\u0435\u0435",time:"\u0432\u0440\u0435\u043C\u044F",deleteSelected:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u043E\u0435"},Xpe=tz,rz={current:"aktualny",time:"czas",deleteSelected:"Usu\u0144 wybrane"},Jpe=rz,mk={current:"atual",time:"data",deleteSelected:"Apagar selecionado"},Qpe=mk,eme=mk,iz={current:"\u73FE\u5728",time:"\u6642\u523B",deleteSelected:"\u9078\u629E\u3055\u308C\u305F\u3082\u306E\u3092\u524A\u9664"},tme=iz,nz={current:"nuvarande",time:"tid",deleteSelected:"Radera valda"},rme=nz,L0={current:"n\xE5v\xE6rende",time:"tid",deleteSelected:"Slett valgte"},ime=L0,nme=L0,ame=L0,az={current:"einamas",time:"laikas",deleteSelected:"Pa\u0161alinti pasirinkt\u0105"},sme=az,Bh={en:hk,en_EN:$pe,en_US:zpe,it:fk,it_IT:Hpe,it_CH:Gpe,nl:pk,nl_NL:Vpe,nl_BE:Wpe,de:J$,de_DE:Upe,fr:P0,fr_FR:jpe,fr_CA:Ype,fr_BE:qpe,es:Q$,es_ES:Zpe,uk:ez,uk_UA:Kpe,ru:tz,ru_RU:Xpe,pl:rz,pl_PL:Jpe,pt:mk,pt_BR:Qpe,pt_PT:eme,ja:iz,ja_JP:tme,lt:az,lt_LT:sme,sv:nz,sv_SE:rme,nb:L0,nn:nme,nb_NO:ime,nn_NO:ame},ome=`.vis-custom-time {
  background-color: #6E94FF;
  width: 2px;
  cursor: move;
  z-index: 1;
}

.vis-custom-time > .vis-custom-time-marker {
  background-color: inherit;
  color: white;
  font-size: 12px;
  white-space: nowrap;
  padding: 3px 5px;
  top: 0px;
  cursor: initial;
  z-index: inherit;
}`;Gn(ome);M0=(function(a){Hn(e,a);var t=lme(e);function e(r,n){var s,o;Gt(this,e),o=t.call(this),o.body=r,o.defaultOptions={moment:bn,locales:Bh,locale:"en",id:void 0,title:void 0},o.options=ae.extend({},o.defaultOptions),o.setOptions(n),o.options.locales=ae.extend({},Bh,o.options.locales);var l=o.defaultOptions.locales[o.defaultOptions.locale];return Ue(s=bi(o.options.locales)).call(s,function(c){o.options.locales[c]=ae.extend({},l,o.options.locales[c])}),n&&n.time!=null?o.customTime=n.time:o.customTime=new Date,o.eventParams={},o._create(),o}return Vt(e,[{key:"setOptions",value:function(n){n&&ae.selectiveExtend(["moment","locale","locales","id","title","rtl","snap"],this.options,n)}},{key:"_create",value:function(){var n,s,o,l=document.createElement("div");l["custom-time"]=this,l.className="vis-custom-time ".concat(this.options.id||""),l.style.position="absolute",l.style.top="0px",l.style.height="100%",this.bar=l;var c=document.createElement("div");c.style.position="relative",c.style.top="0px",this.options.rtl?c.style.right="-10px":c.style.left="-10px",c.style.height="100%",c.style.width="20px";function u(d){this.body.range._onMouseWheel(d)}c.addEventListener?(c.addEventListener("mousewheel",Oe(u).call(u,this),!1),c.addEventListener("DOMMouseScroll",Oe(u).call(u,this),!1)):c.attachEvent("onmousewheel",Oe(u).call(u,this)),l.appendChild(c),this.hammer=new yn(c),this.hammer.on("panstart",Oe(n=this._onDragStart).call(n,this)),this.hammer.on("panmove",Oe(s=this._onDrag).call(s,this)),this.hammer.on("panend",Oe(o=this._onDragEnd).call(o,this)),this.hammer.get("pan").set({threshold:5,direction:yn.DIRECTION_ALL}),this.hammer.get("press").set({time:1e4})}},{key:"destroy",value:function(){this.hide(),this.hammer.destroy(),this.hammer=null,this.body=null}},{key:"redraw",value:function(){var n=this.body.dom.backgroundVertical;this.bar.parentNode!=n&&(this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar),n.appendChild(this.bar));var s=this.body.util.toScreen(this.customTime),o=this.options.locales[this.options.locale];o||(this.warned||(console.warn("WARNING: options.locales['".concat(this.options.locale,"'] not found. See https://visjs.github.io/vis-timeline/docs/timeline/#Localization")),this.warned=!0),o=this.options.locales.en);var l=this.options.title;if(l===void 0){var c;l=Ir(c="".concat(o.time,": ")).call(c,this.options.moment(this.customTime).format("dddd, MMMM Do YYYY, H:mm:ss")),l=l.charAt(0).toUpperCase()+l.substring(1)}else typeof l=="function"&&(l=l.call(this,this.customTime));return this.options.rtl?this.bar.style.right="".concat(s,"px"):this.bar.style.left="".concat(s,"px"),this.bar.title=l,!1}},{key:"hide",value:function(){this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar)}},{key:"setCustomTime",value:function(n){this.customTime=ae.convert(n,"Date"),this.redraw()}},{key:"getCustomTime",value:function(){return new Date(this.customTime.valueOf())}},{key:"setCustomMarker",value:function(n,s){var o=document.createElement("div");if(o.className="vis-custom-time-marker",o.innerHTML=ae.xss(n),o.style.position="absolute",s){var l,c;o.setAttribute("contenteditable","true"),o.addEventListener("pointerdown",function(){o.focus()}),o.addEventListener("input",Oe(l=this._onMarkerChange).call(l,this)),o.title=n,o.addEventListener("blur",Oe(c=function(d){this.title!=d.target.innerHTML&&(this._onMarkerChanged(d),this.title=d.target.innerHTML)}).call(c,this))}this.bar.appendChild(o)}},{key:"setCustomTitle",value:function(n){this.options.title=n}},{key:"_onDragStart",value:function(n){this.eventParams.dragging=!0,this.eventParams.customTime=this.customTime,n.stopPropagation()}},{key:"_onDrag",value:function(n){if(this.eventParams.dragging){var s=this.options.rtl?-1*n.deltaX:n.deltaX,o=this.body.util.toScreen(this.eventParams.customTime)+s,l=this.body.util.toTime(o),c=this.body.util.getScale(),u=this.body.util.getStep(),d=this.options.snap,h=d?d(l,c,u):l;this.setCustomTime(h),this.body.emitter.emit("timechange",{id:this.options.id,time:new Date(this.customTime.valueOf()),event:n}),n.stopPropagation()}}},{key:"_onDragEnd",value:function(n){this.eventParams.dragging&&(this.body.emitter.emit("timechanged",{id:this.options.id,time:new Date(this.customTime.valueOf()),event:n}),n.stopPropagation())}},{key:"_onMarkerChange",value:function(n){this.body.emitter.emit("markerchange",{id:this.options.id,title:n.target.innerHTML,event:n}),n.stopPropagation()}},{key:"_onMarkerChanged",value:function(n){this.body.emitter.emit("markerchanged",{id:this.options.id,title:n.target.innerHTML,event:n}),n.stopPropagation()}}],[{key:"customTimeFromTarget",value:function(n){for(var s=n.target;s;){if(s.hasOwnProperty("custom-time"))return s["custom-time"];s=s.parentNode}return null}}]),e})(Zo),ume=`.vis-timeline {
  /*
  -webkit-transition: height .4s ease-in-out;
  transition:         height .4s ease-in-out;
  */
}

.vis-panel {
  /*
  -webkit-transition: height .4s ease-in-out, top .4s ease-in-out;
  transition:         height .4s ease-in-out, top .4s ease-in-out;
  */
}

.vis-axis {
  /*
  -webkit-transition: top .4s ease-in-out;
  transition:         top .4s ease-in-out;
  */
}

/* TODO: get animation working nicely

.vis-item {
  -webkit-transition: top .4s ease-in-out;
  transition:         top .4s ease-in-out;
}

.vis-item.line {
  -webkit-transition: height .4s ease-in-out, top .4s ease-in-out;
  transition:         height .4s ease-in-out, top .4s ease-in-out;
}
/**/`;Gn(ume);dme=`.vis-current-time {
  background-color: #FF7F6E;
  width: 2px;
  z-index: 1;
  pointer-events: none;
}

.vis-rolling-mode-btn {
  height: 40px;
  width: 40px;
  position: absolute;
  top: 7px;
  right: 20px;
  border-radius: 50%;
  font-size: 28px;
  cursor: pointer;
  opacity: 0.8;
  color: white;
  font-weight: bold;
  text-align: center;
  background: #3876c2;
}
.vis-rolling-mode-btn:before {
  content: "\\26F6";
}

.vis-rolling-mode-btn:hover {
  opacity: 1;
}`;Gn(dme);hme=`.vis-panel {
  position: absolute;

  padding: 0;
  margin: 0;

  box-sizing: border-box;
}

.vis-panel.vis-center,
.vis-panel.vis-left,
.vis-panel.vis-right,
.vis-panel.vis-top,
.vis-panel.vis-bottom {
  border: 1px #bfbfbf;
}

.vis-panel.vis-center,
.vis-panel.vis-left,
.vis-panel.vis-right {
  border-top-style: solid;
  border-bottom-style: solid;
  overflow: hidden;
}

.vis-left.vis-panel.vis-vertical-scroll, .vis-right.vis-panel.vis-vertical-scroll {
  height: 100%;
  overflow-x: hidden;
  overflow-y: scroll;
} 

.vis-left.vis-panel.vis-vertical-scroll {
  direction: rtl;
}

.vis-left.vis-panel.vis-vertical-scroll .vis-content {
  direction: ltr;
}

.vis-right.vis-panel.vis-vertical-scroll {
  direction: ltr;
}

.vis-right.vis-panel.vis-vertical-scroll .vis-content {
  direction: rtl;
}

.vis-panel.vis-center,
.vis-panel.vis-top,
.vis-panel.vis-bottom {
  border-left-style: solid;
  border-right-style: solid;
}

.vis-background {
  overflow: hidden;
}

.vis-panel > .vis-content {
  position: relative;
}

.vis-panel .vis-shadow {
  position: absolute;
  width: 100%;
  height: 1px;
  box-shadow: 0 0 10px rgba(0,0,0,0.8);
  /* TODO: find a nice way to ensure vis-shadows are drawn on top of items
  z-index: 1;
  */
}

.vis-panel .vis-shadow.vis-top {
  top: -1px;
  left: 0;
}

.vis-panel .vis-shadow.vis-bottom {
  bottom: -1px;
  left: 0;
}`;Gn(hme);fme=`.vis-graph-group0 {
    fill:#4f81bd;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #4f81bd;
}

.vis-graph-group1 {
    fill:#f79646;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #f79646;
}

.vis-graph-group2 {
    fill: #8c51cf;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #8c51cf;
}

.vis-graph-group3 {
    fill: #75c841;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #75c841;
}

.vis-graph-group4 {
    fill: #ff0100;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #ff0100;
}

.vis-graph-group5 {
    fill: #37d8e6;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #37d8e6;
}

.vis-graph-group6 {
    fill: #042662;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #042662;
}

.vis-graph-group7 {
    fill:#00ff26;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #00ff26;
}

.vis-graph-group8 {
    fill:#ff00ff;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #ff00ff;
}

.vis-graph-group9 {
    fill: #8f3938;
    fill-opacity:0;
    stroke-width:2px;
    stroke: #8f3938;
}

.vis-timeline .vis-fill {
    fill-opacity:0.1;
    stroke: none;
}


.vis-timeline .vis-bar {
    fill-opacity:0.5;
    stroke-width:1px;
}

.vis-timeline .vis-point {
    stroke-width:2px;
    fill-opacity:1.0;
}


.vis-timeline .vis-legend-background {
    stroke-width:1px;
    fill-opacity:0.9;
    fill: #ffffff;
    stroke: #c2c2c2;
}


.vis-timeline .vis-outline {
    stroke-width:1px;
    fill-opacity:1;
    fill: #ffffff;
    stroke: #e5e5e5;
}

.vis-timeline .vis-icon-fill {
    fill-opacity:0.3;
    stroke: none;
}
`;Gn(fme);pme=`
.vis-timeline {
  position: relative;
  border: 1px solid #bfbfbf;
  overflow: hidden;
  padding: 0;
  margin: 0;
  box-sizing: border-box;
}

.vis-loading-screen {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}`;Gn(pme);mme=`/* override some bootstrap styles screwing up the timelines css */

.vis [class*="span"] {
  min-height: 0;
  width: auto;
}
`;Gn(mme);vu=(function(){function a(){Gt(this,a)}return Vt(a,[{key:"_create",value:function(e){var r=this,n,s,o;this.dom={},this.dom.container=e,this.dom.container.style.position="relative",this.dom.root=document.createElement("div"),this.dom.background=document.createElement("div"),this.dom.backgroundVertical=document.createElement("div"),this.dom.backgroundHorizontal=document.createElement("div"),this.dom.centerContainer=document.createElement("div"),this.dom.leftContainer=document.createElement("div"),this.dom.rightContainer=document.createElement("div"),this.dom.center=document.createElement("div"),this.dom.left=document.createElement("div"),this.dom.right=document.createElement("div"),this.dom.top=document.createElement("div"),this.dom.bottom=document.createElement("div"),this.dom.shadowTop=document.createElement("div"),this.dom.shadowBottom=document.createElement("div"),this.dom.shadowTopLeft=document.createElement("div"),this.dom.shadowBottomLeft=document.createElement("div"),this.dom.shadowTopRight=document.createElement("div"),this.dom.shadowBottomRight=document.createElement("div"),this.dom.rollingModeBtn=document.createElement("div"),this.dom.loadingScreen=document.createElement("div"),this.dom.root.className="vis-timeline",this.dom.background.className="vis-panel vis-background",this.dom.backgroundVertical.className="vis-panel vis-background vis-vertical",this.dom.backgroundHorizontal.className="vis-panel vis-background vis-horizontal",this.dom.centerContainer.className="vis-panel vis-center",this.dom.leftContainer.className="vis-panel vis-left",this.dom.rightContainer.className="vis-panel vis-right",this.dom.top.className="vis-panel vis-top",this.dom.bottom.className="vis-panel vis-bottom",this.dom.left.className="vis-content",this.dom.center.className="vis-content",this.dom.right.className="vis-content",this.dom.shadowTop.className="vis-shadow vis-top",this.dom.shadowBottom.className="vis-shadow vis-bottom",this.dom.shadowTopLeft.className="vis-shadow vis-top",this.dom.shadowBottomLeft.className="vis-shadow vis-bottom",this.dom.shadowTopRight.className="vis-shadow vis-top",this.dom.shadowBottomRight.className="vis-shadow vis-bottom",this.dom.rollingModeBtn.className="vis-rolling-mode-btn",this.dom.loadingScreen.className="vis-loading-screen",this.dom.root.appendChild(this.dom.background),this.dom.root.appendChild(this.dom.backgroundVertical),this.dom.root.appendChild(this.dom.backgroundHorizontal),this.dom.root.appendChild(this.dom.centerContainer),this.dom.root.appendChild(this.dom.leftContainer),this.dom.root.appendChild(this.dom.rightContainer),this.dom.root.appendChild(this.dom.top),this.dom.root.appendChild(this.dom.bottom),this.dom.root.appendChild(this.dom.rollingModeBtn),this.dom.centerContainer.appendChild(this.dom.center),this.dom.leftContainer.appendChild(this.dom.left),this.dom.rightContainer.appendChild(this.dom.right),this.dom.centerContainer.appendChild(this.dom.shadowTop),this.dom.centerContainer.appendChild(this.dom.shadowBottom),this.dom.leftContainer.appendChild(this.dom.shadowTopLeft),this.dom.leftContainer.appendChild(this.dom.shadowBottomLeft),this.dom.rightContainer.appendChild(this.dom.shadowTopRight),this.dom.rightContainer.appendChild(this.dom.shadowBottomRight),this.props={root:{},background:{},centerContainer:{},leftContainer:{},rightContainer:{},center:{},left:{},right:{},top:{},bottom:{},border:{},scrollTop:0,scrollTopMin:0},this.on("rangechange",function(){r.initialDrawDone===!0&&r._redraw()}),this.on("rangechanged",function(){r.initialRangeChangeDone||(r.initialRangeChangeDone=!0)}),this.on("touch",Oe(n=this._onTouch).call(n,this)),this.on("panmove",Oe(s=this._onDrag).call(s,this));var l=this;this._origRedraw=Oe(o=this._redraw).call(o,this),this._redraw=ae.throttle(this._origRedraw),this.on("_change",function(v){l.itemSet&&l.itemSet.initialItemSetDrawn&&v&&v.queue==!0?l._redraw():l._origRedraw()}),this.hammer=new yn(this.dom.root);var c=this.hammer.get("pinch").set({enable:!0});c&&Ape(c),this.hammer.get("pan").set({threshold:5,direction:yn.DIRECTION_ALL}),this.timelineListeners={};var u=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];Ue(u).call(u,function(v){var E=function(_){l.isActive()&&l.emit(v,_)};l.hammer.on(v,E),l.timelineListeners[v]=E}),K$(this.hammer,function(v){l.emit("touch",v)}),Ipe(this.hammer,function(v){l.emit("release",v)});function d(v){var E=40,C=800;this.isActive()&&this.emit("mousewheel",v);var _=0,x=0;if("detail"in v&&(x=v.detail*-1),"wheelDelta"in v&&(x=v.wheelDelta),"wheelDeltaY"in v&&(x=v.wheelDeltaY),"wheelDeltaX"in v&&(_=v.wheelDeltaX*-1),"axis"in v&&v.axis===v.HORIZONTAL_AXIS&&(_=x*-1,x=0),"deltaY"in v&&(x=v.deltaY*-1),"deltaX"in v&&(_=v.deltaX),v.deltaMode&&(v.deltaMode===1?(_*=E,x*=E):(_*=E,x*=C)),this.options.preferZoom){if(!this.options.zoomKey||v[this.options.zoomKey])return}else if(this.options.zoomKey&&v[this.options.zoomKey])return;if(!(!this.options.verticalScroll&&!this.options.horizontalScroll)){if(this.options.verticalScroll&&Math.abs(x)>=Math.abs(_)){var P=this.props.scrollTop,I=P+x;if(this.isActive()){var M=this._setScrollTop(I);M!==P&&(this._redraw(),this.emit("scroll",v),v.preventDefault())}}else if(this.options.horizontalScroll){var O=Math.abs(_)>=Math.abs(x)?_:x,R=O/120*(this.range.end-this.range.start)/20,F=this.range.start+R,$=this.range.end+R,k={animation:!1,byUser:!0,event:v};this.range.setRange(F,$,k),v.preventDefault()}}}var h="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":this.dom.centerContainer.addEventListener?"DOMMouseScroll":"onmousewheel";this.dom.top.addEventListener,this.dom.bottom.addEventListener,this.dom.centerContainer.addEventListener(h,Oe(d).call(d,this),!1),this.dom.top.addEventListener(h,Oe(d).call(d,this),!1),this.dom.bottom.addEventListener(h,Oe(d).call(d,this),!1);function f(v){if(l.options.verticalScroll&&(v.preventDefault(),l.isActive())){var E=-v.target.scrollTop;l._setScrollTop(E),l._redraw(),l.emit("scrollSide",v)}}this.dom.left.parentNode.addEventListener("scroll",Oe(f).call(f,this)),this.dom.right.parentNode.addEventListener("scroll",Oe(f).call(f,this));var m=!1;function g(v){var E;if(v.preventDefault&&(l.emit("dragover",l.getEventProperties(v)),v.preventDefault()),Er(E=v.target.className).call(E,"timeline")>-1&&!m)return v.dataTransfer.dropEffect="move",m=!0,!1}function y(v){v.preventDefault&&v.preventDefault(),v.stopPropagation&&v.stopPropagation();try{var E=JSON.parse(v.dataTransfer.getData("text"));if(!E||!E.content)return}catch(C){return!1}return m=!1,v.center={x:v.clientX,y:v.clientY},E.target!=="item"?l.itemSet._onAddItem(v):l.itemSet._onDropObjectOnItem(v),l.emit("drop",l.getEventProperties(v)),!1}if(this.dom.center.addEventListener("dragover",Oe(g).call(g,this),!1),this.dom.center.addEventListener("drop",Oe(y).call(y,this),!1),this.customTimes=[],this.touch={},this.redrawCount=0,this.initialDrawDone=!1,this.initialRangeChangeDone=!1,!e)throw new Error("No container provided");e.appendChild(this.dom.root),e.appendChild(this.dom.loadingScreen)}},{key:"setOptions",value:function(e){var r;if(e){var n=["width","height","minHeight","maxHeight","autoResize","start","end","clickToUse","dataAttributes","hiddenDates","locale","locales","moment","preferZoom","rtl","zoomKey","horizontalScroll","verticalScroll","longSelectPressTime","snap"];if(ae.selectiveExtend(n,this.options,e),this.dom.rollingModeBtn.style.visibility="hidden",this.options.rtl&&(this.dom.container.style.direction="rtl",this.dom.backgroundVertical.className="vis-panel vis-background vis-vertical-rtl"),this.options.verticalScroll&&(this.options.rtl?this.dom.rightContainer.className="vis-panel vis-right vis-vertical-scroll":this.dom.leftContainer.className="vis-panel vis-left vis-vertical-scroll"),yt(this.options.orientation)!=="object"&&(this.options.orientation={item:void 0,axis:void 0}),"orientation"in e&&(typeof e.orientation=="string"?this.options.orientation={item:e.orientation,axis:e.orientation}:yt(e.orientation)==="object"&&("item"in e.orientation&&(this.options.orientation.item=e.orientation.item),"axis"in e.orientation&&(this.options.orientation.axis=e.orientation.axis))),this.options.orientation.axis==="both"){if(!this.timeAxis2){var s=this.timeAxis2=new og(this.body);s.setOptions=function(h){var f=h?ae.extend({},h):{};f.orientation="top",og.prototype.setOptions.call(s,f)},this.components.push(s)}}else if(this.timeAxis2){var o,l=Er(o=this.components).call(o,this.timeAxis2);if(l!==-1){var c;Bn(c=this.components).call(c,l,1)}this.timeAxis2.destroy(),this.timeAxis2=null}typeof e.drawPoints=="function"&&(e.drawPoints={onRender:e.drawPoints}),"hiddenDates"in this.options&&D0(this.options.moment,this.body,this.options.hiddenDates),"clickToUse"in e&&(e.clickToUse?this.activator||(this.activator=new rs(this.dom.root)):this.activator&&(this.activator.destroy(),delete this.activator)),this._initAutoResize()}if(Ue(r=this.components).call(r,function(h){return h.setOptions(e)}),"configure"in e){var u;this.configurator||(this.configurator=this._createConfigurator()),this.configurator.setOptions(e.configure);var d=ae.deepExtend({},this.options);Ue(u=this.components).call(u,function(h){ae.deepExtend(d,h.options)}),this.configurator.setModuleOptions({global:d})}this._redraw()}},{key:"isActive",value:function(){return!this.activator||this.activator.active}},{key:"destroy",value:function(){var e;this.setItems(null),this.setGroups(null),this.off(),this._stopAutoResize(),this.dom.root.parentNode&&this.dom.root.parentNode.removeChild(this.dom.root),this.dom=null,this.activator&&(this.activator.destroy(),delete this.activator);for(var r in this.timelineListeners)this.timelineListeners.hasOwnProperty(r)&&delete this.timelineListeners[r];this.timelineListeners=null,this.hammer&&this.hammer.destroy(),this.hammer=null,Ue(e=this.components).call(e,function(n){return n.destroy()}),this.body=null}},{key:"setCustomTime",value:function(e,r){var n,s=lt(n=this.customTimes).call(n,function(o){return r===o.options.id});if(s.length===0)throw new Error("No custom time bar found with id ".concat(na(r)));s.length>0&&s[0].setCustomTime(e)}},{key:"getCustomTime",value:function(e){var r,n=lt(r=this.customTimes).call(r,function(s){return s.options.id===e});if(n.length===0)throw new Error("No custom time bar found with id ".concat(na(e)));return n[0].getCustomTime()}},{key:"setCustomTimeMarker",value:function(e,r,n){var s,o=lt(s=this.customTimes).call(s,function(l){return l.options.id===r});if(o.length===0)throw new Error("No custom time bar found with id ".concat(na(r)));o.length>0&&o[0].setCustomMarker(e,n)}},{key:"setCustomTimeTitle",value:function(e,r){var n,s=lt(n=this.customTimes).call(n,function(o){return o.options.id===r});if(s.length===0)throw new Error("No custom time bar found with id ".concat(na(r)));if(s.length>0)return s[0].setCustomTitle(e)}},{key:"getEventProperties",value:function(e){return{event:e}}},{key:"addCustomTime",value:function(e,r){var n,s=e!==void 0?ae.convert(e,"Date"):new Date,o=lk(n=this.customTimes).call(n,function(c){return c.options.id===r});if(o)throw new Error("A custom time with id ".concat(na(r)," already exists"));var l=new M0(this.body,ae.extend({},this.options,{time:s,id:r,snap:this.itemSet?this.itemSet.options.snap:this.options.snap}));return this.customTimes.push(l),this.components.push(l),this._redraw(),r}},{key:"removeCustomTime",value:function(e){var r,n=this,s=lt(r=this.customTimes).call(r,function(o){return o.options.id===e});if(s.length===0)throw new Error("No custom time bar found with id ".concat(na(e)));Ue(s).call(s,function(o){var l,c,u,d;Bn(l=n.customTimes).call(l,Er(c=n.customTimes).call(c,o),1),Bn(u=n.components).call(u,Er(d=n.components).call(d,o),1),o.destroy()})}},{key:"getVisibleItems",value:function(){return this.itemSet&&this.itemSet.getVisibleItems()||[]}},{key:"getItemsAtCurrentTime",value:function(e){return this.time=e,this.itemSet&&this.itemSet.getItemsAtCurrentTime(this.time)||[]}},{key:"getVisibleGroups",value:function(){return this.itemSet&&this.itemSet.getVisibleGroups()||[]}},{key:"fit",value:function(e,r){var n=this.getDataRange();if(!(n.min===null&&n.max===null)){var s=n.max-n.min,o=new Date(n.min.valueOf()-s*.01),l=new Date(n.max.valueOf()+s*.01),c=e&&e.animation!==void 0?e.animation:!0;this.range.setRange(o,l,{animation:c},r)}}},{key:"getDataRange",value:function(){throw new Error("Cannot invoke abstract method getDataRange")}},{key:"setWindow",value:function(e,r,n,s){typeof arguments[2]=="function"&&(s=arguments[2],n={});var o,l;arguments.length==1?(l=arguments[0],o=l.animation!==void 0?l.animation:!0,this.range.setRange(l.start,l.end,{animation:o})):arguments.length==2&&typeof arguments[1]=="function"?(l=arguments[0],s=arguments[1],o=l.animation!==void 0?l.animation:!0,this.range.setRange(l.start,l.end,{animation:o},s)):(o=n&&n.animation!==void 0?n.animation:!0,this.range.setRange(e,r,{animation:o},s))}},{key:"moveTo",value:function(e,r,n){typeof arguments[1]=="function"&&(n=arguments[1],r={});var s=this.range.end-this.range.start,o=ae.convert(e,"Date").valueOf(),l=o-s/2,c=o+s/2,u=r&&r.animation!==void 0?r.animation:!0;this.range.setRange(l,c,{animation:u},n)}},{key:"getWindow",value:function(){var e=this.range.getRange();return{start:new Date(e.start),end:new Date(e.end)}}},{key:"zoomIn",value:function(e,r,n){if(!(!e||e<0||e>1)){typeof arguments[1]=="function"&&(n=arguments[1],r={});var s=this.getWindow(),o=s.start.valueOf(),l=s.end.valueOf(),c=l-o,u=c/(1+e),d=(c-u)/2,h=o+d,f=l-d;this.setWindow(h,f,r,n)}}},{key:"zoomOut",value:function(e,r,n){if(!(!e||e<0||e>1)){typeof arguments[1]=="function"&&(n=arguments[1],r={});var s=this.getWindow(),o=s.start.valueOf(),l=s.end.valueOf(),c=l-o,u=o-c*e/2,d=l+c*e/2;this.setWindow(u,d,r,n)}}},{key:"redraw",value:function(){this._redraw()}},{key:"_redraw",value:function(){var e;this.redrawCount++;var r=this.dom;if(!(!r||!r.container||r.root.offsetWidth==0)){var n=!1,s=this.options,o=this.props;ig(this.options.moment,this.body,this.options.hiddenDates),s.orientation=="top"?(ae.addClassName(r.root,"vis-top"),ae.removeClassName(r.root,"vis-bottom")):(ae.removeClassName(r.root,"vis-top"),ae.addClassName(r.root,"vis-bottom")),s.rtl?(ae.addClassName(r.root,"vis-rtl"),ae.removeClassName(r.root,"vis-ltr")):(ae.addClassName(r.root,"vis-ltr"),ae.removeClassName(r.root,"vis-rtl")),r.root.style.maxHeight=ae.option.asSize(s.maxHeight,""),r.root.style.minHeight=ae.option.asSize(s.minHeight,""),r.root.style.width=ae.option.asSize(s.width,"");var l=r.root.offsetWidth;o.border.left=1,o.border.right=1,o.border.top=1,o.border.bottom=1,o.center.height=r.center.offsetHeight,o.left.height=r.left.offsetHeight,o.right.height=r.right.offsetHeight,o.top.height=r.top.clientHeight||-o.border.top,o.bottom.height=Math.round(r.bottom.getBoundingClientRect().height)||r.bottom.clientHeight||-o.border.bottom;var c=Math.max(o.left.height,o.center.height,o.right.height),u=o.top.height+c+o.bottom.height+o.border.top+o.border.bottom;r.root.style.height=ae.option.asSize(s.height,"".concat(u,"px")),o.root.height=r.root.offsetHeight,o.background.height=o.root.height;var d=o.root.height-o.top.height-o.bottom.height;o.centerContainer.height=d,o.leftContainer.height=d,o.rightContainer.height=o.leftContainer.height,o.root.width=l,o.background.width=o.root.width,this.initialDrawDone||(o.scrollbarWidth=ae.getScrollBarWidth());var h=r.leftContainer.clientWidth,f=r.rightContainer.clientWidth;s.verticalScroll?s.rtl?(o.left.width=h||-o.border.left,o.right.width=f+o.scrollbarWidth||-o.border.right):(o.left.width=h+o.scrollbarWidth||-o.border.left,o.right.width=f||-o.border.right):(o.left.width=h||-o.border.left,o.right.width=f||-o.border.right),this._setDOM();var m=this._updateScrollTop();s.orientation.item!="top"&&(m+=Math.max(o.centerContainer.height-o.center.height-o.border.top-o.border.bottom,0)),r.center.style.transform="translateY(".concat(m,"px)");var g=o.scrollTop==0?"hidden":"",y=o.scrollTop==o.scrollTopMin?"hidden":"";r.shadowTop.style.visibility=g,r.shadowBottom.style.visibility=y,r.shadowTopLeft.style.visibility=g,r.shadowBottomLeft.style.visibility=y,r.shadowTopRight.style.visibility=g,r.shadowBottomRight.style.visibility=y,s.verticalScroll&&(r.rightContainer.className="vis-panel vis-right vis-vertical-scroll",r.leftContainer.className="vis-panel vis-left vis-vertical-scroll",r.shadowTopRight.style.visibility="hidden",r.shadowBottomRight.style.visibility="hidden",r.shadowTopLeft.style.visibility="hidden",r.shadowBottomLeft.style.visibility="hidden",r.left.style.top="0px",r.right.style.top="0px"),(!s.verticalScroll||o.center.height<o.centerContainer.height)&&(r.left.style.top="".concat(m,"px"),r.right.style.top="".concat(m,"px"),r.rightContainer.className=r.rightContainer.className.replace(new RegExp("(?:^|\\s)vis-vertical-scroll(?:\\s|$)")," "),r.leftContainer.className=r.leftContainer.className.replace(new RegExp("(?:^|\\s)vis-vertical-scroll(?:\\s|$)")," "),o.left.width=h||-o.border.left,o.right.width=f||-o.border.right,this._setDOM());var v=o.center.height>o.centerContainer.height;this.hammer.get("pan").set({direction:v?yn.DIRECTION_ALL:yn.DIRECTION_HORIZONTAL}),this.hammer.get("press").set({time:this.options.longSelectPressTime}),Ue(e=this.components).call(e,function(C){n=C.redraw()||n});var E=5;if(n)if(this.redrawCount<E){this.body.emitter.emit("_change");return}else console.log("WARNING: infinite loop in redraw?");else this.redrawCount=0;this.body.emitter.emit("changed")}}},{key:"_setDOM",value:function(){var e=this.props,r=this.dom;e.leftContainer.width=e.left.width,e.rightContainer.width=e.right.width;var n=e.root.width-e.left.width-e.right.width;e.center.width=n,e.centerContainer.width=n,e.top.width=n,e.bottom.width=n,r.background.style.height="".concat(e.background.height,"px"),r.backgroundVertical.style.height="".concat(e.background.height,"px"),r.backgroundHorizontal.style.height="".concat(e.centerContainer.height,"px"),r.centerContainer.style.height="".concat(e.centerContainer.height,"px"),r.leftContainer.style.height="".concat(e.leftContainer.height,"px"),r.rightContainer.style.height="".concat(e.rightContainer.height,"px"),r.background.style.width="".concat(e.background.width,"px"),r.backgroundVertical.style.width="".concat(e.centerContainer.width,"px"),r.backgroundHorizontal.style.width="".concat(e.background.width,"px"),r.centerContainer.style.width="".concat(e.center.width,"px"),r.top.style.width="".concat(e.top.width,"px"),r.bottom.style.width="".concat(e.bottom.width,"px"),r.background.style.left="0",r.background.style.top="0",r.backgroundVertical.style.left="".concat(e.left.width+e.border.left,"px"),r.backgroundVertical.style.top="0",r.backgroundHorizontal.style.left="0",r.backgroundHorizontal.style.top="".concat(e.top.height,"px"),r.centerContainer.style.left="".concat(e.left.width,"px"),r.centerContainer.style.top="".concat(e.top.height,"px"),r.leftContainer.style.left="0",r.leftContainer.style.top="".concat(e.top.height,"px"),r.rightContainer.style.left="".concat(e.left.width+e.center.width,"px"),r.rightContainer.style.top="".concat(e.top.height,"px"),r.top.style.left="".concat(e.left.width,"px"),r.top.style.top="0",r.bottom.style.left="".concat(e.left.width,"px"),r.bottom.style.top="".concat(e.top.height+e.centerContainer.height,"px"),r.center.style.left="0",r.left.style.left="0",r.right.style.left="0"}},{key:"setCurrentTime",value:function(e){if(!this.currentTime)throw new Error("Option showCurrentTime must be true");this.currentTime.setCurrentTime(e)}},{key:"getCurrentTime",value:function(){if(!this.currentTime)throw new Error("Option showCurrentTime must be true");return this.currentTime.getCurrentTime()}},{key:"_toTime",value:function(e){return qS(this,e,this.props.center.width)}},{key:"_toGlobalTime",value:function(e){return qS(this,e,this.props.root.width)}},{key:"_toScreen",value:function(e){return YS(this,e,this.props.center.width)}},{key:"_toGlobalScreen",value:function(e){return YS(this,e,this.props.root.width)}},{key:"_initAutoResize",value:function(){this.options.autoResize==!0?this._startAutoResize():this._stopAutoResize()}},{key:"_startAutoResize",value:function(){var e=this;this._stopAutoResize(),this._onResize=function(){if(e.options.autoResize!=!0){e._stopAutoResize();return}if(e.dom.root){var r=e.dom.root.offsetHeight,n=e.dom.root.offsetWidth;(n!=e.props.lastWidth||r!=e.props.lastHeight)&&(e.props.lastWidth=n,e.props.lastHeight=r,e.props.scrollbarWidth=ae.getScrollBarWidth(),e.body.emitter.emit("_change"))}},ae.addEventListener(window,"resize",this._onResize),e.dom.root&&(e.props.lastWidth=e.dom.root.offsetWidth,e.props.lastHeight=e.dom.root.offsetHeight),this.watchTimer=Lpe(this._onResize,1e3)}},{key:"_stopAutoResize",value:function(){this.watchTimer&&(clearInterval(this.watchTimer),this.watchTimer=void 0),this._onResize&&(ae.removeEventListener(window,"resize",this._onResize),this._onResize=null)}},{key:"_onTouch",value:function(e){this.touch.allowDragging=!0,this.touch.initialScrollTop=this.props.scrollTop}},{key:"_onPinch",value:function(e){this.touch.allowDragging=!1}},{key:"_onDrag",value:function(e){if(e&&this.touch.allowDragging){var r=e.deltaY,n=this._getScrollTop(),s=this._setScrollTop(this.touch.initialScrollTop+r);this.options.verticalScroll&&(this.dom.left.parentNode.scrollTop=-this.props.scrollTop,this.dom.right.parentNode.scrollTop=-this.props.scrollTop),s!=n&&this.emit("verticalDrag")}}},{key:"_setScrollTop",value:function(e){return this.props.scrollTop=e,this._updateScrollTop(),this.props.scrollTop}},{key:"_updateScrollTop",value:function(){var e=Math.min(this.props.centerContainer.height-this.props.border.top-this.props.border.bottom-this.props.center.height,0);return e!=this.props.scrollTopMin&&(this.options.orientation.item!="top"&&(this.props.scrollTop+=e-this.props.scrollTopMin),this.props.scrollTopMin=e),this.props.scrollTop>0&&(this.props.scrollTop=0),this.props.scrollTop<e&&(this.props.scrollTop=e),this.options.verticalScroll&&(this.dom.left.parentNode.scrollTop=-this.props.scrollTop,this.dom.right.parentNode.scrollTop=-this.props.scrollTop),this.props.scrollTop}},{key:"_getScrollTop",value:function(){return this.props.scrollTop}},{key:"_createConfigurator",value:function(){throw new Error("Cannot invoke abstract method _createConfigurator")}}]),a})();Px(vu.prototype);gk=(function(a){Hn(e,a);var t=gme(e);function e(r,n){var s,o;Gt(this,e),o=t.call(this),o.body=r,o.defaultOptions={rtl:!1,showCurrentTime:!0,alignCurrentTime:void 0,moment:bn,locales:Bh,locale:"en"},o.options=ae.extend({},o.defaultOptions),o.setOptions(n),o.options.locales=ae.extend({},Bh,o.options.locales);var l=o.defaultOptions.locales[o.defaultOptions.locale];return Ue(s=bi(o.options.locales)).call(s,function(c){o.options.locales[c]=ae.extend({},l,o.options.locales[c])}),o.offset=0,o._create(),o}return Vt(e,[{key:"_create",value:function(){var n=document.createElement("div");n.className="vis-current-time",n.style.position="absolute",n.style.top="0px",n.style.height="100%",this.bar=n}},{key:"destroy",value:function(){this.options.showCurrentTime=!1,this.redraw(),this.body=null}},{key:"setOptions",value:function(n){n&&ae.selectiveExtend(["rtl","showCurrentTime","alignCurrentTime","moment","locale","locales"],this.options,n)}},{key:"redraw",value:function(){if(this.options.showCurrentTime){var n,s,o=this.body.dom.backgroundVertical;this.bar.parentNode!=o&&(this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar),o.appendChild(this.bar),this.start());var l=this.options.moment(Pa()+this.offset);this.options.alignCurrentTime&&(l=l.startOf(this.options.alignCurrentTime));var c=this.body.util.toScreen(l),u=this.options.locales[this.options.locale];u||(this.warned||(console.warn("WARNING: options.locales['".concat(this.options.locale,"'] not found. See https://visjs.github.io/vis-timeline/docs/timeline/#Localization")),this.warned=!0),u=this.options.locales.en);var d=Ir(n=Ir(s="".concat(u.current," ")).call(s,u.time,": ")).call(n,l.format("dddd, MMMM Do YYYY, H:mm:ss"));d=d.charAt(0).toUpperCase()+d.substring(1),this.options.rtl?this.bar.style.transform="translateX(".concat(c*-1,"px)"):this.bar.style.transform="translateX(".concat(c,"px)"),this.bar.title=d}else this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar),this.stop();return!1}},{key:"start",value:function(){var n=this;function s(){n.stop();var o=n.body.range.conversion(n.body.domProps.center.width).scale,l=1/o/10;l<30&&(l=30),l>1e3&&(l=1e3),n.redraw(),n.body.emitter.emit("currentTimeTick"),n.currentTimeTimer=wn(s,l)}s()}},{key:"stop",value:function(){this.currentTimeTimer!==void 0&&(clearTimeout(this.currentTimeTimer),delete this.currentTimeTimer)}},{key:"setCurrentTime",value:function(n){var s=ae.convert(n,"Date").valueOf(),o=Pa();this.offset=s-o,this.redraw()}},{key:"getCurrentTime",value:function(){return new Date(Pa()+this.offset)}}]),e})(Zo),sz={exports:{}},yme=pt,bme=Yo.find,n2="find",oz=!0;n2 in[]&&Array(1)[n2](function(){oz=!1});yme({target:"Array",proto:!0,forced:oz},{find:function(t){return bme(this,t,arguments.length>1?arguments[1]:void 0)}});wme=jr,Eme=wme("Array").find,Tme=Tr,Cme=Eme,tS=Array.prototype,_me=function(a){var t=a.find;return a===tS||Tme(tS,a)&&t===tS.find?Cme:t},Sme=_me,xme=Sme;(function(a){a.exports=xme})(sz);kme=tt(sz.exports),lz={exports:{}},Dme=pt,Pme=Yo.findIndex,a2="findIndex",cz=!0;a2 in[]&&Array(1)[a2](function(){cz=!1});Dme({target:"Array",proto:!0,forced:cz},{findIndex:function(t){return Pme(this,t,arguments.length>1?arguments[1]:void 0)}});Lme=jr,Mme=Lme("Array").findIndex,Ime=Tr,Ame=Mme,rS=Array.prototype,Ome=function(a){var t=a.findIndex;return a===rS||Ime(rS,a)&&t===rS.findIndex?Ame:t},Fme=Ome,Rme=Fme;(function(a){a.exports=Rme})(lz);Nme=tt(lz.exports);ka=.001;Gme=Object.freeze({__proto__:null,orderByStart:uz,orderByEnd:dz,stack:JS,substack:hz,nostack:fz,stackSubgroups:pz,stackSubgroupsWithInnerStack:QS}),Vme="__ungrouped__",Wme="__background__",o2={UNGROUPED:Vme,BACKGROUND:Wme},qb=(function(){function a(t,e,r){var n=this;if(Gt(this,a),this.groupId=t,this.subgroups={},this.subgroupStack={},this.subgroupStackAll=!1,this.subgroupVisibility={},this.doInnerStack=!1,this.shouldBailStackItems=!1,this.subgroupIndex=0,this.subgroupOrderer=e&&e.subgroupOrder,this.itemSet=r,this.isVisible=null,this.stackDirty=!0,this._disposeCallbacks=[],e&&e.nestedGroups&&(this.nestedGroups=e.nestedGroups,e.showNested==!1?this.showNested=!1:this.showNested=!0),e&&e.subgroupStack)if(typeof e.subgroupStack=="boolean")this.doInnerStack=e.subgroupStack,this.subgroupStackAll=e.subgroupStack;else for(var s in e.subgroupStack)this.subgroupStack[s]=e.subgroupStack[s],this.doInnerStack=this.doInnerStack||e.subgroupStack[s];e&&e.heightMode?this.heightMode=e.heightMode:this.heightMode=r.options.groupHeightMode,this.nestedInGroup=null,this.dom={},this.props={label:{width:0,height:0}},this.className=null,this.items={},this.visibleItems=[],this.itemsInRange=[],this.orderedItems={byStart:[],byEnd:[]},this.checkRangedItems=!1;var o=function(){n.checkRangedItems=!0};this.itemSet.body.emitter.on("checkRangedItems",o),this._disposeCallbacks.push(function(){n.itemSet.body.emitter.off("checkRangedItems",o)}),this._create(),this.setData(e)}return Vt(a,[{key:"_create",value:function(){var e=document.createElement("div");this.itemSet.options.groupEditable.order?e.className="vis-label draggable":e.className="vis-label",this.dom.label=e;var r=document.createElement("div");r.className="vis-inner",e.appendChild(r),this.dom.inner=r;var n=document.createElement("div");n.className="vis-group",n["vis-group"]=this,this.dom.foreground=n,this.dom.background=document.createElement("div"),this.dom.background.className="vis-group",this.dom.axis=document.createElement("div"),this.dom.axis.className="vis-group",this.dom.marker=document.createElement("div"),this.dom.marker.style.visibility="hidden",this.dom.marker.style.position="absolute",this.dom.marker.innerHTML="",this.dom.background.appendChild(this.dom.marker)}},{key:"setData",value:function(e){if(!this.itemSet.groupTouchParams.isDragging){var r,n;if(e&&e.subgroupVisibility)for(var s in e.subgroupVisibility)this.subgroupVisibility[s]=e.subgroupVisibility[s];if(this.itemSet.options&&this.itemSet.options.groupTemplate){var o;n=Oe(o=this.itemSet.options.groupTemplate).call(o,this),r=n(e,this.dom.inner)}else r=e&&e.content;if(r instanceof Element){for(;this.dom.inner.firstChild;)this.dom.inner.removeChild(this.dom.inner.firstChild);this.dom.inner.appendChild(r)}else r instanceof Object&&r.isReactComponent||(r instanceof Object?n(e,this.dom.inner):r!=null?this.dom.inner.innerHTML=ae.xss(r):this.dom.inner.innerHTML=ae.xss(this.groupId||""));this.dom.label.title=e&&e.title||"",this.dom.inner.firstChild?ae.removeClassName(this.dom.inner,"vis-hidden"):ae.addClassName(this.dom.inner,"vis-hidden"),e&&e.nestedGroups?((!this.nestedGroups||this.nestedGroups!=e.nestedGroups)&&(this.nestedGroups=e.nestedGroups),(e.showNested!==void 0||this.showNested===void 0)&&(e.showNested==!1?this.showNested=!1:this.showNested=!0),ae.addClassName(this.dom.label,"vis-nesting-group"),this.showNested?(ae.removeClassName(this.dom.label,"collapsed"),ae.addClassName(this.dom.label,"expanded")):(ae.removeClassName(this.dom.label,"expanded"),ae.addClassName(this.dom.label,"collapsed"))):this.nestedGroups&&(this.nestedGroups=null,ae.removeClassName(this.dom.label,"collapsed"),ae.removeClassName(this.dom.label,"expanded"),ae.removeClassName(this.dom.label,"vis-nesting-group")),e&&(e.treeLevel||e.nestedInGroup)?(ae.addClassName(this.dom.label,"vis-nested-group"),e.treeLevel?ae.addClassName(this.dom.label,"vis-group-level-"+e.treeLevel):ae.addClassName(this.dom.label,"vis-group-level-unknown-but-gte1")):ae.addClassName(this.dom.label,"vis-group-level-0");var l=e&&e.className||null;l!=this.className&&(this.className&&(ae.removeClassName(this.dom.label,this.className),ae.removeClassName(this.dom.foreground,this.className),ae.removeClassName(this.dom.background,this.className),ae.removeClassName(this.dom.axis,this.className)),ae.addClassName(this.dom.label,l),ae.addClassName(this.dom.foreground,l),ae.addClassName(this.dom.background,l),ae.addClassName(this.dom.axis,l),this.className=l),this.style&&(ae.removeCssText(this.dom.label,this.style),this.style=null),e&&e.style&&(ae.addCssText(this.dom.label,e.style),this.style=e.style)}}},{key:"getLabelWidth",value:function(){return this.props.label.width}},{key:"_didMarkerHeightChange",value:function(){var e=this.dom.marker.clientHeight;if(e!=this.lastMarkerHeight){this.lastMarkerHeight=e;var r={},n=0;Ue(ae).call(ae,this.items,function(c,u){if(c.dirty=!0,c.displayed){var d=!0;r[u]=c.redraw(d),n=r[u].length}});var s=n>0;if(s)for(var o=function(u){Ue(ae).call(ae,r,function(d){d[u]()})},l=0;l<n;l++)o(l);return!0}else return!1}},{key:"_calculateGroupSizeAndPosition",value:function(){var e=this.dom.foreground,r=e.offsetTop,n=e.offsetLeft,s=e.offsetWidth;this.top=r,this.right=n,this.width=s}},{key:"_shouldBailItemsRedraw",value:function(){var e=this,r=this.itemSet.options.onTimeout,n={relativeBailingTime:this.itemSet.itemsSettingTime,bailTimeMs:r&&r.timeoutMs,userBailFunction:r&&r.callback,shouldBailStackItems:this.shouldBailStackItems},s=null;if(!this.itemSet.initialDrawDone){if(n.shouldBailStackItems)return!0;Math.abs(Pa()-new Date(n.relativeBailingTime))>n.bailTimeMs&&(n.userBailFunction&&this.itemSet.userContinueNotBail==null?n.userBailFunction(function(o){e.itemSet.userContinueNotBail=o,s=!o}):e.itemSet.userContinueNotBail==!1?s=!0:s=!1)}return s}},{key:"_redrawItems",value:function(e,r,n,s){var o=this,l=e||this.stackDirty||this.isVisible&&!r;if(l){var c,u,d,h,f,m,g={byEnd:lt(c=this.orderedItems.byEnd).call(c,function(k){return!k.isCluster}),byStart:lt(u=this.orderedItems.byStart).call(u,function(k){return!k.isCluster})},y={byEnd:Ur(new Zl(lt(d=sr(h=this.orderedItems.byEnd).call(h,function(k){return k.cluster})).call(d,function(k){return!!k}))),byStart:Ur(new Zl(lt(f=sr(m=this.orderedItems.byStart).call(m,function(k){return k.cluster})).call(f,function(k){return!!k})))},v=function(){var N,G,W,Y=o._updateItemsInRange(g,lt(N=o.visibleItems).call(N,function(Z){return!Z.isCluster}),s),U=o._updateClustersInRange(y,lt(G=o.visibleItems).call(G,function(Z){return Z.isCluster}),s);return Ir(W=[]).call(W,Ur(Y),Ur(U))},E=function(N){var G={},W=function(Z){var q,X=lt(q=o.visibleItems).call(q,function(ie){return ie.data.subgroup===Z});G[Z]=N?ci(X).call(X,function(ie,j){return N(ie.data,j.data)}):X};for(var Y in o.subgroups)W(Y);return G};if(typeof this.itemSet.options.order=="function"){var C=this;if(this.doInnerStack&&this.itemSet.options.stackSubgroups){var _=E(this.itemSet.options.order);QS(_,n,this.subgroups),this.visibleItems=v(),this._updateSubGroupHeights(n)}else{var x,P,I,M;this.visibleItems=v(),this._updateSubGroupHeights(n);var O=ci(x=lt(P=En(I=this.visibleItems).call(I)).call(P,function(k){return k.isCluster||!k.isCluster&&!k.cluster})).call(x,function(k,N){return C.itemSet.options.order(k.data,N.data)});this.shouldBailStackItems=JS(O,n,!0,Oe(M=this._shouldBailItemsRedraw).call(M,this))}}else if(this.visibleItems=v(),this._updateSubGroupHeights(n),this.itemSet.options.stack)if(this.doInnerStack&&this.itemSet.options.stackSubgroups){var R=E();QS(R,n,this.subgroups)}else{var F;this.shouldBailStackItems=JS(this.visibleItems,n,!0,Oe(F=this._shouldBailItemsRedraw).call(F,this))}else fz(this.visibleItems,n,this.subgroups,this.itemSet.options.stackSubgroups);for(var $=0;$<this.visibleItems.length;$++)this.visibleItems[$].repositionX(),this.subgroupVisibility[this.visibleItems[$].data.subgroup]!==void 0&&(this.subgroupVisibility[this.visibleItems[$].data.subgroup]||this.visibleItems[$].hide());this.itemSet.options.cluster&&Ue(ae).call(ae,this.items,function(k){k.cluster&&k.displayed&&k.hide()}),this.shouldBailStackItems&&this.itemSet.body.emitter.emit("destroyTimeline"),this.stackDirty=!1}}},{key:"_didResize",value:function(e,r){e=ae.updateProperty(this,"height",r)||e;var n=this.dom.inner.clientWidth,s=this.dom.inner.clientHeight;return e=ae.updateProperty(this.props.label,"width",n)||e,e=ae.updateProperty(this.props.label,"height",s)||e,e}},{key:"_applyGroupHeight",value:function(e){this.dom.background.style.height="".concat(e,"px"),this.dom.foreground.style.height="".concat(e,"px"),this.dom.label.style.height="".concat(e,"px")}},{key:"_updateItemsVerticalPosition",value:function(e){for(var r=0,n=this.visibleItems.length;r<n;r++){var s=this.visibleItems[r];s.repositionY(e),!this.isVisible&&this.groupId!=o2.BACKGROUND&&s.displayed&&s.hide()}}},{key:"redraw",value:function(e,r,n,s){var o=this,l,c,u,d,h,f=!1,m=this.isVisible,g,y=[function(){n=o._didMarkerHeightChange.call(o)||n},Oe(l=this._updateSubGroupHeights).call(l,this,r),Oe(c=this._calculateGroupSizeAndPosition).call(c,this),function(){var E;o.isVisible=Oe(E=o._isGroupVisible).call(E,o)(e,r)},function(){var E;Oe(E=o._redrawItems).call(E,o)(n,m,r,e)},Oe(u=this._updateSubgroupsSizes).call(u,this),function(){var E;g=Oe(E=o._calculateHeight).call(E,o)(r)},Oe(d=this._calculateGroupSizeAndPosition).call(d,this),function(){var E;f=Oe(E=o._didResize).call(E,o)(f,g)},function(){var E;Oe(E=o._applyGroupHeight).call(E,o)(g)},function(){var E;Oe(E=o._updateItemsVerticalPosition).call(E,o)(r)},Oe(h=function(){return!o.isVisible&&o.height&&(f=!1),f}).call(h,this)];if(s)return y;var v;return Ue(y).call(y,function(E){v=E()}),v}},{key:"_updateSubGroupHeights",value:function(e){var r=this;if(bi(this.subgroups).length>0){var n=this;this._resetSubgroups(),Ue(ae).call(ae,this.visibleItems,function(s){s.data.subgroup!==void 0&&(n.subgroups[s.data.subgroup].height=Math.max(n.subgroups[s.data.subgroup].height,s.height+e.item.vertical),n.subgroups[s.data.subgroup].visible=typeof r.subgroupVisibility[s.data.subgroup]=="undefined"?!0:!!r.subgroupVisibility[s.data.subgroup])})}}},{key:"_isGroupVisible",value:function(e,r){return this.top<=e.body.domProps.centerContainer.height-e.body.domProps.scrollTop+r.axis&&this.top+this.height+r.axis>=-e.body.domProps.scrollTop}},{key:"_calculateHeight",value:function(e){var r,n;if(this.heightMode==="fixed"?n=ae.toArray(this.items):n=this.visibleItems,n.length>0){var s=n[0].top,o=n[0].top+n[0].height;if(Ue(ae).call(ae,n,function(c){s=Math.min(s,c.top),o=Math.max(o,c.top+c.height)}),s>e.axis){var l=s-e.axis;o-=l,Ue(ae).call(ae,n,function(c){c.top-=l})}r=Math.ceil(o+e.item.vertical/2),this.heightMode!=="fitItems"&&(r=Math.max(r,this.props.label.height))}else r=this.props.label.height;return r}},{key:"show",value:function(){this.dom.label.parentNode||this.itemSet.dom.labelSet.appendChild(this.dom.label),this.dom.foreground.parentNode||this.itemSet.dom.foreground.appendChild(this.dom.foreground),this.dom.background.parentNode||this.itemSet.dom.background.appendChild(this.dom.background),this.dom.axis.parentNode||this.itemSet.dom.axis.appendChild(this.dom.axis)}},{key:"hide",value:function(){var e=this.dom.label;e.parentNode&&e.parentNode.removeChild(e);var r=this.dom.foreground;r.parentNode&&r.parentNode.removeChild(r);var n=this.dom.background;n.parentNode&&n.parentNode.removeChild(n);var s=this.dom.axis;s.parentNode&&s.parentNode.removeChild(s)}},{key:"add",value:function(e){var r;if(this.items[e.id]=e,e.setParent(this),this.stackDirty=!0,e.data.subgroup!==void 0&&(this._addToSubgroup(e),this.orderSubgroups()),!Kl(r=this.visibleItems).call(r,e)){var n=this.itemSet.body.range;this._checkIfVisible(e,this.visibleItems,n)}}},{key:"_addToSubgroup",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.data.subgroup;r!=null&&this.subgroups[r]===void 0&&(this.subgroups[r]={height:0,top:0,start:e.data.start,end:e.data.end||e.data.start,visible:!1,index:this.subgroupIndex,items:[],stack:this.subgroupStackAll||this.subgroupStack[r]||!1},this.subgroupIndex++),new Date(e.data.start)<new Date(this.subgroups[r].start)&&(this.subgroups[r].start=e.data.start);var n=e.data.end||e.data.start;new Date(n)>new Date(this.subgroups[r].end)&&(this.subgroups[r].end=n),this.subgroups[r].items.push(e)}},{key:"_updateSubgroupsSizes",value:function(){var e=this;if(e.subgroups){var r=function(o){var l,c=e.subgroups[o].items[0].data.end||e.subgroups[o].items[0].data.start,u=e.subgroups[o].items[0].data.start,d=c-1;Ue(l=e.subgroups[o].items).call(l,function(h){new Date(h.data.start)<new Date(u)&&(u=h.data.start);var f=h.data.end||h.data.start;new Date(f)>new Date(d)&&(d=f)}),e.subgroups[o].start=u,e.subgroups[o].end=new Date(d-1)};for(var n in e.subgroups)r(n)}}},{key:"orderSubgroups",value:function(){if(this.subgroupOrderer!==void 0){var e=[];if(typeof this.subgroupOrderer=="string"){for(var r in this.subgroups)e.push({subgroup:r,sortField:this.subgroups[r].items[0].data[this.subgroupOrderer]});ci(e).call(e,function(o,l){return o.sortField-l.sortField})}else if(typeof this.subgroupOrderer=="function"){for(var n in this.subgroups)e.push(this.subgroups[n].items[0].data);ci(e).call(e,this.subgroupOrderer)}if(e.length>0)for(var s=0;s<e.length;s++)this.subgroups[e[s].subgroup].index=s}}},{key:"_resetSubgroups",value:function(){for(var e in this.subgroups)this.subgroups.hasOwnProperty(e)&&(this.subgroups[e].visible=!1,this.subgroups[e].height=0)}},{key:"remove",value:function(e){var r,n;delete this.items[e.id],e.setParent(null),this.stackDirty=!0;var s=Er(r=this.visibleItems).call(r,e);s!=-1&&Bn(n=this.visibleItems).call(n,s,1),e.data.subgroup!==void 0&&(this._removeFromSubgroup(e),this.orderSubgroups())}},{key:"_removeFromSubgroup",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.data.subgroup;if(r!=null){var n=this.subgroups[r];if(n){var s,o=Er(s=n.items).call(s,e);if(o>=0){var l;Bn(l=n.items).call(l,o,1),n.items.length?this._updateSubgroupsSizes():delete this.subgroups[r]}}}}},{key:"removeFromDataSet",value:function(e){this.itemSet.removeItem(e.id)}},{key:"order",value:function(){for(var e=ae.toArray(this.items),r=[],n=[],s=0;s<e.length;s++)e[s].data.end!==void 0&&n.push(e[s]),r.push(e[s]);this.orderedItems={byStart:r,byEnd:n},uz(this.orderedItems.byStart),dz(this.orderedItems.byEnd)}},{key:"_updateItemsInRange",value:function(e,r,n){var s=[],o={};if(!this.isVisible&&this.groupId!=o2.BACKGROUND){for(var l=0;l<r.length;l++){var c=r[l];c.displayed&&c.hide()}return s}var u=(n.end-n.start)/4,d=n.start-u,h=n.end+u,f=function(k){return k<d?-1:k<=h?0:1},m=function(k){var N=k.start,G=k.end;return G<d?-1:N<=h?0:1};if(r.length>0)for(var g=0;g<r.length;g++)this._checkIfVisibleWithReference(r[g],s,o,n);var y=ae.binarySearchCustom(e.byStart,f,"data","start");if(this._traceVisible(y,e.byStart,s,o,function($){return $.data.start<d||$.data.start>h}),this.checkRangedItems==!0){this.checkRangedItems=!1;for(var v=0;v<e.byEnd.length;v++)this._checkIfVisibleWithReference(e.byEnd[v],s,o,n)}else{var E=ae.binarySearchCustom(e.byEnd,m,"data");this._traceVisible(E,e.byEnd,s,o,function($){return $.data.end<d||$.data.start>h})}for(var C={},_=0,x=0;x<s.length;x++){var P=s[x];if(!P.displayed){var I=!0;C[x]=P.redraw(I),_=C[x].length}}var M=_>0;if(M)for(var O=function(k){Ue(ae).call(ae,C,function(N){N[k]()})},R=0;R<_;R++)O(R);for(var F=0;F<s.length;F++)s[F].repositionX();return s}},{key:"_traceVisible",value:function(e,r,n,s,o){if(e!=-1){for(var l=e;l>=0;l--){var c=r[l];if(o(c))break;!(c.isCluster&&!c.hasItems())&&!c.cluster&&s[c.id]===void 0&&(s[c.id]=!0,n.push(c))}for(var u=e+1;u<r.length;u++){var d=r[u];if(o(d))break;!(d.isCluster&&!d.hasItems())&&!d.cluster&&s[d.id]===void 0&&(s[d.id]=!0,n.push(d))}}}},{key:"_checkIfVisible",value:function(e,r,n){e.isVisible(n)?(e.displayed||e.show(),e.repositionX(),r.push(e)):e.displayed&&e.hide()}},{key:"_checkIfVisibleWithReference",value:function(e,r,n,s){e.isVisible(s)?n[e.id]===void 0&&(n[e.id]=!0,r.push(e)):e.displayed&&e.hide()}},{key:"_updateClustersInRange",value:function(e,r,n){var s=[],o={};if(r.length>0)for(var l=0;l<r.length;l++)this._checkIfVisibleWithReference(r[l],s,o,n);for(var c=0;c<e.byStart.length;c++)this._checkIfVisibleWithReference(e.byStart[c],s,o,n);for(var u=0;u<e.byEnd.length;u++)this._checkIfVisibleWithReference(e.byEnd[u],s,o,n);for(var d={},h=0,f=0;f<s.length;f++){var m=s[f];if(!m.displayed){var g=!0;d[f]=m.redraw(g),h=d[f].length}}var y=h>0;if(y)for(var v=0;v<h;v++)Ue(ae).call(ae,d,function(C){C[v]()});for(var E=0;E<s.length;E++)s[E].repositionX();return s}},{key:"changeSubgroup",value:function(e,r,n){this._removeFromSubgroup(e,r),this._addToSubgroup(e,n),this.orderSubgroups()}},{key:"dispose",value:function(){this.hide();for(var e;e=this._disposeCallbacks.pop();)e()}}]),a})();yk=(function(a){Hn(e,a);var t=Ume(e);function e(r,n,s){var o;return Gt(this,e),o=t.call(this,r,n,s),o.width=0,o.height=0,o.top=0,o.left=0,o}return Vt(e,[{key:"redraw",value:function(n,s,o){var l=!1;this.visibleItems=this._updateItemsInRange(this.orderedItems,this.visibleItems,n),this.width=this.dom.background.offsetWidth,this.dom.background.style.height="0";for(var c=0,u=this.visibleItems.length;c<u;c++){var d=this.visibleItems[c];d.repositionY(s)}return l}},{key:"show",value:function(){this.dom.background.parentNode||this.itemSet.dom.background.appendChild(this.dom.background)}}]),e})(qb),Yme=`
.vis-item {
  position: absolute;
  color: #1A1A1A;
  border-color: #97B0F8;
  border-width: 1px;
  background-color: #D5DDF6;
  display: inline-block;
  z-index: 1;
  /*overflow: hidden;*/
}

.vis-item.vis-selected {
  border-color: #FFC200;
  background-color: #FFF785;

  /* z-index must be higher than the z-index of custom time bar and current time bar */
  z-index: 2;
}

.vis-editable.vis-selected {
  cursor: move;
}

.vis-item.vis-point.vis-selected {
  background-color: #FFF785;
}

.vis-item.vis-box {
  text-align: center;
  border-style: solid;
  border-radius: 2px;
}

.vis-item.vis-point {
  background: none;
}

.vis-item.vis-dot {
  position: absolute;
  padding: 0;
  border-width: 4px;
  border-style: solid;
  border-radius: 4px;
}

.vis-item.vis-range {
  border-style: solid;
  border-radius: 2px;
  box-sizing: border-box;
}

.vis-item.vis-background {
  border: none;
  background-color: rgba(213, 221, 246, 0.4);
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

.vis-item .vis-item-overflow {
  position: relative;
  width: 100%;
  height: 100%;
  padding: 0;
  margin: 0;
  overflow: hidden;
}

.vis-item-visible-frame {
  white-space: nowrap;
}

.vis-item.vis-range .vis-item-content {
  position: relative;
  display: inline-block;
}

.vis-item.vis-background .vis-item-content {
  position: absolute;
  display: inline-block;
}

.vis-item.vis-line {
  padding: 0;
  position: absolute;
  width: 0;
  border-left-width: 1px;
  border-left-style: solid;
}

.vis-item .vis-item-content {
  white-space: nowrap;
  box-sizing: border-box;
  padding: 5px;
}

.vis-item .vis-onUpdateTime-tooltip {
  position: absolute;
  background: #4f81bd;
  color: white;
  width: 200px;
  text-align: center;
  white-space: nowrap;
  padding: 5px;
  border-radius: 1px;
  transition: 0.4s;
  -o-transition: 0.4s;
  -moz-transition: 0.4s;
  -webkit-transition: 0.4s;
}

.vis-item .vis-delete, .vis-item .vis-delete-rtl {
  position: absolute;
  top: 0px;
  width: 24px;
  height: 24px;
  box-sizing: border-box;
  padding: 0px 5px;
  cursor: pointer;

  -webkit-transition: background 0.2s linear;
  -moz-transition: background 0.2s linear;
  -ms-transition: background 0.2s linear;
  -o-transition: background 0.2s linear;
  transition: background 0.2s linear;
}

.vis-item .vis-delete {
  right: -24px;
}

.vis-item .vis-delete-rtl {
  left: -24px;
}

.vis-item .vis-delete:after, .vis-item .vis-delete-rtl:after {
  content: "\\00D7"; /* MULTIPLICATION SIGN */
  color: red;
  font-family: arial, sans-serif;
  font-size: 22px;
  font-weight: bold;

  -webkit-transition: color 0.2s linear;
  -moz-transition: color 0.2s linear;
  -ms-transition: color 0.2s linear;
  -o-transition: color 0.2s linear;
  transition: color 0.2s linear;
}

.vis-item .vis-delete:hover, .vis-item .vis-delete-rtl:hover {
  background: red;
}

.vis-item .vis-delete:hover:after, .vis-item .vis-delete-rtl:hover:after {
  color: white;
}

.vis-item .vis-drag-center {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0px;
  cursor: move;
}

.vis-item.vis-range .vis-drag-left {
  position: absolute;
  width: 24px;
  max-width: 20%;
  min-width: 2px;
  height: 100%;
  top: 0;
  left: -4px;

  cursor: w-resize;
}

.vis-item.vis-range .vis-drag-right {
  position: absolute;
  width: 24px;
  max-width: 20%;
  min-width: 2px;
  height: 100%;
  top: 0;
  right: -4px;

  cursor: e-resize;
}

.vis-range.vis-item.vis-readonly .vis-drag-left,
.vis-range.vis-item.vis-readonly .vis-drag-right {
  cursor: auto;
}

.vis-item.vis-cluster {
  vertical-align: center;
  text-align: center;
  border-style: solid;
  border-radius: 2px;
}

.vis-item.vis-cluster-line {
  padding: 0;
  position: absolute;
  width: 0;
  border-left-width: 1px;
  border-left-style: solid;
}

.vis-item.vis-cluster-dot {
  position: absolute;
  padding: 0;
  border-width: 4px;
  border-style: solid;
  border-radius: 4px;
}`;Gn(Yme);Ou=(function(){function a(t,e,r){var n,s=this;Gt(this,a),this.id=null,this.parent=null,this.data=t,this.dom=null,this.conversion=e||{},this.defaultOptions={locales:Bh,locale:"en"},this.options=ae.extend({},this.defaultOptions,r),this.options.locales=ae.extend({},Bh,this.options.locales);var o=this.defaultOptions.locales[this.defaultOptions.locale];Ue(n=bi(this.options.locales)).call(n,function(l){s.options.locales[l]=ae.extend({},o,s.options.locales[l])}),this.selected=!1,this.displayed=!1,this.groupShowing=!0,this.selectable=r&&r.selectable||!1,this.dirty=!0,this.top=null,this.right=null,this.left=null,this.width=null,this.height=null,this.setSelectability(t),this.editable=null,this._updateEditStatus()}return Vt(a,[{key:"select",value:function(){this.selectable&&(this.selected=!0,this.dirty=!0,this.displayed&&this.redraw())}},{key:"unselect",value:function(){this.selected=!1,this.dirty=!0,this.displayed&&this.redraw()}},{key:"setData",value:function(e){var r=e.group!=null&&this.data.group!=e.group;r&&this.parent!=null&&this.parent.itemSet._moveToGroup(this,e.group),this.setSelectability(e),this.parent&&(this.parent.stackDirty=!0);var n=e.subgroup!=null&&this.data.subgroup!=e.subgroup;n&&this.parent!=null&&this.parent.changeSubgroup(this,this.data.subgroup,e.subgroup),this.data=e,this._updateEditStatus(),this.dirty=!0,this.displayed&&this.redraw()}},{key:"setSelectability",value:function(e){e&&(this.selectable=typeof e.selectable=="undefined"?!0:!!e.selectable)}},{key:"setParent",value:function(e){this.displayed?(this.hide(),this.parent=e,this.parent&&this.show()):this.parent=e}},{key:"isVisible",value:function(e){return!1}},{key:"show",value:function(){return!1}},{key:"hide",value:function(){return!1}},{key:"redraw",value:function(){}},{key:"repositionX",value:function(){}},{key:"repositionY",value:function(){}},{key:"_repaintDragCenter",value:function(){if(this.selected&&this.editable.updateTime&&!this.dom.dragCenter){var e,r,n=this,s=document.createElement("div");s.className="vis-drag-center",s.dragCenterItem=this,this.hammerDragCenter=new yn(s),this.hammerDragCenter.on("tap",function(o){n.parent.itemSet.body.emitter.emit("click",{event:o,item:n.id})}),this.hammerDragCenter.on("doubletap",function(o){o.stopPropagation(),n.parent.itemSet._onUpdateItem(n),n.parent.itemSet.body.emitter.emit("doubleClick",{event:o,item:n.id})}),this.hammerDragCenter.on("panstart",function(o){o.stopPropagation(),n.parent.itemSet._onDragStart(o)}),this.hammerDragCenter.on("panmove",Oe(e=n.parent.itemSet._onDrag).call(e,n.parent.itemSet)),this.hammerDragCenter.on("panend",Oe(r=n.parent.itemSet._onDragEnd).call(r,n.parent.itemSet)),this.hammerDragCenter.get("press").set({time:1e4}),this.dom.box?this.dom.dragLeft?this.dom.box.insertBefore(s,this.dom.dragLeft):this.dom.box.appendChild(s):this.dom.point&&this.dom.point.appendChild(s),this.dom.dragCenter=s}else!this.selected&&this.dom.dragCenter&&(this.dom.dragCenter.parentNode&&this.dom.dragCenter.parentNode.removeChild(this.dom.dragCenter),this.dom.dragCenter=null,this.hammerDragCenter&&(this.hammerDragCenter.destroy(),this.hammerDragCenter=null))}},{key:"_repaintDeleteButton",value:function(e){var r=(this.options.editable.overrideItems||this.editable==null)&&this.options.editable.remove||!this.options.editable.overrideItems&&this.editable!=null&&this.editable.remove;if(this.selected&&r&&!this.dom.deleteButton){var n=this,s=document.createElement("div");this.options.rtl?s.className="vis-delete-rtl":s.className="vis-delete";var o=this.options.locales[this.options.locale];o||(this.warned||(console.warn("WARNING: options.locales['".concat(this.options.locale,"'] not found. See https://visjs.github.io/vis-timeline/docs/timeline/#Localization")),this.warned=!0),o=this.options.locales.en),s.title=o.deleteSelected,this.hammerDeleteButton=new yn(s).on("tap",function(l){l.stopPropagation(),n.parent.removeFromDataSet(n)}),e.appendChild(s),this.dom.deleteButton=s}else(!this.selected||!r)&&this.dom.deleteButton&&(this.dom.deleteButton.parentNode&&this.dom.deleteButton.parentNode.removeChild(this.dom.deleteButton),this.dom.deleteButton=null,this.hammerDeleteButton&&(this.hammerDeleteButton.destroy(),this.hammerDeleteButton=null))}},{key:"_repaintOnItemUpdateTimeTooltip",value:function(e){if(this.options.tooltipOnItemUpdateTime){var r=(this.options.editable.updateTime||this.data.editable===!0)&&this.data.editable!==!1;if(this.selected&&r&&!this.dom.onItemUpdateTimeTooltip){var n=document.createElement("div");n.className="vis-onUpdateTime-tooltip",e.appendChild(n),this.dom.onItemUpdateTimeTooltip=n}else!this.selected&&this.dom.onItemUpdateTimeTooltip&&(this.dom.onItemUpdateTimeTooltip.parentNode&&this.dom.onItemUpdateTimeTooltip.parentNode.removeChild(this.dom.onItemUpdateTimeTooltip),this.dom.onItemUpdateTimeTooltip=null);if(this.dom.onItemUpdateTimeTooltip){this.dom.onItemUpdateTimeTooltip.style.visibility=this.parent.itemSet.touchParams.itemIsDragging?"visible":"hidden",this.dom.onItemUpdateTimeTooltip.style.transform="translateX(-50%)",this.dom.onItemUpdateTimeTooltip.style.left="50%";var s=50,o=this.parent.itemSet.body.domProps.scrollTop,l;this.options.orientation.item=="top"?l=this.top:l=this.parent.height-this.top-this.height;var c=l+this.parent.top-s<-o;c?(this.dom.onItemUpdateTimeTooltip.style.bottom="",this.dom.onItemUpdateTimeTooltip.style.top="".concat(this.height+2,"px")):(this.dom.onItemUpdateTimeTooltip.style.top="",this.dom.onItemUpdateTimeTooltip.style.bottom="".concat(this.height+2,"px"));var u,d;if(this.options.tooltipOnItemUpdateTime&&this.options.tooltipOnItemUpdateTime.template){var h;d=Oe(h=this.options.tooltipOnItemUpdateTime.template).call(h,this),u=d(this.data)}else u="start: ".concat(bn(this.data.start).format("MM/DD/YYYY hh:mm")),this.data.end&&(u+="<br> end: ".concat(bn(this.data.end).format("MM/DD/YYYY hh:mm")));this.dom.onItemUpdateTimeTooltip.innerHTML=ae.xss(u)}}}},{key:"_getItemData",value:function(){return this.parent.itemSet.itemsData.get(this.id)}},{key:"_updateContents",value:function(e){var r,n,s,o,l,c=this._getItemData(),u=this.dom.box||this.dom.point,d=u.getElementsByClassName("vis-item-visible-frame")[0];if(this.options.visibleFrameTemplate){var h;l=Oe(h=this.options.visibleFrameTemplate).call(h,this),o=ae.xss(l(c,d))}else o="";if(d){if(o instanceof Object&&!(o instanceof Element))l(c,d);else if(n=this._contentToString(this.itemVisibleFrameContent)!==this._contentToString(o),n){if(o instanceof Element)d.innerHTML="",d.appendChild(o);else if(o!=null)d.innerHTML=ae.xss(o);else if(!(this.data.type=="background"&&this.data.content===void 0))throw new Error('Property "content" missing in item '.concat(this.id));this.itemVisibleFrameContent=o}}if(this.options.template){var f;s=Oe(f=this.options.template).call(f,this),r=s(c,e,this.data)}else r=this.data.content;if(r instanceof Object&&!(r instanceof Element))s(c,e);else if(n=this._contentToString(this.content)!==this._contentToString(r),n){if(r instanceof Element)e.innerHTML="",e.appendChild(r);else if(r!=null)e.innerHTML=ae.xss(r);else if(!(this.data.type=="background"&&this.data.content===void 0))throw new Error('Property "content" missing in item '.concat(this.id));this.content=r}}},{key:"_updateDataAttributes",value:function(e){if(this.options.dataAttributes&&this.options.dataAttributes.length>0){var r=[];if(Tt(this.options.dataAttributes))r=this.options.dataAttributes;else if(this.options.dataAttributes=="all")r=bi(this.data);else return;var n=qme(r),s;try{for(n.s();!(s=n.n()).done;){var o=s.value,l=this.data[o];l!=null?e.setAttribute("data-".concat(o),l):e.removeAttribute("data-".concat(o))}}catch(c){n.e(c)}finally{n.f()}}}},{key:"_updateStyle",value:function(e){this.style&&(ae.removeCssText(e,this.style),this.style=null),this.data.style&&(ae.addCssText(e,this.data.style),this.style=this.data.style)}},{key:"_contentToString",value:function(e){return typeof e=="string"?e:e&&"outerHTML"in e?e.outerHTML:e}},{key:"_updateEditStatus",value:function(){this.options&&(typeof this.options.editable=="boolean"?this.editable={updateTime:this.options.editable,updateGroup:this.options.editable,remove:this.options.editable}:yt(this.options.editable)==="object"&&(this.editable={},ae.selectiveExtend(["updateTime","updateGroup","remove"],this.editable,this.options.editable))),(!this.options||!this.options.editable||this.options.editable.overrideItems!==!0)&&this.data&&(typeof this.data.editable=="boolean"?this.editable={updateTime:this.data.editable,updateGroup:this.data.editable,remove:this.data.editable}:yt(this.data.editable)==="object"&&(this.editable={},ae.selectiveExtend(["updateTime","updateGroup","remove"],this.editable,this.data.editable)))}},{key:"getWidthLeft",value:function(){return 0}},{key:"getWidthRight",value:function(){return 0}},{key:"getTitle",value:function(){if(this.options.tooltip&&this.options.tooltip.template){var e,r=Oe(e=this.options.tooltip.template).call(e,this);return r(this._getItemData(),this.data)}return this.data.title}}]),a})();Ou.prototype.stack=!0;mz=(function(a){Hn(e,a);var t=Kme(e);function e(r,n,s){var o;if(Gt(this,e),o=t.call(this,r,n,s),o.props={dot:{width:0,height:0},line:{width:0,height:0}},r&&r.start==null)throw new Error('Property "start" missing in item '.concat(r));return o}return Vt(e,[{key:"isVisible",value:function(n){if(this.cluster)return!1;var s,o=this.data.align||this.options.align,l=this.width*n.getMillisecondsPerPixel();return o=="right"?s=this.data.start.getTime()>n.start&&this.data.start.getTime()-l<n.end:o=="left"?s=this.data.start.getTime()+l>n.start&&this.data.start.getTime()<n.end:s=this.data.start.getTime()+l/2>n.start&&this.data.start.getTime()-l/2<n.end,s}},{key:"_createDomElement",value:function(){this.dom||(this.dom={},this.dom.box=document.createElement("DIV"),this.dom.content=document.createElement("DIV"),this.dom.content.className="vis-item-content",this.dom.box.appendChild(this.dom.content),this.dom.line=document.createElement("DIV"),this.dom.line.className="vis-line",this.dom.dot=document.createElement("DIV"),this.dom.dot.className="vis-dot",this.dom.box["vis-item"]=this,this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.box.parentNode){var n=this.parent.dom.foreground;if(!n)throw new Error("Cannot redraw item: parent has no foreground container element");n.appendChild(this.dom.box)}if(!this.dom.line.parentNode){var s=this.parent.dom.background;if(!s)throw new Error("Cannot redraw item: parent has no background container element");s.appendChild(this.dom.line)}if(!this.dom.dot.parentNode){var o=this.parent.dom.axis;if(!s)throw new Error("Cannot redraw item: parent has no axis container element");o.appendChild(this.dom.dot)}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){if(this.dirty){this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.box),this._updateStyle(this.dom.box);var n=this.editable.updateTime||this.editable.updateGroup,s=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(n?" vis-editable":" vis-readonly");this.dom.box.className="vis-item vis-box".concat(s),this.dom.line.className="vis-item vis-line".concat(s),this.dom.dot.className="vis-item vis-dot".concat(s)}}},{key:"_getDomComponentsSizes",value:function(){return{previous:{right:this.dom.box.style.right,left:this.dom.box.style.left},dot:{height:this.dom.dot.offsetHeight,width:this.dom.dot.offsetWidth},line:{width:this.dom.line.offsetWidth},box:{width:this.dom.box.offsetWidth,height:this.dom.box.offsetHeight}}}},{key:"_updateDomComponentsSizes",value:function(n){this.options.rtl?this.dom.box.style.right="0px":this.dom.box.style.left="0px",this.props.dot.height=n.dot.height,this.props.dot.width=n.dot.width,this.props.line.width=n.line.width,this.width=n.box.width,this.height=n.box.height,this.options.rtl?this.dom.box.style.right=n.previous.right:this.dom.box.style.left=n.previous.left,this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){this._repaintOnItemUpdateTimeTooltip(this.dom.box),this._repaintDragCenter(),this._repaintDeleteButton(this.dom.box)}},{key:"redraw",value:function(n){var s,o,l,c=this,u,d,h=[Oe(s=this._createDomElement).call(s,this),Oe(o=this._appendDomElement).call(o,this),Oe(l=this._updateDirtyDomComponents).call(l,this),function(){c.dirty&&(d=c._getDomComponentsSizes())},function(){if(c.dirty){var m;Oe(m=c._updateDomComponentsSizes).call(m,c)(d)}},Oe(u=this._repaintDomAdditionals).call(u,this)];if(n)return h;var f;return Ue(h).call(h,function(m){f=m()}),f}},{key:"show",value:function(n){if(!this.displayed)return this.redraw(n)}},{key:"hide",value:function(){if(this.displayed){var n=this.dom;n.box.remove?n.box.remove():n.box.parentNode&&n.box.parentNode.removeChild(n.box),n.line.remove?n.line.remove():n.line.parentNode&&n.line.parentNode.removeChild(n.line),n.dot.remove?n.dot.remove():n.dot.parentNode&&n.dot.parentNode.removeChild(n.dot),this.displayed=!1}}},{key:"repositionXY",value:function(){var n=this.options.rtl,s=function(l,c,u){var d,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!(c===void 0&&u===void 0)){var f=h?c*-1:c;if(u===void 0){l.style.transform="translateX(".concat(f,"px)");return}if(c===void 0){l.style.transform="translateY(".concat(u,"px)");return}l.style.transform=Ir(d="translate(".concat(f,"px, ")).call(d,u,"px)")}};s(this.dom.box,this.boxX,this.boxY,n),s(this.dom.dot,this.dotX,this.dotY,n),s(this.dom.line,this.lineX,this.lineY,n)}},{key:"repositionX",value:function(){var n=this.conversion.toScreen(this.data.start),s=this.data.align===void 0?this.options.align:this.data.align,o=this.props.line.width,l=this.props.dot.width;s=="right"?(this.boxX=n-this.width,this.lineX=n-o,this.dotX=n-o/2-l/2):s=="left"?(this.boxX=n,this.lineX=n,this.dotX=n+o/2-l/2):(this.boxX=n-this.width/2,this.lineX=this.options.rtl?n-o:n-o/2,this.dotX=n-l/2),this.options.rtl?this.right=this.boxX:this.left=this.boxX,this.repositionXY()}},{key:"repositionY",value:function(){var n=this.options.orientation.item,s=this.dom.line.style;if(n=="top"){var o=this.parent.top+this.top+1;this.boxY=this.top||0,s.height="".concat(o,"px"),s.bottom="",s.top="0"}else{var l=this.parent.itemSet.props.height,c=l-this.parent.top-this.parent.height+this.top;this.boxY=this.parent.height-this.top-(this.height||0),s.height="".concat(c,"px"),s.top="",s.bottom="0"}this.dotY=-this.props.dot.height/2,this.repositionXY()}},{key:"getWidthLeft",value:function(){return this.width/2}},{key:"getWidthRight",value:function(){return this.width/2}}]),e})(Ou);gz=(function(a){Hn(e,a);var t=Jme(e);function e(r,n,s){var o;if(Gt(this,e),o=t.call(this,r,n,s),o.props={dot:{top:0,width:0,height:0},content:{height:0,marginLeft:0,marginRight:0}},r&&r.start==null)throw new Error('Property "start" missing in item '.concat(r));return o}return Vt(e,[{key:"isVisible",value:function(n){if(this.cluster)return!1;var s=this.width*n.getMillisecondsPerPixel();return this.data.start.getTime()+s>n.start&&this.data.start<n.end}},{key:"_createDomElement",value:function(){this.dom||(this.dom={},this.dom.point=document.createElement("div"),this.dom.content=document.createElement("div"),this.dom.content.className="vis-item-content",this.dom.point.appendChild(this.dom.content),this.dom.dot=document.createElement("div"),this.dom.point.appendChild(this.dom.dot),this.dom.point["vis-item"]=this,this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.point.parentNode){var n=this.parent.dom.foreground;if(!n)throw new Error("Cannot redraw item: parent has no foreground container element");n.appendChild(this.dom.point)}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){if(this.dirty){this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.point),this._updateStyle(this.dom.point);var n=this.editable.updateTime||this.editable.updateGroup,s=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(n?" vis-editable":" vis-readonly");this.dom.point.className="vis-item vis-point".concat(s),this.dom.dot.className="vis-item vis-dot".concat(s)}}},{key:"_getDomComponentsSizes",value:function(){return{dot:{width:this.dom.dot.offsetWidth,height:this.dom.dot.offsetHeight},content:{width:this.dom.content.offsetWidth,height:this.dom.content.offsetHeight},point:{width:this.dom.point.offsetWidth,height:this.dom.point.offsetHeight}}}},{key:"_updateDomComponentsSizes",value:function(n){this.props.dot.width=n.dot.width,this.props.dot.height=n.dot.height,this.props.content.height=n.content.height,this.options.rtl?this.dom.content.style.marginRight="".concat(this.props.dot.width/2,"px"):this.dom.content.style.marginLeft="".concat(this.props.dot.width/2,"px"),this.width=n.point.width,this.height=n.point.height,this.dom.dot.style.top="".concat((this.height-this.props.dot.height)/2,"px");var s=this.props.dot.width,o=this.options.rtl?s/2:s/2*-1;this.dom.dot.style.transform="translateX(".concat(o,"px"),this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){this._repaintOnItemUpdateTimeTooltip(this.dom.point),this._repaintDragCenter(),this._repaintDeleteButton(this.dom.point)}},{key:"redraw",value:function(n){var s,o,l,c=this,u,d,h=[Oe(s=this._createDomElement).call(s,this),Oe(o=this._appendDomElement).call(o,this),Oe(l=this._updateDirtyDomComponents).call(l,this),function(){c.dirty&&(d=c._getDomComponentsSizes())},function(){if(c.dirty){var m;Oe(m=c._updateDomComponentsSizes).call(m,c)(d)}},Oe(u=this._repaintDomAdditionals).call(u,this)];if(n)return h;var f;return Ue(h).call(h,function(m){f=m()}),f}},{key:"repositionXY",value:function(){var n=this.options.rtl,s=function(l,c,u){var d,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!(c===void 0&&u===void 0)){var f=h?c*-1:c;if(u===void 0){l.style.transform="translateX(".concat(f,"px)");return}if(c===void 0){l.style.transform="translateY(".concat(u,"px)");return}l.style.transform=Ir(d="translate(".concat(f,"px, ")).call(d,u,"px)")}};s(this.dom.point,this.pointX,this.pointY,n)}},{key:"show",value:function(n){if(!this.displayed)return this.redraw(n)}},{key:"hide",value:function(){this.displayed&&(this.dom.point.parentNode&&this.dom.point.parentNode.removeChild(this.dom.point),this.displayed=!1)}},{key:"repositionX",value:function(){var n=this.conversion.toScreen(this.data.start);this.pointX=n,this.options.rtl?this.right=n-this.props.dot.width:this.left=n-this.props.dot.width,this.repositionXY()}},{key:"repositionY",value:function(){var n=this.options.orientation.item;n=="top"?this.pointY=this.top:this.pointY=this.parent.height-this.top-this.height,this.repositionXY()}},{key:"getWidthLeft",value:function(){return this.props.dot.width}},{key:"getWidthRight",value:function(){return this.props.dot.width}}]),e})(Ou);Jl=(function(a){Hn(e,a);var t=ege(e);function e(r,n,s){var o;if(Gt(this,e),o=t.call(this,r,n,s),o.props={content:{width:0}},o.overflow=!1,r){if(r.start==null)throw new Error('Property "start" missing in item '.concat(r.id));if(r.end==null)throw new Error('Property "end" missing in item '.concat(r.id))}return o}return Vt(e,[{key:"isVisible",value:function(n){return this.cluster?!1:this.data.start<n.end&&this.data.end>n.start}},{key:"_createDomElement",value:function(){this.dom||(this.dom={},this.dom.box=document.createElement("div"),this.dom.frame=document.createElement("div"),this.dom.frame.className="vis-item-overflow",this.dom.box.appendChild(this.dom.frame),this.dom.visibleFrame=document.createElement("div"),this.dom.visibleFrame.className="vis-item-visible-frame",this.dom.box.appendChild(this.dom.visibleFrame),this.dom.content=document.createElement("div"),this.dom.content.className="vis-item-content",this.dom.frame.appendChild(this.dom.content),this.dom.box["vis-item"]=this,this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.box.parentNode){var n=this.parent.dom.foreground;if(!n)throw new Error("Cannot redraw item: parent has no foreground container element");n.appendChild(this.dom.box)}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){if(this.dirty){this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.box),this._updateStyle(this.dom.box);var n=this.editable.updateTime||this.editable.updateGroup,s=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(n?" vis-editable":" vis-readonly");this.dom.box.className=this.baseClassName+s,this.dom.content.style.maxWidth="none"}}},{key:"_getDomComponentsSizes",value:function(){return this.overflow=window.getComputedStyle(this.dom.frame).overflow!=="hidden",this.whiteSpace=window.getComputedStyle(this.dom.content).whiteSpace!=="nowrap",{content:{width:this.dom.content.offsetWidth},box:{height:this.dom.box.offsetHeight}}}},{key:"_updateDomComponentsSizes",value:function(n){this.props.content.width=n.content.width,this.height=n.box.height,this.dom.content.style.maxWidth="",this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){this._repaintOnItemUpdateTimeTooltip(this.dom.box),this._repaintDeleteButton(this.dom.box),this._repaintDragCenter(),this._repaintDragLeft(),this._repaintDragRight()}},{key:"redraw",value:function(n){var s,o,l,c=this,u,d,h=[Oe(s=this._createDomElement).call(s,this),Oe(o=this._appendDomElement).call(o,this),Oe(l=this._updateDirtyDomComponents).call(l,this),function(){if(c.dirty){var m;d=Oe(m=c._getDomComponentsSizes).call(m,c)()}},function(){if(c.dirty){var m;Oe(m=c._updateDomComponentsSizes).call(m,c)(d)}},Oe(u=this._repaintDomAdditionals).call(u,this)];if(n)return h;var f;return Ue(h).call(h,function(m){f=m()}),f}},{key:"show",value:function(n){if(!this.displayed)return this.redraw(n)}},{key:"hide",value:function(){if(this.displayed){var n=this.dom.box;n.parentNode&&n.parentNode.removeChild(n),this.displayed=!1}}},{key:"repositionX",value:function(n){var s=this.parent.width,o=this.conversion.toScreen(this.data.start),l=this.conversion.toScreen(this.data.end),c=this.data.align===void 0?this.options.align:this.data.align,u,d;this.data.limitSize!==!1&&(n===void 0||n===!0)&&(o<-s&&(o=-s),l>2*s&&(l=2*s));var h=Math.max(Math.round((l-o)*1e3)/1e3,1);switch(this.overflow?(this.options.rtl?this.right=o:this.left=o,this.width=h+this.props.content.width,d=this.props.content.width):(this.options.rtl?this.right=o:this.left=o,this.width=h,d=Math.min(l-o,this.props.content.width)),this.options.rtl?this.dom.box.style.transform="translateX(".concat(this.right*-1,"px)"):this.dom.box.style.transform="translateX(".concat(this.left,"px)"),this.dom.box.style.width="".concat(h,"px"),this.whiteSpace&&(this.height=this.dom.box.offsetHeight),c){case"left":this.dom.content.style.transform="translateX(0)";break;case"right":if(this.options.rtl){var f=Math.max(h-d,0)*-1;this.dom.content.style.transform="translateX(".concat(f,"px)")}else this.dom.content.style.transform="translateX(".concat(Math.max(h-d,0),"px)");break;case"center":if(this.options.rtl){var m=Math.max((h-d)/2,0)*-1;this.dom.content.style.transform="translateX(".concat(m,"px)")}else this.dom.content.style.transform="translateX(".concat(Math.max((h-d)/2,0),"px)");break;default:if(this.overflow?l>0?u=Math.max(-o,0):u=-d:o<0?u=-o:u=0,this.options.rtl){var g=u*-1;this.dom.content.style.transform="translateX(".concat(g,"px)")}else this.dom.content.style.transform="translateX(".concat(u,"px)")}}},{key:"repositionY",value:function(){var n=this.options.orientation.item,s=this.dom.box;n=="top"?s.style.top="".concat(this.top,"px"):s.style.top="".concat(this.parent.height-this.top-this.height,"px")}},{key:"_repaintDragLeft",value:function(){if((this.selected||this.options.itemsAlwaysDraggable.range)&&this.editable.updateTime&&!this.dom.dragLeft){var n=document.createElement("div");n.className="vis-drag-left",n.dragLeftItem=this,this.dom.box.appendChild(n),this.dom.dragLeft=n}else!this.selected&&!this.options.itemsAlwaysDraggable.range&&this.dom.dragLeft&&(this.dom.dragLeft.parentNode&&this.dom.dragLeft.parentNode.removeChild(this.dom.dragLeft),this.dom.dragLeft=null)}},{key:"_repaintDragRight",value:function(){if((this.selected||this.options.itemsAlwaysDraggable.range)&&this.editable.updateTime&&!this.dom.dragRight){var n=document.createElement("div");n.className="vis-drag-right",n.dragRightItem=this,this.dom.box.appendChild(n),this.dom.dragRight=n}else!this.selected&&!this.options.itemsAlwaysDraggable.range&&this.dom.dragRight&&(this.dom.dragRight.parentNode&&this.dom.dragRight.parentNode.removeChild(this.dom.dragRight),this.dom.dragRight=null)}}]),e})(Ou);Jl.prototype.baseClassName="vis-item vis-range";ic=(function(a){Hn(e,a);var t=rge(e);function e(r,n,s){var o;if(Gt(this,e),o=t.call(this,r,n,s),o.props={content:{width:0}},o.overflow=!1,r){if(r.start==null)throw new Error('Property "start" missing in item '.concat(r.id));if(r.end==null)throw new Error('Property "end" missing in item '.concat(r.id))}return o}return Vt(e,[{key:"isVisible",value:function(n){return this.data.start<n.end&&this.data.end>n.start}},{key:"_createDomElement",value:function(){this.dom||(this.dom={},this.dom.box=document.createElement("div"),this.dom.frame=document.createElement("div"),this.dom.frame.className="vis-item-overflow",this.dom.box.appendChild(this.dom.frame),this.dom.content=document.createElement("div"),this.dom.content.className="vis-item-content",this.dom.frame.appendChild(this.dom.content),this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.box.parentNode){var n=this.parent.dom.background;if(!n)throw new Error("Cannot redraw item: parent has no background container element");n.appendChild(this.dom.box)}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){if(this.dirty){this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.content),this._updateStyle(this.dom.box);var n=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"");this.dom.box.className=this.baseClassName+n}}},{key:"_getDomComponentsSizes",value:function(){return this.overflow=window.getComputedStyle(this.dom.content).overflow!=="hidden",{content:{width:this.dom.content.offsetWidth}}}},{key:"_updateDomComponentsSizes",value:function(n){this.props.content.width=n.content.width,this.height=0,this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){}},{key:"redraw",value:function(n){var s,o,l,c=this,u,d,h=[Oe(s=this._createDomElement).call(s,this),Oe(o=this._appendDomElement).call(o,this),Oe(l=this._updateDirtyDomComponents).call(l,this),function(){if(c.dirty){var m;d=Oe(m=c._getDomComponentsSizes).call(m,c)()}},function(){if(c.dirty){var m;Oe(m=c._updateDomComponentsSizes).call(m,c)(d)}},Oe(u=this._repaintDomAdditionals).call(u,this)];if(n)return h;var f;return Ue(h).call(h,function(m){f=m()}),f}},{key:"repositionY",value:function(n){var s,o=this.options.orientation.item;if(this.data.subgroup!==void 0){var l=this.data.subgroup;this.dom.box.style.height="".concat(this.parent.subgroups[l].height,"px"),o=="top"?this.dom.box.style.top="".concat(this.parent.top+this.parent.subgroups[l].top,"px"):this.dom.box.style.top="".concat(this.parent.top+this.parent.height-this.parent.subgroups[l].top-this.parent.subgroups[l].height,"px"),this.dom.box.style.bottom=""}else this.parent instanceof yk?(s=Math.max(this.parent.height,this.parent.itemSet.body.domProps.center.height,this.parent.itemSet.body.domProps.centerContainer.height),this.dom.box.style.bottom=o=="bottom"?"0":"",this.dom.box.style.top=o=="top"?"0":""):(s=this.parent.height,this.dom.box.style.top="".concat(this.parent.top,"px"),this.dom.box.style.bottom="");this.dom.box.style.height="".concat(s,"px")}}]),e})(Ou);ic.prototype.baseClassName="vis-item vis-background";ic.prototype.stack=!1;ic.prototype.show=Jl.prototype.show;ic.prototype.hide=Jl.prototype.hide;ic.prototype.repositionX=Jl.prototype.repositionX;nge=`div.vis-tooltip {
  position: absolute;
  visibility: hidden;
  padding: 5px;
  white-space: nowrap;

  font-family: verdana;
  font-size:14px;
  color:#000000;
  background-color: #f5f4ed;

  -moz-border-radius: 3px;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  border: 1px solid #808074;

  box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
  pointer-events: none;

  z-index: 5;
}
`;Gn(nge);age=(function(){function a(t,e){Gt(this,a),this.container=t,this.overflowMethod=e||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return Vt(a,[{key:"setPosition",value:function(e,r){this.x=La(e),this.y=La(r)}},{key:"setText",value:function(e){e instanceof Element?(this.frame.innerHTML="",this.frame.appendChild(e)):this.frame.innerHTML=ae.xss(e)}},{key:"show",value:function(e){if(e===void 0&&(e=!0),e===!0){var r=this.frame.clientHeight,n=this.frame.clientWidth,s=this.frame.parentNode.clientHeight,o=this.frame.parentNode.clientWidth,l=0,c=0;if(this.overflowMethod=="flip"||this.overflowMethod=="none"){var u=!1,d=!0;this.overflowMethod=="flip"&&(this.y-r<this.padding&&(d=!1),this.x+n>o-this.padding&&(u=!0)),u?l=this.x-n:l=this.x,d?c=this.y-r:c=this.y}else c=this.y-r,c+r+this.padding>s&&(c=s-r-this.padding),c<this.padding&&(c=this.padding),l=this.x,l+n+this.padding>o&&(l=o-n-this.padding),l<this.padding&&(l=this.padding);this.frame.style.left=l+"px",this.frame.style.top=c+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),a})(),vz={exports:{}},sge=pt,oge=Yo.every,lge=Yh,cge=lge("every");sge({target:"Array",proto:!0,forced:!cge},{every:function(t){return oge(this,t,arguments.length>1?arguments[1]:void 0)}});uge=jr,dge=uge("Array").every,hge=Tr,fge=dge,iS=Array.prototype,pge=function(a){var t=a.every;return a===iS||hge(iS,a)&&t===iS.every?fge:t},mge=pge,gge=mge;(function(a){a.exports=gge})(vz);vge=tt(vz.exports);bk=(function(a){Hn(e,a);var t=bge(e);function e(r,n,s){var o;Gt(this,e);var l=Go({},{fitOnDoubleClick:!0},s,{editable:!1});if(o=t.call(this,r,n,l),o.props={content:{width:0,height:0}},!r||r.uiItems==null)throw new Error('Property "uiItems" missing in item '+r.id);return o.id=gu(),o.group=r.group,o._setupRange(),o.emitter=o.data.eventEmitter,o.range=o.data.range,o.attached=!1,o.isCluster=!0,o.data.isCluster=!0,o}return Vt(e,[{key:"hasItems",value:function(){return this.data.uiItems&&this.data.uiItems.length&&this.attached}},{key:"setUiItems",value:function(n){this.detach(),this.data.uiItems=n,this._setupRange(),this.attach()}},{key:"isVisible",value:function(n){var s=this.data.end?this.data.end-this.data.start:0,o=this.width*n.getMillisecondsPerPixel(),l=Math.max(this.data.start.getTime()+s,this.data.start.getTime()+o);return this.data.start<n.end&&l>n.start&&this.hasItems()}},{key:"getData",value:function(){return{isCluster:!0,id:this.id,items:this.data.items||[],data:this.data}}},{key:"redraw",value:function(n){var s,o,l,c,u,d,h,f=[Oe(s=this._createDomElement).call(s,this),Oe(o=this._appendDomElement).call(o,this),Oe(l=this._updateDirtyDomComponents).call(l,this),Oe(c=function(){this.dirty&&(h=this._getDomComponentsSizes())}).call(c,this),Oe(u=function(){if(this.dirty){var y;Oe(y=this._updateDomComponentsSizes).call(y,this)(h)}}).call(u,this),Oe(d=this._repaintDomAdditionals).call(d,this)];if(n)return f;var m;return Ue(f).call(f,function(g){m=g()}),m}},{key:"show",value:function(){this.displayed||this.redraw()}},{key:"hide",value:function(){if(this.displayed){var n=this.dom;n.box.parentNode&&n.box.parentNode.removeChild(n.box),this.options.showStipes&&(n.line.parentNode&&n.line.parentNode.removeChild(n.line),n.dot.parentNode&&n.dot.parentNode.removeChild(n.dot)),this.displayed=!1}}},{key:"repositionX",value:function(){var n=this.conversion.toScreen(this.data.start),s=this.data.end?this.conversion.toScreen(this.data.end):0;if(s)this.repositionXWithRanges(n,s);else{var o=this.data.align===void 0?this.options.align:this.data.align;this.repositionXWithoutRanges(n,o)}this.options.showStipes&&(this.dom.line.style.display=this._isStipeVisible()?"block":"none",this.dom.dot.style.display=this._isStipeVisible()?"block":"none",this._isStipeVisible()&&this.repositionStype(n,s))}},{key:"repositionStype",value:function(n,s){this.dom.line.style.display="block",this.dom.dot.style.display="block";var o=this.dom.line.offsetWidth,l=this.dom.dot.offsetWidth;if(s){var c=o+n+(s-n)/2,u=c-l/2,d=this.options.rtl?c*-1:c,h=this.options.rtl?u*-1:u;this.dom.line.style.transform="translateX(".concat(d,"px)"),this.dom.dot.style.transform="translateX(".concat(h,"px)")}else{var f=this.options.rtl?n*-1:n,m=this.options.rtl?(n-l/2)*-1:n-l/2;this.dom.line.style.transform="translateX(".concat(f,"px)"),this.dom.dot.style.transform="translateX(".concat(m,"px)")}}},{key:"repositionXWithoutRanges",value:function(n,s){s=="right"?this.options.rtl?(this.right=n-this.width,this.dom.box.style.right=this.right+"px"):(this.left=n-this.width,this.dom.box.style.left=this.left+"px"):s=="left"?this.options.rtl?(this.right=n,this.dom.box.style.right=this.right+"px"):(this.left=n,this.dom.box.style.left=this.left+"px"):this.options.rtl?(this.right=n-this.width/2,this.dom.box.style.right=this.right+"px"):(this.left=n-this.width/2,this.dom.box.style.left=this.left+"px")}},{key:"repositionXWithRanges",value:function(n,s){var o=Math.round(Math.max(s-n+.5,1));this.options.rtl?this.right=n:this.left=n,this.width=Math.max(o,this.minWidth||0),this.options.rtl?this.dom.box.style.right=this.right+"px":this.dom.box.style.left=this.left+"px",this.dom.box.style.width=o+"px"}},{key:"repositionY",value:function(){var n=this.options.orientation.item,s=this.dom.box;if(n=="top"?s.style.top=(this.top||0)+"px":s.style.top=(this.parent.height-this.top-this.height||0)+"px",this.options.showStipes){if(n=="top")this.dom.line.style.top="0",this.dom.line.style.height=this.parent.top+this.top+1+"px",this.dom.line.style.bottom="";else{var o=this.parent.itemSet.props.height,l=o-this.parent.top-this.parent.height+this.top;this.dom.line.style.top=o-l+"px",this.dom.line.style.bottom="0"}this.dom.dot.style.top=-this.dom.dot.offsetHeight/2+"px"}}},{key:"getWidthLeft",value:function(){return this.width/2}},{key:"getWidthRight",value:function(){return this.width/2}},{key:"move",value:function(){this.repositionX(),this.repositionY()}},{key:"attach",value:function(){var n,s=c2(this.data.uiItems),o;try{for(s.s();!(o=s.n()).done;){var l=o.value;l.cluster=this}}catch(c){s.e(c)}finally{s.f()}this.data.items=sr(n=this.data.uiItems).call(n,function(c){return c.data}),this.attached=!0,this.dirty=!0}},{key:"detach",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.hasItems()){var s=c2(this.data.uiItems),o;try{for(s.s();!(o=s.n()).done;){var l=o.value;delete l.cluster}}catch(c){s.e(c)}finally{s.f()}this.attached=!1,n&&this.group&&(this.group.remove(this),this.group=null),this.data.items=[],this.dirty=!0}}},{key:"_onDoubleClick",value:function(){this._fit()}},{key:"_setupRange",value:function(){var n,s,o,l=sr(n=this.data.uiItems).call(n,function(d){return{start:d.data.start.valueOf(),end:d.data.end?d.data.end.valueOf():d.data.start.valueOf()}});this.data.min=Math.min.apply(Math,Ur(sr(l).call(l,function(d){return Math.min(d.start,d.end||d.start)}))),this.data.max=Math.max.apply(Math,Ur(sr(l).call(l,function(d){return Math.max(d.start,d.end||d.start)})));var c=sr(s=this.data.uiItems).call(s,function(d){return d.center}),u=S0(c).call(c,function(d,h){return d+h},0)/this.data.uiItems.length;lk(o=this.data.uiItems).call(o,function(d){return d.data.end})?(this.data.start=new Date(this.data.min),this.data.end=new Date(this.data.max)):(this.data.start=new Date(u),this.data.end=null)}},{key:"_getUiItems",value:function(){var n=this;if(this.data.uiItems&&this.data.uiItems.length){var s;return lt(s=this.data.uiItems).call(s,function(o){return o.cluster===n})}return[]}},{key:"_createDomElement",value:function(){if(!this.dom){if(this.dom={},this.dom.box=document.createElement("DIV"),this.dom.content=document.createElement("DIV"),this.dom.content.className="vis-item-content",this.dom.box.appendChild(this.dom.content),this.options.showStipes&&(this.dom.line=document.createElement("DIV"),this.dom.line.className="vis-cluster-line",this.dom.line.style.display="none",this.dom.dot=document.createElement("DIV"),this.dom.dot.className="vis-cluster-dot",this.dom.dot.style.display="none"),this.options.fitOnDoubleClick){var n;this.dom.box.ondblclick=Oe(n=e.prototype._onDoubleClick).call(n,this)}this.dom.box["vis-item"]=this,this.dirty=!0}}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.box.parentNode){var n=this.parent.dom.foreground;if(!n)throw new Error("Cannot redraw item: parent has no foreground container element");n.appendChild(this.dom.box)}var s=this.parent.dom.background;if(this.options.showStipes){if(!this.dom.line.parentNode){if(!s)throw new Error("Cannot redraw item: parent has no background container element");s.appendChild(this.dom.line)}if(!this.dom.dot.parentNode){var o=this.parent.dom.axis;if(!s)throw new Error("Cannot redraw item: parent has no axis container element");o.appendChild(this.dom.dot)}}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){if(this.dirty){this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.box),this._updateStyle(this.dom.box);var n=this.baseClassName+" "+(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+" vis-readonly";this.dom.box.className="vis-item "+n,this.options.showStipes&&(this.dom.line.className="vis-item vis-cluster-line "+(this.selected?" vis-selected":""),this.dom.dot.className="vis-item vis-cluster-dot "+(this.selected?" vis-selected":"")),this.data.end&&(this.dom.content.style.maxWidth="none")}}},{key:"_getDomComponentsSizes",value:function(){var n={previous:{right:this.dom.box.style.right,left:this.dom.box.style.left},box:{width:this.dom.box.offsetWidth,height:this.dom.box.offsetHeight}};return this.options.showStipes&&(n.dot={height:this.dom.dot.offsetHeight,width:this.dom.dot.offsetWidth},n.line={width:this.dom.line.offsetWidth}),n}},{key:"_updateDomComponentsSizes",value:function(n){this.options.rtl?this.dom.box.style.right="0px":this.dom.box.style.left="0px",this.data.end?this.minWidth=n.box.width:this.width=n.box.width,this.height=n.box.height,this.options.rtl?this.dom.box.style.right=n.previous.right:this.dom.box.style.left=n.previous.left,this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){this._repaintOnItemUpdateTimeTooltip(this.dom.box)}},{key:"_isStipeVisible",value:function(){return this.minWidth>=this.width||!this.data.end}},{key:"_getFitRange",value:function(){var n=.05*(this.data.max-this.data.min)/2;return{fitStart:this.data.min-n,fitEnd:this.data.max+n}}},{key:"_fit",value:function(){if(this.emitter){var n=this._getFitRange(),s=n.fitStart,o=n.fitEnd,l={start:new Date(s),end:new Date(o),animation:!0};this.emitter.emit("fit",l)}}},{key:"_getItemData",value:function(){return this.data}}]),e})(Ou);bk.prototype.baseClassName="vis-item vis-range vis-cluster";Cge="__ungrouped__",_ge="__background__",Sge={UNGROUPED:Cge,BACKGROUND:_ge},xge=(function(){function a(t){Gt(this,a),this.itemSet=t,this.groups={},this.cache={},this.cache[-1]=[]}return Vt(a,[{key:"createClusterItem",value:function(e,r,n){var s=new bk(e,r,n);return s}},{key:"setItems",value:function(e,r){this.items=e||[],this.dataChanged=!0,this.applyOnChangedLevel=!1,r&&r.applyOnChangedLevel&&(this.applyOnChangedLevel=r.applyOnChangedLevel)}},{key:"updateData",value:function(){this.dataChanged=!0,this.applyOnChangedLevel=!1}},{key:"getClusters",value:function(e,r,n){var s=typeof n=="boolean"?{}:n,o=s.maxItems,l=s.clusterCriteria;l||(l=function(){return!0}),o=o||1;var c=-1,u=2,d=0;if(r>0){if(r>=1)return[];c=Math.abs(Math.round(Math.log(100/r)/Math.log(u))),d=Math.abs(Math.pow(u,c))}if(this.dataChanged){var h=c!=this.cacheLevel,f=this.applyOnChangedLevel?h:!0;f&&(this._dropLevelsCache(),this._filterData())}this.cacheLevel=c;var m=this.cache[c];if(!m){m=[];for(var g in this.groups)if(this.groups.hasOwnProperty(g))for(var y=this.groups[g],v=y.length,E=0;E<v;){for(var C=y[E],_=1,x=E-1;x>=0&&C.center-y[x].center<d/2;)!y[x].cluster&&l(C.data,y[x].data)&&_++,x--;for(var P=E+1;P<y.length&&y[P].center-C.center<d/2;)l(C.data,y[P].data)&&_++,P++;for(var I=m.length-1;I>=0&&C.center-m[I].center<d;)C.group==m[I].group&&l(C.data,m[I].data)&&_++,I--;if(_>o){for(var M=_-o+1,O=[],R=E;O.length<M&&R<y.length;)l(y[E].data,y[R].data)&&O.push(y[R]),R++;var F=this.itemSet.getGroupId(C.data),$=this.itemSet.groups[F]||this.itemSet.groups[Sge.UNGROUPED],k=this._getClusterForItems(O,$,e,n);m.push(k),E+=M}else delete C.cluster,E+=1}this.cache[c]=m}return m}},{key:"_filterData",value:function(){var e={};this.groups=e;for(var r=0,n=kx(this.items);r<n.length;r++){var s=n[r],o=s.parent?s.parent.groupId:"",l=e[o];l||(l=[],e[o]=l),l.push(s),s.data.start&&(s.data.end?s.center=(s.data.start.valueOf()+s.data.end.valueOf())/2:s.center=s.data.start.valueOf())}for(var c in e)if(e.hasOwnProperty(c)){var u;ci(u=e[c]).call(u,function(d,h){return d.center-h.center})}this.dataChanged=!1}},{key:"_getClusterForItems",value:function(e,r,n,s){var o,l=sr(o=n||[]).call(o,function(_){var x;return{cluster:_,itemsIds:new Zl(sr(x=_.data.uiItems).call(x,function(P){return P.id}))}}),c;if(l.length){var u=Ege(l),d;try{var h=function(){var x=d.value;if(x.itemsIds.size===e.length&&vge(e).call(e,function(P){return x.itemsIds.has(P.id)}))return c=x.cluster,"break"};for(u.s();!(d=u.n()).done;){var f=h();if(f==="break")break}}catch(_){u.e(_)}finally{u.f()}}if(c)return c.setUiItems(e),c.group!==r&&(c.group&&c.group.remove(c),r&&(r.add(c),c.group=r)),c;var m=s.titleTemplate||"",g={toScreen:this.itemSet.body.util.toScreen,toTime:this.itemSet.body.util.toTime},y=m.replace(/{count}/,e.length),v='<div title="'+y+'">'+e.length+"</div>",E=Go({},s,this.itemSet.options),C={content:v,title:y,group:r,uiItems:e,eventEmitter:this.itemSet.body.emitter,range:this.itemSet.body.range};return c=this.createClusterItem(C,g,E),r&&(r.add(c),c.group=r),c.attach(),c}},{key:"_dropLevelsCache",value:function(){this.cache={},this.cacheLevel=-1,this.cache[this.cacheLevel]=[]}}]),a})(),kge=`
.vis-itemset {
  position: relative;
  padding: 0;
  margin: 0;

  box-sizing: border-box;
}

.vis-itemset .vis-background,
.vis-itemset .vis-foreground {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: visible;
}

.vis-axis {
  position: absolute;
  width: 100%;
  height: 0;
  left: 0;
  z-index: 1;
}

.vis-foreground .vis-group {
  position: relative;
  box-sizing: border-box;
  border-bottom: 1px solid #bfbfbf;
}

.vis-foreground .vis-group:last-child {
  border-bottom: none;
}

.vis-nesting-group {
  cursor: pointer;
}

.vis-label.vis-nested-group.vis-group-level-unknown-but-gte1 {
  background: #f5f5f5;
}
.vis-label.vis-nested-group.vis-group-level-0 {
  background-color: #ffffff;
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-0 .vis-inner {
  padding-left: 0;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-0 .vis-inner {
  padding-right: 0;
}
.vis-label.vis-nested-group.vis-group-level-1 {
  background-color: rgba(0, 0, 0, 0.05);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-1 .vis-inner {
  padding-left: 15px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-1 .vis-inner {
  padding-right: 15px;
}
.vis-label.vis-nested-group.vis-group-level-2 {
  background-color: rgba(0, 0, 0, 0.1);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-2 .vis-inner {
  padding-left: 30px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-2 .vis-inner {
  padding-right: 30px;
}
.vis-label.vis-nested-group.vis-group-level-3 {
  background-color: rgba(0, 0, 0, 0.15);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-3 .vis-inner {
  padding-left: 45px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-3 .vis-inner {
  padding-right: 45px;
}
.vis-label.vis-nested-group.vis-group-level-4 {
  background-color: rgba(0, 0, 0, 0.2);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-4 .vis-inner {
  padding-left: 60px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-4 .vis-inner {
  padding-right: 60px;
}
.vis-label.vis-nested-group.vis-group-level-5 {
  background-color: rgba(0, 0, 0, 0.25);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-5 .vis-inner {
  padding-left: 75px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-5 .vis-inner {
  padding-right: 75px;
}
.vis-label.vis-nested-group.vis-group-level-6 {
  background-color: rgba(0, 0, 0, 0.3);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-6 .vis-inner {
  padding-left: 90px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-6 .vis-inner {
  padding-right: 90px;
}
.vis-label.vis-nested-group.vis-group-level-7 {
  background-color: rgba(0, 0, 0, 0.35);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-7 .vis-inner {
  padding-left: 105px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-7 .vis-inner {
  padding-right: 105px;
}
.vis-label.vis-nested-group.vis-group-level-8 {
  background-color: rgba(0, 0, 0, 0.4);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-8 .vis-inner {
  padding-left: 120px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-8 .vis-inner {
  padding-right: 120px;
}
.vis-label.vis-nested-group.vis-group-level-9 {
  background-color: rgba(0, 0, 0, 0.45);
}
.vis-ltr .vis-label.vis-nested-group.vis-group-level-9 .vis-inner {
  padding-left: 135px;
}
.vis-rtl .vis-label.vis-nested-group.vis-group-level-9 .vis-inner {
  padding-right: 135px;
}
/* default takes over beginning with level-10 (thats why we add .vis-nested-group
  to the selectors above, to have higher specifity than these rules for the defaults) */
.vis-label.vis-nested-group {
  background-color: rgba(0, 0, 0, 0.5);
}
.vis-ltr .vis-label.vis-nested-group .vis-inner {
  padding-left: 150px;
}
.vis-rtl .vis-label.vis-nested-group .vis-inner {
  padding-right: 150px;
}

.vis-group-level-unknown-but-gte1 {
  border: 1px solid red;
}

/* expanded/collapsed indicators */
.vis-label.vis-nesting-group:before,
.vis-label.vis-nesting-group:before {
  display: inline-block;
  width: 15px;
}
.vis-label.vis-nesting-group.expanded:before {
  content: "\\25BC";
}
.vis-label.vis-nesting-group.collapsed:before {
  content: "\\25B6";
}
.vis-rtl .vis-label.vis-nesting-group.collapsed:before {
  content: "\\25C0";
}
/* compensate missing expanded/collapsed indicator, but only at levels > 0 */
.vis-ltr .vis-label:not(.vis-nesting-group):not(.vis-group-level-0) {
  padding-left: 15px;
}
.vis-rtl .vis-label:not(.vis-nesting-group):not(.vis-group-level-0) {
  padding-right: 15px;
}

.vis-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10;
}`;Gn(kge);Dge=`
.vis-labelset {
  position: relative;

  overflow: hidden;

  box-sizing: border-box;
}

.vis-labelset .vis-label {
  position: relative;
  left: 0;
  top: 0;
  width: 100%;
  color: #4d4d4d;

  box-sizing: border-box;
}

.vis-labelset .vis-label {
  border-bottom: 1px solid #bfbfbf;
}

.vis-labelset .vis-label.draggable {
  cursor: pointer;
}

.vis-group-is-dragging {
  background: rgba(0, 0, 0, .1);
}

.vis-labelset .vis-label:last-child {
  border-bottom: none;
}

.vis-labelset .vis-label .vis-inner {
  display: inline-block;
  padding: 5px;
}

.vis-labelset .vis-label .vis-inner.vis-hidden {
  padding: 0;
}
`;Gn(Dge);mh="__ungrouped__",Hl="__background__",lg=(function(a){Hn(e,a);var t=Lge(e);function e(r,n){var s;Gt(this,e),s=t.call(this),s.body=r,s.defaultOptions={type:null,orientation:{item:"bottom"},align:"auto",stack:!0,stackSubgroups:!0,groupOrderSwap:function(c,u,d){var h=u.order;u.order=c.order,c.order=h},groupOrder:"order",selectable:!0,multiselect:!1,longSelectPressTime:251,itemsAlwaysDraggable:{item:!1,range:!1},editable:{updateTime:!1,updateGroup:!1,add:!1,remove:!1,overrideItems:!1},groupEditable:{order:!1,add:!1,remove:!1},snap:sg.snap,onDropObjectOnItem:function(c,u,d){d(u)},onAdd:function(c,u){u(c)},onUpdate:function(c,u){u(c)},onMove:function(c,u){u(c)},onRemove:function(c,u){u(c)},onMoving:function(c,u){u(c)},onAddGroup:function(c,u){u(c)},onMoveGroup:function(c,u){u(c)},onRemoveGroup:function(c,u){u(c)},margin:{item:{horizontal:10,vertical:10},axis:20},showTooltips:!0,tooltip:{followMouse:!1,overflowMethod:"flip",delay:500},tooltipOnItemUpdateTime:!1},s.options=ae.extend({},s.defaultOptions),s.options.rtl=n.rtl,s.options.onTimeout=n.onTimeout,s.conversion={toScreen:r.util.toScreen,toTime:r.util.toTime},s.dom={},s.props={},s.hammer=null;var o=wr(s);return s.itemsData=null,s.groupsData=null,s.itemsSettingTime=null,s.initialItemSetDrawn=!1,s.userContinueNotBail=null,s.sequentialSelection=!1,s.itemListeners={add:function(c,u,d){o._onAdd(u.items),o.options.cluster&&o.clusterGenerator.setItems(o.items,{applyOnChangedLevel:!1}),o.redraw()},update:function(c,u,d){o._onUpdate(u.items),o.options.cluster&&o.clusterGenerator.setItems(o.items,{applyOnChangedLevel:!1}),o.redraw()},remove:function(c,u,d){o._onRemove(u.items),o.options.cluster&&o.clusterGenerator.setItems(o.items,{applyOnChangedLevel:!1}),o.redraw()}},s.groupListeners={add:function(c,u,d){if(o._onAddGroups(u.items),o.groupsData&&o.groupsData.length>0){var h,f=o.groupsData.getDataSet();Ue(h=f.get()).call(h,function(m){if(m.nestedGroups){var g;m.showNested!=!1&&(m.showNested=!0);var y=[];Ue(g=m.nestedGroups).call(g,function(v){var E=f.get(v);E&&(E.nestedInGroup=m.id,m.showNested==!1&&(E.visible=!1),y=Ir(y).call(y,E))}),f.update(y,d)}})}},update:function(c,u,d){o._onUpdateGroups(u.items)},remove:function(c,u,d){o._onRemoveGroups(u.items)}},s.items={},s.groups={},s.groupIds=[],s.selection=[],s.popup=null,s.popupTimer=null,s.touchParams={},s.groupTouchParams={group:null,isDragging:!1},s._create(),s.setOptions(n),s.clusters=[],s}return Vt(e,[{key:"_create",value:function(){var n=this,s,o,l,c,u,d,h,f,m,g,y,v,E,C,_,x=document.createElement("div");x.className="vis-itemset",x["vis-itemset"]=this,this.dom.frame=x;var P=document.createElement("div");P.className="vis-background",x.appendChild(P),this.dom.background=P;var I=document.createElement("div");I.className="vis-foreground",x.appendChild(I),this.dom.foreground=I;var M=document.createElement("div");M.className="vis-axis",this.dom.axis=M;var O=document.createElement("div");O.className="vis-labelset",this.dom.labelSet=O,this._updateUngrouped();var R=new yk(Hl,null,this);R.show(),this.groups[Hl]=R,this.hammer=new yn(this.body.dom.centerContainer),this.hammer.on("hammer.input",function(F){F.isFirst&&n._onTouch(F)}),this.hammer.on("panstart",Oe(s=this._onDragStart).call(s,this)),this.hammer.on("panmove",Oe(o=this._onDrag).call(o,this)),this.hammer.on("panend",Oe(l=this._onDragEnd).call(l,this)),this.hammer.get("pan").set({threshold:5,direction:yn.ALL}),this.hammer.get("press").set({time:1e4}),this.hammer.on("tap",Oe(c=this._onSelectItem).call(c,this)),this.hammer.on("press",Oe(u=this._onMultiSelectItem).call(u,this)),this.hammer.get("press").set({time:1e4}),this.hammer.on("doubletap",Oe(d=this._onAddItem).call(d,this)),this.options.rtl?this.groupHammer=new yn(this.body.dom.rightContainer):this.groupHammer=new yn(this.body.dom.leftContainer),this.groupHammer.on("tap",Oe(h=this._onGroupClick).call(h,this)),this.groupHammer.on("panstart",Oe(f=this._onGroupDragStart).call(f,this)),this.groupHammer.on("panmove",Oe(m=this._onGroupDrag).call(m,this)),this.groupHammer.on("panend",Oe(g=this._onGroupDragEnd).call(g,this)),this.groupHammer.get("pan").set({threshold:5,direction:yn.DIRECTION_VERTICAL}),this.body.dom.centerContainer.addEventListener("mouseover",Oe(y=this._onMouseOver).call(y,this)),this.body.dom.centerContainer.addEventListener("mouseout",Oe(v=this._onMouseOut).call(v,this)),this.body.dom.centerContainer.addEventListener("mousemove",Oe(E=this._onMouseMove).call(E,this)),this.body.dom.centerContainer.addEventListener("contextmenu",Oe(C=this._onDragEnd).call(C,this)),this.body.dom.centerContainer.addEventListener("mousewheel",Oe(_=this._onMouseWheel).call(_,this)),this.show()}},{key:"setOptions",value:function(n){var s=this;if(n){var o,l,c=["type","rtl","align","order","stack","stackSubgroups","selectable","multiselect","sequentialSelection","multiselectPerGroup","longSelectPressTime","groupOrder","dataAttributes","template","groupTemplate","visibleFrameTemplate","hide","snap","groupOrderSwap","showTooltips","tooltip","tooltipOnItemUpdateTime","groupHeightMode","onTimeout"];ae.selectiveExtend(c,this.options,n),"itemsAlwaysDraggable"in n&&(typeof n.itemsAlwaysDraggable=="boolean"?(this.options.itemsAlwaysDraggable.item=n.itemsAlwaysDraggable,this.options.itemsAlwaysDraggable.range=!1):yt(n.itemsAlwaysDraggable)==="object"&&(ae.selectiveExtend(["item","range"],this.options.itemsAlwaysDraggable,n.itemsAlwaysDraggable),this.options.itemsAlwaysDraggable.item||(this.options.itemsAlwaysDraggable.range=!1))),"sequentialSelection"in n&&typeof n.sequentialSelection=="boolean"&&(this.options.sequentialSelection=n.sequentialSelection),"orientation"in n&&(typeof n.orientation=="string"?this.options.orientation.item=n.orientation==="top"?"top":"bottom":yt(n.orientation)==="object"&&"item"in n.orientation&&(this.options.orientation.item=n.orientation.item)),"margin"in n&&(typeof n.margin=="number"?(this.options.margin.axis=n.margin,this.options.margin.item.horizontal=n.margin,this.options.margin.item.vertical=n.margin):yt(n.margin)==="object"&&(ae.selectiveExtend(["axis"],this.options.margin,n.margin),"item"in n.margin&&(typeof n.margin.item=="number"?(this.options.margin.item.horizontal=n.margin.item,this.options.margin.item.vertical=n.margin.item):yt(n.margin.item)==="object"&&ae.selectiveExtend(["horizontal","vertical"],this.options.margin.item,n.margin.item)))),Ue(o=["locale","locales"]).call(o,function(d){d in n&&(s.options[d]=n[d])}),"editable"in n&&(typeof n.editable=="boolean"?(this.options.editable.updateTime=n.editable,this.options.editable.updateGroup=n.editable,this.options.editable.add=n.editable,this.options.editable.remove=n.editable,this.options.editable.overrideItems=!1):yt(n.editable)==="object"&&ae.selectiveExtend(["updateTime","updateGroup","add","remove","overrideItems"],this.options.editable,n.editable)),"groupEditable"in n&&(typeof n.groupEditable=="boolean"?(this.options.groupEditable.order=n.groupEditable,this.options.groupEditable.add=n.groupEditable,this.options.groupEditable.remove=n.groupEditable):yt(n.groupEditable)==="object"&&ae.selectiveExtend(["order","add","remove"],this.options.groupEditable,n.groupEditable));var u=function(h){var f=n[h];if(f){if(typeof f!="function"){var m;throw new Error(Ir(m="option ".concat(h," must be a function ")).call(m,h,"(item, callback)"))}s.options[h]=f}};Ue(l=["onDropObjectOnItem","onAdd","onUpdate","onRemove","onMove","onMoving","onAddGroup","onMoveGroup","onRemoveGroup"]).call(l,u),n.cluster?(Go(this.options,{cluster:n.cluster}),this.clusterGenerator||(this.clusterGenerator=new xge(this)),this.clusterGenerator.setItems(this.items,{applyOnChangedLevel:!1}),this.markDirty({refreshItems:!0,restackGroups:!0}),this.redraw()):this.clusterGenerator?(this._detachAllClusters(),this.clusters=[],this.clusterGenerator=null,this.options.cluster=void 0,this.markDirty({refreshItems:!0,restackGroups:!0}),this.redraw()):this.markDirty()}}},{key:"markDirty",value:function(n){this.groupIds=[],n&&(n.refreshItems&&Ue(ae).call(ae,this.items,function(s){s.dirty=!0,s.displayed&&s.redraw()}),n.restackGroups&&Ue(ae).call(ae,this.groups,function(s,o){o!==Hl&&(s.stackDirty=!0)}))}},{key:"destroy",value:function(){this.clearPopupTimer(),this.hide(),this.setItems(null),this.setGroups(null),this.hammer&&this.hammer.destroy(),this.groupHammer&&this.groupHammer.destroy(),this.hammer=null,this.body=null,this.conversion=null}},{key:"hide",value:function(){this.dom.frame.parentNode&&this.dom.frame.parentNode.removeChild(this.dom.frame),this.dom.axis.parentNode&&this.dom.axis.parentNode.removeChild(this.dom.axis),this.dom.labelSet.parentNode&&this.dom.labelSet.parentNode.removeChild(this.dom.labelSet)}},{key:"show",value:function(){this.dom.frame.parentNode||this.body.dom.center.appendChild(this.dom.frame),this.dom.axis.parentNode||this.body.dom.backgroundVertical.appendChild(this.dom.axis),this.dom.labelSet.parentNode||(this.options.rtl?this.body.dom.right.appendChild(this.dom.labelSet):this.body.dom.left.appendChild(this.dom.labelSet))}},{key:"setPopupTimer",value:function(n){if(this.clearPopupTimer(),n){var s=this.options.tooltip.delay||typeof this.options.tooltip.delay=="number"?this.options.tooltip.delay:500;this.popupTimer=wn(function(){n.show()},s)}}},{key:"clearPopupTimer",value:function(){this.popupTimer!=null&&(clearTimeout(this.popupTimer),this.popupTimer=null)}},{key:"setSelection",value:function(n){var s;n==null&&(n=[]),Tt(n)||(n=[n]);var o=lt(s=this.selection).call(s,function(y){return Er(n).call(n,y)===-1}),l=lu(o),c;try{for(l.s();!(c=l.n()).done;){var u=c.value,d=this.getItemById(u);d&&d.unselect()}}catch(y){l.e(y)}finally{l.f()}this.selection=Ur(n);var h=lu(n),f;try{for(h.s();!(f=h.n()).done;){var m=f.value,g=this.getItemById(m);g&&g.select()}}catch(y){h.e(y)}finally{h.f()}}},{key:"getSelection",value:function(){var n;return Ir(n=this.selection).call(n,[])}},{key:"getVisibleItems",value:function(){var n=this.body.range.getRange(),s,o;this.options.rtl?(s=this.body.util.toScreen(n.start),o=this.body.util.toScreen(n.end)):(o=this.body.util.toScreen(n.start),s=this.body.util.toScreen(n.end));var l=[];for(var c in this.groups)if(this.groups.hasOwnProperty(c)){var u=this.groups[c],d=u.isVisible?u.visibleItems:[],h=lu(d),f;try{for(h.s();!(f=h.n()).done;){var m=f.value;this.options.rtl?m.right<o&&m.right+m.width>s&&l.push(m.id):m.left<s&&m.left+m.width>o&&l.push(m.id)}}catch(g){h.e(g)}finally{h.f()}}return l}},{key:"getItemsAtCurrentTime",value:function(n){var s,o;this.options.rtl?(s=this.body.util.toScreen(n),o=this.body.util.toScreen(n)):(o=this.body.util.toScreen(n),s=this.body.util.toScreen(n));var l=[];for(var c in this.groups)if(this.groups.hasOwnProperty(c)){var u=this.groups[c],d=u.isVisible?u.visibleItems:[],h=lu(d),f;try{for(h.s();!(f=h.n()).done;){var m=f.value;this.options.rtl?m.right<o&&m.right+m.width>s&&l.push(m.id):m.left<s&&m.left+m.width>o&&l.push(m.id)}}catch(g){h.e(g)}finally{h.f()}}return l}},{key:"getVisibleGroups",value:function(){var n=[];for(var s in this.groups)if(this.groups.hasOwnProperty(s)){var o=this.groups[s];o.isVisible&&n.push(s)}return n}},{key:"getItemById",value:function(n){var s;return this.items[n]||kme(s=this.clusters).call(s,function(o){return o.id===n})}},{key:"_deselect",value:function(n){for(var s=this.selection,o=0,l=s.length;o<l;o++)if(s[o]==n){Bn(s).call(s,o,1);break}}},{key:"redraw",value:function(){var n=this,s=this.options.margin,o=this.body.range,l=ae.option.asSize,c=this.options,u=c.orientation.item,d=!1,h=this.dom.frame;this.props.top=this.body.domProps.top.height+this.body.domProps.border.top,this.options.rtl?this.props.right=this.body.domProps.right.width+this.body.domProps.border.right:this.props.left=this.body.domProps.left.width+this.body.domProps.border.left,h.className="vis-itemset",this.options.cluster&&this._clusterItems(),d=this._orderGroups()||d;var f=o.end-o.start,m=f!=this.lastVisibleInterval||this.props.width!=this.props.lastWidth,g=o.start!=this.lastRangeStart,y=c.stack!=this.lastStack,v=c.stackSubgroups!=this.lastStackSubgroups,E=m||g||y||v;this.lastVisibleInterval=f,this.lastRangeStart=o.start,this.lastStack=c.stack,this.lastStackSubgroups=c.stackSubgroups,this.props.lastWidth=this.props.width;var C=this._firstGroup(),_={item:s.item,axis:s.axis},x={item:s.item,axis:s.item.vertical/2},P=0,I=s.axis+s.item.vertical;this.groups[Hl].redraw(o,x,E);var M={},O=0;Ue(ae).call(ae,this.groups,function(F,$){if($!==Hl){var k=F==C?_:x,N=!0;M[$]=F.redraw(o,k,E,N),O=M[$].length}});var R=O>0;return R&&(function(){for(var F={},$=function(G){Ue(ae).call(ae,M,function(W,Y){F[Y]=W[G]()})},k=0;k<O;k++)$(k);Ue(ae).call(ae,n.groups,function(N,G){if(G!==Hl){var W=F[G];d=W||d,P+=N.height}}),P=Math.max(P,I)})(),P=Math.max(P,I),h.style.height=l(P),this.props.width=h.offsetWidth,this.props.height=P,this.dom.axis.style.top=l(u=="top"?this.body.domProps.top.height+this.body.domProps.border.top:this.body.domProps.top.height+this.body.domProps.centerContainer.height),this.options.rtl?this.dom.axis.style.right="0":this.dom.axis.style.left="0",this.hammer.get("press").set({time:this.options.longSelectPressTime}),this.initialItemSetDrawn=!0,d=this._isResized()||d,d}},{key:"_firstGroup",value:function(){var n=this.options.orientation.item=="top"?0:this.groupIds.length-1,s=this.groupIds[n],o=this.groups[s]||this.groups[mh];return o||null}},{key:"_updateUngrouped",value:function(){var n=this.groups[mh],s,o;if(this.groupsData){if(n){n.dispose(),delete this.groups[mh];for(o in this.items)if(this.items.hasOwnProperty(o)){s=this.items[o],s.parent&&s.parent.remove(s);var l=this.getGroupId(s.data),c=this.groups[l];c&&c.add(s)||s.hide()}}}else if(!n){var u=null,d=null;n=new qb(u,d,this),this.groups[mh]=n;for(o in this.items)this.items.hasOwnProperty(o)&&(s=this.items[o],n.add(s));n.show()}}},{key:"getLabelSet",value:function(){return this.dom.labelSet}},{key:"setItems",value:function(n){this.itemsSettingTime=new Date;var s=this,o,l=this.itemsData;if(!n)this.itemsData=null;else if(Uo(n))this.itemsData=Nh(n);else throw new TypeError("Data must implement the interface of DataSet or DataView");if(l&&(Ue(ae).call(ae,this.itemListeners,function(u,d){l.off(d,u)}),l.dispose(),o=l.getIds(),this._onRemove(o)),this.itemsData){var c=this.id;Ue(ae).call(ae,this.itemListeners,function(u,d){s.itemsData.on(d,u,c)}),o=this.itemsData.getIds(),this._onAdd(o),this._updateUngrouped()}this.body.emitter.emit("_change",{queue:!0})}},{key:"getItems",value:function(){return this.itemsData!=null?this.itemsData.rawDS:null}},{key:"setGroups",value:function(n){var s=this,o;if(this.groupsData&&(Ue(ae).call(ae,this.groupListeners,function(d,h){s.groupsData.off(h,d)}),o=this.groupsData.getIds(),this.groupsData=null,this._onRemoveGroups(o)),!n)this.groupsData=null;else if(Uo(n))this.groupsData=n;else throw new TypeError("Data must implement the interface of DataSet or DataView");if(this.groupsData){var l,c=this.groupsData.getDataSet();Ue(l=c.get()).call(l,function(d){if(d.nestedGroups){var h;Ue(h=d.nestedGroups).call(h,function(f){var m=c.get(f);m.nestedInGroup=d.id,d.showNested==!1&&(m.visible=!1),c.update(m)})}});var u=this.id;Ue(ae).call(ae,this.groupListeners,function(d,h){s.groupsData.on(h,d,u)}),o=this.groupsData.getIds(),this._onAddGroups(o)}this._updateUngrouped(),this._order(),this.options.cluster&&(this.clusterGenerator.updateData(),this._clusterItems(),this.markDirty({refreshItems:!0,restackGroups:!0})),this.body.emitter.emit("_change",{queue:!0})}},{key:"getGroups",value:function(){return this.groupsData}},{key:"removeItem",value:function(n){var s=this,o=this.itemsData.get(n);o&&this.options.onRemove(o,function(l){l&&s.itemsData.remove(n)})}},{key:"_getType",value:function(n){return n.type||this.options.type||(n.end?"range":"box")}},{key:"getGroupId",value:function(n){var s=this._getType(n);return s=="background"&&n.group==null?Hl:this.groupsData?n.group:mh}},{key:"_onUpdate",value:function(n){var s=this,o=this;Ue(n).call(n,function(l){var c=o.itemsData.get(l),u=o.items[l],d=c?o._getType(c):null,h=e.types[d],f;if(u&&(!h||!(u instanceof h)?(f=u.selected,o._removeItem(u),u=null):o._updateItem(u,c)),!u&&c)if(h)u=new h(c,o.conversion,o.options),u.id=l,o._addItem(u),f&&(s.selection.push(l),u.select());else throw new TypeError('Unknown item type "'.concat(d,'"'))}),this._order(),this.options.cluster&&(this.clusterGenerator.setItems(this.items,{applyOnChangedLevel:!1}),this._clusterItems()),this.body.emitter.emit("_change",{queue:!0})}},{key:"_onRemove",value:function(n){var s=0,o=this;Ue(n).call(n,function(l){var c=o.items[l];c&&(s++,o._removeItem(c))}),s&&(this._order(),this.body.emitter.emit("_change",{queue:!0}))}},{key:"_order",value:function(){Ue(ae).call(ae,this.groups,function(n){n.order()})}},{key:"_onUpdateGroups",value:function(n){this._onAddGroups(n)}},{key:"_onAddGroups",value:function(n){var s=this;Ue(n).call(n,function(o){var l=s.groupsData.get(o),c=s.groups[o];if(c)c.setData(l);else{if(o==mh||o==Hl)throw new Error("Illegal group id. ".concat(o," is a reserved id."));var u=Cg(s.options);ae.extend(u,{height:null}),c=new qb(o,l,s),s.groups[o]=c;for(var d in s.items)if(s.items.hasOwnProperty(d)){var h=s.items[d];h.data.group==o&&c.add(h)}c.order(),c.show()}}),this.body.emitter.emit("_change",{queue:!0})}},{key:"_onRemoveGroups",value:function(n){var s=this;Ue(n).call(n,function(o){var l=s.groups[o];l&&(l.dispose(),delete s.groups[o])}),this.options.cluster&&(this.clusterGenerator.updateData(),this._clusterItems()),this.markDirty({restackGroups:!!this.options.cluster}),this.body.emitter.emit("_change",{queue:!0})}},{key:"_orderGroups",value:function(){if(this.groupsData){var n=this.groupsData.getIds({order:this.options.groupOrder});n=this._orderNestedGroups(n);var s=!ae.equalArray(n,this.groupIds);if(s){var o=this.groups;Ue(n).call(n,function(l){o[l].hide()}),Ue(n).call(n,function(l){o[l].show()}),this.groupIds=n}return s}else return!1}},{key:"_orderNestedGroups",value:function(n){var s=this;function o(c,u){var d=[];return Ue(u).call(u,function(h){d.push(h);var f=c.groupsData.get(h);if(f.nestedGroups){var m,g=sr(m=c.groupsData.get({filter:function(v){return v.nestedInGroup==h},order:c.options.groupOrder})).call(m,function(y){return y.id});d=Ir(d).call(d,o(c,g))}}),d}var l=lt(n).call(n,function(c){return!s.groupsData.get(c).nestedInGroup});return o(this,l)}},{key:"_addItem",value:function(n){this.items[n.id]=n;var s=this.getGroupId(n.data),o=this.groups[s];o?o&&o.data&&o.data.showNested&&(n.groupShowing=!0):n.groupShowing=!1,o&&o.add(n)}},{key:"_updateItem",value:function(n,s){n.setData(s);var o=this.getGroupId(n.data),l=this.groups[o];l?l&&l.data&&l.data.showNested&&(n.groupShowing=!0):n.groupShowing=!1}},{key:"_removeItem",value:function(n){var s,o;n.hide(),delete this.items[n.id];var l=Er(s=this.selection).call(s,n.id);l!=-1&&Bn(o=this.selection).call(o,l,1),n.parent&&n.parent.remove(n),this.popup!=null&&this.popup.hide()}},{key:"_constructByEndArray",value:function(n){for(var s=[],o=0;o<n.length;o++)n[o]instanceof Jl&&s.push(n[o]);return s}},{key:"_onTouch",value:function(n){this.touchParams.item=this.itemFromTarget(n),this.touchParams.dragLeftItem=n.target.dragLeftItem||!1,this.touchParams.dragRightItem=n.target.dragRightItem||!1,this.touchParams.itemProps=null}},{key:"_getGroupIndex",value:function(n){for(var s=0;s<this.groupIds.length;s++)if(n==this.groupIds[s])return s}},{key:"_onDragStart",value:function(n){var s=this;if(!this.touchParams.itemIsDragging){var o=this.touchParams.item||null,l=this,c;if(o&&(o.selected||this.options.itemsAlwaysDraggable.item)){if(this.options.editable.overrideItems&&!this.options.editable.updateTime&&!this.options.editable.updateGroup||o.editable!=null&&!o.editable.updateTime&&!o.editable.updateGroup&&!this.options.editable.overrideItems)return;var u=this.touchParams.dragLeftItem,d=this.touchParams.dragRightItem;if(this.touchParams.itemIsDragging=!0,this.touchParams.selectedItem=o,u)c={item:u,initialX:n.center.x,dragLeft:!0,data:this._cloneItemData(o.data)},this.touchParams.itemProps=[c];else if(d)c={item:d,initialX:n.center.x,dragRight:!0,data:this._cloneItemData(o.data)},this.touchParams.itemProps=[c];else if(this.options.editable.add&&(n.srcEvent.ctrlKey||n.srcEvent.metaKey))this._onDragStartAddItem(n);else{this.groupIds.length<1&&this.redraw();var h=this._getGroupIndex(o.data.group),f=this.options.itemsAlwaysDraggable.item&&!o.selected?[o.id]:this.getSelection();this.touchParams.itemProps=sr(f).call(f,function(m){var g=l.items[m],y=l._getGroupIndex(g.data.group);return{item:g,initialX:n.center.x,groupOffset:h-y,data:s._cloneItemData(g.data)}})}n.stopPropagation()}else this.options.editable.add&&(n.srcEvent.ctrlKey||n.srcEvent.metaKey)&&this._onDragStartAddItem(n)}}},{key:"_onDragStartAddItem",value:function(n){var s=this.options.snap||null,o=this.dom.frame.getBoundingClientRect(),l=this.options.rtl?o.right-n.center.x+10:n.center.x-o.left-10,c=this.body.util.toTime(l),u=this.body.util.getScale(),d=this.body.util.getStep(),h=s?s(c,u,d):c,f=h,m={type:"range",start:h,end:f,content:"new item"},g=gu();m[this.itemsData.idProp]=g;var y=this.groupFromTarget(n);y&&(m.group=y.groupId);var v=new Jl(m,this.conversion,this.options);v.id=g,v.data=this._cloneItemData(m),this._addItem(v),this.touchParams.selectedItem=v;var E={item:v,initialX:n.center.x,data:v.data};this.options.rtl?E.dragLeft=!0:E.dragRight=!0,this.touchParams.itemProps=[E],n.stopPropagation()}},{key:"_onDrag",value:function(n){var s=this;if(this.popup!=null&&this.options.showTooltips&&!this.popup.hidden){var o=this.body.dom.centerContainer,l=o.getBoundingClientRect();this.popup.setPosition(n.center.x-l.left+o.offsetLeft,n.center.y-l.top+o.offsetTop),this.popup.show()}if(this.touchParams.itemProps){var c;n.stopPropagation();var u=this,d=this.options.snap||null,h=this.body.dom.root.offsetLeft,f=this.options.rtl?h+this.body.domProps.right.width:h+this.body.domProps.left.width,m=this.body.util.getScale(),g=this.body.util.getStep(),y=this.touchParams.selectedItem,v=(this.options.editable.overrideItems||y.editable==null)&&this.options.editable.updateGroup||!this.options.editable.overrideItems&&y.editable!=null&&y.editable.updateGroup,E=null;if(v&&y&&y.data.group!=null){var C=u.groupFromTarget(n);C&&(E=this._getGroupIndex(C.groupId))}Ue(c=this.touchParams.itemProps).call(c,function(_){var x=u.body.util.toTime(n.center.x-f),P=u.body.util.toTime(_.initialX-f),I,M,O,R,F;s.options.rtl?I=-(x-P):I=x-P;var $=s._cloneItemData(_.item.data);if(!(_.item.editable!=null&&!_.item.editable.updateTime&&!_.item.editable.updateGroup&&!u.options.editable.overrideItems)){var k=(s.options.editable.overrideItems||y.editable==null)&&s.options.editable.updateTime||!s.options.editable.overrideItems&&y.editable!=null&&y.editable.updateTime;if(k){if(_.dragLeft)s.options.rtl?$.end!=null&&(O=ae.convert(_.data.end,"Date"),F=new Date(O.valueOf()+I),$.end=d?d(F,m,g):F):$.start!=null&&(M=ae.convert(_.data.start,"Date"),R=new Date(M.valueOf()+I),$.start=d?d(R,m,g):R);else if(_.dragRight)s.options.rtl?$.start!=null&&(M=ae.convert(_.data.start,"Date"),R=new Date(M.valueOf()+I),$.start=d?d(R,m,g):R):$.end!=null&&(O=ae.convert(_.data.end,"Date"),F=new Date(O.valueOf()+I),$.end=d?d(F,m,g):F);else if($.start!=null)if(M=ae.convert(_.data.start,"Date").valueOf(),R=new Date(M+I),$.end!=null){O=ae.convert(_.data.end,"Date");var N=O.valueOf()-M.valueOf();$.start=d?d(R,m,g):R,$.end=new Date($.start.valueOf()+N)}else $.start=d?d(R,m,g):R}if(v&&!_.dragLeft&&!_.dragRight&&E!=null&&$.group!=null){var G=E-_.groupOffset;G=Math.max(0,G),G=Math.min(u.groupIds.length-1,G),$.group=u.groupIds[G]}$=s._cloneItemData($),u.options.onMoving($,function(W){W&&_.item.setData(s._cloneItemData(W,"Date"))})}}),this.body.emitter.emit("_change")}}},{key:"_moveToGroup",value:function(n,s){var o=this.groups[s];if(o&&o.groupId!=n.data.group){var l=n.parent;l.remove(n),l.order(),n.data.group=o.groupId,o.add(n),o.order()}}},{key:"_onDragEnd",value:function(n){var s=this;if(this.touchParams.itemIsDragging=!1,this.touchParams.itemProps){n.stopPropagation();var o=this,l=this.touchParams.itemProps;this.touchParams.itemProps=null,Ue(l).call(l,function(c){var u=c.item.id,d=o.itemsData.get(u)!=null;if(!d)o.options.onAdd(c.item.data,function(f){o._removeItem(c.item),f&&o.itemsData.add(f),o.body.emitter.emit("_change")});else{var h=s._cloneItemData(c.item.data);o.options.onMove(h,function(f){f?(f[s.itemsData.idProp]=u,s.itemsData.update(f)):(c.item.setData(c.data),o.body.emitter.emit("_change"))})}})}}},{key:"_onGroupClick",value:function(n){var s=this,o=this.groupFromTarget(n);wn(function(){s.toggleGroupShowNested(o)},1)}},{key:"toggleGroupShowNested",value:function(n){var s,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;if(!(!n||!n.nestedGroups)){var l=this.groupsData.getDataSet();o!=null?n.showNested=!!o:n.showNested=!n.showNested;var c=l.get(n.groupId);c.showNested=n.showNested;for(var u=n.nestedGroups,d=u;d.length>0;){var h=d;d=[];for(var f=0;f<h.length;f++){var m=l.get(h[f]);m.nestedGroups&&(d=Ir(d).call(d,m.nestedGroups))}d.length>0&&(u=Ir(u).call(u,d))}var g=sr(s=l.get(u)).call(s,function(y){return y.visible==null&&(y.visible=!0),y.visible=!!c.showNested,y});l.update(Ir(g).call(g,c)),c.showNested?(ae.removeClassName(n.dom.label,"collapsed"),ae.addClassName(n.dom.label,"expanded")):(ae.removeClassName(n.dom.label,"expanded"),ae.addClassName(n.dom.label,"collapsed"))}}},{key:"toggleGroupDragClassName",value:function(n){n.dom.label.classList.toggle("vis-group-is-dragging"),n.dom.foreground.classList.toggle("vis-group-is-dragging")}},{key:"_onGroupDragStart",value:function(n){this.groupTouchParams.isDragging||this.options.groupEditable.order&&(this.groupTouchParams.group=this.groupFromTarget(n),this.groupTouchParams.group&&(n.stopPropagation(),this.groupTouchParams.isDragging=!0,this.toggleGroupDragClassName(this.groupTouchParams.group),this.groupTouchParams.originalOrder=this.groupsData.getIds({order:this.options.groupOrder})))}},{key:"_onGroupDrag",value:function(n){if(this.options.groupEditable.order&&this.groupTouchParams.group){n.stopPropagation();var s=this.groupsData.getDataSet(),o=this.groupFromTarget(n);if(o&&o.height!=this.groupTouchParams.group.height){var l=o.top<this.groupTouchParams.group.top,c=n.center?n.center.y:n.clientY,u=o.dom.foreground.getBoundingClientRect(),d=this.groupTouchParams.group.height;if(l){if(u.top+d<c)return}else{var h=o.height;if(u.top+h-d>c)return}}if(o&&o!=this.groupTouchParams.group){var f=s.get(o.groupId),m=s.get(this.groupTouchParams.group.groupId);m&&f&&(this.options.groupOrderSwap(m,f,s),s.update(m),s.update(f));var g=s.getIds({order:this.options.groupOrder});if(!ae.equalArray(g,this.groupTouchParams.originalOrder))for(var y=this.groupTouchParams.originalOrder,v=this.groupTouchParams.group.groupId,E=Math.min(y.length,g.length),C=0,_=0,x=0;C<E;){for(;C+_<E&&C+x<E&&g[C+_]==y[C+x];)C++;if(C+_>=E)break;if(g[C+_]==v)_=1;else if(y[C+x]==v)x=1;else{var P=Er(g).call(g,y[C+x]),I=s.get(g[C+_]),M=s.get(y[C+x]);this.options.groupOrderSwap(I,M,s),s.update(I),s.update(M);var O=g[C+_];g[C+_]=y[C+x],g[P]=O,C++}}}}}},{key:"_onGroupDragEnd",value:function(n){if(this.groupTouchParams.isDragging=!1,this.options.groupEditable.order&&this.groupTouchParams.group){n.stopPropagation();var s=this,o=s.groupTouchParams.group.groupId,l=s.groupsData.getDataSet(),c=ae.extend({},l.get(o));s.options.onMoveGroup(c,function(u){if(u)u[l._idProp]=o,l.update(u);else{var d=l.getIds({order:s.options.groupOrder});if(!ae.equalArray(d,s.groupTouchParams.originalOrder))for(var h=s.groupTouchParams.originalOrder,f=Math.min(h.length,d.length),m=0;m<f;){for(;m<f&&d[m]==h[m];)m++;if(m>=f)break;var g=Er(d).call(d,h[m]),y=l.get(d[m]),v=l.get(h[m]);s.options.groupOrderSwap(y,v,l),l.update(y),l.update(v);var E=d[m];d[m]=h[m],d[g]=E,m++}}}),s.body.emitter.emit("groupDragged",{groupId:o}),this.toggleGroupDragClassName(this.groupTouchParams.group),this.groupTouchParams.group=null}}},{key:"_onSelectItem",value:function(n){if(this.options.selectable){var s=n.srcEvent&&(n.srcEvent.ctrlKey||n.srcEvent.metaKey),o=n.srcEvent&&n.srcEvent.shiftKey;if(s||o){this._onMultiSelectItem(n);return}var l=this.getSelection(),c=this.itemFromTarget(n),u=c&&c.selectable?[c.id]:[];this.setSelection(u);var d=this.getSelection();(d.length>0||l.length>0)&&this.body.emitter.emit("select",{items:d,event:n})}}},{key:"_onMouseOver",value:function(n){var s=this.itemFromTarget(n);if(s){var o=this.itemFromRelatedTarget(n);if(s!==o){var l=s.getTitle();if(this.options.showTooltips&&l){this.popup==null&&(this.popup=new age(this.body.dom.root,this.options.tooltip.overflowMethod||"flip")),this.popup.setText(l);var c=this.body.dom.centerContainer,u=c.getBoundingClientRect();this.popup.setPosition(n.clientX-u.left+c.offsetLeft,n.clientY-u.top+c.offsetTop),this.setPopupTimer(this.popup)}else this.clearPopupTimer(),this.popup!=null&&this.popup.hide();this.body.emitter.emit("itemover",{item:s.id,event:n})}}}},{key:"_onMouseOut",value:function(n){var s=this.itemFromTarget(n);if(s){var o=this.itemFromRelatedTarget(n);s!==o&&(this.clearPopupTimer(),this.popup!=null&&this.popup.hide(),this.body.emitter.emit("itemout",{item:s.id,event:n}))}}},{key:"_onMouseMove",value:function(n){var s=this.itemFromTarget(n);if(s&&(this.popupTimer!=null&&this.setPopupTimer(this.popup),this.options.showTooltips&&this.options.tooltip.followMouse&&this.popup&&!this.popup.hidden)){var o=this.body.dom.centerContainer,l=o.getBoundingClientRect();this.popup.setPosition(n.clientX-l.left+o.offsetLeft,n.clientY-l.top+o.offsetTop),this.popup.show()}}},{key:"_onMouseWheel",value:function(n){this.touchParams.itemIsDragging&&this._onDragEnd(n)}},{key:"_onUpdateItem",value:function(n){if(this.options.selectable&&!(!this.options.editable.updateTime&&!this.options.editable.updateGroup)){var s=this;if(n){var o=s.itemsData.get(n.id);this.options.onUpdate(o,function(l){l&&s.itemsData.update(l)})}}}},{key:"_onDropObjectOnItem",value:function(n){var s=this.itemFromTarget(n),o=JSON.parse(n.dataTransfer.getData("text"));this.options.onDropObjectOnItem(o,s)}},{key:"_onAddItem",value:function(n){if(this.options.selectable&&this.options.editable.add){var s=this,o=this.options.snap||null,l=this.dom.frame.getBoundingClientRect(),c=this.options.rtl?l.right-n.center.x:n.center.x-l.left,u=this.body.util.toTime(c),d=this.body.util.getScale(),h=this.body.util.getStep(),f,m;n.type=="drop"?(m=JSON.parse(n.dataTransfer.getData("text")),m.content=m.content?m.content:"new item",m.start=m.start?m.start:o?o(u,d,h):u,m.type=m.type||"box",m[this.itemsData.idProp]=m.id||gu(),m.type=="range"&&!m.end&&(f=this.body.util.toTime(c+this.props.width/5),m.end=o?o(f,d,h):f)):(m={start:o?o(u,d,h):u,content:"new item"},m[this.itemsData.idProp]=gu(),this.options.type==="range"&&(f=this.body.util.toTime(c+this.props.width/5),m.end=o?o(f,d,h):f));var g=this.groupFromTarget(n);g&&(m.group=g.groupId),m=this._cloneItemData(m),this.options.onAdd(m,function(y){y&&(s.itemsData.add(y),n.type=="drop"&&s.setSelection([y.id]))})}}},{key:"_onMultiSelectItem",value:function(n){var s=this;if(this.options.selectable){var o=this.itemFromTarget(n);if(o){var l=this.options.multiselect?this.getSelection():[],c=n.srcEvent&&n.srcEvent.shiftKey||!1;if((c||this.options.sequentialSelection)&&this.options.multiselect){var u=this.itemsData.get(o.id).group,d=void 0;this.options.multiselectPerGroup&&l.length>0&&(d=this.itemsData.get(l[0]).group),(!this.options.multiselectPerGroup||d==null||d==u)&&l.push(o.id);var h=e._getItemRange(this.itemsData.get(l));if(!this.options.multiselectPerGroup||d==u){l=[];for(var f in this.items)if(this.items.hasOwnProperty(f)){var m=this.items[f],g=m.data.start,y=m.data.end!==void 0?m.data.end:g;g>=h.min&&y<=h.max&&(!this.options.multiselectPerGroup||d==this.itemsData.get(m.id).group)&&!(m instanceof ic)&&l.push(m.id)}}}else{var v=Er(l).call(l,o.id);v==-1?l.push(o.id):Bn(l).call(l,v,1)}var E=lt(l).call(l,function(C){return s.getItemById(C).selectable});this.setSelection(E),this.body.emitter.emit("select",{items:this.getSelection(),event:n})}}}},{key:"itemFromElement",value:function(n){for(var s=n;s;){if(s.hasOwnProperty("vis-item"))return s["vis-item"];s=s.parentNode}return null}},{key:"itemFromTarget",value:function(n){return this.itemFromElement(n.target)}},{key:"itemFromRelatedTarget",value:function(n){return this.itemFromElement(n.relatedTarget)}},{key:"groupFromTarget",value:function(n){var s=n.center?n.center.y:n.clientY,o=this.groupIds;o.length<=0&&this.groupsData&&(o=this.groupsData.getIds({order:this.options.groupOrder}));for(var l=0;l<o.length;l++){var c=o[l],u=this.groups[c],d=u.dom.foreground,h=d.getBoundingClientRect();if(s>=h.top&&s<h.top+d.offsetHeight)return u;if(this.options.orientation.item==="top"){if(l===this.groupIds.length-1&&s>h.top)return u}else if(l===0&&s<h.top+d.offset)return u}return null}},{key:"_cloneItemData",value:function(n,s){var o=ae.extend({},n);return s||(s=this.itemsData.type),o.start!=null&&(o.start=ae.convert(o.start,s&&s.start||"Date")),o.end!=null&&(o.end=ae.convert(o.end,s&&s.end||"Date")),o}},{key:"_clusterItems",value:function(){if(this.options.cluster){var n=this.body.range.conversion(this.body.domProps.center.width),s=n.scale,o=this.clusterGenerator.getClusters(this.clusters,s,this.options.cluster);if(this.clusters!=o){if(this._detachAllClusters(),o){var l=lu(o),c;try{for(l.s();!(c=l.n()).done;){var u=c.value;u.attach()}}catch(d){l.e(d)}finally{l.f()}this.clusters=o}this._updateClusters(o)}}}},{key:"_detachAllClusters",value:function(){if(this.options.cluster&&this.clusters&&this.clusters.length){var n=lu(this.clusters),s;try{for(n.s();!(s=n.n()).done;){var o=s.value;o.detach()}}catch(l){n.e(l)}finally{n.f()}}}},{key:"_updateClusters",value:function(n){if(this.clusters&&this.clusters.length){var s,o=new Zl(sr(n).call(n,function(v){return v.id})),l=lt(s=this.clusters).call(s,function(v){return!o.has(v.id)}),c=!1,u=lu(l),d;try{for(u.s();!(d=u.n()).done;){var h,f=d.value,m=Er(h=this.selection).call(h,f.id);if(m!==-1){var g;f.unselect(),Bn(g=this.selection).call(g,m,1),c=!0}}}catch(v){u.e(v)}finally{u.f()}if(c){var y=this.getSelection();this.body.emitter.emit("select",{items:y,event})}}this.clusters=n||[]}}],[{key:"_getItemRange",value:function(n){var s=null,o=null;return Ue(n).call(n,function(l){(o==null||l.start<o)&&(o=l.start),l.end!=null?(s==null||l.end>s)&&(s=l.end):(s==null||l.start>s)&&(s=l.start)}),{min:o,max:s}}},{key:"itemSetFromTarget",value:function(n){for(var s=n.target;s;){if(s.hasOwnProperty("vis-itemset"))return s["vis-itemset"];s=s.parentNode}return null}}]),e})(Zo);lg.types={background:ic,box:mz,range:Jl,point:gz};lg.prototype._onAdd=lg.prototype._onUpdate;Fm=!1,Zb="background: #FFeeee; color: #dd0000",yz=(function(){function a(){Gt(this,a)}return Vt(a,null,[{key:"validate",value:function(e,r,n){Fm=!1,f2=r;var s=r;return n!==void 0&&(s=r[n]),a.parse(e,s,[]),Fm}},{key:"parse",value:function(e,r,n){for(var s in e)e.hasOwnProperty(s)&&a.check(s,e,r,n)}},{key:"check",value:function(e,r,n,s){if(n[e]===void 0&&n.__any__===void 0){a.getSuggestion(e,n,s);return}var o=e,l=!0;n[e]===void 0&&n.__any__!==void 0&&(o="__any__",l=a.getType(r[e])==="object");var c=n[o];l&&c.__type__!==void 0&&(c=c.__type__),a.checkFields(e,r,n,o,c,s)}},{key:"checkFields",value:function(e,r,n,s,o,l){var c=function(f){console.log("%c"+f+a.printLocation(l,e),Zb)},u=a.getType(r[e]),d=o[u];d!==void 0?a.getType(d)==="array"&&Er(d).call(d,r[e])===-1?(c('Invalid option detected in "'+e+'". Allowed values are:'+a.print(d)+' not "'+r[e]+'". '),Fm=!0):u==="object"&&s!=="__any__"&&(l=ae.copyAndExtendArray(l,e),a.parse(r[e],n[s],l)):o.any===void 0&&(c('Invalid type received for "'+e+'". Expected: '+a.print(bi(o))+". Received ["+u+'] "'+r[e]+'"'),Fm=!0)}},{key:"getType",value:function(e){var r=yt(e);return r==="object"?e===null?"null":e instanceof Boolean?"boolean":e instanceof Number?"number":e instanceof String?"string":Tt(e)?"array":e instanceof Date?"date":e.nodeType!==void 0?"dom":e._isAMomentObject===!0?"moment":"object":r==="number"?"number":r==="boolean"?"boolean":r==="string"?"string":r===void 0?"undefined":r}},{key:"getSuggestion",value:function(e,r,n){var s=a.findInOptions(e,r,n,!1),o=a.findInOptions(e,f2,[],!0),l=8,c=4,u;s.indexMatch!==void 0?u=" in "+a.printLocation(s.path,e,"")+'Perhaps it was incomplete? Did you mean: "'+s.indexMatch+`"?

`:o.distance<=c&&s.distance>o.distance?u=" in "+a.printLocation(s.path,e,"")+"Perhaps it was misplaced? Matching option found at: "+a.printLocation(o.path,o.closestMatch,""):s.distance<=l?u='. Did you mean "'+s.closestMatch+'"?'+a.printLocation(s.path,e):u=". Did you mean one of these: "+a.print(bi(r))+a.printLocation(n,e),console.log('%cUnknown option detected: "'+e+'"'+u,Zb),Fm=!0}},{key:"findInOptions",value:function(e,r,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=1e9,l="",c=[],u=e.toLowerCase(),d=void 0;for(var h in r){var f=void 0;if(r[h].__type__!==void 0&&s===!0){var m=a.findInOptions(e,r[h],ae.copyAndExtendArray(n,h));o>m.distance&&(l=m.closestMatch,c=m.path,o=m.distance,d=m.indexMatch)}else{var g;Er(g=h.toLowerCase()).call(g,u)!==-1&&(d=h),f=a.levenshteinDistance(e,h),o>f&&(l=h,c=ae.copyArray(n),o=f)}}return{closestMatch:l,path:c,distance:o,indexMatch:d}}},{key:"printLocation",value:function(e,r){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:`Problem value found at: 
`,s=`

`+n+`options = {
`,o=0;o<e.length;o++){for(var l=0;l<o+1;l++)s+="  ";s+=e[o]+`: {
`}for(var c=0;c<e.length+1;c++)s+="  ";s+=r+`
`;for(var u=0;u<e.length+1;u++){for(var d=0;d<e.length-u;d++)s+="  ";s+=`}
`}return s+`

`}},{key:"print",value:function(e){return na(e).replace(/(\")|(\[)|(\])|(,"__type__")/g,"").replace(/(\,)/g,", ")}},{key:"levenshteinDistance",value:function(e,r){if(e.length===0)return r.length;if(r.length===0)return e.length;var n=[],s;for(s=0;s<=r.length;s++)n[s]=[s];var o;for(o=0;o<=e.length;o++)n[0][o]=o;for(s=1;s<=r.length;s++)for(o=1;o<=e.length;o++)r.charAt(s-1)==e.charAt(o-1)?n[s][o]=n[s-1][o-1]:n[s][o]=Math.min(n[s-1][o-1]+1,Math.min(n[s][o-1]+1,n[s-1][o]+1));return n[r.length][e.length]}}]),a})(),Lt="string",kt="boolean",Mr="number",p2="array",gh="date",li="object",Ige="dom",vh="moment",m2="any",Age={configure:{enabled:{boolean:kt},filter:{boolean:kt,function:"function"},container:{dom:Ige},__type__:{object:li,boolean:kt,function:"function"}},align:{string:Lt},alignCurrentTime:{string:Lt,undefined:"undefined"},rtl:{boolean:kt,undefined:"undefined"},rollingMode:{follow:{boolean:kt},offset:{number:Mr,undefined:"undefined"},__type__:{object:li}},onTimeout:{timeoutMs:{number:Mr},callback:{function:"function"},__type__:{object:li}},verticalScroll:{boolean:kt,undefined:"undefined"},horizontalScroll:{boolean:kt,undefined:"undefined"},autoResize:{boolean:kt},throttleRedraw:{number:Mr},clickToUse:{boolean:kt},dataAttributes:{string:Lt,array:p2},editable:{add:{boolean:kt,undefined:"undefined"},remove:{boolean:kt,undefined:"undefined"},updateGroup:{boolean:kt,undefined:"undefined"},updateTime:{boolean:kt,undefined:"undefined"},overrideItems:{boolean:kt,undefined:"undefined"},__type__:{boolean:kt,object:li}},end:{number:Mr,date:gh,string:Lt,moment:vh},format:{minorLabels:{millisecond:{string:Lt,undefined:"undefined"},second:{string:Lt,undefined:"undefined"},minute:{string:Lt,undefined:"undefined"},hour:{string:Lt,undefined:"undefined"},weekday:{string:Lt,undefined:"undefined"},day:{string:Lt,undefined:"undefined"},week:{string:Lt,undefined:"undefined"},month:{string:Lt,undefined:"undefined"},year:{string:Lt,undefined:"undefined"},__type__:{object:li,function:"function"}},majorLabels:{millisecond:{string:Lt,undefined:"undefined"},second:{string:Lt,undefined:"undefined"},minute:{string:Lt,undefined:"undefined"},hour:{string:Lt,undefined:"undefined"},weekday:{string:Lt,undefined:"undefined"},day:{string:Lt,undefined:"undefined"},week:{string:Lt,undefined:"undefined"},month:{string:Lt,undefined:"undefined"},year:{string:Lt,undefined:"undefined"},__type__:{object:li,function:"function"}},__type__:{object:li}},moment:{function:"function"},groupHeightMode:{string:Lt},groupOrder:{string:Lt,function:"function"},groupEditable:{add:{boolean:kt,undefined:"undefined"},remove:{boolean:kt,undefined:"undefined"},order:{boolean:kt,undefined:"undefined"},__type__:{boolean:kt,object:li}},groupOrderSwap:{function:"function"},height:{string:Lt,number:Mr},hiddenDates:{start:{date:gh,number:Mr,string:Lt,moment:vh},end:{date:gh,number:Mr,string:Lt,moment:vh},repeat:{string:Lt},__type__:{object:li,array:p2}},itemsAlwaysDraggable:{item:{boolean:kt,undefined:"undefined"},range:{boolean:kt,undefined:"undefined"},__type__:{boolean:kt,object:li}},limitSize:{boolean:kt},locale:{string:Lt},locales:{__any__:{any:m2},__type__:{object:li}},longSelectPressTime:{number:Mr},margin:{axis:{number:Mr},item:{horizontal:{number:Mr,undefined:"undefined"},vertical:{number:Mr,undefined:"undefined"},__type__:{object:li,number:Mr}},__type__:{object:li,number:Mr}},max:{date:gh,number:Mr,string:Lt,moment:vh},maxHeight:{number:Mr,string:Lt},maxMinorChars:{number:Mr},min:{date:gh,number:Mr,string:Lt,moment:vh},minHeight:{number:Mr,string:Lt},moveable:{boolean:kt},multiselect:{boolean:kt},multiselectPerGroup:{boolean:kt},onAdd:{function:"function"},onDropObjectOnItem:{function:"function"},onUpdate:{function:"function"},onMove:{function:"function"},onMoving:{function:"function"},onRemove:{function:"function"},onAddGroup:{function:"function"},onMoveGroup:{function:"function"},onRemoveGroup:{function:"function"},onInitialDrawComplete:{function:"function"},order:{function:"function"},orientation:{axis:{string:Lt,undefined:"undefined"},item:{string:Lt,undefined:"undefined"},__type__:{string:Lt,object:li}},selectable:{boolean:kt},sequentialSelection:{boolean:kt},showCurrentTime:{boolean:kt},showMajorLabels:{boolean:kt},showMinorLabels:{boolean:kt},showWeekScale:{boolean:kt},stack:{boolean:kt},stackSubgroups:{boolean:kt},cluster:{maxItems:{number:Mr,undefined:"undefined"},titleTemplate:{string:Lt,undefined:"undefined"},clusterCriteria:{function:"function",undefined:"undefined"},showStipes:{boolean:kt,undefined:"undefined"},fitOnDoubleClick:{boolean:kt,undefined:"undefined"},__type__:{boolean:kt,object:li}},snap:{function:"function",null:"null"},start:{date:gh,number:Mr,string:Lt,moment:vh},template:{function:"function"},loadingScreenTemplate:{function:"function"},groupTemplate:{function:"function"},visibleFrameTemplate:{string:Lt,function:"function"},showTooltips:{boolean:kt},tooltip:{followMouse:{boolean:kt},overflowMethod:{string:["cap","flip","none"]},delay:{number:Mr},template:{function:"function"},__type__:{object:li}},tooltipOnItemUpdateTime:{template:{function:"function"},__type__:{boolean:kt,object:li}},timeAxis:{scale:{string:Lt,undefined:"undefined"},step:{number:Mr,undefined:"undefined"},__type__:{object:li}},type:{string:Lt},width:{string:Lt,number:Mr},preferZoom:{boolean:kt},zoomable:{boolean:kt},zoomKey:{string:["ctrlKey","altKey","shiftKey","metaKey",""]},zoomFriction:{number:Mr},zoomMax:{number:Mr},zoomMin:{number:Mr},xss:{disabled:{boolean:kt},filterOptions:{__any__:{any:m2},__type__:{object:li}},__type__:{object:li}},__type__:{object:li}},Oge={global:{align:["center","left","right"],alignCurrentTime:["none","year","month","quarter","week","isoWeek","day","date","hour","minute","second"],direction:!1,autoResize:!0,clickToUse:!1,editable:{add:!1,remove:!1,updateGroup:!1,updateTime:!1},end:"",format:{minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",week:"w",month:"MMM",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",week:"MMMM YYYY",month:"YYYY",year:""}},groupHeightMode:["auto","fixed","fitItems"],groupsDraggable:!1,height:"",locale:"",longSelectPressTime:251,margin:{axis:[20,0,100,1],item:{horizontal:[10,0,100,1],vertical:[10,0,100,1]}},max:"",maxHeight:"",maxMinorChars:[7,0,20,1],min:"",minHeight:"",moveable:!1,multiselect:!1,multiselectPerGroup:!1,orientation:{axis:["both","bottom","top"],item:["bottom","top"]},preferZoom:!1,selectable:!0,showCurrentTime:!1,showMajorLabels:!0,showMinorLabels:!0,stack:!0,stackSubgroups:!0,cluster:!1,start:"",showTooltips:!0,tooltip:{followMouse:!1,overflowMethod:"flip",delay:[500,0,99999,100]},tooltipOnItemUpdateTime:!1,type:["box","point","range","background"],width:"100%",zoomable:!0,zoomKey:["ctrlKey","altKey","shiftKey","metaKey",""],zoomMax:[31536e10,10,31536e10,1],zoomMin:[10,10,31536e10,1],xss:{disabled:!1}}},Fge={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},Rge=(function(){function a(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;Gt(this,a),this.pixelRatio=t,this.generated=!1,this.centerCoordinates={x:289/2,y:289/2},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return Vt(a,[{key:"insertTo",value:function(e){this.hammer!==void 0&&(this.hammer.destroy(),this.hammer=void 0),this.container=e,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(e){if(typeof e=="function")this.updateCallback=e;else throw new Error("Function attempted to set as colorPicker update callback is not a function.")}},{key:"setCloseCallback",value:function(e){if(typeof e=="function")this.closeCallback=e;else throw new Error("Function attempted to set as colorPicker closing callback is not a function.")}},{key:"_isColorString",value:function(e){if(typeof e=="string")return Fge[e]}},{key:"setColor",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e!=="none"){var n,s=this._isColorString(e);if(s!==void 0&&(e=s),ae.isString(e)===!0){if(ae.isValidRGB(e)===!0){var o=e.substr(4).substr(0,e.length-5).split(",");n={r:o[0],g:o[1],b:o[2],a:1}}else if(ae.isValidRGBA(e)===!0){var l=e.substr(5).substr(0,e.length-6).split(",");n={r:l[0],g:l[1],b:l[2],a:l[3]}}else if(ae.isValidHex(e)===!0){var c=ae.hexToRGB(e);n={r:c.r,g:c.g,b:c.b,a:1}}}else if(e instanceof Object&&e.r!==void 0&&e.g!==void 0&&e.b!==void 0){var u=e.a!==void 0?e.a:"1.0";n={r:e.r,g:e.g,b:e.b,a:u}}if(n===void 0)throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+na(e));this._setColor(n,r)}}},{key:"show",value:function(){this.closeCallback!==void 0&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r===!0&&(this.previousColor=ae.extend({},this.color)),this.applied===!0&&this.updateCallback(this.initialColor),this.frame.style.display="none",wn(function(){e.closeCallback!==void 0&&(e.closeCallback(),e.closeCallback=void 0)},0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){this.previousColor!==void 0?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r===!0&&(this.initialColor=ae.extend({},e)),this.color=e;var n=ae.RGBToHSV(e.r,e.g,e.b),s=2*Math.PI,o=this.r*n.s,l=this.centerCoordinates.x+o*Math.sin(s*n.h),c=this.centerCoordinates.y+o*Math.cos(s*n.h);this.colorPickerSelector.style.left=l-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=c-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(e)}},{key:"_setOpacity",value:function(e){this.color.a=e/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(e){var r=ae.RGBToHSV(this.color.r,this.color.g,this.color.b);r.v=e/100;var n=ae.HSVToRGB(r.h,r.s,r.v);n.a=this.color.a,this.color=n,this._updatePicker()}},{key:"_updatePicker",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.color,r=ae.RGBToHSV(e.r,e.g,e.b),n=this.colorPickerCanvas.getContext("2d");this.pixelRation===void 0&&(this.pixelRatio=(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1)),n.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var s=this.colorPickerCanvas.clientWidth,o=this.colorPickerCanvas.clientHeight;n.clearRect(0,0,s,o),n.putImageData(this.hueCircle,0,0),n.fillStyle="rgba(0,0,0,"+(1-r.v)+")",n.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),RN(n).call(n),this.brightnessRange.value=100*r.v,this.opacityRange.value=100*e.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){var e,r,n,s;if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var l=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var o=document.createElement("DIV");o.style.color="red",o.style.fontWeight="bold",o.style.padding="10px",o.innerHTML="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(o)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(u){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(u){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var c=this;this.opacityRange.onchange=function(){c._setOpacity(this.value)},this.opacityRange.oninput=function(){c._setOpacity(this.value)},this.brightnessRange.onchange=function(){c._setBrightness(this.value)},this.brightnessRange.oninput=function(){c._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerHTML="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerHTML="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerHTML="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerHTML="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerHTML="cancel",this.cancelButton.onclick=Oe(e=this._hide).call(e,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerHTML="apply",this.applyButton.onclick=Oe(r=this._apply).call(r,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerHTML="save",this.saveButton.onclick=Oe(n=this._save).call(n,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerHTML="load last",this.loadButton.onclick=Oe(s=this._loadLast).call(s,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var e=this;this.drag={},this.pinch={},this.hammer=new yn(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),K$(this.hammer,function(r){e._moveSelector(r)}),this.hammer.on("tap",function(r){e._moveSelector(r)}),this.hammer.on("panstart",function(r){e._moveSelector(r)}),this.hammer.on("panmove",function(r){e._moveSelector(r)}),this.hammer.on("panend",function(r){e._moveSelector(r)})}},{key:"_generateHueCircle",value:function(){if(this.generated===!1){var e=this.colorPickerCanvas.getContext("2d");this.pixelRation===void 0&&(this.pixelRatio=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)),e.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var r=this.colorPickerCanvas.clientWidth,n=this.colorPickerCanvas.clientHeight;e.clearRect(0,0,r,n);var s,o,l,c;this.centerCoordinates={x:r*.5,y:n*.5},this.r=.49*r;var u=2*Math.PI/360,d=1/360,h=1/this.r,f;for(l=0;l<360;l++)for(c=0;c<this.r;c++)s=this.centerCoordinates.x+c*Math.sin(u*l),o=this.centerCoordinates.y+c*Math.cos(u*l),f=ae.HSVToRGB(l*d,c*h,1),e.fillStyle="rgb("+f.r+","+f.g+","+f.b+")",e.fillRect(s-.5,o-.5,2,2);e.strokeStyle="rgba(0,0,0,1)",e.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),e.stroke(),this.hueCircle=e.getImageData(0,0,r,n)}this.generated=!0}},{key:"_moveSelector",value:function(e){var r=this.colorPickerDiv.getBoundingClientRect(),n=e.center.x-r.left,s=e.center.y-r.top,o=.5*this.colorPickerDiv.clientHeight,l=.5*this.colorPickerDiv.clientWidth,c=n-l,u=s-o,d=Math.atan2(c,u),h=.98*Math.min(Math.sqrt(c*c+u*u),l),f=Math.cos(d)*h+o,m=Math.sin(d)*h+l;this.colorPickerSelector.style.top=f-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=m-.5*this.colorPickerSelector.clientWidth+"px";var g=d/(2*Math.PI);g=g<0?g+1:g;var y=h/this.r,v=ae.RGBToHSV(this.color.r,this.color.g,this.color.b);v.h=g,v.s=y;var E=ae.HSVToRGB(v.h,v.s,v.v);E.a=this.color.a,this.color=E,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),a})(),Nge=`div.vis-configuration {
    position:relative;
    display:block;
    float:left;
    font-size:12px;
}

div.vis-configuration-wrapper {
    display:block;
    width:700px;
}

div.vis-configuration-wrapper::after {
  clear: both;
  content: "";
  display: block;
}

div.vis-configuration.vis-config-option-container{
    display:block;
    width:495px;
    background-color: #ffffff;
    border:2px solid #f7f8fa;
    border-radius:4px;
    margin-top:20px;
    left:10px;
    padding-left:5px;
}

div.vis-configuration.vis-config-button{
    display:block;
    width:495px;
    height:25px;
    vertical-align: middle;
    line-height:25px;
    background-color: #f7f8fa;
    border:2px solid #ceced0;
    border-radius:4px;
    margin-top:20px;
    left:10px;
    padding-left:5px;
    cursor: pointer;
    margin-bottom:30px;
}

div.vis-configuration.vis-config-button.hover{
    background-color: #4588e6;
    border:2px solid #214373;
    color:#ffffff;
}

div.vis-configuration.vis-config-item{
    display:block;
    float:left;
    width:495px;
    height:25px;
    vertical-align: middle;
    line-height:25px;
}


div.vis-configuration.vis-config-item.vis-config-s2{
    left:10px;
    background-color: #f7f8fa;
    padding-left:5px;
    border-radius:3px;
}
div.vis-configuration.vis-config-item.vis-config-s3{
    left:20px;
    background-color: #e4e9f0;
    padding-left:5px;
    border-radius:3px;
}
div.vis-configuration.vis-config-item.vis-config-s4{
    left:30px;
    background-color: #cfd8e6;
    padding-left:5px;
    border-radius:3px;
}

div.vis-configuration.vis-config-header{
    font-size:18px;
    font-weight: bold;
}

div.vis-configuration.vis-config-label{
    width:120px;
    height:25px;
    line-height: 25px;
}

div.vis-configuration.vis-config-label.vis-config-s3{
    width:110px;
}
div.vis-configuration.vis-config-label.vis-config-s4{
    width:100px;
}

div.vis-configuration.vis-config-colorBlock{
    top:1px;
    width:30px;
    height:19px;
    border:1px solid #444444;
    border-radius:2px;
    padding:0px;
    margin:0px;
    cursor:pointer;
}

input.vis-configuration.vis-config-checkbox {
    left:-5px;
}


input.vis-configuration.vis-config-rangeinput{
    position:relative;
    top:-5px;
    width:60px;
    /*height:13px;*/
    padding:1px;
    margin:0;
    pointer-events:none;
}

input.vis-configuration.vis-config-range{
    /*removes default webkit styles*/
    -webkit-appearance: none;

    /*fix for FF unable to apply focus style bug */
    border: 0px solid white;
    background-color:rgba(0,0,0,0);

    /*required for proper track sizing in FF*/
    width: 300px;
    height:20px;
}
input.vis-configuration.vis-config-range::-webkit-slider-runnable-track {
    width: 300px;
    height: 5px;
    background: #dedede; /* Old browsers */
    background: -moz-linear-gradient(top,  #dedede 0%, #c8c8c8 99%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#dedede), color-stop(99%,#c8c8c8)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #dedede 0%,#c8c8c8 99%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #dedede 0%, #c8c8c8 99%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #dedede 0%,#c8c8c8 99%); /* IE10+ */
    background: linear-gradient(to bottom,  #dedede 0%,#c8c8c8 99%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#dedede', endColorstr='#c8c8c8',GradientType=0 ); /* IE6-9 */

    border: 1px solid #999999;
    box-shadow: #aaaaaa 0px 0px 3px 0px;
    border-radius: 3px;
}
input.vis-configuration.vis-config-range::-webkit-slider-thumb {
    -webkit-appearance: none;
    border: 1px solid #14334b;
    height: 17px;
    width: 17px;
    border-radius: 50%;
    background: #3876c2; /* Old browsers */
    background: -moz-linear-gradient(top,  #3876c2 0%, #385380 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#3876c2), color-stop(100%,#385380)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #3876c2 0%,#385380 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #3876c2 0%,#385380 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #3876c2 0%,#385380 100%); /* IE10+ */
    background: linear-gradient(to bottom,  #3876c2 0%,#385380 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#3876c2', endColorstr='#385380',GradientType=0 ); /* IE6-9 */
    box-shadow: #111927 0px 0px 1px 0px;
    margin-top: -7px;
}
input.vis-configuration.vis-config-range:focus {
    outline: none;
}
input.vis-configuration.vis-config-range:focus::-webkit-slider-runnable-track {
    background: #9d9d9d; /* Old browsers */
    background: -moz-linear-gradient(top, #9d9d9d 0%, #c8c8c8 99%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#9d9d9d), color-stop(99%,#c8c8c8)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #9d9d9d 0%,#c8c8c8 99%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #9d9d9d 0%,#c8c8c8 99%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #9d9d9d 0%,#c8c8c8 99%); /* IE10+ */
    background: linear-gradient(to bottom,  #9d9d9d 0%,#c8c8c8 99%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#9d9d9d', endColorstr='#c8c8c8',GradientType=0 ); /* IE6-9 */
}

input.vis-configuration.vis-config-range::-moz-range-track {
    width: 300px;
    height: 10px;
    background: #dedede; /* Old browsers */
    background: -moz-linear-gradient(top,  #dedede 0%, #c8c8c8 99%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#dedede), color-stop(99%,#c8c8c8)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #dedede 0%,#c8c8c8 99%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top, #dedede 0%, #c8c8c8 99%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #dedede 0%,#c8c8c8 99%); /* IE10+ */
    background: linear-gradient(to bottom,  #dedede 0%,#c8c8c8 99%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#dedede', endColorstr='#c8c8c8',GradientType=0 ); /* IE6-9 */

    border: 1px solid #999999;
    box-shadow: #aaaaaa 0px 0px 3px 0px;
    border-radius: 3px;
}
input.vis-configuration.vis-config-range::-moz-range-thumb {
    border: none;
    height: 16px;
    width: 16px;

    border-radius: 50%;
    background:  #385380;
}

/*hide the outline behind the border*/
input.vis-configuration.vis-config-range:-moz-focusring{
    outline: 1px solid white;
    outline-offset: -1px;
}

input.vis-configuration.vis-config-range::-ms-track {
    width: 300px;
    height: 5px;

    /*remove bg colour from the track, we'll use ms-fill-lower and ms-fill-upper instead */
    background: transparent;

    /*leave room for the larger thumb to overflow with a transparent border */
    border-color: transparent;
    border-width: 6px 0;

    /*remove default tick marks*/
    color: transparent;
}
input.vis-configuration.vis-config-range::-ms-fill-lower {
    background: #777;
    border-radius: 10px;
}
input.vis-configuration.vis-config-range::-ms-fill-upper {
    background: #ddd;
    border-radius: 10px;
}
input.vis-configuration.vis-config-range::-ms-thumb {
    border: none;
    height: 16px;
    width: 16px;
    border-radius: 50%;
    background:  #385380;
}
input.vis-configuration.vis-config-range:focus::-ms-fill-lower {
    background: #888;
}
input.vis-configuration.vis-config-range:focus::-ms-fill-upper {
    background: #ccc;
}

.vis-configuration-popup {
    position: absolute;
    background: rgba(57, 76, 89, 0.85);
    border: 2px solid #f2faff;
    line-height:30px;
    height:30px;
    width:150px;
    text-align:center;
    color: #ffffff;
    font-size:14px;
    border-radius:4px;
    -webkit-transition: opacity 0.3s ease-in-out;
    -moz-transition: opacity 0.3s ease-in-out;
    transition: opacity 0.3s ease-in-out;
}
.vis-configuration-popup:after, .vis-configuration-popup:before {
    left: 100%;
    top: 50%;
    border: solid transparent;
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
}

.vis-configuration-popup:after {
    border-color: rgba(136, 183, 213, 0);
    border-left-color: rgba(57, 76, 89, 0.85);
    border-width: 8px;
    margin-top: -8px;
}
.vis-configuration-popup:before {
    border-color: rgba(194, 225, 245, 0);
    border-left-color: #f2faff;
    border-width: 12px;
    margin-top: -12px;
}`;Gn(Nge);bz=(function(){function a(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;Gt(this,a),this.parent=t,this.changedOptions=[],this.container=e,this.allowCreation=!1,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},ae.extend(this.options,this.defaultOptions),this.configureOptions=r,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new Rge(n),this.wrapper=void 0}return Vt(a,[{key:"setOptions",value:function(e){if(e!==void 0){this.popupHistory={},this._removePopup();var r=!0;if(typeof e=="string")this.options.filter=e;else if(Tt(e))this.options.filter=e.join();else if(yt(e)==="object"){if(e==null)throw new TypeError("options cannot be null");e.container!==void 0&&(this.options.container=e.container),lt(e)!==void 0&&(this.options.filter=lt(e)),e.showButton!==void 0&&(this.options.showButton=e.showButton),e.enabled!==void 0&&(r=e.enabled)}else typeof e=="boolean"?(this.options.filter=!0,r=e):typeof e=="function"&&(this.options.filter=e,r=!0);lt(this.options)===!1&&(r=!1),this.options.enabled=r}this._clean()}},{key:"setModuleOptions",value:function(e){this.moduleOptions=e,this.options.enabled===!0&&(this._clean(),this.options.container!==void 0&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var e=lt(this.options),r=0,n=!1;for(var s in this.configureOptions)this.configureOptions.hasOwnProperty(s)&&(this.allowCreation=!1,n=!1,typeof e=="function"?(n=e(s,[]),n=n||this._handleObject(this.configureOptions[s],[s],!0)):(e===!0||Er(e).call(e,s)!==-1)&&(n=!0),n!==!1&&(this.allowCreation=!0,r>0&&this._makeItem([]),this._makeHeader(s),this._handleObject(this.configureOptions[s],[s])),r++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var e=0;e<this.domElements.length;e++)this.wrapper.appendChild(this.domElements[e]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var e=0;e<this.domElements.length;e++)this.wrapper.removeChild(this.domElements[e]);this.wrapper!==void 0&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(e){for(var r=this.moduleOptions,n=0;n<e.length;n++)if(r[e[n]]!==void 0)r=r[e[n]];else{r=void 0;break}return r}},{key:"_makeItem",value:function(e){if(this.allowCreation===!0){var r=document.createElement("div");r.className="vis-configuration vis-config-item vis-config-s"+e.length;for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return Ue(s).call(s,function(l){r.appendChild(l)}),this.domElements.push(r),this.domElements.length}return 0}},{key:"_makeHeader",value:function(e){var r=document.createElement("div");r.className="vis-configuration vis-config-header",r.innerHTML=ae.xss(e),this._makeItem([],r)}},{key:"_makeLabel",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=document.createElement("div");return s.className="vis-configuration vis-config-label vis-config-s"+r.length,n===!0?s.innerHTML=ae.xss("<i><b>"+e+":</b></i>"):s.innerHTML=ae.xss(e+":"),s}},{key:"_makeDropdown",value:function(e,r,n){var s=document.createElement("select");s.className="vis-configuration vis-config-select";var o=0;r!==void 0&&Er(e).call(e,r)!==-1&&(o=Er(e).call(e,r));for(var l=0;l<e.length;l++){var c=document.createElement("option");c.value=e[l],l===o&&(c.selected="selected"),c.innerHTML=e[l],s.appendChild(c)}var u=this;s.onchange=function(){u._update(this.value,n)};var d=this._makeLabel(n[n.length-1],n);this._makeItem(n,d,s)}},{key:"_makeRange",value:function(e,r,n){var s=e[0],o=e[1],l=e[2],c=e[3],u=document.createElement("input");u.className="vis-configuration vis-config-range";try{u.type="range",u.min=o,u.max=l}catch(E){}u.step=c;var d="",h=0;if(r!==void 0){var f=1.2;r<0&&r*f<o?(u.min=Math.ceil(r*f),h=u.min,d="range increased"):r/f<o&&(u.min=Math.ceil(r/f),h=u.min,d="range increased"),r*f>l&&l!==1&&(u.max=Math.ceil(r*f),h=u.max,d="range increased"),u.value=r}else u.value=s;var m=document.createElement("input");m.className="vis-configuration vis-config-rangeinput",m.value=Number(u.value);var g=this;u.onchange=function(){m.value=this.value,g._update(Number(this.value),n)},u.oninput=function(){m.value=this.value};var y=this._makeLabel(n[n.length-1],n),v=this._makeItem(n,y,u,m);d!==""&&this.popupHistory[v]!==h&&(this.popupHistory[v]=h,this._setupPopup(d,v))}},{key:"_makeButton",value:function(){var e=this;if(this.options.showButton===!0){var r=document.createElement("div");r.className="vis-configuration vis-config-button",r.innerHTML="generate options",r.onclick=function(){e._printOptions()},r.onmouseover=function(){r.className="vis-configuration vis-config-button hover"},r.onmouseout=function(){r.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(r)}}},{key:"_setupPopup",value:function(e,r){var n=this;if(this.initialized===!0&&this.allowCreation===!0&&this.popupCounter<this.popupLimit){var s=document.createElement("div");s.id="vis-configuration-popup",s.className="vis-configuration-popup",s.innerHTML=ae.xss(e),s.onclick=function(){n._removePopup()},this.popupCounter+=1,this.popupDiv={html:s,index:r}}}},{key:"_removePopup",value:function(){this.popupDiv.html!==void 0&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var e=this;if(this.popupDiv.html!==void 0){var r=this.domElements[this.popupDiv.index],n=r.getBoundingClientRect();this.popupDiv.html.style.left=n.left+"px",this.popupDiv.html.style.top=n.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=wn(function(){e.popupDiv.html.style.opacity=0},1500),this.popupDiv.deleteTimeout=wn(function(){e._removePopup()},1800)}}},{key:"_makeCheckbox",value:function(e,r,n){var s=document.createElement("input");s.type="checkbox",s.className="vis-configuration vis-config-checkbox",s.checked=e,r!==void 0&&(s.checked=r,r!==e&&(yt(e)==="object"?r!==e.enabled&&this.changedOptions.push({path:n,value:r}):this.changedOptions.push({path:n,value:r})));var o=this;s.onchange=function(){o._update(this.checked,n)};var l=this._makeLabel(n[n.length-1],n);this._makeItem(n,l,s)}},{key:"_makeTextInput",value:function(e,r,n){var s=document.createElement("input");s.type="text",s.className="vis-configuration vis-config-text",s.value=r,r!==e&&this.changedOptions.push({path:n,value:r});var o=this;s.onchange=function(){o._update(this.value,n)};var l=this._makeLabel(n[n.length-1],n);this._makeItem(n,l,s)}},{key:"_makeColorField",value:function(e,r,n){var s=this,o=e[1],l=document.createElement("div");r=r===void 0?o:r,r!=="none"?(l.className="vis-configuration vis-config-colorBlock",l.style.backgroundColor=r):l.className="vis-configuration vis-config-colorBlock none",r=r===void 0?o:r,l.onclick=function(){s._showColorPicker(r,l,n)};var c=this._makeLabel(n[n.length-1],n);this._makeItem(n,c,l)}},{key:"_showColorPicker",value:function(e,r,n){var s=this;r.onclick=function(){},this.colorPicker.insertTo(r),this.colorPicker.show(),this.colorPicker.setColor(e),this.colorPicker.setUpdateCallback(function(o){var l="rgba("+o.r+","+o.g+","+o.b+","+o.a+")";r.style.backgroundColor=l,s._update(l,n)}),this.colorPicker.setCloseCallback(function(){r.onclick=function(){s._showColorPicker(e,r,n)}})}},{key:"_handleObject",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,o=lt(this.options),l=!1;for(var c in e)if(e.hasOwnProperty(c)){s=!0;var u=e[c],d=ae.copyAndExtendArray(r,c);if(typeof o=="function"&&(s=o(c,r),s===!1&&!Tt(u)&&typeof u!="string"&&typeof u!="boolean"&&u instanceof Object&&(this.allowCreation=!1,s=this._handleObject(u,d,!0),this.allowCreation=n===!1)),s!==!1){l=!0;var h=this._getValue(d);if(Tt(u))this._handleArray(u,h,d);else if(typeof u=="string")this._makeTextInput(u,h,d);else if(typeof u=="boolean")this._makeCheckbox(u,h,d);else if(u instanceof Object){var f=!0;if(Er(r).call(r,"physics")!==-1&&this.moduleOptions.physics.solver!==c&&(f=!1),f===!0)if(u.enabled!==void 0){var m=ae.copyAndExtendArray(d,"enabled"),g=this._getValue(m);if(g===!0){var y=this._makeLabel(c,d,!0);this._makeItem(d,y),l=this._handleObject(u,d)||l}else this._makeCheckbox(u,g,d)}else{var v=this._makeLabel(c,d,!0);this._makeItem(d,v),l=this._handleObject(u,d)||l}}else console.error("dont know how to handle",u,c,d)}}return l}},{key:"_handleArray",value:function(e,r,n){typeof e[0]=="string"&&e[0]==="color"?(this._makeColorField(e,r,n),e[1]!==r&&this.changedOptions.push({path:n,value:r})):typeof e[0]=="string"?(this._makeDropdown(e,r,n),e[0]!==r&&this.changedOptions.push({path:n,value:r})):typeof e[0]=="number"&&(this._makeRange(e,r,n),e[0]!==r&&this.changedOptions.push({path:n,value:Number(r)}))}},{key:"_update",value:function(e,r){var n=this._constructOptions(e,r);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",n),this.initialized=!0,this.parent.setOptions(n)}},{key:"_constructOptions",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=n;e=e==="true"?!0:e,e=e==="false"?!1:e;for(var o=0;o<r.length;o++)r[o]!=="global"&&(s[r[o]]===void 0&&(s[r[o]]={}),o!==r.length-1?s=s[r[o]]:s[r[o]]=e);return n}},{key:"_printOptions",value:function(){var e=this.getOptions();this.optionsContainer.innerHTML="<pre>var options = "+na(e,null,2)+"</pre>"}},{key:"getOptions",value:function(){for(var e={},r=0;r<this.changedOptions.length;r++)this._constructOptions(this.changedOptions[r].value,this.changedOptions[r].path,e);return e}}]),a})();zge=(function(a){Hn(e,a);var t=Bge(e);function e(r,n,s,o){var l,c,u,d,h,f,m,g;if(Gt(this,e),g=t.call(this),g.initTime=new Date,g.itemsDone=!1,!(wr(g)instanceof e))throw new SyntaxError("Constructor must be called with the new operator");if(!(Tt(s)||Uo(s))&&s instanceof Object){var y=o;o=s,s=y}o&&o.throttleRedraw&&console.warn('Timeline option "throttleRedraw" is DEPRICATED and no longer supported. It will be removed in the next MAJOR release.');var v=wr(g);if(g.defaultOptions={autoResize:!0,longSelectPressTime:251,orientation:{axis:"bottom",item:"bottom"},moment:bn},g.options=ae.deepExtend({},g.defaultOptions),o&&ae.setupXSSProtection(o.xss),g._create(r),!o||o&&typeof o.rtl=="undefined"){g.dom.root.style.visibility="hidden";for(var E,C=g.dom.root;!E&&C;)E=window.getComputedStyle(C,null).direction,C=C.parentElement;g.options.rtl=E&&E.toLowerCase()=="rtl"}else g.options.rtl=o.rtl;o&&(o.rollingMode&&(g.options.rollingMode=o.rollingMode),o.onInitialDrawComplete&&(g.options.onInitialDrawComplete=o.onInitialDrawComplete),o.onTimeout&&(g.options.onTimeout=o.onTimeout),o.loadingScreenTemplate&&(g.options.loadingScreenTemplate=o.loadingScreenTemplate));var _=document.createElement("div");if(g.options.loadingScreenTemplate){var x,P=Oe(x=g.options.loadingScreenTemplate).call(x,wr(g)),I=P(g.dom.loadingScreen);I instanceof Object&&!(I instanceof Element)?P(_):I instanceof Element?(_.innerHTML="",_.appendChild(I)):I!=null&&(_.innerHTML=ae.xss(I))}g.dom.loadingScreen.appendChild(_),g.components=[],g.body={dom:g.dom,domProps:g.props,emitter:{on:Oe(l=g.on).call(l,wr(g)),off:Oe(c=g.off).call(c,wr(g)),emit:Oe(u=g.emit).call(u,wr(g))},hiddenDates:[],util:{getScale:function(){return v.timeAxis.step.scale},getStep:function(){return v.timeAxis.step.step},toScreen:Oe(d=v._toScreen).call(d,v),toGlobalScreen:Oe(h=v._toGlobalScreen).call(h,v),toTime:Oe(f=v._toTime).call(f,v),toGlobalTime:Oe(m=v._toGlobalTime).call(m,v)}},g.range=new dk(g.body,g.options),g.components.push(g.range),g.body.range=g.range,g.timeAxis=new og(g.body,g.options),g.timeAxis2=null,g.components.push(g.timeAxis),g.currentTime=new gk(g.body,g.options),g.components.push(g.currentTime),g.itemSet=new lg(g.body,g.options),g.components.push(g.itemSet),g.itemsData=null,g.groupsData=null;function M(O,R){v.hasListeners(O)&&v.emit(O,v.getEventProperties(R))}return g.dom.root.onclick=function(O){M("click",O)},g.dom.root.ondblclick=function(O){M("doubleClick",O)},g.dom.root.oncontextmenu=function(O){M("contextmenu",O)},g.dom.root.onmouseover=function(O){M("mouseOver",O)},window.PointerEvent?(g.dom.root.onpointerdown=function(O){M("mouseDown",O)},g.dom.root.onpointermove=function(O){M("mouseMove",O)},g.dom.root.onpointerup=function(O){M("mouseUp",O)}):(g.dom.root.onmousemove=function(O){M("mouseMove",O)},g.dom.root.onmousedown=function(O){M("mouseDown",O)},g.dom.root.onmouseup=function(O){M("mouseUp",O)}),g.initialFitDone=!1,g.on("changed",function(){if(v.itemsData!=null){if(!v.initialFitDone&&!v.options.rollingMode)if(v.initialFitDone=!0,v.options.start!=null||v.options.end!=null){if(v.options.start==null||v.options.end==null)var O=v.getItemRange();var R=v.options.start!=null?v.options.start:O.min,F=v.options.end!=null?v.options.end:O.max;v.setWindow(R,F,{animation:!1})}else v.fit({animation:!1});!v.initialDrawDone&&(v.initialRangeChangeDone||!v.options.start&&!v.options.end||v.options.rollingMode)&&(v.initialDrawDone=!0,v.itemSet.initialDrawDone=!0,v.dom.root.style.visibility="visible",v.dom.loadingScreen.parentNode.removeChild(v.dom.loadingScreen),v.options.onInitialDrawComplete&&wn(function(){return v.options.onInitialDrawComplete()},0))}}),g.on("destroyTimeline",function(){v.destroy()}),o&&g.setOptions(o),g.body.emitter.on("fit",function(O){g._onFit(O),g.redraw()}),s&&g.setGroups(s),n&&g.setItems(n),g._redraw(),g}return Vt(e,[{key:"_createConfigurator",value:function(){return new bz(this,this.dom.container,Oge)}},{key:"redraw",value:function(){this.itemSet&&this.itemSet.markDirty({refreshItems:!0}),this._redraw()}},{key:"setOptions",value:function(n){var s=yz.validate(n,Age);if(s===!0&&console.log("%cErrors have been found in the supplied options object.",Zb),vu.prototype.setOptions.call(this,n),"type"in n&&n.type!==this.options.type){this.options.type=n.type;var o=this.itemsData;if(o){var l=this.getSelection();this.setItems(null),this.setItems(o.rawDS),this.setSelection(l)}}}},{key:"setItems",value:function(n){this.itemsDone=!1;var s;n?Uo(n)?s=Nh(n):s=Nh(new Su(n)):s=null,this.itemsData&&this.itemsData.dispose(),this.itemsData=s,this.itemSet&&this.itemSet.setItems(s!=null?s.rawDS:null)}},{key:"setGroups",value:function(n){var s,o=function(c){return c.visible!==!1};n?(Tt(n)&&(n=new Su(n)),s=new x$(n,{filter:o})):s=null,this.groupsData!=null&&typeof this.groupsData.setData=="function"&&this.groupsData.setData(null),this.groupsData=s,this.itemSet.setGroups(s)}},{key:"setData",value:function(n){n&&n.groups&&this.setGroups(n.groups),n&&n.items&&this.setItems(n.items)}},{key:"setSelection",value:function(n,s){this.itemSet&&this.itemSet.setSelection(n),s&&s.focus&&this.focus(n,s)}},{key:"getSelection",value:function(){return this.itemSet&&this.itemSet.getSelection()||[]}},{key:"focus",value:function(n,s){if(!(!this.itemsData||n==null)){var o=Tt(n)?n:[n],l=this.itemsData.get(o),c=null,u=null;if(Ue(l).call(l,function(P){var I=P.start.valueOf(),M="end"in P?P.end.valueOf():P.start.valueOf();(c===null||I<c)&&(c=I),(u===null||M>u)&&(u=M)}),c!==null&&u!==null){var d=this,h=this.itemSet.items[o[0]],f=this._getScrollTop()*-1,m=null,g=function(I,M,O){var R=g2(d,h);if(R!==!1&&(m||(m=R),!(m.itemTop==R.itemTop&&!m.shouldScroll))){m.itemTop!=R.itemTop&&R.shouldScroll&&(m=R,f=d._getScrollTop()*-1);var F=f,$=m.scrollOffset,k=O?$:F+($-F)*I;d._setScrollTop(-k),M||d._redraw()}},y=function(){var I=g2(d,h);I.shouldScroll&&I.itemTop!=m.itemTop&&(d._setScrollTop(-I.scrollOffset),d._redraw())},v=function(){y(),wn(y,100)},E=s&&s.zoom!==void 0?s.zoom:!0,C=(c+u)/2,_=E?(u-c)*1.1:Math.max(this.range.end-this.range.start,(u-c)*1.1),x=s&&s.animation!==void 0?s.animation:!0;x||(m={shouldScroll:!1,scrollOffset:-1,itemTop:-1}),this.range.setRange(C-_/2,C+_/2,{animation:x},v,g)}}}},{key:"fit",value:function(n,s){var o=n&&n.animation!==void 0?n.animation:!0,l;this.itemsData.length===1&&this.itemsData.get()[0].end===void 0?(l=this.getDataRange(),this.moveTo(l.min.valueOf(),{animation:o},s)):(l=this.getItemRange(),this.range.setRange(l.min,l.max,{animation:o},s))}},{key:"getItemRange",value:function(){var n=this,s=this.getDataRange(),o=s.min!==null?s.min.valueOf():null,l=s.max!==null?s.max.valueOf():null,c=null,u=null;if(o!=null&&l!=null){var d=l-o;d<=0&&(d=10);var h=d/this.props.center.width,f={},m=0;Ue(ae).call(ae,this.itemSet.items,function(x,P){if(x.groupShowing){var I=!0;f[P]=x.redraw(I),m=f[P].length}});var g=m>0;if(g)for(var y=function(P){Ue(ae).call(ae,f,function(I){I[P]()})},v=0;v<m;v++)y(v);if(Ue(ae).call(ae,this.itemSet.items,function(x){var P=nS(x),I=aS(x),M,O;n.options.rtl?(M=P-(x.getWidthRight()+10)*h,O=I+(x.getWidthLeft()+10)*h):(M=P-(x.getWidthLeft()+10)*h,O=I+(x.getWidthRight()+10)*h),M<o&&(o=M,c=x),O>l&&(l=O,u=x)}),c&&u){var E=c.getWidthLeft()+10,C=u.getWidthRight()+10,_=this.props.center.width-E-C;_>0&&(this.options.rtl?(o=nS(c)-C*d/_,l=aS(u)+E*d/_):(o=nS(c)-E*d/_,l=aS(u)+C*d/_))}}return{min:o!=null?new Date(o):null,max:l!=null?new Date(l):null}}},{key:"getDataRange",value:function(){var n=null,s=null;if(this.itemsData){var o;Ue(o=this.itemsData).call(o,function(l){var c=ae.convert(l.start,"Date").valueOf(),u=ae.convert(l.end!=null?l.end:l.start,"Date").valueOf();(n===null||c<n)&&(n=c),(s===null||u>s)&&(s=u)})}return{min:n!=null?new Date(n):null,max:s!=null?new Date(s):null}}},{key:"getEventProperties",value:function(n){var s=n.center?n.center.x:n.clientX,o=n.center?n.center.y:n.clientY,l=this.dom.centerContainer.getBoundingClientRect(),c=this.options.rtl?l.right-s:s-l.left,u=o-l.top,d=this.itemSet.itemFromTarget(n),h=this.itemSet.groupFromTarget(n),f=M0.customTimeFromTarget(n),m=this.itemSet.options.snap||null,g=this.body.util.getScale(),y=this.body.util.getStep(),v=this._toTime(c),E=m?m(v,g,y):v,C=ae.getTarget(n),_=null;return d!=null?_="item":f!=null?_="custom-time":ae.hasParent(C,this.timeAxis.dom.foreground)||this.timeAxis2&&ae.hasParent(C,this.timeAxis2.dom.foreground)?_="axis":ae.hasParent(C,this.itemSet.dom.labelSet)?_="group-label":ae.hasParent(C,this.currentTime.bar)?_="current-time":ae.hasParent(C,this.dom.center)&&(_="background"),{event:n,item:d?d.id:null,isCluster:d?!!d.isCluster:!1,items:d?d.items||[]:null,group:h?h.groupId:null,customTime:f?f.options.id:null,what:_,pageX:n.srcEvent?n.srcEvent.pageX:n.pageX,pageY:n.srcEvent?n.srcEvent.pageY:n.pageY,x:c,y:u,time:v,snappedTime:E}}},{key:"toggleRollingMode",value:function(){this.range.rolling?this.range.stopRolling():(this.options.rollingMode==null&&this.setOptions(this.options),this.range.startRolling())}},{key:"_redraw",value:function(){vu.prototype._redraw.call(this)}},{key:"_onFit",value:function(n){var s=n.start,o=n.end,l=n.animation;o?this.range.setRange(s,o,{animation:l}):this.moveTo(s.valueOf(),{animation:l})}}]),e})(vu);wz=(function(){function a(t,e,r,n,s,o){var l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;if(Gt(this,a),this.majorSteps=[1,2,5,10],this.minorSteps=[.25,.5,1,2],this.customLines=null,this.containerHeight=s,this.majorCharHeight=o,this._start=t,this._end=e,this.scale=1,this.minorStepIdx=-1,this.magnitudefactor=1,this.determineScale(),this.zeroAlign=l,this.autoScaleStart=r,this.autoScaleEnd=n,this.formattingFunction=c,r||n){var u=this,d=function(f){var m=f-f%(u.magnitudefactor*u.minorSteps[u.minorStepIdx]);return f%(u.magnitudefactor*u.minorSteps[u.minorStepIdx])>.5*(u.magnitudefactor*u.minorSteps[u.minorStepIdx])?m+u.magnitudefactor*u.minorSteps[u.minorStepIdx]:m};r&&(this._start-=this.magnitudefactor*2*this.minorSteps[this.minorStepIdx],this._start=d(this._start)),n&&(this._end+=this.magnitudefactor*this.minorSteps[this.minorStepIdx],this._end=d(this._end)),this.determineScale()}}return Vt(a,[{key:"setCharHeight",value:function(e){this.majorCharHeight=e}},{key:"setHeight",value:function(e){this.containerHeight=e}},{key:"determineScale",value:function(){var e=this._end-this._start;this.scale=this.containerHeight/e;var r=this.majorCharHeight/this.scale,n=e>0?Math.round(Math.log(e)/Math.LN10):0;this.minorStepIdx=-1,this.magnitudefactor=Math.pow(10,n);var s=0;n<0&&(s=n);for(var o=!1,l=s;Math.abs(l)<=Math.abs(n);l++){this.magnitudefactor=Math.pow(10,l);for(var c=0;c<this.minorSteps.length;c++){var u=this.magnitudefactor*this.minorSteps[c];if(u>=r){o=!0,this.minorStepIdx=c;break}}if(o===!0)break}}},{key:"is_major",value:function(e){return e%(this.magnitudefactor*this.majorSteps[this.minorStepIdx])===0}},{key:"getStep",value:function(){return this.magnitudefactor*this.minorSteps[this.minorStepIdx]}},{key:"getFirstMajor",value:function(){var e=this.magnitudefactor*this.majorSteps[this.minorStepIdx];return this.convertValue(this._start+(e-this._start%e)%e)}},{key:"formatValue",value:function(e){var r=e.toPrecision(5);return typeof this.formattingFunction=="function"&&(r=this.formattingFunction(e)),typeof r=="number"?"".concat(r):typeof r=="string"?r:e.toPrecision(5)}},{key:"getLines",value:function(){for(var e=[],r=this.getStep(),n=(r-this._start%r)%r,s=this._start+n;this._end-s>1e-5;s+=r)s!=this._start&&e.push({major:this.is_major(s),y:this.convertValue(s),val:this.formatValue(s)});return e}},{key:"followScale",value:function(e){var r=this.minorStepIdx,n=this._start,s=this._end,o=this,l=function(){o.magnitudefactor*=2},c=function(){o.magnitudefactor/=2};e.minorStepIdx<=1&&this.minorStepIdx<=1||e.minorStepIdx>1&&this.minorStepIdx>1||(e.minorStepIdx<this.minorStepIdx?(this.minorStepIdx=1,r==2||l(),l()):(this.minorStepIdx=2,r==1||c(),c()));for(var u=e.convertValue(0),d=e.getStep()*e.scale,h=!1,f=0;!h&&f++<5;){this.scale=d/(this.minorSteps[this.minorStepIdx]*this.magnitudefactor);var m=this.containerHeight/this.scale;this._start=n,this._end=this._start+m;var g=this._end*this.scale,y=this.magnitudefactor*this.majorSteps[this.minorStepIdx],v=this.getFirstMajor()-e.getFirstMajor();if(this.zeroAlign){var E=u-g;this._end+=E/this.scale,this._start=this._end-m}else this.autoScaleStart?(this._start-=v/this.scale,this._end=this._start+m):(this._start+=y-v/this.scale,this._end=this._start+m);if(!this.autoScaleEnd&&this._end>s+1e-5){c(),h=!1;continue}if(!this.autoScaleStart&&this._start<n-1e-5)if(this.zeroAlign&&n>=0)console.warn("Can't adhere to given 'min' range, due to zeroalign");else{c(),h=!1;continue}if(this.autoScaleStart&&this.autoScaleEnd&&m<s-n){l(),h=!1;continue}h=!0}}},{key:"convertValue",value:function(e){return this.containerHeight-(e-this._start)*this.scale}},{key:"screenToValue",value:function(e){return(this.containerHeight-e)/this.scale+this._start}}]),a})(),Hge=`
.vis-panel.vis-background.vis-horizontal .vis-grid.vis-horizontal {
  position: absolute;
  width: 100%;
  height: 0;
  border-bottom: 1px solid;
}

.vis-panel.vis-background.vis-horizontal .vis-grid.vis-minor {
  border-color: #e5e5e5;
}

.vis-panel.vis-background.vis-horizontal .vis-grid.vis-major {
  border-color: #bfbfbf;
}


.vis-data-axis .vis-y-axis.vis-major {
  width: 100%;
  position: absolute;
  color: #4d4d4d;
  white-space: nowrap;
}

.vis-data-axis .vis-y-axis.vis-major.vis-measure {
  padding: 0;
  margin: 0;
  border: 0;
  visibility: hidden;
  width: auto;
}


.vis-data-axis .vis-y-axis.vis-minor {
  position: absolute;
  width: 100%;
  color: #bebebe;
  white-space: nowrap;
}

.vis-data-axis .vis-y-axis.vis-minor.vis-measure {
  padding: 0;
  margin: 0;
  border: 0;
  visibility: hidden;
  width: auto;
}

.vis-data-axis .vis-y-axis.vis-title {
  position: absolute;
  color: #4d4d4d;
  white-space: nowrap;
  bottom: 20px;
  text-align: center;
}

.vis-data-axis .vis-y-axis.vis-title.vis-measure {
  padding: 0;
  margin: 0;
  visibility: hidden;
  width: auto;
}

.vis-data-axis .vis-y-axis.vis-title.vis-left {
  bottom: 0;
  -webkit-transform-origin: left top;
  -moz-transform-origin: left top;
  -ms-transform-origin: left top;
  -o-transform-origin: left top;
  transform-origin: left bottom;
  -webkit-transform: rotate(-90deg);
  -moz-transform: rotate(-90deg);
  -ms-transform: rotate(-90deg);
  -o-transform: rotate(-90deg);
  transform: rotate(-90deg);
}

.vis-data-axis .vis-y-axis.vis-title.vis-right {
  bottom: 0;
  -webkit-transform-origin: right bottom;
  -moz-transform-origin: right bottom;
  -ms-transform-origin: right bottom;
  -o-transform-origin: right bottom;
  transform-origin: right bottom;
  -webkit-transform: rotate(90deg);
  -moz-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  -o-transform: rotate(90deg);
  transform: rotate(90deg);
}

.vis-legend {
  background-color: rgba(247, 252, 255, 0.65);
  padding: 5px;
  border: 1px solid #b3b3b3;
  box-shadow: 2px 2px 10px rgba(154, 154, 154, 0.55);
}

.vis-legend-text {
  /*font-size: 10px;*/
  white-space: nowrap;
  display: inline-block
}`;Gn(Hge);ex=(function(a){Hn(e,a);var t=Wge(e);function e(r,n,s,o){var l;Gt(this,e),l=t.call(this),l.id=gu(),l.body=r,l.defaultOptions={orientation:"left",showMinorLabels:!0,showMajorLabels:!0,showWeekScale:!1,icons:!1,majorLinesOffset:7,minorLinesOffset:4,labelOffsetX:10,labelOffsetY:2,iconWidth:20,width:"40px",visible:!0,alignZeros:!0,left:{range:{min:void 0,max:void 0},format:function(d){return"".concat(Yb(d.toPrecision(3)))},title:{text:void 0,style:void 0}},right:{range:{min:void 0,max:void 0},format:function(d){return"".concat(Yb(d.toPrecision(3)))},title:{text:void 0,style:void 0}}},l.linegraphOptions=o,l.linegraphSVG=s,l.props={},l.DOMelements={lines:{},labels:{},title:{}},l.dom={},l.scale=void 0,l.range={start:0,end:0},l.options=ae.extend({},l.defaultOptions),l.conversionFactor=1,l.setOptions(n),l.width=Number("".concat(l.options.width).replace("px","")),l.minWidth=l.width,l.height=l.linegraphSVG.getBoundingClientRect().height,l.hidden=!1,l.stepPixels=25,l.zeroCrossing=-1,l.amountOfSteps=-1,l.lineOffset=0,l.master=!0,l.masterAxis=null,l.svgElements={},l.iconsRemoved=!1,l.groups={},l.amountOfGroups=0,l._create(),l.scale==null&&l._redrawLabels(),l.framework={svg:l.svg,svgElements:l.svgElements,options:l.options,groups:l.groups};var c=wr(l);return l.body.emitter.on("verticalDrag",function(){c.dom.lineContainer.style.top="".concat(c.body.domProps.scrollTop,"px")}),l}return Vt(e,[{key:"addGroup",value:function(n,s){this.groups.hasOwnProperty(n)||(this.groups[n]=s),this.amountOfGroups+=1}},{key:"updateGroup",value:function(n,s){this.groups.hasOwnProperty(n)||(this.amountOfGroups+=1),this.groups[n]=s}},{key:"removeGroup",value:function(n){this.groups.hasOwnProperty(n)&&(delete this.groups[n],this.amountOfGroups-=1)}},{key:"setOptions",value:function(n){if(n){var s=!1;this.options.orientation!=n.orientation&&n.orientation!==void 0&&(s=!0);var o=["orientation","showMinorLabels","showMajorLabels","icons","majorLinesOffset","minorLinesOffset","labelOffsetX","labelOffsetY","iconWidth","width","visible","left","right","alignZeros"];ae.selectiveDeepExtend(o,this.options,n),this.minWidth=Number("".concat(this.options.width).replace("px","")),s===!0&&this.dom.frame&&(this.hide(),this.show())}}},{key:"_create",value:function(){this.dom.frame=document.createElement("div"),this.dom.frame.style.width=this.options.width,this.dom.frame.style.height=this.height,this.dom.lineContainer=document.createElement("div"),this.dom.lineContainer.style.width="100%",this.dom.lineContainer.style.height=this.height,this.dom.lineContainer.style.position="relative",this.dom.lineContainer.style.visibility="visible",this.dom.lineContainer.style.display="block",this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.style.position="absolute",this.svg.style.top="0px",this.svg.style.height="100%",this.svg.style.width="100%",this.svg.style.display="block",this.dom.frame.appendChild(this.svg)}},{key:"_redrawGroupIcons",value:function(){Fo(this.svgElements);var n,s=this.options.iconWidth,o=15,l=4,c=l+.5*o;this.options.orientation==="left"?n=l:n=this.width-s-l;var u=bi(this.groups);ci(u).call(u,function(m,g){return m<g?-1:1});var d=Gge(u),h;try{for(d.s();!(h=d.n()).done;){var f=h.value;this.groups[f].visible===!0&&(this.linegraphOptions.visibility[f]===void 0||this.linegraphOptions.visibility[f]===!0)&&(this.groups[f].getLegend(s,o,this.framework,n,c),c+=o+l)}}catch(m){d.e(m)}finally{d.f()}Da(this.svgElements),this.iconsRemoved=!1}},{key:"_cleanupIcons",value:function(){this.iconsRemoved===!1&&(Fo(this.svgElements),Da(this.svgElements),this.iconsRemoved=!0)}},{key:"show",value:function(){this.hidden=!1,this.dom.frame.parentNode||(this.options.orientation==="left"?this.body.dom.left.appendChild(this.dom.frame):this.body.dom.right.appendChild(this.dom.frame)),this.dom.lineContainer.parentNode||this.body.dom.backgroundHorizontal.appendChild(this.dom.lineContainer),this.dom.lineContainer.style.display="block"}},{key:"hide",value:function(){this.hidden=!0,this.dom.frame.parentNode&&this.dom.frame.parentNode.removeChild(this.dom.frame),this.dom.lineContainer.style.display="none"}},{key:"setRange",value:function(n,s){this.range.start=n,this.range.end=s}},{key:"redraw",value:function(){var n=!1,s=0;this.dom.lineContainer.style.top="".concat(this.body.domProps.scrollTop,"px");for(var o in this.groups)this.groups.hasOwnProperty(o)&&this.groups[o].visible===!0&&(this.linegraphOptions.visibility[o]===void 0||this.linegraphOptions.visibility[o]===!0)&&s++;if(this.amountOfGroups===0||s===0)this.hide();else{this.show(),this.height=Number(this.linegraphSVG.style.height.replace("px","")),this.dom.lineContainer.style.height="".concat(this.height,"px"),this.width=this.options.visible===!0?Number("".concat(this.options.width).replace("px","")):0;var l=this.props,c=this.dom.frame;c.className="vis-data-axis",this._calculateCharSize();var u=this.options.orientation,d=this.options.showMinorLabels,h=this.options.showMajorLabels,f=this.body.dom.backgroundHorizontal.offsetWidth;l.minorLabelHeight=d?l.minorCharHeight:0,l.majorLabelHeight=h?l.majorCharHeight:0,l.minorLineWidth=f-this.lineOffset-this.width+2*this.options.minorLinesOffset,l.minorLineHeight=1,l.majorLineWidth=f-this.lineOffset-this.width+2*this.options.majorLinesOffset,l.majorLineHeight=1,u==="left"?(c.style.top="0",c.style.left="0",c.style.bottom="",c.style.width="".concat(this.width,"px"),c.style.height="".concat(this.height,"px"),this.props.width=this.body.domProps.left.width,this.props.height=this.body.domProps.left.height):(c.style.top="",c.style.bottom="0",c.style.left="0",c.style.width="".concat(this.width,"px"),c.style.height="".concat(this.height,"px"),this.props.width=this.body.domProps.right.width,this.props.height=this.body.domProps.right.height),n=this._redrawLabels(),n=this._isResized()||n,this.options.icons===!0?this._redrawGroupIcons():this._cleanupIcons(),this._redrawTitle(u)}return n}},{key:"_redrawLabels",value:function(){var n=this,s=!1;Fo(this.DOMelements.lines),Fo(this.DOMelements.labels);var o=this.options.orientation,l=this.options[o].range!=null?this.options[o].range:{},c=!0;l.max!=null&&(this.range.end=l.max,c=!1);var u=!0;l.min!=null&&(this.range.start=l.min,u=!1),this.scale=new wz(this.range.start,this.range.end,u,c,this.dom.frame.offsetHeight,this.props.majorCharHeight,this.options.alignZeros,this.options[o].format),this.master===!1&&this.masterAxis!=null?(this.scale.followScale(this.masterAxis.scale),this.dom.lineContainer.style.display="none"):this.dom.lineContainer.style.display="block",this.maxLabelSize=0;var d=this.scale.getLines();Ue(d).call(d,function(m){var g=m.y,y=m.major;n.options.showMinorLabels&&y===!1&&n._redrawLabel(g-2,m.val,o,"vis-y-axis vis-minor",n.props.minorCharHeight),y&&g>=0&&n._redrawLabel(g-2,m.val,o,"vis-y-axis vis-major",n.props.majorCharHeight),n.master===!0&&(y?n._redrawLine(g,o,"vis-grid vis-horizontal vis-major",n.options.majorLinesOffset,n.props.majorLineWidth):n._redrawLine(g,o,"vis-grid vis-horizontal vis-minor",n.options.minorLinesOffset,n.props.minorLineWidth))});var h=0;this.options[o].title!==void 0&&this.options[o].title.text!==void 0&&(h=this.props.titleCharHeight);var f=this.options.icons===!0?Math.max(this.options.iconWidth,h)+this.options.labelOffsetX+15:h+this.options.labelOffsetX+15;return this.maxLabelSize>this.width-f&&this.options.visible===!0?(this.width=this.maxLabelSize+f,this.options.width="".concat(this.width,"px"),Da(this.DOMelements.lines),Da(this.DOMelements.labels),this.redraw(),s=!0):this.maxLabelSize<this.width-f&&this.options.visible===!0&&this.width>this.minWidth?(this.width=Math.max(this.minWidth,this.maxLabelSize+f),this.options.width="".concat(this.width,"px"),Da(this.DOMelements.lines),Da(this.DOMelements.labels),this.redraw(),s=!0):(Da(this.DOMelements.lines),Da(this.DOMelements.labels),s=!1),s}},{key:"convertValue",value:function(n){return this.scale.convertValue(n)}},{key:"screenToValue",value:function(n){return this.scale.screenToValue(n)}},{key:"_redrawLabel",value:function(n,s,o,l,c){var u=Sb("div",this.DOMelements.labels,this.dom.frame);u.className=l,u.innerHTML=ae.xss(s),o==="left"?(u.style.left="-".concat(this.options.labelOffsetX,"px"),u.style.textAlign="right"):(u.style.right="-".concat(this.options.labelOffsetX,"px"),u.style.textAlign="left"),u.style.top="".concat(n-.5*c+this.options.labelOffsetY,"px"),s+="";var d=Math.max(this.props.majorCharWidth,this.props.minorCharWidth);this.maxLabelSize<s.length*d&&(this.maxLabelSize=s.length*d)}},{key:"_redrawLine",value:function(n,s,o,l,c){if(this.master===!0){var u=Sb("div",this.DOMelements.lines,this.dom.lineContainer);u.className=o,u.innerHTML="",s==="left"?u.style.left="".concat(this.width-l,"px"):u.style.right="".concat(this.width-l,"px"),u.style.width="".concat(c,"px"),u.style.top="".concat(n,"px")}}},{key:"_redrawTitle",value:function(n){if(Fo(this.DOMelements.title),this.options[n].title!==void 0&&this.options[n].title.text!==void 0){var s=Sb("div",this.DOMelements.title,this.dom.frame);s.className="vis-y-axis vis-title vis-".concat(n),s.innerHTML=ae.xss(this.options[n].title.text),this.options[n].title.style!==void 0&&ae.addCssText(s,this.options[n].title.style),n==="left"?s.style.left="".concat(this.props.titleCharHeight,"px"):s.style.right="".concat(this.props.titleCharHeight,"px"),s.style.width="".concat(this.height,"px")}Da(this.DOMelements.title)}},{key:"_calculateCharSize",value:function(){if(!("minorCharHeight"in this.props)){var n=document.createTextNode("0"),s=document.createElement("div");s.className="vis-y-axis vis-minor vis-measure",s.appendChild(n),this.dom.frame.appendChild(s),this.props.minorCharHeight=s.clientHeight,this.props.minorCharWidth=s.clientWidth,this.dom.frame.removeChild(s)}if(!("majorCharHeight"in this.props)){var o=document.createTextNode("0"),l=document.createElement("div");l.className="vis-y-axis vis-major vis-measure",l.appendChild(o),this.dom.frame.appendChild(l),this.props.majorCharHeight=l.clientHeight,this.props.majorCharWidth=l.clientWidth,this.dom.frame.removeChild(l)}if(!("titleCharHeight"in this.props)){var c=document.createTextNode("0"),u=document.createElement("div");u.className="vis-y-axis vis-title vis-measure",u.appendChild(c),this.dom.frame.appendChild(u),this.props.titleCharHeight=u.clientHeight,this.props.titleCharWidth=u.clientWidth,this.dom.frame.removeChild(u)}}}]),e})(Zo);Lg.draw=function(a,t,e,r){r=r||0;for(var n=jge(e,t),s=0;s<a.length;s++)if(!n)Cu(a[s].screen_x+r,a[s].screen_y,tx(t),e.svgElements,e.svg,a[s].label);else{var o=n(a[s],t);(o===!0||yt(o)==="object")&&Cu(a[s].screen_x+r,a[s].screen_y,tx(t,o),e.svgElements,e.svg,a[s].label)}};Lg.drawIcon=function(a,t,e,r,n,s){var o=n*.5,l=ns("rect",s.svgElements,s.svg);l.setAttributeNS(null,"x",t),l.setAttributeNS(null,"y",e-o),l.setAttributeNS(null,"width",r),l.setAttributeNS(null,"height",2*o),l.setAttributeNS(null,"class","vis-outline"),Cu(t+.5*r,e,tx(a),s.svgElements,s.svg)};$n.drawIcon=function(a,t,e,r,n,s){var o=n*.5,l=ns("rect",s.svgElements,s.svg);l.setAttributeNS(null,"x",t),l.setAttributeNS(null,"y",e-o),l.setAttributeNS(null,"width",r),l.setAttributeNS(null,"height",2*o),l.setAttributeNS(null,"class","vis-outline");var c=Math.round(.3*r),u=a.options.barChart.width,d=u/c,h=Math.round(.4*n),f=Math.round(.75*n),m=Math.round((r-2*c)/3);if(zb(t+.5*c+m,e+o-h-1,c,h,a.className+" vis-bar",s.svgElements,s.svg,a.style),zb(t+1.5*c+m+2,e+o-f-1,c,f,a.className+" vis-bar",s.svgElements,s.svg,a.style),a.options.drawPoints.enabled==!0){var g={style:a.options.drawPoints.style,styles:a.options.drawPoints.styles,size:a.options.drawPoints.size/d,className:a.className};Cu(t+.5*c+m,e+o-h-1,g,s.svgElements,s.svg),Cu(t+1.5*c+m+2,e+o-f-1,g,s.svgElements,s.svg)}};$n.draw=function(a,t,e){var r=[],n={},s,o,l,c,u,d,h=0;for(u=0;u<a.length;u++)if(c=e.groups[a[u]],c.options.style==="bar"&&c.visible===!0&&(e.options.groups.visibility[a[u]]===void 0||e.options.groups.visibility[a[u]]===!0))for(d=0;d<t[a[u]].length;d++)r.push({screen_x:t[a[u]][d].screen_x,screen_end:t[a[u]][d].screen_end,screen_y:t[a[u]][d].screen_y,x:t[a[u]][d].x,end:t[a[u]][d].end,y:t[a[u]][d].y,groupId:a[u],label:t[a[u]][d].label}),h+=1;if(h!==0)for(ci(r).call(r,function(C,_){return C.screen_x===_.screen_x?C.groupId<_.groupId?-1:1:C.screen_x-_.screen_x}),$n._getDataIntersections(n,r),u=0;u<r.length;u++){c=e.groups[r[u].groupId];var f=c.options.barChart.minWidth!=null?c.options.barChart.minWidth:.1*c.options.barChart.width;o=r[u].screen_x;var m=0;if(n[o]===void 0)u+1<r.length&&(s=Math.abs(r[u+1].screen_x-o)),l=$n._getSafeDrawData(s,c,f);else{var g=u+(n[o].amount-n[o].resolved);g<r.length&&(s=Math.abs(r[g].screen_x-o)),l=$n._getSafeDrawData(s,c,f),n[o].resolved+=1,c.options.stack===!0&&c.options.excludeFromStacking!==!0?r[u].screen_y<c.zeroPosition?(m=n[o].accumulatedNegative,n[o].accumulatedNegative+=c.zeroPosition-r[u].screen_y):(m=n[o].accumulatedPositive,n[o].accumulatedPositive+=c.zeroPosition-r[u].screen_y):c.options.barChart.sideBySide===!0&&(l.width=l.width/n[o].amount,l.offset+=n[o].resolved*l.width-.5*l.width*(n[o].amount+1))}var y=l.width,v=r[u].screen_x;if(r[u].screen_end!=null?(y=r[u].screen_end-r[u].screen_x,v+=y*.5):v+=l.offset,zb(v,r[u].screen_y-m,y,c.zeroPosition-r[u].screen_y,c.className+" vis-bar",e.svgElements,e.svg,c.style),c.options.drawPoints.enabled===!0){var E={screen_x:r[u].screen_x,screen_y:r[u].screen_y-m,x:r[u].x,y:r[u].y,groupId:r[u].groupId,label:r[u].label};Lg.draw([E],c,e,l.offset)}}};$n._getDataIntersections=function(a,t){for(var e,r=0;r<t.length;r++)r+1<t.length&&(e=Math.abs(t[r+1].screen_x-t[r].screen_x)),r>0&&(e=Math.min(e,Math.abs(t[r-1].screen_x-t[r].screen_x))),e===0&&(a[t[r].screen_x]===void 0&&(a[t[r].screen_x]={amount:0,resolved:0,accumulatedPositive:0,accumulatedNegative:0}),a[t[r].screen_x].amount+=1)};$n._getSafeDrawData=function(a,t,e){var r,n;return a<t.options.barChart.width&&a>0?(r=a<e?e:a,n=0,t.options.barChart.align==="left"?n-=.5*a:t.options.barChart.align==="right"&&(n+=.5*a)):(r=t.options.barChart.width,n=0,t.options.barChart.align==="left"?n-=.5*t.options.barChart.width:t.options.barChart.align==="right"&&(n+=.5*t.options.barChart.width)),{width:r,offset:n}};$n.getStackedYRange=function(a,t,e,r,n){if(a.length>0){ci(a).call(a,function(o,l){return o.screen_x===l.screen_x?o.groupId<l.groupId?-1:1:o.screen_x-l.screen_x});var s={};$n._getDataIntersections(s,a),t[r]=$n._getStackedYRange(s,a),t[r].yAxisOrientation=n,e.push(r)}};$n._getStackedYRange=function(a,t){for(var e,r=t[0].screen_y,n=t[0].screen_y,s=0;s<t.length;s++)e=t[s].screen_x,a[e]===void 0?(r=r>t[s].screen_y?t[s].screen_y:r,n=n<t[s].screen_y?t[s].screen_y:n):t[s].screen_y<0?a[e].accumulatedNegative+=t[s].screen_y:a[e].accumulatedPositive+=t[s].screen_y;for(var o in a)a.hasOwnProperty(o)&&(r=r>a[o].accumulatedNegative?a[o].accumulatedNegative:r,r=r>a[o].accumulatedPositive?a[o].accumulatedPositive:r,n=n<a[o].accumulatedNegative?a[o].accumulatedNegative:n,n=n<a[o].accumulatedPositive?a[o].accumulatedPositive:n);return{min:r,max:n}};rn.calcPath=function(a,t){if(a!=null&&a.length>0){var e=[];return t.options.interpolation.enabled==!0?e=rn._catmullRom(a,t):e=rn._linear(a),e}};rn.drawIcon=function(a,t,e,r,n,s){var o=n*.5,l,c,u=ns("rect",s.svgElements,s.svg);if(u.setAttributeNS(null,"x",t),u.setAttributeNS(null,"y",e-o),u.setAttributeNS(null,"width",r),u.setAttributeNS(null,"height",2*o),u.setAttributeNS(null,"class","vis-outline"),l=ns("path",s.svgElements,s.svg),l.setAttributeNS(null,"class",a.className),a.style!==void 0&&l.setAttributeNS(null,"style",a.style),l.setAttributeNS(null,"d","M"+t+","+e+" L"+(t+r)+","+e),a.options.shaded.enabled==!0&&(c=ns("path",s.svgElements,s.svg),a.options.shaded.orientation=="top"?c.setAttributeNS(null,"d","M"+t+", "+(e-o)+"L"+t+","+e+" L"+(t+r)+","+e+" L"+(t+r)+","+(e-o)):c.setAttributeNS(null,"d","M"+t+","+e+" L"+t+","+(e+o)+" L"+(t+r)+","+(e+o)+"L"+(t+r)+","+e),c.setAttributeNS(null,"class",a.className+" vis-icon-fill"),a.options.shaded.style!==void 0&&a.options.shaded.style!==""&&c.setAttributeNS(null,"style",a.options.shaded.style)),a.options.drawPoints.enabled==!0){var d={style:a.options.drawPoints.style,styles:a.options.drawPoints.styles,size:a.options.drawPoints.size,className:a.className};Cu(t+.5*r,e,d,s.svgElements,s.svg)}};rn.drawShading=function(a,t,e,r){if(t.options.shaded.enabled==!0){var n=Number(r.svg.style.height.replace("px","")),s=ns("path",r.svgElements,r.svg),o="L";t.options.interpolation.enabled==!0&&(o="C");var l,c=0;t.options.shaded.orientation=="top"?c=0:t.options.shaded.orientation=="bottom"?c=n:c=Math.min(Math.max(0,t.zeroPosition),n),t.options.shaded.orientation=="group"&&e!=null&&e!=null?l="M"+a[0][0]+","+a[0][1]+" "+this.serializePath(a,o,!1)+" L"+e[e.length-1][0]+","+e[e.length-1][1]+" "+this.serializePath(e,o,!0)+e[0][0]+","+e[0][1]+" Z":l="M"+a[0][0]+","+a[0][1]+" "+this.serializePath(a,o,!1)+" V"+c+" H"+a[0][0]+" Z",s.setAttributeNS(null,"class",t.className+" vis-fill"),t.options.shaded.style!==void 0&&s.setAttributeNS(null,"style",t.options.shaded.style),s.setAttributeNS(null,"d",l)}};rn.draw=function(a,t,e){if(a!=null&&a!=null){var r=ns("path",e.svgElements,e.svg);r.setAttributeNS(null,"class",t.className),t.style!==void 0&&r.setAttributeNS(null,"style",t.style);var n="L";t.options.interpolation.enabled==!0&&(n="C"),r.setAttributeNS(null,"d","M"+a[0][0]+","+a[0][1]+" "+this.serializePath(a,n,!1))}};rn.serializePath=function(a,t,e){if(a.length<2)return"";var r=t,n;if(e)for(n=a.length-2;n>0;n--)r+=a[n][0]+","+a[n][1]+" ";else for(n=1;n<a.length;n++)r+=a[n][0]+","+a[n][1]+" ";return r};rn._catmullRomUniform=function(a){var t,e,r,n,s,o,l=[];l.push([Math.round(a[0].screen_x),Math.round(a[0].screen_y)]);for(var c=1/6,u=a.length,d=0;d<u-1;d++)t=d==0?a[0]:a[d-1],e=a[d],r=a[d+1],n=d+2<u?a[d+2]:r,s={screen_x:(-t.screen_x+6*e.screen_x+r.screen_x)*c,screen_y:(-t.screen_y+6*e.screen_y+r.screen_y)*c},o={screen_x:(e.screen_x+6*r.screen_x-n.screen_x)*c,screen_y:(e.screen_y+6*r.screen_y-n.screen_y)*c},l.push([s.screen_x,s.screen_y]),l.push([o.screen_x,o.screen_y]),l.push([r.screen_x,r.screen_y]);return l};rn._catmullRom=function(a,t){var e=t.options.interpolation.alpha;if(e==0||e===void 0)return this._catmullRomUniform(a);var r,n,s,o,l,c,u,d,h,f,m,g,y,v,E,C,_,x,P,I=[];I.push([Math.round(a[0].screen_x),Math.round(a[0].screen_y)]);for(var M=a.length,O=0;O<M-1;O++)r=O==0?a[0]:a[O-1],n=a[O],s=a[O+1],o=O+2<M?a[O+2]:s,u=Math.sqrt(Math.pow(r.screen_x-n.screen_x,2)+Math.pow(r.screen_y-n.screen_y,2)),d=Math.sqrt(Math.pow(n.screen_x-s.screen_x,2)+Math.pow(n.screen_y-s.screen_y,2)),h=Math.sqrt(Math.pow(s.screen_x-o.screen_x,2)+Math.pow(s.screen_y-o.screen_y,2)),v=Math.pow(h,e),C=Math.pow(h,2*e),E=Math.pow(d,e),_=Math.pow(d,2*e),P=Math.pow(u,e),x=Math.pow(u,2*e),f=2*x+3*P*E+_,m=2*C+3*v*E+_,g=3*P*(P+E),g>0&&(g=1/g),y=3*v*(v+E),y>0&&(y=1/y),l={screen_x:(-_*r.screen_x+f*n.screen_x+x*s.screen_x)*g,screen_y:(-_*r.screen_y+f*n.screen_y+x*s.screen_y)*g},c={screen_x:(C*n.screen_x+m*s.screen_x-_*o.screen_x)*y,screen_y:(C*n.screen_y+m*s.screen_y-_*o.screen_y)*y},l.screen_x==0&&l.screen_y==0&&(l=n),c.screen_x==0&&c.screen_y==0&&(c=s),I.push([l.screen_x,l.screen_y]),I.push([c.screen_x,c.screen_y]),I.push([s.screen_x,s.screen_y]);return I};rn._linear=function(a){for(var t=[],e=0;e<a.length;e++)t.push([a[e].screen_x,a[e].screen_y]);return t};Ko.prototype.setItems=function(a){a!=null?(this.itemsData=a,ci(this.options)==!0&&ae.insertSort(this.itemsData,function(t,e){return t.x>e.x?1:-1})):this.itemsData=[]};Ko.prototype.getItems=function(){return this.itemsData};Ko.prototype.setZeroPosition=function(a){this.zeroPosition=a};Ko.prototype.setOptions=function(a){if(a!==void 0){var t=["sampling","style","sort","yAxisOrientation","barChart","zIndex","excludeFromStacking","excludeFromLegend"];ae.selectiveDeepExtend(t,this.options,a),typeof a.drawPoints=="function"&&(a.drawPoints={onRender:a.drawPoints}),ae.mergeOptions(this.options,a,"interpolation"),ae.mergeOptions(this.options,a,"drawPoints"),ae.mergeOptions(this.options,a,"shaded"),a.interpolation&&yt(a.interpolation)=="object"&&a.interpolation.parametrization&&(a.interpolation.parametrization=="uniform"?this.options.interpolation.alpha=0:a.interpolation.parametrization=="chordal"?this.options.interpolation.alpha=1:(this.options.interpolation.parametrization="centripetal",this.options.interpolation.alpha=.5))}};Ko.prototype.update=function(a){this.group=a,this.content=a.content||"graph",this.className=a.className||this.className||"vis-graph-group"+this.groupsUsingDefaultStyles[0]%10,this.visible=a.visible===void 0?!0:a.visible,this.style=a.style,this.setOptions(a.options)};Ko.prototype.getLegend=function(a,t,e,r,n){if(e==null||e==null){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");e={svg:s,svgElements:{},options:this.options,groups:[this]}}switch((r==null||r==null)&&(r=0),(n==null||n==null)&&(n=.5*t),this.options.style){case"line":rn.drawIcon(this,r,n,a,t,e);break;case"points":case"point":Lg.drawIcon(this,r,n,a,t,e);break;case"bar":$n.drawIcon(this,r,n,a,t,e);break}return{icon:e.svg,label:this.content,orientation:this.options.yAxisOrientation}};Ko.prototype.getYRange=function(a){for(var t=a[0].y,e=a[0].y,r=0;r<a.length;r++)t=t>a[r].y?a[r].y:t,e=e<a[r].y?a[r].y:e;return{min:t,max:e,yAxisOrientation:this.options.yAxisOrientation}};sa.prototype=new Zo;sa.prototype.clear=function(){this.groups={},this.amountOfGroups=0};sa.prototype.addGroup=function(a,t){t.options.excludeFromLegend!=!0&&(this.groups.hasOwnProperty(a)||(this.groups[a]=t),this.amountOfGroups+=1)};sa.prototype.updateGroup=function(a,t){this.groups[a]=t};sa.prototype.removeGroup=function(a){this.groups.hasOwnProperty(a)&&(delete this.groups[a],this.amountOfGroups-=1)};sa.prototype._create=function(){this.dom.frame=document.createElement("div"),this.dom.frame.className="vis-legend",this.dom.frame.style.position="absolute",this.dom.frame.style.top="10px",this.dom.frame.style.display="block",this.dom.textArea=document.createElement("div"),this.dom.textArea.className="vis-legend-text",this.dom.textArea.style.position="relative",this.dom.textArea.style.top="0px",this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.style.position="absolute",this.svg.style.top="0px",this.svg.style.width=this.options.iconSize+5+"px",this.svg.style.height="100%",this.dom.frame.appendChild(this.svg),this.dom.frame.appendChild(this.dom.textArea)};sa.prototype.hide=function(){this.dom.frame.parentNode&&this.dom.frame.parentNode.removeChild(this.dom.frame)};sa.prototype.show=function(){this.dom.frame.parentNode||this.body.dom.center.appendChild(this.dom.frame)};sa.prototype.setOptions=function(a){var t=["enabled","orientation","icons","left","right"];ae.selectiveDeepExtend(t,this.options,a)};sa.prototype.redraw=function(){var a=0,t=bi(this.groups);ci(t).call(t,function(o,l){return o<l?-1:1});for(var e=0;e<t.length;e++){var r=t[e];this.groups[r].visible==!0&&(this.linegraphOptions.visibility[r]===void 0||this.linegraphOptions.visibility[r]==!0)&&a++}if(this.options[this.side].visible==!1||this.amountOfGroups==0||this.options.enabled==!1||a==0)this.hide();else{if(this.show(),this.options[this.side].position=="top-left"||this.options[this.side].position=="bottom-left"?(this.dom.frame.style.left="4px",this.dom.frame.style.textAlign="left",this.dom.textArea.style.textAlign="left",this.dom.textArea.style.left=this.options.iconSize+15+"px",this.dom.textArea.style.right="",this.svg.style.left="0px",this.svg.style.right=""):(this.dom.frame.style.right="4px",this.dom.frame.style.textAlign="right",this.dom.textArea.style.textAlign="right",this.dom.textArea.style.right=this.options.iconSize+15+"px",this.dom.textArea.style.left="",this.svg.style.right="0px",this.svg.style.left=""),this.options[this.side].position=="top-left"||this.options[this.side].position=="top-right")this.dom.frame.style.top=4-Number(this.body.dom.center.style.top.replace("px",""))+"px",this.dom.frame.style.bottom="";else{var n=this.body.domProps.center.height-this.body.domProps.centerContainer.height;this.dom.frame.style.bottom=4+n+Number(this.body.dom.center.style.top.replace("px",""))+"px",this.dom.frame.style.top=""}this.options.icons==!1?(this.dom.frame.style.width=this.dom.textArea.offsetWidth+10+"px",this.dom.textArea.style.right="",this.dom.textArea.style.left="",this.svg.style.width="0px"):(this.dom.frame.style.width=this.options.iconSize+15+this.dom.textArea.offsetWidth+10+"px",this.drawLegendIcons());var s="";for(e=0;e<t.length;e++)r=t[e],this.groups[r].visible==!0&&(this.linegraphOptions.visibility[r]===void 0||this.linegraphOptions.visibility[r]==!0)&&(s+=this.groups[r].content+"<br />");this.dom.textArea.innerHTML=ae.xss(s),this.dom.textArea.style.lineHeight=.75*this.options.iconSize+this.options.iconSpacing+"px"}};sa.prototype.drawLegendIcons=function(){if(this.dom.frame.parentNode){var a=bi(this.groups);ci(a).call(a,function(u,d){return u<d?-1:1}),vB(this.svgElements);var t=window.getComputedStyle(this.dom.frame).paddingTop,e=Number(t.replace("px","")),r=e,n=this.options.iconSize,s=.75*this.options.iconSize,o=e+.5*s+3;this.svg.style.width=n+5+e+"px";for(var l=0;l<a.length;l++){var c=a[l];this.groups[c].visible==!0&&(this.linegraphOptions.visibility[c]===void 0||this.linegraphOptions.visibility[c]==!0)&&(this.groups[c].getLegend(n,s,this.framework,r,o),o+=s+this.options.iconSpacing)}}};Kb="__ungrouped__";pr.prototype=new Zo;pr.prototype._create=function(){var a=document.createElement("div");a.className="vis-line-graph",this.dom.frame=a,this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.style.position="relative",this.svg.style.height=(""+this.options.graphHeight).replace("px","")+"px",this.svg.style.display="block",a.appendChild(this.svg),this.options.dataAxis.orientation="left",this.yAxisLeft=new ex(this.body,this.options.dataAxis,this.svg,this.options.groups),this.options.dataAxis.orientation="right",this.yAxisRight=new ex(this.body,this.options.dataAxis,this.svg,this.options.groups),delete this.options.dataAxis.orientation,this.legendLeft=new sa(this.body,this.options.legend,"left",this.options.groups),this.legendRight=new sa(this.body,this.options.legend,"right",this.options.groups),this.show()};pr.prototype.setOptions=function(a){if(a){var t=["sampling","defaultGroup","stack","height","graphHeight","yAxisOrientation","style","barChart","dataAxis","sort","groups"];a.graphHeight===void 0&&a.height!==void 0?(this.updateSVGheight=!0,this.updateSVGheightOnResize=!0):this.body.domProps.centerContainer.height!==void 0&&a.graphHeight!==void 0&&La((a.graphHeight+"").replace("px",""))<this.body.domProps.centerContainer.height&&(this.updateSVGheight=!0),ae.selectiveDeepExtend(t,this.options,a),ae.mergeOptions(this.options,a,"interpolation"),ae.mergeOptions(this.options,a,"drawPoints"),ae.mergeOptions(this.options,a,"shaded"),ae.mergeOptions(this.options,a,"legend"),a.interpolation&&yt(a.interpolation)=="object"&&a.interpolation.parametrization&&(a.interpolation.parametrization=="uniform"?this.options.interpolation.alpha=0:a.interpolation.parametrization=="chordal"?this.options.interpolation.alpha=1:(this.options.interpolation.parametrization="centripetal",this.options.interpolation.alpha=.5)),this.yAxisLeft&&a.dataAxis!==void 0&&(this.yAxisLeft.setOptions(this.options.dataAxis),this.yAxisRight.setOptions(this.options.dataAxis)),this.legendLeft&&a.legend!==void 0&&(this.legendLeft.setOptions(this.options.legend),this.legendRight.setOptions(this.options.legend)),this.groups.hasOwnProperty(Kb)&&this.groups[Kb].setOptions(a)}this.dom.frame&&(this.forceGraphUpdate=!0,this.body.emitter.emit("_change",{queue:!0}))};pr.prototype.hide=function(){this.dom.frame.parentNode&&this.dom.frame.parentNode.removeChild(this.dom.frame)};pr.prototype.show=function(){this.dom.frame.parentNode||this.body.dom.center.appendChild(this.dom.frame)};pr.prototype.setItems=function(a){var t=this,e,r=this.itemsData;if(!a)this.itemsData=null;else if(Uo(a))this.itemsData=Nh(a);else throw new TypeError("Data must implement the interface of DataSet or DataView");if(r&&(Ue(ae).call(ae,this.itemListeners,function(s,o){r.off(o,s)}),r.dispose(),e=r.getIds(),this._onRemove(e)),this.itemsData){var n=this.id;Ue(ae).call(ae,this.itemListeners,function(s,o){t.itemsData.on(o,s,n)}),e=this.itemsData.getIds(),this._onAdd(e)}};pr.prototype.setGroups=function(a){var t=this,e;if(this.groupsData){Ue(ae).call(ae,this.groupListeners,function(s,o){t.groupsData.off(o,s)}),e=this.groupsData.getIds(),this.groupsData=null;for(var r=0;r<e.length;r++)this._removeGroup(e[r])}if(!a)this.groupsData=null;else if(Uo(a))this.groupsData=a;else throw new TypeError("Data must implement the interface of DataSet or DataView");if(this.groupsData){var n=this.id;Ue(ae).call(ae,this.groupListeners,function(s,o){t.groupsData.on(o,s,n)}),e=this.groupsData.getIds(),this._onAddGroups(e)}};pr.prototype._onUpdate=function(a){this._updateAllGroupData(a)};pr.prototype._onAdd=function(a){this._onUpdate(a)};pr.prototype._onRemove=function(a){this._onUpdate(a)};pr.prototype._onUpdateGroups=function(a){this._updateAllGroupData(null,a)};pr.prototype._onAddGroups=function(a){this._onUpdateGroups(a)};pr.prototype._onRemoveGroups=function(a){for(var t=0;t<a.length;t++)this._removeGroup(a[t]);this.forceGraphUpdate=!0,this.body.emitter.emit("_change",{queue:!0})};pr.prototype._removeGroup=function(a){this.groups.hasOwnProperty(a)&&(this.groups[a].options.yAxisOrientation=="right"?(this.yAxisRight.removeGroup(a),this.legendRight.removeGroup(a),this.legendRight.redraw()):(this.yAxisLeft.removeGroup(a),this.legendLeft.removeGroup(a),this.legendLeft.redraw()),delete this.groups[a])};pr.prototype._updateGroup=function(a,t){this.groups.hasOwnProperty(t)?(this.groups[t].update(a),this.groups[t].options.yAxisOrientation=="right"?(this.yAxisRight.updateGroup(t,this.groups[t]),this.legendRight.updateGroup(t,this.groups[t]),this.yAxisLeft.removeGroup(t),this.legendLeft.removeGroup(t)):(this.yAxisLeft.updateGroup(t,this.groups[t]),this.legendLeft.updateGroup(t,this.groups[t]),this.yAxisRight.removeGroup(t),this.legendRight.removeGroup(t))):(this.groups[t]=new Ko(a,t,this.options,this.groupsUsingDefaultStyles),this.groups[t].options.yAxisOrientation=="right"?(this.yAxisRight.addGroup(t,this.groups[t]),this.legendRight.addGroup(t,this.groups[t])):(this.yAxisLeft.addGroup(t,this.groups[t]),this.legendLeft.addGroup(t,this.groups[t]))),this.legendLeft.redraw(),this.legendRight.redraw()};pr.prototype._updateAllGroupData=function(a,t){if(this.itemsData!=null){var e={},r=this.itemsData.get(),n=this.itemsData.idProp,s={};a&&sr(a).call(a,function(v){s[v]=v});for(var o={},l=0;l<r.length;l++){var c=r[l],u=c.group;u==null&&(u=Kb),o.hasOwnProperty(u)?o[u]++:o[u]=1}var d={};if(!t&&a){for(u in this.groups)if(this.groups.hasOwnProperty(u)){y=this.groups[u];var h=y.getItems();e[u]=lt(h).call(h,function(v){return d[v[n]]=v[n],v[n]!==s[v[n]]});var f=o[u];o[u]-=e[u].length,e[u].length<f&&(e[u][f-1]={})}}for(l=0;l<r.length;l++)if(c=r[l],u=c.group,u==null&&(u=Kb),!(!t&&a&&c[n]!==s[c[n]]&&d.hasOwnProperty(c[n]))){e.hasOwnProperty(u)||(e[u]=new Array(o[u]));var m=ae.bridgeObject(c);m.x=ae.convert(c.x,"Date"),m.end=ae.convert(c.end,"Date"),m.orginalY=c.y,m.y=Number(c.y),m[n]=c[n];var g=e[u].length-o[u]--;e[u][g]=m}for(u in this.groups)this.groups.hasOwnProperty(u)&&(e.hasOwnProperty(u)||(e[u]=new Array(0)));for(u in e)if(e.hasOwnProperty(u))if(e[u].length==0)this.groups.hasOwnProperty(u)&&this._removeGroup(u);else{var y=void 0;this.groupsData!=null&&(y=this.groupsData.get(u)),y==null&&(y={id:u,content:this.options.defaultGroup+u}),this._updateGroup(y,u),this.groups[u].setItems(e[u])}this.forceGraphUpdate=!0,this.body.emitter.emit("_change",{queue:!0})}};pr.prototype.redraw=function(){var a=!1;this.props.width=this.dom.frame.offsetWidth,this.props.height=this.body.domProps.centerContainer.height-this.body.domProps.border.top-this.body.domProps.border.bottom,a=this._isResized()||a;var t=this.body.range.end-this.body.range.start,e=t!=this.lastVisibleInterval;if(this.lastVisibleInterval=t,a==!0){var r;this.svg.style.width=ae.option.asSize(3*this.props.width),this.svg.style.left=ae.option.asSize(-this.props.width),(Er(r=this.options.height+"").call(r,"%")!=-1||this.updateSVGheightOnResize==!0)&&(this.updateSVGheight=!0)}if(this.updateSVGheight==!0?(this.options.graphHeight!=this.props.height+"px"&&(this.options.graphHeight=this.props.height+"px",this.svg.style.height=this.props.height+"px"),this.updateSVGheight=!1):this.svg.style.height=(""+this.options.graphHeight).replace("px","")+"px",a==!0||e==!0||this.abortedGraphUpdate==!0||this.forceGraphUpdate==!0)a=this._updateGraph()||a,this.forceGraphUpdate=!1,this.lastStart=this.body.range.start,this.svg.style.left=-this.props.width+"px";else if(this.lastStart!=0){var n=this.body.range.start-this.lastStart,s=this.body.range.end-this.body.range.start;if(this.props.width!=0){var o=this.props.width/s,l=n*o;this.svg.style.left=-this.props.width-l+"px"}}return this.legendLeft.redraw(),this.legendRight.redraw(),a};pr.prototype._getSortedGroupIds=function(){var a=[];for(var t in this.groups)if(this.groups.hasOwnProperty(t)){var e=this.groups[t];e.visible==!0&&(this.options.groups.visibility[t]===void 0||this.options.groups.visibility[t]==!0)&&a.push({id:t,zIndex:e.options.zIndex})}ae.insertSort(a,function(s,o){var l=s.zIndex,c=o.zIndex;return l===void 0&&(l=0),c===void 0&&(c=0),l==c?0:l<c?-1:1});for(var r=new Array(a.length),n=0;n<a.length;n++)r[n]=a[n].id;return r};pr.prototype._updateGraph=function(){if(Fo(this.svgElements),this.props.width!=0&&this.itemsData!=null){var a,t,e={},r=!1,n=this.body.util.toGlobalTime(-this.body.domProps.root.width),s=this.body.util.toGlobalTime(2*this.body.domProps.root.width),o=this._getSortedGroupIds();if(o.length>0){var l={};for(this._getRelevantData(o,l,n,s),this._applySampling(o,l),t=0;t<o.length;t++)this._convertXcoordinates(l[o[t]]);if(this._getYRanges(o,l,e),r=this._updateYAxis(o,e),r==!0)return Da(this.svgElements),this.abortedGraphUpdate=!0,!0;this.abortedGraphUpdate=!1;var c=void 0;for(t=0;t<o.length;t++)a=this.groups[o[t]],this.options.stack===!0&&this.options.style==="line"&&(a.options.excludeFromStacking==null||!a.options.excludeFromStacking)&&(c!=null&&(this._stack(l[a.id],l[c.id]),a.options.shaded.enabled==!0&&a.options.shaded.orientation!=="group"&&(a.options.shaded.orientation=="top"&&c.options.shaded.orientation!=="group"?(c.options.shaded.orientation="group",c.options.shaded.groupId=a.id):(a.options.shaded.orientation="group",a.options.shaded.groupId=c.id))),c=a),this._convertYcoordinates(l[o[t]],a);var u={};for(t=0;t<o.length;t++)if(a=this.groups[o[t]],a.options.style==="line"&&a.options.shaded.enabled==!0){var d=l[o[t]];if(d==null||d.length==0)continue;if(u.hasOwnProperty(o[t])||(u[o[t]]=rn.calcPath(d,a)),a.options.shaded.orientation==="group"){var h=a.options.shaded.groupId;if(Er(o).call(o,h)===-1){console.log(a.id+": Unknown shading group target given:"+h);continue}u.hasOwnProperty(h)||(u[h]=rn.calcPath(l[h],this.groups[h])),rn.drawShading(u[o[t]],a,u[h],this.framework)}else rn.drawShading(u[o[t]],a,void 0,this.framework)}for($n.draw(o,l,this.framework),t=0;t<o.length;t++)if(a=this.groups[o[t]],l[o[t]].length>0)switch(a.options.style){case"line":u.hasOwnProperty(o[t])||(u[o[t]]=rn.calcPath(l[o[t]],a)),rn.draw(u[o[t]],a,this.framework);case"point":case"points":(a.options.style=="point"||a.options.style=="points"||a.options.drawPoints.enabled==!0)&&Lg.draw(l[o[t]],a,this.framework);break}}}return Da(this.svgElements),!1};pr.prototype._stack=function(a,t){var e,r,n,s,o;e=0;for(var l=0;l<a.length;l++){s=void 0,o=void 0;for(var c=e;c<t.length;c++)if(t[c].x===a[l].x){s=t[c],o=t[c],e=c;break}else if(t[c].x>a[l].x){o=t[c],c==0?s=o:s=t[c-1],e=c;break}o===void 0&&(s=t[t.length-1],o=t[t.length-1]),r=o.x-s.x,n=o.y-s.y,r==0?a[l].y=a[l].orginalY+o.y:a[l].y=a[l].orginalY+n/r*(a[l].x-s.x)+s.y}};pr.prototype._getRelevantData=function(a,t,e,r){var n,s,o,l;if(a.length>0)for(s=0;s<a.length;s++){n=this.groups[a[s]];var c=n.getItems();if(ci(n.options)==!0){var u=function(g,y){return g.getTime()==y.getTime()?0:g<y?-1:1},d=Math.max(0,ae.binarySearchValue(c,e,"x","before",u)),h=Math.min(c.length,ae.binarySearchValue(c,r,"x","after",u)+1);h<=0&&(h=c.length);var f=new Array(h-d);for(o=d;o<h;o++)l=n.itemsData[o],f[o-d]=l;t[a[s]]=f}else t[a[s]]=n.itemsData}};pr.prototype._applySampling=function(a,t){var e;if(a.length>0){for(var r=0;r<a.length;r++)if(e=this.groups[a[r]],e.options.sampling==!0){var n=t[a[r]];if(n.length>0){var s=1,o=n.length,l=this.body.util.toGlobalScreen(n[n.length-1].x)-this.body.util.toGlobalScreen(n[0].x),c=o/l;s=Math.min(Math.ceil(.2*o),Math.max(1,Math.round(c)));for(var u=new Array(o),d=0;d<o;d+=s){var h=Math.round(d/s);u[h]=n[d]}t[a[r]]=Bn(u).call(u,0,Math.round(o/s))}}}};pr.prototype._getYRanges=function(a,t,e){var r,n,s,o=[],l=[],c;if(a.length>0){for(s=0;s<a.length;s++)r=t[a[s]],c=this.groups[a[s]].options,r.length>0&&(n=this.groups[a[s]],c.stack===!0&&c.style==="bar"?c.yAxisOrientation==="left"?o=Ir(o).call(o,r):l=Ir(l).call(l,r):e[a[s]]=n.getYRange(r,a[s]));$n.getStackedYRange(o,e,a,"__barStackLeft","left"),$n.getStackedYRange(l,e,a,"__barStackRight","right")}};pr.prototype._updateYAxis=function(a,t){var e=!1,r=!1,n=!1,s=1e9,o=1e9,l=-1e9,c=-1e9,u,d;if(a.length>0){for(var h=0;h<a.length;h++){var f=this.groups[a[h]];f&&f.options.yAxisOrientation!="right"?(r=!0,s=1e9,l=-1e9):f&&f.options.yAxisOrientation&&(n=!0,o=1e9,c=-1e9)}for(h=0;h<a.length;h++)t.hasOwnProperty(a[h])&&t[a[h]].ignore!==!0&&(u=t[a[h]].min,d=t[a[h]].max,t[a[h]].yAxisOrientation!="right"?(r=!0,s=s>u?u:s,l=l<d?d:l):(n=!0,o=o>u?u:o,c=c<d?d:c));r==!0&&this.yAxisLeft.setRange(s,l),n==!0&&this.yAxisRight.setRange(o,c)}e=this._toggleAxisVisiblity(r,this.yAxisLeft)||e,e=this._toggleAxisVisiblity(n,this.yAxisRight)||e,n==!0&&r==!0?(this.yAxisLeft.drawIcons=!0,this.yAxisRight.drawIcons=!0):(this.yAxisLeft.drawIcons=!1,this.yAxisRight.drawIcons=!1),this.yAxisRight.master=!r,this.yAxisRight.masterAxis=this.yAxisLeft,this.yAxisRight.master==!1?(n==!0?this.yAxisLeft.lineOffset=this.yAxisRight.width:this.yAxisLeft.lineOffset=0,e=this.yAxisLeft.redraw()||e,e=this.yAxisRight.redraw()||e):e=this.yAxisRight.redraw()||e;var m=["__barStackLeft","__barStackRight","__lineStackLeft","__lineStackRight"];for(h=0;h<m.length;h++)Er(a).call(a,m[h])!=-1&&Bn(a).call(a,Er(a).call(a,m[h]),1);return e};pr.prototype._toggleAxisVisiblity=function(a,t){var e=!1;return a==!1?t.dom.frame.parentNode&&t.hidden==!1&&(t.hide(),e=!0):!t.dom.frame.parentNode&&t.hidden==!0&&(t.show(),e=!0),e};pr.prototype._convertXcoordinates=function(a){for(var t=this.body.util.toScreen,e=0;e<a.length;e++)a[e].screen_x=t(a[e].x)+this.props.width,a[e].screen_y=a[e].y,a[e].end!=null?a[e].screen_end=t(a[e].end)+this.props.width:a[e].screen_end=void 0};pr.prototype._convertYcoordinates=function(a,t){var e=this.yAxisLeft,r=Number(this.svg.style.height.replace("px",""));t.options.yAxisOrientation=="right"&&(e=this.yAxisRight);for(var n=0;n<a.length;n++)a[n].screen_y=Math.round(e.convertValue(a[n].y));t.setZeroPosition(Math.min(r,e.convertValue(0)))};Mt="string",Yt="boolean",br="number",Yge="array",yh="date",Wr="object",qge="dom",bh="moment",y2="any",Zge={configure:{enabled:{boolean:Yt},filter:{boolean:Yt,function:"function"},container:{dom:qge},__type__:{object:Wr,boolean:Yt,function:"function"}},alignCurrentTime:{string:Mt,undefined:"undefined"},yAxisOrientation:{string:["left","right"]},defaultGroup:{string:Mt},sort:{boolean:Yt},sampling:{boolean:Yt},stack:{boolean:Yt},graphHeight:{string:Mt,number:br},shaded:{enabled:{boolean:Yt},orientation:{string:["bottom","top","zero","group"]},groupId:{object:Wr},__type__:{boolean:Yt,object:Wr}},style:{string:["line","bar","points"]},barChart:{width:{number:br},minWidth:{number:br},sideBySide:{boolean:Yt},align:{string:["left","center","right"]},__type__:{object:Wr}},interpolation:{enabled:{boolean:Yt},parametrization:{string:["centripetal","chordal","uniform"]},alpha:{number:br},__type__:{object:Wr,boolean:Yt}},drawPoints:{enabled:{boolean:Yt},onRender:{function:"function"},size:{number:br},style:{string:["square","circle"]},__type__:{object:Wr,boolean:Yt,function:"function"}},dataAxis:{showMinorLabels:{boolean:Yt},showMajorLabels:{boolean:Yt},showWeekScale:{boolean:Yt},icons:{boolean:Yt},width:{string:Mt,number:br},visible:{boolean:Yt},alignZeros:{boolean:Yt},left:{range:{min:{number:br,undefined:"undefined"},max:{number:br,undefined:"undefined"},__type__:{object:Wr}},format:{function:"function"},title:{text:{string:Mt,number:br,undefined:"undefined"},style:{string:Mt,undefined:"undefined"},__type__:{object:Wr}},__type__:{object:Wr}},right:{range:{min:{number:br,undefined:"undefined"},max:{number:br,undefined:"undefined"},__type__:{object:Wr}},format:{function:"function"},title:{text:{string:Mt,number:br,undefined:"undefined"},style:{string:Mt,undefined:"undefined"},__type__:{object:Wr}},__type__:{object:Wr}},__type__:{object:Wr}},legend:{enabled:{boolean:Yt},icons:{boolean:Yt},left:{visible:{boolean:Yt},position:{string:["top-right","bottom-right","top-left","bottom-left"]},__type__:{object:Wr}},right:{visible:{boolean:Yt},position:{string:["top-right","bottom-right","top-left","bottom-left"]},__type__:{object:Wr}},__type__:{object:Wr,boolean:Yt}},groups:{visibility:{any:y2},__type__:{object:Wr}},autoResize:{boolean:Yt},throttleRedraw:{number:br},clickToUse:{boolean:Yt},end:{number:br,date:yh,string:Mt,moment:bh},format:{minorLabels:{millisecond:{string:Mt,undefined:"undefined"},second:{string:Mt,undefined:"undefined"},minute:{string:Mt,undefined:"undefined"},hour:{string:Mt,undefined:"undefined"},weekday:{string:Mt,undefined:"undefined"},day:{string:Mt,undefined:"undefined"},week:{string:Mt,undefined:"undefined"},month:{string:Mt,undefined:"undefined"},quarter:{string:Mt,undefined:"undefined"},year:{string:Mt,undefined:"undefined"},__type__:{object:Wr}},majorLabels:{millisecond:{string:Mt,undefined:"undefined"},second:{string:Mt,undefined:"undefined"},minute:{string:Mt,undefined:"undefined"},hour:{string:Mt,undefined:"undefined"},weekday:{string:Mt,undefined:"undefined"},day:{string:Mt,undefined:"undefined"},week:{string:Mt,undefined:"undefined"},month:{string:Mt,undefined:"undefined"},quarter:{string:Mt,undefined:"undefined"},year:{string:Mt,undefined:"undefined"},__type__:{object:Wr}},__type__:{object:Wr}},moment:{function:"function"},height:{string:Mt,number:br},hiddenDates:{start:{date:yh,number:br,string:Mt,moment:bh},end:{date:yh,number:br,string:Mt,moment:bh},repeat:{string:Mt},__type__:{object:Wr,array:Yge}},locale:{string:Mt},locales:{__any__:{any:y2},__type__:{object:Wr}},max:{date:yh,number:br,string:Mt,moment:bh},maxHeight:{number:br,string:Mt},maxMinorChars:{number:br},min:{date:yh,number:br,string:Mt,moment:bh},minHeight:{number:br,string:Mt},moveable:{boolean:Yt},multiselect:{boolean:Yt},orientation:{string:Mt},showCurrentTime:{boolean:Yt},showMajorLabels:{boolean:Yt},showMinorLabels:{boolean:Yt},showWeekScale:{boolean:Yt},snap:{function:"function",null:"null"},start:{date:yh,number:br,string:Mt,moment:bh},timeAxis:{scale:{string:Mt,undefined:"undefined"},step:{number:br,undefined:"undefined"},__type__:{object:Wr}},width:{string:Mt,number:br},zoomable:{boolean:Yt},zoomKey:{string:["ctrlKey","altKey","metaKey",""]},zoomMax:{number:br},zoomMin:{number:br},zIndex:{number:br},__type__:{object:Wr}},Kge={global:{alignCurrentTime:["none","year","month","quarter","week","isoWeek","day","date","hour","minute","second"],sort:!0,sampling:!0,stack:!1,shaded:{enabled:!1,orientation:["zero","top","bottom","group"]},style:["line","bar","points"],barChart:{width:[50,5,100,5],minWidth:[50,5,100,5],sideBySide:!1,align:["left","center","right"]},interpolation:{enabled:!0,parametrization:["centripetal","chordal","uniform"]},drawPoints:{enabled:!0,size:[6,2,30,1],style:["square","circle"]},dataAxis:{showMinorLabels:!0,showMajorLabels:!0,showWeekScale:!1,icons:!1,width:[40,0,200,1],visible:!0,alignZeros:!0,left:{title:{text:"",style:""}},right:{title:{text:"",style:""}}},legend:{enabled:!1,icons:!0,left:{visible:!0,position:["top-right","bottom-right","top-left","bottom-left"]},right:{visible:!0,position:["top-right","bottom-right","top-left","bottom-left"]}},autoResize:!0,clickToUse:!1,end:"",format:{minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",week:"w",month:"MMM",quarter:"[Q]Q",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",week:"MMMM YYYY",month:"YYYY",quarter:"YYYY",year:""}},height:"",locale:"",max:"",maxHeight:"",maxMinorChars:[7,0,20,1],min:"",minHeight:"",moveable:!0,orientation:["both","bottom","top"],showCurrentTime:!1,showMajorLabels:!0,showMinorLabels:!0,showWeekScale:!1,start:"",width:"100%",zoomable:!0,zoomKey:["ctrlKey","altKey","metaKey",""],zoomMax:[31536e10,10,31536e10,1],zoomMin:[10,10,31536e10,1],zIndex:0}};co.prototype=new vu;co.prototype.setOptions=function(a){var t=yz.validate(a,Zge);t===!0&&console.log("%cErrors have been found in the supplied options object.",Zb),vu.prototype.setOptions.call(this,a)};co.prototype.setItems=function(a){var t=this.itemsData==null,e;if(a?Uo(a)?e=Nh(a):e=Nh(new Su(a)):e=null,this.itemsData&&this.itemsData.dispose(),this.itemsData=e,this.linegraph&&this.linegraph.setItems(e!=null?e.rawDS:null),t)if(this.options.start!=null||this.options.end!=null){var r=this.options.start!=null?this.options.start:null,n=this.options.end!=null?this.options.end:null;this.setWindow(r,n,{animation:!1})}else this.fit({animation:!1})};co.prototype.setGroups=function(a){var t;a?Uo(a)?t=a:t=new Su(a):t=null,this.groupsData=t,this.linegraph.setGroups(t)};co.prototype.getLegend=function(a,t,e){return t===void 0&&(t=15),e===void 0&&(e=15),this.linegraph.groups[a]!==void 0?this.linegraph.groups[a].getLegend(t,e):"cannot find group:'"+a+"'"};co.prototype.isGroupVisible=function(a){return this.linegraph.groups[a]!==void 0?this.linegraph.groups[a].visible&&(this.linegraph.options.groups.visibility[a]===void 0||this.linegraph.options.groups.visibility[a]==!0):!1};co.prototype.getDataRange=function(){var a=null,t=null;for(var e in this.linegraph.groups)if(this.linegraph.groups.hasOwnProperty(e)&&this.linegraph.groups[e].visible==!0)for(var r=0;r<this.linegraph.groups[e].itemsData.length;r++){var n=this.linegraph.groups[e].itemsData[r],s=ae.convert(n.x,"Date").valueOf();a=a==null||a>s?s:a,t=t==null||t<s?s:t}return{min:a!=null?new Date(a):null,max:t!=null?new Date(t):null}};co.prototype.getEventProperties=function(a){var t=a.center?a.center.x:a.clientX,e=a.center?a.center.y:a.clientY,r=t-ae.getAbsoluteLeft(this.dom.centerContainer),n=e-ae.getAbsoluteTop(this.dom.centerContainer),s=this._toTime(r),o=M0.customTimeFromTarget(a),l=ae.getTarget(a),c=null;ae.hasParent(l,this.timeAxis.dom.foreground)||this.timeAxis2&&ae.hasParent(l,this.timeAxis2.dom.foreground)?c="axis":ae.hasParent(l,this.linegraph.yAxisLeft.dom.frame)||ae.hasParent(l,this.linegraph.yAxisRight.dom.frame)?c="data-axis":ae.hasParent(l,this.linegraph.legendLeft.dom.frame)||ae.hasParent(l,this.linegraph.legendRight.dom.frame)?c="legend":o!=null?c="custom-time":ae.hasParent(l,this.currentTime.bar)?c="current-time":ae.hasParent(l,this.dom.center)&&(c="background");var u=[],d=this.linegraph.yAxisLeft,h=this.linegraph.yAxisRight;return!d.hidden&&this.itemsData.length>0&&u.push(d.screenToValue(n)),!h.hidden&&this.itemsData.length>0&&u.push(h.screenToValue(n)),{event:a,customTime:o?o.options.id:null,what:c,pageX:a.srcEvent?a.srcEvent.pageX:a.pageX,pageY:a.srcEvent?a.srcEvent.pageY:a.pageY,x:r,y:n,time:s,value:u}};co.prototype._createConfigurator=function(){return new bz(this,this.dom.container,Kge)};Xge=yB();bn.locale(Xge);Jge={Core:vu,DateUtil:Spe,Range:dk,stack:Gme,TimeStep:sg,components:{items:{Item:Ou,BackgroundItem:ic,BoxItem:mz,ClusterItem:bk,PointItem:gz,RangeItem:Jl},BackgroundGroup:yk,Component:Zo,CurrentTime:gk,CustomTime:M0,DataAxis:ex,DataScale:wz,GraphGroup:Ko,Group:qb,ItemSet:lg,Legend:sa,LineGraph:pr,TimeAxis:og}}});var Tz=_e(()=>{Ez()});var Cz={};At(Cz,{DOMutil:()=>qae,DataSet:()=>Su,DataView:()=>x$,Graph2d:()=>co,Hammer:()=>yn,Queue:()=>_$,Timeline:()=>zge,keycharm:()=>X$,moment:()=>bn,timeline:()=>Jge,util:()=>gB});var _z=_e(()=>{Tz()});var Fu,kz,Sz,xz,Xh,wk=_e(()=>{Fu=require("obsidian");nh();uh();au();WI();kz=(_z(),Do(Cz)),Sz=kz.Timeline,xz=kz.DataSet,Xh=class{constructor(t,e,r={}){this.timeline=null;this.dependencyArrows=null;this.filters={};this.events=[];this.locations=[];this.showEras=!1;this.narrativeOrder=!1;this.palette=["#7C3AED","#2563EB","#059669","#CA8A04","#DC2626","#EA580C","#0EA5E9","#22C55E","#D946EF","#F59E0B"];this.container=t,this.plugin=e,this.app=e.app,this.options={ganttMode:!1,groupMode:"none",showDependencies:!0,stackEnabled:!0,density:50,defaultGanttDuration:1,editMode:!1,...r}}async initialize(){this.events=await this.plugin.listEvents(),this.locations=await this.plugin.listLocations(),await this.render()}async refresh(){this.events=await this.plugin.listEvents(),await this.render()}applyFilters(t){this.filters={...this.filters,...t},this.render()}setGanttMode(t){this.options.ganttMode=t,this.render()}setGroupMode(t){this.options.groupMode=t,this.render()}setEditMode(t){this.options.editMode=t,this.timeline&&this.timeline.setOptions({editable:t?{updateTime:!0,updateGroup:!0,remove:!1,add:!1}:!1})}setShowEras(t){this.showEras=t,this.options.showEras=t,this.render()}setNarrativeOrder(t){this.narrativeOrder=t,this.options.narrativeOrder=t,this.render()}setVisibleRange(t,e){this.timeline&&this.timeline.setWindow(t,e)}setStackEnabled(t){this.options.stackEnabled=t,this.render()}setDensity(t){this.options.density=t,this.render()}fitToView(){this.timeline&&this.timeline.fit()}zoomPresetYears(t){if(!this.timeline)return;let e=this.plugin.getReferenceTodayDate().getTime(),r=t*365.25*24*60*60*1e3/2;this.timeline.setWindow(new Date(e-r),new Date(e+r))}moveToToday(){if(this.timeline){let t=this.plugin.getReferenceTodayDate();this.timeline.moveTo(t)}}getVisibleRange(){if(!this.timeline)return null;try{let t=this.timeline.getWindow();return{start:new Date(t.start),end:new Date(t.end)}}catch(t){return null}}async exportAsImage(t){new Fu.Notice(`Export as ${t.toUpperCase()} not yet implemented`)}getEventCount(){return this.events.filter(t=>this.shouldIncludeEvent(t)).length}getDateRange(){let t=this.plugin.getReferenceTodayDate(),e=1/0,r=-1/0;return this.events.forEach(n=>{if(!this.shouldIncludeEvent(n))return;let s=n.dateTime?Pt(n.dateTime,{referenceDate:t}):null,o=to(s==null?void 0:s.start),l=to(s==null?void 0:s.end);o!=null&&(e=Math.min(e,o),r=Math.max(r,l||o))}),e===1/0?null:{start:new Date(e),end:new Date(r)}}destroy(){if(this.dependencyArrows){try{this.dependencyArrows.removeArrows()}catch(t){}this.dependencyArrows=null}if(this.timeline){try{this.timeline.destroy()}catch(t){}this.timeline=null}}async render(){try{this.destroy();let t=this.plugin.getReferenceTodayDate(),e=this.buildDatasets(t),r=e.items,n=e.groups,o=(this.options.ganttMode?15:4)+Math.round((this.options.density||50)/6),l=1440*60*1e3,c=365.25*l,u=this.getDateRange(),d=1e3*c,h=1e4*c;if(u){let m=u.end.getTime()-u.start.getTime();d=Math.max(m*2,1e3*c),d=Math.min(d,h)}let f={stack:this.options.stackEnabled,stackSubgroups:!0,margin:{item:o,axis:20},zoomable:!0,zoomFriction:10,zoomKey:"ctrlKey",horizontalScroll:!0,zoomMin:l,zoomMax:d,multiselect:!0,orientation:"bottom",tooltip:{followMouse:!0,overflowMethod:"cap",delay:300},visibleFrameTemplate:function(m){return!m.progress||m.progress===0?"":`<div class="timeline-progress" style="width:${m.progress}%"></div>`}};this.container.style.overflow="visible",this.options.editMode&&(f.editable={updateTime:!0,updateGroup:!0,remove:!1,add:!1},f.onMove=async(m,g)=>{let y=this.events[m.id];if(!y){g(null);return}let v=new Date(m.start),E=m.end?new Date(m.end):null;E&&!y.isMilestone?y.dateTime=`${v.toISOString()} to ${E.toISOString()}`:y.dateTime=v.toISOString();try{await this.plugin.saveEvent(y),new Fu.Notice(`Event "${y.name}" rescheduled`),g(m)}catch(C){console.error("Error saving event after drag:",C),new Fu.Notice("Error saving event changes"),g(null)}});try{this.timeline=n?new Sz(this.container,r,n,f):new Sz(this.container,r,f)}catch(m){console.error("Storyteller Suite: Error creating vis-timeline:",m),new Fu.Notice("Timeline rendering failed. Check console for details."),this.container.empty(),this.container.createDiv("storyteller-timeline-error",g=>{g.createEl("h3",{text:"Timeline Error"}),g.createEl("p",{text:"Failed to render timeline. This may be due to invalid date formats or vis-timeline configuration issues."}),g.createEl("p",{text:"Check the developer console (Ctrl+Shift+I) for more details."})});return}if(this.timeline&&t)try{typeof this.timeline.setCurrentTime=="function"&&this.timeline.setCurrentTime(t)}catch(m){console.warn("Storyteller Suite: Could not set current time marker:",m)}if(this.timeline.on("doubleClick",m=>{if(m.item!=null){let g=m.item,y=this.events[g];new ts(this.app,this.plugin,y,async v=>{await this.plugin.saveEvent(v),new Fu.Notice(`Event "${v.name}" updated`),await this.refresh()}).open()}}),this.options.ganttMode&&this.options.showDependencies)try{let m=this.buildDependencyArrows();if(m.length>0){let g={followRelationships:!0,color:"#666",strokeWidth:2,hideWhenItemsNotVisible:!0};this.dependencyArrows=new km(this.timeline,m,g)}}catch(m){console.warn("Storyteller Suite: Error rendering dependency arrows:",m)}if(this.narrativeOrder)try{this.renderNarrativeConnectors()}catch(m){console.warn("Storyteller Suite: Error rendering narrative connectors:",m)}}catch(t){console.error("Storyteller Suite: Fatal error in timeline rendering:",t),new Fu.Notice("Timeline could not be rendered. Check console for details."),this.container.empty(),this.container.createDiv("storyteller-timeline-error",e=>{e.createEl("h3",{text:"Timeline Error"}),e.createEl("p",{text:"An unexpected error occurred while rendering the timeline."}),e.createEl("p",{text:"Check the developer console (Ctrl+Shift+I) for more details."})})}}buildDatasets(t){let e=new xz,r=[],n,s=Vr.detectAllConflicts(this.events);this.options.onConflictsDetected&&this.options.onConflictsDetected(s);let o=new Map;s.forEach(d=>{d.events.forEach(h=>{let f=o.get(h.name)||[];f.push(d),o.set(h.name,f)})});let l=[...this.events];this.narrativeOrder&&l.sort((d,h)=>{var g,y;let f=(g=d.narrativeSequence)!=null?g:Number.MAX_SAFE_INTEGER,m=(y=h.narrativeSequence)!=null?y:Number.MAX_SAFE_INTEGER;return f-m});let c=new Map,u=new Map;if(this.options.groupMode!=="none"){if(n=new xz,this.options.groupMode==="group"){this.plugin.getGroups().forEach((f,m)=>{let g=f.color||this.palette[m%this.palette.length];c.set(f.id,g),u.set(f.id,f.name),n.add({id:f.id,content:f.name}),r.push({key:f.id,label:f.name,color:g})});let h="#64748B";c.set("__ungrouped__",h),u.set("__ungrouped__","Ungrouped"),n.add({id:"__ungrouped__",content:"Ungrouped"}),r.push({key:"__ungrouped__",label:"Ungrouped",color:h})}else if(this.options.groupMode==="location")Array.from(new Set(this.events.map(h=>h.location||"Unspecified"))).forEach((h,f)=>{let m=h||"Unspecified",g=m==="Unspecified"?"Unspecified":this.resolveLocationName(m),y=this.palette[f%this.palette.length];c.set(m,y),u.set(m,g),n.add({id:m,content:g}),r.push({key:m,label:g,color:y})});else if(this.options.groupMode==="character"){let d=new Set;this.events.forEach(f=>{f.characters&&f.characters.length>0&&f.characters.forEach(m=>d.add(m))}),Array.from(d).forEach((f,m)=>{let g=this.palette[m%this.palette.length];c.set(f,g),u.set(f,f),n.add({id:f,content:f}),r.push({key:f,label:f,color:g})});let h="#64748B";c.set("__unassigned__",h),u.set("__unassigned__","No character"),n.add({id:"__unassigned__",content:"No character"}),r.push({key:"__unassigned__",label:"No character",color:h})}else if(this.options.groupMode==="track"){(this.plugin.settings.timelineTracks||[]).filter(m=>m.visible!==!1).forEach((m,g)=>{let y=m.color||this.palette[g%this.palette.length];c.set(m.id,y),u.set(m.id,m.name),n.add({id:m.id,content:m.name}),r.push({key:m.id,label:m.name,color:y})});let f="#64748B";c.set("__no_track__",f),u.set("__no_track__","Unassigned"),n.add({id:"__no_track__",content:"Unassigned"}),r.push({key:"__no_track__",label:"Unassigned",color:f})}}return l.forEach(d=>{var W,Y,U;if(!this.shouldIncludeEvent(d))return;let h=this.events.findIndex(Z=>Z===d);if(h===-1)return;let f=d.dateTime?Pt(d.dateTime,{referenceDate:t}):{error:"empty"},m=to(f.start),g=to(f.end);if(m==null)return;let y,v;if(this.options.groupMode==="group")y=d.groups&&d.groups.length>0?d.groups[0]:"__ungrouped__",v=c.get(y);else if(this.options.groupMode==="location")y=d.location||"Unspecified",v=c.get(y);else if(this.options.groupMode==="character")y=d.characters&&d.characters.length>0?d.characters[0]:"__unassigned__",v=c.get(y);else if(this.options.groupMode==="track"){let X=(this.plugin.settings.timelineTracks||[]).filter(ie=>ie.visible!==!1).find(ie=>{var j,K;if(ie.type==="global")return!0;if(ie.type==="character"&&ie.entityId)return(j=d.characters)==null?void 0:j.includes(ie.entityId);if(ie.type==="location"&&ie.entityId)return d.location===ie.entityId;if(ie.type==="group"&&ie.entityId)return(K=d.groups)==null?void 0:K.includes(ie.entityId);if(ie.type==="custom"&&ie.filterCriteria){let se=ie.filterCriteria,ne=!0;return se.characters&&se.characters.length>0&&(se.characters.some(ve=>{var Se;return(Se=d.characters)==null?void 0:Se.includes(ve)})||(ne=!1)),se.locations&&se.locations.length>0&&(!d.location||!se.locations.includes(d.location))&&(ne=!1),se.tags&&se.tags.length>0&&(se.tags.some(ve=>{var Se;return(Se=d.tags)==null?void 0:Se.includes(ve)})||(ne=!1)),se.groups&&se.groups.length>0&&(se.groups.some(ve=>{var Se;return(Se=d.groups)==null?void 0:Se.includes(ve)})||(ne=!1)),se.status&&se.status.length>0&&(!d.status||!se.status.includes(d.status))&&(ne=!1),se.milestonesOnly===!0&&(d.isMilestone||(ne=!1)),ne}return!1});y=X?X.id:"__no_track__",v=c.get(y)}let E=!!f.approximate,C=!!d.isMilestone,_=g;if(this.options.ganttMode&&_==null){let Z=(this.options.defaultGanttDuration||1)*24*60*60*1e3;_=m+Z}let x=[];E&&x.push("is-approx"),C&&(x.push("timeline-milestone"),this.options.ganttMode&&x.push("gantt-milestone")),this.options.ganttMode&&!C&&x.push("gantt-bar");let P=((W=d.narrativeMarkers)==null?void 0:W.isFlashback)||!1,I=((Y=d.narrativeMarkers)==null?void 0:Y.isFlashforward)||!1;P&&x.push("narrative-flashback"),I&&x.push("narrative-flashforward");let M=v&&!C?`background-color:${this.hexWithAlpha(v,.18)};border-color:${v};`:"",O=o.get(d.name)||[],R=O.length>0,F=O.some(Z=>Z.severity==="error"),$=O.some(Z=>Z.severity==="warning"),k=(U=d.name)==null?void 0:U.trim(),N=k||"(Untitled Event)";k||console.warn(`Storyteller Suite: Event at index ${h} has no name. File: ${d.filePath||"unknown"}`),this.narrativeOrder&&d.narrativeSequence!==void 0&&(N=`[${d.narrativeSequence}] ${N}`,x.push("has-narrative-sequence")),F?(N="\u26A0\uFE0F "+N,x.push("has-conflict-error")):$&&(N="\u26A0 "+N,x.push("has-conflict-warning")),P&&(N="\u21B6 "+N),I&&(N="\u21B7 "+N),C&&(N="\u2B50 "+N);let G;this.options.ganttMode?G="range":C?G="box":G=_!=null?"range":"box",e.add({id:h,content:N,start:new Date(m),end:_!=null?new Date(_):void 0,title:this.makeTooltip(d,f,O),type:G,className:x.length>0?x.join(" "):void 0,group:y,style:M,progress:d.progress})}),this.showEras&&(this.plugin.settings.timelineEras||[]).filter(f=>f.visible!==!1).forEach((f,m)=>{if(!f.startDate||!f.endDate)return;let g=Pt(f.startDate,{referenceDate:t}),y=Pt(f.endDate,{referenceDate:t}),v=to(g==null?void 0:g.start),E=to(y==null?void 0:y.start);v==null||E==null||e.add({id:`era-${f.id}`,content:f.name,start:new Date(v),end:new Date(E),type:"background",className:"timeline-era-background",style:f.color?`background-color: ${f.color}; opacity: 0.3;`:`background-color: ${this.palette[m%this.palette.length]}; opacity: 0.2;`})}),{items:e,groups:n,legend:r}}buildDependencyArrows(){let t=[],e=0,r=new Set(this.events.map(n=>this.sanitizeEventId(n.name)));return this.events.forEach((n,s)=>{!n.dependencies||n.dependencies.length===0||this.shouldIncludeEvent(n)&&n.dependencies.forEach(o=>{let l=this.sanitizeEventId(o);if(!r.has(l)){console.warn(`Storyteller Suite: Dependency "${o}" not found for event "${n.name}". Arrow will not be rendered.`);return}let c=this.events.findIndex(u=>this.sanitizeEventId(u.name)===l);if(c===-1){console.warn(`Storyteller Suite: Could not find index for dependency "${o}" for event "${n.name}".`);return}this.shouldIncludeEvent(this.events[c])&&t.push({id:`arrow_${e++}`,id_item_1:c,id_item_2:s,title:`${o} \u2192 ${n.name}`})})}),t}sanitizeEventId(t){return t?t.trim().replace(/[^\w\s-]/g,"").toLowerCase():""}shouldIncludeEvent(t){var r,n,s;if(this.filters.milestonesOnly&&!t.isMilestone||this.filters.characters&&this.filters.characters.size>0&&!((r=t.characters)==null?void 0:r.some(l=>this.filters.characters&&this.filters.characters.has(l)))||this.filters.locations&&this.filters.locations.size>0&&(!t.location||!this.filters.locations.has(t.location))||this.filters.groups&&this.filters.groups.size>0&&!((n=t.groups)==null?void 0:n.some(l=>this.filters.groups&&this.filters.groups.has(l))))return!1;let e=t.id||t.name;if(this.filters.forkId){let o=this.plugin.getTimelineFork(this.filters.forkId);if(o&&!((s=o.forkEvents)==null?void 0:s.includes(e)))return!1}else if(this.plugin.getTimelineForks().some(c=>{var u;return(u=c.forkEvents)==null?void 0:u.includes(e)}))return!1;return!0}resolveLocationName(t){let e=this.locations.find(n=>n.id===t);if(e)return e.name;let r=this.locations.find(n=>n.name===t);return r?r.name:t}makeTooltip(t,e,r=[]){let n=[t.name||"(Untitled Event)"],s=e!=null&&e.start?EI(e.start,void 0,e.isBCE,e.originalYear):t.dateTime||"";if(s&&n.push(s),t.location&&n.push(`@ ${this.resolveLocationName(t.location)}`),t.description&&n.push(t.description.length>120?t.description.slice(0,120)+"\u2026":t.description),r.length>0){let o=r.filter(c=>c.severity==="error"),l=r.filter(c=>c.severity==="warning");o.length>0&&(n.push(""),n.push(`\u26A0\uFE0F ${o.length} ERROR(S):`),o.slice(0,3).forEach(c=>n.push(`  \u2022 ${c.message}`)),o.length>3&&n.push(`  ... and ${o.length-3} more`)),l.length>0&&(n.push(""),n.push(`\u26A0 ${l.length} WARNING(S):`),l.slice(0,3).forEach(c=>n.push(`  \u2022 ${c.message}`)),l.length>3&&n.push(`  ... and ${l.length-3} more`))}return n.filter(Boolean).join(` 
`)}hexWithAlpha(t,e){let r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(!r)return t;let n=parseInt(r[1],16),s=parseInt(r[2],16),o=parseInt(r[3],16);return`rgba(${n}, ${s}, ${o}, ${e})`}renderNarrativeConnectors(){if(!this.timeline)return;this.container.querySelectorAll(".narrative-connector-svg").forEach(s=>s.remove());let e=[];if(this.events.forEach((s,o)=>{if(!this.shouldIncludeEvent(s))return;let l=s.narrativeMarkers;if(!l||!l.targetEvent)return;let c=this.events.findIndex(d=>this.sanitizeEventId(d.name)===this.sanitizeEventId(l.targetEvent||""));if(c===-1||!this.shouldIncludeEvent(this.events[c]))return;let u=l.isFlashback?"flashback":l.isFlashforward?"flashforward":null;u&&e.push({fromIdx:o,toIdx:c,type:u})}),e.length===0)return;let r=this.container.querySelector(".vis-timeline");if(!r)return;let n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.classList.add("narrative-connector-svg"),n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.pointerEvents="none",n.style.zIndex="1",r.appendChild(n),e.forEach(({fromIdx:s,toIdx:o,type:l})=>{let c=this.container.querySelector(`[data-id="${s}"]`),u=this.container.querySelector(`[data-id="${o}"]`);if(!c||!u)return;let d=c.getBoundingClientRect(),h=u.getBoundingClientRect(),f=r.getBoundingClientRect(),m=d.left-f.left+d.width/2,g=d.top-f.top+d.height/2,y=h.left-f.left+h.width/2,v=h.top-f.top+h.height/2,E=y-m,C=v-g,_=Math.abs(E)*.3,x=document.createElementNS("http://www.w3.org/2000/svg","path"),P=`M ${m} ${g} C ${m+_} ${g}, ${y-_} ${v}, ${y} ${v}`;x.setAttribute("d",P),x.setAttribute("fill","none"),x.setAttribute("stroke",l==="flashback"?"#8B5C2E":"#2563EB"),x.setAttribute("stroke-width","2"),x.setAttribute("stroke-dasharray","5,5"),x.setAttribute("opacity","0.6"),x.classList.add("narrative-connector-line");let I=document.createElementNS("http://www.w3.org/2000/svg","marker"),M=`arrow-${l}-${s}-${o}`;I.setAttribute("id",M),I.setAttribute("markerWidth","10"),I.setAttribute("markerHeight","10"),I.setAttribute("refX","5"),I.setAttribute("refY","5"),I.setAttribute("orient","auto");let O=document.createElementNS("http://www.w3.org/2000/svg","path");O.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),O.setAttribute("fill",l==="flashback"?"#8B5C2E":"#2563EB"),I.appendChild(O),n.appendChild(I),x.setAttribute("marker-end",`url(#${M})`),n.appendChild(x)})}}});var Vn,Jh,Ek=_e(()=>{Vn=require("obsidian");St();Jh=class extends Vn.Modal{constructor(e,r,n,s){super(e);this.trackListEl=null;this.characters=[];this.locations=[];this.groups=[];this.plugin=r,this.tracks=JSON.parse(JSON.stringify(n)),this.onSave=s}async onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("storyteller-track-manager"),this.characters=await this.plugin.listCharacters(),this.locations=await this.plugin.listLocations(),this.groups=this.plugin.getGroups(),e.createEl("h2",{text:w("manageTimelineTracks")||"Manage Timeline Tracks"}),e.createDiv({text:"Timeline tracks allow you to view multiple filtered timelines simultaneously. Each track can show events for specific characters, locations, or custom criteria.",cls:"storyteller-track-manager-desc"}),new Vn.Setting(e).setName(w("addTrack")||"Add Track").setDesc("Create a new timeline track").addButton(n=>n.setButtonText(w("add")||"Add").setCta().onClick(()=>this.addNewTrack())),this.trackListEl=e.createDiv({cls:"storyteller-track-list"}),this.renderTrackList();let r=new Vn.Setting(e);r.addButton(n=>n.setButtonText(w("save")||"Save").setCta().onClick(()=>this.save())),r.addButton(n=>n.setButtonText(w("cancel")||"Cancel").onClick(()=>this.close())),this.addStyles()}addNewTrack(){let e={id:`track-${Date.now()}`,name:`Track ${this.tracks.length+1}`,type:"custom",description:"",color:this.getRandomColor(),filterCriteria:{},sortOrder:this.tracks.length,visible:!0};this.tracks.push(e),this.renderTrackList()}renderTrackList(){if(this.trackListEl){if(this.trackListEl.empty(),this.tracks.length===0){this.trackListEl.createDiv({text:'No tracks created yet. Click "Add Track" to create your first timeline track.',cls:"storyteller-empty-state"});return}this.tracks.sort((e,r)=>(e.sortOrder||0)-(r.sortOrder||0)).forEach((e,r)=>{this.renderTrack(e,r)})}}renderTrack(e,r){if(!this.trackListEl)return;let n=this.trackListEl.createDiv({cls:"storyteller-track-item"}),s=n.createDiv({cls:"storyteller-track-header"});s.createSpan({cls:"storyteller-track-drag-handle",text:"\u2630"}).setAttribute("draggable","true"),this.setupDragAndDrop(n,e,r);let l=s.createSpan({cls:"storyteller-track-color"});l.style.backgroundColor=e.color||"#888888";let c=s.createEl("input",{type:"text",value:e.name,cls:"storyteller-track-name-input"});c.addEventListener("change",()=>{e.name=c.value});let u=s.createEl("button",{text:e.visible?"\u{1F441}":"\u{1F441}\u200D\u{1F5E8}",cls:"storyteller-track-visibility-btn"});u.addEventListener("click",()=>{e.visible=!e.visible,u.setText(e.visible?"\u{1F441}":"\u{1F441}\u200D\u{1F5E8}")}),s.createEl("button",{text:"\u{1F5D1}",cls:"storyteller-track-delete-btn"}).addEventListener("click",()=>{this.deleteTrack(r)});let h=n.createDiv({cls:"storyteller-track-details"});new Vn.Setting(h).setName(w("trackType")||"Track Type").addDropdown(f=>{f.addOption("global","Global (All Events)").addOption("character","Character-based").addOption("location","Location-based").addOption("group","Group-based").addOption("custom","Custom Filter").setValue(e.type).onChange(m=>{e.type=m,this.renderTrackList()})}),(e.type==="character"||e.type==="location"||e.type==="group")&&this.renderEntitySelector(h,e),new Vn.Setting(h).setName(w("trackColor")||"Track Color").addColorPicker(f=>{f.setValue(e.color||"#888888").onChange(m=>{e.color=m,l.style.backgroundColor=m})}),new Vn.Setting(h).setName(w("description")||"Description").addTextArea(f=>{f.setValue(e.description||"").onChange(m=>{e.description=m}),f.inputEl.rows=2}),e.type==="custom"&&this.renderFilterCriteria(h,e)}renderEntitySelector(e,r){let n=[],s=r.entityId||"";r.type==="character"?n=this.characters.map(o=>({value:o.id||o.name,label:o.name})):r.type==="location"?n=this.locations.map(o=>({value:o.id||o.name,label:o.name})):r.type==="group"&&(n=this.groups.map(o=>({value:o.id,label:o.name}))),new Vn.Setting(e).setName(r.type.charAt(0).toUpperCase()+r.type.slice(1)).addDropdown(o=>{o.addOption("","-- Select --"),n.forEach(l=>{o.addOption(l.value,l.label)}),o.setValue(s).onChange(l=>{r.entityId=l})})}renderFilterCriteria(e,r){r.filterCriteria||(r.filterCriteria={}),e.createEl("h4",{text:"Filter Criteria"}),new Vn.Setting(e).setName(w("characters")||"Characters").setDesc("Filter events by characters").addText(n=>{var s;n.setPlaceholder("Character names (comma-separated)").setValue((((s=r.filterCriteria)==null?void 0:s.characters)||[]).join(", ")).onChange(o=>{r.filterCriteria||(r.filterCriteria={}),r.filterCriteria.characters=o.split(",").map(l=>l.trim()).filter(l=>l.length>0)})}),new Vn.Setting(e).setName(w("locations")||"Locations").setDesc("Filter events by locations").addText(n=>{var s;n.setPlaceholder("Location names (comma-separated)").setValue((((s=r.filterCriteria)==null?void 0:s.locations)||[]).join(", ")).onChange(o=>{r.filterCriteria||(r.filterCriteria={}),r.filterCriteria.locations=o.split(",").map(l=>l.trim()).filter(l=>l.length>0)})}),new Vn.Setting(e).setName(w("tags")||"Tags").setDesc("Filter events by tags").addText(n=>{var s;n.setPlaceholder("Tags (comma-separated)").setValue((((s=r.filterCriteria)==null?void 0:s.tags)||[]).join(", ")).onChange(o=>{r.filterCriteria||(r.filterCriteria={}),r.filterCriteria.tags=o.split(",").map(l=>l.trim()).filter(l=>l.length>0)})}),new Vn.Setting(e).setName(w("milestonesOnly")||"Milestones Only").addToggle(n=>{var s;n.setValue(((s=r.filterCriteria)==null?void 0:s.milestonesOnly)||!1).onChange(o=>{r.filterCriteria||(r.filterCriteria={}),r.filterCriteria.milestonesOnly=o})})}setupDragAndDrop(e,r,n){e.addEventListener("dragstart",s=>{var o;(o=s.dataTransfer)==null||o.setData("text/plain",n.toString()),e.addClass("dragging")}),e.addEventListener("dragend",()=>{e.removeClass("dragging")}),e.addEventListener("dragover",s=>{s.preventDefault(),e.addClass("drag-over")}),e.addEventListener("dragleave",()=>{e.removeClass("drag-over")}),e.addEventListener("drop",s=>{var c;s.preventDefault(),e.removeClass("drag-over");let o=parseInt(((c=s.dataTransfer)==null?void 0:c.getData("text/plain"))||"-1");if(o===-1||o===n)return;let[l]=this.tracks.splice(o,1);this.tracks.splice(n,0,l),this.tracks.forEach((u,d)=>{u.sortOrder=d}),this.renderTrackList()})}deleteTrack(e){this.tracks.splice(e,1),this.tracks.forEach((r,n)=>{r.sortOrder=n}),this.renderTrackList()}save(){this.onSave(this.tracks),new Vn.Notice("Timeline tracks saved"),this.close()}getRandomColor(){let e=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7B731","#5F27CD","#00D2D3","#FF9FF3","#54A0FF","#48DBFB","#1DD1A1","#10AC84","#EE5A6F","#C44569"];return e[Math.floor(Math.random()*e.length)]}addStyles(){let e=document.createElement("style");e.textContent=`
            .storyteller-track-manager {
                padding: 1em;
            }

            .storyteller-track-manager-desc {
                margin-bottom: 1.5em;
                color: var(--text-muted);
                font-size: 0.9em;
            }

            .storyteller-track-list {
                max-height: 60vh;
                overflow-y: auto;
                margin: 1em 0;
            }

            .storyteller-track-item {
                border: 1px solid var(--background-modifier-border);
                border-radius: 6px;
                margin-bottom: 1em;
                background: var(--background-secondary);
            }

            .storyteller-track-item.dragging {
                opacity: 0.5;
            }

            .storyteller-track-item.drag-over {
                border-color: var(--interactive-accent);
                border-width: 2px;
            }

            .storyteller-track-header {
                display: flex;
                align-items: center;
                padding: 0.75em;
                gap: 0.5em;
                background: var(--background-primary);
                border-bottom: 1px solid var(--background-modifier-border);
                border-radius: 6px 6px 0 0;
            }

            .storyteller-track-drag-handle {
                cursor: grab;
                user-select: none;
                color: var(--text-muted);
                font-size: 1.2em;
            }

            .storyteller-track-drag-handle:active {
                cursor: grabbing;
            }

            .storyteller-track-color {
                width: 16px;
                height: 16px;
                border-radius: 50%;
                border: 2px solid var(--background-modifier-border);
            }

            .storyteller-track-name-input {
                flex: 1;
                border: none;
                background: transparent;
                font-weight: 600;
                font-size: 1em;
                color: var(--text-normal);
            }

            .storyteller-track-name-input:focus {
                outline: none;
                background: var(--background-secondary);
                padding: 0.25em 0.5em;
                border-radius: 3px;
            }

            .storyteller-track-visibility-btn,
            .storyteller-track-delete-btn {
                background: transparent;
                border: none;
                cursor: pointer;
                font-size: 1.1em;
                padding: 0.25em 0.5em;
                border-radius: 3px;
            }

            .storyteller-track-visibility-btn:hover,
            .storyteller-track-delete-btn:hover {
                background: var(--background-modifier-hover);
            }

            .storyteller-track-details {
                padding: 1em;
            }

            .storyteller-track-details h4 {
                margin-top: 1em;
                margin-bottom: 0.5em;
                color: var(--text-accent);
            }

            .storyteller-empty-state {
                text-align: center;
                padding: 3em;
                color: var(--text-muted);
                font-style: italic;
            }
        `,this.contentEl.appendChild(e)}onClose(){let{contentEl:e}=this;e.empty()}}});var As,Qh,Tk=_e(()=>{As=require("obsidian");au();St();Qh=class extends As.Modal{constructor(e,r,n){super(e);this.selectedSeverity="all";this.selectedType="all";this.conflictListEl=null;this.locations=[];this.plugin=r,this.conflicts=n,this.filteredConflicts=n}async onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("storyteller-conflict-viewer"),this.locations=await this.plugin.listLocations(),e.createEl("h2",{text:"Timeline Conflicts"}),this.renderSummary(e),this.renderFilters(e),new As.Setting(e).setName("Export Report").setDesc("Generate a markdown report of all conflicts").addButton(n=>n.setButtonText("Export").onClick(()=>this.exportReport())),this.conflictListEl=e.createDiv({cls:"storyteller-conflict-list"}),this.renderConflictList(),new As.Setting(e).addButton(n=>n.setButtonText(w("close")||"Close").onClick(()=>this.close())),this.addStyles()}renderSummary(e){let r=e.createDiv({cls:"storyteller-conflict-summary"}),n=this.conflicts.filter(l=>l.severity==="error"),s=this.conflicts.filter(l=>l.severity==="warning"),o=this.conflicts.filter(l=>l.severity==="info");r.createEl("div",{text:`Total: ${this.conflicts.length}`,cls:"storyteller-conflict-stat"}),n.length>0&&r.createEl("div",{text:`Errors: ${n.length}`,cls:"storyteller-conflict-stat storyteller-conflict-error"}),s.length>0&&r.createEl("div",{text:`Warnings: ${s.length}`,cls:"storyteller-conflict-stat storyteller-conflict-warning"}),o.length>0&&r.createEl("div",{text:`Info: ${o.length}`,cls:"storyteller-conflict-stat storyteller-conflict-info"}),this.conflicts.length===0&&r.createEl("div",{text:"\u2713 No conflicts detected",cls:"storyteller-conflict-none"})}renderFilters(e){let r=e.createDiv({cls:"storyteller-conflict-filters"});new As.Setting(r).setName("Filter by Severity").addDropdown(n=>{n.addOption("all","All").addOption("error","Errors Only").addOption("warning","Warnings Only").addOption("info","Info Only").setValue(this.selectedSeverity).onChange(s=>{this.selectedSeverity=s,this.applyFilters()})}),new As.Setting(r).setName("Filter by Type").addDropdown(n=>{n.addOption("all","All Types").addOption("location","Location Conflicts").addOption("character","Character Conflicts").addOption("temporal","Temporal Conflicts").addOption("dependency","Dependency Conflicts").setValue(this.selectedType).onChange(s=>{this.selectedType=s,this.applyFilters()})})}applyFilters(){let e=this.conflicts;this.selectedSeverity!=="all"&&(e=Vr.getConflictsBySeverity(this.selectedSeverity,e)),this.selectedType!=="all"&&(e=Vr.getConflictsByType(this.selectedType,e)),this.filteredConflicts=e,this.renderConflictList()}renderConflictList(){if(!this.conflictListEl)return;if(this.conflictListEl.empty(),this.filteredConflicts.length===0){this.conflictListEl.createDiv({text:"No conflicts match the selected filters.",cls:"storyteller-empty-state"});return}let e=this.groupConflictsByType(this.filteredConflicts);for(let[r,n]of Object.entries(e)){if(n.length===0)continue;let s=this.conflictListEl.createDiv({cls:"storyteller-conflict-type-section"});s.createEl("h3",{text:`${this.capitalize(r)} Conflicts (${n.length})`}),n.forEach(o=>{this.renderConflict(s,o)})}}renderConflict(e,r){let n=e.createDiv({cls:`storyteller-conflict-item storyteller-conflict-${r.severity}`}),s=n.createDiv({cls:"storyteller-conflict-header"}),o=s.createSpan({text:r.severity.toUpperCase(),cls:`storyteller-conflict-badge storyteller-conflict-badge-${r.severity}`}),l=s.createSpan({text:r.message,cls:"storyteller-conflict-message"}),c=n.createDiv({cls:"storyteller-conflict-details"});if(r.character&&c.createEl("div",{text:`Character: ${r.character}`,cls:"storyteller-conflict-detail"}),r.details.description&&c.createEl("div",{text:r.details.description,cls:"storyteller-conflict-description"}),r.events.length>0){let u=c.createDiv({cls:"storyteller-conflict-events"});u.createEl("strong",{text:"Involved Events:"});let d=u.createEl("ul");r.events.forEach(h=>{let f=d.createEl("li");f.createEl("a",{text:h.name,cls:"storyteller-conflict-event-link"}).addEventListener("click",()=>{this.openEvent(h)}),h.dateTime&&f.createSpan({text:` (${h.dateTime})`,cls:"storyteller-conflict-event-date"}),h.location&&f.createSpan({text:` @ ${this.resolveLocationName(h.location)}`,cls:"storyteller-conflict-event-location"})})}if(r.details.timeOverlap){let u=r.details.timeOverlap;c.createEl("div",{text:`Overlap: ${u.start.toLocaleString()} - ${u.end.toLocaleString()}`,cls:"storyteller-conflict-overlap"})}if(r.details.locations&&r.details.locations.length>0){let u=r.details.locations.map(d=>this.resolveLocationName(d));c.createEl("div",{text:`Locations: ${u.join(", ")}`,cls:"storyteller-conflict-locations"})}}groupConflictsByType(e){return{location:e.filter(r=>r.type==="location"),character:e.filter(r=>r.type==="character"),temporal:e.filter(r=>r.type==="temporal"),dependency:e.filter(r=>r.type==="dependency")}}capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}resolveLocationName(e){let r=this.locations.find(s=>s.id===e);if(r)return r.name;let n=this.locations.find(s=>s.name===e);return n?n.name:e}async openEvent(e){this.close(),this.app.vault.getAbstractFileByPath(e.filePath||"")?await this.app.workspace.openLinkText(e.filePath||"","",!1):new As.Notice(`Could not find file for event: ${e.name}`)}async exportReport(){let e=Vr.generateConflictReport(this.conflicts),r=`Timeline Conflict Report ${new Date().toISOString().split("T")[0]}.md`,n=`${r}`;try{await this.app.vault.create(n,e),new As.Notice(`Conflict report exported to ${r}`)}catch(s){new As.Notice(`Failed to export report: ${s}`)}}addStyles(){let e=document.createElement("style");e.textContent=`
            .storyteller-conflict-viewer {
                padding: 1em;
                max-width: 800px;
            }

            .storyteller-conflict-summary {
                display: flex;
                gap: 1em;
                margin-bottom: 1.5em;
                padding: 1em;
                background: var(--background-secondary);
                border-radius: 6px;
                flex-wrap: wrap;
            }

            .storyteller-conflict-stat {
                padding: 0.5em 1em;
                border-radius: 4px;
                background: var(--background-primary);
                font-weight: 600;
            }

            .storyteller-conflict-error {
                color: var(--text-error);
                border-left: 3px solid var(--text-error);
            }

            .storyteller-conflict-warning {
                color: var(--text-warning);
                border-left: 3px solid var(--text-warning);
            }

            .storyteller-conflict-info {
                color: var(--text-accent);
                border-left: 3px solid var(--text-accent);
            }

            .storyteller-conflict-none {
                color: var(--text-success);
                font-weight: 600;
                width: 100%;
                text-align: center;
                padding: 1em;
            }

            .storyteller-conflict-filters {
                margin-bottom: 1.5em;
            }

            .storyteller-conflict-list {
                max-height: 60vh;
                overflow-y: auto;
            }

            .storyteller-conflict-type-section {
                margin-bottom: 2em;
            }

            .storyteller-conflict-type-section h3 {
                margin-bottom: 1em;
                color: var(--text-accent);
            }

            .storyteller-conflict-item {
                border: 1px solid var(--background-modifier-border);
                border-radius: 6px;
                margin-bottom: 1em;
                padding: 1em;
                background: var(--background-secondary);
            }

            .storyteller-conflict-item.storyteller-conflict-error {
                border-left: 4px solid var(--text-error);
            }

            .storyteller-conflict-item.storyteller-conflict-warning {
                border-left: 4px solid var(--text-warning);
            }

            .storyteller-conflict-item.storyteller-conflict-info {
                border-left: 4px solid var(--text-accent);
            }

            .storyteller-conflict-header {
                display: flex;
                align-items: center;
                gap: 0.75em;
                margin-bottom: 0.75em;
            }

            .storyteller-conflict-badge {
                padding: 0.25em 0.5em;
                border-radius: 3px;
                font-size: 0.75em;
                font-weight: 700;
                letter-spacing: 0.5px;
            }

            .storyteller-conflict-badge-error {
                background: var(--text-error);
                color: white;
            }

            .storyteller-conflict-badge-warning {
                background: var(--text-warning);
                color: var(--text-on-accent);
            }

            .storyteller-conflict-badge-info {
                background: var(--text-accent);
                color: var(--text-on-accent);
            }

            .storyteller-conflict-message {
                font-weight: 600;
                flex: 1;
            }

            .storyteller-conflict-details {
                margin-left: 0.5em;
                color: var(--text-muted);
            }

            .storyteller-conflict-detail,
            .storyteller-conflict-description,
            .storyteller-conflict-overlap,
            .storyteller-conflict-locations {
                margin-bottom: 0.5em;
                font-size: 0.9em;
            }

            .storyteller-conflict-events {
                margin-top: 0.75em;
            }

            .storyteller-conflict-events ul {
                margin-top: 0.5em;
                margin-left: 1.5em;
            }

            .storyteller-conflict-events li {
                margin-bottom: 0.25em;
            }

            .storyteller-conflict-event-link {
                cursor: pointer;
                color: var(--link-color);
                text-decoration: none;
            }

            .storyteller-conflict-event-link:hover {
                text-decoration: underline;
            }

            .storyteller-conflict-event-date,
            .storyteller-conflict-event-location {
                font-size: 0.85em;
                color: var(--text-muted);
            }

            .storyteller-empty-state {
                text-align: center;
                padding: 3em;
                color: var(--text-muted);
                font-style: italic;
            }
        `,this.contentEl.appendChild(e)}onClose(){let{contentEl:e}=this;e.empty()}}});var I0,ef,Dz=_e(()=>{I0=require("obsidian");nh();OC();ef=class{constructor(t){this.app=t}async generateFromTags(t){let e=this.app.vault.getMarkdownFiles(),r=[];for(let n of e){let s=await this.processFile(n,t);s&&r.push(s)}return r}async processFile(t,e){let r=await this.app.vault.read(t),n=this.app.metadataCache.getFileCache(t),s=n?(0,I0.getAllTags)(n)||[]:[];if(!(e.tags.length===0||s.some(v=>e.tags.includes(v))))return null;let l=[],c=null,u="",d=0;switch(e.dateStrategy){case"frontmatter":let v=this.extractDateFromFrontmatter(n,e.dateFrontmatterField);c=v.date,u=v.method,d=v.confidence,c||l.push("No date found in frontmatter");break;case"content":let E=this.extractDateFromContent(r,e.datePatterns);c=E.date,u=E.method,d=E.confidence,c||l.push("No date found in content");break;case"file-created":c=new Date(t.stat.ctime).toISOString(),u="File creation date",d=.7;break;case"file-modified":c=new Date(t.stat.mtime).toISOString(),u="File modification date",d=.5;break;case"auto":default:let C=this.extractDateAuto(t,n,r,e);c=C.date,u=C.method,d=C.confidence,c||l.push("Could not extract date using any method");break}let h=t.basename,f="";e.includeContent&&(f=this.extractDescription(r,e.maxContentLength));let m=this.extractCharacters(n,r),g=this.extractLocation(n,r);return{event:{name:h,dateTime:c||void 0,description:f,characters:m,location:g,tags:s.map(v=>v.replace("#","")),status:e.defaultStatus||"Generated"},sourceFile:t,extractionMethod:u,confidence:d,warnings:l}}extractDateFromFrontmatter(t,e="date"){if(!(t!=null&&t.frontmatter))return{date:null,method:"",confidence:0};let r=t.frontmatter;if(r[e])return{date:r[e],method:`Frontmatter field: ${e}`,confidence:1};let n=["date","created","datetime","time","when","eventDate"];for(let s of n)if(r[s])return{date:r[s],method:`Frontmatter field: ${s}`,confidence:.9};return{date:null,method:"",confidence:0}}extractDateFromContent(t,e){if(e&&e.length>0)for(let n of e){let s=t.match(n);if(s&&s[1])return{date:s[1],method:`Custom pattern: ${n.source}`,confidence:.8}}let r=[/Date:\s*(.+)/i,/When:\s*(.+)/i,/On\s+(.+?),/i,/(\d{4}-\d{2}-\d{2})/,/(\d{1,2}\/\d{1,2}\/\d{4})/];for(let n of r){let s=t.match(n);if(s&&s[1])return{date:s[1].trim(),method:`Content pattern: ${n.source}`,confidence:.7}}try{let n=rh(t,new Date,{forwardDate:!0});if(n.length>0){let s=n[0];return{date:s.start.date().toISOString(),method:`Natural language parsing: "${s.text}"`,confidence:.6}}}catch(n){}return{date:null,method:"",confidence:0}}extractDateAuto(t,e,r,n){let s=this.extractDateFromFrontmatter(e,n.dateFrontmatterField);if(s.date)return s;let o=this.extractDateFromContent(r,n.datePatterns);return o.date?o:{date:new Date(t.stat.ctime).toISOString(),method:"File creation date (fallback)",confidence:.4}}extractDescription(t,e=500){let r=t.replace(/^---[\s\S]*?---\s*/m,"");return r=r.replace(/^#+\s+.+$/gm,""),r=r.trim().substring(0,e),t.length>e&&(r+="..."),r.trim()}extractCharacters(t,e){var o;if((o=t==null?void 0:t.frontmatter)!=null&&o.characters){if(Array.isArray(t.frontmatter.characters))return t.frontmatter.characters;if(typeof t.frontmatter.characters=="string")return t.frontmatter.characters.split(",").map(l=>l.trim())}let r=/\[\[([^\]]+)\]\]/g,n=e.matchAll(r),s=new Set;for(let l of n){let c=l[1];c&&c[0]===c[0].toUpperCase()&&s.add(c)}return s.size>0?Array.from(s):void 0}extractLocation(t,e){var s;if((s=t==null?void 0:t.frontmatter)!=null&&s.location)return t.frontmatter.location;let r=/(?:Location|Place|Where):\s*(.+)/i,n=e.match(r);if(n&&n[1])return n[1].trim()}static validateGeneratedEvents(t){let e=[],r=[];for(let n of t){let s=[];if((!n.event.name||n.event.name.trim()==="")&&s.push("Event name is required"),n.event.dateTime){let o=Pt(n.event.dateTime);o.error&&s.push(`Invalid date: ${o.error}`)}s.length>0?r.push({preview:n,errors:s}):e.push(n)}return{valid:e,invalid:r}}async getAllTags(){let t=this.app.vault.getMarkdownFiles(),e=new Set;for(let r of t){let n=this.app.metadataCache.getFileCache(r);(n?(0,I0.getAllTags)(n)||[]:[]).forEach(o=>e.add(o))}return Array.from(e).sort()}async getTagStatistics(){let t=this.app.vault.getMarkdownFiles(),e=new Map;for(let r of t){let n=this.app.metadataCache.getFileCache(r);(n?(0,I0.getAllTags)(n)||[]:[]).forEach(o=>{e.set(o,(e.get(o)||0)+1)})}return e}}});var Li,tf,Ck=_e(()=>{Li=require("obsidian");Dz();St();tf=class extends Li.Modal{constructor(e,r){super(e);this.selectedTags=[];this.previews=[];this.previewListEl=null;this.locations=[];this.options={tags:[],dateStrategy:"auto",dateFrontmatterField:"date",includeContent:!0,maxContentLength:500,defaultStatus:"Generated"};this.plugin=r,this.generator=new ef(e)}async onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("storyteller-tag-timeline-generator"),this.locations=await this.plugin.listLocations(),e.createEl("h2",{text:"Generate Timeline from Tags"}),e.createDiv({text:"Automatically create timeline events from notes with specific tags. Events will be extracted based on your chosen date strategy.",cls:"storyteller-tag-timeline-desc"}),await this.renderOptions(e),new Li.Setting(e).setName("Generate Preview").setDesc("Scan notes and preview events that will be created").addButton(s=>s.setButtonText("Generate").setCta().onClick(()=>this.generatePreview()));let r=e.createDiv({cls:"storyteller-tag-timeline-preview-section"});r.createEl("h3",{text:"Preview"}),this.previewListEl=r.createDiv({cls:"storyteller-tag-timeline-preview-list"}),this.renderPreviewList();let n=new Li.Setting(e);n.addButton(s=>s.setButtonText("Create Events").setCta().setDisabled(this.previews.length===0).onClick(()=>this.createEvents())),n.addButton(s=>s.setButtonText(w("cancel")||"Cancel").onClick(()=>this.close())),this.addStyles()}async renderOptions(e){let r=e.createDiv({cls:"storyteller-tag-timeline-options"});r.createEl("h3",{text:"Options"});let n=await this.generator.getAllTags(),s=await this.generator.getTagStatistics();if(new Li.Setting(r).setName("Tags to Include").setDesc("Select tags to filter notes (leave empty for all tags)").addText(o=>{o.setPlaceholder("Enter tags (comma-separated)").onChange(l=>{this.selectedTags=l.split(",").map(c=>c.trim()).filter(c=>c.length>0),this.options.tags=this.selectedTags})}),n.length>0){let o=r.createDiv({cls:"storyteller-tag-list"});o.createEl("small",{text:"Available tags:"});let l=o.createDiv({cls:"storyteller-tag-chips"});n.slice(0,20).forEach(c=>{let u=s.get(c)||0,d=l.createSpan({text:`${c} (${u})`,cls:"storyteller-tag-chip"});d.addEventListener("click",()=>{this.selectedTags.includes(c)||(this.selectedTags.push(c),this.options.tags=this.selectedTags,d.addClass("storyteller-tag-chip-selected"))})}),n.length>20&&o.createEl("small",{text:`... and ${n.length-20} more`})}new Li.Setting(r).setName("Date Extraction Strategy").setDesc("How to extract dates from notes").addDropdown(o=>{o.addOption("auto","Auto (try all methods)").addOption("frontmatter","From Frontmatter").addOption("content","From Content").addOption("file-created","File Creation Date").addOption("file-modified","File Modification Date").setValue(this.options.dateStrategy).onChange(l=>{this.options.dateStrategy=l})}),new Li.Setting(r).setName("Frontmatter Date Field").setDesc("Field name to extract date from (when using frontmatter strategy)").addText(o=>{o.setValue(this.options.dateFrontmatterField||"date").setPlaceholder("date").onChange(l=>{this.options.dateFrontmatterField=l})}),new Li.Setting(r).setName("Include Note Content").setDesc("Add note content as event description").addToggle(o=>{o.setValue(this.options.includeContent||!1).onChange(l=>{this.options.includeContent=l})}),new Li.Setting(r).setName("Max Description Length").setDesc("Maximum characters for event description").addText(o=>{o.setValue(String(this.options.maxContentLength||500)).setPlaceholder("500").onChange(l=>{this.options.maxContentLength=parseInt(l)||500}),o.inputEl.type="number"}),new Li.Setting(r).setName("Default Status").setDesc("Status for generated events").addText(o=>{o.setValue(this.options.defaultStatus||"Generated").setPlaceholder("Generated").onChange(l=>{this.options.defaultStatus=l})})}resolveLocationName(e){let r=this.locations.find(s=>s.id===e);if(r)return r.name;let n=this.locations.find(s=>s.name===e);return n?n.name:e}async generatePreview(){new Li.Notice("Scanning notes for tags...");try{this.previews=await this.generator.generateFromTags(this.options),this.previews.length===0?new Li.Notice("No notes found with the selected tags"):new Li.Notice(`Found ${this.previews.length} potential events`),this.renderPreviewList();let e=this.contentEl.querySelector("button.mod-cta");e&&(e.disabled=this.previews.length===0)}catch(e){new Li.Notice(`Error generating preview: ${e}`),console.error("Tag timeline generation error:",e)}}renderPreviewList(){if(!this.previewListEl)return;if(this.previewListEl.empty(),this.previews.length===0){this.previewListEl.createDiv({text:'No events to preview. Click "Generate Preview" to scan your notes.',cls:"storyteller-empty-state"});return}let{valid:e,invalid:r}=ef.validateGeneratedEvents(this.previews),n=this.previewListEl.createDiv({cls:"storyteller-preview-summary"});n.createDiv({text:`Valid: ${e.length}`,cls:"storyteller-preview-stat storyteller-preview-valid"}),r.length>0&&n.createDiv({text:`Invalid: ${r.length}`,cls:"storyteller-preview-stat storyteller-preview-invalid"}),e.forEach(s=>{this.renderPreviewItem(s,!0)}),r.forEach(({preview:s,errors:o})=>{this.renderPreviewItem(s,!1,o)})}renderPreviewItem(e,r,n){if(!this.previewListEl)return;let s=this.previewListEl.createDiv({cls:`storyteller-preview-item ${r?"valid":"invalid"}`}),o=s.createDiv({cls:"storyteller-preview-header"});r||o.createSpan({text:"\u26A0",cls:"storyteller-preview-warning"}),o.createSpan({text:e.event.name||"Untitled",cls:"storyteller-preview-name"});let l=Math.round((e.confidence||0)*100),c=l>=80?"high":l>=50?"medium":"low";o.createSpan({text:`${l}%`,cls:`storyteller-preview-confidence storyteller-confidence-${c}`});let u=s.createDiv({cls:"storyteller-preview-details"});if(e.event.dateTime&&u.createDiv({text:`Date: ${e.event.dateTime}`,cls:"storyteller-preview-detail"}),u.createDiv({text:`Source: ${e.sourceFile.path}`,cls:"storyteller-preview-detail storyteller-preview-source"}),u.createDiv({text:`Method: ${e.extractionMethod}`,cls:"storyteller-preview-detail storyteller-preview-method"}),e.event.characters&&e.event.characters.length>0&&u.createDiv({text:`Characters: ${e.event.characters.join(", ")}`,cls:"storyteller-preview-detail"}),e.event.location&&u.createDiv({text:`Location: ${this.resolveLocationName(e.event.location)}`,cls:"storyteller-preview-detail"}),e.event.tags&&e.event.tags.length>0&&u.createDiv({text:`Tags: ${e.event.tags.join(", ")}`,cls:"storyteller-preview-detail"}),e.warnings.length>0){let d=u.createDiv({cls:"storyteller-preview-warnings"});e.warnings.forEach(h=>{d.createDiv({text:`\u26A0 ${h}`,cls:"storyteller-preview-warning-item"})})}if(n&&n.length>0){let d=u.createDiv({cls:"storyteller-preview-errors"});n.forEach(h=>{d.createDiv({text:`\u274C ${h}`,cls:"storyteller-preview-error-item"})})}}async createEvents(){let{valid:e}=ef.validateGeneratedEvents(this.previews);if(e.length===0){new Li.Notice("No valid events to create");return}new Li.Notice(`Creating ${e.length} events...`);let r=0,n=0;for(let s of e)try{let o={id:void 0,name:s.event.name||"Untitled",dateTime:s.event.dateTime,description:s.event.description,characters:s.event.characters,location:s.event.location,tags:s.event.tags,status:s.event.status,customFields:{generatedFrom:s.sourceFile.path,generationMethod:s.extractionMethod,generationConfidence:String(Math.round((s.confidence||0)*100))}};await this.plugin.saveEvent(o),r++}catch(o){console.error(`Failed to create event ${s.event.name}:`,o),n++}new Li.Notice(`Created ${r} events${n>0?`, ${n} failed`:""}`),this.close()}addStyles(){let e=document.createElement("style");e.textContent=`
            .storyteller-tag-timeline-generator {
                padding: 1em;
                max-width: 900px;
            }

            .storyteller-tag-timeline-desc {
                margin-bottom: 1.5em;
                color: var(--text-muted);
                font-size: 0.9em;
            }

            .storyteller-tag-timeline-options h3,
            .storyteller-tag-timeline-preview-section h3 {
                margin-top: 1.5em;
                margin-bottom: 1em;
                color: var(--text-accent);
            }

            .storyteller-tag-list {
                margin-top: 0.5em;
                padding: 0.75em;
                background: var(--background-secondary);
                border-radius: 4px;
            }

            .storyteller-tag-chips {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5em;
                margin-top: 0.5em;
            }

            .storyteller-tag-chip {
                padding: 0.25em 0.75em;
                background: var(--background-modifier-border);
                border-radius: 12px;
                cursor: pointer;
                font-size: 0.85em;
                transition: all 0.2s;
            }

            .storyteller-tag-chip:hover {
                background: var(--interactive-accent);
                color: var(--text-on-accent);
            }

            .storyteller-tag-chip-selected {
                background: var(--interactive-accent);
                color: var(--text-on-accent);
            }

            .storyteller-tag-timeline-preview-list {
                max-height: 50vh;
                overflow-y: auto;
                margin-top: 1em;
            }

            .storyteller-preview-summary {
                display: flex;
                gap: 1em;
                margin-bottom: 1em;
                padding: 0.75em;
                background: var(--background-secondary);
                border-radius: 6px;
            }

            .storyteller-preview-stat {
                padding: 0.5em 1em;
                border-radius: 4px;
                background: var(--background-primary);
                font-weight: 600;
            }

            .storyteller-preview-valid {
                color: var(--text-success);
                border-left: 3px solid var(--text-success);
            }

            .storyteller-preview-invalid {
                color: var(--text-error);
                border-left: 3px solid var(--text-error);
            }

            .storyteller-preview-item {
                border: 1px solid var(--background-modifier-border);
                border-radius: 6px;
                margin-bottom: 1em;
                padding: 1em;
                background: var(--background-secondary);
            }

            .storyteller-preview-item.valid {
                border-left: 3px solid var(--text-success);
            }

            .storyteller-preview-item.invalid {
                border-left: 3px solid var(--text-error);
                opacity: 0.7;
            }

            .storyteller-preview-header {
                display: flex;
                align-items: center;
                gap: 0.75em;
                margin-bottom: 0.75em;
            }

            .storyteller-preview-warning {
                font-size: 1.2em;
            }

            .storyteller-preview-name {
                flex: 1;
                font-weight: 600;
                font-size: 1.1em;
            }

            .storyteller-preview-confidence {
                padding: 0.25em 0.5em;
                border-radius: 3px;
                font-size: 0.85em;
                font-weight: 600;
            }

            .storyteller-confidence-high {
                background: var(--text-success);
                color: white;
            }

            .storyteller-confidence-medium {
                background: var(--text-warning);
                color: var(--text-on-accent);
            }

            .storyteller-confidence-low {
                background: var(--text-error);
                color: white;
            }

            .storyteller-preview-details {
                margin-left: 0.5em;
                font-size: 0.9em;
            }

            .storyteller-preview-detail {
                margin-bottom: 0.35em;
                color: var(--text-muted);
            }

            .storyteller-preview-source {
                font-style: italic;
            }

            .storyteller-preview-method {
                font-family: var(--font-monospace);
                font-size: 0.85em;
            }

            .storyteller-preview-warnings,
            .storyteller-preview-errors {
                margin-top: 0.75em;
                padding-top: 0.75em;
                border-top: 1px solid var(--background-modifier-border);
            }

            .storyteller-preview-warning-item {
                color: var(--text-warning);
                margin-bottom: 0.25em;
            }

            .storyteller-preview-error-item {
                color: var(--text-error);
                margin-bottom: 0.25em;
                font-weight: 600;
            }

            .storyteller-empty-state {
                text-align: center;
                padding: 3em;
                color: var(--text-muted);
                font-style: italic;
            }
        `,this.contentEl.appendChild(e)}onClose(){let{contentEl:e}=this;e.empty()}}});var nn,A0,Pz=_e(()=>{nn=require("obsidian");xm();A0=class extends nn.Modal{constructor(t,e,r,n,s){super(t),this.plugin=e,this.isNew=r===null;let o=r?{...r}:{id:`era-${Date.now()}`,name:"",description:"",startDate:"",endDate:"",color:tn.generateEraColor(),type:"custom",visible:!0,sortOrder:0,events:[],tags:[]};this.era=o,this.onSubmit=n,this.onDelete=s,this.modalEl.addClass("storyteller-era-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?"Create Timeline Era":`Edit Era: ${this.era.name}`}),new nn.Setting(t).setName("Era Name").setDesc("Name of this period, arc, or act").addText(n=>n.setPlaceholder('e.g., "Act I: Rising Action", "Medieval Period"').setValue(this.era.name).onChange(s=>{this.era.name=s}).inputEl.addClass("storyteller-modal-input-large")),new nn.Setting(t).setName("Start Date").setDesc("When this era begins (supports flexible formats like events)").addText(n=>n.setPlaceholder('e.g., "1200-01-01", "January 1200", "500 BCE"').setValue(this.era.startDate).onChange(s=>{this.era.startDate=s})),new nn.Setting(t).setName("End Date").setDesc("When this era ends").addText(n=>n.setPlaceholder('e.g., "1300-12-31", "December 1300"').setValue(this.era.endDate).onChange(s=>{this.era.endDate=s})),new nn.Setting(t).setName("Era Type").setDesc("Category of this era").addDropdown(n=>{n.addOption("custom","Custom").addOption("act","Act").addOption("arc","Story Arc").addOption("period","Historical Period").addOption("season","Season").addOption("chapter","Chapter Range").setValue(this.era.type||"custom").onChange(s=>{this.era.type=s})});let e;if(new nn.Setting(t).setName("Background Color").setDesc("Color for timeline visualization").addColorPicker(n=>{e=n,n.setValue(this.era.color||tn.generateEraColor()).onChange(s=>{this.era.color=s})}).addButton(n=>n.setButtonText("Random").setTooltip("Generate random color").onClick(()=>{let s=tn.generateEraColor();this.era.color=s,e&&e.setValue(s),new nn.Notice(`Color set to ${s}`)})),new nn.Setting(t).setName("Description").setDesc("What defines this era or period").setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setPlaceholder("Describe what happens during this era...").setValue(this.era.description||"").onChange(s=>{this.era.description=s||void 0}),n.inputEl.rows=3,n.inputEl.addClass("storyteller-modal-textarea")}),new nn.Setting(t).setName("Visible on Timeline").setDesc("Show this era on the timeline").addToggle(n=>n.setValue(this.era.visible!==!1).onChange(s=>{this.era.visible=s})),new nn.Setting(t).setName("Sort Order").setDesc("Lower numbers appear first (optional, defaults to start date)").addText(n=>{var s;return n.setPlaceholder("0").setValue(((s=this.era.sortOrder)==null?void 0:s.toString())||"").onChange(o=>{let l=parseInt(o);this.era.sortOrder=isNaN(l)?void 0:l}).inputEl.setAttribute("type","number")}),this.era.startDate&&this.era.endDate&&tn.validateEra(this.era).valid){let s=tn.getEraDuration(this.era);t.createDiv("storyteller-era-duration",o=>{o.createEl("strong",{text:"Duration: "}),o.createSpan({text:s})})}let r=t.createDiv("storyteller-modal-buttons");!this.isNew&&this.onDelete&&r.createEl("button",{text:"Delete Era",cls:"mod-warning"},n=>{n.addEventListener("click",async()=>{await new Promise(o=>{let l=new nn.Modal(this.app);l.contentEl.createEl("h3",{text:"Delete Era?"}),l.contentEl.createEl("p",{text:`Are you sure you want to delete "${this.era.name}"? This action cannot be undone.`});let c=l.contentEl.createDiv("modal-button-container");c.createEl("button",{text:"Cancel"},u=>{u.addEventListener("click",()=>{o(!1),l.close()})}),c.createEl("button",{text:"Delete",cls:"mod-warning"},u=>{u.addEventListener("click",()=>{o(!0),l.close()})}),l.open()})&&this.onDelete&&(await this.onDelete(this.era),this.close())})}),r.createEl("button",{text:"Cancel"},n=>{n.addEventListener("click",()=>{this.close()})}),r.createEl("button",{text:this.isNew?"Create Era":"Save Changes",cls:"mod-cta"},n=>{n.addEventListener("click",async()=>{let s=tn.validateEra(this.era);if(!s.valid){new nn.Notice(`Validation failed:
${s.errors.join(`
`)}`);return}try{await this.onSubmit(this.era),new nn.Notice(`Era "${this.era.name}" ${this.isNew?"created":"updated"} successfully`),this.close()}catch(o){console.error("Error saving era:",o),new nn.Notice("Error saving era. Check console for details.")}})})}onClose(){let{contentEl:t}=this;t.empty()}}});var O0={};At(O0,{EraListModal:()=>Sk});var _k,Sk,F0=_e(()=>{_k=require("obsidian");Pz();xm();Sk=class extends _k.Modal{constructor(t,e){super(t),this.plugin=e,this.eras=e.settings.timelineEras||[],this.modalEl.addClass("storyteller-era-list-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Timeline Eras & Periods"}),t.createEl("p",{text:"Organize your timeline into acts, arcs, or historical periods. Eras display as colored backgrounds on the timeline.",cls:"storyteller-modal-description"});let e=t.createDiv("storyteller-list-header");e.createEl("button",{text:"+ Create New Era",cls:"mod-cta"},n=>{n.addEventListener("click",()=>{this.openEraModal(null)})}),e.createEl("span",{text:`${this.eras.length} era${this.eras.length!==1?"s":""}`,cls:"storyteller-list-count"}),this.listContainer=t.createDiv("storyteller-era-list"),this.renderEraList(),t.createDiv("storyteller-modal-buttons").createEl("button",{text:"Close"},n=>{n.addEventListener("click",()=>{this.close()})})}renderEraList(){if(this.listContainer.empty(),this.eras.length===0){this.listContainer.createEl("p",{text:'No eras created yet. Click "Create New Era" to get started.',cls:"storyteller-empty-state"});return}let t=tn.getVisibleEras([...this.eras,...this.eras.filter(e=>e.visible===!1)]);for(let e of t){let r=this.listContainer.createDiv("storyteller-era-card"),n=r.createDiv("storyteller-era-color-bar");e.color&&(n.style.backgroundColor=e.color);let s=r.createDiv("storyteller-era-content"),o=s.createDiv("storyteller-era-header");o.createEl("h3",{text:e.name}),e.visible||o.createEl("span",{text:"(Hidden)",cls:"storyteller-era-hidden-badge"}),e.type&&e.type!=="custom"&&o.createEl("span",{text:e.type.charAt(0).toUpperCase()+e.type.slice(1),cls:"storyteller-era-type-badge"}),s.createDiv("storyteller-era-dates",d=>{d.createEl("strong",{text:"Period: "}),d.createSpan({text:`${e.startDate} \u2192 ${e.endDate}`})});let l=tn.validateEra(e);l.valid?s.createDiv("storyteller-era-duration",d=>{d.createEl("strong",{text:"Duration: "}),d.createSpan({text:tn.getEraDuration(e)})}):s.createDiv("storyteller-era-error",d=>{d.createEl("strong",{text:"\u26A0\uFE0F Invalid: "}),d.createSpan({text:l.errors.join(", ")})}),e.description&&s.createDiv("storyteller-era-description",d=>{let h=e.description&&e.description.length>100?e.description.slice(0,100)+"...":e.description||"";d.createSpan({text:h})}),(this.plugin.listEvents?(async()=>{let d=await this.plugin.listEvents();return tn.getEventsInEra(e,d)})():Promise.resolve([])).then(d=>{s.createDiv("storyteller-era-events",h=>{h.createEl("strong",{text:"Events: "}),h.createSpan({text:d.length.toString()})})});let u=s.createDiv("storyteller-era-actions");u.createEl("button",{text:"Edit",cls:"storyteller-era-action-btn"},d=>{d.addEventListener("click",()=>{this.openEraModal(e)})}),u.createEl("button",{text:e.visible===!1?"Show":"Hide",cls:"storyteller-era-action-btn"},d=>{d.addEventListener("click",async()=>{e.visible=e.visible===!1,await this.plugin.updateTimelineEra(e),this.renderEraList()})}),u.createEl("button",{text:"Delete",cls:"storyteller-era-action-btn mod-warning"},d=>{d.addEventListener("click",async()=>{await this.confirmDelete(e.name)&&(await this.plugin.deleteTimelineEra(e.id),this.eras=this.plugin.settings.timelineEras||[],this.renderEraList())})})}}openEraModal(t){new A0(this.app,this.plugin,t,async r=>{t?await this.plugin.updateTimelineEra(r):await this.plugin.createTimelineEra(r),this.eras=this.plugin.settings.timelineEras||[],this.renderEraList()},async r=>{await this.plugin.deleteTimelineEra(r.id),this.eras=this.plugin.settings.timelineEras||[],this.renderEraList()}).open()}async confirmDelete(t){return new Promise(e=>{let r=new _k.Modal(this.app);r.contentEl.createEl("h3",{text:"Delete Era?"}),r.contentEl.createEl("p",{text:`Are you sure you want to delete "${t}"? This action cannot be undone.`});let n=r.contentEl.createDiv("modal-button-container");n.createEl("button",{text:"Cancel"},s=>{s.addEventListener("click",()=>{e(!1),r.close()})}),n.createEl("button",{text:"Delete",cls:"mod-warning"},s=>{s.addEventListener("click",()=>{e(!0),r.close()})}),r.open()})}onClose(){let{contentEl:t}=this;t.empty()}}});var Yr,nc,xk=_e(()=>{Yr=require("obsidian");St();Ek();Tk();Ck();au();nc=class{constructor(t,e,r){this.plugin=t,this.state=e,this.callbacks=r}static createDefaultState(t){var e,r;return{ganttMode:!1,groupMode:t.settings.defaultTimelineGroupMode||"none",filters:{},stackEnabled:(e=t.settings.defaultTimelineStack)!=null?e:!0,density:(r=t.settings.defaultTimelineDensity)!=null?r:50,editMode:!1,showEras:!1,narrativeOrder:!1}}createGanttToggle(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":this.state.ganttMode?w("timelineView"):w("ganttView"),title:this.state.ganttMode?w("timelineView"):w("ganttView")}});return(0,Yr.setIcon)(e,this.state.ganttMode?"bar-chart-2":"clock"),e.addEventListener("click",()=>{var n;this.state.ganttMode=!this.state.ganttMode,(0,Yr.setIcon)(e,this.state.ganttMode?"bar-chart-2":"clock"),e.setAttribute("aria-label",this.state.ganttMode?w("timelineView"):w("ganttView")),e.setAttribute("title",this.state.ganttMode?w("timelineView"):w("ganttView")),(n=this.callbacks.getRenderer())==null||n.setGanttMode(this.state.ganttMode);let r=t.closest(".storyteller-timeline-view");r&&(this.state.ganttMode?r.addClass("gantt-mode"):r.removeClass("gantt-mode")),this.callbacks.onStateChange()}),e}createGroupingDropdown(t){let r=t.createDiv("storyteller-grouping-container").createEl("select",{cls:"dropdown storyteller-grouping-select",attr:{"aria-label":"Grouping mode"}});return[{value:"none",label:w("noGrouping")},{value:"location",label:w("byLocation")},{value:"group",label:w("byGroup")},{value:"character",label:w("byCharacter")},{value:"track",label:"By Track"}].forEach(n=>{let s=r.createEl("option",{value:n.value,text:n.label});n.value===this.state.groupMode&&(s.selected=!0)}),r.addEventListener("change",()=>{var n;this.state.groupMode=r.value,(n=this.callbacks.getRenderer())==null||n.setGroupMode(this.state.groupMode),this.callbacks.onStateChange()}),r}createFitButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("fit"),title:w("fit")}});return(0,Yr.setIcon)(e,"maximize-2"),e.addEventListener("click",()=>{var r;return(r=this.callbacks.getRenderer())==null?void 0:r.fitToView()}),e}createDecadeButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("decade"),title:w("decade")}});return(0,Yr.setIcon)(e,"calendar"),e.addEventListener("click",()=>{var r;return(r=this.callbacks.getRenderer())==null?void 0:r.zoomPresetYears(10)}),e}createCenturyButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("century"),title:w("century")}});return(0,Yr.setIcon)(e,"calendar-days"),e.addEventListener("click",()=>{var r;return(r=this.callbacks.getRenderer())==null?void 0:r.zoomPresetYears(100)}),e}createTodayButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("today"),title:w("today")}});return(0,Yr.setIcon)(e,"calendar-clock"),e.addEventListener("click",()=>{var r;return(r=this.callbacks.getRenderer())==null?void 0:r.moveToToday()}),e}createEditModeToggle(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("editMode"),title:w("editModeTooltip")}});return(0,Yr.setIcon)(e,this.state.editMode?"pencil":"lock"),e.addEventListener("click",()=>{var r;this.state.editMode=!this.state.editMode,(0,Yr.setIcon)(e,this.state.editMode?"pencil":"lock"),(r=this.callbacks.getRenderer())==null||r.setEditMode(this.state.editMode),this.state.editMode?new Yr.Notice("Edit mode enabled - drag events to reschedule"):new Yr.Notice("Edit mode disabled")}),e}createNarrativeOrderToggle(t){let e=t.createEl("button",{cls:`clickable-icon storyteller-toolbar-btn${this.state.narrativeOrder?" is-active":""}`,attr:{"aria-label":"Toggle narrative order",title:this.state.narrativeOrder?"Show chronological order":"Show narrative order"}});return(0,Yr.setIcon)(e,"book-open"),e.addEventListener("click",()=>{var r;this.state.narrativeOrder=!this.state.narrativeOrder,e.toggleClass("is-active",this.state.narrativeOrder),e.setAttribute("title",this.state.narrativeOrder?"Show chronological order":"Show narrative order"),(r=this.callbacks.getRenderer())==null||r.setNarrativeOrder(this.state.narrativeOrder)}),e}createEraToggle(t){let e=t.createEl("button",{cls:`clickable-icon storyteller-toolbar-btn${this.state.showEras?" is-active":""}`,attr:{"aria-label":"Toggle era backgrounds",title:this.state.showEras?"Hide era backgrounds":"Show era backgrounds"}});return(0,Yr.setIcon)(e,"layers"),e.addEventListener("click",()=>{var r;this.state.showEras=!this.state.showEras,e.toggleClass("is-active",this.state.showEras),e.setAttribute("title",this.state.showEras?"Hide era backgrounds":"Show era backgrounds"),(r=this.callbacks.getRenderer())==null||r.setShowEras(this.state.showEras)}),e}createRefreshButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("refresh"),title:w("refresh")}});return(0,Yr.setIcon)(e,"refresh-cw"),e.addEventListener("click",async()=>{var r;await((r=this.callbacks.getRenderer())==null?void 0:r.refresh()),this.callbacks.onStateChange()}),e}addStackToggle(t){t.addToggle(e=>(e.setTooltip("Stack items").setValue(this.state.stackEnabled).onChange(r=>{this.state.stackEnabled=r,this.callbacks.onRendererUpdate()}),e))}createCopyRangeButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("copyRange")||"Copy range",title:w("copyRange")||"Copy range"}});return(0,Yr.setIcon)(e,"copy"),e.addEventListener("click",()=>{var n;let r=this.callbacks.getRenderer();if(r)try{let s=r.getVisibleRange();if(!s)return;let o=`Timeline range: ${s.start.toISOString()} \u2014 ${s.end.toISOString()}`;(n=navigator.clipboard)==null||n.writeText(o),new Yr.Notice(w("copyRange"))}catch(s){new Yr.Notice("Could not copy timeline range")}}),e}hasActiveFilters(){let t=this.state.filters;return t.characters&&t.characters.size>0||t.locations&&t.locations.size>0||t.groups&&t.groups.size>0||t.tags&&t.tags.size>0||t.milestonesOnly===!0}clearAllFilters(){var t;this.state.filters={},(t=this.callbacks.getRenderer())==null||t.applyFilters(this.state.filters),this.callbacks.onStateChange()}applyDefaultZoomPreset(){let t=this.callbacks.getRenderer();if(!t)return;let e=this.plugin.settings.defaultTimelineZoomPreset||"none";e==="fit"?t.fitToView():e==="decade"?t.zoomPresetYears(10):e==="century"&&t.zoomPresetYears(100)}getState(){return this.state}getPlugin(){return this.plugin}createManageTracksButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":"Manage timeline tracks",title:"Manage timeline tracks"}});return(0,Yr.setIcon)(e,"layers-2"),e.addEventListener("click",()=>{let r=this.plugin.settings.timelineTracks||[];new Jh(this.plugin.app,this.plugin,r,async n=>{this.plugin.settings.timelineTracks=n,await this.plugin.saveSettings(),this.callbacks.onRendererUpdate()}).open()}),e}createManageErasButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":"Manage timeline eras",title:"Manage timeline eras & periods"}});return(0,Yr.setIcon)(e,"calendar-range"),e.addEventListener("click",async()=>{let{EraListModal:r}=await Promise.resolve().then(()=>(F0(),O0));new r(this.plugin.app,this.plugin).open()}),e}createCheckConflictsButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":"Check timeline conflicts",title:"Detect timeline conflicts"}});return(0,Yr.setIcon)(e,"alert-triangle"),e.addEventListener("click",async()=>{let r=this.callbacks.getEvents(),n=Array.isArray(r)?r:await r,s=Vr.detectAllConflicts(n);new Qh(this.plugin.app,this.plugin,s).open();let o=s.filter(c=>c.severity==="error").length,l=s.filter(c=>c.severity==="warning").length;s.length===0?new Yr.Notice("\u2713 No timeline conflicts detected"):new Yr.Notice(`Found ${o} error(s), ${l} warning(s)`)}),e}createGenerateFromTagsButton(t){let e=t.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":"Generate timeline from tags",title:"Generate events from tagged notes"}});return(0,Yr.setIcon)(e,"hash"),e.addEventListener("click",()=>{new tf(this.plugin.app,this.plugin).open()}),e}}});var Ru,rf,kk=_e(()=>{Ru=require("obsidian");St();rf=class{constructor(t,e,r){this.locations=[];this.plugin=t,this.state=e,this.callbacks=r}async loadLocations(){this.locations=await this.plugin.listLocations()}resolveLocationName(t){let e=this.locations.find(n=>n.id===t);if(e)return e.name;let r=this.locations.find(n=>n.name===t);return r?r.name:t}createCharacterFilter(t,e){new Ru.Setting(t).setName(w("filterByCharacter")).addDropdown(r=>{r.addOption("",w("selectCharacterFilter")||"Select character...");let n=new Set;e.forEach(s=>{s.characters&&s.characters.forEach(o=>n.add(o))}),Array.from(n).sort().forEach(s=>{r.addOption(s,s)}),r.setValue(""),r.onChange(s=>{s&&(this.state.filters.characters||(this.state.filters.characters=new Set),this.state.filters.characters.add(s),this.applyFilters(),r.setValue(""))})})}createLocationFilter(t,e){new Ru.Setting(t).setName(w("filterByLocation")).addDropdown(r=>{r.addOption("",w("selectLocationFilter")||"Select location...");let n=new Set;e.forEach(o=>{o.location&&n.add(o.location)}),Array.from(n).sort((o,l)=>this.resolveLocationName(o).localeCompare(this.resolveLocationName(l))).forEach(o=>{r.addOption(o,this.resolveLocationName(o))}),r.setValue(""),r.onChange(o=>{o&&(this.state.filters.locations||(this.state.filters.locations=new Set),this.state.filters.locations.add(o),this.applyFilters(),r.setValue(""))})})}createGroupFilter(t){new Ru.Setting(t).setName(w("filterByGroup")).addDropdown(e=>{e.addOption("",w("selectGroupFilter")||"Select group..."),this.plugin.getGroups().forEach(n=>{e.addOption(n.id,n.name)}),e.setValue(""),e.onChange(n=>{n&&(this.state.filters.groups||(this.state.filters.groups=new Set),this.state.filters.groups.add(n),this.applyFilters(),e.setValue(""))})})}createTagFilter(t,e){new Ru.Setting(t).setName("Filter by Tag").addDropdown(r=>{r.addOption("","Select tag...");let n=new Set;e.forEach(s=>{s.tags&&s.tags.forEach(o=>n.add(o))}),Array.from(n).sort().forEach(s=>{r.addOption(s,s)}),r.setValue(""),r.onChange(s=>{s&&(this.state.filters.tags||(this.state.filters.tags=new Set),this.state.filters.tags.add(s),this.applyFilters(),r.setValue(""))})})}createMilestonesToggle(t){new Ru.Setting(t).setName(w("milestonesOnly")||"Milestones Only").setDesc("Show only milestone events").addToggle(e=>{e.setValue(this.state.filters.milestonesOnly||!1).onChange(r=>{this.state.filters.milestonesOnly=r,this.applyFilters()})})}createClearFiltersButton(t){new Ru.Setting(t).addButton(e=>e.setButtonText(w("clearAllFilters")||"Clear All Filters").onClick(()=>{this.clearAllFilters()}))}async buildFilterPanel(t,e){await this.loadLocations(),this.createMilestonesToggle(t),this.createCharacterFilter(t,e),this.createLocationFilter(t,e),this.createGroupFilter(t),this.createTagFilter(t,e),this.createClearFiltersButton(t)}renderFilterChips(t){var e,r,n,s;t.empty(),this.hasActiveFilters()&&((e=this.state.filters.characters)==null||e.forEach(o=>{this.createFilterChip(t,`Character: ${o}`,()=>{var l;(l=this.state.filters.characters)==null||l.delete(o),this.renderFilterChips(t),this.applyFilters()})}),(r=this.state.filters.locations)==null||r.forEach(o=>{let l=this.resolveLocationName(o);this.createFilterChip(t,`Location: ${l}`,()=>{var c;(c=this.state.filters.locations)==null||c.delete(o),this.renderFilterChips(t),this.applyFilters()})}),(n=this.state.filters.groups)==null||n.forEach(o=>{let l=this.plugin.getGroups().find(u=>u.id===o),c=l?l.name:o;this.createFilterChip(t,`Group: ${c}`,()=>{var u;(u=this.state.filters.groups)==null||u.delete(o),this.renderFilterChips(t),this.applyFilters()})}),(s=this.state.filters.tags)==null||s.forEach(o=>{this.createFilterChip(t,`Tag: ${o}`,()=>{var l;(l=this.state.filters.tags)==null||l.delete(o),this.renderFilterChips(t),this.applyFilters()})}),this.state.filters.milestonesOnly&&this.createFilterChip(t,"Milestones Only",()=>{this.state.filters.milestonesOnly=!1,this.renderFilterChips(t),this.applyFilters()}))}createFilterChip(t,e,r){let n=t.createDiv("filter-chip");n.createSpan({text:e});let s=n.createSpan({text:"x",cls:"filter-chip-remove"});s.onclick=r}hasActiveFilters(){let t=this.state.filters;return t.characters&&t.characters.size>0||t.locations&&t.locations.size>0||t.groups&&t.groups.size>0||t.tags&&t.tags.size>0||t.milestonesOnly===!0}clearAllFilters(){this.state.filters.characters&&this.state.filters.characters.clear(),this.state.filters.locations&&this.state.filters.locations.clear(),this.state.filters.groups&&this.state.filters.groups.clear(),this.state.filters.tags&&this.state.filters.tags.clear(),this.state.filters.milestonesOnly=!1,this.applyFilters()}applyFilters(){var t;(t=this.callbacks.getRenderer())==null||t.applyFilters(this.state.filters),this.callbacks.onFilterChange()}getState(){return this.state}}});var Lz={};At(Lz,{TimelineModal:()=>Mg});var Xo,Mg,Dk=_e(()=>{Xo=require("obsidian");St();uh();wk();xk();kk();Mg=class extends Xo.Modal{constructor(e,r,n){var l;super(e);this.renderer=null;this.defaultGanttDuration=1;this.filterPanelVisible=!1;this.filterChipsEl=null;this.plugin=r,this.events=n,this.modalEl.addClass("storyteller-list-modal"),this.modalEl.addClass("storyteller-timeline-modal"),this.currentState=nc.createDefaultState(r),this.defaultGanttDuration=(l=r.settings.ganttDefaultDuration)!=null?l:1;let s={onStateChange:()=>{this.filterChipsEl&&this.filterBuilder.renderFilterChips(this.filterChipsEl)},onRendererUpdate:()=>this.renderTimeline(),getRenderer:()=>this.renderer,getEvents:()=>this.events},o={onFilterChange:()=>{this.filterChipsEl&&this.filterBuilder.renderFilterChips(this.filterChipsEl)},getRenderer:()=>this.renderer};this.controlsBuilder=new nc(r,this.currentState,s),this.filterBuilder=new rf(r,this.currentState,o)}async onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:w("timeline")});let r=e.createDiv("storyteller-timeline-toolbar");this.controlsBuilder.createGanttToggle(r),this.controlsBuilder.createGroupingDropdown(r),this.controlsBuilder.createFitButton(r),this.controlsBuilder.createDecadeButton(r),this.controlsBuilder.createCenturyButton(r),this.controlsBuilder.createTodayButton(r),this.controlsBuilder.createEditModeToggle(r),this.controlsBuilder.createCopyRangeButton(r);let n=e.createDiv("storyteller-filter-panel-container");new Xo.ButtonComponent(n).setButtonText("Filters").setIcon("filter").onClick(()=>{this.filterPanelVisible=!this.filterPanelVisible,s.style.display=this.filterPanelVisible?"block":"none"});let s=n.createDiv("storyteller-filter-panel");s.style.display=this.filterPanelVisible?"block":"none",await this.filterBuilder.buildFilterPanel(s,this.events),this.filterChipsEl=e.createDiv("storyteller-filter-chips"),this.filterBuilder.renderFilterChips(this.filterChipsEl),this.timelineContainer=e.createDiv(),this.timelineContainer.style.height="380px",this.timelineContainer.style.marginBottom="0.75rem",this.legendEl=e.createDiv("storyteller-timeline-legend"),this.detailsEl=e.createDiv("storyteller-timeline-details"),await this.renderTimeline(),this.controlsBuilder.applyDefaultZoomPreset(),new Xo.Setting(e).addButton(o=>{let l=!!this.plugin.getActiveStory();o.setButtonText(w("createNewEvent")).setCta().onClick(()=>{if(!this.plugin.getActiveStory()){new Xo.Notice(w("selectOrCreateStoryFirst"));return}this.close(),new ts(this.app,this.plugin,null,async c=>{await this.plugin.saveEvent(c),new Xo.Notice(w("created",w("event"),c.name))}).open()}),l||o.setDisabled(!0).setTooltip("Select or create a story first.")})}async renderTimeline(){this.renderer&&(this.renderer.destroy(),this.renderer=null),this.legendEl&&this.legendEl.empty(),this.detailsEl&&this.detailsEl.empty(),this.renderer=new Xh(this.timelineContainer,this.plugin,{ganttMode:this.currentState.ganttMode,groupMode:this.currentState.groupMode,stackEnabled:this.currentState.stackEnabled,density:this.currentState.density,editMode:this.currentState.editMode,defaultGanttDuration:this.defaultGanttDuration,showDependencies:!0,showEras:this.currentState.showEras,narrativeOrder:this.currentState.narrativeOrder}),await this.renderer.initialize(),this.filterBuilder.hasActiveFilters()&&this.renderer.applyFilters(this.currentState.filters)}onClose(){this.contentEl.empty(),this.renderer&&(this.renderer.destroy(),this.renderer=null)}}});var Mz={};At(Mz,{PlotItemModal:()=>Os});var Ei,Os,Ig=_e(()=>{Ei=require("obsidian");Qa();oi();St();ru();Bl();Nl();es();Os=class extends Ei.Modal{constructor(e,r,n,s,o){super(e);this._groupRefreshInterval=null;this.groupSelectorContainer=null;this.plugin=r,this.isNew=n===null;let l=n?{...n}:{id:"",filePath:"",name:"",isPlotCritical:!1,pastOwners:[],associatedEvents:[],customFields:{}};l.pastOwners||(l.pastOwners=[]),l.associatedEvents||(l.associatedEvents=[]),l.customFields||(l.customFields={}),l.groups||(l.groups=[]),this.item=l,this.onSubmit=s,this.onDelete=o,this.modalEl.addClass("storyteller-item-modal")}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:this.isNew?w("createItem"):`${w("edit")} ${this.item.name}`}),this.isNew&&new Ei.Setting(e).setName("Start from Template").setDesc("Optionally start with a pre-configured item template").addButton(o=>o.setButtonText("Choose Template").setTooltip("Select an item template").onClick(()=>{new Gr(this.app,this.plugin,async l=>{await this.applyTemplateToItem(l),this.refresh(),new Ei.Notice(`Template "${l.name}" applied`)},"item").open()})),new Ei.Setting(e).setName(w("name")).setDesc(w("name")).addText(o=>o.setPlaceholder(w("enterItemName")).setValue(this.item.name).onChange(l=>this.item.name=l).inputEl.addClass("storyteller-modal-input-large")),new Ei.Setting(e).setName(w("plotCritical")).setDesc(w("plotCritical")).addToggle(o=>o.setValue(this.item.isPlotCritical).onChange(l=>this.item.isPlotCritical=l));let r;new Ei.Setting(e).setName(w("itemImage")).setDesc("").then(o=>{r=o.descEl.createEl("small",{text:w("currentValue",this.item.profileImagePath||w("none"))}),o.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(o=>o.setButtonText(w("select")).setTooltip(w("selectFromGallery")).onClick(()=>{new zr(this.app,this.plugin,l=>{let c=l?l.filePath:void 0;this.item.profileImagePath=c,r.setText(`Current: ${c||"None"}`)}).open()})).addButton(o=>o.setButtonText(w("upload")).setTooltip(w("uploadImage")).onClick(async()=>{let l=document.createElement("input");l.type="file",l.accept="image/*",l.onchange=async()=>{var u;let c=(u=l.files)==null?void 0:u[0];if(c)try{let d=this.plugin.settings.galleryUploadFolder;await this.plugin.ensureFolder(d);let h=Date.now(),f=c.name.replace(/[^\w\s.-]/g,"").replace(/\s+/g,"_"),m=`${h}_${f}`,g=`${d}/${m}`,y=await c.arrayBuffer();await this.app.vault.createBinary(g,y),this.item.profileImagePath=g,r.setText(`Current: ${g}`),new Ei.Notice(w("imageUploaded",m))}catch(d){console.error("Error uploading image:",d),new Ei.Notice(w("errorUploadingImage"))}},l.click()})).addButton(o=>o.setIcon("cross").setTooltip(w("clearImage")).setClass("mod-warning").onClick(()=>{this.item.profileImagePath=void 0,r.setText(`Current: ${this.item.profileImagePath||"None"}`)})),new Ei.Setting(e).setName(w("description")).setClass("storyteller-modal-setting-vertical").addTextArea(o=>{o.setPlaceholder(w("itemDescriptionPh")).setValue(this.item.description||"").onChange(l=>this.item.description=l||void 0),o.inputEl.rows=4}),new Ei.Setting(e).setName(w("history")).setClass("storyteller-modal-setting-vertical").addTextArea(o=>{o.setPlaceholder(w("itemHistoryPh")).setValue(this.item.history||"").onChange(l=>this.item.history=l||void 0),o.inputEl.rows=6}),e.createEl("h3",{text:w("relationships")}),new Ei.Setting(e).setName(w("currentOwner")).setDesc(`${w("currentOwner")}: ${this.item.currentOwner||w("none")}`).addButton(o=>o.setButtonText(w("selectOwner")).onClick(()=>{new Fn(this.app,this.plugin,l=>{this.item.currentOwner=l.name,this.onOpen()}).open()})),e.createEl("h3",{text:w("groups")}),this.groupSelectorContainer=e.createDiv("storyteller-group-selector-container"),this.renderGroupSelector(this.groupSelectorContainer),this._groupRefreshInterval=window.setInterval(()=>{this.modalEl.isShown()&&this.groupSelectorContainer&&this.renderGroupSelector(this.groupSelectorContainer)},2e3),e.createEl("h3",{text:w("customFields")});let n=e.createDiv("storyteller-custom-fields-container");this.item.customFields||(this.item.customFields={}),new Ei.Setting(e).addButton(o=>o.setButtonText(w("addCustomField")).setIcon("plus").onClick(()=>{let l=this.item.customFields,c=new Set([...Vi("item"),"customFields","filePath","id","sections"]),u=d=>{new Qr(this.app,{title:w("customFieldValueTitle"),label:w("valueForX",d),defaultValue:"",onSubmit:h=>{l[d]=h}}).open()};new Qr(this.app,{title:w("newCustomFieldTitle"),label:w("fieldName"),defaultValue:"",validator:d=>{let h=d.trim();return h?c.has(h)?w("thatNameIsReserved"):Object.keys(l).some(m=>m.toLowerCase()===h.toLowerCase())?w("fieldAlreadyExists"):null:w("fieldNameCannotBeEmpty")},onSubmit:d=>u(d.trim())}).open()})),new Ei.Setting(e).setName(w("currentLocation")).setDesc(`${w("currentLocation")}: ${this.item.currentLocation||w("none")}`).addButton(o=>o.setButtonText(w("selectLocation")).onClick(()=>{new fn(this.app,this.plugin,l=>{this.item.currentLocation=l?l.name:void 0,this.onOpen()}).open()}));let s=new Ei.Setting(e).setClass("storyteller-modal-buttons");!this.isNew&&this.onDelete&&s.addButton(o=>o.setButtonText(w("deleteItem")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteItem",this.item.name))&&(await this.onDelete(this.item),this.close())})),s.controlEl.createDiv({cls:"storyteller-modal-button-spacer"}),s.addButton(o=>o.setButtonText(w("cancel")).onClick(()=>this.close())),s.addButton(o=>o.setButtonText(this.isNew?w("createItem"):w("saveChanges")).setCta().onClick(async()=>{if(!this.item.name.trim()){new Ei.Notice(w("itemNameRequired"));return}this.item.description=this.item.description||"",this.item.history=this.item.history||"",await this.onSubmit(this.item),this.close()}))}renderGroupSelector(e){e.empty();let r=this.plugin.getGroups(),n=async()=>{let s=this.item.id||this.item.name,l=(await this.plugin.listPlotItems()).find(u=>(u.id||u.name)===s),c=new Set((l==null?void 0:l.groups)||this.item.groups||[]);return this.item.groups=Array.from(c),c};(async()=>{let s=await n();if(new Ei.Setting(e).setName(w("groups")).setDesc(w("assignItemToGroupsDesc")).addDropdown(o=>{o.addOption("",w("selectGroupPlaceholder")),r.forEach(l=>o.addOption(l.id,l.name)),o.setValue(""),o.onChange(async l=>{if(l&&!s.has(l)){s.add(l),this.item.groups=Array.from(s);let c=this.item.id||this.item.name;await this.plugin.addMemberToGroup(l,"item",c),this.renderGroupSelector(e)}})}),s.size>0){let o=e.createDiv("selected-groups");r.filter(l=>s.has(l.id)).forEach(l=>{let u=o.createSpan({text:l.name,cls:"group-tag"}).createSpan({text:" \xD7",cls:"remove-group-btn"});u.onclick=async()=>{s.delete(l.id),this.item.groups=Array.from(s);let d=this.item.id||this.item.name;await this.plugin.removeMemberFromGroup(l.id,"item",d),this.renderGroupSelector(e)}})}})()}async applyTemplateToItem(e){if(!e.entities.items||e.entities.items.length===0){new Ei.Notice("This template does not contain any items");return}let r=e.entities.items[0],{templateId:n,sectionContent:s,customYamlFields:o,id:l,filePath:c,...u}=r;if(Object.assign(this.item,u),o&&Object.assign(this.item,o),s)for(let[d,h]of Object.entries(s)){let f=d.toLowerCase().replace(/\s+/g,"");this.item[f]=h}this.item.currentOwner=void 0,this.item.pastOwners=[],this.item.currentLocation=void 0,this.item.associatedEvents=[],this.item.groups=[],this.item.connections=[]}refresh(){this.onOpen()}onClose(){this.contentEl.empty(),this._groupRefreshInterval&&clearInterval(this._groupRefreshInterval)}}});function Qge(a,t){let e=a.trim(),r=t.trim();return!e&&!r?`---
---
`:e?r?`---
${e}
---

${r}`:`---
${e}
---
`:r}function Nu(a){if(a.yamlContent&&typeof a.yamlContent=="string")return a.yamlContent;let{templateId:t,sectionContent:e,customYamlFields:r,yamlContent:n,markdownContent:s,...o}=a,l={...o,...r||{}},c={};for(let[u,d]of Object.entries(l))u==="templateId"||u==="yamlContent"||u==="markdownContent"||u!=="sectionContent"&&(typeof d=="string"&&d.includes(`
`)||d!=null&&(c[u]=d));try{let{stringifyYaml:u}=require("obsidian");return u(c).trim()}catch(u){return Object.entries(c).map(([d,h])=>Array.isArray(h)?`${d}: [${h.map(f=>typeof f=="string"?`"${f}"`:f).join(", ")}]`:typeof h=="string"?`${d}: "${h}"`:typeof h=="object"?`${d}: ${JSON.stringify(h)}`:`${d}: ${h}`).join(`
`)}}function Bu(a){if(a.markdownContent&&typeof a.markdownContent=="string")return a.markdownContent;let t={};return a.sectionContent&&typeof a.sectionContent=="object"&&Object.assign(t,a.sectionContent),["description","backstory","history","outcome","summary","content"].forEach(r=>{if(a[r]&&typeof a[r]=="string"&&a[r].trim()){let n=r.charAt(0).toUpperCase()+r.slice(1);t[n]=a[r]}}),Object.keys(t).length>0?Object.entries(t).map(([r,n])=>`## ${r}
${n||""}`).join(`

`):""}function N0(a){let t=Nu(a),e=Bu(a);return Qge(t,e)}var B0=_e(()=>{});var $0,Lk,z0,Iz=_e(()=>{$0=require("obsidian");ea();B0();Lk=require("obsidian"),z0=class extends hr{constructor(e,r,n,s,o){super(e);this.yamlEditor=null;this.markdownEditor=null;this.previewContainer=null;this.plugin=r,this.entity={...n},this.entityType=s,this.onSave=o,this.migrateToNewFormat(),this.modalEl.addClass("storyteller-entity-detail-modal")}migrateToNewFormat(){this.entity.yamlContent!==void 0||this.entity.markdownContent!==void 0||(this.entity.yamlContent=Nu(this.entity),this.entity.markdownContent=Bu(this.entity))}onOpen(){super.onOpen();let{contentEl:e}=this;e.empty(),e.addClass("entity-detail-editor"),this.renderHeader(e);let r=e.createDiv("entity-detail-split");r.style.display="flex",r.style.gap="20px",r.style.height="calc(100vh - 200px)";let n=r.createDiv("entity-detail-editor-pane");n.style.flex="1",n.style.display="flex",n.style.flexDirection="column",n.style.gap="10px",this.renderEditorPane(n);let s=r.createDiv("entity-detail-preview-pane");s.style.flex="1",s.style.display="flex",s.style.flexDirection="column",this.renderPreviewPane(s),this.renderFooter(e)}renderHeader(e){let r=e.createDiv("entity-detail-header"),n=this.getEntityTypeLabel(this.entityType),s=this.entity.name||"Unnamed";r.createEl("h2",{text:`Edit ${n}: ${s}`}),r.createEl("p",{text:`Edit the YAML frontmatter and markdown content for this ${n.toLowerCase()}. Changes are previewed on the right.`,cls:"entity-detail-subtitle"})}renderEditorPane(e){let r=e.createDiv("entity-detail-yaml-section");r.createEl("h3",{text:"YAML Frontmatter"}),r.createEl("p",{text:"Edit the YAML frontmatter fields. Use {{variableName}} for template variables.",cls:"setting-item-description"});let n=r.createEl("textarea",{cls:"entity-detail-yaml-editor",placeholder:`name: {{characterName}}
status: Alive
traits: [Brave, Loyal]`});n.style.width="100%",n.style.flex="1",n.style.minHeight="200px",n.style.fontFamily="monospace",n.style.fontSize="12px",n.style.padding="10px",n.style.border="1px solid var(--background-modifier-border)",n.style.borderRadius="4px",n.style.resize="vertical",n.value=this.entity.yamlContent||Nu(this.entity),this.yamlEditor=n,n.addEventListener("input",()=>{this.entity.yamlContent=n.value,this.updatePreview()});let s=e.createDiv("entity-detail-markdown-section");s.style.flex="1",s.style.display="flex",s.style.flexDirection="column",s.createEl("h3",{text:"Markdown Content"}),s.createEl("p",{text:"Edit the markdown body content with sections (e.g., ## Description, ## Backstory).",cls:"setting-item-description"});let o=s.createEl("textarea",{cls:"entity-detail-markdown-editor",placeholder:`## Description

Enter description here...

## Backstory

Enter backstory here...`});o.style.width="100%",o.style.flex="1",o.style.minHeight="200px",o.style.fontFamily="monospace",o.style.fontSize="12px",o.style.padding="10px",o.style.border="1px solid var(--background-modifier-border)",o.style.borderRadius="4px",o.style.resize="vertical",o.value=this.entity.markdownContent||Bu(this.entity),this.markdownEditor=o,o.addEventListener("input",()=>{this.entity.markdownContent=o.value,this.updatePreview()})}renderPreviewPane(e){e.createEl("h3",{text:"Preview"}),e.createEl("p",{text:"This is how the note will appear when the template is applied.",cls:"setting-item-description"});let r=e.createDiv("entity-detail-preview-box");r.style.flex="1",r.style.border="1px solid var(--background-modifier-border)",r.style.borderRadius="4px",r.style.padding="15px",r.style.overflow="auto",r.style.backgroundColor="var(--background-primary)",r.style.fontFamily="var(--font-text)",r.style.fontSize="14px",r.style.lineHeight="1.6",this.previewContainer=r,this.updatePreview()}updatePreview(){if(!this.previewContainer)return;let e=this.entity.yamlContent||Nu(this.entity),r=this.entity.markdownContent||Bu(this.entity),n=N0({yamlContent:e,markdownContent:r});this.previewContainer.empty();let s=this.previewContainer.createEl("pre",{cls:"entity-detail-preview-code"});s.style.margin="0",s.style.whiteSpace="pre-wrap",s.style.wordBreak="break-word",s.textContent=n}renderFooter(e){let r=e.createDiv("entity-detail-footer");r.style.marginTop="20px",r.style.display="flex",r.style.justifyContent="flex-end",r.style.gap="10px",r.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close()),r.createEl("button",{text:"Save Changes",cls:"mod-cta"}).addEventListener("click",()=>this.handleSave())}handleSave(){if(this.entity.yamlContent)try{(0,Lk.parseYaml)(this.entity.yamlContent)}catch(e){new $0.Notice(`Invalid YAML: ${e.message}`);return}if(!this.entity.name&&this.entity.yamlContent)try{let e=(0,Lk.parseYaml)(this.entity.yamlContent);e&&typeof e=="object"&&"name"in e&&(this.entity.name=String(e.name||"Unnamed"))}catch(e){}if(!this.entity.name||this.entity.name.trim()===""){new $0.Notice('Please ensure the YAML contains a "name" field or set a name for this entity');return}this.onSave(this.entity),new $0.Notice("Entity updated successfully!"),this.close()}getEntityTypeLabel(e){return{character:"Character",location:"Location",event:"Event",item:"Item",group:"Group",culture:"Culture",economy:"Economy",magicSystem:"Magic System",chapter:"Chapter",scene:"Scene",reference:"Reference"}[e]}onClose(){this.contentEl.empty(),this.yamlEditor=null,this.markdownEditor=null,this.previewContainer=null}}});var da,Og,Az=_e(()=>{da=require("obsidian");ea();Og=class extends hr{constructor(t,e,r,n){super(t),this.plugin=e,this.onSave=n,this.isNewVariable=r===null,this.variable=r?{...r}:this.createEmptyVariable(),this.modalEl.addClass("storyteller-variable-editor-modal")}createEmptyVariable(){return{name:"newVariable",label:"New Variable",type:"text",defaultValue:"",description:""}}onOpen(){super.onOpen();let{contentEl:t}=this;t.empty(),t.addClass("variable-editor"),this.renderHeader(t);let e=t.createDiv("variable-editor-form");this.renderForm(e),this.renderFooter(t)}renderHeader(t){let e=t.createDiv("variable-editor-header");e.createEl("h2",{text:this.isNewVariable?"Create New Variable":`Edit Variable: {{${this.variable.name}}}`}),e.createEl("p",{text:"Define a variable that users can customize when applying this template. Use {{variableName}} in entity fields and content.",cls:"variable-editor-subtitle"})}renderForm(t){new da.Setting(t).setName("Variable Name").setDesc("Internal name used in {{variableName}} syntax. Use camelCase, no spaces.").addText(r=>{r.setPlaceholder("e.g., characterName, kingdomAge").setValue(this.variable.name);let n=r.inputEl;n.addEventListener("blur",()=>{let s=n.value,o=s.trim().replace(/[^a-zA-Z0-9]/g,"").replace(/^[0-9]/,"");o!==s&&(this.variable.name=o,r.setValue(o))}),r.onChange(s=>{let o=s.trim().replace(/[^a-zA-Z0-9]/g,"").replace(/^[0-9]/,"");this.variable.name=o})}),new da.Setting(t).setName("Display Label").setDesc("User-friendly label shown in the template application UI").addText(r=>r.setPlaceholder("e.g., Character Name, Kingdom Age").setValue(this.variable.label).onChange(n=>{this.variable.label=n}));let e=new da.Setting(t).setName("Variable Type").setDesc("Data type for this variable").addDropdown(r=>r.addOption("text","Text - Single line text input").addOption("number","Number - Numeric input").addOption("boolean","Boolean - True/False toggle").addOption("select","Select - Dropdown with predefined options").addOption("date","Date - Date picker").setValue(this.variable.type).onChange(n=>{this.variable.type=n,this.onOpen()}));this.renderDefaultValueField(t),this.variable.type==="select"&&this.renderOptionsField(t),new da.Setting(t).setName("Description").setDesc("Help text explaining what this variable controls").addTextArea(r=>{r.setPlaceholder("e.g., The name of the main character in your story").setValue(this.variable.description||"").onChange(n=>{this.variable.description=n}),r.inputEl.rows=3,r.inputEl.cols=50}),this.variable.usedIn&&this.variable.usedIn.length>0?this.renderUsageInfo(t):t.createDiv("variable-usage-empty").createEl("p",{text:"\u{1F4A1} Tip: After saving, use {{"+this.variable.name+"}} in your entity fields and section content.",cls:"setting-item-description"}),this.renderExamplePreview(t)}renderDefaultValueField(t){let e=new da.Setting(t).setName("Default Value").setDesc("Default value for this variable (optional)");switch(this.variable.type){case"text":case"date":e.addText(r=>{var n;return r.setPlaceholder(this.variable.type==="date"?"YYYY-MM-DD":"Enter default value").setValue(((n=this.variable.defaultValue)==null?void 0:n.toString())||"").onChange(s=>{this.variable.defaultValue=s})});break;case"number":e.addText(r=>{var n;return r.setPlaceholder("Enter default number").setValue(((n=this.variable.defaultValue)==null?void 0:n.toString())||"").onChange(s=>{let o=parseFloat(s);this.variable.defaultValue=isNaN(o)?"":o})});break;case"boolean":e.addToggle(r=>r.setValue(this.variable.defaultValue===!0).onChange(n=>{this.variable.defaultValue=n}));break;case"select":e.addText(r=>{var n;return r.setPlaceholder("Enter default selection (must match an option)").setValue(((n=this.variable.defaultValue)==null?void 0:n.toString())||"").onChange(s=>{this.variable.defaultValue=s})});break}}renderOptionsField(t){let e=t.createDiv("variable-options-section");e.createEl("h4",{text:"Select Options"}),e.createEl("p",{text:"Enter options one per line. Users will choose from these values.",cls:"setting-item-description"});let r=e.createEl("textarea",{placeholder:`Option 1
Option 2
Option 3`,value:(this.variable.options||[]).join(`
`)});r.rows=6,r.addClass("variable-options-textarea"),r.addEventListener("change",()=>{let n=r.value.split(`
`).map(s=>s.trim()).filter(s=>s.length>0);this.variable.options=n.length>0?n:void 0})}renderUsageInfo(t){let e=t.createDiv("variable-usage-section");e.createEl("h4",{text:"Variable Usage"}),e.createEl("p",{text:`This variable is used in ${this.variable.usedIn.length} location(s):`,cls:"setting-item-description"});let r=e.createDiv("variable-usage-list");this.variable.usedIn.forEach(n=>{r.createDiv("variable-usage-item").createEl("span",{text:`\u{1F4CD} ${this.getEntityTypeLabel(n.entityType)} \u2192 ${n.field}`,cls:"variable-usage-location"})})}renderExamplePreview(t){let e=t.createDiv("variable-example-preview");e.createEl("h4",{text:"Example Usage"});let r=e.createEl("code",{cls:"variable-example-code"}),n="";switch(this.variable.type){case"text":n=`name: "{{${this.variable.name}}}"  # User enters: "John Smith"`;break;case"number":n=`age: {{${this.variable.name}}}  # User enters: 25`;break;case"boolean":n=`isAlive: {{${this.variable.name}}}  # User toggles: true/false`;break;case"select":n=`rank: "{{${this.variable.name}}}"  # User selects from: [${(this.variable.options||[]).join(", ")}]`;break;case"date":n=`birthdate: "{{${this.variable.name}}}"  # User picks: 2024-01-15`;break}r.textContent=n,e.createEl("p",{text:"When applying the template, users will be prompted to provide a value for this variable.",cls:"setting-item-description"})}renderFooter(t){let e=t.createDiv("variable-editor-footer");e.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close()),e.createEl("button",{text:this.isNewVariable?"Create Variable":"Save Changes",cls:"mod-cta"}).addEventListener("click",()=>this.handleSave())}handleSave(){if(!this.variable.name||this.variable.name.trim()===""){new da.Notice("Please enter a variable name");return}if(!/^[a-zA-Z][a-zA-Z0-9]*$/.test(this.variable.name)){new da.Notice("Variable name must start with a letter and contain only letters and numbers");return}if(!this.variable.label||this.variable.label.trim()===""){new da.Notice("Please enter a display label");return}if(this.variable.type==="select"){if(!this.variable.options||this.variable.options.length===0){new da.Notice("Select type variables must have at least one option");return}if(this.variable.defaultValue&&!this.variable.options.includes(this.variable.defaultValue)){new da.Notice("Default value must be one of the provided options");return}}if(this.variable.type==="date"&&this.variable.defaultValue&&!/^\d{4}-\d{2}-\d{2}$/.test(this.variable.defaultValue)){new da.Notice("Date default value must be in YYYY-MM-DD format");return}this.onSave(this.variable),new da.Notice(`Variable {{${this.variable.name}}} ${this.isNewVariable?"created":"updated"} successfully!`),this.close()}getEntityTypeLabel(t){return{character:"Character",location:"Location",event:"Event",item:"Item",group:"Group",culture:"Culture",economy:"Economy",magicSystem:"Magic System",chapter:"Chapter",scene:"Scene",reference:"Reference"}[t]||t}onClose(){this.contentEl.empty()}}});var Ik={};At(Ik,{TemplateMigrator:()=>Mk});var Mk,Ak=_e(()=>{B0();Mk=class{static migrateTemplateToNewFormat(t){let e=JSON.parse(JSON.stringify(t));return["characters","locations","events","items","groups","cultures","economies","magicSystems","chapters","scenes","references"].forEach(n=>{let s=e.entities[n];s&&Array.isArray(s)&&s.forEach(o=>{this.migrateEntityToNewFormat(o)})}),e}static migrateEntityToNewFormat(t){t.yamlContent||t.markdownContent||(t.yamlContent=Nu(t),t.markdownContent=Bu(t))}}});var Yi,Fs,H0=_e(()=>{Yi=require("obsidian");ea();Iz();Az();B0();Fs=class extends hr{constructor(e,r,n,s){super(e);this.currentTab="metadata";this.selectedEntityType=null;this.selectedEntityIndex=-1;this.plugin=r,this.onSave=s,this.isNewTemplate=n===null,this.template=n||this.createEmptyTemplate(),this.modalEl.addClass("storyteller-template-editor-modal")}createEmptyTemplate(){return{id:`template-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:"New Template",description:"",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"User",isBuiltIn:!1,isEditable:!0,created:new Date().toISOString(),modified:new Date().toISOString(),tags:[],entities:{},entityTypes:[],usageCount:0,quickApplyEnabled:!0,variables:[]}}onOpen(){super.onOpen();let{contentEl:e}=this;e.empty(),e.addClass("storyteller-template-editor"),this.renderHeader(e),this.renderTabs(e);let r=e.createDiv("template-editor-content");this.renderCurrentTab(r),this.renderFooter(e)}renderHeader(e){let r=e.createDiv("template-editor-header");r.createEl("h2",{text:this.isNewTemplate?"Create New Template":`Edit Template: ${this.template.name}`}),this.template.isEditable||r.createDiv("template-editor-warning").createEl("span",{text:"\u26A0\uFE0F This is a built-in template and cannot be edited. You can duplicate it to create an editable version."})}renderTabs(e){let r=e.createDiv("template-editor-tabs");[{id:"metadata",label:"\u{1F4CB} Metadata"},{id:"entities",label:"\u{1F465} Entities"},{id:"variables",label:"\u{1F527} Variables"},{id:"preview",label:"\u{1F441}\uFE0F Preview"}].forEach(s=>{let o=r.createEl("button",{cls:"template-editor-tab",text:s.label});this.currentTab===s.id&&o.addClass("active"),o.onclick=()=>{this.currentTab=s.id,this.onOpen()}})}renderCurrentTab(e){switch(e.empty(),this.currentTab){case"metadata":this.renderMetadataTab(e);break;case"entities":this.renderEntitiesTab(e);break;case"variables":this.renderVariablesTab(e);break;case"preview":this.renderPreviewTab(e);break}}renderMetadataTab(e){let r=e.createDiv("template-editor-section");new Yi.Setting(r).setName("Template Name").setDesc("A descriptive name for this template").addText(n=>n.setPlaceholder("Enter template name").setValue(this.template.name).onChange(s=>{this.template.name=s,this.template.modified=new Date().toISOString()})),new Yi.Setting(r).setName("Description").setDesc("Describe what this template provides and when to use it").addTextArea(n=>{n.setPlaceholder("Enter description").setValue(this.template.description).onChange(s=>{this.template.description=s,this.template.modified=new Date().toISOString()}),n.inputEl.rows=4,n.inputEl.cols=50}),new Yi.Setting(r).setName("Genre").setDesc("Genre classification for this template").addDropdown(n=>n.addOption("fantasy","Fantasy").addOption("scifi","Sci-Fi").addOption("mystery","Mystery").addOption("horror","Horror").addOption("romance","Romance").addOption("historical","Historical").addOption("western","Western").addOption("thriller","Thriller").addOption("custom","Custom").setValue(this.template.genre).onChange(s=>{this.template.genre=s,this.template.modified=new Date().toISOString()})),new Yi.Setting(r).setName("Category").setDesc("Template scope and complexity").addDropdown(n=>n.addOption("single-entity","Single Entity - One character, location, or item").addOption("entity-set","Entity Set - Collection of related entities").addOption("full-world","Full World - Complete story world with all entity types").setValue(this.template.category).onChange(s=>{this.template.category=s,this.template.modified=new Date().toISOString()})),new Yi.Setting(r).setName("Tags").setDesc("Comma-separated tags for searching (e.g., king, ruler, noble)").addText(n=>n.setPlaceholder("tag1, tag2, tag3").setValue(this.template.tags.join(", ")).onChange(s=>{this.template.tags=s.split(",").map(o=>o.trim()).filter(o=>o.length>0),this.template.modified=new Date().toISOString()})),new Yi.Setting(r).setName("Version").setDesc("Template version (semantic versioning)").addText(n=>n.setPlaceholder("1.0.0").setValue(this.template.version).onChange(s=>{this.template.version=s,this.template.modified=new Date().toISOString()})),new Yi.Setting(r).setName("Enable Quick Apply").setDesc("Show this template in quick-apply menus").addToggle(n=>n.setValue(this.template.quickApplyEnabled||!1).onChange(s=>{this.template.quickApplyEnabled=s,this.template.modified=new Date().toISOString()}))}renderEntitiesTab(e){let r=e.createDiv("template-editor-section");r.createEl("h3",{text:"Entities in Template"}),r.createEl("p",{text:"Add and configure entities that will be created when this template is applied.",cls:"setting-item-description"});let n="character",s=["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"],o=new Yi.Setting(r).setName("Add New Entity").setDesc("Select the type of entity to add to this template");o.addDropdown(c=>{s.forEach(u=>{c.addOption(u,this.getEntityTypeLabel(u))}),c.setValue(n),c.onChange(u=>{n=u})}),o.addButton(c=>{c.setButtonText("Add Entity").setCta().onClick(()=>{this.addEntity(n),this.onOpen()})});let l=r.createDiv("template-entities-list");this.renderEntitiesList(l)}renderEntitiesList(e){if(!(this.template.entityTypes&&this.template.entityTypes.length>0)){e.createEl("p",{text:"No entities added yet. Add your first entity above.",cls:"template-empty-state"});return}["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"].forEach(s=>{let o=this.getEntityTypePlural(s),l=this.template.entities[o];if(!l||l.length===0)return;let c=e.createDiv("template-entity-type-section");c.createEl("h4",{text:this.getEntityTypeLabel(s)}),l.forEach((u,d)=>{this.renderEntityCard(c,u,s,d)})})}renderEntityCard(e,r,n,s){let o=e.createDiv("template-entity-card"),l=o.createDiv("template-entity-card-header");l.createEl("span",{text:r.name||`${this.getEntityTypeLabel(n)} ${s+1}`,cls:"template-entity-name"});let c=l.createDiv("template-entity-actions");c.createEl("button",{text:"\u270F\uFE0F Edit",cls:"template-entity-btn"}).addEventListener("click",()=>{this.editEntity(n,s)}),c.createEl("button",{text:"\u{1F5D1}\uFE0F Delete",cls:"template-entity-btn-danger"}).addEventListener("click",()=>{this.deleteEntity(n,s)});let h=o.createDiv("template-entity-preview");r.description&&h.createEl("p",{text:r.description.substring(0,100)+(r.description.length>100?"...":""),cls:"template-entity-description"});let f=Object.keys(r).filter(m=>m!=="templateId").length;h.createEl("small",{text:`${f} fields defined`,cls:"template-entity-meta"})}renderVariablesTab(e){let r=e.createDiv("template-editor-section");r.createEl("h3",{text:"Template Variables"}),r.createEl("p",{text:"Define variables that users can customize when applying the template. Use {{variableName}} in entity fields and content.",cls:"setting-item-description"}),r.createEl("button",{text:"+ Add Variable",cls:"mod-cta"}).addEventListener("click",()=>{this.addVariable(),this.onOpen()});let s=r.createDiv("template-variables-list");!this.template.variables||this.template.variables.length===0?s.createEl("p",{text:"No variables defined yet. Variables allow template customization.",cls:"template-empty-state"}):this.template.variables.forEach((o,l)=>{this.renderVariableCard(s,o,l)})}renderVariableCard(e,r,n){let s=e.createDiv("template-variable-card"),o=s.createDiv("template-variable-header");o.createEl("strong",{text:r.label||r.name});let l=o.createDiv("template-variable-actions");l.createEl("button",{text:"\u270F\uFE0F Edit",cls:"template-variable-btn"}).addEventListener("click",()=>{this.editVariable(n)}),l.createEl("button",{text:"\u{1F5D1}\uFE0F",cls:"template-variable-btn-danger"}).addEventListener("click",()=>{this.deleteVariable(n)}),s.createEl("p",{text:`Variable: {{${r.name}}}`,cls:"template-variable-syntax"}),s.createEl("p",{text:`Type: ${r.type}`,cls:"template-variable-type"}),r.description&&s.createEl("p",{text:r.description,cls:"template-variable-desc"}),r.defaultValue!==void 0&&r.defaultValue!==""&&s.createEl("p",{text:`Default: ${r.defaultValue}`,cls:"template-variable-default"}),r.type==="select"&&r.options&&r.options.length>0&&s.createEl("p",{text:`${r.options.length} option(s): ${r.options.slice(0,3).join(", ")}${r.options.length>3?"...":""}`,cls:"template-variable-options"})}renderPreviewTab(e){var c,u;let r=e.createDiv("template-editor-section");r.createEl("h3",{text:"Template Preview"}),r.createEl("p",{text:"Preview what entities will be created when this template is applied.",cls:"setting-item-description"});let n=r.createDiv("template-preview-stats"),s=((c=this.template.entityTypes)==null?void 0:c.length)||0,o=((u=this.template.variables)==null?void 0:u.length)||0;n.createEl("p",{text:`\u{1F4E6} ${s} entity types`}),n.createEl("p",{text:`\u{1F527} ${o} variables`}),n.createEl("p",{text:`\u{1F3F7}\uFE0F ${this.template.tags.length} tags`});let l=r.createDiv("template-preview-entities");l.createEl("h4",{text:"Entities"}),s===0?l.createEl("p",{text:"No entities configured yet.",cls:"template-empty-state"}):this.renderEntitiesPreview(l)}renderEntitiesPreview(e){["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"].forEach(n=>{let s=this.getEntityTypePlural(n),o=this.template.entities[s];if(!o||o.length===0)return;let l=e.createDiv("template-preview-type-section");l.createEl("h5",{text:`${this.getEntityTypeLabel(n)} (${o.length})`}),o.forEach(c=>{let u=l.createDiv("template-preview-entity");u.style.marginBottom="20px",u.style.border="1px solid var(--background-modifier-border)",u.style.borderRadius="4px",u.style.padding="15px",u.style.backgroundColor="var(--background-secondary)";let d=u.createDiv("template-preview-entity-header");d.style.marginBottom="10px",d.style.paddingBottom="10px",d.style.borderBottom="1px solid var(--background-modifier-border)";let h=d.createEl("strong",{text:c.name||"Unnamed"});h.style.fontSize="16px";let f=N0(c),m=u.createEl("pre",{cls:"template-preview-note-code"});m.style.margin="0",m.style.padding="10px",m.style.backgroundColor="var(--background-primary)",m.style.border="1px solid var(--background-modifier-border)",m.style.borderRadius="4px",m.style.fontSize="12px",m.style.fontFamily="monospace",m.style.whiteSpace="pre-wrap",m.style.wordBreak="break-word",m.style.maxHeight="300px",m.style.overflow="auto",m.textContent=f})})}renderFooter(e){let r=e.createDiv("template-editor-footer");r.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close()),this.template.isEditable?r.createEl("button",{text:"Save Template",cls:"mod-cta"}).addEventListener("click",()=>this.handleSave()):r.createEl("button",{text:"Duplicate",cls:"mod-cta"}).addEventListener("click",()=>this.handleDuplicate())}addEntity(e){let r=this.getEntityTypePlural(e);this.template.entities[r]||(this.template.entities[r]=[]);let n={templateId:`${e.toUpperCase()}_${Date.now()}`,name:"",description:""};this.template.entities[r].push(n),this.template.entityTypes||(this.template.entityTypes=[]),this.template.entityTypes.includes(e)||this.template.entityTypes.push(e),this.template.modified=new Date().toISOString()}editEntity(e,r){let n=this.getEntityTypePlural(e),s=this.template.entities[n];if(!s||s.length<=r){new Yi.Notice("Entity not found");return}let o=s[r];new z0(this.app,this.plugin,o,e,l=>{s[r]=l,this.template.modified=new Date().toISOString(),this.onOpen()}).open()}deleteEntity(e,r){var o;let n=this.getEntityTypePlural(e),s=this.template.entities[n];s&&s.length>r&&(s.splice(r,1),s.length===0&&(delete this.template.entities[n],this.template.entityTypes=(o=this.template.entityTypes)==null?void 0:o.filter(l=>l!==e)),this.template.modified=new Date().toISOString(),this.onOpen())}addVariable(){this.template.variables||(this.template.variables=[]),new Og(this.app,this.plugin,null,e=>{var r;if((r=this.template.variables)!=null&&r.some(n=>n.name===e.name)){new Yi.Notice(`Variable name "{{${e.name}}}" already exists. Please choose a different name.`);return}this.template.variables.push(e),this.template.modified=new Date().toISOString(),this.onOpen()}).open()}editVariable(e){if(!this.template.variables||this.template.variables.length<=e){new Yi.Notice("Variable not found");return}let r=this.template.variables[e],n=r.name;new Og(this.app,this.plugin,r,s=>{var o;if(s.name!==n&&((o=this.template.variables)!=null&&o.some(l=>l.name===s.name))){new Yi.Notice(`Variable name "{{${s.name}}}" already exists. Please choose a different name.`);return}this.template.variables[e]=s,this.template.modified=new Date().toISOString(),this.onOpen()}).open()}deleteVariable(e){this.template.variables&&this.template.variables.length>e&&(this.template.variables.splice(e,1),this.template.modified=new Date().toISOString(),this.onOpen())}async handleSave(){try{if(!this.template.name||this.template.name.trim()===""){new Yi.Notice("Please enter a template name");return}if(!this.template.description||this.template.description.trim()===""){new Yi.Notice("Please enter a description");return}this.template.modified=new Date().toISOString(),await this.plugin.templateManager.saveTemplate(this.template),this.onSave(this.template),new Yi.Notice(`Template "${this.template.name}" saved successfully!`),this.close()}catch(e){console.error("Error saving template:",e),new Yi.Notice(`Failed to save template: ${e.message}`)}}async handleDuplicate(){let e=JSON.parse(JSON.stringify(this.template)),{TemplateMigrator:r}=await Promise.resolve().then(()=>(Ak(),Ik));e=r.migrateTemplateToNewFormat(e),e={...e,id:`template-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:`${this.template.name} (Copy)`,author:"User",isBuiltIn:!1,isEditable:!0,created:new Date().toISOString(),modified:new Date().toISOString(),usageCount:0},this.template=e,this.isNewTemplate=!0,await this.handleSave()}getEntityTypePlural(e){return{character:"characters",location:"locations",event:"events",item:"items",group:"groups",culture:"cultures",economy:"economies",magicSystem:"magicSystems",chapter:"chapters",scene:"scenes",reference:"references"}[e]}getEntityTypeLabel(e){return{character:"Character",location:"Location",event:"Event",item:"Item",group:"Group",culture:"Culture",economy:"Economy",magicSystem:"Magic System",chapter:"Chapter",scene:"Scene",reference:"Reference"}[e]}onClose(){this.contentEl.empty()}}});function uD(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,r=Array(t);e<t;e++)r[e]=a[e];return r}function eve(a){if(Array.isArray(a))return a}function tve(a){if(Array.isArray(a))return uD(a)}function Tc(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function rve(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,cV(r.key),r)}}function Cc(a,t,e){return t&&rve(a.prototype,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function pa(a,t){var e=typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=LD(a))||t){e&&(a=e);var r=0,n=function(){};return{s:n,n:function(){return r>=a.length?{done:!0}:{done:!1,value:a[r++]}},e:function(c){throw c},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,l=!1;return{s:function(){e=e.call(a)},n:function(){var c=e.next();return o=c.done,c},e:function(c){l=!0,s=c},f:function(){try{o||e.return==null||e.return()}finally{if(l)throw s}}}}function lV(a,t,e){return(t=cV(t))in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function ive(a){if(typeof Symbol!="undefined"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function nve(a,t){var e=a==null?null:typeof Symbol!="undefined"&&a[Symbol.iterator]||a["@@iterator"];if(e!=null){var r,n,s,o,l=[],c=!0,u=!1;try{if(s=(e=e.call(a)).next,t===0){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=s.call(e)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,n=d}finally{try{if(!c&&e.return!=null&&(o=e.return(),Object(o)!==o))return}finally{if(u)throw n}}return l}}function ave(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ci(a,t){return eve(a)||nve(a,t)||LD(a,t)||ave()}function hw(a){return tve(a)||ive(a)||LD(a)||sve()}function ove(a,t){if(typeof a!="object"||!a)return a;var e=a[Symbol.toPrimitive];if(e!==void 0){var r=e.call(a,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}function cV(a){var t=ove(a,"string");return typeof t=="symbol"?t:t+""}function Ai(a){"@babel/helpers - typeof";return Ai=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ai(a)}function LD(a,t){if(a){if(typeof a=="string")return uD(a,t);var e={}.toString.call(a).slice(8,-1);return e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set"?Array.from(a):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?uD(a,t):void 0}}function sv(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function ov(){if(Rz)return Ok;Rz=1;function a(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}return Ok=a,Ok}function Lve(){if(Nz)return Fk;Nz=1;var a=typeof G0=="object"&&G0&&G0.Object===Object&&G0;return Fk=a,Fk}function kw(){if(Bz)return Rk;Bz=1;var a=Lve(),t=typeof self=="object"&&self&&self.Object===Object&&self,e=a||t||Function("return this")();return Rk=e,Rk}function Mve(){if($z)return Nk;$z=1;var a=kw(),t=function(){return a.Date.now()};return Nk=t,Nk}function Ive(){if(zz)return Bk;zz=1;var a=/\s/;function t(e){for(var r=e.length;r--&&a.test(e.charAt(r)););return r}return Bk=t,Bk}function Ave(){if(Hz)return $k;Hz=1;var a=Ive(),t=/^\s+/;function e(r){return r&&r.slice(0,a(r)+1).replace(t,"")}return $k=e,$k}function AD(){if(Gz)return zk;Gz=1;var a=kw(),t=a.Symbol;return zk=t,zk}function Ove(){if(Vz)return Hk;Vz=1;var a=AD(),t=Object.prototype,e=t.hasOwnProperty,r=t.toString,n=a?a.toStringTag:void 0;function s(o){var l=e.call(o,n),c=o[n];try{o[n]=void 0;var u=!0}catch(h){}var d=r.call(o);return u&&(l?o[n]=c:delete o[n]),d}return Hk=s,Hk}function Fve(){if(Wz)return Gk;Wz=1;var a=Object.prototype,t=a.toString;function e(r){return t.call(r)}return Gk=e,Gk}function yV(){if(Uz)return Vk;Uz=1;var a=AD(),t=Ove(),e=Fve(),r="[object Null]",n="[object Undefined]",s=a?a.toStringTag:void 0;function o(l){return l==null?l===void 0?n:r:s&&s in Object(l)?t(l):e(l)}return Vk=o,Vk}function Rve(){if(jz)return Wk;jz=1;function a(t){return t!=null&&typeof t=="object"}return Wk=a,Wk}function lv(){if(Yz)return Uk;Yz=1;var a=yV(),t=Rve(),e="[object Symbol]";function r(n){return typeof n=="symbol"||t(n)&&a(n)==e}return Uk=r,Uk}function Nve(){if(qz)return jk;qz=1;var a=Ave(),t=ov(),e=lv(),r=NaN,n=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(u){if(typeof u=="number")return u;if(e(u))return r;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=a(u);var h=s.test(u);return h||o.test(u)?l(u.slice(2),h?2:8):n.test(u)?r:+u}return jk=c,jk}function Bve(){if(Zz)return Yk;Zz=1;var a=ov(),t=Mve(),e=Nve(),r="Expected a function",n=Math.max,s=Math.min;function o(l,c,u){var d,h,f,m,g,y,v=0,E=!1,C=!1,_=!0;if(typeof l!="function")throw new TypeError(r);c=e(c)||0,a(u)&&(E=!!u.leading,C="maxWait"in u,f=C?n(e(u.maxWait)||0,c):f,_="trailing"in u?!!u.trailing:_);function x(N){var G=d,W=h;return d=h=void 0,v=N,m=l.apply(W,G),m}function P(N){return v=N,g=setTimeout(O,c),E?x(N):m}function I(N){var G=N-y,W=N-v,Y=c-G;return C?s(Y,f-W):Y}function M(N){var G=N-y,W=N-v;return y===void 0||G>=c||G<0||C&&W>=f}function O(){var N=t();if(M(N))return R(N);g=setTimeout(O,I(N))}function R(N){return g=void 0,_&&d?x(N):(d=h=void 0,m)}function F(){g!==void 0&&clearTimeout(g),v=0,d=y=h=g=void 0}function $(){return g===void 0?m:R(t())}function k(){var N=t(),G=M(N);if(d=arguments,h=this,y=N,G){if(g===void 0)return P(y);if(C)return clearTimeout(g),g=setTimeout(O,c),x(y)}return g===void 0&&(g=setTimeout(O,c)),m}return k.cancel=F,k.flush=$,k}return Yk=o,Yk}function Vve(a,t,e,r,n){var s=n*Math.PI/180,o=Math.cos(s)*(a-e)-Math.sin(s)*(t-r)+e,l=Math.sin(s)*(a-e)+Math.cos(s)*(t-r)+r;return{x:o,y:l}}function Uve(a,t,e){if(e===0)return a;var r=(t.x1+t.x2)/2,n=(t.y1+t.y2)/2,s=t.w/t.h,o=1/s,l=Vve(a.x,a.y,r,n,e),c=Wve(l.x,l.y,r,n,s,o);return{x:c.x,y:c.y}}function rye(){return eH||(eH=1,(function(a,t){(function(){var e,r,n,s,o,l,c,u,d,h,f,m,g,y,v;n=Math.floor,h=Math.min,r=function(E,C){return E<C?-1:E>C?1:0},d=function(E,C,_,x,P){var I;if(_==null&&(_=0),P==null&&(P=r),_<0)throw new Error("lo must be non-negative");for(x==null&&(x=E.length);_<x;)I=n((_+x)/2),P(C,E[I])<0?x=I:_=I+1;return[].splice.apply(E,[_,_-_].concat(C)),C},l=function(E,C,_){return _==null&&(_=r),E.push(C),y(E,0,E.length-1,_)},o=function(E,C){var _,x;return C==null&&(C=r),_=E.pop(),E.length?(x=E[0],E[0]=_,v(E,0,C)):x=_,x},u=function(E,C,_){var x;return _==null&&(_=r),x=E[0],E[0]=C,v(E,0,_),x},c=function(E,C,_){var x;return _==null&&(_=r),E.length&&_(E[0],C)<0&&(x=[E[0],C],C=x[0],E[0]=x[1],v(E,0,_)),C},s=function(E,C){var _,x,P,I,M,O;for(C==null&&(C=r),I=(function(){O=[];for(var R=0,F=n(E.length/2);0<=F?R<F:R>F;0<=F?R++:R--)O.push(R);return O}).apply(this).reverse(),M=[],x=0,P=I.length;x<P;x++)_=I[x],M.push(v(E,_,C));return M},g=function(E,C,_){var x;if(_==null&&(_=r),x=E.indexOf(C),x!==-1)return y(E,0,x,_),v(E,x,_)},f=function(E,C,_){var x,P,I,M,O;if(_==null&&(_=r),P=E.slice(0,C),!P.length)return P;for(s(P,_),O=E.slice(C),I=0,M=O.length;I<M;I++)x=O[I],c(P,x,_);return P.sort(_).reverse()},m=function(E,C,_){var x,P,I,M,O,R,F,$,k;if(_==null&&(_=r),C*10<=E.length){if(I=E.slice(0,C).sort(_),!I.length)return I;for(P=I[I.length-1],F=E.slice(C),M=0,R=F.length;M<R;M++)x=F[M],_(x,P)<0&&(d(I,x,0,null,_),I.pop(),P=I[I.length-1]);return I}for(s(E,_),k=[],O=0,$=h(C,E.length);0<=$?O<$:O>$;0<=$?++O:--O)k.push(o(E,_));return k},y=function(E,C,_,x){var P,I,M;for(x==null&&(x=r),P=E[_];_>C;){if(M=_-1>>1,I=E[M],x(P,I)<0){E[_]=I,_=M;continue}break}return E[_]=P},v=function(E,C,_){var x,P,I,M,O;for(_==null&&(_=r),P=E.length,O=C,I=E[C],x=2*C+1;x<P;)M=x+1,M<P&&!(_(E[x],E[M])<0)&&(x=M),E[C]=E[x],C=x,x=2*C+1;return E[C]=I,y(E,O,C,_)},e=(function(){E.push=l,E.pop=o,E.replace=u,E.pushpop=c,E.heapify=s,E.updateItem=g,E.nlargest=f,E.nsmallest=m;function E(C){this.cmp=C!=null?C:r,this.nodes=[]}return E.prototype.push=function(C){return l(this.nodes,C,this.cmp)},E.prototype.pop=function(){return o(this.nodes,this.cmp)},E.prototype.peek=function(){return this.nodes[0]},E.prototype.contains=function(C){return this.nodes.indexOf(C)!==-1},E.prototype.replace=function(C){return u(this.nodes,C,this.cmp)},E.prototype.pushpop=function(C){return c(this.nodes,C,this.cmp)},E.prototype.heapify=function(){return s(this.nodes,this.cmp)},E.prototype.updateItem=function(C){return g(this.nodes,C,this.cmp)},E.prototype.clear=function(){return this.nodes=[]},E.prototype.empty=function(){return this.nodes.length===0},E.prototype.size=function(){return this.nodes.length},E.prototype.clone=function(){var C;return C=new E,C.nodes=this.nodes.slice(0),C},E.prototype.toArray=function(){return this.nodes.slice(0)},E.prototype.insert=E.prototype.push,E.prototype.top=E.prototype.peek,E.prototype.front=E.prototype.peek,E.prototype.has=E.prototype.contains,E.prototype.copy=E.prototype.clone,E})(),(function(E,C){return a.exports=C()})(this,function(){return e})}).call(tye)})(tw)),tw.exports}function iye(){return tH||(tH=1,Zk=rye()),Zk}function Pye(a,t){if(a.length<3)throw new Error("Need at least 3 vertices");var e=function(O,R){return{x:O.x+R.x,y:O.y+R.y}},r=function(O,R){return{x:O.x-R.x,y:O.y-R.y}},n=function(O,R){return{x:O.x*R,y:O.y*R}},s=function(O,R){return O.x*R.y-O.y*R.x},o=function(O){var R=Dye(O.x,O.y);return R===0?{x:0,y:0}:{x:O.x/R,y:O.y/R}},l=function(O){for(var R=0,F=0;F<O.length;F++){var $=O[F],k=O[(F+1)%O.length];R+=$.x*k.y-k.x*$.y}return R/2},c=function(O,R,F,$){var k=r(R,O),N=r($,F),G=s(k,N);if(Math.abs(G)<1e-9)return e(O,n(k,.5));var W=s(r(F,O),N)/G;return e(O,n(k,W))},u=a.map(function(M){return{x:M.x,y:M.y}});l(u)<0&&u.reverse();for(var d=u.length,h=[],f=0;f<d;f++){var m=u[f],g=u[(f+1)%d],y=r(g,m),v=o({x:y.y,y:-y.x});h.push(v)}for(var E=h.map(function(M,O){var R=e(u[O],n(M,t)),F=e(u[(O+1)%d],n(M,t));return{p1:R,p2:F}}),C=[],_=0;_<d;_++){var x=E[(_-1+d)%d],P=E[_],I=c(x.p1,x.p2,P.p1,P.p2);C.push(I)}return C}function Lye(a,t,e,r,n,s){var o=$ye(a,t,e,r,n),l=Pye(o,s),c=Un();return l.forEach(function(u){return DV(c,u.x,u.y)}),c}function Qk(a,t){function e(h){for(var f=[],m=0;m<h.length;m++){var g=h[m],y=h[(m+1)%h.length],v={x:y.x-g.x,y:y.y-g.y},E={x:-v.y,y:v.x},C=Math.sqrt(E.x*E.x+E.y*E.y);f.push({x:E.x/C,y:E.y/C})}return f}function r(h,f){var m=1/0,g=-1/0,y=pa(h),v;try{for(y.s();!(v=y.n()).done;){var E=v.value,C=E.x*f.x+E.y*f.y;m=Math.min(m,C),g=Math.max(g,C)}}catch(_){y.e(_)}finally{y.f()}return{min:m,max:g}}function n(h,f){return!(h.max<f.min||f.max<h.min)}var s=[].concat(hw(e(a)),hw(e(t))),o=pa(s),l;try{for(o.s();!(l=o.n()).done;){var c=l.value,u=r(a,c),d=r(t,c);if(!n(u,d))return!1}}catch(h){o.e(h)}finally{o.f()}return!0}function Lw(a,t,e,r,n,s){var o;return ti(a)?o=a:o=Ef[a]||Ef.euclidean,t===0&&ti(a)?o(n,s):o(t,e,r,n,s)}function Mw(){if(bH)return t1;bH=1;var a=Array.isArray;return t1=a,t1}function Ibe(){if(wH)return r1;wH=1;var a=Mw(),t=lv(),e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function n(s,o){if(a(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||t(s)?!0:r.test(s)||!e.test(s)||o!=null&&s in Object(o)}return r1=n,r1}function Abe(){if(EH)return i1;EH=1;var a=yV(),t=ov(),e="[object AsyncFunction]",r="[object Function]",n="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!t(l))return!1;var c=a(l);return c==r||c==n||c==e||c==s}return i1=o,i1}function Obe(){if(TH)return n1;TH=1;var a=kw(),t=a["__core-js_shared__"];return n1=t,n1}function Fbe(){if(CH)return a1;CH=1;var a=Obe(),t=(function(){var r=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""})();function e(r){return!!t&&t in r}return a1=e,a1}function Rbe(){if(_H)return s1;_H=1;var a=Function.prototype,t=a.toString;function e(r){if(r!=null){try{return t.call(r)}catch(n){}try{return r+""}catch(n){}}return""}return s1=e,s1}function Nbe(){if(SH)return o1;SH=1;var a=Abe(),t=Fbe(),e=ov(),r=Rbe(),n=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,u=l.hasOwnProperty,d=RegExp("^"+c.call(u).replace(n,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(f){if(!e(f)||t(f))return!1;var m=a(f)?d:s;return m.test(r(f))}return o1=h,o1}function Bbe(){if(xH)return l1;xH=1;function a(t,e){return t==null?void 0:t[e]}return l1=a,l1}function GD(){if(kH)return c1;kH=1;var a=Nbe(),t=Bbe();function e(r,n){var s=t(r,n);return a(s)?s:void 0}return c1=e,c1}function Iw(){if(DH)return u1;DH=1;var a=GD(),t=a(Object,"create");return u1=t,u1}function $be(){if(PH)return d1;PH=1;var a=Iw();function t(){this.__data__=a?a(null):{},this.size=0}return d1=t,d1}function zbe(){if(LH)return h1;LH=1;function a(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}return h1=a,h1}function Hbe(){if(MH)return f1;MH=1;var a=Iw(),t="__lodash_hash_undefined__",e=Object.prototype,r=e.hasOwnProperty;function n(s){var o=this.__data__;if(a){var l=o[s];return l===t?void 0:l}return r.call(o,s)?o[s]:void 0}return f1=n,f1}function Gbe(){if(IH)return p1;IH=1;var a=Iw(),t=Object.prototype,e=t.hasOwnProperty;function r(n){var s=this.__data__;return a?s[n]!==void 0:e.call(s,n)}return p1=r,p1}function Vbe(){if(AH)return m1;AH=1;var a=Iw(),t="__lodash_hash_undefined__";function e(r,n){var s=this.__data__;return this.size+=this.has(r)?0:1,s[r]=a&&n===void 0?t:n,this}return m1=e,m1}function Wbe(){if(OH)return g1;OH=1;var a=$be(),t=zbe(),e=Hbe(),r=Gbe(),n=Vbe();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=a,s.prototype.delete=t,s.prototype.get=e,s.prototype.has=r,s.prototype.set=n,g1=s,g1}function Ube(){if(FH)return v1;FH=1;function a(){this.__data__=[],this.size=0}return v1=a,v1}function VV(){if(RH)return y1;RH=1;function a(t,e){return t===e||t!==t&&e!==e}return y1=a,y1}function Aw(){if(NH)return b1;NH=1;var a=VV();function t(e,r){for(var n=e.length;n--;)if(a(e[n][0],r))return n;return-1}return b1=t,b1}function jbe(){if(BH)return w1;BH=1;var a=Aw(),t=Array.prototype,e=t.splice;function r(n){var s=this.__data__,o=a(s,n);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():e.call(s,o,1),--this.size,!0}return w1=r,w1}function Ybe(){if($H)return E1;$H=1;var a=Aw();function t(e){var r=this.__data__,n=a(r,e);return n<0?void 0:r[n][1]}return E1=t,E1}function qbe(){if(zH)return T1;zH=1;var a=Aw();function t(e){return a(this.__data__,e)>-1}return T1=t,T1}function Zbe(){if(HH)return C1;HH=1;var a=Aw();function t(e,r){var n=this.__data__,s=a(n,e);return s<0?(++this.size,n.push([e,r])):n[s][1]=r,this}return C1=t,C1}function Kbe(){if(GH)return _1;GH=1;var a=Ube(),t=jbe(),e=Ybe(),r=qbe(),n=Zbe();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=a,s.prototype.delete=t,s.prototype.get=e,s.prototype.has=r,s.prototype.set=n,_1=s,_1}function Xbe(){if(VH)return S1;VH=1;var a=GD(),t=kw(),e=a(t,"Map");return S1=e,S1}function Jbe(){if(WH)return x1;WH=1;var a=Wbe(),t=Kbe(),e=Xbe();function r(){this.size=0,this.__data__={hash:new a,map:new(e||t),string:new a}}return x1=r,x1}function Qbe(){if(UH)return k1;UH=1;function a(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}return k1=a,k1}function Ow(){if(jH)return D1;jH=1;var a=Qbe();function t(e,r){var n=e.__data__;return a(r)?n[typeof r=="string"?"string":"hash"]:n.map}return D1=t,D1}function e0e(){if(YH)return P1;YH=1;var a=Ow();function t(e){var r=a(this,e).delete(e);return this.size-=r?1:0,r}return P1=t,P1}function t0e(){if(qH)return L1;qH=1;var a=Ow();function t(e){return a(this,e).get(e)}return L1=t,L1}function r0e(){if(ZH)return M1;ZH=1;var a=Ow();function t(e){return a(this,e).has(e)}return M1=t,M1}function i0e(){if(KH)return I1;KH=1;var a=Ow();function t(e,r){var n=a(this,e),s=n.size;return n.set(e,r),this.size+=n.size==s?0:1,this}return I1=t,I1}function n0e(){if(XH)return A1;XH=1;var a=Jbe(),t=e0e(),e=t0e(),r=r0e(),n=i0e();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=a,s.prototype.delete=t,s.prototype.get=e,s.prototype.has=r,s.prototype.set=n,A1=s,A1}function a0e(){if(JH)return O1;JH=1;var a=n0e(),t="Expected a function";function e(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new TypeError(t);var s=function(){var o=arguments,l=n?n.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var u=r.apply(this,o);return s.cache=c.set(l,u)||c,u};return s.cache=new(e.Cache||a),s}return e.Cache=a,O1=e,O1}function s0e(){if(QH)return F1;QH=1;var a=a0e(),t=500;function e(r){var n=a(r,function(o){return s.size===t&&s.clear(),o}),s=n.cache;return n}return F1=e,F1}function WV(){if(eG)return R1;eG=1;var a=s0e(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,e=/\\(\\)?/g,r=a(function(n){var s=[];return n.charCodeAt(0)===46&&s.push(""),n.replace(t,function(o,l,c,u){s.push(c?u.replace(e,"$1"):l||o)}),s});return R1=r,R1}function UV(){if(tG)return N1;tG=1;function a(t,e){for(var r=-1,n=t==null?0:t.length,s=Array(n);++r<n;)s[r]=e(t[r],r,t);return s}return N1=a,N1}function o0e(){if(rG)return B1;rG=1;var a=AD(),t=UV(),e=Mw(),r=lv(),n=a?a.prototype:void 0,s=n?n.toString:void 0;function o(l){if(typeof l=="string")return l;if(e(l))return t(l,o)+"";if(r(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return B1=o,B1}function jV(){if(iG)return $1;iG=1;var a=o0e();function t(e){return e==null?"":a(e)}return $1=t,$1}function YV(){if(nG)return z1;nG=1;var a=Mw(),t=Ibe(),e=WV(),r=jV();function n(s,o){return a(s)?s:t(s,o)?[s]:e(r(s))}return z1=n,z1}function VD(){if(aG)return H1;aG=1;var a=lv();function t(e){if(typeof e=="string"||a(e))return e;var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}return H1=t,H1}function l0e(){if(sG)return G1;sG=1;var a=YV(),t=VD();function e(r,n){n=a(n,r);for(var s=0,o=n.length;r!=null&&s<o;)r=r[t(n[s++])];return s&&s==o?r:void 0}return G1=e,G1}function c0e(){if(oG)return V1;oG=1;var a=l0e();function t(e,r,n){var s=e==null?void 0:a(e,r);return s===void 0?n:s}return V1=t,V1}function h0e(){if(lG)return W1;lG=1;var a=GD(),t=(function(){try{var e=a(Object,"defineProperty");return e({},"",{}),e}catch(r){}})();return W1=t,W1}function f0e(){if(cG)return U1;cG=1;var a=h0e();function t(e,r,n){r=="__proto__"&&a?a(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}return U1=t,U1}function p0e(){if(uG)return j1;uG=1;var a=f0e(),t=VV(),e=Object.prototype,r=e.hasOwnProperty;function n(s,o,l){var c=s[o];(!(r.call(s,o)&&t(c,l))||l===void 0&&!(o in s))&&a(s,o,l)}return j1=n,j1}function m0e(){if(dG)return Y1;dG=1;var a=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function e(r,n){var s=typeof r;return n=n==null?a:n,!!n&&(s=="number"||s!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<n}return Y1=e,Y1}function g0e(){if(hG)return q1;hG=1;var a=p0e(),t=YV(),e=m0e(),r=ov(),n=VD();function s(o,l,c,u){if(!r(o))return o;l=t(l,o);for(var d=-1,h=l.length,f=h-1,m=o;m!=null&&++d<h;){var g=n(l[d]),y=c;if(g==="__proto__"||g==="constructor"||g==="prototype")return o;if(d!=f){var v=m[g];y=u?u(v,g,m):void 0,y===void 0&&(y=r(v)?v:e(l[d+1])?[]:{})}a(m,g,y),m=m[g]}return o}return q1=s,q1}function v0e(){if(fG)return Z1;fG=1;var a=g0e();function t(e,r,n){return e==null?e:a(e,r,n)}return Z1=t,Z1}function w0e(){if(pG)return K1;pG=1;function a(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}return K1=a,K1}function E0e(){if(mG)return X1;mG=1;var a=UV(),t=w0e(),e=Mw(),r=lv(),n=WV(),s=VD(),o=jV();function l(c){return e(c)?a(c,s):r(c)?[c]:t(n(o(c)))}return X1=l,X1}function UD(a,t,e,r){for(var n=[],s=new Cf,o=a.cy(),l=o.hasCompoundNodes(),c=0;c<a.length;c++){var u=a[c];e?n.push(u):l&&r(n,s,u)}for(;n.length>0;){var d=n.shift();t(d),s.add(d.id()),l&&r(n,s,d)}return a}function ZV(a,t,e){if(e.isParent())for(var r=e._private.children,n=0;n<r.length;n++){var s=r[n];t.has(s.id())||a.push(s)}}function KV(a,t,e){if(e.isChild()){var r=e._private.parent;t.has(r.id())||a.push(r)}}function H0e(a,t,e){KV(a,t,e),ZV(a,t,e)}function J1(a){return function(t){var e=this;if(t===void 0&&(t=!0),e.length!==0)if(e.isNode()&&!e.removed()){for(var r=0,n=e[0],s=n._private.edges,o=0;o<s.length;o++){var l=s[o];!t&&l.isLoop()||(r+=a(n,l))}return r}else return}}function sf(a,t){return function(e){for(var r,n=this.nodes(),s=0;s<n.length;s++){var o=n[s],l=o[a](e);l!==void 0&&(r===void 0||t(l,r))&&(r=l)}return r}}function Ng(){return!1}function Z0(){return!0}function Rw(){for(var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:swe,t=arguments.length>1?arguments[1]:void 0,e=0;e<TG.length;e++){var r=TG[e];this[r]=a[r]||s5[r]}this.context=t||this.context,this.listeners=[],this.emitting=0}function d5(a,t,e){var r=e._private,n=r.styleCache=r.styleCache||[],s;return(s=n[a])!=null||(s=n[a]=t(e)),s}function Nw(a,t){return a=Yu(a),function(r){return d5(a,t,r)}}function Bw(a,t){a=Yu(a);var e=function(n){return t.call(n)};return function(){var n=this[0];if(n)return d5(a,e,n)}}function eD(a,t){var e=a._private,r=e.data.parent?a.parents():null;if(r)for(var n=0;n<r.length;n++){var s=r[n];if(!t(s))return!1}return!0}function jD(a){var t=a.ok,e=a.edgeOkViaNode||a.ok,r=a.parentOk||a.ok;return function(){var n=this.cy();if(!n.styleEnabled())return!0;var s=this[0],o=n.hasCompoundNodes();if(s){var l=s._private;if(!t(s))return!1;if(s.isNode())return!o||eD(s,r);var c=l.source,u=l.target;return e(c)&&(!o||eD(c,e))&&(c===u||e(u)&&(!o||eD(u,e)))}}}function _G(a){return function(){var t=arguments,e=[];if(t.length===2){var r=t[0],n=t[1];this.on(a.event,r,n)}else if(t.length===1&&ti(t[0])){var s=t[0];this.on(a.event,s)}else if(t.length===0||t.length===1&&Pr(t[0])){for(var o=t.length===1?t[0]:null,l=0;l<this.length;l++){var c=this[l],u=!a.ableField||c._private[a.ableField],d=c._private[a.field]!=a.value;if(a.overrideAble){var h=a.overrideAble(c);if(h!==void 0&&(u=h,!h))return this}u&&(c._private[a.field]=a.value,d&&e.push(c))}var f=this.spawn(e);f.updateStyle(),f.emit(a.event),o&&f.emit(o)}return this}}function xf(a){pc[a.field]=function(){var t=this[0];if(t){if(a.overrideField){var e=a.overrideField(t);if(e!==void 0)return e}return t._private[a.field]}},pc[a.on]=_G({event:a.on,field:a.field,ableField:a.ableField,overrideAble:a.overrideAble,value:!0}),pc[a.off]=_G({event:a.off,field:a.field,ableField:a.ableField,overrideAble:a.overrideAble,value:!1})}function DG(a){return function(e){for(var r=[],n=0;n<this.length;n++){var s=this[n],o=s._private[a.attr];o&&r.push(o)}return this.spawn(r,!0).filter(e)}}function PG(a){return function(e){var r=[],n=this._private.cy,s=a||{};at(e)&&(e=n.$(e));for(var o=0;o<e.length;o++)for(var l=e[o]._private.edges,c=0;c<l.length;c++){var u=l[c],d=u._private.data,h=this.hasElementWithId(d.source)&&e.hasElementWithId(d.target),f=e.hasElementWithId(d.source)&&this.hasElementWithId(d.target),m=h||f;m&&((s.thisIsSrc||s.thisIsTgt)&&(s.thisIsSrc&&!h||s.thisIsTgt&&!f)||r.push(u))}return this.spawn(r,!0)}}function LG(a){var t={codirected:!1};return a=ut({},t,a),function(r){for(var n=[],s=this.edges(),o=a,l=0;l<s.length;l++)for(var c=s[l],u=c._private,d=u.source,h=d._private.data.id,f=u.data.target,m=d._private.edges,g=0;g<m.length;g++){var y=m[g],v=y._private.data,E=v.target,C=v.source,_=E===f&&C===h,x=h===E&&f===C;(o.codirected&&_||!o.codirected&&(_||x))&&n.push(y)}return this.spawn(n,!0).filter(r)}}function vwe(a,t,e,r){var n=4,s=.001,o=1e-7,l=10,c=11,u=1/(c-1),d=typeof Float32Array!="undefined";if(arguments.length!==4)return!1;for(var h=0;h<4;++h)if(typeof arguments[h]!="number"||isNaN(arguments[h])||!isFinite(arguments[h]))return!1;a=Math.min(a,1),e=Math.min(e,1),a=Math.max(a,0),e=Math.max(e,0);var f=d?new Float32Array(c):new Array(c);function m(F,$){return 1-3*$+3*F}function g(F,$){return 3*$-6*F}function y(F){return 3*F}function v(F,$,k){return((m($,k)*F+g($,k))*F+y($))*F}function E(F,$,k){return 3*m($,k)*F*F+2*g($,k)*F+y($)}function C(F,$){for(var k=0;k<n;++k){var N=E($,a,e);if(N===0)return $;var G=v($,a,e)-F;$-=G/N}return $}function _(){for(var F=0;F<c;++F)f[F]=v(F*u,a,e)}function x(F,$,k){var N,G,W=0;do G=$+(k-$)/2,N=v(G,a,e)-F,N>0?k=G:$=G;while(Math.abs(N)>o&&++W<l);return G}function P(F){for(var $=0,k=1,N=c-1;k!==N&&f[k]<=F;++k)$+=u;--k;var G=(F-f[k])/(f[k+1]-f[k]),W=$+G*u,Y=E(W,a,e);return Y>=s?C(F,W):Y===0?W:x(F,$,$+u)}var I=!1;function M(){I=!0,(a!==t||e!==r)&&_()}var O=function($){return I||M(),a===t&&e===r?$:$===0?0:$===1?1:v(P($),t,r)};O.getControlPoints=function(){return[{x:a,y:t},{x:e,y:r}]};var R="generateBezier("+[a,t,e,r]+")";return O.toString=function(){return R},O}function MG(a,t,e,r,n){if(r===1||t===e)return e;var s=n(t,e,r);return a==null||((a.roundValue||a.color)&&(s=Math.round(s)),a.min!==void 0&&(s=Math.max(s,a.min)),a.max!==void 0&&(s=Math.min(s,a.max))),s}function IG(a,t){return a.pfValue!=null||a.value!=null?a.pfValue!=null&&(t==null||t.type.units!=="%")?a.pfValue:a.value:a}function of(a,t,e,r,n){var s=n!=null?n.type:null;e<0?e=0:e>1&&(e=1);var o=IG(a,n),l=IG(t,n);if(We(o)&&We(l))return MG(s,o,l,e,r);if(Pr(o)&&Pr(l)){for(var c=[],u=0;u<l.length;u++){var d=o[u],h=l[u];if(d!=null&&h!=null){var f=MG(s,d,h,e,r);c.push(f)}else c.push(h)}return c}}function bwe(a,t,e,r){var n=!r,s=a._private,o=t._private,l=o.easing,c=o.startTime,u=r?a:a.cy(),d=u.style();if(!o.easingImpl)if(l==null)o.easingImpl=sw.linear;else{var h;if(at(l)){var f=d.parse("transition-timing-function",l);h=f.value}else h=l;var m,g;at(h)?(m=h,g=[]):(m=h[1],g=h.slice(2).map(function(q){return+q})),g.length>0?(m==="spring"&&g.push(o.duration),o.easingImpl=sw[m].apply(null,g)):o.easingImpl=sw[m]}var y=o.easingImpl,v;if(o.duration===0?v=1:v=(e-c)/o.duration,o.applying&&(v=o.progress),v<0?v=0:v>1&&(v=1),o.delay==null){var E=o.startPosition,C=o.position;if(C&&n&&!a.locked()){var _={};Bg(E.x,C.x)&&(_.x=of(E.x,C.x,v,y)),Bg(E.y,C.y)&&(_.y=of(E.y,C.y,v,y)),a.position(_)}var x=o.startPan,P=o.pan,I=s.pan,M=P!=null&&r;M&&(Bg(x.x,P.x)&&(I.x=of(x.x,P.x,v,y)),Bg(x.y,P.y)&&(I.y=of(x.y,P.y,v,y)),a.emit("pan"));var O=o.startZoom,R=o.zoom,F=R!=null&&r;F&&(Bg(O,R)&&(s.zoom=Xg(s.minZoom,of(O,R,v,y),s.maxZoom)),a.emit("zoom")),(M||F)&&a.emit("viewport");var $=o.style;if($&&$.length>0&&n){for(var k=0;k<$.length;k++){var N=$[k],G=N.name,W=N,Y=o.startStyle[G],U=d.properties[Y.name],Z=of(Y,W,v,y,U);d.overrideBypass(a,G,Z)}a.emit("style")}}return o.progress=v,v}function Bg(a,t){return a==null||t==null?!1:We(a)&&We(t)?!0:!!(a&&t)}function wwe(a,t,e,r){var n=t._private;n.started=!0,n.startTime=e-n.progress*n.duration}function AG(a,t){var e=t._private.aniEles,r=[];function n(d,h){var f=d._private,m=f.animation.current,g=f.animation.queue,y=!1;if(m.length===0){var v=g.shift();v&&m.push(v)}for(var E=function(I){for(var M=I.length-1;M>=0;M--){var O=I[M];O()}I.splice(0,I.length)},C=m.length-1;C>=0;C--){var _=m[C],x=_._private;if(x.stopped){m.splice(C,1),x.hooked=!1,x.playing=!1,x.started=!1,E(x.frames);continue}!x.playing&&!x.applying||(x.playing&&x.applying&&(x.applying=!1),x.started||wwe(d,_,a),bwe(d,_,a,h),x.applying&&(x.applying=!1),E(x.frames),x.step!=null&&x.step(a),_.completed()&&(m.splice(C,1),x.hooked=!1,x.playing=!1,x.started=!1,E(x.completes)),y=!0)}return!h&&m.length===0&&g.length===0&&r.push(d),y}for(var s=!1,o=0;o<e.length;o++){var l=e[o],c=n(l);s=s||c}var u=n(t,!0);(s||u)&&(e.length>0?t.notify("draw",e):t.notify("draw")),e.unmerge(r),t.emit("step")}function f5(a){this.options=ut({},Dwe,Pwe,a)}function p5(a){this.options=ut({},Lwe,a)}function m5(a){this.options=ut({},Mwe,a)}function Hw(a){this.options=ut({},Iwe,a),this.options.layout=this;var t=this.options.eles.nodes(),e=this.options.eles.edges(),r=e.filter(function(n){var s=n.source().data("id"),o=n.target().data("id"),l=t.some(function(u){return u.data("id")===s}),c=t.some(function(u){return u.data("id")===o});return!l||!c});this.options.eles=this.options.eles.not(r)}function b5(a){this.options=ut({},Ywe,a)}function ZD(a){this.options=ut({},qwe,a)}function w5(a){this.options=ut({},Zwe,a)}function E5(a){this.options=ut({},Kwe,a)}function T5(a){this.options=a,this.notifications=0}function S5(a,t){t.radius===0?a.lineTo(t.cx,t.cy):a.arc(t.cx,t.cy,t.radius,t.startAngle,t.endAngle,t.counterClockwise)}function XD(a,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return r===0||t.radius===0?{cx:t.x,cy:t.y,radius:0,startX:t.x,startY:t.y,stopX:t.x,stopY:t.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(Qwe(a,t,e,r,n),{cx:ED,cy:TD,radius:Vu,startX:C5,startY:_5,stopX:CD,stopY:_D,startAngle:fo.ang+Math.PI/2*Uu,endAngle:ls.ang-Math.PI/2*Uu,counterClockwise:cw})}function x5(a){var t=[];if(a!=null){for(var e=0;e<a.length;e+=2){var r=a[e],n=a[e+1];t.push({x:r,y:n})}return t}}function tEe(a,t,e){for(var r=function(u,d,h,f){return qi(u,d,h,f)},n=t._private,s=n.rstyle.bezierPts,o=0;o<a.bezierProjPcts.length;o++){var l=a.bezierProjPcts[o];s.push({x:r(e[0],e[2],e[4],l),y:r(e[1],e[3],e[5],l)})}}function MEe(a,t){for(var e=0;e<t.length;e++){var r=t[e];a.lineTo(r.x,r.y)}}function IEe(a,t,e){for(var r,n=0;n<t.length;n++){var s=t[n];n===0&&(r=s),a.lineTo(s.x,s.y)}a.quadraticCurveTo(e.x,e.y,r.x,r.y)}function XG(a,t,e){a.beginPath&&a.beginPath();for(var r=t,n=0;n<r.length;n++){var s=r[n];a.lineTo(s.x,s.y)}var o=e,l=e[0];a.moveTo(l.x,l.y);for(var n=1;n<o.length;n++){var s=o[n];a.lineTo(s.x,s.y)}a.closePath&&a.closePath()}function AEe(a,t,e,r,n){a.beginPath&&a.beginPath(),a.arc(e,r,n,0,Math.PI*2,!1);var s=t,o=s[0];a.moveTo(o.x,o.y);for(var l=0;l<s.length;l++){var c=s[l];a.lineTo(c.x,c.y)}a.closePath&&a.closePath()}function OEe(a,t,e,r){a.arc(t,e,r,0,Math.PI*2,!1)}function zEe(a,t,e,r,n){var s=Math.min(r,n),o=s/2,l=t+r/2,c=e+n/2;a.beginPath(),a.arc(l,c,o,0,Math.PI*2),a.closePath()}function JG(a,t,e,r,n){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=Math.min(s,r/2,n/2);a.beginPath(),a.moveTo(t+o,e),a.lineTo(t+r-o,e),a.quadraticCurveTo(t+r,e,t+r,e+o),a.lineTo(t+r,e+n-o),a.quadraticCurveTo(t+r,e+n,t+r-o,e+n),a.lineTo(t+o,e+n),a.quadraticCurveTo(t,e+n,t,e+n-o),a.lineTo(t,e+o),a.quadraticCurveTo(t,e,t+o,e),a.closePath()}function QG(a,t,e){var r=a.createShader(t);if(a.shaderSource(r,e),a.compileShader(r),!a.getShaderParameter(r,a.COMPILE_STATUS))throw new Error(a.getShaderInfoLog(r));return r}function GEe(a,t,e){var r=QG(a,a.VERTEX_SHADER,t),n=QG(a,a.FRAGMENT_SHADER,e),s=a.createProgram();if(a.attachShader(s,r),a.attachShader(s,n),a.linkProgram(s),!a.getProgramParameter(s,a.LINK_STATUS))throw new Error("Could not initialize shaders");return s}function VEe(a,t,e){e===void 0&&(e=t);var r=a.makeOffscreenCanvas(t,e),n=r.context=r.getContext("2d");return r.clear=function(){return n.clearRect(0,0,r.width,r.height)},r.clear(),r}function eP(a){var t=a.pixelRatio,e=a.cy.zoom(),r=a.cy.pan();return{zoom:e*t,pan:{x:r.x*t,y:r.y*t}}}function WEe(a){var t=a.pixelRatio,e=a.cy.zoom();return e*t}function UEe(a,t,e,r,n){var s=r*e+t.x,o=n*e+t.y;return o=Math.round(a.canvasHeight-o),[s,o]}function jEe(a){return a.pstyle("background-fill").value!=="solid"||a.pstyle("background-image").strValue!=="none"?!1:a.pstyle("border-width").value===0||a.pstyle("border-opacity").value===0?!0:a.pstyle("border-style").value==="solid"}function YEe(a,t){if(a.length!==t.length)return!1;for(var e=0;e<a.length;e++)if(a[e]!==t[e])return!1;return!0}function zu(a,t,e){var r=a[0]/255,n=a[1]/255,s=a[2]/255,o=t,l=e||new Array(4);return l[0]=r*o,l[1]=n*o,l[2]=s*o,l[3]=o,l}function uf(a,t){var e=t||new Array(4);return e[0]=(a>>0&255)/255,e[1]=(a>>8&255)/255,e[2]=(a>>16&255)/255,e[3]=(a>>24&255)/255,e}function qEe(a){return a[0]+(a[1]<<8)+(a[2]<<16)+(a[3]<<24)}function ZEe(a,t){var e=a.createTexture();return e.buffer=function(r){a.bindTexture(a.TEXTURE_2D,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,r),a.generateMipmap(a.TEXTURE_2D),a.bindTexture(a.TEXTURE_2D,null)},e.deleteTexture=function(){a.deleteTexture(e)},e}function $5(a,t){switch(t){case"float":return[1,a.FLOAT,4];case"vec2":return[2,a.FLOAT,4];case"vec3":return[3,a.FLOAT,4];case"vec4":return[4,a.FLOAT,4];case"int":return[1,a.INT,4];case"ivec2":return[2,a.INT,4]}}function z5(a,t,e){switch(t){case a.FLOAT:return new Float32Array(e);case a.INT:return new Int32Array(e)}}function KEe(a,t,e,r,n,s){switch(t){case a.FLOAT:return new Float32Array(e.buffer,s*r,n);case a.INT:return new Int32Array(e.buffer,s*r,n)}}function XEe(a,t,e,r){var n=$5(a,t),s=Ci(n,2),o=s[0],l=s[1],c=z5(a,l,r),u=a.createBuffer();return a.bindBuffer(a.ARRAY_BUFFER,u),a.bufferData(a.ARRAY_BUFFER,c,a.STATIC_DRAW),l===a.FLOAT?a.vertexAttribPointer(e,o,l,!1,0,0):l===a.INT&&a.vertexAttribIPointer(e,o,l,0,0),a.enableVertexAttribArray(e),a.bindBuffer(a.ARRAY_BUFFER,null),u}function ho(a,t,e,r){var n=$5(a,e),s=Ci(n,3),o=s[0],l=s[1],c=s[2],u=z5(a,l,t*o),d=o*c,h=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,h),a.bufferData(a.ARRAY_BUFFER,t*d,a.DYNAMIC_DRAW),a.enableVertexAttribArray(r),l===a.FLOAT?a.vertexAttribPointer(r,o,l,!1,d,0):l===a.INT&&a.vertexAttribIPointer(r,o,l,d,0),a.vertexAttribDivisor(r,1),a.bindBuffer(a.ARRAY_BUFFER,null);for(var f=new Array(t),m=0;m<t;m++)f[m]=KEe(a,l,u,d,o,m);return h.dataArray=u,h.stride=d,h.size=o,h.getView=function(g){return f[g]},h.setPoint=function(g,y,v){var E=f[g];E[0]=y,E[1]=v},h.bufferSubData=function(g){a.bindBuffer(a.ARRAY_BUFFER,h),g?a.bufferSubData(a.ARRAY_BUFFER,0,u,0,g*o):a.bufferSubData(a.ARRAY_BUFFER,0,u)},h}function JEe(a,t,e){for(var r=9,n=new Float32Array(t*r),s=new Array(t),o=0;o<t;o++){var l=o*r*4;s[o]=new Float32Array(n.buffer,l,r)}var c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,n.byteLength,a.DYNAMIC_DRAW);for(var u=0;u<3;u++){var d=e+u;a.enableVertexAttribArray(d),a.vertexAttribPointer(d,3,a.FLOAT,!1,36,u*12),a.vertexAttribDivisor(d,1)}return a.bindBuffer(a.ARRAY_BUFFER,null),c.getMatrixView=function(h){return s[h]},c.setData=function(h,f){s[f].set(h,0)},c.bufferSubData=function(){a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferSubData(a.ARRAY_BUFFER,0,n)},c}function QEe(a){var t=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,t);var e=a.createTexture();return a.bindTexture(a.TEXTURE_2D,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),a.bindFramebuffer(a.FRAMEBUFFER,null),t.setFramebufferAttachmentSizes=function(r,n){a.bindTexture(a.TEXTURE_2D,e),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,r,n,0,a.RGBA,a.UNSIGNED_BYTE,null)},t}function nD(){var a=new eV(9);return eV!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function tV(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function eTe(a,t,e){var r=t[0],n=t[1],s=t[2],o=t[3],l=t[4],c=t[5],u=t[6],d=t[7],h=t[8],f=e[0],m=e[1],g=e[2],y=e[3],v=e[4],E=e[5],C=e[6],_=e[7],x=e[8];return a[0]=f*r+m*o+g*u,a[1]=f*n+m*l+g*d,a[2]=f*s+m*c+g*h,a[3]=y*r+v*o+E*u,a[4]=y*n+v*l+E*d,a[5]=y*s+v*c+E*h,a[6]=C*r+_*o+x*u,a[7]=C*n+_*l+x*d,a[8]=C*s+_*c+x*h,a}function dw(a,t,e){var r=t[0],n=t[1],s=t[2],o=t[3],l=t[4],c=t[5],u=t[6],d=t[7],h=t[8],f=e[0],m=e[1];return a[0]=r,a[1]=n,a[2]=s,a[3]=o,a[4]=l,a[5]=c,a[6]=f*r+m*o+u,a[7]=f*n+m*l+d,a[8]=f*s+m*c+h,a}function rV(a,t,e){var r=t[0],n=t[1],s=t[2],o=t[3],l=t[4],c=t[5],u=t[6],d=t[7],h=t[8],f=Math.sin(e),m=Math.cos(e);return a[0]=m*r+f*o,a[1]=m*n+f*l,a[2]=m*s+f*c,a[3]=m*o-f*r,a[4]=m*l-f*n,a[5]=m*c-f*s,a[6]=u,a[7]=d,a[8]=h,a}function xD(a,t,e){var r=e[0],n=e[1];return a[0]=r*t[0],a[1]=r*t[1],a[2]=r*t[2],a[3]=n*t[3],a[4]=n*t[4],a[5]=n*t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a}function tTe(a,t,e){return a[0]=2/t,a[1]=0,a[2]=0,a[3]=0,a[4]=-2/e,a[5]=0,a[6]=-1,a[7]=1,a[8]=1,a}function nTe(a,t){return a.intersection?a.intersection(t):new Set(hw(a).filter(function(e){return t.has(e)}))}function hTe(a){var t=a.cy.container(),e=t&&t.style&&t.style.backgroundColor||"white";return mV(e)}function G5(a,t){var e=a._private.rscratch;return ha(e,"labelWrapCachedLines",t)||[]}function fTe(a){{var t=a.render;a.render=function(s){s=s||{};var o=a.cy;a.webgl&&(o.zoom()>O5?(pTe(a),t.call(a,s)):(mTe(a),W5(a,s,Yg.SCREEN)))}}{var e=a.matchCanvasSize;a.matchCanvasSize=function(s){e.call(a,s),a.pickingFrameBuffer.setFramebufferAttachmentSizes(a.canvasWidth,a.canvasHeight),a.pickingFrameBuffer.needsDraw=!0}}a.findNearestElements=function(s,o,l,c){return ETe(a,s,o)};{var r=a.invalidateCachedZSortedEles;a.invalidateCachedZSortedEles=function(){r.call(a),a.pickingFrameBuffer.needsDraw=!0}}{var n=a.notify;a.notify=function(s,o){n.call(a,s,o),s==="viewport"||s==="bounds"?a.pickingFrameBuffer.needsDraw=!0:s==="background"&&a.drawing.invalidate(o,{type:"node-body"})}}}function pTe(a){var t=a.data.contexts[a.WEBGL];t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}function mTe(a){var t=function(r){r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,a.canvasWidth,a.canvasHeight),r.restore()};t(a.data.contexts[a.NODE]),t(a.data.contexts[a.DRAG])}function gTe(a){var t=a.canvasWidth,e=a.canvasHeight,r=eP(a),n=r.pan,s=r.zoom,o=nD();dw(o,o,[n.x,n.y]),xD(o,o,[s,s]);var l=nD();tTe(l,t,e);var c=nD();return eTe(c,l,o),c}function V5(a,t){var e=a.canvasWidth,r=a.canvasHeight,n=eP(a),s=n.pan,o=n.zoom;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e,r),t.translate(s.x,s.y),t.scale(o,o)}function vTe(a,t){a.drawSelectionRectangle(t,function(e){return V5(a,e)})}function yTe(a){var t=a.data.contexts[a.NODE];t.save(),V5(a,t),t.strokeStyle="rgba(0, 0, 0, 0.3)",t.beginPath(),t.moveTo(-1e3,0),t.lineTo(1e3,0),t.stroke(),t.beginPath(),t.moveTo(0,-1e3),t.lineTo(0,1e3),t.stroke(),t.restore()}function bTe(a){var t=function(n,s,o){for(var l=n.atlasManager.getAtlasCollection(s),c=a.data.contexts[a.NODE],u=l.atlases,d=0;d<u.length;d++){var h=u[d],f=h.canvas;if(f){var m=f.width,g=f.height,y=m*d,v=f.height*o,E=.4;c.save(),c.scale(E,E),c.drawImage(f,y,v),c.strokeStyle="black",c.rect(y,v,m,g),c.stroke(),c.restore()}}},e=0;t(a.drawing,"node",e++),t(a.drawing,"label",e++)}function wTe(a,t,e,r,n){var s,o,l,c,u=eP(a),d=u.pan,h=u.zoom;{var f=UEe(a,d,h,t,e),m=Ci(f,2),g=m[0],y=m[1],v=6;s=g-v/2,o=y-v/2,l=v,c=v}if(l===0||c===0)return[];var E=a.data.contexts[a.WEBGL];E.bindFramebuffer(E.FRAMEBUFFER,a.pickingFrameBuffer),a.pickingFrameBuffer.needsDraw&&(E.viewport(0,0,E.canvas.width,E.canvas.height),W5(a,null,Yg.PICKING),a.pickingFrameBuffer.needsDraw=!1);var C=l*c,_=new Uint8Array(C*4);E.readPixels(s,o,l,c,E.RGBA,E.UNSIGNED_BYTE,_),E.bindFramebuffer(E.FRAMEBUFFER,null);for(var x=new Set,P=0;P<C;P++){var I=_.slice(P*4,P*4+4),M=qEe(I)-1;M>=0&&x.add(M)}return x}function ETe(a,t,e){var r=wTe(a,t,e),n=a.getCachedZSortedEles(),s,o,l=pa(r),c;try{for(l.s();!(c=l.n()).done;){var u=c.value,d=n[u];if(!s&&d.isNode()&&(s=d),!o&&d.isEdge()&&(o=d),s&&o)break}}catch(h){l.e(h)}finally{l.f()}return[s,o].filter(Boolean)}function cD(a,t,e){var r=a.drawing;t+=1,e.isNode()?(r.drawNode(e,t,"node-underlay"),r.drawNode(e,t,"node-body"),r.drawTexture(e,t,"label"),r.drawNode(e,t,"node-overlay")):(r.drawEdgeLine(e,t),r.drawEdgeArrow(e,t,"source"),r.drawEdgeArrow(e,t,"target"),r.drawTexture(e,t,"label"),r.drawTexture(e,t,"edge-source-label"),r.drawTexture(e,t,"edge-target-label"))}function W5(a,t,e){var r;a.webglDebug&&(r=performance.now());var n=a.drawing,s=0;if(e.screen&&a.data.canvasNeedsRedraw[a.SELECT_BOX]&&vTe(a,t),a.data.canvasNeedsRedraw[a.NODE]||e.picking){var o=a.data.contexts[a.WEBGL];e.screen?(o.clearColor(0,0,0,0),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA)):o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.viewport(0,0,o.canvas.width,o.canvas.height);var l=gTe(a),c=a.getCachedZSortedEles();if(s=c.length,n.startFrame(l,e),e.screen){for(var u=0;u<c.nondrag.length;u++)cD(a,u,c.nondrag[u]);for(var d=0;d<c.drag.length;d++)cD(a,d,c.drag[d])}else if(e.picking)for(var h=0;h<c.length;h++)cD(a,h,c[h]);n.endFrame(),e.screen&&a.webglDebugShowAtlases&&(yTe(a),bTe(a)),a.data.canvasNeedsRedraw[a.NODE]=!1,a.data.canvasNeedsRedraw[a.DRAG]=!1}if(a.webglDebug){var f=performance.now(),m=!1,g=Math.ceil(f-r),y=n.getDebugInfo(),v=["".concat(s," elements"),"".concat(y.totalInstances," instances"),"".concat(y.batchCount," batches"),"".concat(y.totalAtlases," atlases"),"".concat(y.wrappedCount," wrapped textures"),"".concat(y.simpleCount," simple shapes")].join(", ");if(m)console.log("WebGL (".concat(e.name,") - time ").concat(g,"ms, ").concat(v));else{console.log("WebGL (".concat(e.name,") - frame time ").concat(g,"ms")),console.log("Totals:"),console.log("  ".concat(v)),console.log("Texture Atlases Used:");var E=y.atlasInfo,C=pa(E),_;try{for(C.s();!(_=C.n()).done;){var x=_.value;console.log("  ".concat(x.type,": ").concat(x.keyCount," keys, ").concat(x.atlasCount," atlases"))}}catch(P){C.e(P)}finally{C.f()}console.log("")}}a.data.gc&&(console.log("Garbage Collect!"),a.data.gc=!1,n.gc())}function TTe(a,t){for(var e=atob(a),r=new ArrayBuffer(e.length),n=new Uint8Array(r),s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return new Blob([r],{type:t})}function oV(a){var t=a.indexOf(",");return a.substr(t+1)}function j5(a,t,e){var r=function(){return t.toDataURL(e,a.quality)};switch(a.output){case"blob-promise":return new _f(function(n,s){try{t.toBlob(function(o){o!=null?n(o):s(new Error("`canvas.toBlob()` sent a null value in its callback"))},e,a.quality)}catch(o){s(o)}});case"blob":return TTe(oV(r()),e);case"base64":return oV(r());case"base64uri":default:return r()}}function q5(a){var t=this,e=t.cy.window(),r=e.document;a.webgl&&(Rt.CANVAS_LAYERS=t.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),t.data={canvases:new Array(Rt.CANVAS_LAYERS),contexts:new Array(Rt.CANVAS_LAYERS),canvasNeedsRedraw:new Array(Rt.CANVAS_LAYERS),bufferCanvases:new Array(Rt.BUFFER_COUNT),bufferContexts:new Array(Rt.CANVAS_LAYERS)};var n="-webkit-tap-highlight-color",s="rgba(0,0,0,0)";t.data.canvasContainer=r.createElement("div");var o=t.data.canvasContainer.style;t.data.canvasContainer.style[n]=s,o.position="relative",o.zIndex="0",o.overflow="hidden";var l=a.cy.container();l.appendChild(t.data.canvasContainer),l.style[n]=s;var c={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};vve()&&(c["-ms-touch-action"]="none",c["touch-action"]="none");for(var u=0;u<Rt.CANVAS_LAYERS;u++){var d=t.data.canvases[u]=r.createElement("canvas"),h=Rt.CANVAS_TYPES[u];t.data.contexts[u]=d.getContext(h),t.data.contexts[u]||qr("Could not create canvas of type "+h),Object.keys(c).forEach(function(Te){d.style[Te]=c[Te]}),d.style.position="absolute",d.setAttribute("data-id","layer"+u),d.style.zIndex=String(Rt.CANVAS_LAYERS-u),t.data.canvasContainer.appendChild(d),t.data.canvasNeedsRedraw[u]=!1}t.data.topCanvas=t.data.canvases[0],t.data.canvases[Rt.NODE].setAttribute("data-id","layer"+Rt.NODE+"-node"),t.data.canvases[Rt.SELECT_BOX].setAttribute("data-id","layer"+Rt.SELECT_BOX+"-selectbox"),t.data.canvases[Rt.DRAG].setAttribute("data-id","layer"+Rt.DRAG+"-drag"),t.data.canvases[Rt.WEBGL]&&t.data.canvases[Rt.WEBGL].setAttribute("data-id","layer"+Rt.WEBGL+"-webgl");for(var u=0;u<Rt.BUFFER_COUNT;u++)t.data.bufferCanvases[u]=r.createElement("canvas"),t.data.bufferContexts[u]=t.data.bufferCanvases[u].getContext("2d"),t.data.bufferCanvases[u].style.position="absolute",t.data.bufferCanvases[u].setAttribute("data-id","buffer"+u),t.data.bufferCanvases[u].style.zIndex=String(-u-1),t.data.bufferCanvases[u].style.visibility="hidden";t.pathsEnabled=!0;var f=Un(),m=function(me){return{x:(me.x1+me.x2)/2,y:(me.y1+me.y2)/2}},g=function(me){return{x:-me.w/2,y:-me.h/2}},y=function(me){var pe=me[0]._private,B=pe.oldBackgroundTimestamp===pe.backgroundTimestamp;return!B},v=function(me){return me[0]._private.nodeKey},E=function(me){return me[0]._private.labelStyleKey},C=function(me){return me[0]._private.sourceLabelStyleKey},_=function(me){return me[0]._private.targetLabelStyleKey},x=function(me,pe,B,oe,he){return t.drawElement(me,pe,B,!1,!1,he)},P=function(me,pe,B,oe,he){return t.drawElementText(me,pe,B,oe,"main",he)},I=function(me,pe,B,oe,he){return t.drawElementText(me,pe,B,oe,"source",he)},M=function(me,pe,B,oe,he){return t.drawElementText(me,pe,B,oe,"target",he)},O=function(me){return me.boundingBox(),me[0]._private.bodyBounds},R=function(me){return me.boundingBox(),me[0]._private.labelBounds.main||f},F=function(me){return me.boundingBox(),me[0]._private.labelBounds.source||f},$=function(me){return me.boundingBox(),me[0]._private.labelBounds.target||f},k=function(me,pe){return pe},N=function(me){return m(O(me))},G=function(me,pe,B){var oe=me?me+"-":"";return{x:pe.x+B.pstyle(oe+"text-margin-x").pfValue,y:pe.y+B.pstyle(oe+"text-margin-y").pfValue}},W=function(me,pe,B){var oe=me[0]._private.rscratch;return{x:oe[pe],y:oe[B]}},Y=function(me){return G("",W(me,"labelX","labelY"),me)},U=function(me){return G("source",W(me,"sourceLabelX","sourceLabelY"),me)},Z=function(me){return G("target",W(me,"targetLabelX","targetLabelY"),me)},q=function(me){return g(O(me))},X=function(me){return g(F(me))},ie=function(me){return g($(me))},j=function(me){var pe=R(me),B=g(R(me));if(me.isNode()){switch(me.pstyle("text-halign").value){case"left":B.x=-pe.w-(pe.leftPad||0);break;case"right":B.x=-(pe.rightPad||0);break}switch(me.pstyle("text-valign").value){case"top":B.y=-pe.h-(pe.topPad||0);break;case"bottom":B.y=-(pe.botPad||0);break}}return B},K=t.data.eleTxrCache=new Wg(t,{getKey:v,doesEleInvalidateKey:y,drawElement:x,getBoundingBox:O,getRotationPoint:N,getRotationOffset:q,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),se=t.data.lblTxrCache=new Wg(t,{getKey:E,drawElement:P,getBoundingBox:R,getRotationPoint:Y,getRotationOffset:j,isVisible:k}),ne=t.data.slbTxrCache=new Wg(t,{getKey:C,drawElement:I,getBoundingBox:F,getRotationPoint:U,getRotationOffset:X,isVisible:k}),ge=t.data.tlbTxrCache=new Wg(t,{getKey:_,drawElement:M,getBoundingBox:$,getRotationPoint:Z,getRotationOffset:ie,isVisible:k}),ve=t.data.lyrTxrCache=new F5(t);t.onUpdateEleCalcs(function(me,pe){K.invalidateElements(pe),se.invalidateElements(pe),ne.invalidateElements(pe),ge.invalidateElements(pe),ve.invalidateElements(pe);for(var B=0;B<pe.length;B++){var oe=pe[B]._private;oe.oldBackgroundTimestamp=oe.backgroundTimestamp}});var Se=function(me){for(var pe=0;pe<me.length;pe++)ve.enqueueElementRefinement(me[pe].ele)};K.onDequeue(Se),se.onDequeue(Se),ne.onDequeue(Se),ge.onDequeue(Se),a.webgl&&t.initWebgl(a,{getStyleKey:v,getLabelKey:E,getSourceLabelKey:C,getTargetLabelKey:_,drawElement:x,drawLabel:P,drawSourceLabel:I,drawTargetLabel:M,getElementBox:O,getLabelBox:R,getSourceLabelBox:F,getTargetLabelBox:$,getElementRotationPoint:N,getElementRotationOffset:q,getLabelRotationPoint:Y,getSourceLabelRotationPoint:U,getTargetLabelRotationPoint:Z,getLabelRotationOffset:j,getSourceLabelRotationOffset:X,getTargetLabelRotationOffset:ie})}function X5(a,t,e){var r=e,n=function(O){cr("Can not register `"+t+"` for `"+a+"` since `"+O+"` already exists in the prototype and can not be overridden")};if(a==="core"){if(rv.prototype[t])return n(t);rv.prototype[t]=e}else if(a==="collection"){if(sn.prototype[t])return n(t);sn.prototype[t]=e}else if(a==="layout"){for(var s=function(O){this.options=O,e.call(this,O),Zt(this._private)||(this._private={}),this._private.cy=O.cy,this._private.listeners=[],this.createEmitter()},o=s.prototype=Object.create(e.prototype),l=[],c=0;c<l.length;c++){var u=l[c];o[u]=o[u]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var d=e.prototype.stop;o.stop=function(){var M=this.options;if(M&&M.animate){var O=this.animations;if(O)for(var R=0;R<O.length;R++)O[R].stop()}return d?d.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var h=function(O){return O._private.cy},f={addEventFields:function(O,R){R.layout=O,R.cy=h(O),R.target=O},bubble:function(){return!0},parent:function(O){return h(O)}};ut(o,{createEmitter:function(){return this._private.emitter=new Rw(f,this),this},emitter:function(){return this._private.emitter},on:function(O,R){return this.emitter().on(O,R),this},one:function(O,R){return this.emitter().one(O,R),this},once:function(O,R){return this.emitter().one(O,R),this},removeListener:function(O,R){return this.emitter().removeListener(O,R),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(O,R){return this.emitter().emit(O,R),this}}),lr.eventAliasesOn(o),r=s}else if(a==="renderer"&&t!=="null"&&t!=="base"){var m=J5("renderer","base"),g=m.prototype,y=e,v=e.prototype,E=function(){m.apply(this,arguments),y.apply(this,arguments)},C=E.prototype;for(var _ in g){var x=g[_],P=v[_]!=null;if(P)return n(_);C[_]=x}for(var I in v)C[I]=v[I];g.clientFunctions.forEach(function(M){C[M]=C[M]||function(){qr("Renderer does not implement `renderer."+M+"()` on its prototype")}}),r=E}else if(a==="__proto__"||a==="constructor"||a==="prototype")return qr(a+" is an illegal type to be registered, possibly lead to prototype pollutions");return gV({map:Z5,keys:[a,t],value:r})}function J5(a,t){return vV({map:Z5,keys:[a,t]})}function kTe(a,t,e,r,n){return gV({map:K5,keys:[a,t,e,r],value:n})}function DTe(a,t,e,r){return vV({map:K5,keys:[a,t,e,r]})}var Mi,Oz,lve,uV,cve,uve,nv,at,ti,Pr,Zt,dve,We,hve,fw,Ra,av,dV,MD,hV,fve,mc,pve,mve,gve,vve,wf,ID,xw,fV,Fz,uc,Ii,yve,bve,wve,Eve,Tve,Cve,pV,_ve,ut,Sve,xve,kve,Dve,mV,Pve,gV,vV,G0,Ok,Rz,Fk,Nz,Rk,Bz,Nk,$z,Bk,zz,$k,Hz,zk,Gz,Hk,Vz,Gk,Wz,Vk,Uz,Wk,jz,Uk,Yz,jk,qz,Yk,Zz,$ve,cv,qk,bV,zve,pw,rl,Wu,wV,hf,EV,qg,Zg,Hve,oc,V0,Kz,Yu,TV,Gve,Wve,Xz,jve,Yve,OD,CV,mw,Jz,FD,qr,_V,cr,qve,po,Zve,SV,Kve,xV,on,gc,RD,Xve,ha,el,Jve,tl,Qve,eye,Cf,Dw,Qz,Kg,tw,tye,eH,Zk,tH,nye,uv,aye,sye,oye,lye,cye,uye,dye,hye,fye,pye,mye,Kk,gye,Xk,vye,Pw,kV,ff,yye,bye,wye,Eye,Tye,W0,ND,BD,qu,Gu,Cye,qi,gf,_ye,Xg,Un,Sye,xye,kye,DV,rw,iw,rH,$D,dc,iH,PV,Dye,LV,Mye,Iye,Aye,Oye,Fye,Rye,fa,il,Nye,gw,vw,Bye,ju,Gg,Jk,hc,$ye,Jg,zye,U0,Wn,MV,dD,vc,IV,zD,Hye,hD,Gye,Vye,nH,vf,aH,yf,Wye,fD,Uye,jye,Yye,qye,AV,Zye,Kye,Xye,Jye,Qye,ebe,tbe,sH,rbe,ibe,OV,oH,lH,nbe,abe,Fg,Ef,sbe,HD,yw,e1,FV,RV,obe,lbe,cbe,cH,uH,ube,dbe,hbe,fbe,pbe,dH,mbe,gbe,vbe,ybe,hH,pf,pD,mD,fH,bbe,wbe,Ebe,Tbe,Cbe,_be,pH,Sbe,mH,xbe,kbe,Dbe,j0,Pbe,Y0,Lbe,NV,BV,$V,zV,Bs,gH,HV,vH,yH,GV,_f,gD,Zu,Mbe,t1,bH,r1,wH,i1,EH,n1,TH,a1,CH,s1,_H,o1,SH,l1,xH,c1,kH,u1,DH,d1,PH,h1,LH,f1,MH,p1,IH,m1,AH,g1,OH,v1,FH,y1,RH,b1,NH,w1,BH,E1,$H,T1,zH,C1,HH,_1,GH,S1,VH,x1,WH,k1,UH,D1,jH,P1,YH,L1,qH,M1,ZH,I1,KH,A1,XH,O1,JH,F1,QH,R1,eG,N1,tG,B1,rG,$1,iG,z1,nG,H1,aG,G1,sG,V1,oG,u0e,d0e,W1,lG,U1,cG,j1,uG,Y1,dG,q1,hG,Z1,fG,y0e,b0e,K1,pG,X1,mG,T0e,C0e,_0e,S0e,lr,x0e,nw,qt,Cr,Je,vD,k0e,D0e,P0e,af,lc,yD,L0e,M0e,I0e,A0e,O0e,qV,F0e,R0e,WD,N0e,si,Hr,B0e,$0e,z0e,yc,bc,fc,us,Tf,Qg,XV,G0e,Fw,Ns,JV,QV,gG,V0e,bf,_c,cs,Rs,cc,Rg,q0,Q1,vG,e5,W0e,U0e,t5,r5,yG,ev,bG,wG,j0e,Vg,dv,i5,Y0e,q0e,Z0e,K0e,X0e,J0e,Q0e,ewe,twe,EG,rwe,iwe,nwe,n5,a5,awe,s5,TG,swe,wc,o5,CG,owe,lwe,K0,l5,c5,Qt,cwe,u5,bw,uwe,dwe,aw,an,Sf,hwe,fwe,pwe,mwe,pc,Tn,SG,xG,kG,sn,Or,gwe,ywe,Ar,sw,Ewe,Twe,X0,h5,bD,ow,Cwe,_we,wD,lw,Ki,Ug,Swe,hv,YD,mo,$w,qD,Ti,zw,Zi,Cn,xwe,kwe,Ku,tv,rv,ww,Dwe,Pwe,lf,OG,Lwe,Mwe,tD,Iwe,Awe,Owe,g5,Fwe,Rwe,v5,Nwe,Bwe,$we,FG,zwe,Hwe,Ew,Gwe,Vwe,Wwe,Uwe,jwe,y5,RG,Ywe,qwe,Zwe,Kwe,Xwe,NG,BG,KD,Ju,Tw,ED,TD,fo,ls,$G,zG,Uu,cw,Qo,$u,Vu,uo,cf,J0,C5,_5,CD,_D,HG,GG,Jwe,Qwe,iv,eEe,_n,fv,JD,go,k5,D5,rEe,P5,VG,WG,Gw,Vw,L5,M5,kf,nl,pv,UG,iEe,I5,Df,rD,A5,nEe,jG,Q0,uw,SD,O5,aEe,sEe,oEe,lEe,cEe,uEe,dEe,hEe,fEe,pEe,mEe,gEe,vEe,mf,yEe,Wg,Oi,bEe,jg,Cw,wEe,EEe,TEe,CEe,_Ee,SEe,xEe,kEe,YG,DEe,qG,PEe,F5,ln,ZG,LEe,R5,KG,vo,FEe,REe,NEe,BEe,$Ee,iD,al,N5,QD,Qu,Sc,B5,jn,HEe,$g,eV,rTe,iTe,aTe,sTe,oTe,lTe,cTe,uTe,Yg,_w,aD,iV,nV,sD,df,ew,zg,Hg,dTe,H5,oD,lD,xc,aV,sV,kD,DD,U5,Hu,mv,Y5,CTe,Rt,_Te,STe,xTe,Z5,K5,PD,Sw,Xu,PTe,Ec,Q5=_e(()=>{Mi=typeof window=="undefined"?null:window,Oz=Mi?Mi.navigator:null;Mi&&Mi.document;lve=Ai(""),uV=Ai({}),cve=Ai(function(){}),uve=typeof HTMLElement=="undefined"?"undefined":Ai(HTMLElement),nv=function(t){return t&&t.instanceString&&ti(t.instanceString)?t.instanceString():null},at=function(t){return t!=null&&Ai(t)==lve},ti=function(t){return t!=null&&Ai(t)===cve},Pr=function(t){return!Ra(t)&&(Array.isArray?Array.isArray(t):t!=null&&t instanceof Array)},Zt=function(t){return t!=null&&Ai(t)===uV&&!Pr(t)&&t.constructor===Object},dve=function(t){return t!=null&&Ai(t)===uV},We=function(t){return t!=null&&Ai(t)===Ai(1)&&!isNaN(t)},hve=function(t){return We(t)&&Math.floor(t)===t},fw=function(t){if(uve!=="undefined")return t!=null&&t instanceof HTMLElement},Ra=function(t){return av(t)||dV(t)},av=function(t){return nv(t)==="collection"&&t._private.single},dV=function(t){return nv(t)==="collection"&&!t._private.single},MD=function(t){return nv(t)==="core"},hV=function(t){return nv(t)==="stylesheet"},fve=function(t){return nv(t)==="event"},mc=function(t){return t==null?!0:!!(t===""||t.match(/^\s+$/))},pve=function(t){return typeof HTMLElement=="undefined"?!1:t instanceof HTMLElement},mve=function(t){return Zt(t)&&We(t.x1)&&We(t.x2)&&We(t.y1)&&We(t.y2)},gve=function(t){return dve(t)&&ti(t.then)},vve=function(){return Oz&&Oz.userAgent.match(/msie|trident|edge/i)},wf=function(t,e){e||(e=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var s=[],o=0;o<arguments.length;o++)s.push(arguments[o]);return s.join("$")});var r=function(){var s=this,o=arguments,l,c=e.apply(s,o),u=r.cache;return(l=u[c])||(l=u[c]=t.apply(s,o)),l};return r.cache={},r},ID=wf(function(a){return a.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}),xw=wf(function(a){return a.replace(/(-\w)/g,function(t){return t[1].toUpperCase()})}),fV=wf(function(a,t){return a+t[0].toUpperCase()+t.substring(1)},function(a,t){return a+"$"+t}),Fz=function(t){return mc(t)?t:t.charAt(0).toUpperCase()+t.substring(1)},uc=function(t,e){return t.slice(-1*e.length)===e},Ii="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",yve="rgb[a]?\\(("+Ii+"[%]?)\\s*,\\s*("+Ii+"[%]?)\\s*,\\s*("+Ii+"[%]?)(?:\\s*,\\s*("+Ii+"))?\\)",bve="rgb[a]?\\((?:"+Ii+"[%]?)\\s*,\\s*(?:"+Ii+"[%]?)\\s*,\\s*(?:"+Ii+"[%]?)(?:\\s*,\\s*(?:"+Ii+"))?\\)",wve="hsl[a]?\\(("+Ii+")\\s*,\\s*("+Ii+"[%])\\s*,\\s*("+Ii+"[%])(?:\\s*,\\s*("+Ii+"))?\\)",Eve="hsl[a]?\\((?:"+Ii+")\\s*,\\s*(?:"+Ii+"[%])\\s*,\\s*(?:"+Ii+"[%])(?:\\s*,\\s*(?:"+Ii+"))?\\)",Tve="\\#[0-9a-fA-F]{3}",Cve="\\#[0-9a-fA-F]{6}",pV=function(t,e){return t<e?-1:t>e?1:0},_ve=function(t,e){return-1*pV(t,e)},ut=Object.assign!=null?Object.assign.bind(Object):function(a){for(var t=arguments,e=1;e<t.length;e++){var r=t[e];if(r!=null)for(var n=Object.keys(r),s=0;s<n.length;s++){var o=n[s];a[o]=r[o]}}return a},Sve=function(t){if(!(!(t.length===4||t.length===7)||t[0]!=="#")){var e=t.length===4,r,n,s,o=16;return e?(r=parseInt(t[1]+t[1],o),n=parseInt(t[2]+t[2],o),s=parseInt(t[3]+t[3],o)):(r=parseInt(t[1]+t[2],o),n=parseInt(t[3]+t[4],o),s=parseInt(t[5]+t[6],o)),[r,n,s]}},xve=function(t){var e,r,n,s,o,l,c,u;function d(g,y,v){return v<0&&(v+=1),v>1&&(v-=1),v<1/6?g+(y-g)*6*v:v<1/2?y:v<2/3?g+(y-g)*(2/3-v)*6:g}var h=new RegExp("^"+wve+"$").exec(t);if(h){if(r=parseInt(h[1]),r<0?r=(360- -1*r%360)%360:r>360&&(r=r%360),r/=360,n=parseFloat(h[2]),n<0||n>100||(n=n/100,s=parseFloat(h[3]),s<0||s>100)||(s=s/100,o=h[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(n===0)l=c=u=Math.round(s*255);else{var f=s<.5?s*(1+n):s+n-s*n,m=2*s-f;l=Math.round(255*d(m,f,r+1/3)),c=Math.round(255*d(m,f,r)),u=Math.round(255*d(m,f,r-1/3))}e=[l,c,u,o]}return e},kve=function(t){var e,r=new RegExp("^"+yve+"$").exec(t);if(r){e=[];for(var n=[],s=1;s<=3;s++){var o=r[s];if(o[o.length-1]==="%"&&(n[s]=!0),o=parseFloat(o),n[s]&&(o=o/100*255),o<0||o>255)return;e.push(Math.floor(o))}var l=n[1]||n[2]||n[3],c=n[1]&&n[2]&&n[3];if(l&&!c)return;var u=r[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;e.push(u)}}return e},Dve=function(t){return Pve[t.toLowerCase()]},mV=function(t){return(Pr(t)?t:null)||Dve(t)||Sve(t)||kve(t)||xve(t)},Pve={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},gV=function(t){for(var e=t.map,r=t.keys,n=r.length,s=0;s<n;s++){var o=r[s];if(Zt(o))throw Error("Tried to set map with object key");s<r.length-1?(e[o]==null&&(e[o]={}),e=e[o]):e[o]=t.value}},vV=function(t){for(var e=t.map,r=t.keys,n=r.length,s=0;s<n;s++){var o=r[s];if(Zt(o))throw Error("Tried to get map with object key");if(e=e[o],e==null)return e}return e},G0=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};$ve=Bve(),cv=sv($ve),qk=Mi?Mi.performance:null,bV=qk&&qk.now?function(){return qk.now()}:function(){return Date.now()},zve=(function(){if(Mi){if(Mi.requestAnimationFrame)return function(a){Mi.requestAnimationFrame(a)};if(Mi.mozRequestAnimationFrame)return function(a){Mi.mozRequestAnimationFrame(a)};if(Mi.webkitRequestAnimationFrame)return function(a){Mi.webkitRequestAnimationFrame(a)};if(Mi.msRequestAnimationFrame)return function(a){Mi.msRequestAnimationFrame(a)}}return function(a){a&&setTimeout(function(){a(bV())},1e3/60)}})(),pw=function(t){return zve(t)},rl=bV,Wu=9261,wV=65599,hf=5381,EV=function(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wu,r=e,n;n=t.next(),!n.done;)r=r*wV+n.value|0;return r},qg=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wu;return e*wV+t|0},Zg=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hf;return(e<<5)+e+t|0},Hve=function(t,e){return t*2097152+e},oc=function(t){return t[0]*2097152+t[1]},V0=function(t,e){return[qg(t[0],e[0]),Zg(t[1],e[1])]},Kz=function(t,e){var r={value:0,done:!1},n=0,s=t.length,o={next:function(){return n<s?r.value=t[n++]:r.done=!0,r}};return EV(o,e)},Yu=function(t,e){var r={value:0,done:!1},n=0,s=t.length,o={next:function(){return n<s?r.value=t.charCodeAt(n++):r.done=!0,r}};return EV(o,e)},TV=function(){return Gve(arguments)},Gve=function(t){for(var e,r=0;r<t.length;r++){var n=t[r];r===0?e=Yu(n):e=Yu(n,e)}return e};Wve=function(t,e,r,n,s,o){return{x:(t-r)*s+r,y:(e-n)*o+n}};Xz=!0,jve=console.warn!=null,Yve=console.trace!=null,OD=Number.MAX_SAFE_INTEGER||9007199254740991,CV=function(){return!0},mw=function(){return!1},Jz=function(){return 0},FD=function(){},qr=function(t){throw new Error(t)},_V=function(t){if(t!==void 0)Xz=!!t;else return Xz},cr=function(t){_V()&&(jve?console.warn(t):(console.log(t),Yve&&console.trace()))},qve=function(t){return ut({},t)},po=function(t){return t==null?t:Pr(t)?t.slice():Zt(t)?qve(t):t},Zve=function(t){return t.slice()},SV=function(t,e){for(e=t="";t++<36;e+=t*51&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-");return e},Kve={},xV=function(){return Kve},on=function(t){var e=Object.keys(t);return function(r){for(var n={},s=0;s<e.length;s++){var o=e[s],l=r==null?void 0:r[o];n[o]=l===void 0?t[o]:l}return n}},gc=function(t,e,r){for(var n=t.length-1;n>=0;n--)t[n]===e&&t.splice(n,1)},RD=function(t){t.splice(0,t.length)},Xve=function(t,e){for(var r=0;r<e.length;r++){var n=e[r];t.push(n)}},ha=function(t,e,r){return r&&(e=fV(r,e)),t[e]},el=function(t,e,r,n){r&&(e=fV(r,e)),t[e]=n},Jve=(function(){function a(){Tc(this,a),this._obj={}}return Cc(a,[{key:"set",value:function(e,r){return this._obj[e]=r,this}},{key:"delete",value:function(e){return this._obj[e]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(e){return this._obj[e]!==void 0}},{key:"get",value:function(e){return this._obj[e]}}])})(),tl=typeof Map!="undefined"?Map:Jve,Qve="undefined",eye=(function(){function a(t){if(Tc(this,a),this._obj=Object.create(null),this.size=0,t!=null){var e;t.instanceString!=null&&t.instanceString()===this.instanceString()?e=t.toArray():e=t;for(var r=0;r<e.length;r++)this.add(e[r])}}return Cc(a,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(e){var r=this._obj;r[e]!==1&&(r[e]=1,this.size++)}},{key:"delete",value:function(e){var r=this._obj;r[e]===1&&(r[e]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(e){return this._obj[e]===1}},{key:"toArray",value:function(){var e=this;return Object.keys(this._obj).filter(function(r){return e.has(r)})}},{key:"forEach",value:function(e,r){return this.toArray().forEach(e,r)}}])})(),Cf=(typeof Set=="undefined"?"undefined":Ai(Set))!==Qve?Set:eye,Dw=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(t===void 0||e===void 0||!MD(t)){qr("An element must have a core reference and parameters set");return}var n=e.group;if(n==null&&(e.data&&e.data.source!=null&&e.data.target!=null?n="edges":n="nodes"),n!=="nodes"&&n!=="edges"){qr("An element must be of type `nodes` or `edges`; you specified `"+n+"`");return}this.length=1,this[0]=this;var s=this._private={cy:t,single:!0,data:e.data||{},position:e.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:n,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!e.selected,selectable:e.selectable===void 0?!0:!!e.selectable,locked:!!e.locked,grabbed:!1,grabbable:e.grabbable===void 0?!0:!!e.grabbable,pannable:e.pannable===void 0?n==="edges":!!e.pannable,active:!1,classes:new Cf,animation:{current:[],queue:[]},rscratch:{},scratch:e.scratch||{},edges:[],children:[],parent:e.parent&&e.parent.isNode()?e.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(s.position.x==null&&(s.position.x=0),s.position.y==null&&(s.position.y=0),e.renderedPosition){var o=e.renderedPosition,l=t.pan(),c=t.zoom();s.position={x:(o.x-l.x)/c,y:(o.y-l.y)/c}}var u=[];Pr(e.classes)?u=e.classes:at(e.classes)&&(u=e.classes.split(/\s+/));for(var d=0,h=u.length;d<h;d++){var f=u[d];!f||f===""||s.classes.add(f)}this.createEmitter(),(r===void 0||r)&&this.restore();var m=e.style||e.css;m&&(cr("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(m))},Qz=function(t){return t={bfs:t.bfs||!t.dfs,dfs:t.dfs||!t.bfs},function(r,n,s){var o;Zt(r)&&!Ra(r)&&(o=r,r=o.roots||o.root,n=o.visit,s=o.directed),s=arguments.length===2&&!ti(n)?n:s,n=ti(n)?n:function(){};for(var l=this._private.cy,c=r=at(r)?this.filter(r):r,u=[],d=[],h={},f={},m={},g=0,y,v=this.byGroup(),E=v.nodes,C=v.edges,_=0;_<c.length;_++){var x=c[_],P=x.id();x.isNode()&&(u.unshift(x),t.bfs&&(m[P]=!0,d.push(x)),f[P]=0)}for(var I=function(){var N=t.bfs?u.shift():u.pop(),G=N.id();if(t.dfs){if(m[G])return 0;m[G]=!0,d.push(N)}var W=f[G],Y=h[G],U=Y!=null?Y.source():null,Z=Y!=null?Y.target():null,q=Y==null?void 0:N.same(U)?Z[0]:U[0],X;if(X=n(N,Y,q,g++,W),X===!0)return y=N,1;if(X===!1)return 1;for(var ie=N.connectedEdges().filter(function(ge){return(!s||ge.source().same(N))&&C.has(ge)}),j=0;j<ie.length;j++){var K=ie[j],se=K.connectedNodes().filter(function(ge){return!ge.same(N)&&E.has(ge)}),ne=se.id();se.length!==0&&!m[ne]&&(se=se[0],u.push(se),t.bfs&&(m[ne]=!0,d.push(se)),h[ne]=K,f[ne]=f[G]+1)}},M;u.length!==0&&(M=I(),!(M!==0&&M===1)););for(var O=l.collection(),R=0;R<d.length;R++){var F=d[R],$=h[F.id()];$!=null&&O.push($),O.push(F)}return{path:l.collection(O),found:l.collection(y)}}},Kg={breadthFirstSearch:Qz({bfs:!0}),depthFirstSearch:Qz({dfs:!0})};Kg.bfs=Kg.breadthFirstSearch;Kg.dfs=Kg.depthFirstSearch;tw={exports:{}},tye=tw.exports;nye=iye(),uv=sv(nye),aye=on({root:null,weight:function(t){return 1},directed:!1}),sye={dijkstra:function(t){if(!Zt(t)){var e=arguments;t={root:e[0],weight:e[1],directed:e[2]}}var r=aye(t),n=r.root,s=r.weight,o=r.directed,l=this,c=s,u=at(n)?this.filter(n)[0]:n[0],d={},h={},f={},m=this.byGroup(),g=m.nodes,y=m.edges;y.unmergeBy(function(W){return W.isLoop()});for(var v=function(Y){return d[Y.id()]},E=function(Y,U){d[Y.id()]=U,C.updateItem(Y)},C=new uv(function(W,Y){return v(W)-v(Y)}),_=0;_<g.length;_++){var x=g[_];d[x.id()]=x.same(u)?0:1/0,C.push(x)}for(var P=function(Y,U){for(var Z=(o?Y.edgesTo(U):Y.edgesWith(U)).intersect(y),q=1/0,X,ie=0;ie<Z.length;ie++){var j=Z[ie],K=c(j);(K<q||!X)&&(q=K,X=j)}return{edge:X,dist:q}};C.size()>0;){var I=C.pop(),M=v(I),O=I.id();if(f[O]=M,M!==1/0)for(var R=I.neighborhood().intersect(g),F=0;F<R.length;F++){var $=R[F],k=$.id(),N=P(I,$),G=M+N.dist;G<v($)&&(E($,G),h[k]={node:I,edge:N.edge})}}return{distanceTo:function(Y){var U=at(Y)?g.filter(Y)[0]:Y[0];return f[U.id()]},pathTo:function(Y){var U=at(Y)?g.filter(Y)[0]:Y[0],Z=[],q=U,X=q.id();if(U.length>0)for(Z.unshift(U);h[X];){var ie=h[X];Z.unshift(ie.edge),Z.unshift(ie.node),q=ie.node,X=q.id()}return l.spawn(Z)}}}},oye={kruskal:function(t){t=t||function(_){return 1};for(var e=this.byGroup(),r=e.nodes,n=e.edges,s=r.length,o=new Array(s),l=r,c=function(x){for(var P=0;P<o.length;P++){var I=o[P];if(I.has(x))return P}},u=0;u<s;u++)o[u]=this.spawn(r[u]);for(var d=n.sort(function(_,x){return t(_)-t(x)}),h=0;h<d.length;h++){var f=d[h],m=f.source()[0],g=f.target()[0],y=c(m),v=c(g),E=o[y],C=o[v];y!==v&&(l.merge(f),E.merge(C),o.splice(v,1))}return l}},lye=on({root:null,goal:null,weight:function(t){return 1},heuristic:function(t){return 0},directed:!1}),cye={aStar:function(t){var e=this.cy(),r=lye(t),n=r.root,s=r.goal,o=r.heuristic,l=r.directed,c=r.weight;n=e.collection(n)[0],s=e.collection(s)[0];var u=n.id(),d=s.id(),h={},f={},m={},g=new uv(function(X,ie){return f[X.id()]-f[ie.id()]}),y=new Cf,v={},E={},C=function(ie,j){g.push(ie),y.add(j)},_,x,P=function(){_=g.pop(),x=_.id(),y.delete(x)},I=function(ie){return y.has(ie)};C(n,u),h[u]=0,f[u]=o(n);for(var M=0;g.size()>0;){if(P(),M++,x===d){for(var O=[],R=s,F=d,$=E[F];O.unshift(R),$!=null&&O.unshift($),R=v[F],R!=null;)F=R.id(),$=E[F];return{found:!0,distance:h[x],path:this.spawn(O),steps:M}}m[x]=!0;for(var k=_._private.edges,N=0;N<k.length;N++){var G=k[N];if(this.hasElementWithId(G.id())&&!(l&&G.data("source")!==x)){var W=G.source(),Y=G.target(),U=W.id()!==x?W:Y,Z=U.id();if(this.hasElementWithId(Z)&&!m[Z]){var q=h[x]+c(G);if(!I(Z)){h[Z]=q,f[Z]=q+o(U),C(U,Z),v[Z]=_,E[Z]=G;continue}q<h[Z]&&(h[Z]=q,f[Z]=q+o(U),v[Z]=_,E[Z]=G)}}}}return{found:!1,distance:void 0,path:void 0,steps:M}}},uye=on({weight:function(t){return 1},directed:!1}),dye={floydWarshall:function(t){for(var e=this.cy(),r=uye(t),n=r.weight,s=r.directed,o=n,l=this.byGroup(),c=l.nodes,u=l.edges,d=c.length,h=d*d,f=function(K){return c.indexOf(K)},m=function(K){return c[K]},g=new Array(h),y=0;y<h;y++){var v=y%d,E=(y-v)/d;E===v?g[y]=0:g[y]=1/0}for(var C=new Array(h),_=new Array(h),x=0;x<u.length;x++){var P=u[x],I=P.source()[0],M=P.target()[0];if(I!==M){var O=f(I),R=f(M),F=O*d+R,$=o(P);if(g[F]>$&&(g[F]=$,C[F]=R,_[F]=P),!s){var k=R*d+O;!s&&g[k]>$&&(g[k]=$,C[k]=O,_[k]=P)}}}for(var N=0;N<d;N++)for(var G=0;G<d;G++)for(var W=G*d+N,Y=0;Y<d;Y++){var U=G*d+Y,Z=N*d+Y;g[W]+g[Z]<g[U]&&(g[U]=g[W]+g[Z],C[U]=C[W])}var q=function(K){return(at(K)?e.filter(K):K)[0]},X=function(K){return f(q(K))},ie={distance:function(K,se){var ne=X(K),ge=X(se);return g[ne*d+ge]},path:function(K,se){var ne=X(K),ge=X(se),ve=m(ne);if(ne===ge)return ve.collection();if(C[ne*d+ge]==null)return e.collection();var Se=e.collection(),Te=ne,me;for(Se.merge(ve);ne!==ge;)Te=ne,ne=C[ne*d+ge],me=_[Te*d+ne],Se.merge(me),Se.merge(m(ne));return Se}};return ie}},hye=on({weight:function(t){return 1},directed:!1,root:null}),fye={bellmanFord:function(t){var e=this,r=hye(t),n=r.weight,s=r.directed,o=r.root,l=n,c=this,u=this.cy(),d=this.byGroup(),h=d.edges,f=d.nodes,m=f.length,g=new tl,y=!1,v=[];o=u.collection(o)[0],h.unmergeBy(function(ce){return ce.isLoop()});for(var E=h.length,C=function(Ee){var Ce=g.get(Ee.id());return Ce||(Ce={},g.set(Ee.id(),Ce)),Ce},_=function(Ee){return(at(Ee)?u.$(Ee):Ee)[0]},x=function(Ee){return C(_(Ee)).dist},P=function(Ee){for(var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,le=_(Ee),we=[],Le=le;;){if(Le==null)return e.spawn();var Me=C(Le),Ne=Me.edge,Ge=Me.pred;if(we.unshift(Le[0]),Le.same(Ce)&&we.length>0)break;Ne!=null&&we.unshift(Ne),Le=Ge}return c.spawn(we)},I=0;I<m;I++){var M=f[I],O=C(M);M.same(o)?O.dist=0:O.dist=1/0,O.pred=null,O.edge=null}for(var R=!1,F=function(Ee,Ce,le,we,Le,Me){var Ne=we.dist+Me;Ne<Le.dist&&!le.same(we.edge)&&(Le.dist=Ne,Le.pred=Ee,Le.edge=le,R=!0)},$=1;$<m;$++){R=!1;for(var k=0;k<E;k++){var N=h[k],G=N.source(),W=N.target(),Y=l(N),U=C(G),Z=C(W);F(G,W,N,U,Z,Y),s||F(W,G,N,Z,U,Y)}if(!R)break}if(R)for(var q=[],X=0;X<E;X++){var ie=h[X],j=ie.source(),K=ie.target(),se=l(ie),ne=C(j).dist,ge=C(K).dist;if(ne+se<ge||!s&&ge+se<ne)if(y||(cr("Graph contains a negative weight cycle for Bellman-Ford"),y=!0),t.findNegativeWeightCycles!==!1){var ve=[];ne+se<ge&&ve.push(j),!s&&ge+se<ne&&ve.push(K);for(var Se=ve.length,Te=0;Te<Se;Te++){var me=ve[Te],pe=[me];pe.push(C(me).edge);for(var B=C(me).pred;pe.indexOf(B)===-1;)pe.push(B),pe.push(C(B).edge),B=C(B).pred;pe=pe.slice(pe.indexOf(B));for(var oe=pe[0].id(),he=0,te=2;te<pe.length;te+=2)pe[te].id()<oe&&(oe=pe[te].id(),he=te);pe=pe.slice(he).concat(pe.slice(0,he)),pe.push(pe[0]);var re=pe.map(function(ce){return ce.id()}).join(",");q.indexOf(re)===-1&&(v.push(c.spawn(pe)),q.push(re))}}else break}return{distanceTo:x,pathTo:P,hasNegativeWeightCycle:y,negativeWeightCycles:v}}},pye=Math.sqrt(2),mye=function(t,e,r){r.length===0&&qr("Karger-Stein must be run on a connected (sub)graph");for(var n=r[t],s=n[1],o=n[2],l=e[s],c=e[o],u=r,d=u.length-1;d>=0;d--){var h=u[d],f=h[1],m=h[2];(e[f]===l&&e[m]===c||e[f]===c&&e[m]===l)&&u.splice(d,1)}for(var g=0;g<u.length;g++){var y=u[g];y[1]===c?(u[g]=y.slice(),u[g][1]=l):y[2]===c&&(u[g]=y.slice(),u[g][2]=l)}for(var v=0;v<e.length;v++)e[v]===c&&(e[v]=l);return u},Kk=function(t,e,r,n){for(;r>n;){var s=Math.floor(Math.random()*e.length);e=mye(s,t,e),r--}return e},gye={kargerStein:function(){var t=this,e=this.byGroup(),r=e.nodes,n=e.edges;n.unmergeBy(function(Z){return Z.isLoop()});var s=r.length,o=n.length,l=Math.ceil(Math.pow(Math.log(s)/Math.LN2,2)),c=Math.floor(s/pye);if(s<2){qr("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],d=0;d<o;d++){var h=n[d];u.push([d,r.indexOf(h.source()),r.indexOf(h.target())])}for(var f=1/0,m=[],g=new Array(s),y=new Array(s),v=new Array(s),E=function(q,X){for(var ie=0;ie<s;ie++)X[ie]=q[ie]},C=0;C<=l;C++){for(var _=0;_<s;_++)y[_]=_;var x=Kk(y,u.slice(),s,c),P=x.slice();E(y,v);var I=Kk(y,x,c,2),M=Kk(v,P,c,2);I.length<=M.length&&I.length<f?(f=I.length,m=I,E(y,g)):M.length<=I.length&&M.length<f&&(f=M.length,m=M,E(v,g))}for(var O=this.spawn(m.map(function(Z){return n[Z[0]]})),R=this.spawn(),F=this.spawn(),$=g[0],k=0;k<g.length;k++){var N=g[k],G=r[k];N===$?R.merge(G):F.merge(G)}var W=function(q){var X=t.spawn();return q.forEach(function(ie){X.merge(ie),ie.connectedEdges().forEach(function(j){t.contains(j)&&!O.contains(j)&&X.merge(j)})}),X},Y=[W(R),W(F)],U={cut:O,components:Y,partition1:R,partition2:F};return U}},vye=function(t){return{x:t.x,y:t.y}},Pw=function(t,e,r){return{x:t.x*e+r.x,y:t.y*e+r.y}},kV=function(t,e,r){return{x:(t.x-r.x)/e,y:(t.y-r.y)/e}},ff=function(t){return{x:t[0],y:t[1]}},yye=function(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,n=1/0,s=e;s<r;s++){var o=t[s];isFinite(o)&&(n=Math.min(o,n))}return n},bye=function(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,n=-1/0,s=e;s<r;s++){var o=t[s];isFinite(o)&&(n=Math.max(o,n))}return n},wye=function(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,n=0,s=0,o=e;o<r;o++){var l=t[o];isFinite(l)&&(n+=l,s++)}return n/s},Eye=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;n?t=t.slice(e,r):(r<t.length&&t.splice(r,t.length-r),e>0&&t.splice(0,e));for(var l=0,c=t.length-1;c>=0;c--){var u=t[c];o?isFinite(u)||(t[c]=-1/0,l++):t.splice(c,1)}s&&t.sort(function(f,m){return f-m});var d=t.length,h=Math.floor(d/2);return d%2!==0?t[h+1+l]:(t[h-1+l]+t[h+l])/2},Tye=function(t){return Math.PI*t/180},W0=function(t,e){return Math.atan2(e,t)-Math.PI/2},ND=Math.log2||function(a){return Math.log(a)/Math.log(2)},BD=function(t){return t>0?1:t<0?-1:0},qu=function(t,e){return Math.sqrt(Gu(t,e))},Gu=function(t,e){var r=e.x-t.x,n=e.y-t.y;return r*r+n*n},Cye=function(t){for(var e=t.length,r=0,n=0;n<e;n++)r+=t[n];for(var s=0;s<e;s++)t[s]=t[s]/r;return t},qi=function(t,e,r,n){return(1-n)*(1-n)*t+2*(1-n)*n*e+n*n*r},gf=function(t,e,r,n){return{x:qi(t.x,e.x,r.x,n),y:qi(t.y,e.y,r.y,n)}},_ye=function(t,e,r,n){var s={x:e.x-t.x,y:e.y-t.y},o=qu(t,e),l={x:s.x/o,y:s.y/o};return r=r==null?0:r,n=n!=null?n:r*o,{x:t.x+l.x*n,y:t.y+l.y*n}},Xg=function(t,e,r){return Math.max(t,Math.min(r,e))},Un=function(t){if(t==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(t.x1!=null&&t.y1!=null){if(t.x2!=null&&t.y2!=null&&t.x2>=t.x1&&t.y2>=t.y1)return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,w:t.x2-t.x1,h:t.y2-t.y1};if(t.w!=null&&t.h!=null&&t.w>=0&&t.h>=0)return{x1:t.x1,y1:t.y1,x2:t.x1+t.w,y2:t.y1+t.h,w:t.w,h:t.h}}},Sye=function(t){return{x1:t.x1,x2:t.x2,w:t.w,y1:t.y1,y2:t.y2,h:t.h}},xye=function(t){t.x1=1/0,t.y1=1/0,t.x2=-1/0,t.y2=-1/0,t.w=0,t.h=0},kye=function(t,e){t.x1=Math.min(t.x1,e.x1),t.x2=Math.max(t.x2,e.x2),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,e.y1),t.y2=Math.max(t.y2,e.y2),t.h=t.y2-t.y1},DV=function(t,e,r){t.x1=Math.min(t.x1,e),t.x2=Math.max(t.x2,e),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,r),t.y2=Math.max(t.y2,r),t.h=t.y2-t.y1},rw=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.x1-=e,t.x2+=e,t.y1-=e,t.y2+=e,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},iw=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],r,n,s,o;if(e.length===1)r=n=s=o=e[0];else if(e.length===2)r=s=e[0],o=n=e[1];else if(e.length===4){var l=Ci(e,4);r=l[0],n=l[1],s=l[2],o=l[3]}return t.x1-=o,t.x2+=n,t.y1-=r,t.y2+=s,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},rH=function(t,e){t.x1=e.x1,t.y1=e.y1,t.x2=e.x2,t.y2=e.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1},$D=function(t,e){return!(t.x1>e.x2||e.x1>t.x2||t.x2<e.x1||e.x2<t.x1||t.y2<e.y1||e.y2<t.y1||t.y1>e.y2||e.y1>t.y2)},dc=function(t,e,r){return t.x1<=e&&e<=t.x2&&t.y1<=r&&r<=t.y2},iH=function(t,e){return dc(t,e.x,e.y)},PV=function(t,e){return dc(t,e.x1,e.y1)&&dc(t,e.x2,e.y2)},Dye=(Xk=Math.hypot)!==null&&Xk!==void 0?Xk:function(a,t){return Math.sqrt(a*a+t*t)};LV=function(t,e,r,n,s,o,l){var c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",u=c==="auto"?vc(s,o):c,d=s/2,h=o/2;u=Math.min(u,d,h);var f=u!==d,m=u!==h,g;if(f){var y=r-d+u-l,v=n-h-l,E=r+d-u+l,C=v;if(g=hc(t,e,r,n,y,v,E,C,!1),g.length>0)return g}if(m){var _=r+d+l,x=n-h+u-l,P=_,I=n+h-u+l;if(g=hc(t,e,r,n,_,x,P,I,!1),g.length>0)return g}if(f){var M=r-d+u-l,O=n+h+l,R=r+d-u+l,F=O;if(g=hc(t,e,r,n,M,O,R,F,!1),g.length>0)return g}if(m){var $=r-d-l,k=n-h+u-l,N=$,G=n+h-u+l;if(g=hc(t,e,r,n,$,k,N,G,!1),g.length>0)return g}var W;{var Y=r-d+u,U=n-h+u;if(W=Gg(t,e,r,n,Y,U,u+l),W.length>0&&W[0]<=Y&&W[1]<=U)return[W[0],W[1]]}{var Z=r+d-u,q=n-h+u;if(W=Gg(t,e,r,n,Z,q,u+l),W.length>0&&W[0]>=Z&&W[1]<=q)return[W[0],W[1]]}{var X=r+d-u,ie=n+h-u;if(W=Gg(t,e,r,n,X,ie,u+l),W.length>0&&W[0]>=X&&W[1]>=ie)return[W[0],W[1]]}{var j=r-d+u,K=n+h-u;if(W=Gg(t,e,r,n,j,K,u+l),W.length>0&&W[0]<=j&&W[1]>=K)return[W[0],W[1]]}return[]},Mye=function(t,e,r,n,s,o,l){var c=l,u=Math.min(r,s),d=Math.max(r,s),h=Math.min(n,o),f=Math.max(n,o);return u-c<=t&&t<=d+c&&h-c<=e&&e<=f+c},Iye=function(t,e,r,n,s,o,l,c,u){var d={x1:Math.min(r,l,s)-u,x2:Math.max(r,l,s)+u,y1:Math.min(n,c,o)-u,y2:Math.max(n,c,o)+u};return!(t<d.x1||t>d.x2||e<d.y1||e>d.y2)},Aye=function(t,e,r,n){r-=n;var s=e*e-4*t*r;if(s<0)return[];var o=Math.sqrt(s),l=2*t,c=(-e+o)/l,u=(-e-o)/l;return[c,u]},Oye=function(t,e,r,n,s){var o=1e-5;t===0&&(t=o),e/=t,r/=t,n/=t;var l,c,u,d,h,f,m,g;if(c=(3*r-e*e)/9,u=-(27*n)+e*(9*r-2*(e*e)),u/=54,l=c*c*c+u*u,s[1]=0,m=e/3,l>0){h=u+Math.sqrt(l),h=h<0?-Math.pow(-h,1/3):Math.pow(h,1/3),f=u-Math.sqrt(l),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),s[0]=-m+h+f,m+=(h+f)/2,s[4]=s[2]=-m,m=Math.sqrt(3)*(-f+h)/2,s[3]=m,s[5]=-m;return}if(s[5]=s[3]=0,l===0){g=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),s[0]=-m+2*g,s[4]=s[2]=-(g+m);return}c=-c,d=c*c*c,d=Math.acos(u/Math.sqrt(d)),g=2*Math.sqrt(c),s[0]=-m+g*Math.cos(d/3),s[2]=-m+g*Math.cos((d+2*Math.PI)/3),s[4]=-m+g*Math.cos((d+4*Math.PI)/3)},Fye=function(t,e,r,n,s,o,l,c){var u=1*r*r-4*r*s+2*r*l+4*s*s-4*s*l+l*l+n*n-4*n*o+2*n*c+4*o*o-4*o*c+c*c,d=9*r*s-3*r*r-3*r*l-6*s*s+3*s*l+9*n*o-3*n*n-3*n*c-6*o*o+3*o*c,h=3*r*r-6*r*s+r*l-r*t+2*s*s+2*s*t-l*t+3*n*n-6*n*o+n*c-n*e+2*o*o+2*o*e-c*e,f=1*r*s-r*r+r*t-s*t+n*o-n*n+n*e-o*e,m=[];Oye(u,d,h,f,m);for(var g=1e-7,y=[],v=0;v<6;v+=2)Math.abs(m[v+1])<g&&m[v]>=0&&m[v]<=1&&y.push(m[v]);y.push(1),y.push(0);for(var E=-1,C,_,x,P=0;P<y.length;P++)C=Math.pow(1-y[P],2)*r+2*(1-y[P])*y[P]*s+y[P]*y[P]*l,_=Math.pow(1-y[P],2)*n+2*(1-y[P])*y[P]*o+y[P]*y[P]*c,x=Math.pow(C-t,2)+Math.pow(_-e,2),E>=0?x<E&&(E=x):E=x;return E},Rye=function(t,e,r,n,s,o){var l=[t-r,e-n],c=[s-r,o-n],u=c[0]*c[0]+c[1]*c[1],d=l[0]*l[0]+l[1]*l[1],h=l[0]*c[0]+l[1]*c[1],f=h*h/u;return h<0?d:f>u?(t-s)*(t-s)+(e-o)*(e-o):d-f},fa=function(t,e,r){for(var n,s,o,l,c,u=0,d=0;d<r.length/2;d++)if(n=r[d*2],s=r[d*2+1],d+1<r.length/2?(o=r[(d+1)*2],l=r[(d+1)*2+1]):(o=r[(d+1-r.length/2)*2],l=r[(d+1-r.length/2)*2+1]),!(n==t&&o==t))if(n>=t&&t>=o||n<=t&&t<=o)c=(t-n)/(o-n)*(l-s)+s,c>e&&u++;else continue;return u%2!==0},il=function(t,e,r,n,s,o,l,c,u){var d=new Array(r.length),h;c[0]!=null?(h=Math.atan(c[1]/c[0]),c[0]<0?h=h+Math.PI/2:h=-h-Math.PI/2):h=c;for(var f=Math.cos(-h),m=Math.sin(-h),g=0;g<d.length/2;g++)d[g*2]=o/2*(r[g*2]*f-r[g*2+1]*m),d[g*2+1]=l/2*(r[g*2+1]*f+r[g*2]*m),d[g*2]+=n,d[g*2+1]+=s;var y;if(u>0){var v=vw(d,-u);y=gw(v)}else y=d;return fa(t,e,y)},Nye=function(t,e,r,n,s,o,l,c){for(var u=new Array(r.length*2),d=0;d<c.length;d++){var h=c[d];u[d*4+0]=h.startX,u[d*4+1]=h.startY,u[d*4+2]=h.stopX,u[d*4+3]=h.stopY;var f=Math.pow(h.cx-t,2)+Math.pow(h.cy-e,2);if(f<=Math.pow(h.radius,2))return!0}return fa(t,e,u)},gw=function(t){for(var e=new Array(t.length/2),r,n,s,o,l,c,u,d,h=0;h<t.length/4;h++){r=t[h*4],n=t[h*4+1],s=t[h*4+2],o=t[h*4+3],h<t.length/4-1?(l=t[(h+1)*4],c=t[(h+1)*4+1],u=t[(h+1)*4+2],d=t[(h+1)*4+3]):(l=t[0],c=t[1],u=t[2],d=t[3]);var f=hc(r,n,s,o,l,c,u,d,!0);e[h*2]=f[0],e[h*2+1]=f[1]}return e},vw=function(t,e){for(var r=new Array(t.length*2),n,s,o,l,c=0;c<t.length/2;c++){n=t[c*2],s=t[c*2+1],c<t.length/2-1?(o=t[(c+1)*2],l=t[(c+1)*2+1]):(o=t[0],l=t[1]);var u=l-s,d=-(o-n),h=Math.sqrt(u*u+d*d),f=u/h,m=d/h;r[c*4]=n+f*e,r[c*4+1]=s+m*e,r[c*4+2]=o+f*e,r[c*4+3]=l+m*e}return r},Bye=function(t,e,r,n,s,o){var l=r-t,c=n-e;l/=s,c/=o;var u=Math.sqrt(l*l+c*c),d=u-1;if(d<0)return[];var h=d/u;return[(r-t)*h+t,(n-e)*h+e]},ju=function(t,e,r,n,s,o,l){return t-=s,e-=o,t/=r/2+l,e/=n/2+l,t*t+e*e<=1},Gg=function(t,e,r,n,s,o,l){var c=[r-t,n-e],u=[t-s,e-o],d=c[0]*c[0]+c[1]*c[1],h=2*(u[0]*c[0]+u[1]*c[1]),f=u[0]*u[0]+u[1]*u[1]-l*l,m=h*h-4*d*f;if(m<0)return[];var g=(-h+Math.sqrt(m))/(2*d),y=(-h-Math.sqrt(m))/(2*d),v=Math.min(g,y),E=Math.max(g,y),C=[];if(v>=0&&v<=1&&C.push(v),E>=0&&E<=1&&C.push(E),C.length===0)return[];var _=C[0]*c[0]+t,x=C[0]*c[1]+e;if(C.length>1){if(C[0]==C[1])return[_,x];var P=C[1]*c[0]+t,I=C[1]*c[1]+e;return[_,x,P,I]}else return[_,x]},Jk=function(t,e,r){return e<=t&&t<=r||r<=t&&t<=e?t:t<=e&&e<=r||r<=e&&e<=t?e:r},hc=function(t,e,r,n,s,o,l,c,u){var d=t-s,h=r-t,f=l-s,m=e-o,g=n-e,y=c-o,v=f*m-y*d,E=h*m-g*d,C=y*h-f*g;if(C!==0){var _=v/C,x=E/C,P=.001,I=0-P,M=1+P;return I<=_&&_<=M&&I<=x&&x<=M?[t+_*h,e+_*g]:u?[t+_*h,e+_*g]:[]}else return v===0||E===0?Jk(t,r,l)===l?[l,c]:Jk(t,r,s)===s?[s,o]:Jk(s,l,r)===r?[r,n]:[]:[]},$ye=function(t,e,r,n,s){var o=[],l=n/2,c=s/2,u=e,d=r;o.push({x:u+l*t[0],y:d+c*t[1]});for(var h=1;h<t.length/2;h++)o.push({x:u+l*t[h*2],y:d+c*t[h*2+1]});return o},Jg=function(t,e,r,n,s,o,l,c){var u=[],d,h=new Array(r.length),f=!0;o==null&&(f=!1);var m;if(f){for(var g=0;g<h.length/2;g++)h[g*2]=r[g*2]*o+n,h[g*2+1]=r[g*2+1]*l+s;if(c>0){var y=vw(h,-c);m=gw(y)}else m=h}else m=r;for(var v,E,C,_,x=0;x<m.length/2;x++)v=m[x*2],E=m[x*2+1],x<m.length/2-1?(C=m[(x+1)*2],_=m[(x+1)*2+1]):(C=m[0],_=m[1]),d=hc(t,e,n,s,v,E,C,_),d.length!==0&&u.push(d[0],d[1]);return u},zye=function(t,e,r,n,s,o,l,c,u){var d=[],h,f=new Array(r.length*2);u.forEach(function(C,_){_===0?(f[f.length-2]=C.startX,f[f.length-1]=C.startY):(f[_*4-2]=C.startX,f[_*4-1]=C.startY),f[_*4]=C.stopX,f[_*4+1]=C.stopY,h=Gg(t,e,n,s,C.cx,C.cy,C.radius),h.length!==0&&d.push(h[0],h[1])});for(var m=0;m<f.length/4;m++)h=hc(t,e,n,s,f[m*4],f[m*4+1],f[m*4+2],f[m*4+3],!1),h.length!==0&&d.push(h[0],h[1]);if(d.length>2){for(var g=[d[0],d[1]],y=Math.pow(g[0]-t,2)+Math.pow(g[1]-e,2),v=1;v<d.length/2;v++){var E=Math.pow(d[v*2]-t,2)+Math.pow(d[v*2+1]-e,2);E<=y&&(g[0]=d[v*2],g[1]=d[v*2+1],y=E)}return g}return d},U0=function(t,e,r){var n=[t[0]-e[0],t[1]-e[1]],s=Math.sqrt(n[0]*n[0]+n[1]*n[1]),o=(s-r)/s;return o<0&&(o=1e-5),[e[0]+o*n[0],e[1]+o*n[1]]},Wn=function(t,e){var r=dD(t,e);return r=MV(r),r},MV=function(t){for(var e,r,n=t.length/2,s=1/0,o=1/0,l=-1/0,c=-1/0,u=0;u<n;u++)e=t[2*u],r=t[2*u+1],s=Math.min(s,e),l=Math.max(l,e),o=Math.min(o,r),c=Math.max(c,r);for(var d=2/(l-s),h=2/(c-o),f=0;f<n;f++)e=t[2*f]=t[2*f]*d,r=t[2*f+1]=t[2*f+1]*h,s=Math.min(s,e),l=Math.max(l,e),o=Math.min(o,r),c=Math.max(c,r);if(o<-1)for(var m=0;m<n;m++)r=t[2*m+1]=t[2*m+1]+(-1-o);return t},dD=function(t,e){var r=1/t*2*Math.PI,n=t%2===0?Math.PI/2+r/2:Math.PI/2;n+=e;for(var s=new Array(t*2),o,l=0;l<t;l++)o=l*r+n,s[2*l]=Math.cos(o),s[2*l+1]=Math.sin(-o);return s},vc=function(t,e){return Math.min(t/4,e/4,8)},IV=function(t,e){return Math.min(t/10,e/10,8)},zD=function(){return 8},Hye=function(t,e,r){return[t-2*e+r,2*(e-t),t]},hD=function(t,e){return{heightOffset:Math.min(15,.05*e),widthOffset:Math.min(100,.25*t),ctrlPtOffsetPct:.05}};Gye=on({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(t){return 1}}),Vye={pageRank:function(t){for(var e=Gye(t),r=e.dampingFactor,n=e.precision,s=e.iterations,o=e.weight,l=this._private.cy,c=this.byGroup(),u=c.nodes,d=c.edges,h=u.length,f=h*h,m=d.length,g=new Array(f),y=new Array(h),v=(1-r)/h,E=0;E<h;E++){for(var C=0;C<h;C++){var _=E*h+C;g[_]=0}y[E]=0}for(var x=0;x<m;x++){var P=d[x],I=P.data("source"),M=P.data("target");if(I!==M){var O=u.indexOfId(I),R=u.indexOfId(M),F=o(P),$=R*h+O;g[$]+=F,y[O]+=F}}for(var k=1/h+v,N=0;N<h;N++)if(y[N]===0)for(var G=0;G<h;G++){var W=G*h+N;g[W]=k}else for(var Y=0;Y<h;Y++){var U=Y*h+N;g[U]=g[U]/y[N]+v}for(var Z=new Array(h),q=new Array(h),X,ie=0;ie<h;ie++)Z[ie]=1;for(var j=0;j<s;j++){for(var K=0;K<h;K++)q[K]=0;for(var se=0;se<h;se++)for(var ne=0;ne<h;ne++){var ge=se*h+ne;q[se]+=g[ge]*Z[ne]}Cye(q),X=Z,Z=q,q=X;for(var ve=0,Se=0;Se<h;Se++){var Te=X[Se]-Z[Se];ve+=Te*Te}if(ve<n)break}var me={rank:function(B){return B=l.collection(B)[0],Z[u.indexOf(B)]}};return me}},nH=on({root:null,weight:function(t){return 1},directed:!1,alpha:0}),vf={degreeCentralityNormalized:function(t){t=nH(t);var e=this.cy(),r=this.nodes(),n=r.length;if(t.directed){for(var d={},h={},f=0,m=0,g=0;g<n;g++){var y=r[g],v=y.id();t.root=y;var E=this.degreeCentrality(t);f<E.indegree&&(f=E.indegree),m<E.outdegree&&(m=E.outdegree),d[v]=E.indegree,h[v]=E.outdegree}return{indegree:function(_){return f==0?0:(at(_)&&(_=e.filter(_)),d[_.id()]/f)},outdegree:function(_){return m===0?0:(at(_)&&(_=e.filter(_)),h[_.id()]/m)}}}else{for(var s={},o=0,l=0;l<n;l++){var c=r[l];t.root=c;var u=this.degreeCentrality(t);o<u.degree&&(o=u.degree),s[c.id()]=u.degree}return{degree:function(_){return o===0?0:(at(_)&&(_=e.filter(_)),s[_.id()]/o)}}}},degreeCentrality:function(t){t=nH(t);var e=this.cy(),r=this,n=t,s=n.root,o=n.weight,l=n.directed,c=n.alpha;if(s=e.collection(s)[0],l){for(var m=s.connectedEdges(),g=m.filter(function(I){return I.target().same(s)&&r.has(I)}),y=m.filter(function(I){return I.source().same(s)&&r.has(I)}),v=g.length,E=y.length,C=0,_=0,x=0;x<g.length;x++)C+=o(g[x]);for(var P=0;P<y.length;P++)_+=o(y[P]);return{indegree:Math.pow(v,1-c)*Math.pow(C,c),outdegree:Math.pow(E,1-c)*Math.pow(_,c)}}else{for(var u=s.connectedEdges().intersection(r),d=u.length,h=0,f=0;f<u.length;f++)h+=o(u[f]);return{degree:Math.pow(d,1-c)*Math.pow(h,c)}}}};vf.dc=vf.degreeCentrality;vf.dcn=vf.degreeCentralityNormalised=vf.degreeCentralityNormalized;aH=on({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),yf={closenessCentralityNormalized:function(t){for(var e=aH(t),r=e.harmonic,n=e.weight,s=e.directed,o=this.cy(),l={},c=0,u=this.nodes(),d=this.floydWarshall({weight:n,directed:s}),h=0;h<u.length;h++){for(var f=0,m=u[h],g=0;g<u.length;g++)if(h!==g){var y=d.distance(m,u[g]);r?f+=1/y:f+=y}r||(f=1/f),c<f&&(c=f),l[m.id()]=f}return{closeness:function(E){return c==0?0:(at(E)?E=o.filter(E)[0].id():E=E.id(),l[E]/c)}}},closenessCentrality:function(t){var e=aH(t),r=e.root,n=e.weight,s=e.directed,o=e.harmonic;r=this.filter(r)[0];for(var l=this.dijkstra({root:r,weight:n,directed:s}),c=0,u=this.nodes(),d=0;d<u.length;d++){var h=u[d];if(!h.same(r)){var f=l.distanceTo(h);o?c+=1/f:c+=f}}return o?c:1/c}};yf.cc=yf.closenessCentrality;yf.ccn=yf.closenessCentralityNormalised=yf.closenessCentralityNormalized;Wye=on({weight:null,directed:!1}),fD={betweennessCentrality:function(t){for(var e=Wye(t),r=e.directed,n=e.weight,s=n!=null,o=this.cy(),l=this.nodes(),c={},u={},d=0,h={set:function(_,x){u[_]=x,x>d&&(d=x)},get:function(_){return u[_]}},f=0;f<l.length;f++){var m=l[f],g=m.id();r?c[g]=m.outgoers().nodes():c[g]=m.openNeighborhood().nodes(),h.set(g,0)}for(var y=function(){for(var _=l[v].id(),x=[],P={},I={},M={},O=new uv(function(se,ne){return M[se]-M[ne]}),R=0;R<l.length;R++){var F=l[R].id();P[F]=[],I[F]=0,M[F]=1/0}for(I[_]=1,M[_]=0,O.push(_);!O.empty();){var $=O.pop();if(x.push($),s)for(var k=0;k<c[$].length;k++){var N=c[$][k],G=o.getElementById($),W=void 0;G.edgesTo(N).length>0?W=G.edgesTo(N)[0]:W=N.edgesTo(G)[0];var Y=n(W);N=N.id(),M[N]>M[$]+Y&&(M[N]=M[$]+Y,O.nodes.indexOf(N)<0?O.push(N):O.updateItem(N),I[N]=0,P[N]=[]),M[N]==M[$]+Y&&(I[N]=I[N]+I[$],P[N].push($))}else for(var U=0;U<c[$].length;U++){var Z=c[$][U].id();M[Z]==1/0&&(O.push(Z),M[Z]=M[$]+1),M[Z]==M[$]+1&&(I[Z]=I[Z]+I[$],P[Z].push($))}}for(var q={},X=0;X<l.length;X++)q[l[X].id()]=0;for(;x.length>0;){for(var ie=x.pop(),j=0;j<P[ie].length;j++){var K=P[ie][j];q[K]=q[K]+I[K]/I[ie]*(1+q[ie])}ie!=l[v].id()&&h.set(ie,h.get(ie)+q[ie])}},v=0;v<l.length;v++)y();var E={betweenness:function(_){var x=o.collection(_).id();return h.get(x)},betweennessNormalized:function(_){if(d==0)return 0;var x=o.collection(_).id();return h.get(x)/d}};return E.betweennessNormalised=E.betweennessNormalized,E}};fD.bc=fD.betweennessCentrality;Uye=on({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(a){return 1}]}),jye=function(t){return Uye(t)},Yye=function(t,e){for(var r=0,n=0;n<e.length;n++)r+=e[n](t);return r},qye=function(t,e,r){for(var n=0;n<e;n++)t[n*e+n]=r},AV=function(t,e){for(var r,n=0;n<e;n++){r=0;for(var s=0;s<e;s++)r+=t[s*e+n];for(var o=0;o<e;o++)t[o*e+n]=t[o*e+n]/r}},Zye=function(t,e,r){for(var n=new Array(r*r),s=0;s<r;s++){for(var o=0;o<r;o++)n[s*r+o]=0;for(var l=0;l<r;l++)for(var c=0;c<r;c++)n[s*r+c]+=t[s*r+l]*e[l*r+c]}return n},Kye=function(t,e,r){for(var n=t.slice(0),s=1;s<r;s++)t=Zye(t,n,e);return t},Xye=function(t,e,r){for(var n=new Array(e*e),s=0;s<e*e;s++)n[s]=Math.pow(t[s],r);return AV(n,e),n},Jye=function(t,e,r,n){for(var s=0;s<r;s++){var o=Math.round(t[s]*Math.pow(10,n))/Math.pow(10,n),l=Math.round(e[s]*Math.pow(10,n))/Math.pow(10,n);if(o!==l)return!1}return!0},Qye=function(t,e,r,n){for(var s=[],o=0;o<e;o++){for(var l=[],c=0;c<e;c++)Math.round(t[o*e+c]*1e3)/1e3>0&&l.push(r[c]);l.length!==0&&s.push(n.collection(l))}return s},ebe=function(t,e){for(var r=0;r<t.length;r++)if(!e[r]||t[r].id()!==e[r].id())return!1;return!0},tbe=function(t){for(var e=0;e<t.length;e++)for(var r=0;r<t.length;r++)e!=r&&ebe(t[e],t[r])&&t.splice(r,1);return t},sH=function(t){for(var e=this.nodes(),r=this.edges(),n=this.cy(),s=jye(t),o={},l=0;l<e.length;l++)o[e[l].id()]=l;for(var c=e.length,u=c*c,d=new Array(u),h,f=0;f<u;f++)d[f]=0;for(var m=0;m<r.length;m++){var g=r[m],y=o[g.source().id()],v=o[g.target().id()],E=Yye(g,s.attributes);d[y*c+v]+=E,d[v*c+y]+=E}qye(d,c,s.multFactor),AV(d,c);for(var C=!0,_=0;C&&_<s.maxIterations;)C=!1,h=Kye(d,c,s.expandFactor),d=Xye(h,c,s.inflateFactor),Jye(d,h,u,4)||(C=!0),_++;var x=Qye(d,c,e,n);return x=tbe(x),x},rbe={markovClustering:sH,mcl:sH},ibe=function(t){return t},OV=function(t,e){return Math.abs(e-t)},oH=function(t,e,r){return t+OV(e,r)},lH=function(t,e,r){return t+Math.pow(r-e,2)},nbe=function(t){return Math.sqrt(t)},abe=function(t,e,r){return Math.max(t,OV(e,r))},Fg=function(t,e,r,n,s){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:ibe,l=n,c,u,d=0;d<t;d++)c=e(d),u=r(d),l=s(l,c,u);return o(l)},Ef={euclidean:function(t,e,r){return t>=2?Fg(t,e,r,0,lH,nbe):Fg(t,e,r,0,oH)},squaredEuclidean:function(t,e,r){return Fg(t,e,r,0,lH)},manhattan:function(t,e,r){return Fg(t,e,r,0,oH)},max:function(t,e,r){return Fg(t,e,r,-1/0,abe)}};Ef["squared-euclidean"]=Ef.squaredEuclidean;Ef.squaredeuclidean=Ef.squaredEuclidean;sbe=on({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),HD=function(t){return sbe(t)},yw=function(t,e,r,n,s){var o=s!=="kMedoids",l=o?function(h){return r[h]}:function(h){return n[h](r)},c=function(f){return n[f](e)},u=r,d=e;return Lw(t,n.length,l,c,u,d)},e1=function(t,e,r){for(var n=r.length,s=new Array(n),o=new Array(n),l=new Array(e),c=null,u=0;u<n;u++)s[u]=t.min(r[u]).value,o[u]=t.max(r[u]).value;for(var d=0;d<e;d++){c=[];for(var h=0;h<n;h++)c[h]=Math.random()*(o[h]-s[h])+s[h];l[d]=c}return l},FV=function(t,e,r,n,s){for(var o=1/0,l=0,c=0;c<e.length;c++){var u=yw(r,t,e[c],n,s);u<o&&(o=u,l=c)}return l},RV=function(t,e,r){for(var n=[],s=null,o=0;o<e.length;o++)s=e[o],r[s.id()]===t&&n.push(s);return n},obe=function(t,e,r){return Math.abs(e-t)<=r},lbe=function(t,e,r){for(var n=0;n<t.length;n++)for(var s=0;s<t[n].length;s++){var o=Math.abs(t[n][s]-e[n][s]);if(o>r)return!1}return!0},cbe=function(t,e,r){for(var n=0;n<r;n++)if(t===e[n])return!0;return!1},cH=function(t,e){var r=new Array(e);if(t.length<50)for(var n=0;n<e;n++){for(var s=t[Math.floor(Math.random()*t.length)];cbe(s,r,n);)s=t[Math.floor(Math.random()*t.length)];r[n]=s}else for(var o=0;o<e;o++)r[o]=t[Math.floor(Math.random()*t.length)];return r},uH=function(t,e,r){for(var n=0,s=0;s<e.length;s++)n+=yw("manhattan",e[s],t,r,"kMedoids");return n},ube=function(t){var e=this.cy(),r=this.nodes(),n=null,s=HD(t),o=new Array(s.k),l={},c;s.testMode?typeof s.testCentroids=="number"?(s.testCentroids,c=e1(r,s.k,s.attributes)):Ai(s.testCentroids)==="object"?c=s.testCentroids:c=e1(r,s.k,s.attributes):c=e1(r,s.k,s.attributes);for(var u=!0,d=0;u&&d<s.maxIterations;){for(var h=0;h<r.length;h++)n=r[h],l[n.id()]=FV(n,c,s.distance,s.attributes,"kMeans");u=!1;for(var f=0;f<s.k;f++){var m=RV(f,r,l);if(m.length!==0){for(var g=s.attributes.length,y=c[f],v=new Array(g),E=new Array(g),C=0;C<g;C++){E[C]=0;for(var _=0;_<m.length;_++)n=m[_],E[C]+=s.attributes[C](n);v[C]=E[C]/m.length,obe(v[C],y[C],s.sensitivityThreshold)||(u=!0)}c[f]=v,o[f]=e.collection(m)}}d++}return o},dbe=function(t){var e=this.cy(),r=this.nodes(),n=null,s=HD(t),o=new Array(s.k),l,c={},u,d=new Array(s.k);s.testMode?typeof s.testCentroids=="number"||(Ai(s.testCentroids)==="object"?l=s.testCentroids:l=cH(r,s.k)):l=cH(r,s.k);for(var h=!0,f=0;h&&f<s.maxIterations;){for(var m=0;m<r.length;m++)n=r[m],c[n.id()]=FV(n,l,s.distance,s.attributes,"kMedoids");h=!1;for(var g=0;g<l.length;g++){var y=RV(g,r,c);if(y.length!==0){d[g]=uH(l[g],y,s.attributes);for(var v=0;v<y.length;v++)u=uH(y[v],y,s.attributes),u<d[g]&&(d[g]=u,l[g]=y[v],h=!0);o[g]=e.collection(y)}}f++}return o},hbe=function(t,e,r,n,s){for(var o,l,c=0;c<e.length;c++)for(var u=0;u<t.length;u++)n[c][u]=Math.pow(r[c][u],s.m);for(var d=0;d<t.length;d++)for(var h=0;h<s.attributes.length;h++){o=0,l=0;for(var f=0;f<e.length;f++)o+=n[f][d]*s.attributes[h](e[f]),l+=n[f][d];t[d][h]=o/l}},fbe=function(t,e,r,n,s){for(var o=0;o<t.length;o++)e[o]=t[o].slice();for(var l,c,u,d=2/(s.m-1),h=0;h<r.length;h++)for(var f=0;f<n.length;f++){l=0;for(var m=0;m<r.length;m++)c=yw(s.distance,n[f],r[h],s.attributes,"cmeans"),u=yw(s.distance,n[f],r[m],s.attributes,"cmeans"),l+=Math.pow(c/u,d);t[f][h]=1/l}},pbe=function(t,e,r,n){for(var s=new Array(r.k),o=0;o<s.length;o++)s[o]=[];for(var l,c,u=0;u<e.length;u++){l=-1/0,c=-1;for(var d=0;d<e[0].length;d++)e[u][d]>l&&(l=e[u][d],c=d);s[c].push(t[u])}for(var h=0;h<s.length;h++)s[h]=n.collection(s[h]);return s},dH=function(t){var e=this.cy(),r=this.nodes(),n=HD(t),s,o,l,c,u;c=new Array(r.length);for(var d=0;d<r.length;d++)c[d]=new Array(n.k);l=new Array(r.length);for(var h=0;h<r.length;h++)l[h]=new Array(n.k);for(var f=0;f<r.length;f++){for(var m=0,g=0;g<n.k;g++)l[f][g]=Math.random(),m+=l[f][g];for(var y=0;y<n.k;y++)l[f][y]=l[f][y]/m}o=new Array(n.k);for(var v=0;v<n.k;v++)o[v]=new Array(n.attributes.length);u=new Array(r.length);for(var E=0;E<r.length;E++)u[E]=new Array(n.k);for(var C=!0,_=0;C&&_<n.maxIterations;)C=!1,hbe(o,r,l,u,n),fbe(l,c,o,r,n),lbe(l,c,n.sensitivityThreshold)||(C=!0),_++;return s=pbe(r,l,n,e),{clusters:s,degreeOfMembership:l}},mbe={kMeans:ube,kMedoids:dbe,fuzzyCMeans:dH,fcm:dH},gbe=on({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),vbe={single:"min",complete:"max"},ybe=function(t){var e=gbe(t),r=vbe[e.linkage];return r!=null&&(e.linkage=r),e},hH=function(t,e,r,n,s){for(var o=0,l=1/0,c,u=s.attributes,d=function(R,F){return Lw(s.distance,u.length,function($){return u[$](R)},function($){return u[$](F)},R,F)},h=0;h<t.length;h++){var f=t[h].key,m=r[f][n[f]];m<l&&(o=f,l=m)}if(s.mode==="threshold"&&l>=s.threshold||s.mode==="dendrogram"&&t.length===1)return!1;var g=e[o],y=e[n[o]],v;s.mode==="dendrogram"?v={left:g,right:y,key:g.key}:v={value:g.value.concat(y.value),key:g.key},t[g.index]=v,t.splice(y.index,1),e[g.key]=v;for(var E=0;E<t.length;E++){var C=t[E];g.key===C.key?c=1/0:s.linkage==="min"?(c=r[g.key][C.key],r[g.key][C.key]>r[y.key][C.key]&&(c=r[y.key][C.key])):s.linkage==="max"?(c=r[g.key][C.key],r[g.key][C.key]<r[y.key][C.key]&&(c=r[y.key][C.key])):s.linkage==="mean"?c=(r[g.key][C.key]*g.size+r[y.key][C.key]*y.size)/(g.size+y.size):s.mode==="dendrogram"?c=d(C.value,g.value):c=d(C.value[0],g.value[0]),r[g.key][C.key]=r[C.key][g.key]=c}for(var _=0;_<t.length;_++){var x=t[_].key;if(n[x]===g.key||n[x]===y.key){for(var P=x,I=0;I<t.length;I++){var M=t[I].key;r[x][M]<r[x][P]&&(P=M)}n[x]=P}t[_].index=_}return g.key=y.key=g.index=y.index=null,!0},pf=function(t,e,r){t&&(t.value?e.push(t.value):(t.left&&pf(t.left,e),t.right&&pf(t.right,e)))},pD=function(t,e){if(!t)return"";if(t.left&&t.right){var r=pD(t.left,e),n=pD(t.right,e),s=e.add({group:"nodes",data:{id:r+","+n}});return e.add({group:"edges",data:{source:r,target:s.id()}}),e.add({group:"edges",data:{source:n,target:s.id()}}),s.id()}else if(t.value)return t.value.id()},mD=function(t,e,r){if(!t)return[];var n=[],s=[],o=[];return e===0?(t.left&&pf(t.left,n),t.right&&pf(t.right,s),o=n.concat(s),[r.collection(o)]):e===1?t.value?[r.collection(t.value)]:(t.left&&pf(t.left,n),t.right&&pf(t.right,s),[r.collection(n),r.collection(s)]):t.value?[r.collection(t.value)]:(t.left&&(n=mD(t.left,e-1,r)),t.right&&(s=mD(t.right,e-1,r)),n.concat(s))},fH=function(t){for(var e=this.cy(),r=this.nodes(),n=ybe(t),s=n.attributes,o=function(_,x){return Lw(n.distance,s.length,function(P){return s[P](_)},function(P){return s[P](x)},_,x)},l=[],c=[],u=[],d=[],h=0;h<r.length;h++){var f={value:n.mode==="dendrogram"?r[h]:[r[h]],key:h,index:h};l[h]=f,d[h]=f,c[h]=[],u[h]=0}for(var m=0;m<l.length;m++)for(var g=0;g<=m;g++){var y=void 0;n.mode==="dendrogram"?y=m===g?1/0:o(l[m].value,l[g].value):y=m===g?1/0:o(l[m].value[0],l[g].value[0]),c[m][g]=y,c[g][m]=y,y<c[m][u[m]]&&(u[m]=g)}for(var v=hH(l,d,c,u,n);v;)v=hH(l,d,c,u,n);var E;return n.mode==="dendrogram"?(E=mD(l[0],n.dendrogramDepth,e),n.addDendrogram&&pD(l[0],e)):(E=new Array(l.length),l.forEach(function(C,_){C.key=C.index=null,E[_]=e.collection(C.value)})),E},bbe={hierarchicalClustering:fH,hca:fH},wbe=on({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),Ebe=function(t){var e=t.damping,r=t.preference;.5<=e&&e<1||qr("Damping must range on [0.5, 1).  Got: ".concat(e));var n=["median","mean","min","max"];return n.some(function(s){return s===r})||We(r)||qr("Preference must be one of [".concat(n.map(function(s){return"'".concat(s,"'")}).join(", "),"] or a number.  Got: ").concat(r)),wbe(t)},Tbe=function(t,e,r,n){var s=function(l,c){return n[c](l)};return-Lw(t,n.length,function(o){return s(e,o)},function(o){return s(r,o)},e,r)},Cbe=function(t,e){var r=null;return e==="median"?r=Eye(t):e==="mean"?r=wye(t):e==="min"?r=yye(t):e==="max"?r=bye(t):r=e,r},_be=function(t,e,r){for(var n=[],s=0;s<t;s++)e[s*t+s]+r[s*t+s]>0&&n.push(s);return n},pH=function(t,e,r){for(var n=[],s=0;s<t;s++){for(var o=-1,l=-1/0,c=0;c<r.length;c++){var u=r[c];e[s*t+u]>l&&(o=u,l=e[s*t+u])}o>0&&n.push(o)}for(var d=0;d<r.length;d++)n[r[d]]=r[d];return n},Sbe=function(t,e,r){for(var n=pH(t,e,r),s=0;s<r.length;s++){for(var o=[],l=0;l<n.length;l++)n[l]===r[s]&&o.push(l);for(var c=-1,u=-1/0,d=0;d<o.length;d++){for(var h=0,f=0;f<o.length;f++)h+=e[o[f]*t+o[d]];h>u&&(c=d,u=h)}r[s]=o[c]}return n=pH(t,e,r),n},mH=function(t){for(var e=this.cy(),r=this.nodes(),n=Ebe(t),s={},o=0;o<r.length;o++)s[r[o].id()]=o;var l,c,u,d,h,f;l=r.length,c=l*l,u=new Array(c);for(var m=0;m<c;m++)u[m]=-1/0;for(var g=0;g<l;g++)for(var y=0;y<l;y++)g!==y&&(u[g*l+y]=Tbe(n.distance,r[g],r[y],n.attributes));d=Cbe(u,n.preference);for(var v=0;v<l;v++)u[v*l+v]=d;h=new Array(c);for(var E=0;E<c;E++)h[E]=0;f=new Array(c);for(var C=0;C<c;C++)f[C]=0;for(var _=new Array(l),x=new Array(l),P=new Array(l),I=0;I<l;I++)_[I]=0,x[I]=0,P[I]=0;for(var M=new Array(l*n.minIterations),O=0;O<M.length;O++)M[O]=0;var R;for(R=0;R<n.maxIterations;R++){for(var F=0;F<l;F++){for(var $=-1/0,k=-1/0,N=-1,G=0,W=0;W<l;W++)_[W]=h[F*l+W],G=f[F*l+W]+u[F*l+W],G>=$?(k=$,$=G,N=W):G>k&&(k=G);for(var Y=0;Y<l;Y++)h[F*l+Y]=(1-n.damping)*(u[F*l+Y]-$)+n.damping*_[Y];h[F*l+N]=(1-n.damping)*(u[F*l+N]-k)+n.damping*_[N]}for(var U=0;U<l;U++){for(var Z=0,q=0;q<l;q++)_[q]=f[q*l+U],x[q]=Math.max(0,h[q*l+U]),Z+=x[q];Z-=x[U],x[U]=h[U*l+U],Z+=x[U];for(var X=0;X<l;X++)f[X*l+U]=(1-n.damping)*Math.min(0,Z-x[X])+n.damping*_[X];f[U*l+U]=(1-n.damping)*(Z-x[U])+n.damping*_[U]}for(var ie=0,j=0;j<l;j++){var K=f[j*l+j]+h[j*l+j]>0?1:0;M[R%n.minIterations*l+j]=K,ie+=K}if(ie>0&&(R>=n.minIterations-1||R==n.maxIterations-1)){for(var se=0,ne=0;ne<l;ne++){P[ne]=0;for(var ge=0;ge<n.minIterations;ge++)P[ne]+=M[ge*l+ne];(P[ne]===0||P[ne]===n.minIterations)&&se++}if(se===l)break}}for(var ve=_be(l,h,f),Se=Sbe(l,u,ve),Te={},me=0;me<ve.length;me++)Te[ve[me]]=[];for(var pe=0;pe<r.length;pe++){var B=s[r[pe].id()],oe=Se[B];oe!=null&&Te[oe].push(r[pe])}for(var he=new Array(ve.length),te=0;te<ve.length;te++)he[te]=e.collection(Te[ve[te]]);return he},xbe={affinityPropagation:mH,ap:mH},kbe=on({root:void 0,directed:!1}),Dbe={hierholzer:function(t){if(!Zt(t)){var e=arguments;t={root:e[0],directed:e[1]}}var r=kbe(t),n=r.root,s=r.directed,o=this,l=!1,c,u,d;n&&(d=at(n)?this.filter(n)[0].id():n[0].id());var h={},f={};s?o.forEach(function(C){var _=C.id();if(C.isNode()){var x=C.indegree(!0),P=C.outdegree(!0),I=x-P,M=P-x;I==1?c?l=!0:c=_:M==1?u?l=!0:u=_:(M>1||I>1)&&(l=!0),h[_]=[],C.outgoers().forEach(function(O){O.isEdge()&&h[_].push(O.id())})}else f[_]=[void 0,C.target().id()]}):o.forEach(function(C){var _=C.id();if(C.isNode()){var x=C.degree(!0);x%2&&(c?u?l=!0:u=_:c=_),h[_]=[],C.connectedEdges().forEach(function(P){return h[_].push(P.id())})}else f[_]=[C.source().id(),C.target().id()]});var m={found:!1,trail:void 0};if(l)return m;if(u&&c)if(s){if(d&&u!=d)return m;d=u}else{if(d&&u!=d&&c!=d)return m;d||(d=u)}else d||(d=o[0].id());var g=function(_){for(var x=_,P=[_],I,M,O;h[x].length;)I=h[x].shift(),M=f[I][0],O=f[I][1],x!=O?(h[O]=h[O].filter(function(R){return R!=I}),x=O):!s&&x!=M&&(h[M]=h[M].filter(function(R){return R!=I}),x=M),P.unshift(I),P.unshift(x);return P},y=[],v=[];for(v=g(d);v.length!=1;)h[v[0]].length==0?(y.unshift(o.getElementById(v.shift())),y.unshift(o.getElementById(v.shift()))):v=g(v.shift()).concat(v);y.unshift(o.getElementById(v.shift()));for(var E in h)if(h[E].length)return m;return m.found=!0,m.trail=this.spawn(y,!0),m}},j0=function(){var t=this,e={},r=0,n=0,s=[],o=[],l={},c=function(f,m){for(var g=o.length-1,y=[],v=t.spawn();o[g].x!=f||o[g].y!=m;)y.push(o.pop().edge),g--;y.push(o.pop().edge),y.forEach(function(E){var C=E.connectedNodes().intersection(t);v.merge(E),C.forEach(function(_){var x=_.id(),P=_.connectedEdges().intersection(t);v.merge(_),e[x].cutVertex?v.merge(P.filter(function(I){return I.isLoop()})):v.merge(P)})}),s.push(v)},u=function(f,m,g){f===g&&(n+=1),e[m]={id:r,low:r++,cutVertex:!1};var y=t.getElementById(m).connectedEdges().intersection(t);if(y.size()===0)s.push(t.spawn(t.getElementById(m)));else{var v,E,C,_;y.forEach(function(x){v=x.source().id(),E=x.target().id(),C=v===m?E:v,C!==g&&(_=x.id(),l[_]||(l[_]=!0,o.push({x:m,y:C,edge:x})),C in e?e[m].low=Math.min(e[m].low,e[C].id):(u(f,C,m),e[m].low=Math.min(e[m].low,e[C].low),e[m].id<=e[C].low&&(e[m].cutVertex=!0,c(m,C))))})}};t.forEach(function(h){if(h.isNode()){var f=h.id();f in e||(n=0,u(f,f),e[f].cutVertex=n>1)}});var d=Object.keys(e).filter(function(h){return e[h].cutVertex}).map(function(h){return t.getElementById(h)});return{cut:t.spawn(d),components:s}},Pbe={hopcroftTarjanBiconnected:j0,htbc:j0,htb:j0,hopcroftTarjanBiconnectedComponents:j0},Y0=function(){var t=this,e={},r=0,n=[],s=[],o=t.spawn(t),l=function(u){s.push(u),e[u]={index:r,low:r++,explored:!1};var d=t.getElementById(u).connectedEdges().intersection(t);if(d.forEach(function(y){var v=y.target().id();v!==u&&(v in e||l(v),e[v].explored||(e[u].low=Math.min(e[u].low,e[v].low)))}),e[u].index===e[u].low){for(var h=t.spawn();;){var f=s.pop();if(h.merge(t.getElementById(f)),e[f].low=e[u].index,e[f].explored=!0,f===u)break}var m=h.edgesWith(h),g=h.merge(m);n.push(g),o=o.difference(g)}};return t.forEach(function(c){if(c.isNode()){var u=c.id();u in e||l(u)}}),{cut:o,components:n}},Lbe={tarjanStronglyConnected:Y0,tsc:Y0,tscc:Y0,tarjanStronglyConnectedComponents:Y0},NV={};[Kg,sye,oye,cye,dye,fye,gye,Vye,vf,yf,fD,rbe,mbe,bbe,xbe,Dbe,Pbe,Lbe].forEach(function(a){ut(NV,a)});BV=0,$V=1,zV=2,Bs=function(t){if(!(this instanceof Bs))return new Bs(t);this.id="Thenable/1.0.7",this.state=BV,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof t=="function"&&t.call(this,this.fulfill.bind(this),this.reject.bind(this))};Bs.prototype={fulfill:function(t){return gH(this,$V,"fulfillValue",t)},reject:function(t){return gH(this,zV,"rejectReason",t)},then:function(t,e){var r=this,n=new Bs;return r.onFulfilled.push(yH(t,n,"fulfill")),r.onRejected.push(yH(e,n,"reject")),HV(r),n.proxy}};gH=function(t,e,r,n){return t.state===BV&&(t.state=e,t[r]=n,HV(t)),t},HV=function(t){t.state===$V?vH(t,"onFulfilled",t.fulfillValue):t.state===zV&&vH(t,"onRejected",t.rejectReason)},vH=function(t,e,r){if(t[e].length!==0){var n=t[e];t[e]=[];var s=function(){for(var l=0;l<n.length;l++)n[l](r)};typeof setImmediate=="function"?setImmediate(s):setTimeout(s,0)}},yH=function(t,e,r){return function(n){if(typeof t!="function")e[r].call(e,n);else{var s;try{s=t(n)}catch(o){e.reject(o);return}GV(e,s)}}},GV=function(t,e){if(t===e||t.proxy===e){t.reject(new TypeError("cannot resolve promise with itself"));return}var r;if(Ai(e)==="object"&&e!==null||typeof e=="function")try{r=e.then}catch(s){t.reject(s);return}if(typeof r=="function"){var n=!1;try{r.call(e,function(s){n||(n=!0,s===e?t.reject(new TypeError("circular thenable chain")):GV(t,s))},function(s){n||(n=!0,t.reject(s))})}catch(s){n||t.reject(s)}return}t.fulfill(e)};Bs.all=function(a){return new Bs(function(t,e){for(var r=new Array(a.length),n=0,s=function(c,u){r[c]=u,n++,n===a.length&&t(r)},o=0;o<a.length;o++)(function(l){var c=a[l],u=c!=null&&c.then!=null;if(u)c.then(function(h){s(l,h)},function(h){e(h)});else{var d=c;s(l,d)}})(o)})};Bs.resolve=function(a){return new Bs(function(t,e){t(a)})};Bs.reject=function(a){return new Bs(function(t,e){e(a)})};_f=typeof Promise!="undefined"?Promise:Bs,gD=function(t,e,r){var n=MD(t),s=!n,o=this._private=ut({duration:1e3},e,r);if(o.target=t,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&ti(o.complete)&&o.completes.push(o.complete),s){var l=t.position();o.startPosition=o.startPosition||{x:l.x,y:l.y},o.startStyle=o.startStyle||t.cy().style().getAnimationStartStyle(t,o.style)}if(n){var c=t.pan();o.startPan={x:c.x,y:c.y},o.startZoom=t.zoom()}this.length=1,this[0]=this},Zu=gD.prototype;ut(Zu,{instanceString:function(){return"animation"},hook:function(){var t=this._private;if(!t.hooked){var e,r=t.target._private.animation;t.queue?e=r.queue:e=r.current,e.push(this),Ra(t.target)&&t.target.cy().addToAnimationPool(t.target),t.hooked=!0}return this},play:function(){var t=this._private;return t.progress===1&&(t.progress=0),t.playing=!0,t.started=!1,t.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var t=this._private;return t.applying=!0,t.started=!1,t.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var t=this._private;return t.playing=!1,t.started=!1,this},stop:function(){var t=this._private;return t.playing=!1,t.started=!1,t.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(t){var e=this._private;return t===void 0?e.progress*e.duration:this.progress(t/e.duration)},progress:function(t){var e=this._private,r=e.playing;return t===void 0?e.progress:(r&&this.pause(),e.progress=t,e.started=!1,r&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var t=this._private,e=t.playing;e&&this.pause(),t.progress=1-t.progress,t.started=!1;var r=function(u,d){var h=t[u];h!=null&&(t[u]=t[d],t[d]=h)};if(r("zoom","startZoom"),r("pan","startPan"),r("position","startPosition"),t.style)for(var n=0;n<t.style.length;n++){var s=t.style[n],o=s.name,l=t.startStyle[o];t.startStyle[o]=s,t.style[n]=l}return e&&this.play(),this},promise:function(t){var e=this._private,r;switch(t){case"frame":r=e.frames;break;default:case"complete":case"completed":r=e.completes}return new _f(function(n,s){r.push(function(){n()})})}});Zu.complete=Zu.completed;Zu.run=Zu.play;Zu.running=Zu.playing;Mbe={animated:function(){return function(){var e=this,r=e.length!==void 0,n=r?e:[e],s=this._private.cy||this;if(!s.styleEnabled())return!1;var o=n[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var e=this,r=e.length!==void 0,n=r?e:[e],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var o=0;o<n.length;o++){var l=n[o];l._private.animation.queue=[]}return this}},delay:function(){return function(e,r){var n=this._private.cy||this;return n.styleEnabled()?this.animate({delay:e,duration:e,complete:r}):this}},delayAnimation:function(){return function(e,r){var n=this._private.cy||this;return n.styleEnabled()?this.animation({delay:e,duration:e,complete:r}):this}},animation:function(){return function(e,r){var n=this,s=n.length!==void 0,o=s?n:[n],l=this._private.cy||this,c=!s,u=!c;if(!l.styleEnabled())return this;var d=l.style();e=ut({},e,r);var h=Object.keys(e).length===0;if(h)return new gD(o[0],e);switch(e.duration===void 0&&(e.duration=400),e.duration){case"slow":e.duration=600;break;case"fast":e.duration=200;break}if(u&&(e.style=d.getPropsList(e.style||e.css),e.css=void 0),u&&e.renderedPosition!=null){var f=e.renderedPosition,m=l.pan(),g=l.zoom();e.position=kV(f,g,m)}if(c&&e.panBy!=null){var y=e.panBy,v=l.pan();e.pan={x:v.x+y.x,y:v.y+y.y}}var E=e.center||e.centre;if(c&&E!=null){var C=l.getCenterPan(E.eles,e.zoom);C!=null&&(e.pan=C)}if(c&&e.fit!=null){var _=e.fit,x=l.getFitViewport(_.eles||_.boundingBox,_.padding);x!=null&&(e.pan=x.pan,e.zoom=x.zoom)}if(c&&Zt(e.zoom)){var P=l.getZoomedViewport(e.zoom);P!=null?(P.zoomed&&(e.zoom=P.zoom),P.panned&&(e.pan=P.pan)):e.zoom=null}return new gD(o[0],e)}},animate:function(){return function(e,r){var n=this,s=n.length!==void 0,o=s?n:[n],l=this._private.cy||this;if(!l.styleEnabled())return this;r&&(e=ut({},e,r));for(var c=0;c<o.length;c++){var u=o[c],d=u.animated()&&(e.queue===void 0||e.queue),h=u.animation(e,d?{queue:!0}:void 0);h.play()}return this}},stop:function(){return function(e,r){var n=this,s=n.length!==void 0,o=s?n:[n],l=this._private.cy||this;if(!l.styleEnabled())return this;for(var c=0;c<o.length;c++){for(var u=o[c],d=u._private,h=d.animation.current,f=0;f<h.length;f++){var m=h[f],g=m._private;r&&(g.duration=0)}e&&(d.animation.queue=[]),r||(d.animation.current=[])}return l.notify("draw"),this}}};u0e=c0e(),d0e=sv(u0e);y0e=v0e(),b0e=sv(y0e);T0e=E0e(),C0e=sv(T0e),_0e={data:function(t){var e={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(n){},beforeSet:function(n,s){},onSet:function(n){},canSet:function(n){return!0}};return t=ut({},e,t),function(n,s){var o=t,l=this,c=l.length!==void 0,u=c?l:[l],d=c?l[0]:l;if(at(n)){var h=n.indexOf(".")!==-1,f=h&&C0e(n);if(o.allowGetting&&s===void 0){var m;return d&&(o.beforeGet(d),f&&d._private[o.field][n]===void 0?m=d0e(d._private[o.field],f):m=d._private[o.field][n]),m}else if(o.allowSetting&&s!==void 0){var g=!o.immutableKeys[n];if(g){var y=lV({},n,s);o.beforeSet(l,y);for(var v=0,E=u.length;v<E;v++){var C=u[v];o.canSet(C)&&(f&&d._private[o.field][n]===void 0?b0e(C._private[o.field],f,s):C._private[o.field][n]=s)}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&Zt(n)){var _=n,x,P,I=Object.keys(_);o.beforeSet(l,_);for(var M=0;M<I.length;M++){x=I[M],P=_[x];var O=!o.immutableKeys[x];if(O)for(var R=0;R<u.length;R++){var F=u[R];o.canSet(F)&&(F._private[o.field][x]=P)}}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&ti(n)){var $=n;l.on(o.bindingEvent,$)}else if(o.allowGetting&&n===void 0){var k;return d&&(o.beforeGet(d),k=d._private[o.field]),k}return l}},removeData:function(t){var e={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return t=ut({},e,t),function(n){var s=t,o=this,l=o.length!==void 0,c=l?o:[o];if(at(n)){for(var u=n.split(/\s+/),d=u.length,h=0;h<d;h++){var f=u[h];if(!mc(f)){var m=!s.immutableKeys[f];if(m)for(var g=0,y=c.length;g<y;g++)c[g]._private[s.field][f]=void 0}}s.triggerEvent&&o[s.triggerFnName](s.event)}else if(n===void 0){for(var v=0,E=c.length;v<E;v++)for(var C=c[v]._private[s.field],_=Object.keys(C),x=0;x<_.length;x++){var P=_[x],I=!s.immutableKeys[P];I&&(C[P]=void 0)}s.triggerEvent&&o[s.triggerFnName](s.event)}return o}}},S0e={eventAliasesOn:function(t){var e=t;e.addListener=e.listen=e.bind=e.on,e.unlisten=e.unbind=e.off=e.removeListener,e.trigger=e.emit,e.pon=e.promiseOn=function(r,n){var s=this,o=Array.prototype.slice.call(arguments,0);return new _f(function(l,c){var u=function(m){s.off.apply(s,h),l(m)},d=o.concat([u]),h=d.concat([]);s.on.apply(s,d)})}}},lr={};[Mbe,_0e,S0e].forEach(function(a){ut(lr,a)});x0e={animate:lr.animate(),animation:lr.animation(),animated:lr.animated(),clearQueue:lr.clearQueue(),delay:lr.delay(),delayAnimation:lr.delayAnimation(),stop:lr.stop()},nw={classes:function(t){var e=this;if(t===void 0){var r=[];return e[0]._private.classes.forEach(function(g){return r.push(g)}),r}else Pr(t)||(t=(t||"").match(/\S+/g)||[]);for(var n=[],s=new Cf(t),o=0;o<e.length;o++){for(var l=e[o],c=l._private,u=c.classes,d=!1,h=0;h<t.length;h++){var f=t[h],m=u.has(f);if(!m){d=!0;break}}d||(d=u.size!==t.length),d&&(c.classes=s,n.push(l))}return n.length>0&&this.spawn(n).updateStyle().emit("class"),e},addClass:function(t){return this.toggleClass(t,!0)},hasClass:function(t){var e=this[0];return e!=null&&e._private.classes.has(t)},toggleClass:function(t,e){Pr(t)||(t=t.match(/\S+/g)||[]);for(var r=this,n=e===void 0,s=[],o=0,l=r.length;o<l;o++)for(var c=r[o],u=c._private.classes,d=!1,h=0;h<t.length;h++){var f=t[h],m=u.has(f),g=!1;e||n&&!m?(u.add(f),g=!0):(!e||n&&m)&&(u.delete(f),g=!0),!d&&g&&(s.push(c),d=!0)}return s.length>0&&this.spawn(s).updateStyle().emit("class"),r},removeClass:function(t){return this.toggleClass(t,!1)},flashClass:function(t,e){var r=this;if(e==null)e=250;else if(e===0)return r;return r.addClass(t),setTimeout(function(){r.removeClass(t)},e),r}};nw.className=nw.classNames=nw.classes;qt={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Ii,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};qt.variable="(?:[\\w-.]|(?:\\\\"+qt.metaChar+"))+";qt.className="(?:[\\w-]|(?:\\\\"+qt.metaChar+"))+";qt.value=qt.string+"|"+qt.number;qt.id=qt.variable;(function(){var a,t,e;for(a=qt.comparatorOp.split("|"),e=0;e<a.length;e++)t=a[e],qt.comparatorOp+="|@"+t;for(a=qt.comparatorOp.split("|"),e=0;e<a.length;e++)t=a[e],!(t.indexOf("!")>=0)&&t!=="="&&(qt.comparatorOp+="|\\!"+t)})();Cr=function(){return{checks:[]}},Je={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},vD=[{selector:":selected",matches:function(t){return t.selected()}},{selector:":unselected",matches:function(t){return!t.selected()}},{selector:":selectable",matches:function(t){return t.selectable()}},{selector:":unselectable",matches:function(t){return!t.selectable()}},{selector:":locked",matches:function(t){return t.locked()}},{selector:":unlocked",matches:function(t){return!t.locked()}},{selector:":visible",matches:function(t){return t.visible()}},{selector:":hidden",matches:function(t){return!t.visible()}},{selector:":transparent",matches:function(t){return t.transparent()}},{selector:":grabbed",matches:function(t){return t.grabbed()}},{selector:":free",matches:function(t){return!t.grabbed()}},{selector:":removed",matches:function(t){return t.removed()}},{selector:":inside",matches:function(t){return!t.removed()}},{selector:":grabbable",matches:function(t){return t.grabbable()}},{selector:":ungrabbable",matches:function(t){return!t.grabbable()}},{selector:":animated",matches:function(t){return t.animated()}},{selector:":unanimated",matches:function(t){return!t.animated()}},{selector:":parent",matches:function(t){return t.isParent()}},{selector:":childless",matches:function(t){return t.isChildless()}},{selector:":child",matches:function(t){return t.isChild()}},{selector:":orphan",matches:function(t){return t.isOrphan()}},{selector:":nonorphan",matches:function(t){return t.isChild()}},{selector:":compound",matches:function(t){return t.isNode()?t.isParent():t.source().isParent()||t.target().isParent()}},{selector:":loop",matches:function(t){return t.isLoop()}},{selector:":simple",matches:function(t){return t.isSimple()}},{selector:":active",matches:function(t){return t.active()}},{selector:":inactive",matches:function(t){return!t.active()}},{selector:":backgrounding",matches:function(t){return t.backgrounding()}},{selector:":nonbackgrounding",matches:function(t){return!t.backgrounding()}}].sort(function(a,t){return _ve(a.selector,t.selector)}),k0e=(function(){for(var a={},t,e=0;e<vD.length;e++)t=vD[e],a[t.selector]=t.matches;return a})(),D0e=function(t,e){return k0e[t](e)},P0e="("+vD.map(function(a){return a.selector}).join("|")+")",af=function(t){return t.replace(new RegExp("\\\\("+qt.metaChar+")","g"),function(e,r){return r})},lc=function(t,e,r){t[t.length-1]=r},yD=[{name:"group",query:!0,regex:"("+qt.group+")",populate:function(t,e,r){var n=Ci(r,1),s=n[0];e.checks.push({type:Je.GROUP,value:s==="*"?s:s+"s"})}},{name:"state",query:!0,regex:P0e,populate:function(t,e,r){var n=Ci(r,1),s=n[0];e.checks.push({type:Je.STATE,value:s})}},{name:"id",query:!0,regex:"\\#("+qt.id+")",populate:function(t,e,r){var n=Ci(r,1),s=n[0];e.checks.push({type:Je.ID,value:af(s)})}},{name:"className",query:!0,regex:"\\.("+qt.className+")",populate:function(t,e,r){var n=Ci(r,1),s=n[0];e.checks.push({type:Je.CLASS,value:af(s)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+qt.variable+")\\s*\\]",populate:function(t,e,r){var n=Ci(r,1),s=n[0];e.checks.push({type:Je.DATA_EXIST,field:af(s)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+qt.variable+")\\s*("+qt.comparatorOp+")\\s*("+qt.value+")\\s*\\]",populate:function(t,e,r){var n=Ci(r,3),s=n[0],o=n[1],l=n[2],c=new RegExp("^"+qt.string+"$").exec(l)!=null;c?l=l.substring(1,l.length-1):l=parseFloat(l),e.checks.push({type:Je.DATA_COMPARE,field:af(s),operator:o,value:l})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+qt.boolOp+")\\s*("+qt.variable+")\\s*\\]",populate:function(t,e,r){var n=Ci(r,2),s=n[0],o=n[1];e.checks.push({type:Je.DATA_BOOL,field:af(o),operator:s})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+qt.meta+")\\s*("+qt.comparatorOp+")\\s*("+qt.number+")\\s*\\]\\]",populate:function(t,e,r){var n=Ci(r,3),s=n[0],o=n[1],l=n[2];e.checks.push({type:Je.META_COMPARE,field:af(s),operator:o,value:parseFloat(l)})}},{name:"nextQuery",separator:!0,regex:qt.separator,populate:function(t,e){var r=t.currentSubject,n=t.edgeCount,s=t.compoundCount,o=t[t.length-1];r!=null&&(o.subject=r,t.currentSubject=null),o.edgeCount=n,o.compoundCount=s,t.edgeCount=0,t.compoundCount=0;var l=t[t.length++]=Cr();return l}},{name:"directedEdge",separator:!0,regex:qt.directedEdge,populate:function(t,e){if(t.currentSubject==null){var r=Cr(),n=e,s=Cr();return r.checks.push({type:Je.DIRECTED_EDGE,source:n,target:s}),lc(t,e,r),t.edgeCount++,s}else{var o=Cr(),l=e,c=Cr();return o.checks.push({type:Je.NODE_SOURCE,source:l,target:c}),lc(t,e,o),t.edgeCount++,c}}},{name:"undirectedEdge",separator:!0,regex:qt.undirectedEdge,populate:function(t,e){if(t.currentSubject==null){var r=Cr(),n=e,s=Cr();return r.checks.push({type:Je.UNDIRECTED_EDGE,nodes:[n,s]}),lc(t,e,r),t.edgeCount++,s}else{var o=Cr(),l=e,c=Cr();return o.checks.push({type:Je.NODE_NEIGHBOR,node:l,neighbor:c}),lc(t,e,o),c}}},{name:"child",separator:!0,regex:qt.child,populate:function(t,e){if(t.currentSubject==null){var r=Cr(),n=Cr(),s=t[t.length-1];return r.checks.push({type:Je.CHILD,parent:s,child:n}),lc(t,e,r),t.compoundCount++,n}else if(t.currentSubject===e){var o=Cr(),l=t[t.length-1],c=Cr(),u=Cr(),d=Cr(),h=Cr();return o.checks.push({type:Je.COMPOUND_SPLIT,left:l,right:c,subject:u}),u.checks=e.checks,e.checks=[{type:Je.TRUE}],h.checks.push({type:Je.TRUE}),c.checks.push({type:Je.PARENT,parent:h,child:d}),lc(t,l,o),t.currentSubject=u,t.compoundCount++,d}else{var f=Cr(),m=Cr(),g=[{type:Je.PARENT,parent:f,child:m}];return f.checks=e.checks,e.checks=g,t.compoundCount++,m}}},{name:"descendant",separator:!0,regex:qt.descendant,populate:function(t,e){if(t.currentSubject==null){var r=Cr(),n=Cr(),s=t[t.length-1];return r.checks.push({type:Je.DESCENDANT,ancestor:s,descendant:n}),lc(t,e,r),t.compoundCount++,n}else if(t.currentSubject===e){var o=Cr(),l=t[t.length-1],c=Cr(),u=Cr(),d=Cr(),h=Cr();return o.checks.push({type:Je.COMPOUND_SPLIT,left:l,right:c,subject:u}),u.checks=e.checks,e.checks=[{type:Je.TRUE}],h.checks.push({type:Je.TRUE}),c.checks.push({type:Je.ANCESTOR,ancestor:h,descendant:d}),lc(t,l,o),t.currentSubject=u,t.compoundCount++,d}else{var f=Cr(),m=Cr(),g=[{type:Je.ANCESTOR,ancestor:f,descendant:m}];return f.checks=e.checks,e.checks=g,t.compoundCount++,m}}},{name:"subject",modifier:!0,regex:qt.subject,populate:function(t,e){if(t.currentSubject!=null&&t.currentSubject!==e)return cr("Redefinition of subject in selector `"+t.toString()+"`"),!1;t.currentSubject=e;var r=t[t.length-1],n=r.checks[0],s=n==null?null:n.type;s===Je.DIRECTED_EDGE?n.type=Je.NODE_TARGET:s===Je.UNDIRECTED_EDGE&&(n.type=Je.NODE_NEIGHBOR,n.node=n.nodes[1],n.neighbor=n.nodes[0],n.nodes=null)}}];yD.forEach(function(a){return a.regexObj=new RegExp("^"+a.regex)});L0e=function(t){for(var e,r,n,s=0;s<yD.length;s++){var o=yD[s],l=o.name,c=t.match(o.regexObj);if(c!=null){r=c,e=o,n=l;var u=c[0];t=t.substring(u.length);break}}return{expr:e,match:r,name:n,remaining:t}},M0e=function(t){var e=t.match(/^\s+/);if(e){var r=e[0];t=t.substring(r.length)}return t},I0e=function(t){var e=this,r=e.inputText=t,n=e[0]=Cr();for(e.length=1,r=M0e(r);;){var s=L0e(r);if(s.expr==null)return cr("The selector `"+t+"`is invalid"),!1;var o=s.match.slice(1),l=s.expr.populate(e,n,o);if(l===!1)return!1;if(l!=null&&(n=l),r=s.remaining,r.match(/^\s*$/))break}var c=e[e.length-1];e.currentSubject!=null&&(c.subject=e.currentSubject),c.edgeCount=e.edgeCount,c.compoundCount=e.compoundCount;for(var u=0;u<e.length;u++){var d=e[u];if(d.compoundCount>0&&d.edgeCount>0)return cr("The selector `"+t+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(d.edgeCount>1)return cr("The selector `"+t+"` is invalid because it uses multiple edge selectors"),!1;d.edgeCount===1&&cr("The selector `"+t+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},A0e=function(){if(this.toStringCache!=null)return this.toStringCache;for(var t=function(d){return d==null?"":d},e=function(d){return at(d)?'"'+d+'"':t(d)},r=function(d){return" "+d+" "},n=function(d,h){var f=d.type,m=d.value;switch(f){case Je.GROUP:{var g=t(m);return g.substring(0,g.length-1)}case Je.DATA_COMPARE:{var y=d.field,v=d.operator;return"["+y+r(t(v))+e(m)+"]"}case Je.DATA_BOOL:{var E=d.operator,C=d.field;return"["+t(E)+C+"]"}case Je.DATA_EXIST:{var _=d.field;return"["+_+"]"}case Je.META_COMPARE:{var x=d.operator,P=d.field;return"[["+P+r(t(x))+e(m)+"]]"}case Je.STATE:return m;case Je.ID:return"#"+m;case Je.CLASS:return"."+m;case Je.PARENT:case Je.CHILD:return s(d.parent,h)+r(">")+s(d.child,h);case Je.ANCESTOR:case Je.DESCENDANT:return s(d.ancestor,h)+" "+s(d.descendant,h);case Je.COMPOUND_SPLIT:{var I=s(d.left,h),M=s(d.subject,h),O=s(d.right,h);return I+(I.length>0?" ":"")+M+O}case Je.TRUE:return""}},s=function(d,h){return d.checks.reduce(function(f,m,g){return f+(h===d&&g===0?"$":"")+n(m,h)},"")},o="",l=0;l<this.length;l++){var c=this[l];o+=s(c,c.subject),this.length>1&&l<this.length-1&&(o+=", ")}return this.toStringCache=o,o},O0e={parse:I0e,toString:A0e},qV=function(t,e,r){var n,s=at(t),o=We(t),l=at(r),c,u,d=!1,h=!1,f=!1;switch(e.indexOf("!")>=0&&(e=e.replace("!",""),h=!0),e.indexOf("@")>=0&&(e=e.replace("@",""),d=!0),(s||l||d)&&(c=!s&&!o?"":""+t,u=""+r),d&&(t=c=c.toLowerCase(),r=u=u.toLowerCase()),e){case"*=":n=c.indexOf(u)>=0;break;case"$=":n=c.indexOf(u,c.length-u.length)>=0;break;case"^=":n=c.indexOf(u)===0;break;case"=":n=t===r;break;case">":f=!0,n=t>r;break;case">=":f=!0,n=t>=r;break;case"<":f=!0,n=t<r;break;case"<=":f=!0,n=t<=r;break;default:n=!1;break}return h&&(t!=null||!f)&&(n=!n),n},F0e=function(t,e){switch(e){case"?":return!!t;case"!":return!t;case"^":return t===void 0}},R0e=function(t){return t!==void 0},WD=function(t,e){return t.data(e)},N0e=function(t,e){return t[e]()},si=[],Hr=function(t,e){return t.checks.every(function(r){return si[r.type](r,e)})};si[Je.GROUP]=function(a,t){var e=a.value;return e==="*"||e===t.group()};si[Je.STATE]=function(a,t){var e=a.value;return D0e(e,t)};si[Je.ID]=function(a,t){var e=a.value;return t.id()===e};si[Je.CLASS]=function(a,t){var e=a.value;return t.hasClass(e)};si[Je.META_COMPARE]=function(a,t){var e=a.field,r=a.operator,n=a.value;return qV(N0e(t,e),r,n)};si[Je.DATA_COMPARE]=function(a,t){var e=a.field,r=a.operator,n=a.value;return qV(WD(t,e),r,n)};si[Je.DATA_BOOL]=function(a,t){var e=a.field,r=a.operator;return F0e(WD(t,e),r)};si[Je.DATA_EXIST]=function(a,t){var e=a.field;return a.operator,R0e(WD(t,e))};si[Je.UNDIRECTED_EDGE]=function(a,t){var e=a.nodes[0],r=a.nodes[1],n=t.source(),s=t.target();return Hr(e,n)&&Hr(r,s)||Hr(r,n)&&Hr(e,s)};si[Je.NODE_NEIGHBOR]=function(a,t){return Hr(a.node,t)&&t.neighborhood().some(function(e){return e.isNode()&&Hr(a.neighbor,e)})};si[Je.DIRECTED_EDGE]=function(a,t){return Hr(a.source,t.source())&&Hr(a.target,t.target())};si[Je.NODE_SOURCE]=function(a,t){return Hr(a.source,t)&&t.outgoers().some(function(e){return e.isNode()&&Hr(a.target,e)})};si[Je.NODE_TARGET]=function(a,t){return Hr(a.target,t)&&t.incomers().some(function(e){return e.isNode()&&Hr(a.source,e)})};si[Je.CHILD]=function(a,t){return Hr(a.child,t)&&Hr(a.parent,t.parent())};si[Je.PARENT]=function(a,t){return Hr(a.parent,t)&&t.children().some(function(e){return Hr(a.child,e)})};si[Je.DESCENDANT]=function(a,t){return Hr(a.descendant,t)&&t.ancestors().some(function(e){return Hr(a.ancestor,e)})};si[Je.ANCESTOR]=function(a,t){return Hr(a.ancestor,t)&&t.descendants().some(function(e){return Hr(a.descendant,e)})};si[Je.COMPOUND_SPLIT]=function(a,t){return Hr(a.subject,t)&&Hr(a.left,t)&&Hr(a.right,t)};si[Je.TRUE]=function(){return!0};si[Je.COLLECTION]=function(a,t){var e=a.value;return e.has(t)};si[Je.FILTER]=function(a,t){var e=a.value;return e(t)};B0e=function(t){var e=this;if(e.length===1&&e[0].checks.length===1&&e[0].checks[0].type===Je.ID)return t.getElementById(e[0].checks[0].value).collection();var r=function(s){for(var o=0;o<e.length;o++){var l=e[o];if(Hr(l,s))return!0}return!1};return e.text()==null&&(r=function(){return!0}),t.filter(r)},$0e=function(t){for(var e=this,r=0;r<e.length;r++){var n=e[r];if(Hr(n,t))return!0}return!1},z0e={matches:$0e,filter:B0e},yc=function(t){this.inputText=t,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,t==null||at(t)&&t.match(/^\s*$/)||(Ra(t)?this.addQuery({checks:[{type:Je.COLLECTION,value:t.collection()}]}):ti(t)?this.addQuery({checks:[{type:Je.FILTER,value:t}]}):at(t)?this.parse(t)||(this.invalid=!0):qr("A selector must be created from a string; found "))},bc=yc.prototype;[O0e,z0e].forEach(function(a){return ut(bc,a)});bc.text=function(){return this.inputText};bc.size=function(){return this.length};bc.eq=function(a){return this[a]};bc.sameText=function(a){return!this.invalid&&!a.invalid&&this.text()===a.text()};bc.addQuery=function(a){this[this.length++]=a};bc.selector=bc.toString;fc={allAre:function(t){var e=new yc(t);return this.every(function(r){return e.matches(r)})},is:function(t){var e=new yc(t);return this.some(function(r){return e.matches(r)})},some:function(t,e){for(var r=0;r<this.length;r++){var n=e?t.apply(e,[this[r],r,this]):t(this[r],r,this);if(n)return!0}return!1},every:function(t,e){for(var r=0;r<this.length;r++){var n=e?t.apply(e,[this[r],r,this]):t(this[r],r,this);if(!n)return!1}return!0},same:function(t){if(this===t)return!0;t=this.cy().collection(t);var e=this.length,r=t.length;return e!==r?!1:e===1?this[0]===t[0]:this.every(function(n){return t.hasElementWithId(n.id())})},anySame:function(t){return t=this.cy().collection(t),this.some(function(e){return t.hasElementWithId(e.id())})},allAreNeighbors:function(t){t=this.cy().collection(t);var e=this.neighborhood();return t.every(function(r){return e.hasElementWithId(r.id())})},contains:function(t){t=this.cy().collection(t);var e=this;return t.every(function(r){return e.hasElementWithId(r.id())})}};fc.allAreNeighbours=fc.allAreNeighbors;fc.has=fc.contains;fc.equal=fc.equals=fc.same;us=function(t,e){return function(n,s,o,l){var c=n,u=this,d;if(c==null?d="":Ra(c)&&c.length===1&&(d=c.id()),u.length===1&&d){var h=u[0]._private,f=h.traversalCache=h.traversalCache||{},m=f[e]=f[e]||[],g=Yu(d),y=m[g];return y||(m[g]=t.call(u,n,s,o,l))}else return t.call(u,n,s,o,l)}},Tf={parent:function(t){var e=[];if(this.length===1){var r=this[0]._private.parent;if(r)return r}for(var n=0;n<this.length;n++){var s=this[n],o=s._private.parent;o&&e.push(o)}return this.spawn(e,!0).filter(t)},parents:function(t){for(var e=[],r=this.parent();r.nonempty();){for(var n=0;n<r.length;n++){var s=r[n];e.push(s)}r=r.parent()}return this.spawn(e,!0).filter(t)},commonAncestors:function(t){for(var e,r=0;r<this.length;r++){var n=this[r],s=n.parents();e=e||s,e=e.intersect(s)}return e.filter(t)},orphans:function(t){return this.stdFilter(function(e){return e.isOrphan()}).filter(t)},nonorphans:function(t){return this.stdFilter(function(e){return e.isChild()}).filter(t)},children:us(function(a){for(var t=[],e=0;e<this.length;e++)for(var r=this[e],n=r._private.children,s=0;s<n.length;s++)t.push(n[s]);return this.spawn(t,!0).filter(a)},"children"),siblings:function(t){return this.parent().children().not(this).filter(t)},isParent:function(){var t=this[0];if(t)return t.isNode()&&t._private.children.length!==0},isChildless:function(){var t=this[0];if(t)return t.isNode()&&t._private.children.length===0},isChild:function(){var t=this[0];if(t)return t.isNode()&&t._private.parent!=null},isOrphan:function(){var t=this[0];if(t)return t.isNode()&&t._private.parent==null},descendants:function(t){var e=[];function r(n){for(var s=0;s<n.length;s++){var o=n[s];e.push(o),o.children().nonempty()&&r(o.children())}}return r(this.children()),this.spawn(e,!0).filter(t)}};Tf.forEachDown=function(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return UD(this,a,t,ZV)};Tf.forEachUp=function(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return UD(this,a,t,KV)};Tf.forEachUpAndDown=function(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return UD(this,a,t,H0e)};Tf.ancestors=Tf.parents;Qg=XV={data:lr.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:lr.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:lr.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:lr.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:lr.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:lr.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var t=this[0];if(t)return t._private.data.id}};Qg.attr=Qg.data;Qg.removeAttr=Qg.removeData;G0e=XV,Fw={};ut(Fw,{degree:J1(function(a,t){return t.source().same(t.target())?2:1}),indegree:J1(function(a,t){return t.target().same(a)?1:0}),outdegree:J1(function(a,t){return t.source().same(a)?1:0})});ut(Fw,{minDegree:sf("degree",function(a,t){return a<t}),maxDegree:sf("degree",function(a,t){return a>t}),minIndegree:sf("indegree",function(a,t){return a<t}),maxIndegree:sf("indegree",function(a,t){return a>t}),minOutdegree:sf("outdegree",function(a,t){return a<t}),maxOutdegree:sf("outdegree",function(a,t){return a>t})});ut(Fw,{totalDegree:function(t){for(var e=0,r=this.nodes(),n=0;n<r.length;n++)e+=r[n].degree(t);return e}});QV=function(t,e,r){for(var n=0;n<t.length;n++){var s=t[n];if(!s.locked()){var o=s._private.position,l={x:e.x!=null?e.x-o.x:0,y:e.y!=null?e.y-o.y:0};s.isParent()&&!(l.x===0&&l.y===0)&&s.children().shift(l,r),s.dirtyBoundingBoxCache()}}},gG={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(t){t.updateCompoundBounds()},beforeSet:function(t,e){QV(t,e,!1)},onSet:function(t){t.dirtyCompoundBoundsCache()},canSet:function(t){return!t.locked()}};Ns=JV={position:lr.data(gG),silentPosition:lr.data(ut({},gG,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(t,e){QV(t,e,!0)},onSet:function(t){t.dirtyCompoundBoundsCache()}})),positions:function(t,e){if(Zt(t))e?this.silentPosition(t):this.position(t);else if(ti(t)){var r=t,n=this.cy();n.startBatch();for(var s=0;s<this.length;s++){var o=this[s],l=void 0;(l=r(o,s))&&(e?o.silentPosition(l):o.position(l))}n.endBatch()}return this},silentPositions:function(t){return this.positions(t,!0)},shift:function(t,e,r){var n;if(Zt(t)?(n={x:We(t.x)?t.x:0,y:We(t.y)?t.y:0},r=e):at(t)&&We(e)&&(n={x:0,y:0},n[t]=e),n!=null){var s=this.cy();s.startBatch();for(var o=0;o<this.length;o++){var l=this[o];if(!(s.hasCompoundNodes()&&l.isChild()&&l.ancestors().anySame(this))){var c=l.position(),u={x:c.x+n.x,y:c.y+n.y};r?l.silentPosition(u):l.position(u)}}s.endBatch()}return this},silentShift:function(t,e){return Zt(t)?this.shift(t,!0):at(t)&&We(e)&&this.shift(t,e,!0),this},renderedPosition:function(t,e){var r=this[0],n=this.cy(),s=n.zoom(),o=n.pan(),l=Zt(t)?t:void 0,c=l!==void 0||e!==void 0&&at(t);if(r&&r.isNode())if(c)for(var u=0;u<this.length;u++){var d=this[u];e!==void 0?d.position(t,(e-o[t])/s):l!==void 0&&d.position(kV(l,s,o))}else{var h=r.position();return l=Pw(h,s,o),t===void 0?l:l[t]}else if(!c)return;return this},relativePosition:function(t,e){var r=this[0],n=this.cy(),s=Zt(t)?t:void 0,o=s!==void 0||e!==void 0&&at(t),l=n.hasCompoundNodes();if(r&&r.isNode())if(o)for(var c=0;c<this.length;c++){var u=this[c],d=l?u.parent():null,h=d&&d.length>0,f=h;h&&(d=d[0]);var m=f?d.position():{x:0,y:0};e!==void 0?u.position(t,e+m[t]):s!==void 0&&u.position({x:s.x+m.x,y:s.y+m.y})}else{var g=r.position(),y=l?r.parent():null,v=y&&y.length>0,E=v;v&&(y=y[0]);var C=E?y.position():{x:0,y:0};return s={x:g.x-C.x,y:g.y-C.y},t===void 0?s:s[t]}else if(!o)return;return this}};Ns.modelPosition=Ns.point=Ns.position;Ns.modelPositions=Ns.points=Ns.positions;Ns.renderedPoint=Ns.renderedPosition;Ns.relativePoint=Ns.relativePosition;V0e=JV;bf=_c={};_c.renderedBoundingBox=function(a){var t=this.boundingBox(a),e=this.cy(),r=e.zoom(),n=e.pan(),s=t.x1*r+n.x,o=t.x2*r+n.x,l=t.y1*r+n.y,c=t.y2*r+n.y;return{x1:s,x2:o,y1:l,y2:c,w:o-s,h:c-l}};_c.dirtyCompoundBoundsCache=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.cy();return!t.styleEnabled()||!t.hasCompoundNodes()?this:(this.forEachUp(function(e){if(e.isParent()){var r=e._private;r.compoundBoundsClean=!1,r.bbCache=null,a||e.emitAndNotify("bounds")}}),this)};_c.updateCompoundBounds=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;if(!a&&t.batching())return this;function e(o){if(!o.isParent())return;var l=o._private,c=o.children(),u=o.pstyle("compound-sizing-wrt-labels").value==="include",d={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},h=c.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),f=l.position;(h.w===0||h.h===0)&&(h={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},h.x1=f.x-h.w/2,h.x2=f.x+h.w/2,h.y1=f.y-h.h/2,h.y2=f.y+h.h/2);function m(R,F,$){var k=0,N=0,G=F+$;return R>0&&G>0&&(k=F/G*R,N=$/G*R),{biasDiff:k,biasComplementDiff:N}}function g(R,F,$,k){if($.units==="%")switch(k){case"width":return R>0?$.pfValue*R:0;case"height":return F>0?$.pfValue*F:0;case"average":return R>0&&F>0?$.pfValue*(R+F)/2:0;case"min":return R>0&&F>0?R>F?$.pfValue*F:$.pfValue*R:0;case"max":return R>0&&F>0?R>F?$.pfValue*R:$.pfValue*F:0;default:return 0}else return $.units==="px"?$.pfValue:0}var y=d.width.left.value;d.width.left.units==="px"&&d.width.val>0&&(y=y*100/d.width.val);var v=d.width.right.value;d.width.right.units==="px"&&d.width.val>0&&(v=v*100/d.width.val);var E=d.height.top.value;d.height.top.units==="px"&&d.height.val>0&&(E=E*100/d.height.val);var C=d.height.bottom.value;d.height.bottom.units==="px"&&d.height.val>0&&(C=C*100/d.height.val);var _=m(d.width.val-h.w,y,v),x=_.biasDiff,P=_.biasComplementDiff,I=m(d.height.val-h.h,E,C),M=I.biasDiff,O=I.biasComplementDiff;l.autoPadding=g(h.w,h.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),l.autoWidth=Math.max(h.w,d.width.val),f.x=(-x+h.x1+h.x2+P)/2,l.autoHeight=Math.max(h.h,d.height.val),f.y=(-M+h.y1+h.y2+O)/2}for(var r=0;r<this.length;r++){var n=this[r],s=n._private;(!s.compoundBoundsClean||a)&&(e(n),t.batching()||(s.compoundBoundsClean=!0))}return this};cs=function(t){return t===1/0||t===-1/0?0:t},Rs=function(t,e,r,n,s){n-e===0||s-r===0||e==null||r==null||n==null||s==null||(t.x1=e<t.x1?e:t.x1,t.x2=n>t.x2?n:t.x2,t.y1=r<t.y1?r:t.y1,t.y2=s>t.y2?s:t.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1)},cc=function(t,e){return e==null?t:Rs(t,e.x1,e.y1,e.x2,e.y2)},Rg=function(t,e,r){return ha(t,e,r)},q0=function(t,e,r){if(!e.cy().headless()){var n=e._private,s=n.rstyle,o=s.arrowWidth/2,l=e.pstyle(r+"-arrow-shape").value,c,u;if(l!=="none"){r==="source"?(c=s.srcX,u=s.srcY):r==="target"?(c=s.tgtX,u=s.tgtY):(c=s.midX,u=s.midY);var d=n.arrowBounds=n.arrowBounds||{},h=d[r]=d[r]||{};h.x1=c-o,h.y1=u-o,h.x2=c+o,h.y2=u+o,h.w=h.x2-h.x1,h.h=h.y2-h.y1,rw(h,1),Rs(t,h.x1,h.y1,h.x2,h.y2)}}},Q1=function(t,e,r){if(!e.cy().headless()){var n;r?n=r+"-":n="";var s=e._private,o=s.rstyle,l=e.pstyle(n+"label").strValue;if(l){var c=e.pstyle("text-halign"),u=e.pstyle("text-valign"),d=Rg(o,"labelWidth",r),h=Rg(o,"labelHeight",r),f=Rg(o,"labelX",r),m=Rg(o,"labelY",r),g=e.pstyle(n+"text-margin-x").pfValue,y=e.pstyle(n+"text-margin-y").pfValue,v=e.isEdge(),E=e.pstyle(n+"text-rotation"),C=e.pstyle("text-outline-width").pfValue,_=e.pstyle("text-border-width").pfValue,x=_/2,P=e.pstyle("text-background-padding").pfValue,I=2,M=h,O=d,R=O/2,F=M/2,$,k,N,G;if(v)$=f-R,k=f+R,N=m-F,G=m+F;else{switch(c.value){case"left":$=f-O,k=f;break;case"center":$=f-R,k=f+R;break;case"right":$=f,k=f+O;break}switch(u.value){case"top":N=m-M,G=m;break;case"center":N=m-F,G=m+F;break;case"bottom":N=m,G=m+M;break}}var W=g-Math.max(C,x)-P-I,Y=g+Math.max(C,x)+P+I,U=y-Math.max(C,x)-P-I,Z=y+Math.max(C,x)+P+I;$+=W,k+=Y,N+=U,G+=Z;var q=r||"main",X=s.labelBounds,ie=X[q]=X[q]||{};ie.x1=$,ie.y1=N,ie.x2=k,ie.y2=G,ie.w=k-$,ie.h=G-N,ie.leftPad=W,ie.rightPad=Y,ie.topPad=U,ie.botPad=Z;var j=v&&E.strValue==="autorotate",K=E.pfValue!=null&&E.pfValue!==0;if(j||K){var se=j?Rg(s.rstyle,"labelAngle",r):E.pfValue,ne=Math.cos(se),ge=Math.sin(se),ve=($+k)/2,Se=(N+G)/2;if(!v){switch(c.value){case"left":ve=k;break;case"right":ve=$;break}switch(u.value){case"top":Se=G;break;case"bottom":Se=N;break}}var Te=function(ce,Ee){return ce=ce-ve,Ee=Ee-Se,{x:ce*ne-Ee*ge+ve,y:ce*ge+Ee*ne+Se}},me=Te($,N),pe=Te($,G),B=Te(k,N),oe=Te(k,G);$=Math.min(me.x,pe.x,B.x,oe.x),k=Math.max(me.x,pe.x,B.x,oe.x),N=Math.min(me.y,pe.y,B.y,oe.y),G=Math.max(me.y,pe.y,B.y,oe.y)}var he=q+"Rot",te=X[he]=X[he]||{};te.x1=$,te.y1=N,te.x2=k,te.y2=G,te.w=k-$,te.h=G-N,Rs(t,$,N,k,G),Rs(s.labelBounds.all,$,N,k,G)}return t}},vG=function(t,e){if(!e.cy().headless()){var r=e.pstyle("outline-opacity").value,n=e.pstyle("outline-width").value,s=e.pstyle("outline-offset").value,o=n+s;e5(t,e,r,o,"outside",o/2)}},e5=function(t,e,r,n,s,o){if(!(r===0||n<=0||s==="inside")){var l=e.cy(),c=e.pstyle("shape").value,u=l.renderer().nodeShapes[c],d=e.position(),h=d.x,f=d.y,m=e.width(),g=e.height();if(u.hasMiterBounds){s==="center"&&(n/=2);var y=u.miterBounds(h,f,m,g,n);cc(t,y)}else o!=null&&o>0&&iw(t,[o,o,o,o])}},W0e=function(t,e){if(!e.cy().headless()){var r=e.pstyle("border-opacity").value,n=e.pstyle("border-width").pfValue,s=e.pstyle("border-position").value;e5(t,e,r,n,s)}},U0e=function(t,e){var r=t._private.cy,n=r.styleEnabled(),s=r.headless(),o=Un(),l=t._private,c=t.isNode(),u=t.isEdge(),d,h,f,m,g,y,v=l.rstyle,E=c&&n?t.pstyle("bounds-expansion").pfValue:[0],C=function(re){return re.pstyle("display").value!=="none"},_=!n||C(t)&&(!u||C(t.source())&&C(t.target()));if(_){var x=0,P=0;n&&e.includeOverlays&&(x=t.pstyle("overlay-opacity").value,x!==0&&(P=t.pstyle("overlay-padding").value));var I=0,M=0;n&&e.includeUnderlays&&(I=t.pstyle("underlay-opacity").value,I!==0&&(M=t.pstyle("underlay-padding").value));var O=Math.max(P,M),R=0,F=0;if(n&&(R=t.pstyle("width").pfValue,F=R/2),c&&e.includeNodes){var $=t.position();g=$.x,y=$.y;var k=t.outerWidth(),N=k/2,G=t.outerHeight(),W=G/2;d=g-N,h=g+N,f=y-W,m=y+W,Rs(o,d,f,h,m),n&&vG(o,t),n&&e.includeOutlines&&!s&&vG(o,t),n&&W0e(o,t)}else if(u&&e.includeEdges)if(n&&!s){var Y=t.pstyle("curve-style").strValue;if(d=Math.min(v.srcX,v.midX,v.tgtX),h=Math.max(v.srcX,v.midX,v.tgtX),f=Math.min(v.srcY,v.midY,v.tgtY),m=Math.max(v.srcY,v.midY,v.tgtY),d-=F,h+=F,f-=F,m+=F,Rs(o,d,f,h,m),Y==="haystack"){var U=v.haystackPts;if(U&&U.length===2){if(d=U[0].x,f=U[0].y,h=U[1].x,m=U[1].y,d>h){var Z=d;d=h,h=Z}if(f>m){var q=f;f=m,m=q}Rs(o,d-F,f-F,h+F,m+F)}}else if(Y==="bezier"||Y==="unbundled-bezier"||uc(Y,"segments")||uc(Y,"taxi")){var X;switch(Y){case"bezier":case"unbundled-bezier":X=v.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":X=v.linePts;break}if(X!=null)for(var ie=0;ie<X.length;ie++){var j=X[ie];d=j.x-F,h=j.x+F,f=j.y-F,m=j.y+F,Rs(o,d,f,h,m)}}}else{var K=t.source(),se=K.position(),ne=t.target(),ge=ne.position();if(d=se.x,h=ge.x,f=se.y,m=ge.y,d>h){var ve=d;d=h,h=ve}if(f>m){var Se=f;f=m,m=Se}d-=F,h+=F,f-=F,m+=F,Rs(o,d,f,h,m)}if(n&&e.includeEdges&&u&&(q0(o,t,"mid-source"),q0(o,t,"mid-target"),q0(o,t,"source"),q0(o,t,"target")),n){var Te=t.pstyle("ghost").value==="yes";if(Te){var me=t.pstyle("ghost-offset-x").pfValue,pe=t.pstyle("ghost-offset-y").pfValue;Rs(o,o.x1+me,o.y1+pe,o.x2+me,o.y2+pe)}}var B=l.bodyBounds=l.bodyBounds||{};rH(B,o),iw(B,E),rw(B,1),n&&(d=o.x1,h=o.x2,f=o.y1,m=o.y2,Rs(o,d-O,f-O,h+O,m+O));var oe=l.overlayBounds=l.overlayBounds||{};rH(oe,o),iw(oe,E),rw(oe,1);var he=l.labelBounds=l.labelBounds||{};he.all!=null?xye(he.all):he.all=Un(),n&&e.includeLabels&&(e.includeMainLabels&&Q1(o,t,null),u&&(e.includeSourceLabels&&Q1(o,t,"source"),e.includeTargetLabels&&Q1(o,t,"target")))}return o.x1=cs(o.x1),o.y1=cs(o.y1),o.x2=cs(o.x2),o.y2=cs(o.y2),o.w=cs(o.x2-o.x1),o.h=cs(o.y2-o.y1),o.w>0&&o.h>0&&_&&(iw(o,E),rw(o,1)),o},t5=function(t){var e=0,r=function(o){return(o?1:0)<<e++},n=0;return n+=r(t.incudeNodes),n+=r(t.includeEdges),n+=r(t.includeLabels),n+=r(t.includeMainLabels),n+=r(t.includeSourceLabels),n+=r(t.includeTargetLabels),n+=r(t.includeOverlays),n+=r(t.includeOutlines),n},r5=function(t){var e=function(l){return Math.round(l)};if(t.isEdge()){var r=t.source().position(),n=t.target().position();return Kz([e(r.x),e(r.y),e(n.x),e(n.y)])}else{var s=t.position();return Kz([e(s.x),e(s.y)])}},yG=function(t,e){var r=t._private,n,s=t.isEdge(),o=e==null?bG:t5(e),l=o===bG;if(r.bbCache==null?(n=U0e(t,ev),r.bbCache=n,r.bbCachePosKey=r5(t)):n=r.bbCache,!l){var c=t.isNode();n=Un(),(e.includeNodes&&c||e.includeEdges&&!c)&&(e.includeOverlays?cc(n,r.overlayBounds):cc(n,r.bodyBounds)),e.includeLabels&&(e.includeMainLabels&&(!s||e.includeSourceLabels&&e.includeTargetLabels)?cc(n,r.labelBounds.all):(e.includeMainLabels&&cc(n,r.labelBounds.mainRot),e.includeSourceLabels&&cc(n,r.labelBounds.sourceRot),e.includeTargetLabels&&cc(n,r.labelBounds.targetRot))),n.w=n.x2-n.x1,n.h=n.y2-n.y1}return n},ev={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},bG=t5(ev),wG=on(ev);_c.boundingBox=function(a){var t,e=a===void 0||a.useCache===void 0||a.useCache===!0,r=wf(function(d){var h=d._private;return h.bbCache==null||h.styleDirty||h.bbCachePosKey!==r5(d)},function(d){return d.id()});if(e&&this.length===1&&!r(this[0]))a===void 0?a=ev:a=wG(a),t=yG(this[0],a);else{t=Un(),a=a||ev;var n=wG(a),s=this,o=s.cy(),l=o.styleEnabled();this.edges().forEach(r),this.nodes().forEach(r),l&&this.recalculateRenderedStyle(e),this.updateCompoundBounds(!e);for(var c=0;c<s.length;c++){var u=s[c];r(u)&&u.dirtyBoundingBoxCache(),cc(t,yG(u,n))}}return t.x1=cs(t.x1),t.y1=cs(t.y1),t.x2=cs(t.x2),t.y2=cs(t.y2),t.w=cs(t.x2-t.x1),t.h=cs(t.y2-t.y1),t};_c.dirtyBoundingBoxCache=function(){for(var a=0;a<this.length;a++){var t=this[a]._private;t.bbCache=null,t.bbCachePosKey=null,t.bodyBounds=null,t.overlayBounds=null,t.labelBounds.all=null,t.labelBounds.source=null,t.labelBounds.target=null,t.labelBounds.main=null,t.labelBounds.sourceRot=null,t.labelBounds.targetRot=null,t.labelBounds.mainRot=null,t.arrowBounds.source=null,t.arrowBounds.target=null,t.arrowBounds["mid-source"]=null,t.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};_c.boundingBoxAt=function(a){var t=this.nodes(),e=this.cy(),r=e.hasCompoundNodes(),n=e.collection();if(r&&(n=t.filter(function(u){return u.isParent()}),t=t.not(n)),Zt(a)){var s=a;a=function(){return s}}var o=function(d,h){return d._private.bbAtOldPos=a(d,h)},l=function(d){return d._private.bbAtOldPos};e.startBatch(),t.forEach(o).silentPositions(a),r&&(n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),n.updateCompoundBounds(!0));var c=Sye(this.boundingBox({useCache:!1}));return t.silentPositions(l),r&&(n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),n.updateCompoundBounds(!0)),e.endBatch(),c};bf.boundingbox=bf.bb=bf.boundingBox;bf.renderedBoundingbox=bf.renderedBoundingBox;j0e=_c;Vg=dv={};i5=function(t){t.uppercaseName=Fz(t.name),t.autoName="auto"+t.uppercaseName,t.labelName="label"+t.uppercaseName,t.outerName="outer"+t.uppercaseName,t.uppercaseOuterName=Fz(t.outerName),Vg[t.name]=function(){var r=this[0],n=r._private,s=n.cy,o=s._private.styleEnabled;if(r)if(o){if(r.isParent())return r.updateCompoundBounds(),n[t.autoName]||0;var l=r.pstyle(t.name);switch(l.strValue){case"label":return r.recalculateRenderedStyle(),n.rstyle[t.labelName]||0;default:return l.pfValue}}else return 1},Vg["outer"+t.uppercaseName]=function(){var r=this[0],n=r._private,s=n.cy,o=s._private.styleEnabled;if(r)if(o){var l=r[t.name](),c=r.pstyle("border-position").value,u;c==="center"?u=r.pstyle("border-width").pfValue:c==="outside"?u=2*r.pstyle("border-width").pfValue:u=0;var d=2*r.padding();return l+u+d}else return 1},Vg["rendered"+t.uppercaseName]=function(){var r=this[0];if(r){var n=r[t.name]();return n*this.cy().zoom()}},Vg["rendered"+t.uppercaseOuterName]=function(){var r=this[0];if(r){var n=r[t.outerName]();return n*this.cy().zoom()}}};i5({name:"width"});i5({name:"height"});dv.padding=function(){var a=this[0],t=a._private;return a.isParent()?(a.updateCompoundBounds(),t.autoPadding!==void 0?t.autoPadding:a.pstyle("padding").pfValue):a.pstyle("padding").pfValue};dv.paddedHeight=function(){var a=this[0];return a.height()+2*a.padding()};dv.paddedWidth=function(){var a=this[0];return a.width()+2*a.padding()};Y0e=dv,q0e=function(t,e){if(t.isEdge()&&t.takesUpSpace())return e(t)},Z0e=function(t,e){if(t.isEdge()&&t.takesUpSpace()){var r=t.cy();return Pw(e(t),r.zoom(),r.pan())}},K0e=function(t,e){if(t.isEdge()&&t.takesUpSpace()){var r=t.cy(),n=r.pan(),s=r.zoom();return e(t).map(function(o){return Pw(o,s,n)})}},X0e=function(t){return t.renderer().getControlPoints(t)},J0e=function(t){return t.renderer().getSegmentPoints(t)},Q0e=function(t){return t.renderer().getSourceEndpoint(t)},ewe=function(t){return t.renderer().getTargetEndpoint(t)},twe=function(t){return t.renderer().getEdgeMidpoint(t)},EG={controlPoints:{get:X0e,mult:!0},segmentPoints:{get:J0e,mult:!0},sourceEndpoint:{get:Q0e},targetEndpoint:{get:ewe},midpoint:{get:twe}},rwe=function(t){return"rendered"+t[0].toUpperCase()+t.substr(1)},iwe=Object.keys(EG).reduce(function(a,t){var e=EG[t],r=rwe(t);return a[t]=function(){return q0e(this,e.get)},e.mult?a[r]=function(){return K0e(this,e.get)}:a[r]=function(){return Z0e(this,e.get)},a},{}),nwe=ut({},V0e,j0e,Y0e,iwe);n5=function(t,e){this.recycle(t,e)};n5.prototype={instanceString:function(){return"event"},recycle:function(t,e){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Ng,t!=null&&t.preventDefault?(this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?Z0:Ng):t!=null&&t.type?e=t:this.type=t,e!=null&&(this.originalEvent=e.originalEvent,this.type=e.type!=null?e.type:this.type,this.cy=e.cy,this.target=e.target,this.position=e.position,this.renderedPosition=e.renderedPosition,this.namespace=e.namespace,this.layout=e.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var r=this.position,n=this.cy.zoom(),s=this.cy.pan();this.renderedPosition={x:r.x*n+s.x,y:r.y*n+s.y}}this.timeStamp=t&&t.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Z0;var t=this.originalEvent;t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Z0;var t=this.originalEvent;t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Z0,this.stopPropagation()},isDefaultPrevented:Ng,isPropagationStopped:Ng,isImmediatePropagationStopped:Ng};a5=/^([^.]+)(\.(?:[^.]+))?$/,awe=".*",s5={qualifierCompare:function(t,e){return t===e},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(t){return t},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},TG=Object.keys(s5),swe={};wc=Rw.prototype,o5=function(t,e,r,n,s,o,l){ti(n)&&(s=n,n=null),l&&(o==null?o=l:o=ut({},o,l));for(var c=Pr(r)?r:r.split(/\s+/),u=0;u<c.length;u++){var d=c[u];if(!mc(d)){var h=d.match(a5);if(h){var f=h[1],m=h[2]?h[2]:null,g=e(t,d,f,m,n,s,o);if(g===!1)break}}}},CG=function(t,e){return t.addEventFields(t.context,e),new n5(e.type,e)},owe=function(t,e,r){if(fve(r)){e(t,r);return}else if(Zt(r)){e(t,CG(t,r));return}for(var n=Pr(r)?r:r.split(/\s+/),s=0;s<n.length;s++){var o=n[s];if(!mc(o)){var l=o.match(a5);if(l){var c=l[1],u=l[2]?l[2]:null,d=CG(t,{type:c,namespace:u,target:t.context});e(t,d)}}}};wc.on=wc.addListener=function(a,t,e,r,n){return o5(this,function(s,o,l,c,u,d,h){ti(d)&&s.listeners.push({event:o,callback:d,type:l,namespace:c,qualifier:u,conf:h})},a,t,e,r,n),this};wc.one=function(a,t,e,r){return this.on(a,t,e,r,{one:!0})};wc.removeListener=wc.off=function(a,t,e,r){var n=this;this.emitting!==0&&(this.listeners=Zve(this.listeners));for(var s=this.listeners,o=function(u){var d=s[u];o5(n,function(h,f,m,g,y,v){if((d.type===m||a==="*")&&(!g&&d.namespace!==".*"||d.namespace===g)&&(!y||h.qualifierCompare(d.qualifier,y))&&(!v||d.callback===v))return s.splice(u,1),!1},a,t,e,r)},l=s.length-1;l>=0;l--)o(l);return this};wc.removeAllListeners=function(){return this.removeListener("*")};wc.emit=wc.trigger=function(a,t,e){var r=this.listeners,n=r.length;return this.emitting++,Pr(t)||(t=[t]),owe(this,function(s,o){e!=null&&(r=[{event:o.event,type:o.type,namespace:o.namespace,callback:e}],n=r.length);for(var l=function(){var d=r[c];if(d.type===o.type&&(!d.namespace||d.namespace===o.namespace||d.namespace===awe)&&s.eventMatches(s.context,d,o)){var h=[o];t!=null&&Xve(h,t),s.beforeEmit(s.context,d,o),d.conf&&d.conf.one&&(s.listeners=s.listeners.filter(function(g){return g!==d}));var f=s.callbackContext(s.context,d,o),m=d.callback.apply(f,h);s.afterEmit(s.context,d,o),m===!1&&(o.stopPropagation(),o.preventDefault())}},c=0;c<n;c++)l();s.bubble(s.context)&&!o.isPropagationStopped()&&s.parent(s.context).emit(o,t)},a),this.emitting--,this};lwe={qualifierCompare:function(t,e){return t==null||e==null?t==null&&e==null:t.sameText(e)},eventMatches:function(t,e,r){var n=e.qualifier;return n!=null?t!==r.target&&av(r.target)&&n.matches(r.target):!0},addEventFields:function(t,e){e.cy=t.cy(),e.target=t},callbackContext:function(t,e,r){return e.qualifier!=null?r.target:t},beforeEmit:function(t,e){e.conf&&e.conf.once&&e.conf.onceCollection.removeListener(e.event,e.qualifier,e.callback)},bubble:function(){return!0},parent:function(t){return t.isChild()?t.parent():t.cy()}},K0=function(t){return at(t)?new yc(t):t},l5={createEmitter:function(){for(var t=0;t<this.length;t++){var e=this[t],r=e._private;r.emitter||(r.emitter=new Rw(lwe,e))}return this},emitter:function(){return this._private.emitter},on:function(t,e,r){for(var n=K0(e),s=0;s<this.length;s++){var o=this[s];o.emitter().on(t,n,r)}return this},removeListener:function(t,e,r){for(var n=K0(e),s=0;s<this.length;s++){var o=this[s];o.emitter().removeListener(t,n,r)}return this},removeAllListeners:function(){for(var t=0;t<this.length;t++){var e=this[t];e.emitter().removeAllListeners()}return this},one:function(t,e,r){for(var n=K0(e),s=0;s<this.length;s++){var o=this[s];o.emitter().one(t,n,r)}return this},once:function(t,e,r){for(var n=K0(e),s=0;s<this.length;s++){var o=this[s];o.emitter().on(t,n,r,{once:!0,onceCollection:this})}},emit:function(t,e){for(var r=0;r<this.length;r++){var n=this[r];n.emitter().emit(t,e)}return this},emitAndNotify:function(t,e){if(this.length!==0)return this.cy().notify(t,this),this.emit(t,e),this}};lr.eventAliasesOn(l5);c5={nodes:function(t){return this.filter(function(e){return e.isNode()}).filter(t)},edges:function(t){return this.filter(function(e){return e.isEdge()}).filter(t)},byGroup:function(){for(var t=this.spawn(),e=this.spawn(),r=0;r<this.length;r++){var n=this[r];n.isNode()?t.push(n):e.push(n)}return{nodes:t,edges:e}},filter:function(t,e){if(t===void 0)return this;if(at(t)||Ra(t))return new yc(t).filter(this);if(ti(t)){for(var r=this.spawn(),n=this,s=0;s<n.length;s++){var o=n[s],l=e?t.apply(e,[o,s,n]):t(o,s,n);l&&r.push(o)}return r}return this.spawn()},not:function(t){if(t){at(t)&&(t=this.filter(t));for(var e=this.spawn(),r=0;r<this.length;r++){var n=this[r],s=t.has(n);s||e.push(n)}return e}else return this},absoluteComplement:function(){var t=this.cy();return t.mutableElements().not(this)},intersect:function(t){if(at(t)){var e=t;return this.filter(e)}for(var r=this.spawn(),n=this,s=t,o=this.length<t.length,l=o?n:s,c=o?s:n,u=0;u<l.length;u++){var d=l[u];c.has(d)&&r.push(d)}return r},xor:function(t){var e=this._private.cy;at(t)&&(t=e.$(t));var r=this.spawn(),n=this,s=t,o=function(c,u){for(var d=0;d<c.length;d++){var h=c[d],f=h._private.data.id,m=u.hasElementWithId(f);m||r.push(h)}};return o(n,s),o(s,n),r},diff:function(t){var e=this._private.cy;at(t)&&(t=e.$(t));var r=this.spawn(),n=this.spawn(),s=this.spawn(),o=this,l=t,c=function(d,h,f){for(var m=0;m<d.length;m++){var g=d[m],y=g._private.data.id,v=h.hasElementWithId(y);v?s.merge(g):f.push(g)}};return c(o,l,r),c(l,o,n),{left:r,right:n,both:s}},add:function(t){var e=this._private.cy;if(!t)return this;if(at(t)){var r=t;t=e.mutableElements().filter(r)}for(var n=this.spawnSelf(),s=0;s<t.length;s++){var o=t[s],l=!this.has(o);l&&n.push(o)}return n},merge:function(t){var e=this._private,r=e.cy;if(!t)return this;if(t&&at(t)){var n=t;t=r.mutableElements().filter(n)}for(var s=e.map,o=0;o<t.length;o++){var l=t[o],c=l._private.data.id,u=!s.has(c);if(u){var d=this.length++;this[d]=l,s.set(c,{ele:l,index:d})}}return this},unmergeAt:function(t){var e=this[t],r=e.id(),n=this._private,s=n.map;this[t]=void 0,s.delete(r);var o=t===this.length-1;if(this.length>1&&!o){var l=this.length-1,c=this[l],u=c._private.data.id;this[l]=void 0,this[t]=c,s.set(u,{ele:c,index:t})}return this.length--,this},unmergeOne:function(t){t=t[0];var e=this._private,r=t._private.data.id,n=e.map,s=n.get(r);if(!s)return this;var o=s.index;return this.unmergeAt(o),this},unmerge:function(t){var e=this._private.cy;if(!t)return this;if(t&&at(t)){var r=t;t=e.mutableElements().filter(r)}for(var n=0;n<t.length;n++)this.unmergeOne(t[n]);return this},unmergeBy:function(t){for(var e=this.length-1;e>=0;e--){var r=this[e];t(r)&&this.unmergeAt(e)}return this},map:function(t,e){for(var r=[],n=this,s=0;s<n.length;s++){var o=n[s],l=e?t.apply(e,[o,s,n]):t(o,s,n);r.push(l)}return r},reduce:function(t,e){for(var r=e,n=this,s=0;s<n.length;s++)r=t(r,n[s],s,n);return r},max:function(t,e){for(var r=-1/0,n,s=this,o=0;o<s.length;o++){var l=s[o],c=e?t.apply(e,[l,o,s]):t(l,o,s);c>r&&(r=c,n=l)}return{value:r,ele:n}},min:function(t,e){for(var r=1/0,n,s=this,o=0;o<s.length;o++){var l=s[o],c=e?t.apply(e,[l,o,s]):t(l,o,s);c<r&&(r=c,n=l)}return{value:r,ele:n}}},Qt=c5;Qt.u=Qt["|"]=Qt["+"]=Qt.union=Qt.or=Qt.add;Qt["\\"]=Qt["!"]=Qt["-"]=Qt.difference=Qt.relativeComplement=Qt.subtract=Qt.not;Qt.n=Qt["&"]=Qt["."]=Qt.and=Qt.intersection=Qt.intersect;Qt["^"]=Qt["(+)"]=Qt["(-)"]=Qt.symmetricDifference=Qt.symdiff=Qt.xor;Qt.fnFilter=Qt.filterFn=Qt.stdFilter=Qt.filter;Qt.complement=Qt.abscomp=Qt.absoluteComplement;cwe={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var t=this[0];if(t)return t._private.group}},u5=function(t,e){var r=t.cy(),n=r.hasCompoundNodes();function s(d){var h=d.pstyle("z-compound-depth");return h.value==="auto"?n?d.zDepth():0:h.value==="bottom"?-1:h.value==="top"?OD:0}var o=s(t)-s(e);if(o!==0)return o;function l(d){var h=d.pstyle("z-index-compare");return h.value==="auto"&&d.isNode()?1:0}var c=l(t)-l(e);if(c!==0)return c;var u=t.pstyle("z-index").value-e.pstyle("z-index").value;return u!==0?u:t.poolIndex()-e.poolIndex()},bw={forEach:function(t,e){if(ti(t))for(var r=this.length,n=0;n<r;n++){var s=this[n],o=e?t.apply(e,[s,n,this]):t(s,n,this);if(o===!1)break}return this},toArray:function(){for(var t=[],e=0;e<this.length;e++)t.push(this[e]);return t},slice:function(t,e){var r=[],n=this.length;e==null&&(e=n),t==null&&(t=0),t<0&&(t=n+t),e<0&&(e=n+e);for(var s=t;s>=0&&s<e&&s<n;s++)r.push(this[s]);return this.spawn(r)},size:function(){return this.length},eq:function(t){return this[t]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(t){if(!ti(t))return this;var e=this.toArray().sort(t);return this.spawn(e)},sortByZIndex:function(){return this.sort(u5)},zDepth:function(){var t=this[0];if(t){var e=t._private,r=e.group;if(r==="nodes"){var n=e.data.parent?t.parents().size():0;return t.isParent()?n:OD-1}else{var s=e.source,o=e.target,l=s.zDepth(),c=o.zDepth();return Math.max(l,c,0)}}}};bw.each=bw.forEach;uwe=function(){var t="undefined",e=(typeof Symbol=="undefined"?"undefined":Ai(Symbol))!=t&&Ai(Symbol.iterator)!=t;e&&(bw[Symbol.iterator]=function(){var r=this,n={value:void 0,done:!1},s=0,o=this.length;return lV({next:function(){return s<o?n.value=r[s++]:(n.value=void 0,n.done=!0),n}},Symbol.iterator,function(){return this})})};uwe();dwe=on({nodeDimensionsIncludeLabels:!1}),aw={layoutDimensions:function(t){t=dwe(t);var e;if(!this.takesUpSpace())e={w:0,h:0};else if(t.nodeDimensionsIncludeLabels){var r=this.boundingBox();e={w:r.w,h:r.h}}else e={w:this.outerWidth(),h:this.outerHeight()};return(e.w===0||e.h===0)&&(e.w=e.h=1),e},layoutPositions:function(t,e,r){var n=this.nodes().filter(function(P){return!P.isParent()}),s=this.cy(),o=e.eles,l=function(I){return I.id()},c=wf(r,l);t.emit({type:"layoutstart",layout:t}),t.animations=[];var u=function(I,M,O){var R={x:M.x1+M.w/2,y:M.y1+M.h/2},F={x:(O.x-R.x)*I,y:(O.y-R.y)*I};return{x:R.x+F.x,y:R.y+F.y}},d=e.spacingFactor&&e.spacingFactor!==1,h=function(){if(!d)return null;for(var I=Un(),M=0;M<n.length;M++){var O=n[M],R=c(O,M);DV(I,R.x,R.y)}return I},f=h(),m=wf(function(P,I){var M=c(P,I);if(d){var O=Math.abs(e.spacingFactor);M=u(O,f,M)}return e.transform!=null&&(M=e.transform(P,M)),M},l);if(e.animate){for(var g=0;g<n.length;g++){var y=n[g],v=m(y,g),E=e.animateFilter==null||e.animateFilter(y,g);if(E){var C=y.animation({position:v,duration:e.animationDuration,easing:e.animationEasing});t.animations.push(C)}else y.position(v)}if(e.fit){var _=s.animation({fit:{boundingBox:o.boundingBoxAt(m),padding:e.padding},duration:e.animationDuration,easing:e.animationEasing});t.animations.push(_)}else if(e.zoom!==void 0&&e.pan!==void 0){var x=s.animation({zoom:e.zoom,pan:e.pan,duration:e.animationDuration,easing:e.animationEasing});t.animations.push(x)}t.animations.forEach(function(P){return P.play()}),t.one("layoutready",e.ready),t.emit({type:"layoutready",layout:t}),_f.all(t.animations.map(function(P){return P.promise()})).then(function(){t.one("layoutstop",e.stop),t.emit({type:"layoutstop",layout:t})})}else n.positions(m),e.fit&&s.fit(e.eles,e.padding),e.zoom!=null&&s.zoom(e.zoom),e.pan&&s.pan(e.pan),t.one("layoutready",e.ready),t.emit({type:"layoutready",layout:t}),t.one("layoutstop",e.stop),t.emit({type:"layoutstop",layout:t});return this},layout:function(t){var e=this.cy();return e.makeLayout(ut({},t,{eles:this}))}};aw.createLayout=aw.makeLayout=aw.layout;an={recalculateRenderedStyle:function(t){var e=this.cy(),r=e.renderer(),n=e.styleEnabled();return r&&n&&r.recalculateRenderedStyle(this,t),this},dirtyStyleCache:function(){var t=this.cy(),e=function(s){return s._private.styleCache=null};if(t.hasCompoundNodes()){var r;r=this.spawnSelf().merge(this.descendants()).merge(this.parents()),r.merge(r.connectedEdges()),r.forEach(e)}else this.forEach(function(n){e(n),n.connectedEdges().forEach(e)});return this},updateStyle:function(t){var e=this._private.cy;if(!e.styleEnabled())return this;if(e.batching()){var r=e._private.batchStyleEles;return r.merge(this),this}var n=e.hasCompoundNodes(),s=this;t=!!(t||t===void 0),n&&(s=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=s;return t?o.emitAndNotify("style"):o.emit("style"),s.forEach(function(l){return l._private.styleDirty=!0}),this},cleanStyle:function(){var t=this.cy();if(t.styleEnabled())for(var e=0;e<this.length;e++){var r=this[e];r._private.styleDirty&&(r._private.styleDirty=!1,t.style().apply(r))}},parsedStyle:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this[0],n=r.cy();if(n.styleEnabled()&&r){r._private.styleDirty&&(r._private.styleDirty=!1,n.style().apply(r));var s=r._private.style[t];return s!=null?s:e?n.style().getDefaultProperty(t):null}},numericStyle:function(t){var e=this[0];if(e.cy().styleEnabled()&&e){var r=e.pstyle(t);return r.pfValue!==void 0?r.pfValue:r.value}},numericStyleUnits:function(t){var e=this[0];if(e.cy().styleEnabled()&&e)return e.pstyle(t).units},renderedStyle:function(t){var e=this.cy();if(!e.styleEnabled())return this;var r=this[0];if(r)return e.style().getRenderedStyle(r,t)},style:function(t,e){var r=this.cy();if(!r.styleEnabled())return this;var n=!1,s=r.style();if(Zt(t)){var o=t;s.applyBypass(this,o,n),this.emitAndNotify("style")}else if(at(t))if(e===void 0){var l=this[0];return l?s.getStylePropertyValue(l,t):void 0}else s.applyBypass(this,t,e,n),this.emitAndNotify("style");else if(t===void 0){var c=this[0];return c?s.getRawStyle(c):void 0}return this},removeStyle:function(t){var e=this.cy();if(!e.styleEnabled())return this;var r=!1,n=e.style(),s=this;if(t===void 0)for(var o=0;o<s.length;o++){var l=s[o];n.removeAllBypasses(l,r)}else{t=t.split(/\s+/);for(var c=0;c<s.length;c++){var u=s[c];n.removeBypasses(u,t,r)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var t=this.cy();if(!t.styleEnabled())return 1;var e=t.hasCompoundNodes(),r=this[0];if(r){var n=r._private,s=r.pstyle("opacity").value;if(!e)return s;var o=n.data.parent?r.parents():null;if(o)for(var l=0;l<o.length;l++){var c=o[l],u=c.pstyle("opacity").value;s=u*s}return s}},transparent:function(){var t=this.cy();if(!t.styleEnabled())return!1;var e=this[0],r=e.cy().hasCompoundNodes();if(e)return r?e.effectiveOpacity()===0:e.pstyle("opacity").value===0},backgrounding:function(){var t=this.cy();if(!t.styleEnabled())return!1;var e=this[0];return!!e._private.backgrounding}};Sf=Nw("eleTakesUpSpace",function(a){return a.pstyle("display").value==="element"&&a.width()!==0&&(a.isNode()?a.height()!==0:!0)});an.takesUpSpace=Bw("takesUpSpace",jD({ok:Sf}));hwe=Nw("eleInteractive",function(a){return a.pstyle("events").value==="yes"&&a.pstyle("visibility").value==="visible"&&Sf(a)}),fwe=Nw("parentInteractive",function(a){return a.pstyle("visibility").value==="visible"&&Sf(a)});an.interactive=Bw("interactive",jD({ok:hwe,parentOk:fwe,edgeOkViaNode:Sf}));an.noninteractive=function(){var a=this[0];if(a)return!a.interactive()};pwe=Nw("eleVisible",function(a){return a.pstyle("visibility").value==="visible"&&a.pstyle("opacity").pfValue!==0&&Sf(a)}),mwe=Sf;an.visible=Bw("visible",jD({ok:pwe,edgeOkViaNode:mwe}));an.hidden=function(){var a=this[0];if(a)return!a.visible()};an.isBundledBezier=Bw("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});an.bypass=an.css=an.style;an.renderedCss=an.renderedStyle;an.removeBypass=an.removeCss=an.removeStyle;an.pstyle=an.parsedStyle;pc={};xf({field:"locked",overrideField:function(t){return t.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});xf({field:"grabbable",overrideField:function(t){return t.cy().autoungrabify()||t.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});xf({field:"selected",ableField:"selectable",overrideAble:function(t){return t.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});xf({field:"selectable",overrideField:function(t){return t.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});pc.deselect=pc.unselect;pc.grabbed=function(){var a=this[0];if(a)return a._private.grabbed};xf({field:"active",on:"activate",off:"unactivate"});xf({field:"pannable",on:"panify",off:"unpanify"});pc.inactive=function(){var a=this[0];if(a)return!a._private.active};Tn={},SG=function(t){return function(r){for(var n=this,s=[],o=0;o<n.length;o++){var l=n[o];if(l.isNode()){for(var c=!1,u=l.connectedEdges(),d=0;d<u.length;d++){var h=u[d],f=h.source(),m=h.target();if(t.noIncomingEdges&&m===l&&f!==l||t.noOutgoingEdges&&f===l&&m!==l){c=!0;break}}c||s.push(l)}}return this.spawn(s,!0).filter(r)}},xG=function(t){return function(e){for(var r=this,n=[],s=0;s<r.length;s++){var o=r[s];if(o.isNode())for(var l=o.connectedEdges(),c=0;c<l.length;c++){var u=l[c],d=u.source(),h=u.target();t.outgoing&&d===o?(n.push(u),n.push(h)):t.incoming&&h===o&&(n.push(u),n.push(d))}}return this.spawn(n,!0).filter(e)}},kG=function(t){return function(e){for(var r=this,n=[],s={};;){var o=t.outgoing?r.outgoers():r.incomers();if(o.length===0)break;for(var l=!1,c=0;c<o.length;c++){var u=o[c],d=u.id();s[d]||(s[d]=!0,n.push(u),l=!0)}if(!l)break;r=o}return this.spawn(n,!0).filter(e)}};Tn.clearTraversalCache=function(){for(var a=0;a<this.length;a++)this[a]._private.traversalCache=null};ut(Tn,{roots:SG({noIncomingEdges:!0}),leaves:SG({noOutgoingEdges:!0}),outgoers:us(xG({outgoing:!0}),"outgoers"),successors:kG({outgoing:!0}),incomers:us(xG({incoming:!0}),"incomers"),predecessors:kG({})});ut(Tn,{neighborhood:us(function(a){for(var t=[],e=this.nodes(),r=0;r<e.length;r++)for(var n=e[r],s=n.connectedEdges(),o=0;o<s.length;o++){var l=s[o],c=l.source(),u=l.target(),d=n===c?u:c;d.length>0&&t.push(d[0]),t.push(l[0])}return this.spawn(t,!0).filter(a)},"neighborhood"),closedNeighborhood:function(t){return this.neighborhood().add(this).filter(t)},openNeighborhood:function(t){return this.neighborhood(t)}});Tn.neighbourhood=Tn.neighborhood;Tn.closedNeighbourhood=Tn.closedNeighborhood;Tn.openNeighbourhood=Tn.openNeighborhood;ut(Tn,{source:us(function(t){var e=this[0],r;return e&&(r=e._private.source||e.cy().collection()),r&&t?r.filter(t):r},"source"),target:us(function(t){var e=this[0],r;return e&&(r=e._private.target||e.cy().collection()),r&&t?r.filter(t):r},"target"),sources:DG({attr:"source"}),targets:DG({attr:"target"})});ut(Tn,{edgesWith:us(PG(),"edgesWith"),edgesTo:us(PG({thisIsSrc:!0}),"edgesTo")});ut(Tn,{connectedEdges:us(function(a){for(var t=[],e=this,r=0;r<e.length;r++){var n=e[r];if(n.isNode())for(var s=n._private.edges,o=0;o<s.length;o++){var l=s[o];t.push(l)}}return this.spawn(t,!0).filter(a)},"connectedEdges"),connectedNodes:us(function(a){for(var t=[],e=this,r=0;r<e.length;r++){var n=e[r];n.isEdge()&&(t.push(n.source()[0]),t.push(n.target()[0]))}return this.spawn(t,!0).filter(a)},"connectedNodes"),parallelEdges:us(LG(),"parallelEdges"),codirectedEdges:us(LG({codirected:!0}),"codirectedEdges")});ut(Tn,{components:function(t){var e=this,r=e.cy(),n=r.collection(),s=t==null?e.nodes():t.nodes(),o=[];t!=null&&s.empty()&&(s=t.sources());var l=function(d,h){n.merge(d),s.unmerge(d),h.merge(d)};if(s.empty())return e.spawn();var c=function(){var d=r.collection();o.push(d);var h=s[0];l(h,d),e.bfs({directed:!1,roots:h,visit:function(m){return l(m,d)}}),d.forEach(function(f){f.connectedEdges().forEach(function(m){e.has(m)&&d.has(m.source())&&d.has(m.target())&&d.merge(m)})})};do c();while(s.length>0);return o},component:function(){var t=this[0];return t.cy().mutableElements().components(t)[0]}});Tn.componentsOf=Tn.components;sn=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t===void 0){qr("A collection must have a reference to the core");return}var s=new tl,o=!1;if(!e)e=[];else if(e.length>0&&Zt(e[0])&&!av(e[0])){o=!0;for(var l=[],c=new Cf,u=0,d=e.length;u<d;u++){var h=e[u];h.data==null&&(h.data={});var f=h.data;if(f.id==null)f.id=SV();else if(t.hasElementWithId(f.id)||c.has(f.id))continue;var m=new Dw(t,h,!1);l.push(m),c.add(f.id)}e=l}this.length=0;for(var g=0,y=e.length;g<y;g++){var v=e[g][0];if(v!=null){var E=v._private.data.id;(!r||!s.has(E))&&(r&&s.set(E,{index:this.length,ele:v}),this[this.length]=v,this.length++)}}this._private={eles:this,cy:t,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(C){this.lazyMap=C},rebuildMap:function(){for(var _=this.lazyMap=new tl,x=this.eles,P=0;P<x.length;P++){var I=x[P];_.set(I.id(),{index:P,ele:I})}}},r&&(this._private.map=s),o&&!n&&this.restore()},Or=Dw.prototype=sn.prototype=Object.create(Array.prototype);Or.instanceString=function(){return"collection"};Or.spawn=function(a,t){return new sn(this.cy(),a,t)};Or.spawnSelf=function(){return this.spawn(this)};Or.cy=function(){return this._private.cy};Or.renderer=function(){return this._private.cy.renderer()};Or.element=function(){return this[0]};Or.collection=function(){return dV(this)?this:new sn(this._private.cy,[this])};Or.unique=function(){return new sn(this._private.cy,this,!0)};Or.hasElementWithId=function(a){return a=""+a,this._private.map.has(a)};Or.getElementById=function(a){a=""+a;var t=this._private.cy,e=this._private.map.get(a);return e?e.ele:new sn(t)};Or.$id=Or.getElementById;Or.poolIndex=function(){var a=this._private.cy,t=a._private.elements,e=this[0]._private.data.id;return t._private.map.get(e).index};Or.indexOf=function(a){var t=a[0]._private.data.id;return this._private.map.get(t).index};Or.indexOfId=function(a){return a=""+a,this._private.map.get(a).index};Or.json=function(a){var t=this.element(),e=this.cy();if(t==null&&a)return this;if(t!=null){var r=t._private;if(Zt(a)){if(e.startBatch(),a.data){t.data(a.data);var n=r.data;if(t.isEdge()){var s=!1,o={},l=a.data.source,c=a.data.target;l!=null&&l!=n.source&&(o.source=""+l,s=!0),c!=null&&c!=n.target&&(o.target=""+c,s=!0),s&&(t=t.move(o))}else{var u="parent"in a.data,d=a.data.parent;u&&(d!=null||n.parent!=null)&&d!=n.parent&&(d===void 0&&(d=null),d!=null&&(d=""+d),t=t.move({parent:d}))}}a.position&&t.position(a.position);var h=function(y,v,E){var C=a[y];C!=null&&C!==r[y]&&(C?t[v]():t[E]())};return h("removed","remove","restore"),h("selected","select","unselect"),h("selectable","selectify","unselectify"),h("locked","lock","unlock"),h("grabbable","grabify","ungrabify"),h("pannable","panify","unpanify"),a.classes!=null&&t.classes(a.classes),e.endBatch(),this}else if(a===void 0){var f={data:po(r.data),position:po(r.position),group:r.group,removed:r.removed,selected:r.selected,selectable:r.selectable,locked:r.locked,grabbable:r.grabbable,pannable:r.pannable,classes:null};f.classes="";var m=0;return r.classes.forEach(function(g){return f.classes+=m++===0?g:" "+g}),f}}};Or.jsons=function(){for(var a=[],t=0;t<this.length;t++){var e=this[t],r=e.json();a.push(r)}return a};Or.clone=function(){for(var a=this.cy(),t=[],e=0;e<this.length;e++){var r=this[e],n=r.json(),s=new Dw(a,n,!1);t.push(s)}return new sn(a,t)};Or.copy=Or.clone;Or.restore=function(){for(var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,e=this,r=e.cy(),n=r._private,s=[],o=[],l,c=0,u=e.length;c<u;c++){var d=e[c];t&&!d.removed()||(d.isNode()?s.push(d):o.push(d))}l=s.concat(o);var h,f=function(){l.splice(h,1),h--};for(h=0;h<l.length;h++){var m=l[h],g=m._private,y=g.data;if(m.clearTraversalCache(),!(!t&&!g.removed)){if(y.id===void 0)y.id=SV();else if(We(y.id))y.id=""+y.id;else if(mc(y.id)||!at(y.id)){qr("Can not create element with invalid string ID `"+y.id+"`"),f();continue}else if(r.hasElementWithId(y.id)){qr("Can not create second element with ID `"+y.id+"`"),f();continue}}var v=y.id;if(m.isNode()){var E=g.position;E.x==null&&(E.x=0),E.y==null&&(E.y=0)}if(m.isEdge()){for(var C=m,_=["source","target"],x=_.length,P=!1,I=0;I<x;I++){var M=_[I],O=y[M];We(O)&&(O=y[M]=""+y[M]),O==null||O===""?(qr("Can not create edge `"+v+"` with unspecified "+M),P=!0):r.hasElementWithId(O)||(qr("Can not create edge `"+v+"` with nonexistant "+M+" `"+O+"`"),P=!0)}if(P){f();continue}var R=r.getElementById(y.source),F=r.getElementById(y.target);R.same(F)?R._private.edges.push(C):(R._private.edges.push(C),F._private.edges.push(C)),C._private.source=R,C._private.target=F}g.map=new tl,g.map.set(v,{ele:m,index:0}),g.removed=!1,t&&r.addToPool(m)}for(var $=0;$<s.length;$++){var k=s[$],N=k._private.data;We(N.parent)&&(N.parent=""+N.parent);var G=N.parent,W=G!=null;if(W||k._private.parent){var Y=k._private.parent?r.collection().merge(k._private.parent):r.getElementById(G);if(Y.empty())N.parent=void 0;else if(Y[0].removed())cr("Node added with missing parent, reference to parent removed"),N.parent=void 0,k._private.parent=null;else{for(var U=!1,Z=Y;!Z.empty();){if(k.same(Z)){U=!0,N.parent=void 0;break}Z=Z.parent()}U||(Y[0]._private.children.push(k),k._private.parent=Y[0],n.hasCompoundNodes=!0)}}}if(l.length>0){for(var q=l.length===e.length?e:new sn(r,l),X=0;X<q.length;X++){var ie=q[X];ie.isNode()||(ie.parallelEdges().clearTraversalCache(),ie.source().clearTraversalCache(),ie.target().clearTraversalCache())}var j;n.hasCompoundNodes?j=r.collection().merge(q).merge(q.connectedNodes()).merge(q.parent()):j=q,j.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(a),a?q.emitAndNotify("add"):t&&q.emit("add")}return e};Or.removed=function(){var a=this[0];return a&&a._private.removed};Or.inside=function(){var a=this[0];return a&&!a._private.removed};Or.remove=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,e=this,r=[],n={},s=e._private.cy;function o(G){for(var W=G._private.edges,Y=0;Y<W.length;Y++)c(W[Y])}function l(G){for(var W=G._private.children,Y=0;Y<W.length;Y++)c(W[Y])}function c(G){var W=n[G.id()];t&&G.removed()||W||(n[G.id()]=!0,G.isNode()?(r.push(G),o(G),l(G)):r.unshift(G))}for(var u=0,d=e.length;u<d;u++){var h=e[u];c(h)}function f(G,W){var Y=G._private.edges;gc(Y,W),G.clearTraversalCache()}function m(G){G.clearTraversalCache()}var g=[];g.ids={};function y(G,W){W=W[0],G=G[0];var Y=G._private.children,U=G.id();gc(Y,W),W._private.parent=null,g.ids[U]||(g.ids[U]=!0,g.push(G))}e.dirtyCompoundBoundsCache(),t&&s.removeFromPool(r);for(var v=0;v<r.length;v++){var E=r[v];if(E.isEdge()){var C=E.source()[0],_=E.target()[0];f(C,E),f(_,E);for(var x=E.parallelEdges(),P=0;P<x.length;P++){var I=x[P];m(I),I.isBundledBezier()&&I.dirtyBoundingBoxCache()}}else{var M=E.parent();M.length!==0&&y(M,E)}t&&(E._private.removed=!0)}var O=s._private.elements;s._private.hasCompoundNodes=!1;for(var R=0;R<O.length;R++){var F=O[R];if(F.isParent()){s._private.hasCompoundNodes=!0;break}}var $=new sn(this.cy(),r);$.size()>0&&(a?$.emitAndNotify("remove"):t&&$.emit("remove"));for(var k=0;k<g.length;k++){var N=g[k];(!t||!N.removed())&&N.updateStyle()}return $};Or.move=function(a){var t=this._private.cy,e=this,r=!1,n=!1,s=function(g){return g==null?g:""+g};if(a.source!==void 0||a.target!==void 0){var o=s(a.source),l=s(a.target),c=o!=null&&t.hasElementWithId(o),u=l!=null&&t.hasElementWithId(l);(c||u)&&(t.batch(function(){e.remove(r,n),e.emitAndNotify("moveout");for(var m=0;m<e.length;m++){var g=e[m],y=g._private.data;g.isEdge()&&(c&&(y.source=o),u&&(y.target=l))}e.restore(r,n)}),e.emitAndNotify("move"))}else if(a.parent!==void 0){var d=s(a.parent),h=d===null||t.hasElementWithId(d);if(h){var f=d===null?void 0:d;t.batch(function(){var m=e.remove(r,n);m.emitAndNotify("moveout");for(var g=0;g<e.length;g++){var y=e[g],v=y._private.data;y.isNode()&&(v.parent=f)}m.restore(r,n)}),e.emitAndNotify("move")}}return this};[NV,x0e,nw,fc,Tf,G0e,Fw,nwe,l5,c5,cwe,bw,aw,an,pc,Tn].forEach(function(a){ut(Or,a)});gwe={add:function(t){var e,r=this;if(Ra(t)){var n=t;if(n._private.cy===r)e=n.restore();else{for(var s=[],o=0;o<n.length;o++){var l=n[o];s.push(l.json())}e=new sn(r,s)}}else if(Pr(t)){var c=t;e=new sn(r,c)}else if(Zt(t)&&(Pr(t.nodes)||Pr(t.edges))){for(var u=t,d=[],h=["nodes","edges"],f=0,m=h.length;f<m;f++){var g=h[f],y=u[g];if(Pr(y))for(var v=0,E=y.length;v<E;v++){var C=ut({group:g},y[v]);d.push(C)}}e=new sn(r,d)}else{var _=t;e=new Dw(r,_).collection()}return e},remove:function(t){if(!Ra(t)){if(at(t)){var e=t;t=this.$(e)}}return t.remove()}};ywe=(function(){function a(r){return-r.tension*r.x-r.friction*r.v}function t(r,n,s){var o={x:r.x+s.dx*n,v:r.v+s.dv*n,tension:r.tension,friction:r.friction};return{dx:o.v,dv:a(o)}}function e(r,n){var s={dx:r.v,dv:a(r)},o=t(r,n*.5,s),l=t(r,n*.5,o),c=t(r,n,l),u=1/6*(s.dx+2*(o.dx+l.dx)+c.dx),d=1/6*(s.dv+2*(o.dv+l.dv)+c.dv);return r.x=r.x+u*n,r.v=r.v+d*n,r}return function r(n,s,o){var l={x:-1,v:0,tension:null,friction:null},c=[0],u=0,d=1/1e4,h=16/1e3,f,m,g;for(n=parseFloat(n)||500,s=parseFloat(s)||20,o=o||null,l.tension=n,l.friction=s,f=o!==null,f?(u=r(n,s),m=u/o*h):m=h;g=e(g||l,m),c.push(1+g.x),u+=16,Math.abs(g.x)>d&&Math.abs(g.v)>d;);return f?function(y){return c[y*(c.length-1)|0]}:u}})(),Ar=function(t,e,r,n){var s=vwe(t,e,r,n);return function(o,l,c){return o+(l-o)*s(c)}},sw={linear:function(t,e,r){return t+(e-t)*r},ease:Ar(.25,.1,.25,1),"ease-in":Ar(.42,0,1,1),"ease-out":Ar(0,0,.58,1),"ease-in-out":Ar(.42,0,.58,1),"ease-in-sine":Ar(.47,0,.745,.715),"ease-out-sine":Ar(.39,.575,.565,1),"ease-in-out-sine":Ar(.445,.05,.55,.95),"ease-in-quad":Ar(.55,.085,.68,.53),"ease-out-quad":Ar(.25,.46,.45,.94),"ease-in-out-quad":Ar(.455,.03,.515,.955),"ease-in-cubic":Ar(.55,.055,.675,.19),"ease-out-cubic":Ar(.215,.61,.355,1),"ease-in-out-cubic":Ar(.645,.045,.355,1),"ease-in-quart":Ar(.895,.03,.685,.22),"ease-out-quart":Ar(.165,.84,.44,1),"ease-in-out-quart":Ar(.77,0,.175,1),"ease-in-quint":Ar(.755,.05,.855,.06),"ease-out-quint":Ar(.23,1,.32,1),"ease-in-out-quint":Ar(.86,0,.07,1),"ease-in-expo":Ar(.95,.05,.795,.035),"ease-out-expo":Ar(.19,1,.22,1),"ease-in-out-expo":Ar(1,0,0,1),"ease-in-circ":Ar(.6,.04,.98,.335),"ease-out-circ":Ar(.075,.82,.165,1),"ease-in-out-circ":Ar(.785,.135,.15,.86),spring:function(t,e,r){if(r===0)return sw.linear;var n=ywe(t,e,r);return function(s,o,l){return s+(o-s)*n(l)}},"cubic-bezier":Ar};Ewe={animate:lr.animate(),animation:lr.animation(),animated:lr.animated(),clearQueue:lr.clearQueue(),delay:lr.delay(),delayAnimation:lr.delayAnimation(),stop:lr.stop(),addToAnimationPool:function(t){var e=this;e.styleEnabled()&&e._private.aniEles.merge(t)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var t=this;if(t._private.animationsRunning=!0,!t.styleEnabled())return;function e(){t._private.animationsRunning&&pw(function(s){AG(s,t),e()})}var r=t.renderer();r&&r.beforeRender?r.beforeRender(function(s,o){AG(o,t)},r.beforeRenderPriorities.animations):e()}},Twe={qualifierCompare:function(t,e){return t==null||e==null?t==null&&e==null:t.sameText(e)},eventMatches:function(t,e,r){var n=e.qualifier;return n!=null?t!==r.target&&av(r.target)&&n.matches(r.target):!0},addEventFields:function(t,e){e.cy=t,e.target=t},callbackContext:function(t,e,r){return e.qualifier!=null?r.target:t}},X0=function(t){return at(t)?new yc(t):t},h5={createEmitter:function(){var t=this._private;return t.emitter||(t.emitter=new Rw(Twe,this)),this},emitter:function(){return this._private.emitter},on:function(t,e,r){return this.emitter().on(t,X0(e),r),this},removeListener:function(t,e,r){return this.emitter().removeListener(t,X0(e),r),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(t,e,r){return this.emitter().one(t,X0(e),r),this},once:function(t,e,r){return this.emitter().one(t,X0(e),r),this},emit:function(t,e){return this.emitter().emit(t,e),this},emitAndNotify:function(t,e){return this.emit(t),this.notify(t,e),this}};lr.eventAliasesOn(h5);bD={png:function(t){var e=this._private.renderer;return t=t||{},e.png(t)},jpg:function(t){var e=this._private.renderer;return t=t||{},t.bg=t.bg||"#fff",e.jpg(t)}};bD.jpeg=bD.jpg;ow={layout:function(t){var e=this;if(t==null){qr("Layout options must be specified to make a layout");return}if(t.name==null){qr("A `name` must be specified to make a layout");return}var r=t.name,n=e.extension("layout",r);if(n==null){qr("No such layout `"+r+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var s;at(t.eles)?s=e.$(t.eles):s=t.eles!=null?t.eles:e.$();var o=new n(ut({},t,{cy:e,eles:s}));return o}};ow.createLayout=ow.makeLayout=ow.layout;Cwe={notify:function(t,e){var r=this._private;if(this.batching()){r.batchNotifications=r.batchNotifications||{};var n=r.batchNotifications[t]=r.batchNotifications[t]||this.collection();e!=null&&n.merge(e);return}if(r.notificationsEnabled){var s=this.renderer();this.destroyed()||!s||s.notify(t,e)}},notifications:function(t){var e=this._private;return t===void 0?e.notificationsEnabled:(e.notificationsEnabled=!!t,this)},noNotifications:function(t){this.notifications(!1),t(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var t=this._private;return t.batchCount==null&&(t.batchCount=0),t.batchCount===0&&(t.batchStyleEles=this.collection(),t.batchNotifications={}),t.batchCount++,this},endBatch:function(){var t=this._private;if(t.batchCount===0)return this;if(t.batchCount--,t.batchCount===0){t.batchStyleEles.updateStyle();var e=this.renderer();Object.keys(t.batchNotifications).forEach(function(r){var n=t.batchNotifications[r];n.empty()?e.notify(r):e.notify(r,n)})}return this},batch:function(t){return this.startBatch(),t(),this.endBatch(),this},batchData:function(t){var e=this;return this.batch(function(){for(var r=Object.keys(t),n=0;n<r.length;n++){var s=r[n],o=t[s],l=e.getElementById(s);l.data(o)}})}},_we=on({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),wD={renderTo:function(t,e,r,n){var s=this._private.renderer;return s.renderTo(t,e,r,n),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(t){var e=this,r=e.extension("renderer",t.name);if(r==null){qr("Can not initialise: No such renderer `".concat(t.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}t.wheelSensitivity!==void 0&&cr("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var n=_we(t);n.cy=e,e._private.renderer=new r(n),this.notify("init")},destroyRenderer:function(){var t=this;t.notify("destroy");var e=t.container();if(e)for(e._cyreg=null;e.childNodes.length>0;)e.removeChild(e.childNodes[0]);t._private.renderer=null,t.mutableElements().forEach(function(r){var n=r._private;n.rscratch={},n.rstyle={},n.animation.current=[],n.animation.queue=[]})},onRender:function(t){return this.on("render",t)},offRender:function(t){return this.off("render",t)}};wD.invalidateDimensions=wD.resize;lw={collection:function(t,e){return at(t)?this.$(t):Ra(t)?t.collection():Pr(t)?(e||(e={}),new sn(this,t,e.unique,e.removed)):new sn(this)},nodes:function(t){var e=this.$(function(r){return r.isNode()});return t?e.filter(t):e},edges:function(t){var e=this.$(function(r){return r.isEdge()});return t?e.filter(t):e},$:function(t){var e=this._private.elements;return t?e.filter(t):e.spawnSelf()},mutableElements:function(){return this._private.elements}};lw.elements=lw.filter=lw.$;Ki={},Ug="t",Swe="f";Ki.apply=function(a){for(var t=this,e=t._private,r=e.cy,n=r.collection(),s=0;s<a.length;s++){var o=a[s],l=t.getContextMeta(o);if(!l.empty){var c=t.getContextStyle(l),u=t.applyContextStyle(l,c,o);o._private.appliedInitStyle?t.updateTransitions(o,u.diffProps):o._private.appliedInitStyle=!0;var d=t.updateStyleHints(o);d&&n.push(o)}}return n};Ki.getPropertiesDiff=function(a,t){var e=this,r=e._private.propDiffs=e._private.propDiffs||{},n=a+"-"+t,s=r[n];if(s)return s;for(var o=[],l={},c=0;c<e.length;c++){var u=e[c],d=a[c]===Ug,h=t[c]===Ug,f=d!==h,m=u.mappedProperties.length>0;if(f||h&&m){var g=void 0;f&&m||f?g=u.properties:m&&(g=u.mappedProperties);for(var y=0;y<g.length;y++){for(var v=g[y],E=v.name,C=!1,_=c+1;_<e.length;_++){var x=e[_],P=t[_]===Ug;if(P&&(C=x.properties[v.name]!=null,C))break}!l[E]&&!C&&(l[E]=!0,o.push(E))}}}return r[n]=o,o};Ki.getContextMeta=function(a){for(var t=this,e="",r,n=a._private.styleCxtKey||"",s=0;s<t.length;s++){var o=t[s],l=o.selector&&o.selector.matches(a);l?e+=Ug:e+=Swe}return r=t.getPropertiesDiff(n,e),a._private.styleCxtKey=e,{key:e,diffPropNames:r,empty:r.length===0}};Ki.getContextStyle=function(a){var t=a.key,e=this,r=this._private.contextStyles=this._private.contextStyles||{};if(r[t])return r[t];for(var n={_private:{key:t}},s=0;s<e.length;s++){var o=e[s],l=t[s]===Ug;if(l)for(var c=0;c<o.properties.length;c++){var u=o.properties[c];n[u.name]=u}}return r[t]=n,n};Ki.applyContextStyle=function(a,t,e){for(var r=this,n=a.diffPropNames,s={},o=r.types,l=0;l<n.length;l++){var c=n[l],u=t[c],d=e.pstyle(c);if(!u)if(d)d.bypass?u={name:c,deleteBypassed:!0}:u={name:c,delete:!0};else continue;if(d!==u){if(u.mapped===o.fn&&d!=null&&d.mapping!=null&&d.mapping.value===u.value){var h=d.mapping,f=h.fnValue=u.value(e);if(f===h.prevFnValue)continue}var m=s[c]={prev:d};r.applyParsedProperty(e,u),m.next=e.pstyle(c),m.next&&m.next.bypass&&(m.next=m.next.bypassed)}}return{diffProps:s}};Ki.updateStyleHints=function(a){var t=a._private,e=this,r=e.propertyGroupNames,n=e.propertyGroupKeys,s=function(B,oe,he){return e.getPropertiesHash(B,oe,he)},o=t.styleKey;if(a.removed())return!1;var l=t.group==="nodes",c=a._private.style;r=Object.keys(c);for(var u=0;u<n.length;u++){var d=n[u];t.styleKeys[d]=[Wu,hf]}for(var h=function(B,oe){return t.styleKeys[oe][0]=qg(B,t.styleKeys[oe][0])},f=function(B,oe){return t.styleKeys[oe][1]=Zg(B,t.styleKeys[oe][1])},m=function(B,oe){h(B,oe),f(B,oe)},g=function(B,oe){for(var he=0;he<B.length;he++){var te=B.charCodeAt(he);h(te,oe),f(te,oe)}},y=2e9,v=function(B){return-128<B&&B<128&&Math.floor(B)!==B?y-(B*1024|0):B},E=0;E<r.length;E++){var C=r[E],_=c[C];if(_!=null){var x=this.properties[C],P=x.type,I=x.groupKey,M=void 0;x.hashOverride!=null?M=x.hashOverride(a,_):_.pfValue!=null&&(M=_.pfValue);var O=x.enums==null?_.value:null,R=M!=null,F=O!=null,$=R||F,k=_.units;if(P.number&&$&&!P.multiple){var N=R?M:O;m(v(N),I),!R&&k!=null&&g(k,I)}else g(_.strValue,I)}}for(var G=[Wu,hf],W=0;W<n.length;W++){var Y=n[W],U=t.styleKeys[Y];G[0]=qg(U[0],G[0]),G[1]=Zg(U[1],G[1])}t.styleKey=Hve(G[0],G[1]);var Z=t.styleKeys;t.labelDimsKey=oc(Z.labelDimensions);var q=s(a,["label"],Z.labelDimensions);if(t.labelKey=oc(q),t.labelStyleKey=oc(V0(Z.commonLabel,q)),!l){var X=s(a,["source-label"],Z.labelDimensions);t.sourceLabelKey=oc(X),t.sourceLabelStyleKey=oc(V0(Z.commonLabel,X));var ie=s(a,["target-label"],Z.labelDimensions);t.targetLabelKey=oc(ie),t.targetLabelStyleKey=oc(V0(Z.commonLabel,ie))}if(l){var j=t.styleKeys,K=j.nodeBody,se=j.nodeBorder,ne=j.nodeOutline,ge=j.backgroundImage,ve=j.compound,Se=j.pie,Te=j.stripe,me=[K,se,ne,ge,ve,Se,Te].filter(function(pe){return pe!=null}).reduce(V0,[Wu,hf]);t.nodeKey=oc(me),t.hasPie=Se!=null&&Se[0]!==Wu&&Se[1]!==hf,t.hasStripe=Te!=null&&Te[0]!==Wu&&Te[1]!==hf}return o!==t.styleKey};Ki.clearStyleHints=function(a){var t=a._private;t.styleCxtKey="",t.styleKeys={},t.styleKey=null,t.labelKey=null,t.labelStyleKey=null,t.sourceLabelKey=null,t.sourceLabelStyleKey=null,t.targetLabelKey=null,t.targetLabelStyleKey=null,t.nodeKey=null,t.hasPie=null,t.hasStripe=null};Ki.applyParsedProperty=function(a,t){var e=this,r=t,n=a._private.style,s,o=e.types,l=e.properties[r.name].type,c=r.bypass,u=n[r.name],d=u&&u.bypass,h=a._private,f="mapping",m=function(K){return K==null?null:K.pfValue!=null?K.pfValue:K.value},g=function(){var K=m(u),se=m(r);e.checkTriggers(a,r.name,K,se)};if(t.name==="curve-style"&&a.isEdge()&&(t.value!=="bezier"&&a.isLoop()||t.value==="haystack"&&(a.source().isParent()||a.target().isParent()))&&(r=t=this.parse(t.name,"bezier",c)),r.delete)return n[r.name]=void 0,g(),!0;if(r.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,g(),!0):!1:(g(),!0);if(r.deleteBypass)return u?u.bypass?(n[r.name]=u.bypassed,g(),!0):!1:(g(),!0);var y=function(){cr("Do not assign mappings to elements without corresponding data (i.e. ele `"+a.id()+"` has no mapping for property `"+r.name+"` with data field `"+r.field+"`); try a `["+r.field+"]` selector to limit scope to elements with `"+r.field+"` defined")};switch(r.mapped){case o.mapData:{for(var v=r.field.split("."),E=h.data,C=0;C<v.length&&E;C++){var _=v[C];E=E[_]}if(E==null)return y(),!1;var x;if(We(E)){var P=r.fieldMax-r.fieldMin;P===0?x=0:x=(E-r.fieldMin)/P}else return cr("Do not use continuous mappers without specifying numeric data (i.e. `"+r.field+": "+E+"` for `"+a.id()+"` is non-numeric)"),!1;if(x<0?x=0:x>1&&(x=1),l.color){var I=r.valueMin[0],M=r.valueMax[0],O=r.valueMin[1],R=r.valueMax[1],F=r.valueMin[2],$=r.valueMax[2],k=r.valueMin[3]==null?1:r.valueMin[3],N=r.valueMax[3]==null?1:r.valueMax[3],G=[Math.round(I+(M-I)*x),Math.round(O+(R-O)*x),Math.round(F+($-F)*x),Math.round(k+(N-k)*x)];s={bypass:r.bypass,name:r.name,value:G,strValue:"rgb("+G[0]+", "+G[1]+", "+G[2]+")"}}else if(l.number){var W=r.valueMin+(r.valueMax-r.valueMin)*x;s=this.parse(r.name,W,r.bypass,f)}else return!1;if(!s)return y(),!1;s.mapping=r,r=s;break}case o.data:{for(var Y=r.field.split("."),U=h.data,Z=0;Z<Y.length&&U;Z++){var q=Y[Z];U=U[q]}if(U!=null&&(s=this.parse(r.name,U,r.bypass,f)),!s)return y(),!1;s.mapping=r,r=s;break}case o.fn:{var X=r.value,ie=r.fnValue!=null?r.fnValue:X(a);if(r.prevFnValue=ie,ie==null)return cr("Custom function mappers may not return null (i.e. `"+r.name+"` for ele `"+a.id()+"` is null)"),!1;if(s=this.parse(r.name,ie,r.bypass,f),!s)return cr("Custom function mappers may not return invalid values for the property type (i.e. `"+r.name+"` for ele `"+a.id()+"` is invalid)"),!1;s.mapping=po(r),r=s;break}case void 0:break;default:return!1}return c?(d?r.bypassed=u.bypassed:r.bypassed=u,n[r.name]=r):d?u.bypassed=r:n[r.name]=r,g(),!0};Ki.cleanElements=function(a,t){for(var e=0;e<a.length;e++){var r=a[e];if(this.clearStyleHints(r),r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache(),!t)r._private.style={};else for(var n=r._private.style,s=Object.keys(n),o=0;o<s.length;o++){var l=s[o],c=n[l];c!=null&&(c.bypass?c.bypassed=null:n[l]=null)}}};Ki.update=function(){var a=this._private.cy,t=a.mutableElements();t.updateStyle()};Ki.updateTransitions=function(a,t){var e=this,r=a._private,n=a.pstyle("transition-property").value,s=a.pstyle("transition-duration").pfValue,o=a.pstyle("transition-delay").pfValue;if(n.length>0&&s>0){for(var l={},c=!1,u=0;u<n.length;u++){var d=n[u],h=a.pstyle(d),f=t[d];if(f){var m=f.prev,g=m,y=f.next!=null?f.next:h,v=!1,E=void 0,C=1e-6;g&&(We(g.pfValue)&&We(y.pfValue)?(v=y.pfValue-g.pfValue,E=g.pfValue+C*v):We(g.value)&&We(y.value)?(v=y.value-g.value,E=g.value+C*v):Pr(g.value)&&Pr(y.value)&&(v=g.value[0]!==y.value[0]||g.value[1]!==y.value[1]||g.value[2]!==y.value[2],E=g.strValue),v&&(l[d]=y.strValue,this.applyBypass(a,d,E),c=!0))}}if(!c)return;r.transitioning=!0,new _f(function(_){o>0?a.delayAnimation(o).play().promise().then(_):_()}).then(function(){return a.animation({style:l,duration:s,easing:a.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){e.removeBypasses(a,n),a.emitAndNotify("style"),r.transitioning=!1})}else r.transitioning&&(this.removeBypasses(a,n),a.emitAndNotify("style"),r.transitioning=!1)};Ki.checkTrigger=function(a,t,e,r,n,s){var o=this.properties[t],l=n(o);a.removed()||l!=null&&l(e,r,a)&&s(o)};Ki.checkZOrderTrigger=function(a,t,e,r){var n=this;this.checkTrigger(a,t,e,r,function(s){return s.triggersZOrder},function(){n._private.cy.notify("zorder",a)})};Ki.checkBoundsTrigger=function(a,t,e,r){this.checkTrigger(a,t,e,r,function(n){return n.triggersBounds},function(n){a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache()})};Ki.checkConnectedEdgesBoundsTrigger=function(a,t,e,r){this.checkTrigger(a,t,e,r,function(n){return n.triggersBoundsOfConnectedEdges},function(n){a.connectedEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};Ki.checkParallelEdgesBoundsTrigger=function(a,t,e,r){this.checkTrigger(a,t,e,r,function(n){return n.triggersBoundsOfParallelEdges},function(n){a.parallelEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};Ki.checkTriggers=function(a,t,e,r){a.dirtyStyleCache(),this.checkZOrderTrigger(a,t,e,r),this.checkBoundsTrigger(a,t,e,r),this.checkConnectedEdgesBoundsTrigger(a,t,e,r),this.checkParallelEdgesBoundsTrigger(a,t,e,r)};hv={};hv.applyBypass=function(a,t,e,r){var n=this,s=[],o=!0;if(t==="*"||t==="**"){if(e!==void 0)for(var l=0;l<n.properties.length;l++){var c=n.properties[l],u=c.name,d=this.parse(u,e,!0);d&&s.push(d)}}else if(at(t)){var h=this.parse(t,e,!0);h&&s.push(h)}else if(Zt(t)){var f=t;r=e;for(var m=Object.keys(f),g=0;g<m.length;g++){var y=m[g],v=f[y];if(v===void 0&&(v=f[xw(y)]),v!==void 0){var E=this.parse(y,v,!0);E&&s.push(E)}}}else return!1;if(s.length===0)return!1;for(var C=!1,_=0;_<a.length;_++){for(var x=a[_],P={},I=void 0,M=0;M<s.length;M++){var O=s[M];if(r){var R=x.pstyle(O.name);I=P[O.name]={prev:R}}C=this.applyParsedProperty(x,po(O))||C,r&&(I.next=x.pstyle(O.name))}C&&this.updateStyleHints(x),r&&this.updateTransitions(x,P,o)}return C};hv.overrideBypass=function(a,t,e){t=ID(t);for(var r=0;r<a.length;r++){var n=a[r],s=n._private.style[t],o=this.properties[t].type,l=o.color,c=o.mutiple,u=s?s.pfValue!=null?s.pfValue:s.value:null;!s||!s.bypass?this.applyBypass(n,t,e):(s.value=e,s.pfValue!=null&&(s.pfValue=e),l?s.strValue="rgb("+e.join(",")+")":c?s.strValue=e.join(" "):s.strValue=""+e,this.updateStyleHints(n)),this.checkTriggers(n,t,u,e)}};hv.removeAllBypasses=function(a,t){return this.removeBypasses(a,this.propertyNames,t)};hv.removeBypasses=function(a,t,e){for(var r=!0,n=0;n<a.length;n++){for(var s=a[n],o={},l=0;l<t.length;l++){var c=t[l],u=this.properties[c],d=s.pstyle(u.name);if(!(!d||!d.bypass)){var h="",f=this.parse(c,h,!0),m=o[u.name]={prev:d};this.applyParsedProperty(s,f),m.next=s.pstyle(u.name)}}this.updateStyleHints(s),e&&this.updateTransitions(s,o,r)}};YD={};YD.getEmSizeInPixels=function(){var a=this.containerCss("font-size");return a!=null?parseFloat(a):1};YD.containerCss=function(a){var t=this._private.cy,e=t.container(),r=t.window();if(r&&e&&r.getComputedStyle)return r.getComputedStyle(e).getPropertyValue(a)};mo={};mo.getRenderedStyle=function(a,t){return t?this.getStylePropertyValue(a,t,!0):this.getRawStyle(a,!0)};mo.getRawStyle=function(a,t){var e=this;if(a=a[0],a){for(var r={},n=0;n<e.properties.length;n++){var s=e.properties[n],o=e.getStylePropertyValue(a,s.name,t);o!=null&&(r[s.name]=o,r[xw(s.name)]=o)}return r}};mo.getIndexedStyle=function(a,t,e,r){var n=a.pstyle(t)[e][r];return n!=null?n:a.cy().style().getDefaultProperty(t)[e][0]};mo.getStylePropertyValue=function(a,t,e){var r=this;if(a=a[0],a){var n=r.properties[t];n.alias&&(n=n.pointsTo);var s=n.type,o=a.pstyle(n.name);if(o){var l=o.value,c=o.units,u=o.strValue;if(e&&s.number&&l!=null&&We(l)){var d=a.cy().zoom(),h=function(v){return v*d},f=function(v,E){return h(v)+E},m=Pr(l),g=m?c.every(function(y){return y!=null}):c!=null;return g?m?l.map(function(y,v){return f(y,c[v])}).join(" "):f(l,c):m?l.map(function(y){return at(y)?y:""+h(y)}).join(" "):""+h(l)}else if(u!=null)return u}return null}};mo.getAnimationStartStyle=function(a,t){for(var e={},r=0;r<t.length;r++){var n=t[r],s=n.name,o=a.pstyle(s);o!==void 0&&(Zt(o)?o=this.parse(s,o.strValue):o=this.parse(s,o)),o&&(e[s]=o)}return e};mo.getPropsList=function(a){var t=this,e=[],r=a,n=t.properties;if(r)for(var s=Object.keys(r),o=0;o<s.length;o++){var l=s[o],c=r[l],u=n[l]||n[ID(l)],d=this.parse(u.name,c);d&&e.push(d)}return e};mo.getNonDefaultPropertiesHash=function(a,t,e){var r=e.slice(),n,s,o,l,c,u;for(c=0;c<t.length;c++)if(n=t[c],s=a.pstyle(n,!1),s!=null)if(s.pfValue!=null)r[0]=qg(l,r[0]),r[1]=Zg(l,r[1]);else for(o=s.strValue,u=0;u<o.length;u++)l=o.charCodeAt(u),r[0]=qg(l,r[0]),r[1]=Zg(l,r[1]);return r};mo.getPropertiesHash=mo.getNonDefaultPropertiesHash;$w={};$w.appendFromJson=function(a){for(var t=this,e=0;e<a.length;e++){var r=a[e],n=r.selector,s=r.style||r.css,o=Object.keys(s);t.selector(n);for(var l=0;l<o.length;l++){var c=o[l],u=s[c];t.css(c,u)}}return t};$w.fromJson=function(a){var t=this;return t.resetToDefault(),t.appendFromJson(a),t};$w.json=function(){for(var a=[],t=this.defaultLength;t<this.length;t++){for(var e=this[t],r=e.selector,n=e.properties,s={},o=0;o<n.length;o++){var l=n[o];s[l.name]=l.strValue}a.push({selector:r?r.toString():"core",style:s})}return a};qD={};qD.appendFromString=function(a){var t=this,e=this,r=""+a,n,s,o;r=r.replace(/[/][*](\s|.)+?[*][/]/g,"");function l(){r.length>n.length?r=r.substr(n.length):r=""}function c(){s.length>o.length?s=s.substr(o.length):s=""}for(;;){var u=r.match(/^\s*$/);if(u)break;var d=r.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!d){cr("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+r);break}n=d[0];var h=d[1];if(h!=="core"){var f=new yc(h);if(f.invalid){cr("Skipping parsing of block: Invalid selector found in string stylesheet: "+h),l();continue}}var m=d[2],g=!1;s=m;for(var y=[];;){var v=s.match(/^\s*$/);if(v)break;var E=s.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!E){cr("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+m),g=!0;break}o=E[0];var C=E[1],_=E[2],x=t.properties[C];if(!x){cr("Skipping property: Invalid property name in: "+o),c();continue}var P=e.parse(C,_);if(!P){cr("Skipping property: Invalid property definition in: "+o),c();continue}y.push({name:C,val:_}),c()}if(g){l();break}e.selector(h);for(var I=0;I<y.length;I++){var M=y[I];e.css(M.name,M.val)}l()}return e};qD.fromString=function(a){var t=this;return t.resetToDefault(),t.appendFromString(a),t};Ti={};(function(){var a=Ii,t=bve,e=Eve,r=Tve,n=Cve,s=function(pe){return"^"+pe+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(pe){var B=a+"|\\w+|"+t+"|"+e+"|"+r+"|"+n;return"^"+pe+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+a+")\\s*\\,\\s*("+a+")\\s*,\\s*("+B+")\\s*\\,\\s*("+B+")\\)$"},l=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Ti.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:s("data")},layoutData:{mapping:!0,regex:s("layoutData")},scratch:{mapping:!0,regex:s("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:l,singleRegexMatchValue:!0},urls:{regexes:l,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(pe,B){switch(pe.length){case 2:return B[0]!=="deg"&&B[0]!=="rad"&&B[1]!=="deg"&&B[1]!=="rad";case 1:return at(pe[0])||B[0]==="deg"||B[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+a+")\\s*,\\s*("+a+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+a+")\\s*,\\s*("+a+")\\s*,\\s*("+a+")\\s*,\\s*("+a+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(pe){var B=pe.length;return B===1||B===2||B===4}}};var c={zeroNonZero:function(pe,B){return(pe==null||B==null)&&pe!==B||pe==0&&B!=0?!0:pe!=0&&B==0},any:function(pe,B){return pe!=B},emptyNonEmpty:function(pe,B){var oe=mc(pe),he=mc(B);return oe&&!he||!oe&&he}},u=Ti.types,d=[{name:"label",type:u.text,triggersBounds:c.any,triggersZOrder:c.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:c.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:c.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:c.any}],h=[{name:"source-label",type:u.text,triggersBounds:c.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:c.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:c.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:c.any},{name:"source-text-offset",type:u.size,triggersBounds:c.any}],f=[{name:"target-label",type:u.text,triggersBounds:c.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:c.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:c.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:c.any},{name:"target-text-offset",type:u.size,triggersBounds:c.any}],m=[{name:"font-family",type:u.fontFamily,triggersBounds:c.any},{name:"font-style",type:u.fontStyle,triggersBounds:c.any},{name:"font-weight",type:u.fontWeight,triggersBounds:c.any},{name:"font-size",type:u.size,triggersBounds:c.any},{name:"text-transform",type:u.textTransform,triggersBounds:c.any},{name:"text-wrap",type:u.textWrap,triggersBounds:c.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:c.any},{name:"text-max-width",type:u.size,triggersBounds:c.any},{name:"text-outline-width",type:u.size,triggersBounds:c.any},{name:"line-height",type:u.positiveNumber,triggersBounds:c.any}],g=[{name:"text-valign",type:u.valign,triggersBounds:c.any},{name:"text-halign",type:u.halign,triggersBounds:c.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:c.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:c.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:c.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:c.any},{name:"text-justification",type:u.justification},{name:"box-select-labels",type:u.bool,triggersBounds:c.any}],y=[{name:"events",type:u.bool,triggersZOrder:c.any},{name:"text-events",type:u.bool,triggersZOrder:c.any},{name:"box-selection",type:u.boxSelection,triggersZOrder:c.any}],v=[{name:"display",type:u.display,triggersZOrder:c.any,triggersBounds:c.any,triggersBoundsOfConnectedEdges:c.any,triggersBoundsOfParallelEdges:function(pe,B,oe){return pe===B?!1:oe.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:u.visibility,triggersZOrder:c.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:c.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:c.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:c.any},{name:"z-index",type:u.number,triggersZOrder:c.any}],E=[{name:"overlay-padding",type:u.size,triggersBounds:c.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:c.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:c.any},{name:"overlay-corner-radius",type:u.cornerRadius}],C=[{name:"underlay-padding",type:u.size,triggersBounds:c.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:c.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:c.any},{name:"underlay-corner-radius",type:u.cornerRadius}],_=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],x=function(pe,B){return B.value==="label"?-pe.poolIndex():B.pfValue},P=[{name:"height",type:u.nodeSize,triggersBounds:c.any,hashOverride:x},{name:"width",type:u.nodeSize,triggersBounds:c.any,hashOverride:x},{name:"shape",type:u.nodeShape,triggersBounds:c.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:c.any},{name:"corner-radius",type:u.cornerRadius},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:c.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:c.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:c.any}],I=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:c.any},{name:"border-style",type:u.borderStyle},{name:"border-cap",type:u.lineCap},{name:"border-join",type:u.lineJoin},{name:"border-dash-pattern",type:u.numbers},{name:"border-dash-offset",type:u.number},{name:"border-position",type:u.linePosition}],M=[{name:"outline-color",type:u.color},{name:"outline-opacity",type:u.zeroOneNumber},{name:"outline-width",type:u.size,triggersBounds:c.any},{name:"outline-style",type:u.borderStyle},{name:"outline-offset",type:u.size,triggersBounds:c.any}],O=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],R=[{name:"position",type:u.position,triggersBounds:c.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:c.any},{name:"min-width",type:u.size,triggersBounds:c.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:c.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:c.any},{name:"min-height",type:u.size,triggersBounds:c.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:c.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:c.any}],F=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-outline-width",type:u.size},{name:"line-outline-color",type:u.color},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:c.any,triggersBoundsOfParallelEdges:function(pe,B){return pe===B?!1:pe==="bezier"||B==="bezier"}},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:c.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:c.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:c.any},{name:"control-point-step-size",type:u.size,triggersBounds:c.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:c.any},{name:"control-point-weights",type:u.numbers,triggersBounds:c.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:c.any},{name:"segment-weights",type:u.numbers,triggersBounds:c.any},{name:"segment-radii",type:u.numbers,triggersBounds:c.any},{name:"radius-type",type:u.radiusType,triggersBounds:c.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:c.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:c.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:c.any},{name:"taxi-radius",type:u.number,triggersBounds:c.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:c.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:c.any},{name:"loop-direction",type:u.angle,triggersBounds:c.any},{name:"loop-sweep",type:u.angle,triggersBounds:c.any},{name:"source-distance-from-node",type:u.size,triggersBounds:c.any},{name:"target-distance-from-node",type:u.size,triggersBounds:c.any}],$=[{name:"ghost",type:u.bool,triggersBounds:c.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:c.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:c.any},{name:"ghost-opacity",type:u.zeroOneNumber}],k=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],N=[];Ti.pieBackgroundN=16,N.push({name:"pie-size",type:u.sizeMaybePercent}),N.push({name:"pie-hole",type:u.sizeMaybePercent}),N.push({name:"pie-start-angle",type:u.angle});for(var G=1;G<=Ti.pieBackgroundN;G++)N.push({name:"pie-"+G+"-background-color",type:u.color}),N.push({name:"pie-"+G+"-background-size",type:u.percent}),N.push({name:"pie-"+G+"-background-opacity",type:u.zeroOneNumber});var W=[];Ti.stripeBackgroundN=16,W.push({name:"stripe-size",type:u.sizeMaybePercent}),W.push({name:"stripe-direction",type:u.axisDirectionPrimary});for(var Y=1;Y<=Ti.stripeBackgroundN;Y++)W.push({name:"stripe-"+Y+"-background-color",type:u.color}),W.push({name:"stripe-"+Y+"-background-size",type:u.percent}),W.push({name:"stripe-"+Y+"-background-opacity",type:u.zeroOneNumber});var U=[],Z=Ti.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:c.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill},{name:"arrow-width",type:u.arrowWidth}].forEach(function(me){Z.forEach(function(pe){var B=pe+"-"+me.name,oe=me.type,he=me.triggersBounds;U.push({name:B,type:oe,triggersBounds:he})})},{});var q=Ti.properties=[].concat(y,_,v,E,C,$,g,m,d,h,f,P,I,M,O,N,W,R,F,U,k),X=Ti.propertyGroups={behavior:y,transition:_,visibility:v,overlay:E,underlay:C,ghost:$,commonLabel:g,labelDimensions:m,mainLabel:d,sourceLabel:h,targetLabel:f,nodeBody:P,nodeBorder:I,nodeOutline:M,backgroundImage:O,pie:N,stripe:W,compound:R,edgeLine:F,edgeArrow:U,core:k},ie=Ti.propertyGroupNames={},j=Ti.propertyGroupKeys=Object.keys(X);j.forEach(function(me){ie[me]=X[me].map(function(pe){return pe.name}),X[me].forEach(function(pe){return pe.groupKey=me})});var K=Ti.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Ti.propertyNames=q.map(function(me){return me.name});for(var se=0;se<q.length;se++){var ne=q[se];q[ne.name]=ne}for(var ge=0;ge<K.length;ge++){var ve=K[ge],Se=q[ve.pointsTo],Te={name:ve.name,alias:!0,pointsTo:Se};q.push(Te),q[ve.name]=Te}})();Ti.getDefaultProperty=function(a){return this.getDefaultProperties()[a]};Ti.getDefaultProperties=function(){var a=this._private;if(a.defaultProperties!=null)return a.defaultProperties;for(var t=ut({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(c,u){for(var d=1;d<=Ti.pieBackgroundN;d++){var h=u.name.replace("{{i}}",d),f=u.value;c[h]=f}return c},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(c,u){for(var d=1;d<=Ti.stripeBackgroundN;d++){var h=u.name.replace("{{i}}",d),f=u.value;c[h]=f}return c},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(c,u){return Ti.arrowPrefixes.forEach(function(d){var h=d+"-"+u.name,f=u.value;c[h]=f}),c},{})),e={},r=0;r<this.properties.length;r++){var n=this.properties[r];if(!n.pointsTo){var s=n.name,o=t[s],l=this.parse(s,o);e[s]=l}}return a.defaultProperties=e,a.defaultProperties};Ti.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};zw={};zw.parse=function(a,t,e,r){var n=this;if(ti(t))return n.parseImplWarn(a,t,e,r);var s=r==="mapping"||r===!0||r===!1||r==null?"dontcare":r,o=e?"t":"f",l=""+t,c=TV(a,l,o,s),u=n.propCache=n.propCache||[],d;return(d=u[c])||(d=u[c]=n.parseImplWarn(a,t,e,r)),(e||r==="mapping")&&(d=po(d),d&&(d.value=po(d.value))),d};zw.parseImplWarn=function(a,t,e,r){var n=this.parseImpl(a,t,e,r);return!n&&t!=null&&cr("The style property `".concat(a,": ").concat(t,"` is invalid")),n&&(n.name==="width"||n.name==="height")&&t==="label"&&cr("The style value of `label` is deprecated for `"+n.name+"`"),n};zw.parseImpl=function(a,t,e,r){var n=this;a=ID(a);var s=n.properties[a],o=t,l=n.types;if(!s||t===void 0)return null;s.alias&&(s=s.pointsTo,a=s.name);var c=at(t);c&&(t=t.trim());var u=s.type;if(!u)return null;if(e&&(t===""||t===null))return{name:a,value:t,bypass:!0,deleteBypass:!0};if(ti(t))return{name:a,value:t,strValue:"fn",mapped:l.fn,bypass:e};var d,h;if(!(!c||r||t.length<7||t[1]!=="a")){if(t.length>=7&&t[0]==="d"&&(d=new RegExp(l.data.regex).exec(t))){if(e)return!1;var f=l.data;return{name:a,value:d,strValue:""+t,mapped:f,field:d[1],bypass:e}}else if(t.length>=10&&t[0]==="m"&&(h=new RegExp(l.mapData.regex).exec(t))){if(e||u.multiple)return!1;var m=l.mapData;if(!(u.color||u.number))return!1;var g=this.parse(a,h[4]);if(!g||g.mapped)return!1;var y=this.parse(a,h[5]);if(!y||y.mapped)return!1;if(g.pfValue===y.pfValue||g.strValue===y.strValue)return cr("`"+a+": "+t+"` is not a valid mapper because the output range is zero; converting to `"+a+": "+g.strValue+"`"),this.parse(a,g.strValue);if(u.color){var v=g.value,E=y.value,C=v[0]===E[0]&&v[1]===E[1]&&v[2]===E[2]&&(v[3]===E[3]||(v[3]==null||v[3]===1)&&(E[3]==null||E[3]===1));if(C)return!1}return{name:a,value:h,strValue:""+t,mapped:m,field:h[1],fieldMin:parseFloat(h[2]),fieldMax:parseFloat(h[3]),valueMin:g.value,valueMax:y.value,bypass:e}}}if(u.multiple&&r!=="multiple"){var _;if(c?_=t.split(/\s+/):Pr(t)?_=t:_=[t],u.evenMultiple&&_.length%2!==0)return null;for(var x=[],P=[],I=[],M="",O=!1,R=0;R<_.length;R++){var F=n.parse(a,_[R],e,"multiple");O=O||at(F.value),x.push(F.value),I.push(F.pfValue!=null?F.pfValue:F.value),P.push(F.units),M+=(R>0?" ":"")+F.strValue}return u.validate&&!u.validate(x,P)?null:u.singleEnum&&O?x.length===1&&at(x[0])?{name:a,value:x[0],strValue:x[0],bypass:e}:null:{name:a,value:x,pfValue:I,strValue:M,bypass:e,units:P}}var $=function(){for(var Te=0;Te<u.enums.length;Te++){var me=u.enums[Te];if(me===t)return{name:a,value:t,strValue:""+t,bypass:e}}return null};if(u.number){var k,N="px";if(u.units&&(k=u.units),u.implicitUnits&&(N=u.implicitUnits),!u.unitless)if(c){var G="px|em"+(u.allowPercent?"|\\%":"");k&&(G=k);var W=t.match("^("+Ii+")("+G+")?$");W&&(t=W[1],k=W[2]||N)}else(!k||u.implicitUnits)&&(k=N);if(t=parseFloat(t),isNaN(t)&&u.enums===void 0)return null;if(isNaN(t)&&u.enums!==void 0)return t=o,$();if(u.integer&&!hve(t)||u.min!==void 0&&(t<u.min||u.strictMin&&t===u.min)||u.max!==void 0&&(t>u.max||u.strictMax&&t===u.max))return null;var Y={name:a,value:t,strValue:""+t+(k||""),units:k,bypass:e};return u.unitless||k!=="px"&&k!=="em"?Y.pfValue=t:Y.pfValue=k==="px"||!k?t:this.getEmSizeInPixels()*t,(k==="ms"||k==="s")&&(Y.pfValue=k==="ms"?t:1e3*t),(k==="deg"||k==="rad")&&(Y.pfValue=k==="rad"?t:Tye(t)),k==="%"&&(Y.pfValue=t/100),Y}else if(u.propList){var U=[],Z=""+t;if(Z!=="none"){for(var q=Z.split(/\s*,\s*|\s+/),X=0;X<q.length;X++){var ie=q[X].trim();n.properties[ie]?U.push(ie):cr("`"+ie+"` is not a valid property name")}if(U.length===0)return null}return{name:a,value:U,strValue:U.length===0?"none":U.join(" "),bypass:e}}else if(u.color){var j=mV(t);return j?{name:a,value:j,pfValue:j,strValue:"rgb("+j[0]+","+j[1]+","+j[2]+")",bypass:e}:null}else if(u.regex||u.regexes){if(u.enums){var K=$();if(K)return K}for(var se=u.regexes?u.regexes:[u.regex],ne=0;ne<se.length;ne++){var ge=new RegExp(se[ne]),ve=ge.exec(t);if(ve)return{name:a,value:u.singleRegexMatchValue?ve[1]:ve,strValue:""+t,bypass:e}}return null}else return u.string?{name:a,value:""+t,strValue:""+t,bypass:e}:u.enums?$():null};Zi=function(t){if(!(this instanceof Zi))return new Zi(t);if(!MD(t)){qr("A style must have a core reference");return}this._private={cy:t,coreStyle:{}},this.length=0,this.resetToDefault()},Cn=Zi.prototype;Cn.instanceString=function(){return"style"};Cn.clear=function(){for(var a=this._private,t=a.cy,e=t.elements(),r=0;r<this.length;r++)this[r]=void 0;return this.length=0,a.contextStyles={},a.propDiffs={},this.cleanElements(e,!0),e.forEach(function(n){var s=n[0]._private;s.styleDirty=!0,s.appliedInitStyle=!1}),this};Cn.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Cn.core=function(a){return this._private.coreStyle[a]||this.getDefaultProperty(a)};Cn.selector=function(a){var t=a==="core"?null:new yc(a),e=this.length++;return this[e]={selector:t,properties:[],mappedProperties:[],index:e},this};Cn.css=function(){var a=this,t=arguments;if(t.length===1)for(var e=t[0],r=0;r<a.properties.length;r++){var n=a.properties[r],s=e[n.name];s===void 0&&(s=e[xw(n.name)]),s!==void 0&&this.cssRule(n.name,s)}else t.length===2&&this.cssRule(t[0],t[1]);return this};Cn.style=Cn.css;Cn.cssRule=function(a,t){var e=this.parse(a,t);if(e){var r=this.length-1;this[r].properties.push(e),this[r].properties[e.name]=e,e.name.match(/pie-(\d+)-background-size/)&&e.value&&(this._private.hasPie=!0),e.name.match(/stripe-(\d+)-background-size/)&&e.value&&(this._private.hasStripe=!0),e.mapped&&this[r].mappedProperties.push(e);var n=!this[r].selector;n&&(this._private.coreStyle[e.name]=e)}return this};Cn.append=function(a){return hV(a)?a.appendToStyle(this):Pr(a)?this.appendFromJson(a):at(a)&&this.appendFromString(a),this};Zi.fromJson=function(a,t){var e=new Zi(a);return e.fromJson(t),e};Zi.fromString=function(a,t){return new Zi(a).fromString(t)};[Ki,hv,YD,mo,$w,qD,Ti,zw].forEach(function(a){ut(Cn,a)});Zi.types=Cn.types;Zi.properties=Cn.properties;Zi.propertyGroups=Cn.propertyGroups;Zi.propertyGroupNames=Cn.propertyGroupNames;Zi.propertyGroupKeys=Cn.propertyGroupKeys;xwe={style:function(t){if(t){var e=this.setStyle(t);e.update()}return this._private.style},setStyle:function(t){var e=this._private;return hV(t)?e.style=t.generateStyle(this):Pr(t)?e.style=Zi.fromJson(this,t):at(t)?e.style=Zi.fromString(this,t):e.style=Zi(this),e.style},updateStyle:function(){this.mutableElements().updateStyle()}},kwe="single",Ku={autolock:function(t){if(t!==void 0)this._private.autolock=!!t;else return this._private.autolock;return this},autoungrabify:function(t){if(t!==void 0)this._private.autoungrabify=!!t;else return this._private.autoungrabify;return this},autounselectify:function(t){if(t!==void 0)this._private.autounselectify=!!t;else return this._private.autounselectify;return this},selectionType:function(t){var e=this._private;if(e.selectionType==null&&(e.selectionType=kwe),t!==void 0)(t==="additive"||t==="single")&&(e.selectionType=t);else return e.selectionType;return this},panningEnabled:function(t){if(t!==void 0)this._private.panningEnabled=!!t;else return this._private.panningEnabled;return this},userPanningEnabled:function(t){if(t!==void 0)this._private.userPanningEnabled=!!t;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(t){if(t!==void 0)this._private.zoomingEnabled=!!t;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(t){if(t!==void 0)this._private.userZoomingEnabled=!!t;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(t){if(t!==void 0)this._private.boxSelectionEnabled=!!t;else return this._private.boxSelectionEnabled;return this},pan:function(){var t=arguments,e=this._private.pan,r,n,s,o,l;switch(t.length){case 0:return e;case 1:if(at(t[0]))return r=t[0],e[r];if(Zt(t[0])){if(!this._private.panningEnabled)return this;s=t[0],o=s.x,l=s.y,We(o)&&(e.x=o),We(l)&&(e.y=l),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;r=t[0],n=t[1],(r==="x"||r==="y")&&We(n)&&(e[r]=n),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(t,e){var r=arguments,n=this._private.pan,s,o,l,c,u;if(!this._private.panningEnabled)return this;switch(r.length){case 1:Zt(t)&&(l=r[0],c=l.x,u=l.y,We(c)&&(n.x+=c),We(u)&&(n.y+=u),this.emit("pan viewport"));break;case 2:s=t,o=e,(s==="x"||s==="y")&&We(o)&&(n[s]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(t,e){var r=this.getFitViewport(t,e);if(r){var n=this._private;n.zoom=r.zoom,n.pan=r.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(t,e){if(We(t)&&e===void 0&&(e=t,t=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var r;if(at(t)){var n=t;t=this.$(n)}else if(mve(t)){var s=t;r={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2},r.w=r.x2-r.x1,r.h=r.y2-r.y1}else Ra(t)||(t=this.mutableElements());if(!(Ra(t)&&t.empty())){r=r||t.boundingBox();var o=this.width(),l=this.height(),c;if(e=We(e)?e:0,!isNaN(o)&&!isNaN(l)&&o>0&&l>0&&!isNaN(r.w)&&!isNaN(r.h)&&r.w>0&&r.h>0){c=Math.min((o-2*e)/r.w,(l-2*e)/r.h),c=c>this._private.maxZoom?this._private.maxZoom:c,c=c<this._private.minZoom?this._private.minZoom:c;var u={x:(o-c*(r.x1+r.x2))/2,y:(l-c*(r.y1+r.y2))/2};return{zoom:c,pan:u}}}}},zoomRange:function(t,e){var r=this._private;if(e==null){var n=t;t=n.min,e=n.max}return We(t)&&We(e)&&t<=e?(r.minZoom=t,r.maxZoom=e):We(t)&&e===void 0&&t<=r.maxZoom?r.minZoom=t:We(e)&&t===void 0&&e>=r.minZoom&&(r.maxZoom=e),this},minZoom:function(t){return t===void 0?this._private.minZoom:this.zoomRange({min:t})},maxZoom:function(t){return t===void 0?this._private.maxZoom:this.zoomRange({max:t})},getZoomedViewport:function(t){var e=this._private,r=e.pan,n=e.zoom,s,o,l=!1;if(e.zoomingEnabled||(l=!0),We(t)?o=t:Zt(t)&&(o=t.level,t.position!=null?s=Pw(t.position,n,r):t.renderedPosition!=null&&(s=t.renderedPosition),s!=null&&!e.panningEnabled&&(l=!0)),o=o>e.maxZoom?e.maxZoom:o,o=o<e.minZoom?e.minZoom:o,l||!We(o)||o===n||s!=null&&(!We(s.x)||!We(s.y)))return null;if(s!=null){var c=r,u=n,d=o,h={x:-d/u*(s.x-c.x)+s.x,y:-d/u*(s.y-c.y)+s.y};return{zoomed:!0,panned:!0,zoom:d,pan:h}}else return{zoomed:!0,panned:!1,zoom:o,pan:r}},zoom:function(t){if(t===void 0)return this._private.zoom;var e=this.getZoomedViewport(t),r=this._private;return e==null||!e.zoomed?this:(r.zoom=e.zoom,e.panned&&(r.pan.x=e.pan.x,r.pan.y=e.pan.y),this.emit("zoom"+(e.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(t){var e=this._private,r=!0,n=!0,s=[],o=!1,l=!1;if(!t)return this;if(We(t.zoom)||(r=!1),Zt(t.pan)||(n=!1),!r&&!n)return this;if(r){var c=t.zoom;c<e.minZoom||c>e.maxZoom||!e.zoomingEnabled?o=!0:(e.zoom=c,s.push("zoom"))}if(n&&(!o||!t.cancelOnFailedZoom)&&e.panningEnabled){var u=t.pan;We(u.x)&&(e.pan.x=u.x,l=!1),We(u.y)&&(e.pan.y=u.y,l=!1),l||s.push("pan")}return s.length>0&&(s.push("viewport"),this.emit(s.join(" ")),this.notify("viewport")),this},center:function(t){var e=this.getCenterPan(t);return e&&(this._private.pan=e,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(t,e){if(this._private.panningEnabled){if(at(t)){var r=t;t=this.mutableElements().filter(r)}else Ra(t)||(t=this.mutableElements());if(t.length!==0){var n=t.boundingBox(),s=this.width(),o=this.height();e=e===void 0?this._private.zoom:e;var l={x:(s-e*(n.x1+n.x2))/2,y:(o-e*(n.y1+n.y2))/2};return l}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var t=this._private,e=t.container,r=this;return t.sizeCache=t.sizeCache||(e?(function(){var n=r.window().getComputedStyle(e),s=function(l){return parseFloat(n.getPropertyValue(l))};return{width:e.clientWidth-s("padding-left")-s("padding-right"),height:e.clientHeight-s("padding-top")-s("padding-bottom")}})():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var t=this._private.pan,e=this._private.zoom,r=this.renderedExtent(),n={x1:(r.x1-t.x)/e,x2:(r.x2-t.x)/e,y1:(r.y1-t.y)/e,y2:(r.y2-t.y)/e};return n.w=n.x2-n.x1,n.h=n.y2-n.y1,n},renderedExtent:function(){var t=this.width(),e=this.height();return{x1:0,y1:0,x2:t,y2:e,w:t,h:e}},multiClickDebounceTime:function(t){if(t)this._private.multiClickDebounceTime=t;else return this._private.multiClickDebounceTime;return this}};Ku.centre=Ku.center;Ku.autolockNodes=Ku.autolock;Ku.autoungrabifyNodes=Ku.autoungrabify;tv={data:lr.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:lr.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:lr.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:lr.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};tv.attr=tv.data;tv.removeAttr=tv.removeData;rv=function(t){var e=this;t=ut({},t);var r=t.container;r&&!fw(r)&&fw(r[0])&&(r=r[0]);var n=r?r._cyreg:null;n=n||{},n&&n.cy&&(n.cy.destroy(),n={});var s=n.readies=n.readies||[];r&&(r._cyreg=n),n.cy=e;var o=Mi!==void 0&&r!==void 0&&!t.headless,l=t;l.layout=ut({name:o?"grid":"null"},l.layout),l.renderer=ut({name:o?"canvas":"null"},l.renderer);var c=function(g,y,v){return y!==void 0?y:v!==void 0?v:g},u=this._private={container:r,ready:!1,options:l,elements:new sn(this),listeners:[],aniEles:new sn(this),data:l.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:c(!0,l.zoomingEnabled),userZoomingEnabled:c(!0,l.userZoomingEnabled),panningEnabled:c(!0,l.panningEnabled),userPanningEnabled:c(!0,l.userPanningEnabled),boxSelectionEnabled:c(!0,l.boxSelectionEnabled),autolock:c(!1,l.autolock,l.autolockNodes),autoungrabify:c(!1,l.autoungrabify,l.autoungrabifyNodes),autounselectify:c(!1,l.autounselectify),styleEnabled:l.styleEnabled===void 0?o:l.styleEnabled,zoom:We(l.zoom)?l.zoom:1,pan:{x:Zt(l.pan)&&We(l.pan.x)?l.pan.x:0,y:Zt(l.pan)&&We(l.pan.y)?l.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:c(250,l.multiClickDebounceTime)};this.createEmitter(),this.selectionType(l.selectionType),this.zoomRange({min:l.minZoom,max:l.maxZoom});var d=function(g,y){var v=g.some(gve);if(v)return _f.all(g).then(y);y(g)};u.styleEnabled&&e.setStyle([]);var h=ut({},l,l.renderer);e.initRenderer(h);var f=function(g,y,v){e.notifications(!1);var E=e.mutableElements();E.length>0&&E.remove(),g!=null&&(Zt(g)||Pr(g))&&e.add(g),e.one("layoutready",function(_){e.notifications(!0),e.emit(_),e.one("load",y),e.emitAndNotify("load")}).one("layoutstop",function(){e.one("done",v),e.emit("done")});var C=ut({},e._private.options.layout);C.eles=e.elements(),e.layout(C).run()};d([l.style,l.elements],function(m){var g=m[0],y=m[1];u.styleEnabled&&e.style().append(g),f(y,function(){e.startAnimationLoop(),u.ready=!0,ti(l.ready)&&e.on("ready",l.ready);for(var v=0;v<s.length;v++){var E=s[v];e.on("ready",E)}n&&(n.readies=[]),e.emit("ready")},l.done)})},ww=rv.prototype;ut(ww,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(t){return this.isReady()?this.emitter().emit("ready",[],t):this.on("ready",t),this},destroy:function(){var t=this;if(!t.destroyed())return t.stopAnimationLoop(),t.destroyRenderer(),this.emit("destroy"),t._private.destroyed=!0,t},hasElementWithId:function(t){return this._private.elements.hasElementWithId(t)},getElementById:function(t){return this._private.elements.getElementById(t)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(t){return this._private.elements.merge(t),this},removeFromPool:function(t){return this._private.elements.unmerge(t),this},container:function(){return this._private.container||null},window:function(){var t=this._private.container;if(t==null)return Mi;var e=this._private.container.ownerDocument;return e===void 0||e==null?Mi:e.defaultView||Mi},mount:function(t){if(t!=null){var e=this,r=e._private,n=r.options;return!fw(t)&&fw(t[0])&&(t=t[0]),e.stopAnimationLoop(),e.destroyRenderer(),r.container=t,r.styleEnabled=!0,e.invalidateSize(),e.initRenderer(ut({},n,n.renderer,{name:n.renderer.name==="null"?"canvas":n.renderer.name})),e.startAnimationLoop(),e.style(n.style),e.emit("mount"),e}},unmount:function(){var t=this;return t.stopAnimationLoop(),t.destroyRenderer(),t.initRenderer({name:"null"}),t.emit("unmount"),t},options:function(){return po(this._private.options)},json:function(t){var e=this,r=e._private,n=e.mutableElements(),s=function(x){return e.getElementById(x.id())};if(Zt(t)){if(e.startBatch(),t.elements){var o={},l=function(x,P){for(var I=[],M=[],O=0;O<x.length;O++){var R=x[O];if(!R.data.id){cr("cy.json() cannot handle elements without an ID attribute");continue}var F=""+R.data.id,$=e.getElementById(F);o[F]=!0,$.length!==0?M.push({ele:$,json:R}):(P&&(R.group=P),I.push(R))}e.add(I);for(var k=0;k<M.length;k++){var N=M[k],G=N.ele,W=N.json;G.json(W)}};if(Pr(t.elements))l(t.elements);else for(var c=["nodes","edges"],u=0;u<c.length;u++){var d=c[u],h=t.elements[d];Pr(h)&&l(h,d)}var f=e.collection();n.filter(function(_){return!o[_.id()]}).forEach(function(_){_.isParent()?f.merge(_):_.remove()}),f.forEach(function(_){return _.children().move({parent:null})}),f.forEach(function(_){return s(_).remove()})}t.style&&e.style(t.style),t.zoom!=null&&t.zoom!==r.zoom&&e.zoom(t.zoom),t.pan&&(t.pan.x!==r.pan.x||t.pan.y!==r.pan.y)&&e.pan(t.pan),t.data&&e.data(t.data);for(var m=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],g=0;g<m.length;g++){var y=m[g];t[y]!=null&&e[y](t[y])}return e.endBatch(),this}else{var v=!!t,E={};v?E.elements=this.elements().map(function(_){return _.json()}):(E.elements={},n.forEach(function(_){var x=_.group();E.elements[x]||(E.elements[x]=[]),E.elements[x].push(_.json())})),this._private.styleEnabled&&(E.style=e.style().json()),E.data=po(e.data());var C=r.options;return E.zoomingEnabled=r.zoomingEnabled,E.userZoomingEnabled=r.userZoomingEnabled,E.zoom=r.zoom,E.minZoom=r.minZoom,E.maxZoom=r.maxZoom,E.panningEnabled=r.panningEnabled,E.userPanningEnabled=r.userPanningEnabled,E.pan=po(r.pan),E.boxSelectionEnabled=r.boxSelectionEnabled,E.renderer=po(C.renderer),E.hideEdgesOnViewport=C.hideEdgesOnViewport,E.textureOnViewport=C.textureOnViewport,E.wheelSensitivity=C.wheelSensitivity,E.motionBlur=C.motionBlur,E.multiClickDebounceTime=C.multiClickDebounceTime,E}}});ww.$id=ww.getElementById;[gwe,Ewe,h5,bD,ow,Cwe,wD,lw,xwe,Ku,tv].forEach(function(a){ut(ww,a)});Dwe={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}},Pwe={maximal:!1,acyclic:!1},lf=function(t){return t.scratch("breadthfirst")},OG=function(t,e){return t.scratch("breadthfirst",e)};f5.prototype.run=function(){var a=this.options,t=a.cy,e=a.eles,r=e.nodes().filter(function(Ce){return Ce.isChildless()}),n=e,s=a.directed,o=a.acyclic||a.maximal||a.maximalAdjustments>0,l=!!a.boundingBox,c=Un(l?a.boundingBox:structuredClone(t.extent())),u;if(Ra(a.roots))u=a.roots;else if(Pr(a.roots)){for(var d=[],h=0;h<a.roots.length;h++){var f=a.roots[h],m=t.getElementById(f);d.push(m)}u=t.collection(d)}else if(at(a.roots))u=t.$(a.roots);else if(s)u=r.roots();else{var g=e.components();u=t.collection();for(var y=function(){var le=g[v],we=le.maxDegree(!1),Le=le.filter(function(Me){return Me.degree(!1)===we});u=u.add(Le)},v=0;v<g.length;v++)y()}var E=[],C={},_=function(le,we){E[we]==null&&(E[we]=[]);var Le=E[we].length;E[we].push(le),OG(le,{index:Le,depth:we})},x=function(le,we){var Le=lf(le),Me=Le.depth,Ne=Le.index;E[Me][Ne]=null,le.isChildless()&&_(le,we)};n.bfs({roots:u,directed:a.directed,visit:function(le,we,Le,Me,Ne){var Ge=le[0],Ye=Ge.id();Ge.isChildless()&&_(Ge,Ne),C[Ye]=!0}});for(var P=[],I=0;I<r.length;I++){var M=r[I];C[M.id()]||P.push(M)}var O=function(le){for(var we=E[le],Le=0;Le<we.length;Le++){var Me=we[Le];if(Me==null){we.splice(Le,1),Le--;continue}OG(Me,{depth:le,index:Le})}},R=function(le,we){for(var Le=lf(le),Me=le.incomers().filter(function(et){return et.isNode()&&e.has(et)}),Ne=-1,Ge=le.id(),Ye=0;Ye<Me.length;Ye++){var ft=Me[Ye],ct=lf(ft);Ne=Math.max(Ne,ct.depth)}if(Le.depth<=Ne){if(!a.acyclic&&we[Ge])return null;var Ve=Ne+1;return x(le,Ve),we[Ge]=Ve,!0}return!1};if(s&&o){var F=[],$={},k=function(le){return F.push(le)},N=function(){return F.shift()};for(r.forEach(function(Ce){return F.push(Ce)});F.length>0;){var G=N(),W=R(G,$);if(W)G.outgoers().filter(function(Ce){return Ce.isNode()&&e.has(Ce)}).forEach(k);else if(W===null){cr("Detected double maximal shift for node `"+G.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var Y=0;if(a.avoidOverlap)for(var U=0;U<r.length;U++){var Z=r[U],q=Z.layoutDimensions(a),X=q.w,ie=q.h;Y=Math.max(Y,X,ie)}var j={},K=function(le){if(j[le.id()])return j[le.id()];for(var we=lf(le).depth,Le=le.neighborhood(),Me=0,Ne=0,Ge=0;Ge<Le.length;Ge++){var Ye=Le[Ge];if(!(Ye.isEdge()||Ye.isParent()||!r.has(Ye))){var ft=lf(Ye);if(ft!=null){var ct=ft.index,Ve=ft.depth;if(!(ct==null||Ve==null)){var et=E[Ve].length;Ve<we&&(Me+=ct/et,Ne++)}}}}return Ne=Math.max(1,Ne),Me=Me/Ne,Ne===0&&(Me=0),j[le.id()]=Me,Me},se=function(le,we){var Le=K(le),Me=K(we),Ne=Le-Me;return Ne===0?pV(le.id(),we.id()):Ne};a.depthSort!==void 0&&(se=a.depthSort);for(var ne=E.length,ge=0;ge<ne;ge++)E[ge].sort(se),O(ge);for(var ve=[],Se=0;Se<P.length;Se++)ve.push(P[Se]);var Te=function(){for(var le=0;le<ne;le++)O(le)};ve.length&&(E.unshift(ve),ne=E.length,Te());for(var me=0,pe=0;pe<ne;pe++)me=Math.max(E[pe].length,me);var B={x:c.x1+c.w/2,y:c.y1+c.h/2},oe=r.reduce(function(Ce,le){return(function(we){return{w:Ce.w===-1?we.w:(Ce.w+we.w)/2,h:Ce.h===-1?we.h:(Ce.h+we.h)/2}})(le.boundingBox({includeLabels:a.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),he=Math.max(ne===1?0:l?(c.h-a.padding*2-oe.h)/(ne-1):(c.h-a.padding*2-oe.h)/(ne+1),Y),te=E.reduce(function(Ce,le){return Math.max(Ce,le.length)},0),re=function(le){var we=lf(le),Le=we.depth,Me=we.index;if(a.circle){var Ne=Math.min(c.w/2/ne,c.h/2/ne);Ne=Math.max(Ne,Y);var Ge=Ne*Le+Ne-(ne>0&&E[0].length<=3?Ne/2:0),Ye=2*Math.PI/E[Le].length*Me;return Le===0&&E[0].length===1&&(Ge=1),{x:B.x+Ge*Math.cos(Ye),y:B.y+Ge*Math.sin(Ye)}}else{var ft=E[Le].length,ct=Math.max(ft===1?0:l?(c.w-a.padding*2-oe.w)/((a.grid?te:ft)-1):(c.w-a.padding*2-oe.w)/((a.grid?te:ft)+1),Y),Ve={x:B.x+(Me+1-(ft+1)/2)*ct,y:B.y+(Le+1-(ne+1)/2)*he};return Ve}},ce={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(ce).indexOf(a.direction)===-1&&qr("Invalid direction '".concat(a.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(ce).join(", ")));var Ee=function(le){return Uve(re(le),c,ce[a.direction])};return e.nodes().layoutPositions(this,a,Ee),this};Lwe={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};p5.prototype.run=function(){var a=this.options,t=a,e=a.cy,r=t.eles,n=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,s=r.nodes().not(":parent");t.sort&&(s=s.sort(t.sort));for(var o=Un(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},c=t.sweep===void 0?2*Math.PI-2*Math.PI/s.length:t.sweep,u=c/Math.max(1,s.length-1),d,h=0,f=0;f<s.length;f++){var m=s[f],g=m.layoutDimensions(t),y=g.w,v=g.h;h=Math.max(h,y,v)}if(We(t.radius)?d=t.radius:s.length<=1?d=0:d=Math.min(o.h,o.w)/2-h,s.length>1&&t.avoidOverlap){h*=1.75;var E=Math.cos(u)-Math.cos(0),C=Math.sin(u)-Math.sin(0),_=Math.sqrt(h*h/(E*E+C*C));d=Math.max(_,d)}var x=function(I,M){var O=t.startAngle+M*u*(n?1:-1),R=d*Math.cos(O),F=d*Math.sin(O),$={x:l.x+R,y:l.y+F};return $};return r.nodes().layoutPositions(this,t,x),this};Mwe={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(t){return t.degree()},levelWidth:function(t){return t.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};m5.prototype.run=function(){for(var a=this.options,t=a,e=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,r=a.cy,n=t.eles,s=n.nodes().not(":parent"),o=Un(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},c=[],u=0,d=0;d<s.length;d++){var h=s[d],f=void 0;f=t.concentric(h),c.push({value:f,node:h}),h._private.scratch.concentric=f}s.updateStyle();for(var m=0;m<s.length;m++){var g=s[m],y=g.layoutDimensions(t);u=Math.max(u,y.w,y.h)}c.sort(function(he,te){return te.value-he.value});for(var v=t.levelWidth(s),E=[[]],C=E[0],_=0;_<c.length;_++){var x=c[_];if(C.length>0){var P=Math.abs(C[0].value-x.value);P>=v&&(C=[],E.push(C))}C.push(x)}var I=u+t.minNodeSpacing;if(!t.avoidOverlap){var M=E.length>0&&E[0].length>1,O=Math.min(o.w,o.h)/2-I,R=O/(E.length+M?1:0);I=Math.min(I,R)}for(var F=0,$=0;$<E.length;$++){var k=E[$],N=t.sweep===void 0?2*Math.PI-2*Math.PI/k.length:t.sweep,G=k.dTheta=N/Math.max(1,k.length-1);if(k.length>1&&t.avoidOverlap){var W=Math.cos(G)-Math.cos(0),Y=Math.sin(G)-Math.sin(0),U=Math.sqrt(I*I/(W*W+Y*Y));F=Math.max(U,F)}k.r=F,F+=I}if(t.equidistant){for(var Z=0,q=0,X=0;X<E.length;X++){var ie=E[X],j=ie.r-q;Z=Math.max(Z,j)}q=0;for(var K=0;K<E.length;K++){var se=E[K];K===0&&(q=se.r),se.r=q,q+=Z}}for(var ne={},ge=0;ge<E.length;ge++)for(var ve=E[ge],Se=ve.dTheta,Te=ve.r,me=0;me<ve.length;me++){var pe=ve[me],B=t.startAngle+(e?1:-1)*Se*me,oe={x:l.x+Te*Math.cos(B),y:l.y+Te*Math.sin(B)};ne[pe.node.id()]=oe}return n.nodes().layoutPositions(this,t,function(he){var te=he.id();return ne[te]}),this};Iwe={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(t,e){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(t){return 2048},nodeOverlap:4,idealEdgeLength:function(t){return 32},edgeElasticity:function(t){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};Hw.prototype.run=function(){var a=this.options,t=a.cy,e=this;e.stopped=!1,(a.animate===!0||a.animate===!1)&&e.emit({type:"layoutstart",layout:e}),a.debug===!0?tD=!0:tD=!1;var r=Awe(t,e,a);tD&&Fwe(r),a.randomize&&Rwe(r);var n=rl(),s=function(){Nwe(r,t,a),a.fit===!0&&t.fit(a.padding)},o=function(f){return!(e.stopped||f>=a.numIter||(Bwe(r,a),r.temperature=r.temperature*a.coolingFactor,r.temperature<a.minTemp))},l=function(){if(a.animate===!0||a.animate===!1)s(),e.one("layoutstop",a.stop),e.emit({type:"layoutstop",layout:e});else{var f=a.eles.nodes(),m=v5(r,a,f);f.layoutPositions(e,a,m)}},c=0,u=!0;if(a.animate===!0){var d=function(){for(var f=0;u&&f<a.refresh;)u=o(c),c++,f++;if(!u)RG(r,a),l();else{var m=rl();m-n>=a.animationThreshold&&s(),pw(d)}};d()}else{for(;u;)u=o(c),c++;RG(r,a),l()}return this};Hw.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};Hw.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};Awe=function(t,e,r){for(var n=r.eles.edges(),s=r.eles.nodes(),o=Un(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),l={isCompound:t.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:s.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:n.size(),temperature:r.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},c=r.eles.components(),u={},d=0;d<c.length;d++)for(var h=c[d],f=0;f<h.length;f++){var m=h[f];u[m.id()]=d}for(var d=0;d<l.nodeSize;d++){var g=s[d],y=g.layoutDimensions(r),v={};v.isLocked=g.locked(),v.id=g.data("id"),v.parentId=g.data("parent"),v.cmptId=u[g.id()],v.children=[],v.positionX=g.position("x"),v.positionY=g.position("y"),v.offsetX=0,v.offsetY=0,v.height=y.w,v.width=y.h,v.maxX=v.positionX+v.width/2,v.minX=v.positionX-v.width/2,v.maxY=v.positionY+v.height/2,v.minY=v.positionY-v.height/2,v.padLeft=parseFloat(g.style("padding")),v.padRight=parseFloat(g.style("padding")),v.padTop=parseFloat(g.style("padding")),v.padBottom=parseFloat(g.style("padding")),v.nodeRepulsion=ti(r.nodeRepulsion)?r.nodeRepulsion(g):r.nodeRepulsion,l.layoutNodes.push(v),l.idToIndex[v.id]=d}for(var E=[],C=0,_=-1,x=[],d=0;d<l.nodeSize;d++){var g=l.layoutNodes[d],P=g.parentId;P!=null?l.layoutNodes[l.idToIndex[P]].children.push(g.id):(E[++_]=g.id,x.push(g.id))}for(l.graphSet.push(x);C<=_;){var I=E[C++],M=l.idToIndex[I],m=l.layoutNodes[M],O=m.children;if(O.length>0){l.graphSet.push(O);for(var d=0;d<O.length;d++)E[++_]=O[d]}}for(var d=0;d<l.graphSet.length;d++)for(var R=l.graphSet[d],f=0;f<R.length;f++){var F=l.idToIndex[R[f]];l.indexToGraph[F]=d}for(var d=0;d<l.edgeSize;d++){var $=n[d],k={};k.id=$.data("id"),k.sourceId=$.data("source"),k.targetId=$.data("target");var N=ti(r.idealEdgeLength)?r.idealEdgeLength($):r.idealEdgeLength,G=ti(r.edgeElasticity)?r.edgeElasticity($):r.edgeElasticity,W=l.idToIndex[k.sourceId],Y=l.idToIndex[k.targetId],U=l.indexToGraph[W],Z=l.indexToGraph[Y];if(U!=Z){for(var q=Owe(k.sourceId,k.targetId,l),X=l.graphSet[q],ie=0,v=l.layoutNodes[W];X.indexOf(v.id)===-1;)v=l.layoutNodes[l.idToIndex[v.parentId]],ie++;for(v=l.layoutNodes[Y];X.indexOf(v.id)===-1;)v=l.layoutNodes[l.idToIndex[v.parentId]],ie++;N*=ie*r.nestingFactor}k.idealLength=N,k.elasticity=G,l.layoutEdges.push(k)}return l},Owe=function(t,e,r){var n=g5(t,e,0,r);return 2>n.count?0:n.graph},g5=function(t,e,r,n){var s=n.graphSet[r];if(-1<s.indexOf(t)&&-1<s.indexOf(e))return{count:2,graph:r};for(var o=0,l=0;l<s.length;l++){var c=s[l],u=n.idToIndex[c],d=n.layoutNodes[u].children;if(d.length!==0){var h=n.indexToGraph[n.idToIndex[d[0]]],f=g5(t,e,h,n);if(f.count!==0)if(f.count===1){if(o++,o===2)break}else return f}}return{count:o,graph:r}},Rwe=function(t,e){for(var r=t.clientWidth,n=t.clientHeight,s=0;s<t.nodeSize;s++){var o=t.layoutNodes[s];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*r,o.positionY=Math.random()*n)}},v5=function(t,e,r){var n=t.boundingBox,s={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return e.boundingBox&&(r.forEach(function(o){var l=t.layoutNodes[t.idToIndex[o.data("id")]];s.x1=Math.min(s.x1,l.positionX),s.x2=Math.max(s.x2,l.positionX),s.y1=Math.min(s.y1,l.positionY),s.y2=Math.max(s.y2,l.positionY)}),s.w=s.x2-s.x1,s.h=s.y2-s.y1),function(o,l){var c=t.layoutNodes[t.idToIndex[o.data("id")]];if(e.boundingBox){var u=s.w===0?.5:(c.positionX-s.x1)/s.w,d=s.h===0?.5:(c.positionY-s.y1)/s.h;return{x:n.x1+u*n.w,y:n.y1+d*n.h}}else return{x:c.positionX,y:c.positionY}}},Nwe=function(t,e,r){var n=r.layout,s=r.eles.nodes(),o=v5(t,r,s);s.positions(o),t.ready!==!0&&(t.ready=!0,n.one("layoutready",r.ready),n.emit({type:"layoutready",layout:this}))},Bwe=function(t,e,r){$we(t,e),Gwe(t),Vwe(t,e),Wwe(t),Uwe(t)},$we=function(t,e){for(var r=0;r<t.graphSet.length;r++)for(var n=t.graphSet[r],s=n.length,o=0;o<s;o++)for(var l=t.layoutNodes[t.idToIndex[n[o]]],c=o+1;c<s;c++){var u=t.layoutNodes[t.idToIndex[n[c]]];zwe(l,u,t,e)}},FG=function(t){return-1+2*t*Math.random()},zwe=function(t,e,r,n){var s=t.cmptId,o=e.cmptId;if(!(s!==o&&!r.isCompound)){var l=e.positionX-t.positionX,c=e.positionY-t.positionY,u=1;l===0&&c===0&&(l=FG(u),c=FG(u));var d=Hwe(t,e,l,c);if(d>0)var h=n.nodeOverlap*d,f=Math.sqrt(l*l+c*c),m=h*l/f,g=h*c/f;else var y=Ew(t,l,c),v=Ew(e,-1*l,-1*c),E=v.x-y.x,C=v.y-y.y,_=E*E+C*C,f=Math.sqrt(_),h=(t.nodeRepulsion+e.nodeRepulsion)/_,m=h*E/f,g=h*C/f;t.isLocked||(t.offsetX-=m,t.offsetY-=g),e.isLocked||(e.offsetX+=m,e.offsetY+=g)}},Hwe=function(t,e,r,n){if(r>0)var s=t.maxX-e.minX;else var s=e.maxX-t.minX;if(n>0)var o=t.maxY-e.minY;else var o=e.maxY-t.minY;return s>=0&&o>=0?Math.sqrt(s*s+o*o):0},Ew=function(t,e,r){var n=t.positionX,s=t.positionY,o=t.height||1,l=t.width||1,c=r/e,u=o/l,d={};return e===0&&0<r||e===0&&0>r?(d.x=n,d.y=s+o/2,d):0<e&&-1*u<=c&&c<=u?(d.x=n+l/2,d.y=s+l*r/2/e,d):0>e&&-1*u<=c&&c<=u?(d.x=n-l/2,d.y=s-l*r/2/e,d):0<r&&(c<=-1*u||c>=u)?(d.x=n+o*e/2/r,d.y=s+o/2,d):(0>r&&(c<=-1*u||c>=u)&&(d.x=n-o*e/2/r,d.y=s-o/2),d)},Gwe=function(t,e){for(var r=0;r<t.edgeSize;r++){var n=t.layoutEdges[r],s=t.idToIndex[n.sourceId],o=t.layoutNodes[s],l=t.idToIndex[n.targetId],c=t.layoutNodes[l],u=c.positionX-o.positionX,d=c.positionY-o.positionY;if(!(u===0&&d===0)){var h=Ew(o,u,d),f=Ew(c,-1*u,-1*d),m=f.x-h.x,g=f.y-h.y,y=Math.sqrt(m*m+g*g),v=Math.pow(n.idealLength-y,2)/n.elasticity;if(y!==0)var E=v*m/y,C=v*g/y;else var E=0,C=0;o.isLocked||(o.offsetX+=E,o.offsetY+=C),c.isLocked||(c.offsetX-=E,c.offsetY-=C)}}},Vwe=function(t,e){if(e.gravity!==0)for(var r=1,n=0;n<t.graphSet.length;n++){var s=t.graphSet[n],o=s.length;if(n===0)var l=t.clientHeight/2,c=t.clientWidth/2;else var u=t.layoutNodes[t.idToIndex[s[0]]],d=t.layoutNodes[t.idToIndex[u.parentId]],l=d.positionX,c=d.positionY;for(var h=0;h<o;h++){var f=t.layoutNodes[t.idToIndex[s[h]]];if(!f.isLocked){var m=l-f.positionX,g=c-f.positionY,y=Math.sqrt(m*m+g*g);if(y>r){var v=e.gravity*m/y,E=e.gravity*g/y;f.offsetX+=v,f.offsetY+=E}}}}},Wwe=function(t,e){var r=[],n=0,s=-1;for(r.push.apply(r,t.graphSet[0]),s+=t.graphSet[0].length;n<=s;){var o=r[n++],l=t.idToIndex[o],c=t.layoutNodes[l],u=c.children;if(0<u.length&&!c.isLocked){for(var d=c.offsetX,h=c.offsetY,f=0;f<u.length;f++){var m=t.layoutNodes[t.idToIndex[u[f]]];m.offsetX+=d,m.offsetY+=h,r[++s]=u[f]}c.offsetX=0,c.offsetY=0}}},Uwe=function(t,e){for(var r=0;r<t.nodeSize;r++){var n=t.layoutNodes[r];0<n.children.length&&(n.maxX=void 0,n.minX=void 0,n.maxY=void 0,n.minY=void 0)}for(var r=0;r<t.nodeSize;r++){var n=t.layoutNodes[r];if(!(0<n.children.length||n.isLocked)){var s=jwe(n.offsetX,n.offsetY,t.temperature);n.positionX+=s.x,n.positionY+=s.y,n.offsetX=0,n.offsetY=0,n.minX=n.positionX-n.width,n.maxX=n.positionX+n.width,n.minY=n.positionY-n.height,n.maxY=n.positionY+n.height,y5(n,t)}}for(var r=0;r<t.nodeSize;r++){var n=t.layoutNodes[r];0<n.children.length&&!n.isLocked&&(n.positionX=(n.maxX+n.minX)/2,n.positionY=(n.maxY+n.minY)/2,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY)}},jwe=function(t,e,r){var n=Math.sqrt(t*t+e*e);if(n>r)var s={x:r*t/n,y:r*e/n};else var s={x:t,y:e};return s},y5=function(t,e){var r=t.parentId;if(r!=null){var n=e.layoutNodes[e.idToIndex[r]],s=!1;if((n.maxX==null||t.maxX+n.padRight>n.maxX)&&(n.maxX=t.maxX+n.padRight,s=!0),(n.minX==null||t.minX-n.padLeft<n.minX)&&(n.minX=t.minX-n.padLeft,s=!0),(n.maxY==null||t.maxY+n.padBottom>n.maxY)&&(n.maxY=t.maxY+n.padBottom,s=!0),(n.minY==null||t.minY-n.padTop<n.minY)&&(n.minY=t.minY-n.padTop,s=!0),s)return y5(n,e)}},RG=function(t,e){for(var r=t.layoutNodes,n=[],s=0;s<r.length;s++){var o=r[s],l=o.cmptId,c=n[l]=n[l]||[];c.push(o)}for(var u=0,s=0;s<n.length;s++){var d=n[s];if(d){d.x1=1/0,d.x2=-1/0,d.y1=1/0,d.y2=-1/0;for(var h=0;h<d.length;h++){var f=d[h];d.x1=Math.min(d.x1,f.positionX-f.width/2),d.x2=Math.max(d.x2,f.positionX+f.width/2),d.y1=Math.min(d.y1,f.positionY-f.height/2),d.y2=Math.max(d.y2,f.positionY+f.height/2)}d.w=d.x2-d.x1,d.h=d.y2-d.y1,u+=d.w*d.h}}n.sort(function(C,_){return _.w*_.h-C.w*C.h});for(var m=0,g=0,y=0,v=0,E=Math.sqrt(u)*t.clientWidth/t.clientHeight,s=0;s<n.length;s++){var d=n[s];if(d){for(var h=0;h<d.length;h++){var f=d[h];f.isLocked||(f.positionX+=m-d.x1,f.positionY+=g-d.y1)}m+=d.w+e.componentSpacing,y+=d.w+e.componentSpacing,v=Math.max(v,d.h),y>E&&(g+=v+e.componentSpacing,m=0,y=0,v=0)}}},Ywe={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(t){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};b5.prototype.run=function(){var a=this.options,t=a,e=a.cy,r=t.eles,n=r.nodes().not(":parent");t.sort&&(n=n.sort(t.sort));var s=Un(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()});if(s.h===0||s.w===0)r.nodes().layoutPositions(this,t,function(K){return{x:s.x1,y:s.y1}});else{var o=n.size(),l=Math.sqrt(o*s.h/s.w),c=Math.round(l),u=Math.round(s.w/s.h*l),d=function(se){if(se==null)return Math.min(c,u);var ne=Math.min(c,u);ne==c?c=se:u=se},h=function(se){if(se==null)return Math.max(c,u);var ne=Math.max(c,u);ne==c?c=se:u=se},f=t.rows,m=t.cols!=null?t.cols:t.columns;if(f!=null&&m!=null)c=f,u=m;else if(f!=null&&m==null)c=f,u=Math.ceil(o/c);else if(f==null&&m!=null)u=m,c=Math.ceil(o/u);else if(u*c>o){var g=d(),y=h();(g-1)*y>=o?d(g-1):(y-1)*g>=o&&h(y-1)}else for(;u*c<o;){var v=d(),E=h();(E+1)*v>=o?h(E+1):d(v+1)}var C=s.w/u,_=s.h/c;if(t.condense&&(C=0,_=0),t.avoidOverlap)for(var x=0;x<n.length;x++){var P=n[x],I=P._private.position;(I.x==null||I.y==null)&&(I.x=0,I.y=0);var M=P.layoutDimensions(t),O=t.avoidOverlapPadding,R=M.w+O,F=M.h+O;C=Math.max(C,R),_=Math.max(_,F)}for(var $={},k=function(se,ne){return!!$["c-"+se+"-"+ne]},N=function(se,ne){$["c-"+se+"-"+ne]=!0},G=0,W=0,Y=function(){W++,W>=u&&(W=0,G++)},U={},Z=0;Z<n.length;Z++){var q=n[Z],X=t.position(q);if(X&&(X.row!==void 0||X.col!==void 0)){var ie={row:X.row,col:X.col};if(ie.col===void 0)for(ie.col=0;k(ie.row,ie.col);)ie.col++;else if(ie.row===void 0)for(ie.row=0;k(ie.row,ie.col);)ie.row++;U[q.id()]=ie,N(ie.row,ie.col)}}var j=function(se,ne){var ge,ve;if(se.locked()||se.isParent())return!1;var Se=U[se.id()];if(Se)ge=Se.col*C+C/2+s.x1,ve=Se.row*_+_/2+s.y1;else{for(;k(G,W);)Y();ge=W*C+C/2+s.x1,ve=G*_+_/2+s.y1,N(G,W),Y()}return{x:ge,y:ve}};n.layoutPositions(this,t,j)}return this};qwe={ready:function(){},stop:function(){}};ZD.prototype.run=function(){var a=this.options,t=a.eles,e=this;return a.cy,e.emit("layoutstart"),t.nodes().positions(function(){return{x:0,y:0}}),e.one("layoutready",a.ready),e.emit("layoutready"),e.one("layoutstop",a.stop),e.emit("layoutstop"),this};ZD.prototype.stop=function(){return this};Zwe={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};w5.prototype.run=function(){var a=this.options,t=a.eles,e=t.nodes(),r=ti(a.positions);function n(s){if(a.positions==null)return vye(s.position());if(r)return a.positions(s);var o=a.positions[s._private.data.id];return o==null?null:o}return e.layoutPositions(this,a,function(s,o){var l=n(s);return s.locked()||l==null?!1:l}),this};Kwe={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};E5.prototype.run=function(){var a=this.options,t=a.cy,e=a.eles,r=Un(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),n=function(o,l){return{x:r.x1+Math.round(Math.random()*r.w),y:r.y1+Math.round(Math.random()*r.h)}};return e.nodes().layoutPositions(this,a,n),this};Xwe=[{name:"breadthfirst",impl:f5},{name:"circle",impl:p5},{name:"concentric",impl:m5},{name:"cose",impl:Hw},{name:"grid",impl:b5},{name:"null",impl:ZD},{name:"preset",impl:w5},{name:"random",impl:E5}];NG=function(){},BG=function(){throw new Error("A headless instance can not render images")};T5.prototype={recalculateRenderedStyle:NG,notify:function(){this.notifications++},init:NG,isHeadless:function(){return!0},png:BG,jpg:BG};KD={};KD.arrowShapeWidth=.3;KD.registerArrowShapes=function(){var a=this.arrowShapes={},t=this,e=function(u,d,h,f,m,g,y){var v=m.x-h/2-y,E=m.x+h/2+y,C=m.y-h/2-y,_=m.y+h/2+y,x=v<=u&&u<=E&&C<=d&&d<=_;return x},r=function(u,d,h,f,m){var g=u*Math.cos(f)-d*Math.sin(f),y=u*Math.sin(f)+d*Math.cos(f),v=g*h,E=y*h,C=v+m.x,_=E+m.y;return{x:C,y:_}},n=function(u,d,h,f){for(var m=[],g=0;g<u.length;g+=2){var y=u[g],v=u[g+1];m.push(r(y,v,d,h,f))}return m},s=function(u){for(var d=[],h=0;h<u.length;h++){var f=u[h];d.push(f.x,f.y)}return d},o=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},l=function(u,d){at(d)&&(d=a[d]),a[u]=ut({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(f,m,g,y,v,E){var C=s(n(this.points,g+2*E,y,v)),_=fa(f,m,C);return _},roughCollide:e,draw:function(f,m,g,y){var v=n(this.points,m,g,y);t.arrowShapeImpl("polygon")(f,v)},spacing:function(f){return 0},gap:o},d)};l("none",{collide:mw,roughCollide:mw,draw:FD,spacing:Jz,gap:Jz}),l("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),l("arrow","triangle"),l("triangle-backcurve",{points:a.triangle.points,controlPoint:[0,-.15],roughCollide:e,draw:function(u,d,h,f,m){var g=n(this.points,d,h,f),y=this.controlPoint,v=r(y[0],y[1],d,h,f);t.arrowShapeImpl(this.name)(u,g,v)},gap:function(u){return o(u)*.8}}),l("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,d,h,f,m,g,y){var v=s(n(this.points,h+2*y,f,m)),E=s(n(this.pointsTee,h+2*y,f,m)),C=fa(u,d,v)||fa(u,d,E);return C},draw:function(u,d,h,f,m){var g=n(this.points,d,h,f),y=n(this.pointsTee,d,h,f);t.arrowShapeImpl(this.name)(u,g,y)}}),l("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,d,h,f,m,g,y){var v=m,E=Math.pow(v.x-u,2)+Math.pow(v.y-d,2)<=Math.pow((h+2*y)*this.radius,2),C=s(n(this.points,h+2*y,f,m));return fa(u,d,C)||E},draw:function(u,d,h,f,m){var g=n(this.pointsTr,d,h,f);t.arrowShapeImpl(this.name)(u,g,f.x,f.y,this.radius*d)},spacing:function(u){return t.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),l("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,d){var h=this.baseCrossLinePts.slice(),f=d/u,m=3,g=5;return h[m]=h[m]-f,h[g]=h[g]-f,h},collide:function(u,d,h,f,m,g,y){var v=s(n(this.points,h+2*y,f,m)),E=s(n(this.crossLinePts(h,g),h+2*y,f,m)),C=fa(u,d,v)||fa(u,d,E);return C},draw:function(u,d,h,f,m){var g=n(this.points,d,h,f),y=n(this.crossLinePts(d,m),d,h,f);t.arrowShapeImpl(this.name)(u,g,y)}}),l("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return o(u)*.525}}),l("circle",{radius:.15,collide:function(u,d,h,f,m,g,y){var v=m,E=Math.pow(v.x-u,2)+Math.pow(v.y-d,2)<=Math.pow((h+2*y)*this.radius,2);return E},draw:function(u,d,h,f,m){t.arrowShapeImpl(this.name)(u,f.x,f.y,this.radius*d)},spacing:function(u){return t.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),l("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),l("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),l("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),l("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};Ju={};Ju.projectIntoViewport=function(a,t){var e=this.cy,r=this.findContainerClientCoords(),n=r[0],s=r[1],o=r[4],l=e.pan(),c=e.zoom(),u=((a-n)/o-l.x)/c,d=((t-s)/o-l.y)/c;return[u,d]};Ju.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var a=this.container,t=a.getBoundingClientRect(),e=this.cy.window().getComputedStyle(a),r=function(E){return parseFloat(e.getPropertyValue(E))},n={left:r("padding-left"),right:r("padding-right"),top:r("padding-top"),bottom:r("padding-bottom")},s={left:r("border-left-width"),right:r("border-right-width"),top:r("border-top-width"),bottom:r("border-bottom-width")},o=a.clientWidth,l=a.clientHeight,c=n.left+n.right,u=n.top+n.bottom,d=s.left+s.right,h=t.width/(o+d),f=o-c,m=l-u,g=t.left+n.left+s.left,y=t.top+n.top+s.top;return this.containerBB=[g,y,f,m,h]};Ju.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Ju.findNearestElement=function(a,t,e,r){return this.findNearestElements(a,t,e,r)[0]};Ju.findNearestElements=function(a,t,e,r){var n=this,s=this,o=s.getCachedZSortedEles(),l=[],c=s.cy.zoom(),u=s.cy.hasCompoundNodes(),d=(r?24:8)/c,h=(r?8:2)/c,f=(r?8:2)/c,m=1/0,g,y;e&&(o=o.interactive);function v(M,O){if(M.isNode()){if(y)return;y=M,l.push(M)}if(M.isEdge()&&(O==null||O<m))if(g){if(g.pstyle("z-compound-depth").value===M.pstyle("z-compound-depth").value&&g.pstyle("z-compound-depth").value===M.pstyle("z-compound-depth").value){for(var R=0;R<l.length;R++)if(l[R].isEdge()){l[R]=M,g=M,m=O!=null?O:m;break}}}else l.push(M),g=M,m=O!=null?O:m}function E(M){var O=M.outerWidth()+2*h,R=M.outerHeight()+2*h,F=O/2,$=R/2,k=M.position(),N=M.pstyle("corner-radius").value==="auto"?"auto":M.pstyle("corner-radius").pfValue,G=M._private.rscratch;if(k.x-F<=a&&a<=k.x+F&&k.y-$<=t&&t<=k.y+$){var W=s.nodeShapes[n.getNodeShape(M)];if(W.checkPoint(a,t,0,O,R,k.x,k.y,N,G))return v(M,0),!0}}function C(M){var O=M._private,R=O.rscratch,F=M.pstyle("width").pfValue,$=M.pstyle("arrow-scale").value,k=F/2+d,N=k*k,G=k*2,Z=O.source,q=O.target,W;if(R.edgeType==="segments"||R.edgeType==="straight"||R.edgeType==="haystack"){for(var Y=R.allpts,U=0;U+3<Y.length;U+=2)if(Mye(a,t,Y[U],Y[U+1],Y[U+2],Y[U+3],G)&&N>(W=Rye(a,t,Y[U],Y[U+1],Y[U+2],Y[U+3])))return v(M,W),!0}else if(R.edgeType==="bezier"||R.edgeType==="multibezier"||R.edgeType==="self"||R.edgeType==="compound"){for(var Y=R.allpts,U=0;U+5<R.allpts.length;U+=4)if(Iye(a,t,Y[U],Y[U+1],Y[U+2],Y[U+3],Y[U+4],Y[U+5],G)&&N>(W=Fye(a,t,Y[U],Y[U+1],Y[U+2],Y[U+3],Y[U+4],Y[U+5])))return v(M,W),!0}for(var Z=Z||O.source,q=q||O.target,X=n.getArrowWidth(F,$),ie=[{name:"source",x:R.arrowStartX,y:R.arrowStartY,angle:R.srcArrowAngle},{name:"target",x:R.arrowEndX,y:R.arrowEndY,angle:R.tgtArrowAngle},{name:"mid-source",x:R.midX,y:R.midY,angle:R.midsrcArrowAngle},{name:"mid-target",x:R.midX,y:R.midY,angle:R.midtgtArrowAngle}],U=0;U<ie.length;U++){var j=ie[U],K=s.arrowShapes[M.pstyle(j.name+"-arrow-shape").value],se=M.pstyle("width").pfValue;if(K.roughCollide(a,t,X,j.angle,{x:j.x,y:j.y},se,d)&&K.collide(a,t,X,j.angle,{x:j.x,y:j.y},se,d))return v(M),!0}u&&l.length>0&&(E(Z),E(q))}function _(M,O,R){return ha(M,O,R)}function x(M,O){var R=M._private,F=f,$;O?$=O+"-":$="",M.boundingBox();var k=R.labelBounds[O||"main"],N=M.pstyle($+"label").value,G=M.pstyle("text-events").strValue==="yes";if(!(!G||!N)){var W=_(R.rscratch,"labelX",O),Y=_(R.rscratch,"labelY",O),U=_(R.rscratch,"labelAngle",O),Z=M.pstyle($+"text-margin-x").pfValue,q=M.pstyle($+"text-margin-y").pfValue,X=k.x1-F-Z,ie=k.x2+F-Z,j=k.y1-F-q,K=k.y2+F-q;if(U){var se=Math.cos(U),ne=Math.sin(U),ge=function(oe,he){return oe=oe-W,he=he-Y,{x:oe*se-he*ne+W,y:oe*ne+he*se+Y}},ve=ge(X,j),Se=ge(X,K),Te=ge(ie,j),me=ge(ie,K),pe=[ve.x+Z,ve.y+q,Te.x+Z,Te.y+q,me.x+Z,me.y+q,Se.x+Z,Se.y+q];if(fa(a,t,pe))return v(M),!0}else if(dc(k,a,t))return v(M),!0}}for(var P=o.length-1;P>=0;P--){var I=o[P];I.isNode()?E(I)||x(I):C(I)||x(I)||x(I,"source")||x(I,"target")}return l};Ju.getAllInBox=function(a,t,e,r){var n=this.getCachedZSortedEles().interactive,s=this.cy.zoom(),o=2/s,l=[],c=Math.min(a,e),u=Math.max(a,e),d=Math.min(t,r),h=Math.max(t,r);a=c,e=u,t=d,r=h;var f=Un({x1:a,y1:t,x2:e,y2:r}),m=[{x:f.x1,y:f.y1},{x:f.x2,y:f.y1},{x:f.x2,y:f.y2},{x:f.x1,y:f.y2}],g=[[m[0],m[1]],[m[1],m[2]],[m[2],m[3]],[m[3],m[0]]];function y(oe,he,te){return ha(oe,he,te)}function v(oe,he){var te=oe._private,re=o,ce="";oe.boundingBox();var Ee=te.labelBounds.main;if(!Ee)return null;var Ce=y(te.rscratch,"labelX",he),le=y(te.rscratch,"labelY",he),we=y(te.rscratch,"labelAngle",he),Le=oe.pstyle(ce+"text-margin-x").pfValue,Me=oe.pstyle(ce+"text-margin-y").pfValue,Ne=Ee.x1-re-Le,Ge=Ee.x2+re-Le,Ye=Ee.y1-re-Me,ft=Ee.y2+re-Me;if(we){var ct=Math.cos(we),Ve=Math.sin(we),et=function(Ie,ee){return Ie=Ie-Ce,ee=ee-le,{x:Ie*ct-ee*Ve+Ce,y:Ie*Ve+ee*ct+le}};return[et(Ne,Ye),et(Ge,Ye),et(Ge,ft),et(Ne,ft)]}else return[{x:Ne,y:Ye},{x:Ge,y:Ye},{x:Ge,y:ft},{x:Ne,y:ft}]}function E(oe,he,te,re){function ce(Ee,Ce,le){return(le.y-Ee.y)*(Ce.x-Ee.x)>(Ce.y-Ee.y)*(le.x-Ee.x)}return ce(oe,te,re)!==ce(he,te,re)&&ce(oe,he,te)!==ce(oe,he,re)}for(var C=0;C<n.length;C++){var _=n[C];if(_.isNode()){var x=_,P=x.pstyle("text-events").strValue==="yes",I=x.pstyle("box-selection").strValue,M=x.pstyle("box-select-labels").strValue==="yes";if(I==="none")continue;var O=(I==="overlap"||M)&&P,R=x.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:O});if(I==="contain"){var F=!1;if(M&&P){var $=v(x);$&&Qk($,m)&&(l.push(x),F=!0)}!F&&PV(f,R)&&l.push(x)}else if(I==="overlap"&&$D(f,R)){var k=x.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),N=[{x:k.x1,y:k.y1},{x:k.x2,y:k.y1},{x:k.x2,y:k.y2},{x:k.x1,y:k.y2}];if(Qk(N,m))l.push(x);else{var G=v(x);G&&Qk(G,m)&&l.push(x)}}}else{var W=_,Y=W._private,U=Y.rscratch,Z=W.pstyle("box-selection").strValue;if(Z==="none")continue;if(Z==="contain"){if(U.startX!=null&&U.startY!=null&&!dc(f,U.startX,U.startY)||U.endX!=null&&U.endY!=null&&!dc(f,U.endX,U.endY))continue;if(U.edgeType==="bezier"||U.edgeType==="multibezier"||U.edgeType==="self"||U.edgeType==="compound"||U.edgeType==="segments"||U.edgeType==="haystack"){for(var q=Y.rstyle.bezierPts||Y.rstyle.linePts||Y.rstyle.haystackPts,X=!0,ie=0;ie<q.length;ie++)if(!iH(f,q[ie])){X=!1;break}X&&l.push(W)}else U.edgeType==="straight"&&l.push(W)}else if(Z==="overlap"){var j=!1;if(U.startX!=null&&U.startY!=null&&U.endX!=null&&U.endY!=null&&(dc(f,U.startX,U.startY)||dc(f,U.endX,U.endY)))l.push(W),j=!0;else if(!j&&U.edgeType==="haystack"){for(var K=Y.rstyle.haystackPts,se=0;se<K.length;se++)if(iH(f,K[se])){l.push(W),j=!0;break}}if(!j){var ne=Y.rstyle.bezierPts||Y.rstyle.linePts||Y.rstyle.haystackPts;if((!ne||ne.length<2)&&U.edgeType==="straight"&&U.startX!=null&&U.startY!=null&&U.endX!=null&&U.endY!=null&&(ne=[{x:U.startX,y:U.startY},{x:U.endX,y:U.endY}]),!ne||ne.length<2)continue;for(var ge=0;ge<ne.length-1;ge++){for(var ve=ne[ge],Se=ne[ge+1],Te=0;Te<g.length;Te++){var me=Ci(g[Te],2),pe=me[0],B=me[1];if(E(ve,Se,pe,B)){l.push(W),j=!0;break}}if(j)break}}}}}return l};Tw={};Tw.calculateArrowAngles=function(a){var t=a._private.rscratch,e=t.edgeType==="haystack",r=t.edgeType==="bezier",n=t.edgeType==="multibezier",s=t.edgeType==="segments",o=t.edgeType==="compound",l=t.edgeType==="self",c,u,d,h,f,m,E,C;if(e?(d=t.haystackPts[0],h=t.haystackPts[1],f=t.haystackPts[2],m=t.haystackPts[3]):(d=t.arrowStartX,h=t.arrowStartY,f=t.arrowEndX,m=t.arrowEndY),E=t.midX,C=t.midY,s)c=d-t.segpts[0],u=h-t.segpts[1];else if(n||o||l||r){var g=t.allpts,y=qi(g[0],g[2],g[4],.1),v=qi(g[1],g[3],g[5],.1);c=d-y,u=h-v}else c=d-E,u=h-C;t.srcArrowAngle=W0(c,u);var E=t.midX,C=t.midY;if(e&&(E=(d+f)/2,C=(h+m)/2),c=f-d,u=m-h,s){var g=t.allpts;if(g.length/2%2===0){var _=g.length/2,x=_-2;c=g[_]-g[x],u=g[_+1]-g[x+1]}else if(t.isRound)c=t.midVector[1],u=-t.midVector[0];else{var _=g.length/2-1,x=_-2;c=g[_]-g[x],u=g[_+1]-g[x+1]}}else if(n||o||l){var g=t.allpts,P=t.ctrlpts,I,M,O,R;if(P.length/2%2===0){var F=g.length/2-1,$=F+2,k=$+2;I=qi(g[F],g[$],g[k],0),M=qi(g[F+1],g[$+1],g[k+1],0),O=qi(g[F],g[$],g[k],1e-4),R=qi(g[F+1],g[$+1],g[k+1],1e-4)}else{var $=g.length/2-1,F=$-2,k=$+2;I=qi(g[F],g[$],g[k],.4999),M=qi(g[F+1],g[$+1],g[k+1],.4999),O=qi(g[F],g[$],g[k],.5),R=qi(g[F+1],g[$+1],g[k+1],.5)}c=O-I,u=R-M}if(t.midtgtArrowAngle=W0(c,u),t.midDispX=c,t.midDispY=u,c*=-1,u*=-1,s){var g=t.allpts;if(g.length/2%2!==0){if(!t.isRound){var _=g.length/2-1,N=_+2;c=-(g[N]-g[_]),u=-(g[N+1]-g[_+1])}}}if(t.midsrcArrowAngle=W0(c,u),s)c=f-t.segpts[t.segpts.length-2],u=m-t.segpts[t.segpts.length-1];else if(n||o||l||r){var g=t.allpts,G=g.length,y=qi(g[G-6],g[G-4],g[G-2],.9),v=qi(g[G-5],g[G-3],g[G-1],.9);c=f-y,u=m-v}else c=f-E,u=m-C;t.tgtArrowAngle=W0(c,u)};Tw.getArrowWidth=Tw.getArrowHeight=function(a,t){var e=this.arrowWidthCache=this.arrowWidthCache||{},r=e[a+", "+t];return r||(r=Math.max(Math.pow(a*13.37,.9),29)*t,e[a+", "+t]=r,r)};fo={},ls={},GG=function(t,e,r){r.x=e.x-t.x,r.y=e.y-t.y,r.len=Math.sqrt(r.x*r.x+r.y*r.y),r.nx=r.x/r.len,r.ny=r.y/r.len,r.ang=Math.atan2(r.ny,r.nx)},Jwe=function(t,e){e.x=t.x*-1,e.y=t.y*-1,e.nx=t.nx*-1,e.ny=t.ny*-1,e.ang=t.ang>0?-(Math.PI-t.ang):Math.PI+t.ang},Qwe=function(t,e,r,n,s){if(t!==HG?GG(e,t,fo):Jwe(ls,fo),GG(e,r,ls),$G=fo.nx*ls.ny-fo.ny*ls.nx,zG=fo.nx*ls.nx-fo.ny*-ls.ny,Qo=Math.asin(Math.max(-1,Math.min(1,$G))),Math.abs(Qo)<1e-6){ED=e.x,TD=e.y,Vu=cf=0;return}Uu=1,cw=!1,zG<0?Qo<0?Qo=Math.PI+Qo:(Qo=Math.PI-Qo,Uu=-1,cw=!0):Qo>0&&(Uu=-1,cw=!0),e.radius!==void 0?cf=e.radius:cf=n,$u=Qo/2,J0=Math.min(fo.len/2,ls.len/2),s?(uo=Math.abs(Math.cos($u)*cf/Math.sin($u)),uo>J0?(uo=J0,Vu=Math.abs(uo*Math.sin($u)/Math.cos($u))):Vu=cf):(uo=Math.min(J0,cf),Vu=Math.abs(uo*Math.sin($u)/Math.cos($u))),CD=e.x+ls.nx*uo,_D=e.y+ls.ny*uo,ED=CD-ls.ny*Vu*Uu,TD=_D+ls.nx*Vu*Uu,C5=e.x+fo.nx*uo,_5=e.y+fo.ny*uo,HG=e};iv=.01,eEe=Math.sqrt(2*iv),_n={};_n.findMidptPtsEtc=function(a,t){var e=t.posPts,r=t.intersectionPts,n=t.vectorNormInverse,s,o=a.pstyle("source-endpoint"),l=a.pstyle("target-endpoint"),c=o.units!=null&&l.units!=null,u=function(P,I,M,O){var R=O-I,F=M-P,$=Math.sqrt(F*F+R*R);return{x:-R/$,y:F/$}},d=a.pstyle("edge-distances").value;switch(d){case"node-position":s=e;break;case"intersection":s=r;break;case"endpoints":{if(c){var h=this.manualEndptToPx(a.source()[0],o),f=Ci(h,2),m=f[0],g=f[1],y=this.manualEndptToPx(a.target()[0],l),v=Ci(y,2),E=v[0],C=v[1],_={x1:m,y1:g,x2:E,y2:C};n=u(m,g,E,C),s=_}else cr("Edge ".concat(a.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),s=r;break}}return{midptPts:s,vectorNormInverse:n}};_n.findHaystackPoints=function(a){for(var t=0;t<a.length;t++){var e=a[t],r=e._private,n=r.rscratch;if(!n.haystack){var s=Math.random()*2*Math.PI;n.source={x:Math.cos(s),y:Math.sin(s)},s=Math.random()*2*Math.PI,n.target={x:Math.cos(s),y:Math.sin(s)}}var o=r.source,l=r.target,c=o.position(),u=l.position(),d=o.width(),h=l.width(),f=o.height(),m=l.height(),g=e.pstyle("haystack-radius").value,y=g/2;n.haystackPts=n.allpts=[n.source.x*d*y+c.x,n.source.y*f*y+c.y,n.target.x*h*y+u.x,n.target.y*m*y+u.y],n.midX=(n.allpts[0]+n.allpts[2])/2,n.midY=(n.allpts[1]+n.allpts[3])/2,n.edgeType="haystack",n.haystack=!0,this.storeEdgeProjections(e),this.calculateArrowAngles(e),this.recalculateEdgeLabelProjections(e),this.calculateLabelAngles(e)}};_n.findSegmentsPoints=function(a,t){var e=a._private.rscratch,r=a.pstyle("segment-weights"),n=a.pstyle("segment-distances"),s=a.pstyle("segment-radii"),o=a.pstyle("radius-type"),l=Math.min(r.pfValue.length,n.pfValue.length),c=s.pfValue[s.pfValue.length-1],u=o.pfValue[o.pfValue.length-1];e.edgeType="segments",e.segpts=[],e.radii=[],e.isArcRadius=[];for(var d=0;d<l;d++){var h=r.pfValue[d],f=n.pfValue[d],m=1-h,g=h,y=this.findMidptPtsEtc(a,t),v=y.midptPts,E=y.vectorNormInverse,C={x:v.x1*m+v.x2*g,y:v.y1*m+v.y2*g};e.segpts.push(C.x+E.x*f,C.y+E.y*f),e.radii.push(s.pfValue[d]!==void 0?s.pfValue[d]:c),e.isArcRadius.push((o.pfValue[d]!==void 0?o.pfValue[d]:u)==="arc-radius")}};_n.findLoopPoints=function(a,t,e,r){var n=a._private.rscratch,s=t.dirCounts,o=t.srcPos,l=a.pstyle("control-point-distances"),c=l?l.pfValue[0]:void 0,u=a.pstyle("loop-direction").pfValue,d=a.pstyle("loop-sweep").pfValue,h=a.pstyle("control-point-step-size").pfValue;n.edgeType="self";var f=e,m=h;r&&(f=0,m=c);var g=u-Math.PI/2,y=g-d/2,v=g+d/2,E=u+"_"+d;f=s[E]===void 0?s[E]=0:++s[E],n.ctrlpts=[o.x+Math.cos(y)*1.4*m*(f/3+1),o.y+Math.sin(y)*1.4*m*(f/3+1),o.x+Math.cos(v)*1.4*m*(f/3+1),o.y+Math.sin(v)*1.4*m*(f/3+1)]};_n.findCompoundLoopPoints=function(a,t,e,r){var n=a._private.rscratch;n.edgeType="compound";var s=t.srcPos,o=t.tgtPos,l=t.srcW,c=t.srcH,u=t.tgtW,d=t.tgtH,h=a.pstyle("control-point-step-size").pfValue,f=a.pstyle("control-point-distances"),m=f?f.pfValue[0]:void 0,g=e,y=h;r&&(g=0,y=m);var v=50,E={x:s.x-l/2,y:s.y-c/2},C={x:o.x-u/2,y:o.y-d/2},_={x:Math.min(E.x,C.x),y:Math.min(E.y,C.y)},x=.5,P=Math.max(x,Math.log(l*iv)),I=Math.max(x,Math.log(u*iv));n.ctrlpts=[_.x,_.y-(1+Math.pow(v,1.12)/100)*y*(g/3+1)*P,_.x-(1+Math.pow(v,1.12)/100)*y*(g/3+1)*I,_.y]};_n.findStraightEdgePoints=function(a){a._private.rscratch.edgeType="straight"};_n.findBezierPoints=function(a,t,e,r,n){var s=a._private.rscratch,o=a.pstyle("control-point-step-size").pfValue,l=a.pstyle("control-point-distances"),c=a.pstyle("control-point-weights"),u=l&&c?Math.min(l.value.length,c.value.length):1,d=l?l.pfValue[0]:void 0,h=c.value[0],f=r;s.edgeType=f?"multibezier":"bezier",s.ctrlpts=[];for(var m=0;m<u;m++){var g=(.5-t.eles.length/2+e)*o*(n?-1:1),y=void 0,v=BD(g);f&&(d=l?l.pfValue[m]:o,h=c.value[m]),r?y=d:y=d!==void 0?v*d:void 0;var E=y!==void 0?y:g,C=1-h,_=h,x=this.findMidptPtsEtc(a,t),P=x.midptPts,I=x.vectorNormInverse,M={x:P.x1*C+P.x2*_,y:P.y1*C+P.y2*_};s.ctrlpts.push(M.x+I.x*E,M.y+I.y*E)}};_n.findTaxiPoints=function(a,t){var e=a._private.rscratch;e.edgeType="segments";var r="vertical",n="horizontal",s="leftward",o="rightward",l="downward",c="upward",u="auto",d=t.posPts,h=t.srcW,f=t.srcH,m=t.tgtW,g=t.tgtH,y=a.pstyle("edge-distances").value,v=y!=="node-position",E=a.pstyle("taxi-direction").value,C=E,_=a.pstyle("taxi-turn"),x=_.units==="%",P=_.pfValue,I=P<0,M=a.pstyle("taxi-turn-min-distance").pfValue,O=v?(h+m)/2:0,R=v?(f+g)/2:0,F=d.x2-d.x1,$=d.y2-d.y1,k=function(ee,ye){return ee>0?Math.max(ee-ye,0):Math.min(ee+ye,0)},N=k(F,O),G=k($,R),W=!1;C===u?E=Math.abs(N)>Math.abs(G)?n:r:C===c||C===l?(E=r,W=!0):(C===s||C===o)&&(E=n,W=!0);var Y=E===r,U=Y?G:N,Z=Y?$:F,q=BD(Z),X=!1;!(W&&(x||I))&&(C===l&&Z<0||C===c&&Z>0||C===s&&Z>0||C===o&&Z<0)&&(q*=-1,U=q*Math.abs(U),X=!0);var ie;if(x){var j=P<0?1+P:P;ie=j*U}else{var K=P<0?U:0;ie=K+P*q}var se=function(ee){return Math.abs(ee)<M||Math.abs(ee)>=Math.abs(U)},ne=se(ie),ge=se(Math.abs(U)-Math.abs(ie)),ve=ne||ge;if(ve&&!X)if(Y){var Se=Math.abs(Z)<=f/2,Te=Math.abs(F)<=m/2;if(Se){var me=(d.x1+d.x2)/2,pe=d.y1,B=d.y2;e.segpts=[me,pe,me,B]}else if(Te){var oe=(d.y1+d.y2)/2,he=d.x1,te=d.x2;e.segpts=[he,oe,te,oe]}else e.segpts=[d.x1,d.y2]}else{var re=Math.abs(Z)<=h/2,ce=Math.abs($)<=g/2;if(re){var Ee=(d.y1+d.y2)/2,Ce=d.x1,le=d.x2;e.segpts=[Ce,Ee,le,Ee]}else if(ce){var we=(d.x1+d.x2)/2,Le=d.y1,Me=d.y2;e.segpts=[we,Le,we,Me]}else e.segpts=[d.x2,d.y1]}else if(Y){var Ne=d.y1+ie+(v?f/2*q:0),Ge=d.x1,Ye=d.x2;e.segpts=[Ge,Ne,Ye,Ne]}else{var ft=d.x1+ie+(v?h/2*q:0),ct=d.y1,Ve=d.y2;e.segpts=[ft,ct,ft,Ve]}if(e.isRound){var et=a.pstyle("taxi-radius").value,$e=a.pstyle("radius-type").value[0]==="arc-radius";e.radii=new Array(e.segpts.length/2).fill(et),e.isArcRadius=new Array(e.segpts.length/2).fill($e)}};_n.tryToCorrectInvalidPoints=function(a,t){var e=a._private.rscratch;if(e.edgeType==="bezier"){var r=t.srcPos,n=t.tgtPos,s=t.srcW,o=t.srcH,l=t.tgtW,c=t.tgtH,u=t.srcShape,d=t.tgtShape,h=t.srcCornerRadius,f=t.tgtCornerRadius,m=t.srcRs,g=t.tgtRs,y=!We(e.startX)||!We(e.startY),v=!We(e.arrowStartX)||!We(e.arrowStartY),E=!We(e.endX)||!We(e.endY),C=!We(e.arrowEndX)||!We(e.arrowEndY),_=3,x=this.getArrowWidth(a.pstyle("width").pfValue,a.pstyle("arrow-scale").value)*this.arrowShapeWidth,P=_*x,I=qu({x:e.ctrlpts[0],y:e.ctrlpts[1]},{x:e.startX,y:e.startY}),M=I<P,O=qu({x:e.ctrlpts[0],y:e.ctrlpts[1]},{x:e.endX,y:e.endY}),R=O<P,F=!1;if(y||v||M){F=!0;var $={x:e.ctrlpts[0]-r.x,y:e.ctrlpts[1]-r.y},k=Math.sqrt($.x*$.x+$.y*$.y),N={x:$.x/k,y:$.y/k},G=Math.max(s,o),W={x:e.ctrlpts[0]+N.x*2*G,y:e.ctrlpts[1]+N.y*2*G},Y=u.intersectLine(r.x,r.y,s,o,W.x,W.y,0,h,m);M?(e.ctrlpts[0]=e.ctrlpts[0]+N.x*(P-I),e.ctrlpts[1]=e.ctrlpts[1]+N.y*(P-I)):(e.ctrlpts[0]=Y[0]+N.x*P,e.ctrlpts[1]=Y[1]+N.y*P)}if(E||C||R){F=!0;var U={x:e.ctrlpts[0]-n.x,y:e.ctrlpts[1]-n.y},Z=Math.sqrt(U.x*U.x+U.y*U.y),q={x:U.x/Z,y:U.y/Z},X=Math.max(s,o),ie={x:e.ctrlpts[0]+q.x*2*X,y:e.ctrlpts[1]+q.y*2*X},j=d.intersectLine(n.x,n.y,l,c,ie.x,ie.y,0,f,g);R?(e.ctrlpts[0]=e.ctrlpts[0]+q.x*(P-O),e.ctrlpts[1]=e.ctrlpts[1]+q.y*(P-O)):(e.ctrlpts[0]=j[0]+q.x*P,e.ctrlpts[1]=j[1]+q.y*P)}F&&this.findEndpoints(a)}};_n.storeAllpts=function(a){var t=a._private.rscratch;if(t.edgeType==="multibezier"||t.edgeType==="bezier"||t.edgeType==="self"||t.edgeType==="compound"){t.allpts=[],t.allpts.push(t.startX,t.startY);for(var e=0;e+1<t.ctrlpts.length;e+=2)t.allpts.push(t.ctrlpts[e],t.ctrlpts[e+1]),e+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[e]+t.ctrlpts[e+2])/2,(t.ctrlpts[e+1]+t.ctrlpts[e+3])/2);t.allpts.push(t.endX,t.endY);var r,n;t.ctrlpts.length/2%2===0?(r=t.allpts.length/2-1,t.midX=t.allpts[r],t.midY=t.allpts[r+1]):(r=t.allpts.length/2-3,n=.5,t.midX=qi(t.allpts[r],t.allpts[r+2],t.allpts[r+4],n),t.midY=qi(t.allpts[r+1],t.allpts[r+3],t.allpts[r+5],n))}else if(t.edgeType==="straight")t.allpts=[t.startX,t.startY,t.endX,t.endY],t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4,t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4;else if(t.edgeType==="segments"){if(t.allpts=[],t.allpts.push(t.startX,t.startY),t.allpts.push.apply(t.allpts,t.segpts),t.allpts.push(t.endX,t.endY),t.isRound){t.roundCorners=[];for(var s=2;s+3<t.allpts.length;s+=2){var o=t.radii[s/2-1],l=t.isArcRadius[s/2-1];t.roundCorners.push(XD({x:t.allpts[s-2],y:t.allpts[s-1]},{x:t.allpts[s],y:t.allpts[s+1],radius:o},{x:t.allpts[s+2],y:t.allpts[s+3]},o,l))}}if(t.segpts.length%4===0){var c=t.segpts.length/2,u=c-2;t.midX=(t.segpts[u]+t.segpts[c])/2,t.midY=(t.segpts[u+1]+t.segpts[c+1])/2}else{var d=t.segpts.length/2-1;if(!t.isRound)t.midX=t.segpts[d],t.midY=t.segpts[d+1];else{var h={x:t.segpts[d],y:t.segpts[d+1]},f=t.roundCorners[d/2];if(f.radius===0){var m={x:t.segpts[d+2],y:t.segpts[d+3]};t.midX=h.x,t.midY=h.y,t.midVector=[h.y-m.y,m.x-h.x]}else{var g=[h.x-f.cx,h.y-f.cy],y=f.radius/Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2));g=g.map(function(v){return v*y}),t.midX=f.cx+g[0],t.midY=f.cy+g[1],t.midVector=g}}}}};_n.checkForInvalidEdgeWarning=function(a){var t=a[0]._private.rscratch;t.nodesOverlap||We(t.startX)&&We(t.startY)&&We(t.endX)&&We(t.endY)?t.loggedErr=!1:t.loggedErr||(t.loggedErr=!0,cr("Edge `"+a.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};_n.findEdgeControlPoints=function(a){var t=this;if(!(!a||a.length===0)){for(var e=this,r=e.cy,n=r.hasCompoundNodes(),s=new tl,o=function(R,F){return[].concat(hw(R),[F?1:0]).join("-")},l=[],c=[],u=0;u<a.length;u++){var d=a[u],h=d._private,f=d.pstyle("curve-style").value;if(!(d.removed()||!d.takesUpSpace())){if(f==="haystack"){c.push(d);continue}var m=f==="unbundled-bezier"||uc(f,"segments")||f==="straight"||f==="straight-triangle"||uc(f,"taxi"),g=f==="unbundled-bezier"||f==="bezier",y=h.source,v=h.target,E=y.poolIndex(),C=v.poolIndex(),_=[E,C].sort(),x=o(_,m),P=s.get(x);P==null&&(P={eles:[]},l.push({pairId:_,edgeIsUnbundled:m}),s.set(x,P)),P.eles.push(d),m&&(P.hasUnbundled=!0),g&&(P.hasBezier=!0)}}for(var I=function(){var R=l[M],F=R.pairId,$=R.edgeIsUnbundled,k=o(F,$),N=s.get(k),G;if(!N.hasUnbundled){var W=N.eles[0].parallelEdges().filter(function($e){return $e.isBundledBezier()});RD(N.eles),W.forEach(function($e){return N.eles.push($e)}),N.eles.sort(function($e,Ie){return $e.poolIndex()-Ie.poolIndex()})}var Y=N.eles[0],U=Y.source(),Z=Y.target();if(U.poolIndex()>Z.poolIndex()){var q=U;U=Z,Z=q}var X=N.srcPos=U.position(),ie=N.tgtPos=Z.position(),j=N.srcW=U.outerWidth(),K=N.srcH=U.outerHeight(),se=N.tgtW=Z.outerWidth(),ne=N.tgtH=Z.outerHeight(),ge=N.srcShape=e.nodeShapes[t.getNodeShape(U)],ve=N.tgtShape=e.nodeShapes[t.getNodeShape(Z)],Se=N.srcCornerRadius=U.pstyle("corner-radius").value==="auto"?"auto":U.pstyle("corner-radius").pfValue,Te=N.tgtCornerRadius=Z.pstyle("corner-radius").value==="auto"?"auto":Z.pstyle("corner-radius").pfValue,me=N.tgtRs=Z._private.rscratch,pe=N.srcRs=U._private.rscratch;N.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var B=0;B<N.eles.length;B++){var oe=N.eles[B],he=oe[0]._private.rscratch,te=oe.pstyle("curve-style").value,re=te==="unbundled-bezier"||uc(te,"segments")||uc(te,"taxi"),ce=!U.same(oe.source());if(!N.calculatedIntersection&&U!==Z&&(N.hasBezier||N.hasUnbundled)){N.calculatedIntersection=!0;var Ee=ge.intersectLine(X.x,X.y,j,K,ie.x,ie.y,0,Se,pe),Ce=N.srcIntn=Ee,le=ve.intersectLine(ie.x,ie.y,se,ne,X.x,X.y,0,Te,me),we=N.tgtIntn=le,Le=N.intersectionPts={x1:Ee[0],x2:le[0],y1:Ee[1],y2:le[1]},Me=N.posPts={x1:X.x,x2:ie.x,y1:X.y,y2:ie.y},Ne=le[1]-Ee[1],Ge=le[0]-Ee[0],Ye=Math.sqrt(Ge*Ge+Ne*Ne);We(Ye)&&Ye>=eEe||(Ye=Math.sqrt(Math.max(Ge*Ge,iv)+Math.max(Ne*Ne,iv)));var ft=N.vector={x:Ge,y:Ne},ct=N.vectorNorm={x:ft.x/Ye,y:ft.y/Ye},Ve={x:-ct.y,y:ct.x};N.nodesOverlap=!We(Ye)||ve.checkPoint(Ee[0],Ee[1],0,se,ne,ie.x,ie.y,Te,me)||ge.checkPoint(le[0],le[1],0,j,K,X.x,X.y,Se,pe),N.vectorNormInverse=Ve,G={nodesOverlap:N.nodesOverlap,dirCounts:N.dirCounts,calculatedIntersection:!0,hasBezier:N.hasBezier,hasUnbundled:N.hasUnbundled,eles:N.eles,srcPos:ie,srcRs:me,tgtPos:X,tgtRs:pe,srcW:se,srcH:ne,tgtW:j,tgtH:K,srcIntn:we,tgtIntn:Ce,srcShape:ve,tgtShape:ge,posPts:{x1:Me.x2,y1:Me.y2,x2:Me.x1,y2:Me.y1},intersectionPts:{x1:Le.x2,y1:Le.y2,x2:Le.x1,y2:Le.y1},vector:{x:-ft.x,y:-ft.y},vectorNorm:{x:-ct.x,y:-ct.y},vectorNormInverse:{x:-Ve.x,y:-Ve.y}}}var et=ce?G:N;he.nodesOverlap=et.nodesOverlap,he.srcIntn=et.srcIntn,he.tgtIntn=et.tgtIntn,he.isRound=te.startsWith("round"),n&&(U.isParent()||U.isChild()||Z.isParent()||Z.isChild())&&(U.parents().anySame(Z)||Z.parents().anySame(U)||U.same(Z)&&U.isParent())?t.findCompoundLoopPoints(oe,et,B,re):U===Z?t.findLoopPoints(oe,et,B,re):te.endsWith("segments")?t.findSegmentsPoints(oe,et):te.endsWith("taxi")?t.findTaxiPoints(oe,et):te==="straight"||!re&&N.eles.length%2===1&&B===Math.floor(N.eles.length/2)?t.findStraightEdgePoints(oe):t.findBezierPoints(oe,et,B,re,ce),t.findEndpoints(oe),t.tryToCorrectInvalidPoints(oe,et),t.checkForInvalidEdgeWarning(oe),t.storeAllpts(oe),t.storeEdgeProjections(oe),t.calculateArrowAngles(oe),t.recalculateEdgeLabelProjections(oe),t.calculateLabelAngles(oe)}},M=0;M<l.length;M++)I();this.findHaystackPoints(c)}};_n.getSegmentPoints=function(a){var t=a[0]._private.rscratch;this.recalculateRenderedStyle(a);var e=t.edgeType;if(e==="segments")return x5(t.segpts)};_n.getControlPoints=function(a){var t=a[0]._private.rscratch;this.recalculateRenderedStyle(a);var e=t.edgeType;if(e==="bezier"||e==="multibezier"||e==="self"||e==="compound")return x5(t.ctrlpts)};_n.getEdgeMidpoint=function(a){var t=a[0]._private.rscratch;return this.recalculateRenderedStyle(a),{x:t.midX,y:t.midY}};fv={};fv.manualEndptToPx=function(a,t){var e=this,r=a.position(),n=a.outerWidth(),s=a.outerHeight(),o=a._private.rscratch;if(t.value.length===2){var l=[t.pfValue[0],t.pfValue[1]];return t.units[0]==="%"&&(l[0]=l[0]*n),t.units[1]==="%"&&(l[1]=l[1]*s),l[0]+=r.x,l[1]+=r.y,l}else{var c=t.pfValue[0];c=-Math.PI/2+c;var u=2*Math.max(n,s),d=[r.x+Math.cos(c)*u,r.y+Math.sin(c)*u];return e.nodeShapes[this.getNodeShape(a)].intersectLine(r.x,r.y,n,s,d[0],d[1],0,a.pstyle("corner-radius").value==="auto"?"auto":a.pstyle("corner-radius").pfValue,o)}};fv.findEndpoints=function(a){var t,e,r,n,s=this,o,l=a.source()[0],c=a.target()[0],u=l.position(),d=c.position(),h=a.pstyle("target-arrow-shape").value,f=a.pstyle("source-arrow-shape").value,m=a.pstyle("target-distance-from-node").pfValue,g=a.pstyle("source-distance-from-node").pfValue,y=l._private.rscratch,v=c._private.rscratch,E=a.pstyle("curve-style").value,C=a._private.rscratch,_=C.edgeType,x=uc(E,"taxi"),P=_==="self"||_==="compound",I=_==="bezier"||_==="multibezier"||P,M=_!=="bezier",O=_==="straight"||_==="segments",R=_==="segments",F=I||M||O,$=P||x,k=a.pstyle("source-endpoint"),N=$?"outside-to-node":k.value,G=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue,W=a.pstyle("target-endpoint"),Y=$?"outside-to-node":W.value,U=c.pstyle("corner-radius").value==="auto"?"auto":c.pstyle("corner-radius").pfValue;C.srcManEndpt=k,C.tgtManEndpt=W;var Z,q,X,ie,j=(t=(W==null||(e=W.pfValue)===null||e===void 0?void 0:e.length)===2?W.pfValue:null)!==null&&t!==void 0?t:[0,0],K=(r=(k==null||(n=k.pfValue)===null||n===void 0?void 0:n.length)===2?k.pfValue:null)!==null&&r!==void 0?r:[0,0];if(I){var se=[C.ctrlpts[0],C.ctrlpts[1]],ne=M?[C.ctrlpts[C.ctrlpts.length-2],C.ctrlpts[C.ctrlpts.length-1]]:se;Z=ne,q=se}else if(O){var ge=R?C.segpts.slice(0,2):[d.x+j[0],d.y+j[1]],ve=R?C.segpts.slice(C.segpts.length-2):[u.x+K[0],u.y+K[1]];Z=ve,q=ge}if(Y==="inside-to-node")o=[d.x,d.y];else if(W.units)o=this.manualEndptToPx(c,W);else if(Y==="outside-to-line")o=C.tgtIntn;else if(Y==="outside-to-node"||Y==="outside-to-node-or-label"?X=Z:(Y==="outside-to-line"||Y==="outside-to-line-or-label")&&(X=[u.x,u.y]),o=s.nodeShapes[this.getNodeShape(c)].intersectLine(d.x,d.y,c.outerWidth(),c.outerHeight(),X[0],X[1],0,U,v),Y==="outside-to-node-or-label"||Y==="outside-to-line-or-label"){var Se=c._private.rscratch,Te=Se.labelWidth,me=Se.labelHeight,pe=Se.labelX,B=Se.labelY,oe=Te/2,he=me/2,te=c.pstyle("text-valign").value;te==="top"?B-=he:te==="bottom"&&(B+=he);var re=c.pstyle("text-halign").value;re==="left"?pe-=oe:re==="right"&&(pe+=oe);var ce=Jg(X[0],X[1],[pe-oe,B-he,pe+oe,B-he,pe+oe,B+he,pe-oe,B+he],d.x,d.y);if(ce.length>0){var Ee=u,Ce=Gu(Ee,ff(o)),le=Gu(Ee,ff(ce)),we=Ce;if(le<Ce&&(o=ce,we=le),ce.length>2){var Le=Gu(Ee,{x:ce[2],y:ce[3]});Le<we&&(o=[ce[2],ce[3]])}}}var Me=U0(o,Z,s.arrowShapes[h].spacing(a)+m),Ne=U0(o,Z,s.arrowShapes[h].gap(a)+m);if(C.endX=Ne[0],C.endY=Ne[1],C.arrowEndX=Me[0],C.arrowEndY=Me[1],N==="inside-to-node")o=[u.x,u.y];else if(k.units)o=this.manualEndptToPx(l,k);else if(N==="outside-to-line")o=C.srcIntn;else if(N==="outside-to-node"||N==="outside-to-node-or-label"?ie=q:(N==="outside-to-line"||N==="outside-to-line-or-label")&&(ie=[d.x,d.y]),o=s.nodeShapes[this.getNodeShape(l)].intersectLine(u.x,u.y,l.outerWidth(),l.outerHeight(),ie[0],ie[1],0,G,y),N==="outside-to-node-or-label"||N==="outside-to-line-or-label"){var Ge=l._private.rscratch,Ye=Ge.labelWidth,ft=Ge.labelHeight,ct=Ge.labelX,Ve=Ge.labelY,et=Ye/2,$e=ft/2,Ie=l.pstyle("text-valign").value;Ie==="top"?Ve-=$e:Ie==="bottom"&&(Ve+=$e);var ee=l.pstyle("text-halign").value;ee==="left"?ct-=et:ee==="right"&&(ct+=et);var ye=Jg(ie[0],ie[1],[ct-et,Ve-$e,ct+et,Ve-$e,ct+et,Ve+$e,ct-et,Ve+$e],u.x,u.y);if(ye.length>0){var Pe=d,xe=Gu(Pe,ff(o)),Fe=Gu(Pe,ff(ye)),qe=xe;if(Fe<xe&&(o=[ye[0],ye[1]],qe=Fe),ye.length>2){var Re=Gu(Pe,{x:ye[2],y:ye[3]});Re<qe&&(o=[ye[2],ye[3]])}}}var ze=U0(o,q,s.arrowShapes[f].spacing(a)+g),Ze=U0(o,q,s.arrowShapes[f].gap(a)+g);C.startX=Ze[0],C.startY=Ze[1],C.arrowStartX=ze[0],C.arrowStartY=ze[1],F&&(!We(C.startX)||!We(C.startY)||!We(C.endX)||!We(C.endY)?C.badLine=!0:C.badLine=!1)};fv.getSourceEndpoint=function(a){var t=a[0]._private.rscratch;switch(this.recalculateRenderedStyle(a),t.edgeType){case"haystack":return{x:t.haystackPts[0],y:t.haystackPts[1]};default:return{x:t.arrowStartX,y:t.arrowStartY}}};fv.getTargetEndpoint=function(a){var t=a[0]._private.rscratch;switch(this.recalculateRenderedStyle(a),t.edgeType){case"haystack":return{x:t.haystackPts[2],y:t.haystackPts[3]};default:return{x:t.arrowEndX,y:t.arrowEndY}}};JD={};JD.storeEdgeProjections=function(a){var t=a._private,e=t.rscratch,r=e.edgeType;if(t.rstyle.bezierPts=null,t.rstyle.linePts=null,t.rstyle.haystackPts=null,r==="multibezier"||r==="bezier"||r==="self"||r==="compound"){t.rstyle.bezierPts=[];for(var n=0;n+5<e.allpts.length;n+=4)tEe(this,a,e.allpts.slice(n,n+6))}else if(r==="segments")for(var s=t.rstyle.linePts=[],n=0;n+1<e.allpts.length;n+=2)s.push({x:e.allpts[n],y:e.allpts[n+1]});else if(r==="haystack"){var o=e.haystackPts;t.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(a.pstyle("width").pfValue,a.pstyle("arrow-scale").value)*this.arrowShapeWidth};JD.recalculateEdgeProjections=function(a){this.findEdgeControlPoints(a)};go={};go.recalculateNodeLabelProjection=function(a){var t=a.pstyle("label").strValue;if(!mc(t)){var e,r,n=a._private,s=a.width(),o=a.height(),l=a.padding(),c=a.position(),u=a.pstyle("text-halign").strValue,d=a.pstyle("text-valign").strValue,h=n.rscratch,f=n.rstyle;switch(u){case"left":e=c.x-s/2-l;break;case"right":e=c.x+s/2+l;break;default:e=c.x}switch(d){case"top":r=c.y-o/2-l;break;case"bottom":r=c.y+o/2+l;break;default:r=c.y}h.labelX=e,h.labelY=r,f.labelX=e,f.labelY=r,this.calculateLabelAngles(a),this.applyLabelDimensions(a)}};k5=function(t,e){var r=Math.atan(e/t);return t===0&&r<0&&(r=r*-1),r},D5=function(t,e){var r=e.x-t.x,n=e.y-t.y;return k5(r,n)},rEe=function(t,e,r,n){var s=Xg(0,n-.001,1),o=Xg(0,n+.001,1),l=gf(t,e,r,s),c=gf(t,e,r,o);return D5(l,c)};go.recalculateEdgeLabelProjections=function(a){var t,e=a._private,r=e.rscratch,n=this,s={mid:a.pstyle("label").strValue,source:a.pstyle("source-label").strValue,target:a.pstyle("target-label").strValue};if(s.mid||s.source||s.target){t={x:r.midX,y:r.midY};var o=function(h,f,m){el(e.rscratch,h,f,m),el(e.rstyle,h,f,m)};o("labelX",null,t.x),o("labelY",null,t.y);var l=k5(r.midDispX,r.midDispY);o("labelAutoAngle",null,l);var c=function(){if(c.cache)return c.cache;for(var h=[],f=0;f+5<r.allpts.length;f+=4){var m={x:r.allpts[f],y:r.allpts[f+1]},g={x:r.allpts[f+2],y:r.allpts[f+3]},y={x:r.allpts[f+4],y:r.allpts[f+5]};h.push({p0:m,p1:g,p2:y,startDist:0,length:0,segments:[]})}var v=e.rstyle.bezierPts,E=n.bezierProjPcts.length;function C(M,O,R,F,$){var k=qu(O,R),N=M.segments[M.segments.length-1],G={p0:O,p1:R,t0:F,t1:$,startDist:N?N.startDist+N.length:0,length:k};M.segments.push(G),M.length+=k}for(var _=0;_<h.length;_++){var x=h[_],P=h[_-1];P&&(x.startDist=P.startDist+P.length),C(x,x.p0,v[_*E],0,n.bezierProjPcts[0]);for(var I=0;I<E-1;I++)C(x,v[_*E+I],v[_*E+I+1],n.bezierProjPcts[I],n.bezierProjPcts[I+1]);C(x,v[_*E+E-1],x.p2,n.bezierProjPcts[E-1],1)}return c.cache=h},u=function(h){var f,m=h==="source";if(s[h]){var g=a.pstyle(h+"-text-offset").pfValue;switch(r.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var y=c(),v,E=0,C=0,_=0;_<y.length;_++){for(var x=y[m?_:y.length-1-_],P=0;P<x.segments.length;P++){var I=x.segments[m?P:x.segments.length-1-P],M=_===y.length-1&&P===x.segments.length-1;if(E=C,C+=I.length,C>=g||M){v={cp:x,segment:I};break}}if(v)break}var O=v.cp,R=v.segment,F=(g-E)/R.length,$=R.t1-R.t0,k=m?R.t0+$*F:R.t1-$*F;k=Xg(0,k,1),t=gf(O.p0,O.p1,O.p2,k),f=rEe(O.p0,O.p1,O.p2,k);break}case"straight":case"segments":case"haystack":{for(var N=0,G,W,Y,U,Z=r.allpts.length,q=0;q+3<Z&&(m?(Y={x:r.allpts[q],y:r.allpts[q+1]},U={x:r.allpts[q+2],y:r.allpts[q+3]}):(Y={x:r.allpts[Z-2-q],y:r.allpts[Z-1-q]},U={x:r.allpts[Z-4-q],y:r.allpts[Z-3-q]}),G=qu(Y,U),W=N,N+=G,!(N>=g));q+=2);var X=g-W,ie=X/G;ie=Xg(0,ie,1),t=_ye(Y,U,ie),f=D5(Y,U);break}}o("labelX",h,t.x),o("labelY",h,t.y),o("labelAutoAngle",h,f)}};u("source"),u("target"),this.applyLabelDimensions(a)}};go.applyLabelDimensions=function(a){this.applyPrefixedLabelDimensions(a),a.isEdge()&&(this.applyPrefixedLabelDimensions(a,"source"),this.applyPrefixedLabelDimensions(a,"target"))};go.applyPrefixedLabelDimensions=function(a,t){var e=a._private,r=this.getLabelText(a,t),n=Yu(r,a._private.labelDimsKey);if(ha(e.rscratch,"prefixedLabelDimsKey",t)!==n){el(e.rscratch,"prefixedLabelDimsKey",t,n);var s=this.calculateLabelDimensions(a,r),o=a.pstyle("line-height").pfValue,l=a.pstyle("text-wrap").strValue,c=ha(e.rscratch,"labelWrapCachedLines",t)||[],u=l!=="wrap"?1:Math.max(c.length,1),d=s.height/u,h=d*o,f=s.width,m=s.height+(u-1)*(o-1)*d;el(e.rstyle,"labelWidth",t,f),el(e.rscratch,"labelWidth",t,f),el(e.rstyle,"labelHeight",t,m),el(e.rscratch,"labelHeight",t,m),el(e.rscratch,"labelLineHeight",t,h)}};go.getLabelText=function(a,t){var e=a._private,r=t?t+"-":"",n=a.pstyle(r+"label").strValue,s=a.pstyle("text-transform").value,o=function(K,se){return se?(el(e.rscratch,K,t,se),se):ha(e.rscratch,K,t)};if(!n)return"";s=="none"||(s=="uppercase"?n=n.toUpperCase():s=="lowercase"&&(n=n.toLowerCase()));var l=a.pstyle("text-wrap").value;if(l==="wrap"){var c=o("labelKey");if(c!=null&&o("labelWrapKey")===c)return o("labelWrapCachedText");for(var u="\u200B",d=n.split(`
`),h=a.pstyle("text-max-width").pfValue,f=a.pstyle("text-overflow-wrap").value,m=f==="anywhere",g=[],y=/[\s\u200b]+|$/g,v=0;v<d.length;v++){var E=d[v],C=this.calculateLabelDimensions(a,E),_=C.width;if(m){var x=E.split("").join(u);E=x}if(_>h){var P=E.matchAll(y),I="",M=0,O=pa(P),R;try{for(O.s();!(R=O.n()).done;){var F=R.value,$=F[0],k=E.substring(M,F.index);M=F.index+$.length;var N=I.length===0?k:I+k+$,G=this.calculateLabelDimensions(a,N),W=G.width;W<=h?I+=k+$:(I&&g.push(I),I=k+$)}}catch(j){O.e(j)}finally{O.f()}I.match(/^[\s\u200b]+$/)||g.push(I)}else g.push(E)}o("labelWrapCachedLines",g),n=o("labelWrapCachedText",g.join(`
`)),o("labelWrapKey",c)}else if(l==="ellipsis"){var Y=a.pstyle("text-max-width").pfValue,U="",Z="\u2026",q=!1;if(this.calculateLabelDimensions(a,n).width<Y)return n;for(var X=0;X<n.length;X++){var ie=this.calculateLabelDimensions(a,U+n[X]+Z).width;if(ie>Y)break;U+=n[X],X===n.length-1&&(q=!0)}return q||(U+=Z),U}return n};go.getLabelJustification=function(a){var t=a.pstyle("text-justification").strValue,e=a.pstyle("text-halign").strValue;if(t==="auto")if(a.isNode())switch(e){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return t};go.calculateLabelDimensions=function(a,t){var e=this,r=e.cy.window(),n=r.document,s=0,o=a.pstyle("font-style").strValue,l=a.pstyle("font-size").pfValue,c=a.pstyle("font-family").strValue,u=a.pstyle("font-weight").strValue,d=this.labelCalcCanvas,h=this.labelCalcCanvasContext;if(!d){d=this.labelCalcCanvas=n.createElement("canvas"),h=this.labelCalcCanvasContext=d.getContext("2d");var f=d.style;f.position="absolute",f.left="-9999px",f.top="-9999px",f.zIndex="-1",f.visibility="hidden",f.pointerEvents="none"}h.font="".concat(o," ").concat(u," ").concat(l,"px ").concat(c);for(var m=0,g=0,y=t.split(`
`),v=0;v<y.length;v++){var E=y[v],C=h.measureText(E),_=Math.ceil(C.width),x=l;m=Math.max(_,m),g+=x}return m+=s,g+=s,{width:m,height:g}};go.calculateLabelAngle=function(a,t){var e=a._private,r=e.rscratch,n=a.isEdge(),s=t?t+"-":"",o=a.pstyle(s+"text-rotation"),l=o.strValue;return l==="none"?0:n&&l==="autorotate"?r.labelAutoAngle:l==="autorotate"?0:o.pfValue};go.calculateLabelAngles=function(a){var t=this,e=a.isEdge(),r=a._private,n=r.rscratch;n.labelAngle=t.calculateLabelAngle(a),e&&(n.sourceLabelAngle=t.calculateLabelAngle(a,"source"),n.targetLabelAngle=t.calculateLabelAngle(a,"target"))};P5={},VG=28,WG=!1;P5.getNodeShape=function(a){var t=this,e=a.pstyle("shape").value;if(e==="cutrectangle"&&(a.width()<VG||a.height()<VG))return WG||(cr("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),WG=!0),"rectangle";if(a.isParent())return e==="rectangle"||e==="roundrectangle"||e==="round-rectangle"||e==="cutrectangle"||e==="cut-rectangle"||e==="barrel"?e:"rectangle";if(e==="polygon"){var r=a.pstyle("shape-polygon-points").value;return t.nodeShapes.makePolygon(r).name}return e};Gw={};Gw.registerCalculationListeners=function(){var a=this.cy,t=a.collection(),e=this,r=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(t.merge(o),l)for(var c=0;c<o.length;c++){var u=o[c],d=u._private,h=d.rstyle;h.clean=!1,h.cleanConnected=!1}};e.binder(a).on("bounds.* dirty.*",function(o){var l=o.target;r(l)}).on("style.* background.*",function(o){var l=o.target;r(l,!1)});var n=function(o){if(o){var l=e.onUpdateEleCalcsFns;t.cleanStyle();for(var c=0;c<t.length;c++){var u=t[c],d=u._private.rstyle;u.isNode()&&!d.cleanConnected&&(r(u.connectedEdges()),d.cleanConnected=!0)}if(l)for(var h=0;h<l.length;h++){var f=l[h];f(o,t)}e.recalculateRenderedStyle(t),t=a.collection()}};e.flushRenderedStyleQueue=function(){n(!0)},e.beforeRender(n,e.beforeRenderPriorities.eleCalcs)};Gw.onUpdateEleCalcs=function(a){var t=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];t.push(a)};Gw.recalculateRenderedStyle=function(a,t){var e=function(x){return x._private.rstyle.cleanConnected};if(a.length!==0){var r=[],n=[];if(!this.destroyed){t===void 0&&(t=!0);for(var s=0;s<a.length;s++){var o=a[s],l=o._private,c=l.rstyle;o.isEdge()&&(!e(o.source())||!e(o.target()))&&(c.clean=!1),o.isEdge()&&o.isBundledBezier()&&o.parallelEdges().some(function(_){return!_._private.rstyle.clean&&_.isBundledBezier()})&&(c.clean=!1),!(t&&c.clean||o.removed())&&o.pstyle("display").value!=="none"&&(l.group==="nodes"?n.push(o):r.push(o),c.clean=!0)}for(var u=0;u<n.length;u++){var d=n[u],h=d._private,f=h.rstyle,m=d.position();this.recalculateNodeLabelProjection(d),f.nodeX=m.x,f.nodeY=m.y,f.nodeW=d.pstyle("width").pfValue,f.nodeH=d.pstyle("height").pfValue}this.recalculateEdgeProjections(r);for(var g=0;g<r.length;g++){var y=r[g],v=y._private,E=v.rstyle,C=v.rscratch;E.srcX=C.arrowStartX,E.srcY=C.arrowStartY,E.tgtX=C.arrowEndX,E.tgtY=C.arrowEndY,E.midX=C.midX,E.midY=C.midY,E.labelAngle=C.labelAngle,E.sourceLabelAngle=C.sourceLabelAngle,E.targetLabelAngle=C.targetLabelAngle}}}};Vw={};Vw.updateCachedGrabbedEles=function(){var a=this.cachedZSortedEles;if(a){a.drag=[],a.nondrag=[];for(var t=[],e=0;e<a.length;e++){var r=a[e],n=r._private.rscratch;r.grabbed()&&!r.isParent()?t.push(r):n.inDragLayer?a.drag.push(r):a.nondrag.push(r)}for(var e=0;e<t.length;e++){var r=t[e];a.drag.push(r)}}};Vw.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};Vw.getCachedZSortedEles=function(a){if(a||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(u5),t.interactive=t.filter(function(e){return e.interactive()}),this.cachedZSortedEles=t,this.updateCachedGrabbedEles()}else t=this.cachedZSortedEles;return t};L5={};[Ju,Tw,_n,fv,JD,go,P5,Gw,Vw].forEach(function(a){ut(L5,a)});M5={};M5.getCachedImage=function(a,t,e){var r=this,n=r.imageCache=r.imageCache||{},s=n[a];if(s)return s.image.complete||s.image.addEventListener("load",e),s.image;s=n[a]=n[a]||{};var o=s.image=new Image;o.addEventListener("load",e),o.addEventListener("error",function(){o.error=!0});var l="data:",c=a.substring(0,l.length).toLowerCase()===l;return c||(t=t==="null"?null:t,o.crossOrigin=t),o.src=a,o};kf={};kf.registerBinding=function(a,t,e,r){var n=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(a)){for(var s=[],o=0;o<a.length;o++){var l=a[o];if(l!==void 0){var c=this.binder(l);s.push(c.on.apply(c,n))}}return s}var c=this.binder(a);return c.on.apply(c,n)};kf.binder=function(a){var t=this,e=t.cy.window(),r=a===e||a===e.document||a===e.document.body||pve(a);if(t.supportsPassiveEvents==null){var n=!1;try{var s=Object.defineProperty({},"passive",{get:function(){return n=!0,!0}});e.addEventListener("test",null,s)}catch(l){}t.supportsPassiveEvents=n}var o=function(c,u,d){var h=Array.prototype.slice.call(arguments);return r&&t.supportsPassiveEvents&&(h[2]={capture:d!=null?d:!1,passive:!1,once:!1}),t.bindings.push({target:a,args:h}),(a.addEventListener||a.on).apply(a,h),this};return{on:o,addEventListener:o,addListener:o,bind:o}};kf.nodeIsDraggable=function(a){return a&&a.isNode()&&!a.locked()&&a.grabbable()};kf.nodeIsGrabbable=function(a){return this.nodeIsDraggable(a)&&a.interactive()};kf.load=function(){var a=this,t=a.cy.window(),e=function(ee){return ee.selected()},r=function(ee){var ye=ee.getRootNode();if(ye&&ye.nodeType===11&&ye.host!==void 0)return ye},n=function(ee,ye,Pe,xe){ee==null&&(ee=a.cy);for(var Fe=0;Fe<ye.length;Fe++){var qe=ye[Fe];ee.emit({originalEvent:Pe,type:qe,position:xe})}},s=function(ee){return ee.shiftKey||ee.metaKey||ee.ctrlKey},o=function(ee,ye){var Pe=!0;if(a.cy.hasCompoundNodes()&&ee&&ee.pannable())for(var xe=0;ye&&xe<ye.length;xe++){var ee=ye[xe];if(ee.isNode()&&ee.isParent()&&!ee.pannable()){Pe=!1;break}}else Pe=!0;return Pe},l=function(ee){ee[0]._private.grabbed=!0},c=function(ee){ee[0]._private.grabbed=!1},u=function(ee){ee[0]._private.rscratch.inDragLayer=!0},d=function(ee){ee[0]._private.rscratch.inDragLayer=!1},h=function(ee){ee[0]._private.rscratch.isGrabTarget=!0},f=function(ee){ee[0]._private.rscratch.isGrabTarget=!1},m=function(ee,ye){var Pe=ye.addToList,xe=Pe.has(ee);!xe&&ee.grabbable()&&!ee.locked()&&(Pe.merge(ee),l(ee))},g=function(ee,ye){if(ee.cy().hasCompoundNodes()&&!(ye.inDragLayer==null&&ye.addToList==null)){var Pe=ee.descendants();ye.inDragLayer&&(Pe.forEach(u),Pe.connectedEdges().forEach(u)),ye.addToList&&m(Pe,ye)}},y=function(ee,ye){ye=ye||{};var Pe=ee.cy().hasCompoundNodes();ye.inDragLayer&&(ee.forEach(u),ee.neighborhood().stdFilter(function(xe){return!Pe||xe.isEdge()}).forEach(u)),ye.addToList&&ee.forEach(function(xe){m(xe,ye)}),g(ee,ye),C(ee,{inDragLayer:ye.inDragLayer}),a.updateCachedGrabbedEles()},v=y,E=function(ee){ee&&(a.getCachedZSortedEles().forEach(function(ye){c(ye),d(ye),f(ye)}),a.updateCachedGrabbedEles())},C=function(ee,ye){if(!(ye.inDragLayer==null&&ye.addToList==null)&&ee.cy().hasCompoundNodes()){var Pe=ee.ancestors().orphans();if(!Pe.same(ee)){var xe=Pe.descendants().spawnSelf().merge(Pe).unmerge(ee).unmerge(ee.descendants()),Fe=xe.connectedEdges();ye.inDragLayer&&(Fe.forEach(u),xe.forEach(u)),ye.addToList&&xe.forEach(function(qe){m(qe,ye)})}}},_=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},x=typeof MutationObserver!="undefined",P=typeof ResizeObserver!="undefined";x?(a.removeObserver=new MutationObserver(function(Ie){for(var ee=0;ee<Ie.length;ee++){var ye=Ie[ee],Pe=ye.removedNodes;if(Pe)for(var xe=0;xe<Pe.length;xe++){var Fe=Pe[xe];if(Fe===a.container){a.destroy();break}}}}),a.container.parentNode&&a.removeObserver.observe(a.container.parentNode,{childList:!0})):a.registerBinding(a.container,"DOMNodeRemoved",function(Ie){a.destroy()});var I=cv(function(){a.cy.resize()},100);x&&(a.styleObserver=new MutationObserver(I),a.styleObserver.observe(a.container,{attributes:!0})),a.registerBinding(t,"resize",I),P&&(a.resizeObserver=new ResizeObserver(I),a.resizeObserver.observe(a.container));var M=function(ee,ye){for(;ee!=null;)ye(ee),ee=ee.parentNode},O=function(){a.invalidateContainerClientCoordsCache()};M(a.container,function(Ie){a.registerBinding(Ie,"transitionend",O),a.registerBinding(Ie,"animationend",O),a.registerBinding(Ie,"scroll",O)}),a.registerBinding(a.container,"contextmenu",function(Ie){Ie.preventDefault()});var R=function(){return a.selection[4]!==0},F=function(ee){for(var ye=a.findContainerClientCoords(),Pe=ye[0],xe=ye[1],Fe=ye[2],qe=ye[3],Re=ee.touches?ee.touches:[ee],ze=!1,Ze=0;Ze<Re.length;Ze++){var rt=Re[Ze];if(Pe<=rt.clientX&&rt.clientX<=Pe+Fe&&xe<=rt.clientY&&rt.clientY<=xe+qe){ze=!0;break}}if(!ze)return!1;for(var Ct=a.container,bt=ee.target,Xe=bt.parentNode,wt=!1;Xe;){if(Xe===Ct){wt=!0;break}Xe=Xe.parentNode}return!!wt};a.registerBinding(a.container,"mousedown",function(ee){if(F(ee)&&!(a.hoverData.which===1&&ee.which!==1)){ee.preventDefault(),_(),a.hoverData.capture=!0,a.hoverData.which=ee.which;var ye=a.cy,Pe=[ee.clientX,ee.clientY],xe=a.projectIntoViewport(Pe[0],Pe[1]),Fe=a.selection,qe=a.findNearestElements(xe[0],xe[1],!0,!1),Re=qe[0],ze=a.dragData.possibleDragElements;a.hoverData.mdownPos=xe,a.hoverData.mdownGPos=Pe;var Ze=function(vt){return{originalEvent:ee,type:vt,position:{x:xe[0],y:xe[1]}}},rt=function(){a.hoverData.tapholdCancelled=!1,clearTimeout(a.hoverData.tapholdTimeout),a.hoverData.tapholdTimeout=setTimeout(function(){if(!a.hoverData.tapholdCancelled){var vt=a.hoverData.down;vt?vt.emit(Ze("taphold")):ye.emit(Ze("taphold"))}},a.tapholdDuration)};if(ee.which==3){a.hoverData.cxtStarted=!0;var Ct={originalEvent:ee,type:"cxttapstart",position:{x:xe[0],y:xe[1]}};Re?(Re.activate(),Re.emit(Ct),a.hoverData.down=Re):ye.emit(Ct),a.hoverData.downTime=new Date().getTime(),a.hoverData.cxtDragged=!1}else if(ee.which==1){Re&&Re.activate();{if(Re!=null&&a.nodeIsGrabbable(Re)){var bt=function(vt){vt.emit(Ze("grab"))};if(h(Re),!Re.selected())ze=a.dragData.possibleDragElements=ye.collection(),v(Re,{addToList:ze}),Re.emit(Ze("grabon")).emit(Ze("grab"));else{ze=a.dragData.possibleDragElements=ye.collection();var Xe=ye.$(function(wt){return wt.isNode()&&wt.selected()&&a.nodeIsGrabbable(wt)});y(Xe,{addToList:ze}),Re.emit(Ze("grabon")),Xe.forEach(bt)}a.redrawHint("eles",!0),a.redrawHint("drag",!0)}a.hoverData.down=Re,a.hoverData.downs=qe,a.hoverData.downTime=new Date().getTime()}n(Re,["mousedown","tapstart","vmousedown"],ee,{x:xe[0],y:xe[1]}),Re==null?(Fe[4]=1,a.data.bgActivePosistion={x:xe[0],y:xe[1]},a.redrawHint("select",!0),a.redraw()):Re.pannable()&&(Fe[4]=1),rt()}Fe[0]=Fe[2]=xe[0],Fe[1]=Fe[3]=xe[1]}},!1);var $=r(a.container);a.registerBinding([t,$],"mousemove",function(ee){var ye=a.hoverData.capture;if(!(!ye&&!F(ee))){var Pe=!1,xe=a.cy,Fe=xe.zoom(),qe=[ee.clientX,ee.clientY],Re=a.projectIntoViewport(qe[0],qe[1]),ze=a.hoverData.mdownPos,Ze=a.hoverData.mdownGPos,rt=a.selection,Ct=null;!a.hoverData.draggingEles&&!a.hoverData.dragging&&!a.hoverData.selecting&&(Ct=a.findNearestElement(Re[0],Re[1],!0,!1));var bt=a.hoverData.last,Xe=a.hoverData.down,wt=[Re[0]-rt[2],Re[1]-rt[3]],vt=a.dragData.possibleDragElements,Kr;if(Ze){var ur=qe[0]-Ze[0],Si=ur*ur,mr=qe[1]-Ze[1],Wt=mr*mr,De=Si+Wt;a.hoverData.isOverThresholdDrag=Kr=De>=a.desktopTapThreshold2}var ri=s(ee);Kr&&(a.hoverData.tapholdCancelled=!0);var va=function(){var Rr=a.hoverData.dragDelta=a.hoverData.dragDelta||[];Rr.length===0?(Rr.push(wt[0]),Rr.push(wt[1])):(Rr[0]+=wt[0],Rr[1]+=wt[1])};Pe=!0,n(Ct,["mousemove","vmousemove","tapdrag"],ee,{x:Re[0],y:Re[1]});var Nt=function(Rr){return{originalEvent:ee,type:Rr,position:{x:Re[0],y:Re[1]}}},un=function(){a.data.bgActivePosistion=void 0,a.hoverData.selecting||xe.emit(Nt("boxstart")),rt[4]=1,a.hoverData.selecting=!0,a.redrawHint("select",!0),a.redraw()};if(a.hoverData.which===3){if(Kr){var Dt=Nt("cxtdrag");Xe?Xe.emit(Dt):xe.emit(Dt),a.hoverData.cxtDragged=!0,(!a.hoverData.cxtOver||Ct!==a.hoverData.cxtOver)&&(a.hoverData.cxtOver&&a.hoverData.cxtOver.emit(Nt("cxtdragout")),a.hoverData.cxtOver=Ct,Ct&&Ct.emit(Nt("cxtdragover")))}}else if(a.hoverData.dragging){if(Pe=!0,xe.panningEnabled()&&xe.userPanningEnabled()){var Dn;if(a.hoverData.justStartedPan){var ya=a.hoverData.mdownPos;Dn={x:(Re[0]-ya[0])*Fe,y:(Re[1]-ya[1])*Fe},a.hoverData.justStartedPan=!1}else Dn={x:wt[0]*Fe,y:wt[1]*Fe};xe.panBy(Dn),xe.emit(Nt("dragpan")),a.hoverData.dragged=!0}Re=a.projectIntoViewport(ee.clientX,ee.clientY)}else if(rt[4]==1&&(Xe==null||Xe.pannable())){if(Kr){if(!a.hoverData.dragging&&xe.boxSelectionEnabled()&&(ri||!xe.panningEnabled()||!xe.userPanningEnabled()))un();else if(!a.hoverData.selecting&&xe.panningEnabled()&&xe.userPanningEnabled()){var Sr=o(Xe,a.hoverData.downs);Sr&&(a.hoverData.dragging=!0,a.hoverData.justStartedPan=!0,rt[4]=0,a.data.bgActivePosistion=ff(ze),a.redrawHint("select",!0),a.redraw())}Xe&&Xe.pannable()&&Xe.active()&&Xe.unactivate()}}else{if(Xe&&Xe.pannable()&&Xe.active()&&Xe.unactivate(),(!Xe||!Xe.grabbed())&&Ct!=bt&&(bt&&n(bt,["mouseout","tapdragout"],ee,{x:Re[0],y:Re[1]}),Ct&&n(Ct,["mouseover","tapdragover"],ee,{x:Re[0],y:Re[1]}),a.hoverData.last=Ct),Xe)if(Kr){if(xe.boxSelectionEnabled()&&ri)Xe&&Xe.grabbed()&&(E(vt),Xe.emit(Nt("freeon")),vt.emit(Nt("free")),a.dragData.didDrag&&(Xe.emit(Nt("dragfreeon")),vt.emit(Nt("dragfree")))),un();else if(Xe&&Xe.grabbed()&&a.nodeIsDraggable(Xe)){var Lr=!a.dragData.didDrag;Lr&&a.redrawHint("eles",!0),a.dragData.didDrag=!0,a.hoverData.draggingEles||y(vt,{inDragLayer:!0});var dr={x:0,y:0};if(We(wt[0])&&We(wt[1])&&(dr.x+=wt[0],dr.y+=wt[1],Lr)){var zt=a.hoverData.dragDelta;zt&&We(zt[0])&&We(zt[1])&&(dr.x+=zt[0],dr.y+=zt[1])}a.hoverData.draggingEles=!0,vt.silentShift(dr).emit(Nt("position")).emit(Nt("drag")),a.redrawHint("drag",!0),a.redraw()}}else va();Pe=!0}if(rt[2]=Re[0],rt[3]=Re[1],Pe)return ee.stopPropagation&&ee.stopPropagation(),ee.preventDefault&&ee.preventDefault(),!1}},!1);var k,N,G;a.registerBinding(t,"mouseup",function(ee){if(!(a.hoverData.which===1&&ee.which!==1&&a.hoverData.capture)){var ye=a.hoverData.capture;if(ye){a.hoverData.capture=!1;var Pe=a.cy,xe=a.projectIntoViewport(ee.clientX,ee.clientY),Fe=a.selection,qe=a.findNearestElement(xe[0],xe[1],!0,!1),Re=a.dragData.possibleDragElements,ze=a.hoverData.down,Ze=s(ee);a.data.bgActivePosistion&&(a.redrawHint("select",!0),a.redraw()),a.hoverData.tapholdCancelled=!0,a.data.bgActivePosistion=void 0,ze&&ze.unactivate();var rt=function(ur){return{originalEvent:ee,type:ur,position:{x:xe[0],y:xe[1]}}};if(a.hoverData.which===3){var Ct=rt("cxttapend");if(ze?ze.emit(Ct):Pe.emit(Ct),!a.hoverData.cxtDragged){var bt=rt("cxttap");ze?ze.emit(bt):Pe.emit(bt)}a.hoverData.cxtDragged=!1,a.hoverData.which=null}else if(a.hoverData.which===1){if(n(qe,["mouseup","tapend","vmouseup"],ee,{x:xe[0],y:xe[1]}),!a.dragData.didDrag&&!a.hoverData.dragged&&!a.hoverData.selecting&&!a.hoverData.isOverThresholdDrag&&(n(ze,["click","tap","vclick"],ee,{x:xe[0],y:xe[1]}),N=!1,ee.timeStamp-G<=Pe.multiClickDebounceTime()?(k&&clearTimeout(k),N=!0,G=null,n(ze,["dblclick","dbltap","vdblclick"],ee,{x:xe[0],y:xe[1]})):(k=setTimeout(function(){N||n(ze,["oneclick","onetap","voneclick"],ee,{x:xe[0],y:xe[1]})},Pe.multiClickDebounceTime()),G=ee.timeStamp)),ze==null&&!a.dragData.didDrag&&!a.hoverData.selecting&&!a.hoverData.dragged&&!s(ee)&&(Pe.$(e).unselect(["tapunselect"]),Re.length>0&&a.redrawHint("eles",!0),a.dragData.possibleDragElements=Re=Pe.collection()),qe==ze&&!a.dragData.didDrag&&!a.hoverData.selecting&&qe!=null&&qe._private.selectable&&(a.hoverData.dragging||(Pe.selectionType()==="additive"||Ze?qe.selected()?qe.unselect(["tapunselect"]):qe.select(["tapselect"]):Ze||(Pe.$(e).unmerge(qe).unselect(["tapunselect"]),qe.select(["tapselect"]))),a.redrawHint("eles",!0)),a.hoverData.selecting){var Xe=Pe.collection(a.getAllInBox(Fe[0],Fe[1],Fe[2],Fe[3]));a.redrawHint("select",!0),Xe.length>0&&a.redrawHint("eles",!0),Pe.emit(rt("boxend"));var wt=function(ur){return ur.selectable()&&!ur.selected()};Pe.selectionType()==="additive"||Ze||Pe.$(e).unmerge(Xe).unselect(),Xe.emit(rt("box")).stdFilter(wt).select().emit(rt("boxselect")),a.redraw()}if(a.hoverData.dragging&&(a.hoverData.dragging=!1,a.redrawHint("select",!0),a.redrawHint("eles",!0),a.redraw()),!Fe[4]){a.redrawHint("drag",!0),a.redrawHint("eles",!0);var vt=ze&&ze.grabbed();E(Re),vt&&(ze.emit(rt("freeon")),Re.emit(rt("free")),a.dragData.didDrag&&(ze.emit(rt("dragfreeon")),Re.emit(rt("dragfree"))))}}Fe[4]=0,a.hoverData.down=null,a.hoverData.cxtStarted=!1,a.hoverData.draggingEles=!1,a.hoverData.selecting=!1,a.hoverData.isOverThresholdDrag=!1,a.dragData.didDrag=!1,a.hoverData.dragged=!1,a.hoverData.dragDelta=[],a.hoverData.mdownPos=null,a.hoverData.mdownGPos=null,a.hoverData.which=null}}},!1);var W=[],Y=4,U,Z=1e5,q=function(ee,ye){for(var Pe=0;Pe<ee.length;Pe++)if(ee[Pe]%ye!==0)return!1;return!0},X=function(ee){for(var ye=Math.abs(ee[0]),Pe=1;Pe<ee.length;Pe++)if(Math.abs(ee[Pe])!==ye)return!1;return!0},ie=function(ee){var ye=!1,Pe=ee.deltaY;if(Pe==null&&(ee.wheelDeltaY!=null?Pe=ee.wheelDeltaY/4:ee.wheelDelta!=null&&(Pe=ee.wheelDelta/4)),Pe!==0){if(U==null)if(W.length>=Y){var xe=W;if(U=q(xe,5),!U){var Fe=Math.abs(xe[0]);U=X(xe)&&Fe>5}if(U)for(var qe=0;qe<xe.length;qe++)Z=Math.min(Math.abs(xe[qe]),Z)}else W.push(Pe),ye=!0;else U&&(Z=Math.min(Math.abs(Pe),Z));if(!a.scrollingPage){var Re=a.cy,ze=Re.zoom(),Ze=Re.pan(),rt=a.projectIntoViewport(ee.clientX,ee.clientY),Ct=[rt[0]*ze+Ze.x,rt[1]*ze+Ze.y];if(a.hoverData.draggingEles||a.hoverData.dragging||a.hoverData.cxtStarted||R()){ee.preventDefault();return}if(Re.panningEnabled()&&Re.userPanningEnabled()&&Re.zoomingEnabled()&&Re.userZoomingEnabled()){ee.preventDefault(),a.data.wheelZooming=!0,clearTimeout(a.data.wheelTimeout),a.data.wheelTimeout=setTimeout(function(){a.data.wheelZooming=!1,a.redrawHint("eles",!0),a.redraw()},150);var bt;ye&&Math.abs(Pe)>5&&(Pe=BD(Pe)*5),bt=Pe/-250,U&&(bt/=Z,bt*=3),bt=bt*a.wheelSensitivity;var Xe=ee.deltaMode===1;Xe&&(bt*=33);var wt=Re.zoom()*Math.pow(10,bt);ee.type==="gesturechange"&&(wt=a.gestureStartZoom*ee.scale),Re.zoom({level:wt,renderedPosition:{x:Ct[0],y:Ct[1]}}),Re.emit({type:ee.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:ee,position:{x:rt[0],y:rt[1]}})}}}};a.registerBinding(a.container,"wheel",ie,!0),a.registerBinding(t,"scroll",function(ee){a.scrollingPage=!0,clearTimeout(a.scrollingPageTimeout),a.scrollingPageTimeout=setTimeout(function(){a.scrollingPage=!1},250)},!0),a.registerBinding(a.container,"gesturestart",function(ee){a.gestureStartZoom=a.cy.zoom(),a.hasTouchStarted||ee.preventDefault()},!0),a.registerBinding(a.container,"gesturechange",function(Ie){a.hasTouchStarted||ie(Ie)},!0),a.registerBinding(a.container,"mouseout",function(ee){var ye=a.projectIntoViewport(ee.clientX,ee.clientY);a.cy.emit({originalEvent:ee,type:"mouseout",position:{x:ye[0],y:ye[1]}})},!1),a.registerBinding(a.container,"mouseover",function(ee){var ye=a.projectIntoViewport(ee.clientX,ee.clientY);a.cy.emit({originalEvent:ee,type:"mouseover",position:{x:ye[0],y:ye[1]}})},!1);var j,K,se,ne,ge,ve,Se,Te,me,pe,B,oe,he,te=function(ee,ye,Pe,xe){return Math.sqrt((Pe-ee)*(Pe-ee)+(xe-ye)*(xe-ye))},re=function(ee,ye,Pe,xe){return(Pe-ee)*(Pe-ee)+(xe-ye)*(xe-ye)},ce;a.registerBinding(a.container,"touchstart",ce=function(ee){if(a.hasTouchStarted=!0,!!F(ee)){_(),a.touchData.capture=!0,a.data.bgActivePosistion=void 0;var ye=a.cy,Pe=a.touchData.now,xe=a.touchData.earlier;if(ee.touches[0]){var Fe=a.projectIntoViewport(ee.touches[0].clientX,ee.touches[0].clientY);Pe[0]=Fe[0],Pe[1]=Fe[1]}if(ee.touches[1]){var Fe=a.projectIntoViewport(ee.touches[1].clientX,ee.touches[1].clientY);Pe[2]=Fe[0],Pe[3]=Fe[1]}if(ee.touches[2]){var Fe=a.projectIntoViewport(ee.touches[2].clientX,ee.touches[2].clientY);Pe[4]=Fe[0],Pe[5]=Fe[1]}var qe=function(ri){return{originalEvent:ee,type:ri,position:{x:Pe[0],y:Pe[1]}}};if(ee.touches[1]){a.touchData.singleTouchMoved=!0,E(a.dragData.touchDragEles);var Re=a.findContainerClientCoords();me=Re[0],pe=Re[1],B=Re[2],oe=Re[3],j=ee.touches[0].clientX-me,K=ee.touches[0].clientY-pe,se=ee.touches[1].clientX-me,ne=ee.touches[1].clientY-pe,he=0<=j&&j<=B&&0<=se&&se<=B&&0<=K&&K<=oe&&0<=ne&&ne<=oe;var ze=ye.pan(),Ze=ye.zoom();ge=te(j,K,se,ne),ve=re(j,K,se,ne),Se=[(j+se)/2,(K+ne)/2],Te=[(Se[0]-ze.x)/Ze,(Se[1]-ze.y)/Ze];var rt=200,Ct=rt*rt;if(ve<Ct&&!ee.touches[2]){var bt=a.findNearestElement(Pe[0],Pe[1],!0,!0),Xe=a.findNearestElement(Pe[2],Pe[3],!0,!0);bt&&bt.isNode()?(bt.activate().emit(qe("cxttapstart")),a.touchData.start=bt):Xe&&Xe.isNode()?(Xe.activate().emit(qe("cxttapstart")),a.touchData.start=Xe):ye.emit(qe("cxttapstart")),a.touchData.start&&(a.touchData.start._private.grabbed=!1),a.touchData.cxt=!0,a.touchData.cxtDragged=!1,a.data.bgActivePosistion=void 0,a.redraw();return}}if(ee.touches[2])ye.boxSelectionEnabled()&&ee.preventDefault();else if(!ee.touches[1]){if(ee.touches[0]){var wt=a.findNearestElements(Pe[0],Pe[1],!0,!0),vt=wt[0];if(vt!=null&&(vt.activate(),a.touchData.start=vt,a.touchData.starts=wt,a.nodeIsGrabbable(vt))){var Kr=a.dragData.touchDragEles=ye.collection(),ur=null;a.redrawHint("eles",!0),a.redrawHint("drag",!0),vt.selected()?(ur=ye.$(function(De){return De.selected()&&a.nodeIsGrabbable(De)}),y(ur,{addToList:Kr})):v(vt,{addToList:Kr}),h(vt),vt.emit(qe("grabon")),ur?ur.forEach(function(De){De.emit(qe("grab"))}):vt.emit(qe("grab"))}n(vt,["touchstart","tapstart","vmousedown"],ee,{x:Pe[0],y:Pe[1]}),vt==null&&(a.data.bgActivePosistion={x:Fe[0],y:Fe[1]},a.redrawHint("select",!0),a.redraw()),a.touchData.singleTouchMoved=!1,a.touchData.singleTouchStartTime=+new Date,clearTimeout(a.touchData.tapholdTimeout),a.touchData.tapholdTimeout=setTimeout(function(){a.touchData.singleTouchMoved===!1&&!a.pinching&&!a.touchData.selecting&&n(a.touchData.start,["taphold"],ee,{x:Pe[0],y:Pe[1]})},a.tapholdDuration)}}if(ee.touches.length>=1){for(var Si=a.touchData.startPosition=[null,null,null,null,null,null],mr=0;mr<Pe.length;mr++)Si[mr]=xe[mr]=Pe[mr];var Wt=ee.touches[0];a.touchData.startGPosition=[Wt.clientX,Wt.clientY]}}},!1);var Ee;a.registerBinding(t,"touchmove",Ee=function(ee){var ye=a.touchData.capture;if(!(!ye&&!F(ee))){var Pe=a.selection,xe=a.cy,Fe=a.touchData.now,qe=a.touchData.earlier,Re=xe.zoom();if(ee.touches[0]){var ze=a.projectIntoViewport(ee.touches[0].clientX,ee.touches[0].clientY);Fe[0]=ze[0],Fe[1]=ze[1]}if(ee.touches[1]){var ze=a.projectIntoViewport(ee.touches[1].clientX,ee.touches[1].clientY);Fe[2]=ze[0],Fe[3]=ze[1]}if(ee.touches[2]){var ze=a.projectIntoViewport(ee.touches[2].clientX,ee.touches[2].clientY);Fe[4]=ze[0],Fe[5]=ze[1]}var Ze=function(Ha){return{originalEvent:ee,type:Ha,position:{x:Fe[0],y:Fe[1]}}},rt=a.touchData.startGPosition,Ct;if(ye&&ee.touches[0]&&rt){for(var bt=[],Xe=0;Xe<Fe.length;Xe++)bt[Xe]=Fe[Xe]-qe[Xe];var wt=ee.touches[0].clientX-rt[0],vt=wt*wt,Kr=ee.touches[0].clientY-rt[1],ur=Kr*Kr,Si=vt+ur;Ct=Si>=a.touchTapThreshold2}if(ye&&a.touchData.cxt){ee.preventDefault();var mr=ee.touches[0].clientX-me,Wt=ee.touches[0].clientY-pe,De=ee.touches[1].clientX-me,ri=ee.touches[1].clientY-pe,va=re(mr,Wt,De,ri),Nt=va/ve,un=150,Dt=un*un,Dn=1.5,ya=Dn*Dn;if(Nt>=ya||va>=Dt){a.touchData.cxt=!1,a.data.bgActivePosistion=void 0,a.redrawHint("select",!0);var Sr=Ze("cxttapend");a.touchData.start?(a.touchData.start.unactivate().emit(Sr),a.touchData.start=null):xe.emit(Sr)}}if(ye&&a.touchData.cxt){var Sr=Ze("cxtdrag");a.data.bgActivePosistion=void 0,a.redrawHint("select",!0),a.touchData.start?a.touchData.start.emit(Sr):xe.emit(Sr),a.touchData.start&&(a.touchData.start._private.grabbed=!1),a.touchData.cxtDragged=!0;var Lr=a.findNearestElement(Fe[0],Fe[1],!0,!0);(!a.touchData.cxtOver||Lr!==a.touchData.cxtOver)&&(a.touchData.cxtOver&&a.touchData.cxtOver.emit(Ze("cxtdragout")),a.touchData.cxtOver=Lr,Lr&&Lr.emit(Ze("cxtdragover")))}else if(ye&&ee.touches[2]&&xe.boxSelectionEnabled())ee.preventDefault(),a.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,a.touchData.selecting||xe.emit(Ze("boxstart")),a.touchData.selecting=!0,a.touchData.didSelect=!0,Pe[4]=1,!Pe||Pe.length===0||Pe[0]===void 0?(Pe[0]=(Fe[0]+Fe[2]+Fe[4])/3,Pe[1]=(Fe[1]+Fe[3]+Fe[5])/3,Pe[2]=(Fe[0]+Fe[2]+Fe[4])/3+1,Pe[3]=(Fe[1]+Fe[3]+Fe[5])/3+1):(Pe[2]=(Fe[0]+Fe[2]+Fe[4])/3,Pe[3]=(Fe[1]+Fe[3]+Fe[5])/3),a.redrawHint("select",!0),a.redraw();else if(ye&&ee.touches[1]&&!a.touchData.didSelect&&xe.zoomingEnabled()&&xe.panningEnabled()&&xe.userZoomingEnabled()&&xe.userPanningEnabled()){ee.preventDefault(),a.data.bgActivePosistion=void 0,a.redrawHint("select",!0);var dr=a.dragData.touchDragEles;if(dr){a.redrawHint("drag",!0);for(var zt=0;zt<dr.length;zt++){var xi=dr[zt]._private;xi.grabbed=!1,xi.rscratch.inDragLayer=!1}}var Rr=a.touchData.start,mr=ee.touches[0].clientX-me,Wt=ee.touches[0].clientY-pe,De=ee.touches[1].clientX-me,ri=ee.touches[1].clientY-pe,$a=te(mr,Wt,De,ri),ll=$a/ge;if(he){var Rf=mr-j,Nf=Wt-K,Nr=De-se,cl=ri-ne,Bf=(Rf+Nr)/2,ul=(Nf+cl)/2,qn=xe.zoom(),dl=qn*ll,wo=xe.pan(),Ws=Te[0]*qn+wo.x,Bt=Te[1]*qn+wo.y,xr={x:-dl/qn*(Ws-wo.x-Bf)+Ws,y:-dl/qn*(Bt-wo.y-ul)+Bt};if(Rr&&Rr.active()){var dr=a.dragData.touchDragEles;E(dr),a.redrawHint("drag",!0),a.redrawHint("eles",!0),Rr.unactivate().emit(Ze("freeon")),dr.emit(Ze("free")),a.dragData.didDrag&&(Rr.emit(Ze("dragfreeon")),dr.emit(Ze("dragfree")))}xe.viewport({zoom:dl,pan:xr,cancelOnFailedZoom:!0}),xe.emit(Ze("pinchzoom")),ge=$a,j=mr,K=Wt,se=De,ne=ri,a.pinching=!0}if(ee.touches[0]){var ze=a.projectIntoViewport(ee.touches[0].clientX,ee.touches[0].clientY);Fe[0]=ze[0],Fe[1]=ze[1]}if(ee.touches[1]){var ze=a.projectIntoViewport(ee.touches[1].clientX,ee.touches[1].clientY);Fe[2]=ze[0],Fe[3]=ze[1]}if(ee.touches[2]){var ze=a.projectIntoViewport(ee.touches[2].clientX,ee.touches[2].clientY);Fe[4]=ze[0],Fe[5]=ze[1]}}else if(ee.touches[0]&&!a.touchData.didSelect){var $i=a.touchData.start,ba=a.touchData.last,Lr;if(!a.hoverData.draggingEles&&!a.swipePanning&&(Lr=a.findNearestElement(Fe[0],Fe[1],!0,!0)),ye&&$i!=null&&ee.preventDefault(),ye&&$i!=null&&a.nodeIsDraggable($i))if(Ct){var dr=a.dragData.touchDragEles,za=!a.dragData.didDrag;za&&y(dr,{inDragLayer:!0}),a.dragData.didDrag=!0;var ds={x:0,y:0};if(We(bt[0])&&We(bt[1])&&(ds.x+=bt[0],ds.y+=bt[1],za)){a.redrawHint("eles",!0);var ot=a.touchData.dragDelta;ot&&We(ot[0])&&We(ot[1])&&(ds.x+=ot[0],ds.y+=ot[1])}a.hoverData.draggingEles=!0,dr.silentShift(ds).emit(Ze("position")).emit(Ze("drag")),a.redrawHint("drag",!0),a.touchData.startPosition[0]==qe[0]&&a.touchData.startPosition[1]==qe[1]&&a.redrawHint("eles",!0),a.redraw()}else{var ot=a.touchData.dragDelta=a.touchData.dragDelta||[];ot.length===0?(ot.push(bt[0]),ot.push(bt[1])):(ot[0]+=bt[0],ot[1]+=bt[1])}if(n($i||Lr,["touchmove","tapdrag","vmousemove"],ee,{x:Fe[0],y:Fe[1]}),(!$i||!$i.grabbed())&&Lr!=ba&&(ba&&ba.emit(Ze("tapdragout")),Lr&&Lr.emit(Ze("tapdragover"))),a.touchData.last=Lr,ye)for(var zt=0;zt<Fe.length;zt++)Fe[zt]&&a.touchData.startPosition[zt]&&Ct&&(a.touchData.singleTouchMoved=!0);if(ye&&($i==null||$i.pannable())&&xe.panningEnabled()&&xe.userPanningEnabled()){var Br=o($i,a.touchData.starts);Br&&(ee.preventDefault(),a.data.bgActivePosistion||(a.data.bgActivePosistion=ff(a.touchData.startPosition)),a.swipePanning?(xe.panBy({x:bt[0]*Re,y:bt[1]*Re}),xe.emit(Ze("dragpan"))):Ct&&(a.swipePanning=!0,xe.panBy({x:wt*Re,y:Kr*Re}),xe.emit(Ze("dragpan")),$i&&($i.unactivate(),a.redrawHint("select",!0),a.touchData.start=null)));var ze=a.projectIntoViewport(ee.touches[0].clientX,ee.touches[0].clientY);Fe[0]=ze[0],Fe[1]=ze[1]}}for(var Xe=0;Xe<Fe.length;Xe++)qe[Xe]=Fe[Xe];ye&&ee.touches.length>0&&!a.hoverData.draggingEles&&!a.swipePanning&&a.data.bgActivePosistion!=null&&(a.data.bgActivePosistion=void 0,a.redrawHint("select",!0),a.redraw())}},!1);var Ce;a.registerBinding(t,"touchcancel",Ce=function(ee){var ye=a.touchData.start;a.touchData.capture=!1,ye&&ye.unactivate()});var le,we,Le,Me;if(a.registerBinding(t,"touchend",le=function(ee){var ye=a.touchData.start,Pe=a.touchData.capture;if(Pe)ee.touches.length===0&&(a.touchData.capture=!1),ee.preventDefault();else return;var xe=a.selection;a.swipePanning=!1,a.hoverData.draggingEles=!1;var Fe=a.cy,qe=Fe.zoom(),Re=a.touchData.now,ze=a.touchData.earlier;if(ee.touches[0]){var Ze=a.projectIntoViewport(ee.touches[0].clientX,ee.touches[0].clientY);Re[0]=Ze[0],Re[1]=Ze[1]}if(ee.touches[1]){var Ze=a.projectIntoViewport(ee.touches[1].clientX,ee.touches[1].clientY);Re[2]=Ze[0],Re[3]=Ze[1]}if(ee.touches[2]){var Ze=a.projectIntoViewport(ee.touches[2].clientX,ee.touches[2].clientY);Re[4]=Ze[0],Re[5]=Ze[1]}var rt=function(Dt){return{originalEvent:ee,type:Dt,position:{x:Re[0],y:Re[1]}}};ye&&ye.unactivate();var Ct;if(a.touchData.cxt){if(Ct=rt("cxttapend"),ye?ye.emit(Ct):Fe.emit(Ct),!a.touchData.cxtDragged){var bt=rt("cxttap");ye?ye.emit(bt):Fe.emit(bt)}a.touchData.start&&(a.touchData.start._private.grabbed=!1),a.touchData.cxt=!1,a.touchData.start=null,a.redraw();return}if(!ee.touches[2]&&Fe.boxSelectionEnabled()&&a.touchData.selecting){a.touchData.selecting=!1;var Xe=Fe.collection(a.getAllInBox(xe[0],xe[1],xe[2],xe[3]));xe[0]=void 0,xe[1]=void 0,xe[2]=void 0,xe[3]=void 0,xe[4]=0,a.redrawHint("select",!0),Fe.emit(rt("boxend"));var wt=function(Dt){return Dt.selectable()&&!Dt.selected()};Xe.emit(rt("box")).stdFilter(wt).select().emit(rt("boxselect")),Xe.nonempty()&&a.redrawHint("eles",!0),a.redraw()}if(ye!=null&&ye.unactivate(),ee.touches[2])a.data.bgActivePosistion=void 0,a.redrawHint("select",!0);else if(!ee.touches[1]){if(!ee.touches[0]){if(!ee.touches[0]){a.data.bgActivePosistion=void 0,a.redrawHint("select",!0);var vt=a.dragData.touchDragEles;if(ye!=null){var Kr=ye._private.grabbed;E(vt),a.redrawHint("drag",!0),a.redrawHint("eles",!0),Kr&&(ye.emit(rt("freeon")),vt.emit(rt("free")),a.dragData.didDrag&&(ye.emit(rt("dragfreeon")),vt.emit(rt("dragfree")))),n(ye,["touchend","tapend","vmouseup","tapdragout"],ee,{x:Re[0],y:Re[1]}),ye.unactivate(),a.touchData.start=null}else{var ur=a.findNearestElement(Re[0],Re[1],!0,!0);n(ur,["touchend","tapend","vmouseup","tapdragout"],ee,{x:Re[0],y:Re[1]})}var Si=a.touchData.startPosition[0]-Re[0],mr=Si*Si,Wt=a.touchData.startPosition[1]-Re[1],De=Wt*Wt,ri=mr+De,va=ri*qe*qe;a.touchData.singleTouchMoved||(ye||Fe.$(":selected").unselect(["tapunselect"]),n(ye,["tap","vclick"],ee,{x:Re[0],y:Re[1]}),we=!1,ee.timeStamp-Me<=Fe.multiClickDebounceTime()?(Le&&clearTimeout(Le),we=!0,Me=null,n(ye,["dbltap","vdblclick"],ee,{x:Re[0],y:Re[1]})):(Le=setTimeout(function(){we||n(ye,["onetap","voneclick"],ee,{x:Re[0],y:Re[1]})},Fe.multiClickDebounceTime()),Me=ee.timeStamp)),ye!=null&&!a.dragData.didDrag&&ye._private.selectable&&va<a.touchTapThreshold2&&!a.pinching&&(Fe.selectionType()==="single"?(Fe.$(e).unmerge(ye).unselect(["tapunselect"]),ye.select(["tapselect"])):ye.selected()?ye.unselect(["tapunselect"]):ye.select(["tapselect"]),a.redrawHint("eles",!0)),a.touchData.singleTouchMoved=!0}}}for(var Nt=0;Nt<Re.length;Nt++)ze[Nt]=Re[Nt];a.dragData.didDrag=!1,ee.touches.length===0&&(a.touchData.dragDelta=[],a.touchData.startPosition=[null,null,null,null,null,null],a.touchData.startGPosition=null,a.touchData.didSelect=!1),ee.touches.length<2&&(ee.touches.length===1&&(a.touchData.startGPosition=[ee.touches[0].clientX,ee.touches[0].clientY]),a.pinching=!1,a.redrawHint("eles",!0),a.redraw())},!1),typeof TouchEvent=="undefined"){var Ne=[],Ge=function(ee){return{clientX:ee.clientX,clientY:ee.clientY,force:1,identifier:ee.pointerId,pageX:ee.pageX,pageY:ee.pageY,radiusX:ee.width/2,radiusY:ee.height/2,screenX:ee.screenX,screenY:ee.screenY,target:ee.target}},Ye=function(ee){return{event:ee,touch:Ge(ee)}},ft=function(ee){Ne.push(Ye(ee))},ct=function(ee){for(var ye=0;ye<Ne.length;ye++){var Pe=Ne[ye];if(Pe.event.pointerId===ee.pointerId){Ne.splice(ye,1);return}}},Ve=function(ee){var ye=Ne.filter(function(Pe){return Pe.event.pointerId===ee.pointerId})[0];ye.event=ee,ye.touch=Ge(ee)},et=function(ee){ee.touches=Ne.map(function(ye){return ye.touch})},$e=function(ee){return ee.pointerType==="mouse"||ee.pointerType===4};a.registerBinding(a.container,"pointerdown",function(Ie){$e(Ie)||(Ie.preventDefault(),ft(Ie),et(Ie),ce(Ie))}),a.registerBinding(a.container,"pointerup",function(Ie){$e(Ie)||(ct(Ie),et(Ie),le(Ie))}),a.registerBinding(a.container,"pointercancel",function(Ie){$e(Ie)||(ct(Ie),et(Ie),Ce(Ie))}),a.registerBinding(a.container,"pointermove",function(Ie){$e(Ie)||(Ie.preventDefault(),Ve(Ie),et(Ie),Ee(Ie))})}};nl={};nl.generatePolygon=function(a,t){return this.nodeShapes[a]={renderer:this,name:a,points:t,draw:function(r,n,s,o,l,c){this.renderer.nodeShapeImpl("polygon",r,n,s,o,l,this.points)},intersectLine:function(r,n,s,o,l,c,u,d){return Jg(l,c,this.points,r,n,s/2,o/2,u)},checkPoint:function(r,n,s,o,l,c,u,d){return il(r,n,this.points,c,u,o,l,[0,-1],s)},hasMiterBounds:a!=="rectangle",miterBounds:function(r,n,s,o,l,c){return Lye(this.points,r,n,s,o,l)}}};nl.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(t,e,r,n,s,o){this.renderer.nodeShapeImpl(this.name,t,e,r,n,s)},intersectLine:function(t,e,r,n,s,o,l,c){return Bye(s,o,t,e,r/2+l,n/2+l)},checkPoint:function(t,e,r,n,s,o,l,c){return ju(t,e,n,s,o,l,r)}}};nl.generateRoundPolygon=function(a,t){return this.nodeShapes[a]={renderer:this,name:a,points:t,getOrCreateCorners:function(r,n,s,o,l,c,u){if(c[u]!==void 0&&c[u+"-cx"]===r&&c[u+"-cy"]===n)return c[u];c[u]=new Array(t.length/2),c[u+"-cx"]=r,c[u+"-cy"]=n;var d=s/2,h=o/2;l=l==="auto"?IV(s,o):l;for(var f=new Array(t.length/2),m=0;m<t.length/2;m++)f[m]={x:r+d*t[m*2],y:n+h*t[m*2+1]};var g,y,v,E,C=f.length;for(y=f[C-1],g=0;g<C;g++)v=f[g%C],E=f[(g+1)%C],c[u][g]=XD(y,v,E,l),y=v,v=E;return c[u]},draw:function(r,n,s,o,l,c,u){this.renderer.nodeShapeImpl("round-polygon",r,n,s,o,l,this.points,this.getOrCreateCorners(n,s,o,l,c,u,"drawCorners"))},intersectLine:function(r,n,s,o,l,c,u,d,h){return zye(l,c,this.points,r,n,s,o,u,this.getOrCreateCorners(r,n,s,o,d,h,"corners"))},checkPoint:function(r,n,s,o,l,c,u,d,h){return Nye(r,n,this.points,c,u,o,l,this.getOrCreateCorners(c,u,o,l,d,h,"corners"))}}};nl.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Wn(4,0),draw:function(t,e,r,n,s,o){this.renderer.nodeShapeImpl(this.name,t,e,r,n,s,this.points,o)},intersectLine:function(t,e,r,n,s,o,l,c){return LV(s,o,t,e,r,n,l,c)},checkPoint:function(t,e,r,n,s,o,l,c){var u=n/2,d=s/2;c=c==="auto"?vc(n,s):c,c=Math.min(u,d,c);var h=c*2;return!!(il(t,e,this.points,o,l,n,s-h,[0,-1],r)||il(t,e,this.points,o,l,n-h,s,[0,-1],r)||ju(t,e,h,h,o-u+c,l-d+c,r)||ju(t,e,h,h,o+u-c,l-d+c,r)||ju(t,e,h,h,o+u-c,l+d-c,r)||ju(t,e,h,h,o-u+c,l+d-c,r))}}};nl.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:zD(),points:Wn(4,0),draw:function(t,e,r,n,s,o){this.renderer.nodeShapeImpl(this.name,t,e,r,n,s,null,o)},generateCutTrianglePts:function(t,e,r,n,s){var o=s==="auto"?this.cornerLength:s,l=e/2,c=t/2,u=r-c,d=r+c,h=n-l,f=n+l;return{topLeft:[u,h+o,u+o,h,u+o,h+o],topRight:[d-o,h,d,h+o,d-o,h+o],bottomRight:[d,f-o,d-o,f,d-o,f-o],bottomLeft:[u+o,f,u,f-o,u+o,f-o]}},intersectLine:function(t,e,r,n,s,o,l,c){var u=this.generateCutTrianglePts(r+2*l,n+2*l,t,e,c),d=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return Jg(s,o,d,t,e)},checkPoint:function(t,e,r,n,s,o,l,c){var u=c==="auto"?this.cornerLength:c;if(il(t,e,this.points,o,l,n,s-2*u,[0,-1],r)||il(t,e,this.points,o,l,n-2*u,s,[0,-1],r))return!0;var d=this.generateCutTrianglePts(n,s,o,l);return fa(t,e,d.topLeft)||fa(t,e,d.topRight)||fa(t,e,d.bottomRight)||fa(t,e,d.bottomLeft)}}};nl.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Wn(4,0),draw:function(t,e,r,n,s,o){this.renderer.nodeShapeImpl(this.name,t,e,r,n,s)},intersectLine:function(t,e,r,n,s,o,l,c){var u=.15,d=.5,h=.85,f=this.generateBarrelBezierPts(r+2*l,n+2*l,t,e),m=function(v){var E=gf({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},u),C=gf({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},d),_=gf({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},h);return[v[0],v[1],E.x,E.y,C.x,C.y,_.x,_.y,v[4],v[5]]},g=[].concat(m(f.topLeft),m(f.topRight),m(f.bottomRight),m(f.bottomLeft));return Jg(s,o,g,t,e)},generateBarrelBezierPts:function(t,e,r,n){var s=e/2,o=t/2,l=r-o,c=r+o,u=n-s,d=n+s,h=hD(t,e),f=h.heightOffset,m=h.widthOffset,g=h.ctrlPtOffsetPct*t,y={topLeft:[l,u+f,l+g,u,l+m,u],topRight:[c-m,u,c-g,u,c,u+f],bottomRight:[c,d-f,c-g,d,c-m,d],bottomLeft:[l+m,d,l+g,d,l,d-f]};return y.topLeft.isTop=!0,y.topRight.isTop=!0,y.bottomLeft.isBottom=!0,y.bottomRight.isBottom=!0,y},checkPoint:function(t,e,r,n,s,o,l,c){var u=hD(n,s),d=u.heightOffset,h=u.widthOffset;if(il(t,e,this.points,o,l,n,s-2*d,[0,-1],r)||il(t,e,this.points,o,l,n-2*h,s,[0,-1],r))return!0;for(var f=this.generateBarrelBezierPts(n,s,o,l),m=function(O,R,F){var $=F[4],k=F[2],N=F[0],G=F[5],W=F[1],Y=Math.min($,N),U=Math.max($,N),Z=Math.min(G,W),q=Math.max(G,W);if(Y<=O&&O<=U&&Z<=R&&R<=q){var X=Hye($,k,N),ie=Aye(X[0],X[1],X[2],O),j=ie.filter(function(K){return 0<=K&&K<=1});if(j.length>0)return j[0]}return null},g=Object.keys(f),y=0;y<g.length;y++){var v=g[y],E=f[v],C=m(t,e,E);if(C!=null){var _=E[5],x=E[3],P=E[1],I=qi(_,x,P,C);if(E.isTop&&I<=e||E.isBottom&&e<=I)return!0}}return!1}}};nl.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Wn(4,0),draw:function(t,e,r,n,s,o){this.renderer.nodeShapeImpl(this.name,t,e,r,n,s,this.points,o)},intersectLine:function(t,e,r,n,s,o,l,c){var u=t-(r/2+l),d=e-(n/2+l),h=d,f=t+(r/2+l),m=hc(s,o,t,e,u,d,f,h,!1);return m.length>0?m:LV(s,o,t,e,r,n,l,c)},checkPoint:function(t,e,r,n,s,o,l,c){c=c==="auto"?vc(n,s):c;var u=2*c;if(il(t,e,this.points,o,l,n,s-u,[0,-1],r)||il(t,e,this.points,o,l,n-u,s,[0,-1],r))return!0;var d=n/2+2*r,h=s/2+2*r,f=[o-d,l-h,o-d,l,o+d,l,o+d,l-h];return!!(fa(t,e,f)||ju(t,e,u,u,o+n/2-c,l+s/2-c,r)||ju(t,e,u,u,o-n/2+c,l+s/2-c,r))}}};nl.registerNodeShapes=function(){var a=this.nodeShapes={},t=this;this.generateEllipse(),this.generatePolygon("triangle",Wn(3,0)),this.generateRoundPolygon("round-triangle",Wn(3,0)),this.generatePolygon("rectangle",Wn(4,0)),a.square=a.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var e=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",e),this.generateRoundPolygon("round-diamond",e)}this.generatePolygon("pentagon",Wn(5,0)),this.generateRoundPolygon("round-pentagon",Wn(5,0)),this.generatePolygon("hexagon",Wn(6,0)),this.generateRoundPolygon("round-hexagon",Wn(6,0)),this.generatePolygon("heptagon",Wn(7,0)),this.generateRoundPolygon("round-heptagon",Wn(7,0)),this.generatePolygon("octagon",Wn(8,0)),this.generateRoundPolygon("round-octagon",Wn(8,0));var r=new Array(20);{var n=dD(5,0),s=dD(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var l=0;l<s.length/2;l++)s[l*2]*=o,s[l*2+1]*=o;for(var l=0;l<20/4;l++)r[l*4]=n[l*2],r[l*4+1]=n[l*2+1],r[l*4+2]=s[l*2],r[l*4+3]=s[l*2+1]}r=MV(r),this.generatePolygon("star",r),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var c=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",c),this.generateRoundPolygon("round-tag",c)}a.makePolygon=function(u){var d=u.join("$"),h="polygon-"+d,f;return(f=this[h])?f:t.generatePolygon(h,u)}};pv={};pv.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};pv.redraw=function(a){a=a||xV();var t=this;t.averageRedrawTime===void 0&&(t.averageRedrawTime=0),t.lastRedrawTime===void 0&&(t.lastRedrawTime=0),t.lastDrawTime===void 0&&(t.lastDrawTime=0),t.requestedFrame=!0,t.renderOptions=a};pv.beforeRender=function(a,t){if(!this.destroyed){t==null&&qr("Priority is not optional for beforeRender");var e=this.beforeRenderCallbacks;e.push({fn:a,priority:t}),e.sort(function(r,n){return n.priority-r.priority})}};UG=function(t,e,r){for(var n=t.beforeRenderCallbacks,s=0;s<n.length;s++)n[s].fn(e,r)};pv.startRenderLoop=function(){var a=this,t=a.cy;if(!a.renderLoopStarted){a.renderLoopStarted=!0;var e=function(n){if(!a.destroyed){if(!t.batching())if(a.requestedFrame&&!a.skipFrame){UG(a,!0,n);var s=rl();a.render(a.renderOptions);var o=a.lastDrawTime=rl();a.averageRedrawTime===void 0&&(a.averageRedrawTime=o-s),a.redrawCount===void 0&&(a.redrawCount=0),a.redrawCount++,a.redrawTotalTime===void 0&&(a.redrawTotalTime=0);var l=o-s;a.redrawTotalTime+=l,a.lastRedrawTime=l,a.averageRedrawTime=a.averageRedrawTime/2+l/2,a.requestedFrame=!1}else UG(a,!1,n);a.skipFrame=!1,pw(e)}};pw(e)}};iEe=function(t){this.init(t)},I5=iEe,Df=I5.prototype;Df.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Df.init=function(a){var t=this;t.options=a,t.cy=a.cy;var e=t.container=a.cy.container(),r=t.cy.window();if(r){var n=r.document,s=n.head,o="__________cytoscape_stylesheet",l="__________cytoscape_container",c=n.getElementById(o)!=null;if(e.className.indexOf(l)<0&&(e.className=(e.className||"")+" "+l),!c){var u=n.createElement("style");u.id=o,u.textContent="."+l+" { position: relative; }",s.insertBefore(u,s.children[0])}var d=r.getComputedStyle(e),h=d.getPropertyValue("position");h==="static"&&cr("A Cytoscape container has style position:static and so can not use UI extensions properly")}t.selection=[void 0,void 0,void 0,void 0,0],t.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],t.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},t.dragData={possibleDragElements:[]},t.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},t.redraws=0,t.showFps=a.showFps,t.debug=a.debug,t.webgl=a.webgl,t.hideEdgesOnViewport=a.hideEdgesOnViewport,t.textureOnViewport=a.textureOnViewport,t.wheelSensitivity=a.wheelSensitivity,t.motionBlurEnabled=a.motionBlur,t.forcedPixelRatio=We(a.pixelRatio)?a.pixelRatio:null,t.motionBlur=a.motionBlur,t.motionBlurOpacity=a.motionBlurOpacity,t.motionBlurTransparency=1-t.motionBlurOpacity,t.motionBlurPxRatio=1,t.mbPxRBlurry=1,t.minMbLowQualFrames=4,t.fullQualityMb=!1,t.clearedForMotionBlur=[],t.desktopTapThreshold=a.desktopTapThreshold,t.desktopTapThreshold2=a.desktopTapThreshold*a.desktopTapThreshold,t.touchTapThreshold=a.touchTapThreshold,t.touchTapThreshold2=a.touchTapThreshold*a.touchTapThreshold,t.tapholdDuration=500,t.bindings=[],t.beforeRenderCallbacks=[],t.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},t.registerNodeShapes(),t.registerArrowShapes(),t.registerCalculationListeners()};Df.notify=function(a,t){var e=this,r=e.cy;if(!this.destroyed){if(a==="init"){e.load();return}if(a==="destroy"){e.destroy();return}(a==="add"||a==="remove"||a==="move"&&r.hasCompoundNodes()||a==="load"||a==="zorder"||a==="mount")&&e.invalidateCachedZSortedEles(),a==="viewport"&&e.redrawHint("select",!0),a==="gc"&&e.redrawHint("gc",!0),(a==="load"||a==="resize"||a==="mount")&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container)),e.redrawHint("eles",!0),e.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};Df.destroy=function(){var a=this;a.destroyed=!0,a.cy.stopAnimationLoop();for(var t=0;t<a.bindings.length;t++){var e=a.bindings[t],r=e,n=r.target;(n.off||n.removeEventListener).apply(n,r.args)}if(a.bindings=[],a.beforeRenderCallbacks=[],a.onUpdateEleCalcsFns=[],a.removeObserver&&a.removeObserver.disconnect(),a.styleObserver&&a.styleObserver.disconnect(),a.resizeObserver&&a.resizeObserver.disconnect(),a.labelCalcDiv)try{document.body.removeChild(a.labelCalcDiv)}catch(s){}};Df.isHeadless=function(){return!1};[KD,L5,M5,kf,nl,pv].forEach(function(a){ut(Df,a)});rD=1e3/60,A5={setupDequeueing:function(t){return function(){var r=this,n=this.renderer;if(!r.dequeueingSetup){r.dequeueingSetup=!0;var s=cv(function(){n.redrawHint("eles",!0),n.redrawHint("drag",!0),n.redraw()},t.deqRedrawThreshold),o=function(u,d){var h=rl(),f=n.averageRedrawTime,m=n.lastRedrawTime,g=[],y=n.cy.extent(),v=n.getPixelRatio();for(u||n.flushRenderedStyleQueue();;){var E=rl(),C=E-h,_=E-d;if(m<rD){var x=rD-(u?f:0);if(_>=t.deqFastCost*x)break}else if(u){if(C>=t.deqCost*m||C>=t.deqAvgCost*f)break}else if(_>=t.deqNoDrawCost*rD)break;var P=t.deq(r,v,y);if(P.length>0)for(var I=0;I<P.length;I++)g.push(P[I]);else break}g.length>0&&(t.onDeqd(r,g),!u&&t.shouldRedraw(r,g,v,y)&&s())},l=t.priority||FD;n.beforeRender(o,l(r))}}}},nEe=(function(){function a(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mw;Tc(this,a),this.idsByKey=new tl,this.keyForId=new tl,this.cachesByLvl=new tl,this.lvls=[],this.getKey=t,this.doesEleInvalidateKey=e}return Cc(a,[{key:"getIdsFor",value:function(e){e==null&&qr("Can not get id list for null key");var r=this.idsByKey,n=this.idsByKey.get(e);return n||(n=new Cf,r.set(e,n)),n}},{key:"addIdForKey",value:function(e,r){e!=null&&this.getIdsFor(e).add(r)}},{key:"deleteIdForKey",value:function(e,r){e!=null&&this.getIdsFor(e).delete(r)}},{key:"getNumberOfIdsForKey",value:function(e){return e==null?0:this.getIdsFor(e).size}},{key:"updateKeyMappingFor",value:function(e){var r=e.id(),n=this.keyForId.get(r),s=this.getKey(e);this.deleteIdForKey(n,r),this.addIdForKey(s,r),this.keyForId.set(r,s)}},{key:"deleteKeyMappingFor",value:function(e){var r=e.id(),n=this.keyForId.get(r);this.deleteIdForKey(n,r),this.keyForId.delete(r)}},{key:"keyHasChangedFor",value:function(e){var r=e.id(),n=this.keyForId.get(r),s=this.getKey(e);return n!==s}},{key:"isInvalid",value:function(e){return this.keyHasChangedFor(e)||this.doesEleInvalidateKey(e)}},{key:"getCachesAt",value:function(e){var r=this.cachesByLvl,n=this.lvls,s=r.get(e);return s||(s=new tl,r.set(e,s),n.push(e)),s}},{key:"getCache",value:function(e,r){return this.getCachesAt(r).get(e)}},{key:"get",value:function(e,r){var n=this.getKey(e),s=this.getCache(n,r);return s!=null&&this.updateKeyMappingFor(e),s}},{key:"getForCachedKey",value:function(e,r){var n=this.keyForId.get(e.id()),s=this.getCache(n,r);return s}},{key:"hasCache",value:function(e,r){return this.getCachesAt(r).has(e)}},{key:"has",value:function(e,r){var n=this.getKey(e);return this.hasCache(n,r)}},{key:"setCache",value:function(e,r,n){n.key=e,this.getCachesAt(r).set(e,n)}},{key:"set",value:function(e,r,n){var s=this.getKey(e);this.setCache(s,r,n),this.updateKeyMappingFor(e)}},{key:"deleteCache",value:function(e,r){this.getCachesAt(r).delete(e)}},{key:"delete",value:function(e,r){var n=this.getKey(e);this.deleteCache(n,r)}},{key:"invalidateKey",value:function(e){var r=this;this.lvls.forEach(function(n){return r.deleteCache(e,n)})}},{key:"invalidate",value:function(e){var r=e.id(),n=this.keyForId.get(r);this.deleteKeyMappingFor(e);var s=this.doesEleInvalidateKey(e);return s&&this.invalidateKey(n),s||this.getNumberOfIdsForKey(n)===0}}])})(),jG=25,Q0=50,uw=-4,SD=3,O5=7.99,aEe=8,sEe=1024,oEe=1024,lEe=1024,cEe=.2,uEe=.8,dEe=10,hEe=.15,fEe=.1,pEe=.9,mEe=.9,gEe=100,vEe=1,mf={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},yEe=on({getKey:null,doesEleInvalidateKey:mw,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:CV,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Wg=function(t,e){var r=this;r.renderer=t,r.onDequeues=[];var n=yEe(e);ut(r,n),r.lookup=new nEe(n.getKey,n.doesEleInvalidateKey),r.setupDequeueing()},Oi=Wg.prototype;Oi.reasons=mf;Oi.getTextureQueue=function(a){var t=this;return t.eleImgCaches=t.eleImgCaches||{},t.eleImgCaches[a]=t.eleImgCaches[a]||[]};Oi.getRetiredTextureQueue=function(a){var t=this,e=t.eleImgCaches.retired=t.eleImgCaches.retired||{},r=e[a]=e[a]||[];return r};Oi.getElementQueue=function(){var a=this,t=a.eleCacheQueue=a.eleCacheQueue||new uv(function(e,r){return r.reqs-e.reqs});return t};Oi.getElementKeyToQueue=function(){var a=this,t=a.eleKeyToCacheQueue=a.eleKeyToCacheQueue||{};return t};Oi.getElement=function(a,t,e,r,n){var s=this,o=this.renderer,l=o.cy.zoom(),c=this.lookup;if(!t||t.w===0||t.h===0||isNaN(t.w)||isNaN(t.h)||!a.visible()||a.removed()||!s.allowEdgeTxrCaching&&a.isEdge()||!s.allowParentTxrCaching&&a.isParent())return null;if(r==null&&(r=Math.ceil(ND(l*e))),r<uw)r=uw;else if(l>=O5||r>SD)return null;var u=Math.pow(2,r),d=t.h*u,h=t.w*u,f=o.eleTextBiggerThanMin(a,u);if(!this.isVisible(a,f))return null;var m=c.get(a,r);if(m&&m.invalidated&&(m.invalidated=!1,m.texture.invalidatedWidth-=m.width),m)return m;var g;if(d<=jG?g=jG:d<=Q0?g=Q0:g=Math.ceil(d/Q0)*Q0,d>lEe||h>oEe)return null;var y=s.getTextureQueue(g),v=y[y.length-2],E=function(){return s.recycleTexture(g,h)||s.addTexture(g,h)};v||(v=y[y.length-1]),v||(v=E()),v.width-v.usedWidth<h&&(v=E());for(var C=function(Y){return Y&&Y.scaledLabelShown===f},_=n&&n===mf.dequeue,x=n&&n===mf.highQuality,P=n&&n===mf.downscale,I,M=r+1;M<=SD;M++){var O=c.get(a,M);if(O){I=O;break}}var R=I&&I.level===r+1?I:null,F=function(){v.context.drawImage(R.texture.canvas,R.x,0,R.width,R.height,v.usedWidth,0,h,d)};if(v.context.setTransform(1,0,0,1,0,0),v.context.clearRect(v.usedWidth,0,h,g),C(R))F();else if(C(I))if(x){for(var $=I.level;$>r;$--)R=s.getElement(a,t,e,$,mf.downscale);F()}else return s.queueElement(a,I.level-1),I;else{var k;if(!_&&!x&&!P)for(var N=r-1;N>=uw;N--){var G=c.get(a,N);if(G){k=G;break}}if(C(k))return s.queueElement(a,r),k;v.context.translate(v.usedWidth,0),v.context.scale(u,u),this.drawElement(v.context,a,t,f,!1),v.context.scale(1/u,1/u),v.context.translate(-v.usedWidth,0)}return m={x:v.usedWidth,texture:v,level:r,scale:u,width:h,height:d,scaledLabelShown:f},v.usedWidth+=Math.ceil(h+aEe),v.eleCaches.push(m),c.set(a,r,m),s.checkTextureFullness(v),m};Oi.invalidateElements=function(a){for(var t=0;t<a.length;t++)this.invalidateElement(a[t])};Oi.invalidateElement=function(a){var t=this,e=t.lookup,r=[],n=e.isInvalid(a);if(n){for(var s=uw;s<=SD;s++){var o=e.getForCachedKey(a,s);o&&r.push(o)}var l=e.invalidate(a);if(l)for(var c=0;c<r.length;c++){var u=r[c],d=u.texture;d.invalidatedWidth+=u.width,u.invalidated=!0,t.checkTextureUtility(d)}t.removeFromQueue(a)}};Oi.checkTextureUtility=function(a){a.invalidatedWidth>=cEe*a.width&&this.retireTexture(a)};Oi.checkTextureFullness=function(a){var t=this,e=t.getTextureQueue(a.height);a.usedWidth/a.width>uEe&&a.fullnessChecks>=dEe?gc(e,a):a.fullnessChecks++};Oi.retireTexture=function(a){var t=this,e=a.height,r=t.getTextureQueue(e),n=this.lookup;gc(r,a),a.retired=!0;for(var s=a.eleCaches,o=0;o<s.length;o++){var l=s[o];n.deleteCache(l.key,l.level)}RD(s);var c=t.getRetiredTextureQueue(e);c.push(a)};Oi.addTexture=function(a,t){var e=this,r=e.getTextureQueue(a),n={};return r.push(n),n.eleCaches=[],n.height=a,n.width=Math.max(sEe,t),n.usedWidth=0,n.invalidatedWidth=0,n.fullnessChecks=0,n.canvas=e.renderer.makeOffscreenCanvas(n.width,n.height),n.context=n.canvas.getContext("2d"),n};Oi.recycleTexture=function(a,t){for(var e=this,r=e.getTextureQueue(a),n=e.getRetiredTextureQueue(a),s=0;s<n.length;s++){var o=n[s];if(o.width>=t)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,RD(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),gc(n,o),r.push(o),o}};Oi.queueElement=function(a,t){var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),s=this.getKey(a),o=n[s];if(o)o.level=Math.max(o.level,t),o.eles.merge(a),o.reqs++,r.updateItem(o);else{var l={eles:a.spawn().merge(a),level:t,reqs:1,key:s};r.push(l),n[s]=l}};Oi.dequeue=function(a){for(var t=this,e=t.getElementQueue(),r=t.getElementKeyToQueue(),n=[],s=t.lookup,o=0;o<vEe&&e.size()>0;o++){var l=e.pop(),c=l.key,u=l.eles[0],d=s.hasCache(u,l.level);if(r[c]=null,d)continue;n.push(l);var h=t.getBoundingBox(u);t.getElement(u,h,a,l.level,mf.dequeue)}return n};Oi.removeFromQueue=function(a){var t=this,e=t.getElementQueue(),r=t.getElementKeyToQueue(),n=this.getKey(a),s=r[n];s!=null&&(s.eles.length===1?(s.reqs=OD,e.updateItem(s),e.pop(),r[n]=null):s.eles.unmerge(a))};Oi.onDequeue=function(a){this.onDequeues.push(a)};Oi.offDequeue=function(a){gc(this.onDequeues,a)};Oi.setupDequeueing=A5.setupDequeueing({deqRedrawThreshold:gEe,deqCost:hEe,deqAvgCost:fEe,deqNoDrawCost:pEe,deqFastCost:mEe,deq:function(t,e,r){return t.dequeue(e,r)},onDeqd:function(t,e){for(var r=0;r<t.onDequeues.length;r++){var n=t.onDequeues[r];n(e)}},shouldRedraw:function(t,e,r,n){for(var s=0;s<e.length;s++)for(var o=e[s].eles,l=0;l<o.length;l++){var c=o[l].boundingBox();if($D(c,n))return!0}return!1},priority:function(t){return t.renderer.beforeRenderPriorities.eleTxrDeq}});bEe=1,jg=-4,Cw=2,wEe=3.99,EEe=50,TEe=50,CEe=.15,_Ee=.1,SEe=.9,xEe=.9,kEe=1,YG=250,DEe=4e3*4e3,qG=32767,PEe=!0,F5=function(t){var e=this,r=e.renderer=t,n=r.cy;e.layersByLevel={},e.firstGet=!0,e.lastInvalidationTime=rl()-2*YG,e.skipping=!1,e.eleTxrDeqs=n.collection(),e.scheduleElementRefinement=cv(function(){e.refineElementTextures(e.eleTxrDeqs),e.eleTxrDeqs.unmerge(e.eleTxrDeqs)},TEe),r.beforeRender(function(o,l){l-e.lastInvalidationTime<=YG?e.skipping=!0:e.skipping=!1},r.beforeRenderPriorities.lyrTxrSkip);var s=function(l,c){return c.reqs-l.reqs};e.layersQueue=new uv(s),e.setupDequeueing()},ln=F5.prototype,ZG=0,LEe=Math.pow(2,53)-1;ln.makeLayer=function(a,t){var e=Math.pow(2,t),r=Math.ceil(a.w*e),n=Math.ceil(a.h*e),s=this.renderer.makeOffscreenCanvas(r,n),o={id:ZG=++ZG%LEe,bb:a,level:t,width:r,height:n,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},l=o.context,c=-o.bb.x1,u=-o.bb.y1;return l.scale(e,e),l.translate(c,u),o};ln.getLayers=function(a,t,e){var r=this,n=r.renderer,s=n.cy,o=s.zoom(),l=r.firstGet;if(r.firstGet=!1,e==null){if(e=Math.ceil(ND(o*t)),e<jg)e=jg;else if(o>=wEe||e>Cw)return null}r.validateLayersElesOrdering(e,a);var c=r.layersByLevel,u=Math.pow(2,e),d=c[e]=c[e]||[],h,f=r.levelIsComplete(e,a),m,g=function(){var F=function(W){if(r.validateLayersElesOrdering(W,a),r.levelIsComplete(W,a))return m=c[W],!0},$=function(W){if(!m)for(var Y=e+W;jg<=Y&&Y<=Cw&&!F(Y);Y+=W);};$(1),$(-1);for(var k=d.length-1;k>=0;k--){var N=d[k];N.invalid&&gc(d,N)}};if(!f)g();else return d;var y=function(){if(!h){h=Un();for(var F=0;F<a.length;F++)kye(h,a[F].boundingBox())}return h},v=function(F){F=F||{};var $=F.after;y();var k=Math.ceil(h.w*u),N=Math.ceil(h.h*u);if(k>qG||N>qG)return null;var G=k*N;if(G>DEe)return null;var W=r.makeLayer(h,e);if($!=null){var Y=d.indexOf($)+1;d.splice(Y,0,W)}else(F.insert===void 0||F.insert)&&d.unshift(W);return W};if(r.skipping&&!l)return null;for(var E=null,C=a.length/bEe,_=!l,x=0;x<a.length;x++){var P=a[x],I=P._private.rscratch,M=I.imgLayerCaches=I.imgLayerCaches||{},O=M[e];if(O){E=O;continue}if((!E||E.eles.length>=C||!PV(E.bb,P.boundingBox()))&&(E=v({insert:!0,after:E}),!E))return null;m||_?r.queueLayer(E,P):r.drawEleInLayer(E,P,e,t),E.eles.push(P),M[e]=E}return m||(_?null:d)};ln.getEleLevelForLayerLevel=function(a,t){return a};ln.drawEleInLayer=function(a,t,e,r){var n=this,s=this.renderer,o=a.context,l=t.boundingBox();l.w===0||l.h===0||!t.visible()||(e=n.getEleLevelForLayerLevel(e,r),s.setImgSmoothing(o,!1),s.drawCachedElement(o,t,null,null,e,PEe),s.setImgSmoothing(o,!0))};ln.levelIsComplete=function(a,t){var e=this,r=e.layersByLevel[a];if(!r||r.length===0)return!1;for(var n=0,s=0;s<r.length;s++){var o=r[s];if(o.reqs>0||o.invalid)return!1;n+=o.eles.length}return n===t.length};ln.validateLayersElesOrdering=function(a,t){var e=this.layersByLevel[a];if(e)for(var r=0;r<e.length;r++){for(var n=e[r],s=-1,o=0;o<t.length;o++)if(n.eles[0]===t[o]){s=o;break}if(s<0){this.invalidateLayer(n);continue}for(var l=s,o=0;o<n.eles.length;o++)if(n.eles[o]!==t[l+o]){this.invalidateLayer(n);break}}};ln.updateElementsInLayers=function(a,t){for(var e=this,r=av(a[0]),n=0;n<a.length;n++)for(var s=r?null:a[n],o=r?a[n]:a[n].ele,l=o._private.rscratch,c=l.imgLayerCaches=l.imgLayerCaches||{},u=jg;u<=Cw;u++){var d=c[u];d&&(s&&e.getEleLevelForLayerLevel(d.level)!==s.level||t(d,o,s))}};ln.haveLayers=function(){for(var a=this,t=!1,e=jg;e<=Cw;e++){var r=a.layersByLevel[e];if(r&&r.length>0){t=!0;break}}return t};ln.invalidateElements=function(a){var t=this;a.length!==0&&(t.lastInvalidationTime=rl(),!(a.length===0||!t.haveLayers())&&t.updateElementsInLayers(a,function(r,n,s){t.invalidateLayer(r)}))};ln.invalidateLayer=function(a){if(this.lastInvalidationTime=rl(),!a.invalid){var t=a.level,e=a.eles,r=this.layersByLevel[t];gc(r,a),a.elesQueue=[],a.invalid=!0,a.replacement&&(a.replacement.invalid=!0);for(var n=0;n<e.length;n++){var s=e[n]._private.rscratch.imgLayerCaches;s&&(s[t]=null)}}};ln.refineElementTextures=function(a){var t=this;t.updateElementsInLayers(a,function(r,n,s){var o=r.replacement;if(o||(o=r.replacement=t.makeLayer(r.bb,r.level),o.replaces=r,o.eles=r.eles),!o.reqs)for(var l=0;l<o.eles.length;l++)t.queueLayer(o,o.eles[l])})};ln.enqueueElementRefinement=function(a){this.eleTxrDeqs.merge(a),this.scheduleElementRefinement()};ln.queueLayer=function(a,t){var e=this,r=e.layersQueue,n=a.elesQueue,s=n.hasId=n.hasId||{};if(!a.replacement){if(t){if(s[t.id()])return;n.push(t),s[t.id()]=!0}a.reqs?(a.reqs++,r.updateItem(a)):(a.reqs=1,r.push(a))}};ln.dequeue=function(a){for(var t=this,e=t.layersQueue,r=[],n=0;n<kEe&&e.size()!==0;){var s=e.peek();if(s.replacement){e.pop();continue}if(s.replaces&&s!==s.replaces.replacement){e.pop();continue}if(s.invalid){e.pop();continue}var o=s.elesQueue.shift();o&&(t.drawEleInLayer(s,o,s.level,a),n++),r.length===0&&r.push(!0),s.elesQueue.length===0&&(e.pop(),s.reqs=0,s.replaces&&t.applyLayerReplacement(s),t.requestRedraw())}return r};ln.applyLayerReplacement=function(a){var t=this,e=t.layersByLevel[a.level],r=a.replaces,n=e.indexOf(r);if(!(n<0||r.invalid)){e[n]=a;for(var s=0;s<a.eles.length;s++){var o=a.eles[s]._private,l=o.imgLayerCaches=o.imgLayerCaches||{};l&&(l[a.level]=a)}t.requestRedraw()}};ln.requestRedraw=cv(function(){var a=this.renderer;a.redrawHint("eles",!0),a.redrawHint("drag",!0),a.redraw()},100);ln.setupDequeueing=A5.setupDequeueing({deqRedrawThreshold:EEe,deqCost:CEe,deqAvgCost:_Ee,deqNoDrawCost:SEe,deqFastCost:xEe,deq:function(t,e){return t.dequeue(e)},onDeqd:FD,shouldRedraw:CV,priority:function(t){return t.renderer.beforeRenderPriorities.lyrTxrDeq}});R5={};R5.arrowShapeImpl=function(a){return(KG||(KG={polygon:MEe,"triangle-backcurve":IEe,"triangle-tee":XG,"circle-triangle":AEe,"triangle-cross":XG,circle:OEe}))[a]};vo={};vo.drawElement=function(a,t,e,r,n,s){var o=this;t.isNode()?o.drawNode(a,t,e,r,n,s):o.drawEdge(a,t,e,r,n,s)};vo.drawElementOverlay=function(a,t){var e=this;t.isNode()?e.drawNodeOverlay(a,t):e.drawEdgeOverlay(a,t)};vo.drawElementUnderlay=function(a,t){var e=this;t.isNode()?e.drawNodeUnderlay(a,t):e.drawEdgeUnderlay(a,t)};vo.drawCachedElementPortion=function(a,t,e,r,n,s,o,l){var c=this,u=e.getBoundingBox(t);if(!(u.w===0||u.h===0)){var d=e.getElement(t,u,r,n,s);if(d!=null){var h=l(c,t);if(h===0)return;var f=o(c,t),m=u.x1,g=u.y1,y=u.w,v=u.h,E,C,_,x,P;if(f!==0){var I=e.getRotationPoint(t);_=I.x,x=I.y,a.translate(_,x),a.rotate(f),P=c.getImgSmoothing(a),P||c.setImgSmoothing(a,!0);var M=e.getRotationOffset(t);E=M.x,C=M.y}else E=m,C=g;var O;h!==1&&(O=a.globalAlpha,a.globalAlpha=O*h),a.drawImage(d.texture.canvas,d.x,0,d.width,d.height,E,C,y,v),h!==1&&(a.globalAlpha=O),f!==0&&(a.rotate(-f),a.translate(-_,-x),P||c.setImgSmoothing(a,!1))}else e.drawElement(a,t)}};FEe=function(){return 0},REe=function(t,e){return t.getTextAngle(e,null)},NEe=function(t,e){return t.getTextAngle(e,"source")},BEe=function(t,e){return t.getTextAngle(e,"target")},$Ee=function(t,e){return e.effectiveOpacity()},iD=function(t,e){return e.pstyle("text-opacity").pfValue*e.effectiveOpacity()};vo.drawCachedElement=function(a,t,e,r,n,s){var o=this,l=o.data,c=l.eleTxrCache,u=l.lblTxrCache,d=l.slbTxrCache,h=l.tlbTxrCache,f=t.boundingBox(),m=s===!0?c.reasons.highQuality:null;if(!(f.w===0||f.h===0||!t.visible())&&(!r||$D(f,r))){var g=t.isEdge(),y=t.element()._private.rscratch.badLine;o.drawElementUnderlay(a,t),o.drawCachedElementPortion(a,t,c,e,n,m,FEe,$Ee),(!g||!y)&&o.drawCachedElementPortion(a,t,u,e,n,m,REe,iD),g&&!y&&(o.drawCachedElementPortion(a,t,d,e,n,m,NEe,iD),o.drawCachedElementPortion(a,t,h,e,n,m,BEe,iD)),o.drawElementOverlay(a,t)}};vo.drawElements=function(a,t){for(var e=this,r=0;r<t.length;r++){var n=t[r];e.drawElement(a,n)}};vo.drawCachedElements=function(a,t,e,r){for(var n=this,s=0;s<t.length;s++){var o=t[s];n.drawCachedElement(a,o,e,r)}};vo.drawCachedNodes=function(a,t,e,r){for(var n=this,s=0;s<t.length;s++){var o=t[s];o.isNode()&&n.drawCachedElement(a,o,e,r)}};vo.drawLayeredElements=function(a,t,e,r){var n=this,s=n.data.lyrTxrCache.getLayers(t,e);if(s)for(var o=0;o<s.length;o++){var l=s[o],c=l.bb;c.w===0||c.h===0||a.drawImage(l.canvas,c.x1,c.y1,c.w,c.h)}else n.drawCachedElements(a,t,e,r)};al={};al.drawEdge=function(a,t,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l=t._private.rscratch;if(!(s&&!t.visible())&&!(l.badLine||l.allpts==null||isNaN(l.allpts[0]))){var c;e&&(c=e,a.translate(-c.x1,-c.y1));var u=s?t.pstyle("opacity").value:1,d=s?t.pstyle("line-opacity").value:1,h=t.pstyle("curve-style").value,f=t.pstyle("line-style").value,m=t.pstyle("width").pfValue,g=t.pstyle("line-cap").value,y=t.pstyle("line-outline-width").value,v=t.pstyle("line-outline-color").value,E=u*d,C=u*d,_=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E;h==="straight-triangle"?(o.eleStrokeStyle(a,t,W),o.drawEdgeTrianglePath(t,a,l.allpts)):(a.lineWidth=m,a.lineCap=g,o.eleStrokeStyle(a,t,W),o.drawEdgePath(t,a,l.allpts,f),a.lineCap="butt")},x=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E;if(a.lineWidth=m+y,a.lineCap=g,y>0)o.colorStrokeStyle(a,v[0],v[1],v[2],W);else{a.lineCap="butt";return}h==="straight-triangle"?o.drawEdgeTrianglePath(t,a,l.allpts):(o.drawEdgePath(t,a,l.allpts,f),a.lineCap="butt")},P=function(){n&&o.drawEdgeOverlay(a,t)},I=function(){n&&o.drawEdgeUnderlay(a,t)},M=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C;o.drawArrowheads(a,t,W)},O=function(){o.drawElementText(a,t,null,r)};a.lineJoin="round";var R=t.pstyle("ghost").value==="yes";if(R){var F=t.pstyle("ghost-offset-x").pfValue,$=t.pstyle("ghost-offset-y").pfValue,k=t.pstyle("ghost-opacity").value,N=E*k;a.translate(F,$),_(N),M(N),a.translate(-F,-$)}else x();I(),_(),M(),P(),O(),e&&a.translate(c.x1,c.y1)}};N5=function(t){if(!["overlay","underlay"].includes(t))throw new Error("Invalid state");return function(e,r){if(r.visible()){var n=r.pstyle("".concat(t,"-opacity")).value;if(n!==0){var s=this,o=s.usePaths(),l=r._private.rscratch,c=r.pstyle("".concat(t,"-padding")).pfValue,u=2*c,d=r.pstyle("".concat(t,"-color")).value;e.lineWidth=u,l.edgeType==="self"&&!o?e.lineCap="butt":e.lineCap="round",s.colorStrokeStyle(e,d[0],d[1],d[2],n),s.drawEdgePath(r,e,l.allpts,"solid")}}}};al.drawEdgeOverlay=N5("overlay");al.drawEdgeUnderlay=N5("underlay");al.drawEdgePath=function(a,t,e,r){var n=a._private.rscratch,s=t,o,l=!1,c=this.usePaths(),u=a.pstyle("line-dash-pattern").pfValue,d=a.pstyle("line-dash-offset").pfValue;if(c){var h=e.join("$"),f=n.pathCacheKey&&n.pathCacheKey===h;f?(o=t=n.pathCache,l=!0):(o=t=new Path2D,n.pathCacheKey=h,n.pathCache=o)}if(s.setLineDash)switch(r){case"dotted":s.setLineDash([1,1]);break;case"dashed":s.setLineDash(u),s.lineDashOffset=d;break;case"solid":s.setLineDash([]);break}if(!l&&!n.badLine)switch(t.beginPath&&t.beginPath(),t.moveTo(e[0],e[1]),n.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var m=2;m+3<e.length;m+=4)t.quadraticCurveTo(e[m],e[m+1],e[m+2],e[m+3]);break;case"straight":case"haystack":for(var g=2;g+1<e.length;g+=2)t.lineTo(e[g],e[g+1]);break;case"segments":if(n.isRound){var y=pa(n.roundCorners),v;try{for(y.s();!(v=y.n()).done;){var E=v.value;S5(t,E)}}catch(_){y.e(_)}finally{y.f()}t.lineTo(e[e.length-2],e[e.length-1])}else for(var C=2;C+1<e.length;C+=2)t.lineTo(e[C],e[C+1]);break}t=s,c?t.stroke(o):t.stroke(),t.setLineDash&&t.setLineDash([])};al.drawEdgeTrianglePath=function(a,t,e){t.fillStyle=t.strokeStyle;for(var r=a.pstyle("width").pfValue,n=0;n+1<e.length;n+=2){var s=[e[n+2]-e[n],e[n+3]-e[n+1]],o=Math.sqrt(s[0]*s[0]+s[1]*s[1]),l=[s[1]/o,-s[0]/o],c=[l[0]*r/2,l[1]*r/2];t.beginPath(),t.moveTo(e[n]-c[0],e[n+1]-c[1]),t.lineTo(e[n]+c[0],e[n+1]+c[1]),t.lineTo(e[n+2],e[n+3]),t.closePath(),t.fill()}};al.drawArrowheads=function(a,t,e){var r=t._private.rscratch,n=r.edgeType==="haystack";n||this.drawArrowhead(a,t,"source",r.arrowStartX,r.arrowStartY,r.srcArrowAngle,e),this.drawArrowhead(a,t,"mid-target",r.midX,r.midY,r.midtgtArrowAngle,e),this.drawArrowhead(a,t,"mid-source",r.midX,r.midY,r.midsrcArrowAngle,e),n||this.drawArrowhead(a,t,"target",r.arrowEndX,r.arrowEndY,r.tgtArrowAngle,e)};al.drawArrowhead=function(a,t,e,r,n,s,o){if(!(isNaN(r)||r==null||isNaN(n)||n==null||isNaN(s)||s==null)){var l=this,c=t.pstyle(e+"-arrow-shape").value;if(c!=="none"){var u=t.pstyle(e+"-arrow-fill").value==="hollow"?"both":"filled",d=t.pstyle(e+"-arrow-fill").value,h=t.pstyle("width").pfValue,f=t.pstyle(e+"-arrow-width"),m=f.value==="match-line"?h:f.pfValue;f.units==="%"&&(m*=h);var g=t.pstyle("opacity").value;o===void 0&&(o=g);var y=a.globalCompositeOperation;(o!==1||d==="hollow")&&(a.globalCompositeOperation="destination-out",l.colorFillStyle(a,255,255,255,1),l.colorStrokeStyle(a,255,255,255,1),l.drawArrowShape(t,a,u,h,c,m,r,n,s),a.globalCompositeOperation=y);var v=t.pstyle(e+"-arrow-color").value;l.colorFillStyle(a,v[0],v[1],v[2],o),l.colorStrokeStyle(a,v[0],v[1],v[2],o),l.drawArrowShape(t,a,d,h,c,m,r,n,s)}}};al.drawArrowShape=function(a,t,e,r,n,s,o,l,c){var u=this,d=this.usePaths()&&n!=="triangle-cross",h=!1,f,m=t,g={x:o,y:l},y=a.pstyle("arrow-scale").value,v=this.getArrowWidth(r,y),E=u.arrowShapes[n];if(d){var C=u.arrowPathCache=u.arrowPathCache||[],_=Yu(n),x=C[_];x!=null?(f=t=x,h=!0):(f=t=new Path2D,C[_]=f)}h||(t.beginPath&&t.beginPath(),d?E.draw(t,1,0,{x:0,y:0},1):E.draw(t,v,c,g,r),t.closePath&&t.closePath()),t=m,d&&(t.translate(o,l),t.rotate(c),t.scale(v,v)),(e==="filled"||e==="both")&&(d?t.fill(f):t.fill()),(e==="hollow"||e==="both")&&(t.lineWidth=s/(d?v:1),t.lineJoin="miter",d?t.stroke(f):t.stroke()),d&&(t.scale(1/v,1/v),t.rotate(-c),t.translate(-o,-l))};QD={};QD.safeDrawImage=function(a,t,e,r,n,s,o,l,c,u){if(!(n<=0||s<=0||c<=0||u<=0))try{a.drawImage(t,e,r,n,s,o,l,c,u)}catch(d){cr(d)}};QD.drawInscribedImage=function(a,t,e,r,n){var s=this,o=e.position(),l=o.x,c=o.y,u=e.cy().style(),d=u.getIndexedStyle.bind(u),h=d(e,"background-fit","value",r),f=d(e,"background-repeat","value",r),m=e.width(),g=e.height(),y=e.padding()*2,v=m+(d(e,"background-width-relative-to","value",r)==="inner"?0:y),E=g+(d(e,"background-height-relative-to","value",r)==="inner"?0:y),C=e._private.rscratch,_=d(e,"background-clip","value",r),x=_==="node",P=d(e,"background-image-opacity","value",r)*n,I=d(e,"background-image-smoothing","value",r),M=e.pstyle("corner-radius").value;M!=="auto"&&(M=e.pstyle("corner-radius").pfValue);var O=t.width||t.cachedW,R=t.height||t.cachedH;(O==null||R==null)&&(document.body.appendChild(t),O=t.cachedW=t.width||t.offsetWidth,R=t.cachedH=t.height||t.offsetHeight,document.body.removeChild(t));var F=O,$=R;if(d(e,"background-width","value",r)!=="auto"&&(d(e,"background-width","units",r)==="%"?F=d(e,"background-width","pfValue",r)*v:F=d(e,"background-width","pfValue",r)),d(e,"background-height","value",r)!=="auto"&&(d(e,"background-height","units",r)==="%"?$=d(e,"background-height","pfValue",r)*E:$=d(e,"background-height","pfValue",r)),!(F===0||$===0)){if(h==="contain"){var k=Math.min(v/F,E/$);F*=k,$*=k}else if(h==="cover"){var k=Math.max(v/F,E/$);F*=k,$*=k}var N=l-v/2,G=d(e,"background-position-x","units",r),W=d(e,"background-position-x","pfValue",r);G==="%"?N+=(v-F)*W:N+=W;var Y=d(e,"background-offset-x","units",r),U=d(e,"background-offset-x","pfValue",r);Y==="%"?N+=(v-F)*U:N+=U;var Z=c-E/2,q=d(e,"background-position-y","units",r),X=d(e,"background-position-y","pfValue",r);q==="%"?Z+=(E-$)*X:Z+=X;var ie=d(e,"background-offset-y","units",r),j=d(e,"background-offset-y","pfValue",r);ie==="%"?Z+=(E-$)*j:Z+=j,C.pathCache&&(N-=l,Z-=c,l=0,c=0);var K=a.globalAlpha;a.globalAlpha=P;var se=s.getImgSmoothing(a),ne=!1;if(I==="no"&&se?(s.setImgSmoothing(a,!1),ne=!0):I==="yes"&&!se&&(s.setImgSmoothing(a,!0),ne=!0),f==="no-repeat")x&&(a.save(),C.pathCache?a.clip(C.pathCache):(s.nodeShapes[s.getNodeShape(e)].draw(a,l,c,v,E,M,C),a.clip())),s.safeDrawImage(a,t,0,0,O,R,N,Z,F,$),x&&a.restore();else{var ge=a.createPattern(t,f);a.fillStyle=ge,s.nodeShapes[s.getNodeShape(e)].draw(a,l,c,v,E,M,C),a.translate(N,Z),a.fill(),a.translate(-N,-Z)}a.globalAlpha=K,ne&&s.setImgSmoothing(a,se)}};Qu={};Qu.eleTextBiggerThanMin=function(a,t){if(!t){var e=a.cy().zoom(),r=this.getPixelRatio(),n=Math.ceil(ND(e*r));t=Math.pow(2,n)}var s=a.pstyle("font-size").pfValue*t,o=a.pstyle("min-zoomed-font-size").pfValue;return!(s<o)};Qu.drawElementText=function(a,t,e,r,n){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(r==null){if(s&&!o.eleTextBiggerThanMin(t))return}else if(r===!1)return;if(t.isNode()){var l=t.pstyle("label");if(!l||!l.value)return;var c=o.getLabelJustification(t);a.textAlign=c,a.textBaseline="bottom"}else{var u=t.element()._private.rscratch.badLine,d=t.pstyle("label"),h=t.pstyle("source-label"),f=t.pstyle("target-label");if(u||(!d||!d.value)&&(!h||!h.value)&&(!f||!f.value))return;a.textAlign="center",a.textBaseline="bottom"}var m=!e,g;e&&(g=e,a.translate(-g.x1,-g.y1)),n==null?(o.drawText(a,t,null,m,s),t.isEdge()&&(o.drawText(a,t,"source",m,s),o.drawText(a,t,"target",m,s))):o.drawText(a,t,n,m,s),e&&a.translate(g.x1,g.y1)};Qu.getFontCache=function(a){var t;this.fontCaches=this.fontCaches||[];for(var e=0;e<this.fontCaches.length;e++)if(t=this.fontCaches[e],t.context===a)return t;return t={context:a},this.fontCaches.push(t),t};Qu.setupTextStyle=function(a,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=t.pstyle("font-style").strValue,n=t.pstyle("font-size").pfValue+"px",s=t.pstyle("font-family").strValue,o=t.pstyle("font-weight").strValue,l=e?t.effectiveOpacity()*t.pstyle("text-opacity").value:1,c=t.pstyle("text-outline-opacity").value*l,u=t.pstyle("color").value,d=t.pstyle("text-outline-color").value;a.font=r+" "+o+" "+n+" "+s,a.lineJoin="round",this.colorFillStyle(a,u[0],u[1],u[2],l),this.colorStrokeStyle(a,d[0],d[1],d[2],c)};Qu.getTextAngle=function(a,t){var e,r=a._private,n=r.rscratch,s=t?t+"-":"",o=a.pstyle(s+"text-rotation");if(o.strValue==="autorotate"){var l=ha(n,"labelAngle",t);e=a.isEdge()?l:0}else o.strValue==="none"?e=0:e=o.pfValue;return e};Qu.drawText=function(a,t,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=t._private,o=s.rscratch,l=n?t.effectiveOpacity():1;if(!(n&&(l===0||t.pstyle("text-opacity").value===0))){e==="main"&&(e=null);var c=ha(o,"labelX",e),u=ha(o,"labelY",e),d,h,f=this.getLabelText(t,e);if(f!=null&&f!==""&&!isNaN(c)&&!isNaN(u)){this.setupTextStyle(a,t,n);var m=e?e+"-":"",g=ha(o,"labelWidth",e),y=ha(o,"labelHeight",e),v=t.pstyle(m+"text-margin-x").pfValue,E=t.pstyle(m+"text-margin-y").pfValue,C=t.isEdge(),_=t.pstyle("text-halign").value,x=t.pstyle("text-valign").value;C&&(_="center",x="center"),c+=v,u+=E;var P;switch(r?P=this.getTextAngle(t,e):P=0,P!==0&&(d=c,h=u,a.translate(d,h),a.rotate(P),c=0,u=0),x){case"top":break;case"center":u+=y/2;break;case"bottom":u+=y;break}var I=t.pstyle("text-background-opacity").value,M=t.pstyle("text-border-opacity").value,O=t.pstyle("text-border-width").pfValue,R=t.pstyle("text-background-padding").pfValue,F=t.pstyle("text-background-shape").strValue,$=F==="round-rectangle"||F==="roundrectangle",k=F==="circle",N=2;if(I>0||O>0&&M>0){var G=a.fillStyle,W=a.strokeStyle,Y=a.lineWidth,U=t.pstyle("text-background-color").value,Z=t.pstyle("text-border-color").value,q=t.pstyle("text-border-style").value,X=I>0,ie=O>0&&M>0,j=c-R;switch(_){case"left":j-=g;break;case"center":j-=g/2;break}var K=u-y-R,se=g+2*R,ne=y+2*R;if(X&&(a.fillStyle="rgba(".concat(U[0],",").concat(U[1],",").concat(U[2],",").concat(I*l,")")),ie&&(a.strokeStyle="rgba(".concat(Z[0],",").concat(Z[1],",").concat(Z[2],",").concat(M*l,")"),a.lineWidth=O,a.setLineDash))switch(q){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash([4,2]);break;case"double":a.lineWidth=O/4,a.setLineDash([]);break;case"solid":default:a.setLineDash([]);break}if($?(a.beginPath(),JG(a,j,K,se,ne,N)):k?(a.beginPath(),zEe(a,j,K,se,ne)):(a.beginPath(),a.rect(j,K,se,ne)),X&&a.fill(),ie&&a.stroke(),ie&&q==="double"){var ge=O/2;a.beginPath(),$?JG(a,j+ge,K+ge,se-2*ge,ne-2*ge,N):a.rect(j+ge,K+ge,se-2*ge,ne-2*ge),a.stroke()}a.fillStyle=G,a.strokeStyle=W,a.lineWidth=Y,a.setLineDash&&a.setLineDash([])}var ve=2*t.pstyle("text-outline-width").pfValue;if(ve>0&&(a.lineWidth=ve),t.pstyle("text-wrap").value==="wrap"){var Se=ha(o,"labelWrapCachedLines",e),Te=ha(o,"labelLineHeight",e),me=g/2,pe=this.getLabelJustification(t);switch(pe==="auto"||(_==="left"?pe==="left"?c+=-g:pe==="center"&&(c+=-me):_==="center"?pe==="left"?c+=-me:pe==="right"&&(c+=me):_==="right"&&(pe==="center"?c+=me:pe==="right"&&(c+=g))),x){case"top":u-=(Se.length-1)*Te;break;case"center":case"bottom":u-=(Se.length-1)*Te;break}for(var B=0;B<Se.length;B++)ve>0&&a.strokeText(Se[B],c,u),a.fillText(Se[B],c,u),u+=Te}else ve>0&&a.strokeText(f,c,u),a.fillText(f,c,u);P!==0&&(a.rotate(-P),a.translate(-d,-h))}}};Sc={};Sc.drawNode=function(a,t,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l,c,u=t._private,d=u.rscratch,h=t.position();if(!(!We(h.x)||!We(h.y))&&!(s&&!t.visible())){var f=s?t.effectiveOpacity():1,m=o.usePaths(),g,y=!1,v=t.padding();l=t.width()+2*v,c=t.height()+2*v;var E;e&&(E=e,a.translate(-E.x1,-E.y1));for(var C=t.pstyle("background-image"),_=C.value,x=new Array(_.length),P=new Array(_.length),I=0,M=0;M<_.length;M++){var O=_[M],R=x[M]=O!=null&&O!=="none";if(R){var F=t.cy().style().getIndexedStyle(t,"background-image-crossorigin","value",M);I++,P[M]=o.getCachedImage(O,F,function(){u.backgroundTimestamp=Date.now(),t.emitAndNotify("background")})}}var $=t.pstyle("background-blacken").value,k=t.pstyle("border-width").pfValue,N=t.pstyle("background-opacity").value*f,G=t.pstyle("border-color").value,W=t.pstyle("border-style").value,Y=t.pstyle("border-join").value,U=t.pstyle("border-cap").value,Z=t.pstyle("border-position").value,q=t.pstyle("border-dash-pattern").pfValue,X=t.pstyle("border-dash-offset").pfValue,ie=t.pstyle("border-opacity").value*f,j=t.pstyle("outline-width").pfValue,K=t.pstyle("outline-color").value,se=t.pstyle("outline-style").value,ne=t.pstyle("outline-opacity").value*f,ge=t.pstyle("outline-offset").value,ve=t.pstyle("corner-radius").value;ve!=="auto"&&(ve=t.pstyle("corner-radius").pfValue);var Se=function(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N;o.eleFillStyle(a,t,$e)},Te=function(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ie;o.colorStrokeStyle(a,G[0],G[1],G[2],$e)},me=function(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ne;o.colorStrokeStyle(a,K[0],K[1],K[2],$e)},pe=function($e,Ie,ee,ye){var Pe=o.nodePathCache=o.nodePathCache||[],xe=TV(ee==="polygon"?ee+","+ye.join(","):ee,""+Ie,""+$e,""+ve),Fe=Pe[xe],qe,Re=!1;return Fe!=null?(qe=Fe,Re=!0,d.pathCache=qe):(qe=new Path2D,Pe[xe]=d.pathCache=qe),{path:qe,cacheHit:Re}},B=t.pstyle("shape").strValue,oe=t.pstyle("shape-polygon-points").pfValue;if(m){a.translate(h.x,h.y);var he=pe(l,c,B,oe);g=he.path,y=he.cacheHit}var te=function(){if(!y){var $e=h;m&&($e={x:0,y:0}),o.nodeShapes[o.getNodeShape(t)].draw(g||a,$e.x,$e.y,l,c,ve,d)}m?a.fill(g):a.fill()},re=function(){for(var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ee=u.backgrounding,ye=0,Pe=0;Pe<P.length;Pe++){var xe=t.cy().style().getIndexedStyle(t,"background-image-containment","value",Pe);if(Ie&&xe==="over"||!Ie&&xe==="inside"){ye++;continue}x[Pe]&&P[Pe].complete&&!P[Pe].error&&(ye++,o.drawInscribedImage(a,P[Pe],t,Pe,$e))}u.backgrounding=ye!==I,ee!==u.backgrounding&&t.updateStyle(!1)},ce=function(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f;o.hasPie(t)&&(o.drawPie(a,t,Ie),$e&&(m||o.nodeShapes[o.getNodeShape(t)].draw(a,h.x,h.y,l,c,ve,d)))},Ee=function(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f;o.hasStripe(t)&&(a.save(),m?a.clip(d.pathCache):(o.nodeShapes[o.getNodeShape(t)].draw(a,h.x,h.y,l,c,ve,d),a.clip()),o.drawStripe(a,t,Ie),a.restore(),$e&&(m||o.nodeShapes[o.getNodeShape(t)].draw(a,h.x,h.y,l,c,ve,d)))},Ce=function(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:f,Ie=($>0?$:-$)*$e,ee=$>0?0:255;$!==0&&(o.colorFillStyle(a,ee,ee,ee,Ie),m?a.fill(g):a.fill())},le=function(){if(k>0){if(a.lineWidth=k,a.lineCap=U,a.lineJoin=Y,a.setLineDash)switch(W){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(q),a.lineDashOffset=X;break;case"solid":case"double":a.setLineDash([]);break}if(Z!=="center"){if(a.save(),a.lineWidth*=2,Z==="inside")m?a.clip(g):a.clip();else{var $e=new Path2D;$e.rect(-l/2-k,-c/2-k,l+2*k,c+2*k),$e.addPath(g),a.clip($e,"evenodd")}m?a.stroke(g):a.stroke(),a.restore()}else m?a.stroke(g):a.stroke();if(W==="double"){a.lineWidth=k/3;var Ie=a.globalCompositeOperation;a.globalCompositeOperation="destination-out",m?a.stroke(g):a.stroke(),a.globalCompositeOperation=Ie}a.setLineDash&&a.setLineDash([])}},we=function(){if(j>0){if(a.lineWidth=j,a.lineCap="butt",a.setLineDash)switch(se){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash([4,2]);break;case"solid":case"double":a.setLineDash([]);break}var $e=h;m&&($e={x:0,y:0});var Ie=o.getNodeShape(t),ee=k;Z==="inside"&&(ee=0),Z==="outside"&&(ee*=2);var ye=(l+ee+(j+ge))/l,Pe=(c+ee+(j+ge))/c,xe=l*ye,Fe=c*Pe,qe=o.nodeShapes[Ie].points,Re;if(m){var ze=pe(xe,Fe,Ie,qe);Re=ze.path}if(Ie==="ellipse")o.drawEllipsePath(Re||a,$e.x,$e.y,xe,Fe);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(Ie)){var Ze=0,rt=0,Ct=0;Ie==="round-diamond"?Ze=(ee+ge+j)*1.4:Ie==="round-heptagon"?(Ze=(ee+ge+j)*1.075,Ct=-(ee/2+ge+j)/35):Ie==="round-hexagon"?Ze=(ee+ge+j)*1.12:Ie==="round-pentagon"?(Ze=(ee+ge+j)*1.13,Ct=-(ee/2+ge+j)/15):Ie==="round-tag"?(Ze=(ee+ge+j)*1.12,rt=(ee/2+j+ge)*.07):Ie==="round-triangle"&&(Ze=(ee+ge+j)*(Math.PI/2),Ct=-(ee+ge/2+j)/Math.PI),Ze!==0&&(ye=(l+Ze)/l,xe=l*ye,["round-hexagon","round-tag"].includes(Ie)||(Pe=(c+Ze)/c,Fe=c*Pe)),ve=ve==="auto"?IV(xe,Fe):ve;for(var bt=xe/2,Xe=Fe/2,wt=ve+(ee+j+ge)/2,vt=new Array(qe.length/2),Kr=new Array(qe.length/2),ur=0;ur<qe.length/2;ur++)vt[ur]={x:$e.x+rt+bt*qe[ur*2],y:$e.y+Ct+Xe*qe[ur*2+1]};var Si,mr,Wt,De,ri=vt.length;for(mr=vt[ri-1],Si=0;Si<ri;Si++)Wt=vt[Si%ri],De=vt[(Si+1)%ri],Kr[Si]=XD(mr,Wt,De,wt),mr=Wt,Wt=De;o.drawRoundPolygonPath(Re||a,$e.x+rt,$e.y+Ct,l*ye,c*Pe,qe,Kr)}else if(["roundrectangle","round-rectangle"].includes(Ie))ve=ve==="auto"?vc(xe,Fe):ve,o.drawRoundRectanglePath(Re||a,$e.x,$e.y,xe,Fe,ve+(ee+j+ge)/2);else if(["cutrectangle","cut-rectangle"].includes(Ie))ve=ve==="auto"?zD():ve,o.drawCutRectanglePath(Re||a,$e.x,$e.y,xe,Fe,null,ve+(ee+j+ge)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(Ie))ve=ve==="auto"?vc(xe,Fe):ve,o.drawBottomRoundRectanglePath(Re||a,$e.x,$e.y,xe,Fe,ve+(ee+j+ge)/2);else if(Ie==="barrel")o.drawBarrelPath(Re||a,$e.x,$e.y,xe,Fe);else if(Ie.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(Ie)){var va=(ee+j+ge)/l;qe=gw(vw(qe,va)),o.drawPolygonPath(Re||a,$e.x,$e.y,l,c,qe)}else{var Nt=(ee+j+ge)/l;qe=gw(vw(qe,-Nt)),o.drawPolygonPath(Re||a,$e.x,$e.y,l,c,qe)}if(m?a.stroke(Re):a.stroke(),se==="double"){a.lineWidth=ee/3;var un=a.globalCompositeOperation;a.globalCompositeOperation="destination-out",m?a.stroke(Re):a.stroke(),a.globalCompositeOperation=un}a.setLineDash&&a.setLineDash([])}},Le=function(){n&&o.drawNodeOverlay(a,t,h,l,c)},Me=function(){n&&o.drawNodeUnderlay(a,t,h,l,c)},Ne=function(){o.drawElementText(a,t,null,r)},Ge=t.pstyle("ghost").value==="yes";if(Ge){var Ye=t.pstyle("ghost-offset-x").pfValue,ft=t.pstyle("ghost-offset-y").pfValue,ct=t.pstyle("ghost-opacity").value,Ve=ct*f;a.translate(Ye,ft),me(),we(),Se(ct*N),te(),re(Ve,!0),Te(ct*ie),le(),ce($!==0||k!==0),Ee($!==0||k!==0),re(Ve,!1),Ce(Ve),a.translate(-Ye,-ft)}m&&a.translate(-h.x,-h.y),Me(),m&&a.translate(h.x,h.y),me(),we(),Se(),te(),re(f,!0),Te(),le(),ce($!==0||k!==0),Ee($!==0||k!==0),re(f,!1),Ce(),m&&a.translate(-h.x,-h.y),Ne(),Le(),e&&a.translate(E.x1,E.y1)}};B5=function(t){if(!["overlay","underlay"].includes(t))throw new Error("Invalid state");return function(e,r,n,s,o){var l=this;if(r.visible()){var c=r.pstyle("".concat(t,"-padding")).pfValue,u=r.pstyle("".concat(t,"-opacity")).value,d=r.pstyle("".concat(t,"-color")).value,h=r.pstyle("".concat(t,"-shape")).value,f=r.pstyle("".concat(t,"-corner-radius")).value;if(u>0){if(n=n||r.position(),s==null||o==null){var m=r.padding();s=r.width()+2*m,o=r.height()+2*m}l.colorFillStyle(e,d[0],d[1],d[2],u),l.nodeShapes[h].draw(e,n.x,n.y,s+c*2,o+c*2,f),e.fill()}}}};Sc.drawNodeOverlay=B5("overlay");Sc.drawNodeUnderlay=B5("underlay");Sc.hasPie=function(a){return a=a[0],a._private.hasPie};Sc.hasStripe=function(a){return a=a[0],a._private.hasStripe};Sc.drawPie=function(a,t,e,r){t=t[0],r=r||t.position();var n=t.cy().style(),s=t.pstyle("pie-size"),o=t.pstyle("pie-hole"),l=t.pstyle("pie-start-angle").pfValue,c=r.x,u=r.y,d=t.width(),h=t.height(),f=Math.min(d,h)/2,m,g=0,y=this.usePaths();if(y&&(c=0,u=0),s.units==="%"?f=f*s.pfValue:s.pfValue!==void 0&&(f=s.pfValue/2),o.units==="%"?m=f*o.pfValue:o.pfValue!==void 0&&(m=o.pfValue/2),!(m>=f))for(var v=1;v<=n.pieBackgroundN;v++){var E=t.pstyle("pie-"+v+"-background-size").value,C=t.pstyle("pie-"+v+"-background-color").value,_=t.pstyle("pie-"+v+"-background-opacity").value*e,x=E/100;x+g>1&&(x=1-g);var P=1.5*Math.PI+2*Math.PI*g;P+=l;var I=2*Math.PI*x,M=P+I;E===0||g>=1||g+x>1||(m===0?(a.beginPath(),a.moveTo(c,u),a.arc(c,u,f,P,M),a.closePath()):(a.beginPath(),a.arc(c,u,f,P,M),a.arc(c,u,m,M,P,!0),a.closePath()),this.colorFillStyle(a,C[0],C[1],C[2],_),a.fill(),g+=x)}};Sc.drawStripe=function(a,t,e,r){t=t[0],r=r||t.position();var n=t.cy().style(),s=r.x,o=r.y,l=t.width(),c=t.height(),u=0,d=this.usePaths();a.save();var h=t.pstyle("stripe-direction").value,f=t.pstyle("stripe-size");switch(h){case"vertical":break;case"righward":a.rotate(-Math.PI/2);break}var m=l,g=c;f.units==="%"?(m=m*f.pfValue,g=g*f.pfValue):f.pfValue!==void 0&&(m=f.pfValue,g=f.pfValue),d&&(s=0,o=0),o-=m/2,s-=g/2;for(var y=1;y<=n.stripeBackgroundN;y++){var v=t.pstyle("stripe-"+y+"-background-size").value,E=t.pstyle("stripe-"+y+"-background-color").value,C=t.pstyle("stripe-"+y+"-background-opacity").value*e,_=v/100;_+u>1&&(_=1-u),!(v===0||u>=1||u+_>1)&&(a.beginPath(),a.rect(s,o+g*u,m,g*_),a.closePath(),this.colorFillStyle(a,E[0],E[1],E[2],C),a.fill(),u+=_)}a.restore()};jn={},HEe=100;jn.getPixelRatio=function(){var a=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var t=this.cy.window(),e=a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;return(t.devicePixelRatio||1)/e};jn.paintCache=function(a){for(var t=this.paintCaches=this.paintCaches||[],e=!0,r,n=0;n<t.length;n++)if(r=t[n],r.context===a){e=!1;break}return e&&(r={context:a},t.push(r)),r};jn.createGradientStyleFor=function(a,t,e,r,n){var s,o=this.usePaths(),l=e.pstyle(t+"-gradient-stop-colors").value,c=e.pstyle(t+"-gradient-stop-positions").pfValue;if(r==="radial-gradient")if(e.isEdge()){var u=e.sourceEndpoint(),d=e.targetEndpoint(),h=e.midpoint(),f=qu(u,h),m=qu(d,h);s=a.createRadialGradient(h.x,h.y,0,h.x,h.y,Math.max(f,m))}else{var g=o?{x:0,y:0}:e.position(),y=e.paddedWidth(),v=e.paddedHeight();s=a.createRadialGradient(g.x,g.y,0,g.x,g.y,Math.max(y,v))}else if(e.isEdge()){var E=e.sourceEndpoint(),C=e.targetEndpoint();s=a.createLinearGradient(E.x,E.y,C.x,C.y)}else{var _=o?{x:0,y:0}:e.position(),x=e.paddedWidth(),P=e.paddedHeight(),I=x/2,M=P/2,O=e.pstyle("background-gradient-direction").value;switch(O){case"to-bottom":s=a.createLinearGradient(_.x,_.y-M,_.x,_.y+M);break;case"to-top":s=a.createLinearGradient(_.x,_.y+M,_.x,_.y-M);break;case"to-left":s=a.createLinearGradient(_.x+I,_.y,_.x-I,_.y);break;case"to-right":s=a.createLinearGradient(_.x-I,_.y,_.x+I,_.y);break;case"to-bottom-right":case"to-right-bottom":s=a.createLinearGradient(_.x-I,_.y-M,_.x+I,_.y+M);break;case"to-top-right":case"to-right-top":s=a.createLinearGradient(_.x-I,_.y+M,_.x+I,_.y-M);break;case"to-bottom-left":case"to-left-bottom":s=a.createLinearGradient(_.x+I,_.y-M,_.x-I,_.y+M);break;case"to-top-left":case"to-left-top":s=a.createLinearGradient(_.x+I,_.y+M,_.x-I,_.y-M);break}}if(!s)return null;for(var R=c.length===l.length,F=l.length,$=0;$<F;$++)s.addColorStop(R?c[$]:$/(F-1),"rgba("+l[$][0]+","+l[$][1]+","+l[$][2]+","+n+")");return s};jn.gradientFillStyle=function(a,t,e,r){var n=this.createGradientStyleFor(a,"background",t,e,r);if(!n)return null;a.fillStyle=n};jn.colorFillStyle=function(a,t,e,r,n){a.fillStyle="rgba("+t+","+e+","+r+","+n+")"};jn.eleFillStyle=function(a,t,e){var r=t.pstyle("background-fill").value;if(r==="linear-gradient"||r==="radial-gradient")this.gradientFillStyle(a,t,r,e);else{var n=t.pstyle("background-color").value;this.colorFillStyle(a,n[0],n[1],n[2],e)}};jn.gradientStrokeStyle=function(a,t,e,r){var n=this.createGradientStyleFor(a,"line",t,e,r);if(!n)return null;a.strokeStyle=n};jn.colorStrokeStyle=function(a,t,e,r,n){a.strokeStyle="rgba("+t+","+e+","+r+","+n+")"};jn.eleStrokeStyle=function(a,t,e){var r=t.pstyle("line-fill").value;if(r==="linear-gradient"||r==="radial-gradient")this.gradientStrokeStyle(a,t,r,e);else{var n=t.pstyle("line-color").value;this.colorStrokeStyle(a,n[0],n[1],n[2],e)}};jn.matchCanvasSize=function(a){var t=this,e=t.data,r=t.findContainerClientCoords(),n=r[2],s=r[3],o=t.getPixelRatio(),l=t.motionBlurPxRatio;(a===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]||a===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG])&&(o=l);var c=n*o,u=s*o,d;if(!(c===t.canvasWidth&&u===t.canvasHeight)){t.fontCaches=null;var h=e.canvasContainer;h.style.width=n+"px",h.style.height=s+"px";for(var f=0;f<t.CANVAS_LAYERS;f++)d=e.canvases[f],d.width=c,d.height=u,d.style.width=n+"px",d.style.height=s+"px";for(var f=0;f<t.BUFFER_COUNT;f++)d=e.bufferCanvases[f],d.width=c,d.height=u,d.style.width=n+"px",d.style.height=s+"px";t.textureMult=1,o<=1&&(d=e.bufferCanvases[t.TEXTURE_BUFFER],t.textureMult=2,d.width=c*t.textureMult,d.height=u*t.textureMult),t.canvasWidth=c,t.canvasHeight=u,t.pixelRatio=o}};jn.renderTo=function(a,t,e,r){this.render({forcedContext:a,forcedZoom:t,forcedPan:e,drawAllLayers:!0,forcedPxRatio:r})};jn.clearCanvas=function(){var a=this,t=a.data;function e(r){r.clearRect(0,0,a.canvasWidth,a.canvasHeight)}e(t.contexts[a.NODE]),e(t.contexts[a.DRAG])};jn.render=function(a){var t=this;a=a||xV();var e=t.cy,r=a.forcedContext,n=a.drawAllLayers,s=a.drawOnlyNodeLayer,o=a.forcedZoom,l=a.forcedPan,c=a.forcedPxRatio===void 0?this.getPixelRatio():a.forcedPxRatio,u=t.data,d=u.canvasNeedsRedraw,h=t.textureOnViewport&&!r&&(t.pinching||t.hoverData.dragging||t.swipePanning||t.data.wheelZooming),f=a.motionBlur!==void 0?a.motionBlur:t.motionBlur,m=t.motionBlurPxRatio,g=e.hasCompoundNodes(),y=t.hoverData.draggingEles,v=!!(t.hoverData.selecting||t.touchData.selecting);f=f&&!r&&t.motionBlurEnabled&&!v;var E=f;r||(t.prevPxRatio!==c&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container),t.redrawHint("eles",!0),t.redrawHint("drag",!0)),t.prevPxRatio=c),!r&&t.motionBlurTimeout&&clearTimeout(t.motionBlurTimeout),f&&(t.mbFrames==null&&(t.mbFrames=0),t.mbFrames++,t.mbFrames<3&&(E=!1),t.mbFrames>t.minMbLowQualFrames&&(t.motionBlurPxRatio=t.mbPxRBlurry)),t.clearingMotionBlur&&(t.motionBlurPxRatio=1),t.textureDrawLastFrame&&!h&&(d[t.NODE]=!0,d[t.SELECT_BOX]=!0);var C=e.style(),_=e.zoom(),x=o!==void 0?o:_,P=e.pan(),I={x:P.x,y:P.y},M={zoom:_,pan:{x:P.x,y:P.y}},O=t.prevViewport,R=O===void 0||M.zoom!==O.zoom||M.pan.x!==O.pan.x||M.pan.y!==O.pan.y;!R&&!(y&&!g)&&(t.motionBlurPxRatio=1),l&&(I=l),x*=c,I.x*=c,I.y*=c;var F=t.getCachedZSortedEles();function $(Te,me,pe,B,oe){var he=Te.globalCompositeOperation;Te.globalCompositeOperation="destination-out",t.colorFillStyle(Te,255,255,255,t.motionBlurTransparency),Te.fillRect(me,pe,B,oe),Te.globalCompositeOperation=he}function k(Te,me){var pe,B,oe,he;!t.clearingMotionBlur&&(Te===u.bufferContexts[t.MOTIONBLUR_BUFFER_NODE]||Te===u.bufferContexts[t.MOTIONBLUR_BUFFER_DRAG])?(pe={x:P.x*m,y:P.y*m},B=_*m,oe=t.canvasWidth*m,he=t.canvasHeight*m):(pe=I,B=x,oe=t.canvasWidth,he=t.canvasHeight),Te.setTransform(1,0,0,1,0,0),me==="motionBlur"?$(Te,0,0,oe,he):!r&&(me===void 0||me)&&Te.clearRect(0,0,oe,he),n||(Te.translate(pe.x,pe.y),Te.scale(B,B)),l&&Te.translate(l.x,l.y),o&&Te.scale(o,o)}if(h||(t.textureDrawLastFrame=!1),h){if(t.textureDrawLastFrame=!0,!t.textureCache){t.textureCache={},t.textureCache.bb=e.mutableElements().boundingBox(),t.textureCache.texture=t.data.bufferCanvases[t.TEXTURE_BUFFER];var N=t.data.bufferContexts[t.TEXTURE_BUFFER];N.setTransform(1,0,0,1,0,0),N.clearRect(0,0,t.canvasWidth*t.textureMult,t.canvasHeight*t.textureMult),t.render({forcedContext:N,drawOnlyNodeLayer:!0,forcedPxRatio:c*t.textureMult});var M=t.textureCache.viewport={zoom:e.zoom(),pan:e.pan(),width:t.canvasWidth,height:t.canvasHeight};M.mpan={x:(0-M.pan.x)/M.zoom,y:(0-M.pan.y)/M.zoom}}d[t.DRAG]=!1,d[t.NODE]=!1;var G=u.contexts[t.NODE],W=t.textureCache.texture,M=t.textureCache.viewport;G.setTransform(1,0,0,1,0,0),f?$(G,0,0,M.width,M.height):G.clearRect(0,0,M.width,M.height);var Y=C.core("outside-texture-bg-color").value,U=C.core("outside-texture-bg-opacity").value;t.colorFillStyle(G,Y[0],Y[1],Y[2],U),G.fillRect(0,0,M.width,M.height);var _=e.zoom();k(G,!1),G.clearRect(M.mpan.x,M.mpan.y,M.width/M.zoom/c,M.height/M.zoom/c),G.drawImage(W,M.mpan.x,M.mpan.y,M.width/M.zoom/c,M.height/M.zoom/c)}else t.textureOnViewport&&!r&&(t.textureCache=null);var Z=e.extent(),q=t.pinching||t.hoverData.dragging||t.swipePanning||t.data.wheelZooming||t.hoverData.draggingEles||t.cy.animated(),X=t.hideEdgesOnViewport&&q,ie=[];if(ie[t.NODE]=!d[t.NODE]&&f&&!t.clearedForMotionBlur[t.NODE]||t.clearingMotionBlur,ie[t.NODE]&&(t.clearedForMotionBlur[t.NODE]=!0),ie[t.DRAG]=!d[t.DRAG]&&f&&!t.clearedForMotionBlur[t.DRAG]||t.clearingMotionBlur,ie[t.DRAG]&&(t.clearedForMotionBlur[t.DRAG]=!0),d[t.NODE]||n||s||ie[t.NODE]){var j=f&&!ie[t.NODE]&&m!==1,G=r||(j?t.data.bufferContexts[t.MOTIONBLUR_BUFFER_NODE]:u.contexts[t.NODE]),K=f&&!j?"motionBlur":void 0;k(G,K),X?t.drawCachedNodes(G,F.nondrag,c,Z):t.drawLayeredElements(G,F.nondrag,c,Z),t.debug&&t.drawDebugPoints(G,F.nondrag),!n&&!f&&(d[t.NODE]=!1)}if(!s&&(d[t.DRAG]||n||ie[t.DRAG])){var j=f&&!ie[t.DRAG]&&m!==1,G=r||(j?t.data.bufferContexts[t.MOTIONBLUR_BUFFER_DRAG]:u.contexts[t.DRAG]);k(G,f&&!j?"motionBlur":void 0),X?t.drawCachedNodes(G,F.drag,c,Z):t.drawCachedElements(G,F.drag,c,Z),t.debug&&t.drawDebugPoints(G,F.drag),!n&&!f&&(d[t.DRAG]=!1)}if(this.drawSelectionRectangle(a,k),f&&m!==1){var se=u.contexts[t.NODE],ne=t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE],ge=u.contexts[t.DRAG],ve=t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG],Se=function(me,pe,B){me.setTransform(1,0,0,1,0,0),B||!E?me.clearRect(0,0,t.canvasWidth,t.canvasHeight):$(me,0,0,t.canvasWidth,t.canvasHeight);var oe=m;me.drawImage(pe,0,0,t.canvasWidth*oe,t.canvasHeight*oe,0,0,t.canvasWidth,t.canvasHeight)};(d[t.NODE]||ie[t.NODE])&&(Se(se,ne,ie[t.NODE]),d[t.NODE]=!1),(d[t.DRAG]||ie[t.DRAG])&&(Se(ge,ve,ie[t.DRAG]),d[t.DRAG]=!1)}t.prevViewport=M,t.clearingMotionBlur&&(t.clearingMotionBlur=!1,t.motionBlurCleared=!0,t.motionBlur=!0),f&&(t.motionBlurTimeout=setTimeout(function(){t.motionBlurTimeout=null,t.clearedForMotionBlur[t.NODE]=!1,t.clearedForMotionBlur[t.DRAG]=!1,t.motionBlur=!1,t.clearingMotionBlur=!h,t.mbFrames=0,d[t.NODE]=!0,d[t.DRAG]=!0,t.redraw()},HEe)),r||e.emit("render")};jn.drawSelectionRectangle=function(a,t){var e=this,r=e.cy,n=e.data,s=r.style(),o=a.drawOnlyNodeLayer,l=a.drawAllLayers,c=n.canvasNeedsRedraw,u=a.forcedContext;if(e.showFps||!o&&c[e.SELECT_BOX]&&!l){var d=u||n.contexts[e.SELECT_BOX];if(t(d),e.selection[4]==1&&(e.hoverData.selecting||e.touchData.selecting)){var h=e.cy.zoom(),f=s.core("selection-box-border-width").value/h;d.lineWidth=f,d.fillStyle="rgba("+s.core("selection-box-color").value[0]+","+s.core("selection-box-color").value[1]+","+s.core("selection-box-color").value[2]+","+s.core("selection-box-opacity").value+")",d.fillRect(e.selection[0],e.selection[1],e.selection[2]-e.selection[0],e.selection[3]-e.selection[1]),f>0&&(d.strokeStyle="rgba("+s.core("selection-box-border-color").value[0]+","+s.core("selection-box-border-color").value[1]+","+s.core("selection-box-border-color").value[2]+","+s.core("selection-box-opacity").value+")",d.strokeRect(e.selection[0],e.selection[1],e.selection[2]-e.selection[0],e.selection[3]-e.selection[1]))}if(n.bgActivePosistion&&!e.hoverData.selecting){var h=e.cy.zoom(),m=n.bgActivePosistion;d.fillStyle="rgba("+s.core("active-bg-color").value[0]+","+s.core("active-bg-color").value[1]+","+s.core("active-bg-color").value[2]+","+s.core("active-bg-opacity").value+")",d.beginPath(),d.arc(m.x,m.y,s.core("active-bg-size").pfValue/h,0,2*Math.PI),d.fill()}var g=e.lastRedrawTime;if(e.showFps&&g){g=Math.round(g);var y=Math.round(1e3/g),v="1 frame = "+g+" ms = "+y+" fps";if(d.setTransform(1,0,0,1,0,0),d.fillStyle="rgba(255, 0, 0, 0.75)",d.strokeStyle="rgba(255, 0, 0, 0.75)",d.font="30px Arial",!$g){var E=d.measureText(v);$g=E.actualBoundingBoxAscent}d.fillText(v,0,$g);var C=60;d.strokeRect(0,$g+10,250,20),d.fillRect(0,$g+10,250*Math.min(y/C,1),20)}l||(c[e.SELECT_BOX]=!1)}};eV=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)});rTe=(function(){function a(t,e,r,n){Tc(this,a),this.debugID=Math.floor(Math.random()*1e4),this.r=t,this.texSize=e,this.texRows=r,this.texHeight=Math.floor(e/r),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=n(t,e,e),this.scratch=n(t,e,this.texHeight,"scratch")}return Cc(a,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(e){var r=e.w,n=e.h,s=this.texHeight,o=this.texSize,l=s/n,c=r*l,u=n*l;return c>o&&(l=o/r,c=r*l,u=n*l),{scale:l,texW:c,texH:u}}},{key:"draw",value:function(e,r,n){var s=this;if(this.locked)throw new Error("can't draw, atlas is locked");var o=this.texSize,l=this.texRows,c=this.texHeight,u=this.getScale(r),d=u.scale,h=u.texW,f=u.texH,m=function(_,x){if(n&&x){var P=x.context,I=_.x,M=_.row,O=I,R=c*M;P.save(),P.translate(O,R),P.scale(d,d),n(P,r),P.restore()}},g=[null,null],y=function(){m(s.freePointer,s.canvas),g[0]={x:s.freePointer.x,y:s.freePointer.row*c,w:h,h:f},g[1]={x:s.freePointer.x+h,y:s.freePointer.row*c,w:0,h:f},s.freePointer.x+=h,s.freePointer.x==o&&(s.freePointer.x=0,s.freePointer.row++)},v=function(){var _=s.scratch,x=s.canvas;_.clear(),m({x:0,row:0},_);var P=o-s.freePointer.x,I=h-P,M=c;{var O=s.freePointer.x,R=s.freePointer.row*c,F=P;x.context.drawImage(_,0,0,F,M,O,R,F,M),g[0]={x:O,y:R,w:F,h:f}}{var $=P,k=(s.freePointer.row+1)*c,N=I;x&&x.context.drawImage(_,$,0,N,M,0,k,N,M),g[1]={x:0,y:k,w:N,h:f}}s.freePointer.x=I,s.freePointer.row++},E=function(){s.freePointer.x=0,s.freePointer.row++};if(this.freePointer.x+h<=o)y();else{if(this.freePointer.row>=l-1)return!1;this.freePointer.x===o?(E(),y()):this.enableWrapping?v():(E(),y())}return this.keyToLocation.set(e,g),this.needsBuffer=!0,g}},{key:"getOffsets",value:function(e){return this.keyToLocation.get(e)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(e){if(this.locked)return!1;var r=this.texSize,n=this.texRows,s=this.getScale(e),o=s.texW;return this.freePointer.x+o>r?this.freePointer.row<n-1:!0}},{key:"bufferIfNeeded",value:function(e){this.texture||(this.texture=ZEe(e,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])})(),iTe=(function(){function a(t,e,r,n){Tc(this,a),this.r=t,this.texSize=e,this.texRows=r,this.createTextureCanvas=n,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return Cc(a,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var e=this.r,r=this.texSize,n=this.texRows,s=this.createTextureCanvas;return new rTe(e,r,n,s)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var e=this.r,r=this.texSize,n=this.texRows,s=this.createTextureCanvas,o=Math.floor(r/n);this.scratch=s(e,r,o,"scratch")}return this.scratch}},{key:"draw",value:function(e,r,n){var s=this.styleKeyToAtlas.get(e);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(r))&&(s&&s.lock(),s=this._createAtlas(),this.atlases.push(s)),s.draw(e,r,n),this.styleKeyToAtlas.set(e,s)),s}},{key:"getAtlas",value:function(e){return this.styleKeyToAtlas.get(e)}},{key:"hasAtlas",value:function(e){return this.styleKeyToAtlas.has(e)}},{key:"markKeyForGC",value:function(e){this.markedKeys.add(e)}},{key:"gc",value:function(){var e=this,r=this.markedKeys;if(r.size===0){console.log("nothing to garbage collect");return}var n=[],s=new Map,o=null,l=pa(this.atlases),c;try{var u=function(){var h=c.value,f=h.getKeys(),m=nTe(r,f);if(m.size===0)return n.push(h),f.forEach(function(P){return s.set(P,h)}),1;o||(o=e._createAtlas(),n.push(o));var g=pa(f),y;try{for(g.s();!(y=g.n()).done;){var v=y.value;if(!m.has(v)){var E=h.getOffsets(v),C=Ci(E,2),_=C[0],x=C[1];o.canFit({w:_.w+x.w,h:_.h})||(o.lock(),o=e._createAtlas(),n.push(o)),h.canvas&&(e._copyTextureToNewAtlas(v,h,o),s.set(v,o))}}}catch(P){g.e(P)}finally{g.f()}h.dispose()};for(l.s();!(c=l.n()).done;)u()}catch(d){l.e(d)}finally{l.f()}this.atlases=n,this.styleKeyToAtlas=s,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(e,r,n){var s=r.getOffsets(e),o=Ci(s,2),l=o[0],c=o[1];if(c.w===0)n.draw(e,l,function(f){f.drawImage(r.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h)});else{var u=this._getScratchCanvas();u.clear(),u.context.drawImage(r.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h),u.context.drawImage(r.canvas,c.x,c.y,c.w,c.h,l.w,0,c.w,c.h);var d=l.w+c.w,h=l.h;n.draw(e,{w:d,h},function(f){f.drawImage(u,0,0,d,h,0,0,d,h)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])})();aTe=(function(){function a(t,e){Tc(this,a),this.r=t,this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return Cc(a,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(e,r){var n=this.globalOptions,s=n.webglTexSize,o=n.createTextureCanvas,l=r.texRows,c=this._cacheScratchCanvas(o),u=new iTe(this.r,s,l,c);this.collections.set(e,u)}},{key:"addRenderType",value:function(e,r){var n=r.collection;if(!this.collections.has(n))throw new Error("invalid atlas collection name '".concat(n,"'"));var s=this.collections.get(n),o=ut({type:e,atlasCollection:s},r);this.renderTypes.set(e,o)}},{key:"getRenderTypeOpts",value:function(e){return this.renderTypes.get(e)}},{key:"getAtlasCollection",value:function(e){return this.collections.get(e)}},{key:"_cacheScratchCanvas",value:function(e){var r=-1,n=-1,s=null;return function(o,l,c,u){return u?((!s||l!=r||c!=n)&&(r=l,n=c,s=e(o,l,c)),s):e(o,l,c)}}},{key:"_key",value:function(e,r){return"".concat(e,"-").concat(r)}},{key:"invalidate",value:function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.forceRedraw,o=s===void 0?!1:s,l=n.filterEle,c=l===void 0?function(){return!0}:l,u=n.filterType,d=u===void 0?function(){return!0}:u,h=!1,f=!1,m=pa(e),g;try{for(m.s();!(g=m.n()).done;){var y=g.value;if(c(y)){var v=pa(this.renderTypes.values()),E;try{var C=function(){var x=E.value,P=x.type;if(d(P)){var I=r.collections.get(x.collection),M=x.getKey(y),O=Array.isArray(M)?M:[M];if(o)O.forEach(function(k){return I.markKeyForGC(k)}),f=!0;else{var R=x.getID?x.getID(y):y.id(),F=r._key(P,R),$=r.typeAndIdToKey.get(F);$!==void 0&&!YEe(O,$)&&(h=!0,r.typeAndIdToKey.delete(F),$.forEach(function(k){return I.markKeyForGC(k)}))}}};for(v.s();!(E=v.n()).done;)C()}catch(_){v.e(_)}finally{v.f()}}}}catch(_){m.e(_)}finally{m.f()}return f&&(this.gc(),h=!1),h}},{key:"gc",value:function(){var e=pa(this.collections.values()),r;try{for(e.s();!(r=e.n()).done;){var n=r.value;n.gc()}}catch(s){e.e(s)}finally{e.f()}}},{key:"getOrCreateAtlas",value:function(e,r,n,s){var o=this.renderTypes.get(r),l=this.collections.get(o.collection),c=!1,u=l.draw(s,n,function(f){o.drawClipped?(f.save(),f.beginPath(),f.rect(0,0,n.w,n.h),f.clip(),o.drawElement(f,e,n,!0,!0),f.restore()):o.drawElement(f,e,n,!0,!0),c=!0});if(c){var d=o.getID?o.getID(e):e.id(),h=this._key(r,d);this.typeAndIdToKey.has(h)?this.typeAndIdToKey.get(h).push(s):this.typeAndIdToKey.set(h,[s])}return u}},{key:"getAtlasInfo",value:function(e,r){var n=this,s=this.renderTypes.get(r),o=s.getKey(e),l=Array.isArray(o)?o:[o];return l.map(function(c){var u=s.getBoundingBox(e,c),d=n.getOrCreateAtlas(e,r,u,c),h=d.getOffsets(c),f=Ci(h,2),m=f[0],g=f[1];return{atlas:d,tex:m,tex1:m,tex2:g,bb:u}})}},{key:"getDebugInfo",value:function(){var e=[],r=pa(this.collections),n;try{for(r.s();!(n=r.n()).done;){var s=Ci(n.value,2),o=s[0],l=s[1],c=l.getCounts(),u=c.keyCount,d=c.atlasCount;e.push({type:o,keyCount:u,atlasCount:d})}}catch(h){r.e(h)}finally{r.f()}return e}}])})(),sTe=(function(){function a(t){Tc(this,a),this.globalOptions=t,this.atlasSize=t.webglTexSize,this.maxAtlasesPerBatch=t.webglTexPerBatch,this.batchAtlases=[]}return Cc(a,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(e,r){return r})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(e){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(e):!0}},{key:"getAtlasIndexForBatch",value:function(e){var r=this.batchAtlases.indexOf(e);if(r<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(e),r=this.batchAtlases.length-1}return r}}])})(),oTe=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,lTe=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,cTe=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,uTe=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,Yg={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},_w={IGNORE:1,USE_BB:2},aD=0,iV=1,nV=2,sD=3,df=4,ew=5,zg=6,Hg=7,dTe=(function(){function a(t,e,r){Tc(this,a),this.r=t,this.gl=e,this.maxInstances=r.webglBatchSize,this.atlasSize=r.webglTexSize,this.bgColor=r.bgColor,this.debug=r.webglDebug,this.batchDebugInfo=[],r.enableWrapping=!0,r.createTextureCanvas=VEe,this.atlasManager=new aTe(t,r),this.batchManager=new sTe(r),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(Yg.SCREEN),this.pickingProgram=this._createShaderProgram(Yg.PICKING),this.vao=this._createVAO()}return Cc(a,[{key:"addAtlasCollection",value:function(e,r){this.atlasManager.addAtlasCollection(e,r)}},{key:"addTextureAtlasRenderType",value:function(e,r){this.atlasManager.addRenderType(e,r)}},{key:"addSimpleShapeRenderType",value:function(e,r){this.simpleShapeOptions.set(e,r)}},{key:"invalidate",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.type,s=this.atlasManager;return n?s.invalidate(e,{filterType:function(l){return l===n},forceRedraw:!0}):s.invalidate(e)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(e){var r=this.gl,n=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(aD,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(df," || aVertType == ").concat(Hg,` 
             || aVertType == `).concat(ew," || aVertType == ").concat(zg,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(iV,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(nV,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(sD,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),s=this.batchManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(s.map(function(u){return"uniform sampler2D uTexture".concat(u,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(oTe,`
      `).concat(lTe,`
      `).concat(cTe,`
      `).concat(uTe,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(aD,`) {
          // look up the texel from the texture unit
          `).concat(s.map(function(u){return"if(vAtlasId == ".concat(u,") outColor = texture(uTexture").concat(u,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(sD,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(df,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(df," || vVertType == ").concat(Hg,` 
          || vVertType == `).concat(ew," || vVertType == ").concat(zg,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(df,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(Hg,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(Hg,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(e.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),l=GEe(r,n,o);l.aPosition=r.getAttribLocation(l,"aPosition"),l.aIndex=r.getAttribLocation(l,"aIndex"),l.aVertType=r.getAttribLocation(l,"aVertType"),l.aTransform=r.getAttribLocation(l,"aTransform"),l.aAtlasId=r.getAttribLocation(l,"aAtlasId"),l.aTex=r.getAttribLocation(l,"aTex"),l.aPointAPointB=r.getAttribLocation(l,"aPointAPointB"),l.aPointCPointD=r.getAttribLocation(l,"aPointCPointD"),l.aLineWidth=r.getAttribLocation(l,"aLineWidth"),l.aColor=r.getAttribLocation(l,"aColor"),l.aCornerRadius=r.getAttribLocation(l,"aCornerRadius"),l.aBorderColor=r.getAttribLocation(l,"aBorderColor"),l.uPanZoomMatrix=r.getUniformLocation(l,"uPanZoomMatrix"),l.uAtlasSize=r.getUniformLocation(l,"uAtlasSize"),l.uBGColor=r.getUniformLocation(l,"uBGColor"),l.uZoom=r.getUniformLocation(l,"uZoom"),l.uTextures=[];for(var c=0;c<this.batchManager.getMaxAtlasesPerBatch();c++)l.uTextures.push(r.getUniformLocation(l,"uTexture".concat(c)));return l}},{key:"_createVAO",value:function(){var e=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=e.length/2;var r=this.maxInstances,n=this.gl,s=this.program,o=n.createVertexArray();return n.bindVertexArray(o),XEe(n,"vec2",s.aPosition,e),this.transformBuffer=JEe(n,r,s.aTransform),this.indexBuffer=ho(n,r,"vec4",s.aIndex),this.vertTypeBuffer=ho(n,r,"int",s.aVertType),this.atlasIdBuffer=ho(n,r,"int",s.aAtlasId),this.texBuffer=ho(n,r,"vec4",s.aTex),this.pointAPointBBuffer=ho(n,r,"vec4",s.aPointAPointB),this.pointCPointDBuffer=ho(n,r,"vec4",s.aPointCPointD),this.lineWidthBuffer=ho(n,r,"vec2",s.aLineWidth),this.colorBuffer=ho(n,r,"vec4",s.aColor),this.cornerRadiusBuffer=ho(n,r,"vec4",s.aCornerRadius),this.borderColorBuffer=ho(n,r,"vec4",s.aBorderColor),n.bindVertexArray(null),o}},{key:"buffers",get:function(){var e=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(r){return uc(r,"Buffer")}).map(function(r){return e[r]})),this._buffers}},{key:"startFrame",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yg.SCREEN;this.panZoomMatrix=e,this.renderTarget=r,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(e,r){return e.visible()?r&&r.isVisible?r.isVisible(e):!0:!1}},{key:"drawTexture",value:function(e,r,n){var s=this.atlasManager,o=this.batchManager,l=s.getRenderTypeOpts(n);if(this._isVisible(e,l)&&!(e.isEdge()&&!this._isValidEdge(e))){if(this.renderTarget.picking&&l.getTexPickingMode){var c=l.getTexPickingMode(e);if(c===_w.IGNORE)return;if(c==_w.USE_BB){this.drawPickingRectangle(e,r,n);return}}var u=s.getAtlasInfo(e,n),d=pa(u),h;try{for(d.s();!(h=d.n()).done;){var f=h.value,m=f.atlas,g=f.tex1,y=f.tex2;o.canAddToCurrentBatch(m)||this.endBatch();for(var v=o.getAtlasIndexForBatch(m),E=0,C=[[g,!0],[y,!1]];E<C.length;E++){var _=Ci(C[E],2),x=_[0],P=_[1];if(x.w!=0){var I=this.instanceCount;this.vertTypeBuffer.getView(I)[0]=aD;var M=this.indexBuffer.getView(I);uf(r,M);var O=this.atlasIdBuffer.getView(I);O[0]=v;var R=this.texBuffer.getView(I);R[0]=x.x,R[1]=x.y,R[2]=x.w,R[3]=x.h;var F=this.transformBuffer.getMatrixView(I);this.setTransformMatrix(e,F,l,f,P),this.instanceCount++,P||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch($){d.e($)}finally{d.f()}}}},{key:"setTransformMatrix",value:function(e,r,n,s){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,l=0;if(n.shapeProps&&n.shapeProps.padding&&(l=e.pstyle(n.shapeProps.padding).pfValue),s){var c=s.bb,u=s.tex1,d=s.tex2,h=u.w/(u.w+d.w);o||(h=1-h);var f=this._getAdjustedBB(c,l,o,h);this._applyTransformMatrix(r,f,n,e)}else{var m=n.getBoundingBox(e),g=this._getAdjustedBB(m,l,!0,1);this._applyTransformMatrix(r,g,n,e)}}},{key:"_applyTransformMatrix",value:function(e,r,n,s){var o,l;tV(e);var c=n.getRotation?n.getRotation(s):0;if(c!==0){var u=n.getRotationPoint(s),d=u.x,h=u.y;dw(e,e,[d,h]),rV(e,e,c);var f=n.getRotationOffset(s);o=f.x+(r.xOffset||0),l=f.y+(r.yOffset||0)}else o=r.x1,l=r.y1;dw(e,e,[o,l]),xD(e,e,[r.w,r.h])}},{key:"_getAdjustedBB",value:function(e,r,n,s){var o=e.x1,l=e.y1,c=e.w,u=e.h,d=e.yOffset;r&&(o-=r,l-=r,c+=2*r,u+=2*r);var h=0,f=c*s;return n&&s<1?c=f:!n&&s<1&&(h=c-f,o+=h,c=f),{x1:o,y1:l,w:c,h:u,xOffset:h,yOffset:d}}},{key:"drawPickingRectangle",value:function(e,r,n){var s=this.atlasManager.getRenderTypeOpts(n),o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=df;var l=this.indexBuffer.getView(o);uf(r,l);var c=this.colorBuffer.getView(o);zu([0,0,0],1,c);var u=this.transformBuffer.getMatrixView(o);this.setTransformMatrix(e,u,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(e,r,n){var s=this.simpleShapeOptions.get(n);if(this._isVisible(e,s)){var o=s.shapeProps,l=this._getVertTypeForShape(e,o.shape);if(l===void 0||s.isSimple&&!s.isSimple(e)){this.drawTexture(e,r,n);return}var c=this.instanceCount;if(this.vertTypeBuffer.getView(c)[0]=l,l===ew||l===zg){var u=s.getBoundingBox(e),d=this._getCornerRadius(e,o.radius,u),h=this.cornerRadiusBuffer.getView(c);h[0]=d,h[1]=d,h[2]=d,h[3]=d,l===zg&&(h[0]=0,h[2]=0)}var f=this.indexBuffer.getView(c);uf(r,f);var m=e.pstyle(o.color).value,g=e.pstyle(o.opacity).value,y=this.colorBuffer.getView(c);zu(m,g,y);var v=this.lineWidthBuffer.getView(c);if(v[0]=0,v[1]=0,o.border){var E=e.pstyle("border-width").value;if(E>0){var C=e.pstyle("border-color").value,_=e.pstyle("border-opacity").value,x=this.borderColorBuffer.getView(c);zu(C,_,x);var P=e.pstyle("border-position").value;if(P==="inside")v[0]=0,v[1]=-E;else if(P==="outside")v[0]=E,v[1]=0;else{var I=E/2;v[0]=I,v[1]=-I}}}var M=this.transformBuffer.getMatrixView(c);this.setTransformMatrix(e,M,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(e,r){var n=e.pstyle(r).value;switch(n){case"rectangle":return df;case"ellipse":return Hg;case"roundrectangle":case"round-rectangle":return ew;case"bottom-round-rectangle":return zg;default:return}}},{key:"_getCornerRadius",value:function(e,r,n){var s=n.w,o=n.h;if(e.pstyle(r).value==="auto")return vc(s,o);var l=e.pstyle(r).pfValue,c=s/2,u=o/2;return Math.min(l,u,c)}},{key:"drawEdgeArrow",value:function(e,r,n){if(e.visible()){var s=e._private.rscratch,o,l,c;if(n==="source"?(o=s.arrowStartX,l=s.arrowStartY,c=s.srcArrowAngle):(o=s.arrowEndX,l=s.arrowEndY,c=s.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(l)||l==null||isNaN(c)||c==null)){var u=e.pstyle(n+"-arrow-shape").value;if(u!=="none"){var d=e.pstyle(n+"-arrow-color").value,h=e.pstyle("opacity").value,f=e.pstyle("line-opacity").value,m=h*f,g=e.pstyle("width").pfValue,y=e.pstyle("arrow-scale").value,v=this.r.getArrowWidth(g,y),E=this.instanceCount,C=this.transformBuffer.getMatrixView(E);tV(C),dw(C,C,[o,l]),xD(C,C,[v,v]),rV(C,C,c),this.vertTypeBuffer.getView(E)[0]=sD;var _=this.indexBuffer.getView(E);uf(r,_);var x=this.colorBuffer.getView(E);zu(d,m,x),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(e,r){if(e.visible()){var n=this._getEdgePoints(e);if(n){var s=e.pstyle("opacity").value,o=e.pstyle("line-opacity").value,l=e.pstyle("width").pfValue,c=e.pstyle("line-color").value,u=s*o;if(n.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),n.length==4){var d=this.instanceCount;this.vertTypeBuffer.getView(d)[0]=iV;var h=this.indexBuffer.getView(d);uf(r,h);var f=this.colorBuffer.getView(d);zu(c,u,f);var m=this.lineWidthBuffer.getView(d);m[0]=l;var g=this.pointAPointBBuffer.getView(d);g[0]=n[0],g[1]=n[1],g[2]=n[2],g[3]=n[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var y=0;y<n.length-2;y+=2){var v=this.instanceCount;this.vertTypeBuffer.getView(v)[0]=nV;var E=this.indexBuffer.getView(v);uf(r,E);var C=this.colorBuffer.getView(v);zu(c,u,C);var _=this.lineWidthBuffer.getView(v);_[0]=l;var x=n[y-2],P=n[y-1],I=n[y],M=n[y+1],O=n[y+2],R=n[y+3],F=n[y+4],$=n[y+5];y==0&&(x=2*I-O+.001,P=2*M-R+.001),y==n.length-4&&(F=2*O-I+.001,$=2*R-M+.001);var k=this.pointAPointBBuffer.getView(v);k[0]=x,k[1]=P,k[2]=I,k[3]=M;var N=this.pointCPointDBuffer.getView(v);N[0]=O,N[1]=R,N[2]=F,N[3]=$,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(e){var r=e._private.rscratch;return!(r.badLine||r.allpts==null||isNaN(r.allpts[0]))}},{key:"_getEdgePoints",value:function(e){var r=e._private.rscratch;if(this._isValidEdge(e)){var n=r.allpts;if(n.length==4)return n;var s=this._getNumSegments(e);return this._getCurveSegmentPoints(n,s)}}},{key:"_getNumSegments",value:function(e){var r=15;return Math.min(Math.max(r,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(e,r){if(e.length==4)return e;for(var n=Array((r+1)*2),s=0;s<=r;s++)if(s==0)n[0]=e[0],n[1]=e[1];else if(s==r)n[s*2]=e[e.length-2],n[s*2+1]=e[e.length-1];else{var o=s/r;this._setCurvePoint(e,o,n,s*2)}return n}},{key:"_setCurvePoint",value:function(e,r,n,s){if(e.length<=2)n[s]=e[0],n[s+1]=e[1];else{for(var o=Array(e.length-2),l=0;l<o.length;l+=2){var c=(1-r)*e[l]+r*e[l+2],u=(1-r)*e[l+1]+r*e[l+3];o[l]=c,o[l+1]=u}return this._setCurvePoint(o,r,n,s)}}},{key:"endBatch",value:function(){var e=this.gl,r=this.vao,n=this.vertexCount,s=this.instanceCount;if(s!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;e.useProgram(o),e.bindVertexArray(r);var l=pa(this.buffers),c;try{for(l.s();!(c=l.n()).done;){var u=c.value;u.bufferSubData(s)}}catch(g){l.e(g)}finally{l.f()}for(var d=this.batchManager.getAtlases(),h=0;h<d.length;h++)d[h].bufferIfNeeded(e);for(var f=0;f<d.length;f++)e.activeTexture(e.TEXTURE0+f),e.bindTexture(e.TEXTURE_2D,d[f].texture),e.uniform1i(o.uTextures[f],f);e.uniform1f(o.uZoom,WEe(this.r)),e.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),e.uniform1i(o.uAtlasSize,this.batchManager.getAtlasSize());var m=zu(this.bgColor,1);e.uniform4fv(o.uBGColor,m),e.drawArraysInstanced(e.TRIANGLES,0,n,s),e.bindVertexArray(null),e.bindTexture(e.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:s,atlasCount:d.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var e=this.atlasManager.getDebugInfo(),r=e.reduce(function(o,l){return o+l.atlasCount},0),n=this.batchDebugInfo,s=n.reduce(function(o,l){return o+l.count},0);return{atlasInfo:e,totalAtlases:r,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:n.length,batchInfo:n,totalInstances:s}}}])})(),H5={};H5.initWebgl=function(a,t){var e=this,r=e.data.contexts[e.WEBGL];a.bgColor=hTe(e),a.webglTexSize=Math.min(a.webglTexSize,r.getParameter(r.MAX_TEXTURE_SIZE)),a.webglTexRows=Math.min(a.webglTexRows,54),a.webglTexRowsNodes=Math.min(a.webglTexRowsNodes,54),a.webglBatchSize=Math.min(a.webglBatchSize,16384),a.webglTexPerBatch=Math.min(a.webglTexPerBatch,r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS)),e.webglDebug=a.webglDebug,e.webglDebugShowAtlases=a.webglDebugShowAtlases,e.pickingFrameBuffer=QEe(r),e.pickingFrameBuffer.needsDraw=!0,e.drawing=new dTe(e,r,a);var n=function(h){return function(f){return e.getTextAngle(f,h)}},s=function(h){return function(f){var m=f.pstyle(h);return m&&m.value}},o=function(h){return function(f){return f.pstyle("".concat(h,"-opacity")).value>0}},l=function(h){var f=h.pstyle("text-events").strValue==="yes";return f?_w.USE_BB:_w.IGNORE},c=function(h){var f=h.position(),m=f.x,g=f.y,y=h.outerWidth(),v=h.outerHeight();return{w:y,h:v,x1:m-y/2,y1:g-v/2}};e.drawing.addAtlasCollection("node",{texRows:a.webglTexRowsNodes}),e.drawing.addAtlasCollection("label",{texRows:a.webglTexRows}),e.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:t.getStyleKey,getBoundingBox:t.getElementBox,drawElement:t.drawElement}),e.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:c,isSimple:jEe,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),e.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:c,isVisible:o("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),e.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:c,isVisible:o("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),e.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:l,getKey:oD(t.getLabelKey,null),getBoundingBox:lD(t.getLabelBox,null),drawClipped:!0,drawElement:t.drawLabel,getRotation:n(null),getRotationPoint:t.getLabelRotationPoint,getRotationOffset:t.getLabelRotationOffset,isVisible:s("label")}),e.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:l,getKey:oD(t.getSourceLabelKey,"source"),getBoundingBox:lD(t.getSourceLabelBox,"source"),drawClipped:!0,drawElement:t.drawSourceLabel,getRotation:n("source"),getRotationPoint:t.getSourceLabelRotationPoint,getRotationOffset:t.getSourceLabelRotationOffset,isVisible:s("source-label")}),e.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:l,getKey:oD(t.getTargetLabelKey,"target"),getBoundingBox:lD(t.getTargetLabelBox,"target"),drawClipped:!0,drawElement:t.drawTargetLabel,getRotation:n("target"),getRotationPoint:t.getTargetLabelRotationPoint,getRotationOffset:t.getTargetLabelRotationOffset,isVisible:s("target-label")});var u=cv(function(){console.log("garbage collect flag set"),e.data.gc=!0},1e4);e.onUpdateEleCalcs(function(d,h){var f=!1;h&&h.length>0&&(f|=e.drawing.invalidate(h)),f&&u()}),fTe(e)};oD=function(t,e){return function(r){var n=t(r),s=G5(r,e);return s.length>1?s.map(function(o,l){return"".concat(n,"_").concat(l)}):n}},lD=function(t,e){return function(r,n){var s=t(r);if(typeof n=="string"){var o=n.indexOf("_");if(o>0){var l=Number(n.substring(o+1)),c=G5(r,e),u=s.h/c.length,d=u*l,h=s.y1+d;return{x1:s.x1,w:s.w,y1:h,h:u,yOffset:d}}}return s}};xc={};xc.drawPolygonPath=function(a,t,e,r,n,s){var o=r/2,l=n/2;a.beginPath&&a.beginPath(),a.moveTo(t+o*s[0],e+l*s[1]);for(var c=1;c<s.length/2;c++)a.lineTo(t+o*s[c*2],e+l*s[c*2+1]);a.closePath()};xc.drawRoundPolygonPath=function(a,t,e,r,n,s,o){o.forEach(function(l){return S5(a,l)}),a.closePath()};xc.drawRoundRectanglePath=function(a,t,e,r,n,s){var o=r/2,l=n/2,c=s==="auto"?vc(r,n):Math.min(s,l,o);a.beginPath&&a.beginPath(),a.moveTo(t,e-l),a.arcTo(t+o,e-l,t+o,e,c),a.arcTo(t+o,e+l,t,e+l,c),a.arcTo(t-o,e+l,t-o,e,c),a.arcTo(t-o,e-l,t,e-l,c),a.lineTo(t,e-l),a.closePath()};xc.drawBottomRoundRectanglePath=function(a,t,e,r,n,s){var o=r/2,l=n/2,c=s==="auto"?vc(r,n):s;a.beginPath&&a.beginPath(),a.moveTo(t,e-l),a.lineTo(t+o,e-l),a.lineTo(t+o,e),a.arcTo(t+o,e+l,t,e+l,c),a.arcTo(t-o,e+l,t-o,e,c),a.lineTo(t-o,e-l),a.lineTo(t,e-l),a.closePath()};xc.drawCutRectanglePath=function(a,t,e,r,n,s,o){var l=r/2,c=n/2,u=o==="auto"?zD():o;a.beginPath&&a.beginPath(),a.moveTo(t-l+u,e-c),a.lineTo(t+l-u,e-c),a.lineTo(t+l,e-c+u),a.lineTo(t+l,e+c-u),a.lineTo(t+l-u,e+c),a.lineTo(t-l+u,e+c),a.lineTo(t-l,e+c-u),a.lineTo(t-l,e-c+u),a.closePath()};xc.drawBarrelPath=function(a,t,e,r,n){var s=r/2,o=n/2,l=t-s,c=t+s,u=e-o,d=e+o,h=hD(r,n),f=h.widthOffset,m=h.heightOffset,g=h.ctrlPtOffsetPct*f;a.beginPath&&a.beginPath(),a.moveTo(l,u+m),a.lineTo(l,d-m),a.quadraticCurveTo(l+g,d,l+f,d),a.lineTo(c-f,d),a.quadraticCurveTo(c-g,d,c,d-m),a.lineTo(c,u+m),a.quadraticCurveTo(c-g,u,c-f,u),a.lineTo(l+f,u),a.quadraticCurveTo(l+g,u,l,u+m),a.closePath()};aV=Math.sin(0),sV=Math.cos(0),kD={},DD={},U5=Math.PI/40;for(Hu=0*Math.PI;Hu<2*Math.PI;Hu+=U5)kD[Hu]=Math.sin(Hu),DD[Hu]=Math.cos(Hu);xc.drawEllipsePath=function(a,t,e,r,n){if(a.beginPath&&a.beginPath(),a.ellipse)a.ellipse(t,e,r/2,n/2,0,0,2*Math.PI);else for(var s,o,l=r/2,c=n/2,u=0*Math.PI;u<2*Math.PI;u+=U5)s=t-l*kD[u]*aV+l*DD[u]*sV,o=e+c*DD[u]*aV+c*kD[u]*sV,u===0?a.moveTo(s,o):a.lineTo(s,o);a.closePath()};mv={};mv.createBuffer=function(a,t){var e=document.createElement("canvas");return e.width=a,e.height=t,[e,e.getContext("2d")]};mv.bufferCanvasImage=function(a){var t=this.cy,e=t.mutableElements(),r=e.boundingBox(),n=this.findContainerClientCoords(),s=a.full?Math.ceil(r.w):n[2],o=a.full?Math.ceil(r.h):n[3],l=We(a.maxWidth)||We(a.maxHeight),c=this.getPixelRatio(),u=1;if(a.scale!==void 0)s*=a.scale,o*=a.scale,u=a.scale;else if(l){var d=1/0,h=1/0;We(a.maxWidth)&&(d=u*a.maxWidth/s),We(a.maxHeight)&&(h=u*a.maxHeight/o),u=Math.min(d,h),s*=u,o*=u}l||(s*=c,o*=c,u*=c);var f=document.createElement("canvas");f.width=s,f.height=o,f.style.width=s+"px",f.style.height=o+"px";var m=f.getContext("2d");if(s>0&&o>0){m.clearRect(0,0,s,o),m.globalCompositeOperation="source-over";var g=this.getCachedZSortedEles();if(a.full)m.translate(-r.x1*u,-r.y1*u),m.scale(u,u),this.drawElements(m,g),m.scale(1/u,1/u),m.translate(r.x1*u,r.y1*u);else{var y=t.pan(),v={x:y.x*u,y:y.y*u};u*=t.zoom(),m.translate(v.x,v.y),m.scale(u,u),this.drawElements(m,g),m.scale(1/u,1/u),m.translate(-v.x,-v.y)}a.bg&&(m.globalCompositeOperation="destination-over",m.fillStyle=a.bg,m.rect(0,0,s,o),m.fill())}return f};mv.png=function(a){return j5(a,this.bufferCanvasImage(a),"image/png")};mv.jpg=function(a){return j5(a,this.bufferCanvasImage(a),"image/jpeg")};Y5={};Y5.nodeShapeImpl=function(a,t,e,r,n,s,o,l){switch(a){case"ellipse":return this.drawEllipsePath(t,e,r,n,s);case"polygon":return this.drawPolygonPath(t,e,r,n,s,o);case"round-polygon":return this.drawRoundPolygonPath(t,e,r,n,s,o,l);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,e,r,n,s,l);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,e,r,n,s,o,l);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,e,r,n,s,l);case"barrel":return this.drawBarrelPath(t,e,r,n,s)}};CTe=q5,Rt=q5.prototype;Rt.CANVAS_LAYERS=3;Rt.SELECT_BOX=0;Rt.DRAG=1;Rt.NODE=2;Rt.WEBGL=3;Rt.CANVAS_TYPES=["2d","2d","2d","webgl2"];Rt.BUFFER_COUNT=3;Rt.TEXTURE_BUFFER=0;Rt.MOTIONBLUR_BUFFER_NODE=1;Rt.MOTIONBLUR_BUFFER_DRAG=2;Rt.redrawHint=function(a,t){var e=this;switch(a){case"eles":e.data.canvasNeedsRedraw[Rt.NODE]=t;break;case"drag":e.data.canvasNeedsRedraw[Rt.DRAG]=t;break;case"select":e.data.canvasNeedsRedraw[Rt.SELECT_BOX]=t;break;case"gc":e.data.gc=!0;break}};_Te=typeof Path2D!="undefined";Rt.path2dEnabled=function(a){if(a===void 0)return this.pathsEnabled;this.pathsEnabled=!!a};Rt.usePaths=function(){return _Te&&this.pathsEnabled};Rt.setImgSmoothing=function(a,t){a.imageSmoothingEnabled!=null?a.imageSmoothingEnabled=t:(a.webkitImageSmoothingEnabled=t,a.mozImageSmoothingEnabled=t,a.msImageSmoothingEnabled=t)};Rt.getImgSmoothing=function(a){return a.imageSmoothingEnabled!=null?a.imageSmoothingEnabled:a.webkitImageSmoothingEnabled||a.mozImageSmoothingEnabled||a.msImageSmoothingEnabled};Rt.makeOffscreenCanvas=function(a,t){var e;if((typeof OffscreenCanvas=="undefined"?"undefined":Ai(OffscreenCanvas))!=="undefined")e=new OffscreenCanvas(a,t);else{var r=this.cy.window(),n=r.document;e=n.createElement("canvas"),e.width=a,e.height=t}return e};[R5,vo,al,QD,Qu,Sc,jn,H5,xc,mv,Y5].forEach(function(a){ut(Rt,a)});STe=[{name:"null",impl:T5},{name:"base",impl:I5},{name:"canvas",impl:CTe}],xTe=[{type:"layout",extensions:Xwe},{type:"renderer",extensions:STe}],Z5={},K5={};PD=function(){if(arguments.length===2)return J5.apply(null,arguments);if(arguments.length===3)return X5.apply(null,arguments);if(arguments.length===4)return DTe.apply(null,arguments);if(arguments.length===5)return kTe.apply(null,arguments);qr("Invalid extension access syntax")};rv.prototype.extension=PD;xTe.forEach(function(a){a.extensions.forEach(function(t){X5(a.type,t.name,t.impl)})});Sw=function(){if(!(this instanceof Sw))return new Sw;this.length=0},Xu=Sw.prototype;Xu.instanceString=function(){return"stylesheet"};Xu.selector=function(a){var t=this.length++;return this[t]={selector:a,properties:[]},this};Xu.css=function(a,t){var e=this.length-1;if(at(a))this[e].properties.push({name:a,value:t});else if(Zt(a))for(var r=a,n=Object.keys(r),s=0;s<n.length;s++){var o=n[s],l=r[o];if(l!=null){var c=Zi.properties[o]||Zi.properties[xw(o)];if(c!=null){var u=c.name,d=l;this[e].properties.push({name:u,value:d})}}}return this};Xu.style=Xu.css;Xu.generateStyle=function(a){var t=new Zi(a);return this.appendToStyle(t)};Xu.appendToStyle=function(a){for(var t=0;t<this.length;t++){var e=this[t],r=e.selector,n=e.properties;a.selector(r);for(var s=0;s<n.length;s++){var o=n[s];a.css(o.name,o.value)}}return a};PTe="3.33.1",Ec=function(t){if(t===void 0&&(t={}),Zt(t))return new rv(t);if(at(t))return PD.apply(PD,arguments)};Ec.use=function(a){var t=Array.prototype.slice.call(arguments,1);return t.unshift(Ec),a.apply(null,t),this};Ec.warnings=function(a){return _V(a)};Ec.version=PTe;Ec.stylesheet=Ec.Stylesheet=Sw});function e3(a,t,e,r){let n=[],s=new Map;return a.forEach(l=>s.set(l.id||l.name,{id:l.id||l.name,label:l.name,type:"character",data:l})),t.forEach(l=>s.set(l.id||l.name,{id:l.id||l.name,label:l.name,type:"location",data:l})),e.forEach(l=>s.set(l.id||l.name,{id:l.id||l.name,label:l.name,type:"event",data:l})),r.forEach(l=>s.set(l.id||l.name,{id:l.id||l.name,label:l.name,type:"item",data:l})),[...a.map(l=>({entity:l,type:"character"})),...t.map(l=>({entity:l,type:"location"})),...e.map(l=>({entity:l,type:"event"})),...r.map(l=>({entity:l,type:"item"}))].forEach(({entity:l,type:c})=>{var d,h,f,m,g;let u=l.id||l.name;if(l.connections&&Array.isArray(l.connections)&&l.connections.forEach(y=>{let v=$s(y.target,s);v&&n.push({source:u,target:v,relationshipType:y.type,label:y.label})}),c==="character"&&l.relationships&&((d=l.relationships)==null||d.forEach(v=>{if(typeof v=="string"){let E=$s(v,s);E&&n.push({source:u,target:E,relationshipType:"neutral",label:void 0})}else{let E=$s(v.target,s);E&&n.push({source:u,target:E,relationshipType:v.type,label:v.label})}})),c==="character"&&l.locations&&((h=l.locations)==null||h.forEach(y=>{let v=$s(y,s);v&&!n.some(E=>E.source===u&&E.target===v)&&n.push({source:u,target:v,relationshipType:"neutral",label:"associated"})})),c==="character"&&l.events&&((f=l.events)==null||f.forEach(y=>{let v=$s(y,s);v&&!n.some(E=>E.source===u&&E.target===v)&&n.push({source:u,target:v,relationshipType:"neutral",label:"involved"})})),c==="event"&&l.characters&&((m=l.characters)==null||m.forEach(y=>{let v=$s(y,s);v&&!n.some(E=>E.source===u&&E.target===v)&&n.push({source:u,target:v,relationshipType:"neutral",label:"involved"})})),c==="event"&&l.location){let y=$s(l.location,s);y&&!n.some(v=>v.source===u&&v.target===y)&&n.push({source:u,target:y,relationshipType:"neutral",label:"occurred at"})}if(c==="item"&&l.currentOwner){let y=$s(l.currentOwner,s);y&&!n.some(v=>v.source===u&&v.target===y)&&n.push({source:u,target:y,relationshipType:"neutral",label:"owned by"})}if(c==="item"&&l.currentLocation){let y=$s(l.currentLocation,s);y&&!n.some(v=>v.source===u&&v.target===y)&&n.push({source:u,target:y,relationshipType:"neutral",label:"located at"})}if(c==="item"&&l.associatedEvents&&((g=l.associatedEvents)==null||g.forEach(y=>{let v=$s(y,s);v&&!n.some(E=>E.source===u&&E.target===v)&&n.push({source:u,target:v,relationshipType:"neutral",label:"featured in"})})),c==="location"&&l.parentLocation){let y=$s(l.parentLocation,s);y&&!n.some(v=>v.source===u&&v.target===y)&&n.push({source:u,target:y,relationshipType:"neutral",label:"within"})}}),n}function t3(a){let t=["family","ally","rival","romantic"],e=[...a];return a.forEach(r=>{t.includes(r.relationshipType)&&(a.some(s=>s.source===r.target&&s.target===r.source)||e.push({source:r.target,target:r.source,relationshipType:r.relationshipType,label:r.label}))}),e}function $s(a,t){if(t.has(a))return a;let e=a.toLowerCase();for(let[r,n]of t.entries())if(n.label.toLowerCase()===e)return r;return null}var r3=_e(()=>{});var n3={};At(n3,{NetworkGraphRenderer:()=>ed});var i3,ed,Ww=_e(()=>{Q5();r3();i3=require("obsidian"),ed=class{constructor(t,e,r=!1){this.cy=null;this.canvasEl=null;this.currentFilters={entityTypes:["character","location","event","item"]};this.infoPanelEl=null;this.pinnedNodes=new Set;this.currentLayout="cose";this.showAllEdgeLabels=!1;this.infoPanelTimeout=null;this.saveViewportTimeout=null;this.legendVisible=!1;this.legendPanelEl=null;this.legendToggleButtonEl=null;this.infoPanelExpanded=!1;this.containerEl=t,this.plugin=e,this.isModal=r}getCSSVariable(t){let r=getComputedStyle(document.body).getPropertyValue(t).trim(),n={"--background-modifier-border":"#3e3e3e","--interactive-accent":"#7952b3","--interactive-accent-hover":"#9a7bcc","--font-interface":"sans-serif"};return t==="--font-interface"&&r&&(r=r.replace(/['"]?\?\?['"]?/g,"").replace(/,\s*,/g,",").replace(/^,\s*/,"").replace(/\s*,\s*$/,"").trim(),(!r||r===",")&&(r=n[t]||"sans-serif")),r&&r.includes("calc(")&&(r=n[t]||"#808080"),r||n[t]||"#808080"}getImageSrc(t){var e;return t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:")||t.startsWith("app://")||t.startsWith("obsidian://")||t.startsWith("//")?(t.startsWith("http")||t.startsWith("//"))&&!((e=this.plugin.settings.allowRemoteImages)!=null?e:!1)?"":t:this.plugin.app.vault.adapter.getResourcePath(t)}async buildGraphData(){let t=await this.plugin.listCharacters(),e=await this.plugin.listLocations(),r=await this.plugin.listEvents(),n=await this.plugin.listPlotItems(),s=this.applyFiltersToEntities(t,e,r,n),o=[...s.characters.map(c=>({id:c.id||c.name,label:c.name,type:"character",data:c,imageUrl:c.profileImagePath?this.getImageSrc(c.profileImagePath):void 0})),...s.locations.map(c=>({id:c.id||c.name,label:c.name,type:"location",data:c,imageUrl:c.profileImagePath?this.getImageSrc(c.profileImagePath):void 0})),...s.events.map(c=>({id:c.id||c.name,label:c.name,type:"event",data:c,imageUrl:c.profileImagePath?this.getImageSrc(c.profileImagePath):void 0})),...s.items.map(c=>({id:c.id||c.name,label:c.name,type:"item",data:c,imageUrl:c.profileImagePath?this.getImageSrc(c.profileImagePath):void 0}))],l=e3(s.characters,s.locations,s.events,s.items);return l=t3(l),{nodes:o,edges:l}}applyFiltersToEntities(t,e,r,n){let s=t,o=e,l=r,c=n;return this.currentFilters.entityTypes!==void 0&&(this.currentFilters.entityTypes.includes("character")||(s=[]),this.currentFilters.entityTypes.includes("location")||(o=[]),this.currentFilters.entityTypes.includes("event")||(l=[]),this.currentFilters.entityTypes.includes("item")||(c=[])),this.currentFilters.groups&&this.currentFilters.groups.length>0&&(s=s.filter(u=>u.groups&&u.groups.some(d=>{var h;return(h=this.currentFilters.groups)==null?void 0:h.includes(d)})),o=o.filter(u=>u.groups&&u.groups.some(d=>{var h;return(h=this.currentFilters.groups)==null?void 0:h.includes(d)})),l=l.filter(u=>u.groups&&u.groups.some(d=>{var h;return(h=this.currentFilters.groups)==null?void 0:h.includes(d)})),c=c.filter(u=>u.groups&&u.groups.some(d=>{var h;return(h=this.currentFilters.groups)==null?void 0:h.includes(d)}))),(this.currentFilters.timelineStart||this.currentFilters.timelineEnd)&&(l=l.filter(u=>{if(!u.dateTime)return!0;let d=new Date(u.dateTime);if(this.currentFilters.timelineStart){let h=new Date(this.currentFilters.timelineStart);if(d<h)return!1}if(this.currentFilters.timelineEnd){let h=new Date(this.currentFilters.timelineEnd);if(d>h)return!1}return!0})),{characters:s,locations:o,events:l,items:c}}async initializeCytoscape(){let t=this.containerEl.createDiv("storyteller-network-loading");t.textContent="Loading graph...",this.canvasEl=this.containerEl.createDiv("storyteller-network-canvas"),this.canvasEl.style.width="100%";let e=window.innerWidth<=768?"400px":"500px",r="calc(90vh - 250px)";this.canvasEl.style.height=r,this.canvasEl.style.minHeight=e,this.canvasEl.style.backgroundColor="var(--background-primary)",this.canvasEl.style.border="1px solid var(--background-modifier-border)",this.canvasEl.style.borderRadius="8px",this.canvasEl.style.position="relative";let{nodes:n,edges:s}=await this.buildGraphData();if(t.remove(),n.length===0){this.renderEmptyState();return}let o=new Map;n.forEach(c=>o.set(c.id,0)),s.forEach(c=>{o.set(c.source,(o.get(c.source)||0)+1),o.set(c.target,(o.get(c.target)||0)+1)});let l=[...n.map(c=>({data:{id:c.id,label:c.label,type:c.type,entityData:c.data,imageUrl:c.imageUrl,degree:o.get(c.id)||0}})),...s.map(c=>({data:{id:`${c.source}-${c.target}`,source:c.source,target:c.target,relationshipType:c.relationshipType,label:c.label}}))];this.cy=Ec({container:this.canvasEl,elements:l,style:this.getCytoscapeStyle(),layout:this.getLayoutOptions("cose"),minZoom:.2,maxZoom:4}),this.cy.one("layoutstop",()=>{if(!this.cy)return;if(!this.restoreViewportState()){let u=this.cy.zoom();u<.7&&this.cy.zoom({level:Math.min(u*1.4,1),renderedPosition:{x:this.cy.width()/2,y:this.cy.height()/2}}),this.saveViewportState()}}),this.createInfoPanel(),this.createLegendPanel(),this.setupEventListeners()}getLayoutOptions(t){let e={animate:!0,animationDuration:500,fit:!0,padding:80};switch(t){case"cose":return{...e,name:"cose",nodeRepulsion:25e3,idealEdgeLength:200,edgeElasticity:100,nestingFactor:5,gravity:30,numIter:1e3,initialTemp:200,coolingFactor:.95,minTemp:1,componentSpacing:150,nodeOverlap:20,nodeDimensionsIncludeLabels:!0};case"circle":return{...e,name:"circle",radius:void 0,spacingFactor:1.5};case"grid":return{...e,name:"grid",rows:void 0,cols:void 0,spacingFactor:1.5};case"concentric":return{...e,name:"concentric",minNodeSpacing:100,concentric:r=>r.data("degree")||0,levelWidth:()=>2};default:return e}}getCytoscapeStyle(){let t=this.getCSSVariable("--background-modifier-border"),e=this.getCSSVariable("--interactive-accent"),r=this.getCSSVariable("--interactive-accent-hover"),n=this.getCSSVariable("--font-interface");return[{selector:"node",style:{label:s=>{let o=s.data("label");return o&&o.length>15?o.substring(0,15)+"...":o},"text-valign":"center","text-halign":"center","font-size":"14px","font-family":n,color:"#ffffff","text-background-color":"rgba(0, 0, 0, 0.75)","text-background-opacity":.85,"text-background-padding":"4px","text-background-shape":"roundrectangle","text-outline-color":"transparent","text-outline-width":0,"background-color":e,"border-width":2,"border-color":t,width:s=>{let o=s.data("degree")||0;return Math.max(40,Math.min(120,40+o*8))},height:s=>{let o=s.data("degree")||0;return Math.max(40,Math.min(120,40+o*8))},"text-wrap":"wrap","text-max-width":"100px"}},{selector:"node[imageUrl]",style:{"background-image":"data(imageUrl)","background-fit":"cover","background-clip":"node","background-color":"#ffffff"}},{selector:'node[type="character"]',style:{shape:"ellipse","background-color":"#CC6677"}},{selector:'node[type="location"]',style:{shape:"round-rectangle","background-color":"#44AA99"}},{selector:'node[type="event"]',style:{shape:"diamond","background-color":"#DDCC77"}},{selector:'node[type="item"]',style:{shape:"hexagon","background-color":"#88CCEE"}},{selector:"node[[degree > 10]]",style:{"border-width":5,"border-color":"#FFD700","z-index":200,"font-size":"16px","font-weight":"bold"}},{selector:"node[[degree > 5]][[degree <= 10]]",style:{"border-width":4,"z-index":150,"font-size":"15px","font-weight":"600"}},{selector:"node[[degree > 2]][[degree <= 5]]",style:{"border-width":3,"z-index":100,opacity:1}},{selector:"node[[degree > 0]][[degree <= 2]]",style:{opacity:.8,"border-width":2,"font-size":"13px"}},{selector:"node[[degree = 0]]",style:{opacity:.5,"border-style":"dashed","border-width":2,"font-size":"12px"}},{selector:"edge",style:{width:2,"line-color":t,"target-arrow-color":t,"target-arrow-shape":"triangle","curve-style":"bezier","arrow-scale":1.2,label:"","font-size":"11px","text-rotation":"autorotate","text-margin-y":-10,color:"#ffffff","text-background-color":"rgba(0, 0, 0, 0.8)","text-background-opacity":.85,"text-background-padding":"3px","text-background-shape":"roundrectangle","text-outline-color":"transparent","text-outline-width":0,"font-family":n}},{selector:'edge[relationshipType="ally"]',style:{"line-color":"#4ade80","target-arrow-color":"#4ade80"}},{selector:'edge[relationshipType="enemy"]',style:{"line-color":"#ef4444","target-arrow-color":"#ef4444"}},{selector:'edge[relationshipType="family"]',style:{"line-color":"#3b82f6","target-arrow-color":"#3b82f6"}},{selector:'edge[relationshipType="rival"]',style:{"line-color":"#f97316","target-arrow-color":"#f97316"}},{selector:'edge[relationshipType="romantic"]',style:{"line-color":"#ec4899","target-arrow-color":"#ec4899"}},{selector:'edge[relationshipType="mentor"]',style:{"line-color":"#a855f7","target-arrow-color":"#a855f7"}},{selector:'edge[relationshipType="acquaintance"]',style:{"line-color":"#94a3b8","target-arrow-color":"#94a3b8"}},{selector:"node:selected",style:{"border-width":4,"border-color":r,"z-index":999}},{selector:"edge:selected",style:{width:4}},{selector:"node.dimmed",style:{opacity:.3}},{selector:"edge.dimmed",style:{opacity:.2}},{selector:"node.highlighted",style:{"border-width":4,"border-color":e,"z-index":999}},{selector:"edge.highlighted",style:{width:3,"z-index":999,"font-size":"11px",label:"data(label)","text-background-color":"rgba(0, 0, 0, 0.85)","text-background-opacity":.95}},{selector:"node.pinned",style:{"border-width":3,"border-style":"double","border-color":r}}]}setupEventListeners(){this.cy&&(this.cy.on("tap","node",t=>{let e=t.target;this.handleNodeClick(e)}),this.cy.on("mouseover","node",t=>{var n,s,o;let e=t.target;(n=this.cy)==null||n.elements().removeClass("highlighted dimmed");let r=e.neighborhood("node");(s=this.cy)==null||s.nodes().forEach(l=>{l.id()===e.id()?l.addClass("highlighted"):r.contains(l)||l.addClass("dimmed")}),(o=this.cy)==null||o.edges().forEach(l=>{l.source().id()===e.id()||l.target().id()===e.id()?l.addClass("highlighted"):l.addClass("dimmed")}),this.infoPanelTimeout&&clearTimeout(this.infoPanelTimeout),this.infoPanelTimeout=setTimeout(()=>{this.updateInfoPanel(e)},50)}),this.cy.on("mouseout","node",t=>{this.infoPanelTimeout&&(clearTimeout(this.infoPanelTimeout),this.infoPanelTimeout=null),this.infoPanelTimeout=setTimeout(()=>{var e;(e=this.cy)==null||e.elements().removeClass("highlighted dimmed"),this.hideInfoPanel()},500)}),this.infoPanelEl&&(this.infoPanelEl.addEventListener("mouseenter",()=>{this.infoPanelTimeout&&(clearTimeout(this.infoPanelTimeout),this.infoPanelTimeout=null)}),this.infoPanelEl.addEventListener("mouseleave",()=>{var t;(t=this.cy)==null||t.elements().removeClass("highlighted dimmed"),this.hideInfoPanel()})),this.cy.on("cxttap","node",t=>{t.preventDefault();let e=t.target;this.toggleNodePin(e)}),this.cy.on("pan zoom",()=>{var t;this.infoPanelTimeout&&(clearTimeout(this.infoPanelTimeout),this.infoPanelTimeout=null),(t=this.cy)==null||t.elements().removeClass("highlighted dimmed"),this.hideInfoPanel(),this.saveViewportState()}))}handleNodeClick(t){let e=t.data("entityData");if(e&&e.filePath){let r=this.plugin.app.vault.getAbstractFileByPath(e.filePath);r instanceof i3.TFile&&this.plugin.app.workspace.getLeaf(!1).openFile(r)}}createInfoPanel(){this.canvasEl&&(this.infoPanelEl=document.createElement("div"),this.infoPanelEl.className="storyteller-network-info-panel",this.infoPanelEl.style.position="absolute",this.isModal?(this.infoPanelEl.style.bottom="60px",this.infoPanelEl.style.maxHeight="calc(100% - 80px)"):(this.infoPanelEl.style.bottom="20px",this.infoPanelEl.style.maxHeight="calc(100% - 40px)"),this.infoPanelEl.style.right="16px",this.infoPanelEl.style.backgroundColor="var(--background-secondary)",this.infoPanelEl.style.border="2px solid var(--background-modifier-border)",this.infoPanelEl.style.borderRadius="12px",this.infoPanelEl.style.padding="0",this.infoPanelEl.style.pointerEvents="auto",this.infoPanelEl.style.zIndex="1000",this.infoPanelEl.style.minWidth="140px",this.infoPanelEl.style.maxWidth="140px",this.infoPanelEl.style.overflowY="auto",this.infoPanelEl.style.boxShadow="0 4px 16px rgba(0,0,0,0.4)",this.infoPanelEl.style.cursor="pointer",this.infoPanelEl.style.opacity="0",this.infoPanelEl.style.transform="translateY(10px)",this.infoPanelEl.style.transition="opacity 0.3s ease, transform 0.3s ease, max-width 0.3s ease",this.infoPanelEl.innerHTML=`
            <div style="text-align: center; padding: 12px 8px; color: var(--text-muted);">
                <div style="font-size: 18px; opacity: 0.5;">\u{1F3AF}</div>
                <div style="font-size: 9px; margin-top: 4px;">Hover node</div>
            </div>
        `,this.canvasEl.appendChild(this.infoPanelEl))}updateInfoPanel(t){if(!this.infoPanelEl)return;let e=t.data("entityData"),r=t.data("type"),n=t.data("label"),s=t.degree(!1),o="Minor",l="var(--text-muted)",c="\u25CB";s>10?(o="Hub",l="#FFD700",c="\u2605\u2605\u2605"):s>5?(o="Major",l="var(--text-success)",c="\u2605\u2605"):s>2&&(o="Moderate",l="var(--text-accent)",c="\u2605");let d={character:"\u{1F464}",location:"\u{1F4CD}",event:"\u26A1",item:"\u{1F381}"}[r]||"\u25CF",h="";if(!this.infoPanelExpanded){h=`
                <div style="padding: 8px; text-align: center; position: relative;">
                    <div style="font-size: 24px; margin-bottom: 4px;">${d}</div>
                    <div style="font-size: 9px; font-weight: 600; color: var(--text-normal); margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${n}</div>
                    <div style="font-size: 8px; color: ${l}; margin-bottom: 4px;">${c}</div>
                    <div style="font-size: 11px; font-weight: 700; color: ${l};">${s}</div>
                    <button style="position: absolute; top: 4px; right: 4px; background: transparent; border: none; cursor: pointer; color: var(--text-muted); font-size: 12px; padding: 2px; line-height: 1;" title="Expand">\u2922</button>
                </div>
            `,this.infoPanelEl.innerHTML=h,this.infoPanelEl.style.maxWidth="140px";let y=this.infoPanelEl.querySelector("button");y&&y.addEventListener("click",v=>{v.stopPropagation(),this.infoPanelExpanded=!0,this.updateInfoPanel(t)}),this.infoPanelEl.style.opacity="1",this.infoPanelEl.style.transform="translateY(0)";return}this.infoPanelEl.style.maxWidth="280px",h=`
            <div style="background: linear-gradient(135deg, var(--background-secondary-alt) 0%, var(--background-secondary) 100%); padding: 8px 12px; border-radius: 12px 12px 0 0; border-bottom: 2px solid var(--background-modifier-border); position: relative;">
                <button style="position: absolute; top: 8px; right: 8px; background: transparent; border: none; cursor: pointer; color: var(--text-muted); font-size: 14px; padding: 2px; line-height: 1;" title="Collapse">\u2921</button>
                <div style="display: flex; align-items: flex-start; gap: 8px; padding-right: 24px;">
                    <span style="font-size: 20px; line-height: 1;">${d}</span>
                    <div style="flex: 1; min-width: 0;">
                        <div style="font-weight: 700; font-size: 13px; color: var(--text-normal); margin-bottom: 3px; word-wrap: break-word;">${n}</div>
                        <div style="display: flex; align-items: center; gap: 6px; flex-wrap: wrap;">
                            <span style="font-size: 10px; color: var(--text-muted); text-transform: capitalize; padding: 2px 6px; background: var(--background-primary); border-radius: 10px;">${r}</span>
                            <span style="font-size: 10px; font-weight: 600; color: ${l}; padding: 2px 6px; background: rgba(0,0,0,0.2); border-radius: 10px;">${c} ${o}</span>
                        </div>
                    </div>
                </div>
            </div>
        `,h+='<div style="padding: 8px 12px;">';let m=Math.min(s/20*100,100);if(h+=`
            <div style="margin-bottom: 8px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                    <span style="font-size: 11px; font-weight: 600; color: var(--text-normal);">Connections</span>
                    <span style="font-size: 13px; font-weight: 700; color: ${l};">${s}</span>
                </div>
                <div style="height: 4px; background: var(--background-modifier-border); border-radius: 2px; overflow: hidden;">
                    <div style="height: 100%; width: ${m}%; background: linear-gradient(90deg, ${l}, var(--interactive-accent)); transition: width 0.3s ease;"></div>
                </div>
            </div>
        `,s>0){let y=t.neighborhood("node"),v={},E={};y.forEach(P=>{let I=P.data("type");v[I]=(v[I]||0)+1}),t.connectedEdges().forEach(P=>{let I=P.data("relationshipType")||"unknown";E[I]=(E[I]||0)+1}),h+=`
                <div style="margin-bottom: 8px;">
                    <div style="font-size: 11px; font-weight: 600; color: var(--text-normal); margin-bottom: 6px;">Connected To</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 4px;">
            `,[{key:"character",icon:"\u{1F464}",label:"Characters",color:"#CC6677"},{key:"location",icon:"\u{1F4CD}",label:"Locations",color:"#44AA99"},{key:"event",icon:"\u26A1",label:"Events",color:"#DDCC77"},{key:"item",icon:"\u{1F381}",label:"Items",color:"#88CCEE"}].forEach(({key:P,icon:I,label:M,color:O})=>{let R=v[P]||0,F=R>0?1:.3;h+=`
                    <div style="background: var(--background-primary); padding: 6px; border-radius: 4px; border-left: 2px solid ${O}; opacity: ${F};">
                        <div style="font-size: 14px; margin-bottom: 1px;">${I}</div>
                        <div style="font-size: 12px; font-weight: 700; color: var(--text-normal);">${R}</div>
                        <div style="font-size: 9px; color: var(--text-muted);">${M}</div>
                    </div>
                `}),h+="</div></div>";let x=Object.entries(E).sort((P,I)=>I[1]-P[1]).slice(0,3);if(x.length>0){h+=`
                    <div style="margin-bottom: 8px;">
                        <div style="font-size: 11px; font-weight: 600; color: var(--text-normal); margin-bottom: 4px;">Top Relationships</div>
                `;let P={ally:"#4ade80",enemy:"#ef4444",family:"#3b82f6",rival:"#f97316",romantic:"#ec4899",mentor:"#a855f7",acquaintance:"#94a3b8"};x.forEach(([I,M])=>{let O=P[I]||"var(--text-muted)",R=M/s*100;h+=`
                        <div style="margin-bottom: 3px;">
                            <div style="display: flex; justify-content: space-between; font-size: 10px; margin-bottom: 2px;">
                                <span style="color: var(--text-muted); text-transform: capitalize;">${I}</span>
                                <span style="font-weight: 600; color: ${O};">${M}</span>
                            </div>
                            <div style="height: 3px; background: var(--background-modifier-border); border-radius: 2px; overflow: hidden;">
                                <div style="height: 100%; width: ${R}%; background: ${O};"></div>
                            </div>
                        </div>
                    `}),h+="</div>"}}if(e!=null&&e.description){let y=e.description.substring(0,100);h+=`
                <div style="font-size: 10px; line-height: 1.4; color: var(--text-muted); margin-top: 6px; padding-top: 6px; border-top: 1px solid var(--background-modifier-border);">
                    ${y}${e.description.length>100?"...":""}
                </div>
            `}h+="</div>",h+=`
            <div style="background: var(--background-primary); padding: 6px 12px; border-radius: 0 0 12px 12px; border-top: 1px solid var(--background-modifier-border);">
                <div style="display: flex; align-items: center; justify-content: center; gap: 12px; font-size: 9px; color: var(--text-muted);">
                    <div style="display: flex; align-items: center; gap: 3px;">
                        <span style="font-weight: 600; color: var(--text-accent);">Click</span>
                        <span>to open</span>
                    </div>
                    <span style="color: var(--background-modifier-border);">\u2022</span>
                    <div style="display: flex; align-items: center; gap: 3px;">
                        <span style="font-weight: 600; color: var(--text-accent);">Right-click</span>
                        <span>to pin</span>
                    </div>
                </div>
            </div>
        `,this.infoPanelEl.innerHTML=h;let g=this.infoPanelEl.querySelector("button");g&&g.addEventListener("click",y=>{y.stopPropagation(),this.infoPanelExpanded=!1,this.updateInfoPanel(t)}),this.infoPanelEl.style.opacity="1",this.infoPanelEl.style.transform="translateY(0)"}hideInfoPanel(){this.infoPanelEl&&(this.infoPanelExpanded=!1,this.infoPanelEl.style.opacity="0",this.infoPanelEl.style.transform="translateY(10px)")}toggleNodePin(t){let e=t.id();this.pinnedNodes.has(e)?(this.pinnedNodes.delete(e),t.removeClass("pinned"),t.unlock()):(this.pinnedNodes.add(e),t.addClass("pinned"),t.lock())}createLegendPanel(){if(!this.canvasEl)return;let t=document.createElement("div");t.className="storyteller-network-legend-panel",t.style.position="absolute",t.style.top="16px",t.style.left="16px",t.style.backgroundColor="var(--background-secondary)",t.style.border="2px solid var(--background-modifier-border)",t.style.borderRadius="12px",t.style.padding="0",t.style.zIndex="999",t.style.minWidth="200px",t.style.maxWidth="280px",t.style.boxShadow="0 8px 24px rgba(0,0,0,0.3)",t.style.maxHeight="calc(100% - 32px)",t.style.overflowY="auto",t.style.opacity="0",t.style.transform="translateX(-100%)",t.style.pointerEvents="none",t.style.display="none";let e=`
            <div style="background: linear-gradient(135deg, var(--background-secondary-alt) 0%, var(--background-secondary) 100%); padding: 12px 16px; border-bottom: 2px solid var(--background-modifier-border); position: sticky; top: 0; z-index: 1; display: flex; justify-content: space-between; align-items: center;">
                <div style="font-weight: 700; font-size: 14px; color: var(--text-normal);">\u{1F5FA}\uFE0F Graph Legend</div>
                <button class="legend-toggle-btn" style="background: transparent; border: none; cursor: pointer; padding: 4px; display: flex; align-items: center; color: var(--text-muted); font-size: 16px;" title="Hide legend">\u2715</button>
            </div>
            
            <div style="padding: 12px 16px;">
                <!-- Node Types -->
                <div style="margin-bottom: 16px;">
                    <div style="font-size: 12px; font-weight: 600; color: var(--text-normal); margin-bottom: 8px;">Node Types</div>
                    <div style="display: flex; flex-direction: column; gap: 6px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; border-radius: 50%; background: #CC6677; border: 2px solid var(--background-modifier-border);"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">\u{1F464} Characters</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; border-radius: 4px; background: #44AA99; border: 2px solid var(--background-modifier-border);"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">\u{1F4CD} Locations</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #DDCC77; border: 2px solid var(--background-modifier-border); transform: rotate(45deg);"></div>
                            <span style="font-size: 11px; color: var(--text-muted); margin-left: 4px;">\u26A1 Events</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #88CCEE; border: 2px solid var(--background-modifier-border); clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">\u{1F381} Items</span>
                        </div>
                    </div>
                </div>
                
                <!-- Importance Hierarchy -->
                <div style="margin-bottom: 16px;">
                    <div style="font-size: 12px; font-weight: 600; color: var(--text-normal); margin-bottom: 8px;">Importance Level</div>
                    <div style="display: flex; flex-direction: column; gap: 6px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 14px; color: #FFD700;">\u2605\u2605\u2605</span>
                            <span style="font-size: 11px; color: var(--text-muted);">Hub (10+ connections)</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 14px; color: var(--text-success);">\u2605\u2605</span>
                            <span style="font-size: 11px; color: var(--text-muted);">Major (6-10 connections)</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 14px; color: var(--text-accent);">\u2605</span>
                            <span style="font-size: 11px; color: var(--text-muted);">Moderate (3-5 connections)</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 14px; color: var(--text-muted);">\u25CB</span>
                            <span style="font-size: 11px; color: var(--text-muted);">Minor (1-2 connections)</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 14px; color: var(--text-faint);">\u229D</span>
                            <span style="font-size: 11px; color: var(--text-muted);">Isolated (0 connections)</span>
                        </div>
                    </div>
                </div>
                
                <!-- Relationship Types -->
                <div style="margin-bottom: 16px;">
                    <div style="font-size: 12px; font-weight: 600; color: var(--text-normal); margin-bottom: 8px;">Relationships</div>
                    <div style="display: flex; flex-direction: column; gap: 6px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 3px; background: #4ade80; border-radius: 2px;"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">Ally</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 3px; background: #ef4444; border-radius: 2px;"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">Enemy</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 3px; background: #3b82f6; border-radius: 2px;"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">Family</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 3px; background: #ec4899; border-radius: 2px;"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">Romantic</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 3px; background: #a855f7; border-radius: 2px;"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">Mentor</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 3px; background: #f97316; border-radius: 2px;"></div>
                            <span style="font-size: 11px; color: var(--text-muted);">Rival</span>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Tips -->
                <div style="background: var(--background-primary); padding: 10px; border-radius: 8px; border: 1px solid var(--background-modifier-border);">
                    <div style="font-size: 11px; font-weight: 600; color: var(--text-normal); margin-bottom: 6px;">\u{1F4A1} Quick Tips</div>
                    <div style="font-size: 10px; color: var(--text-muted); line-height: 1.6;">
                        \u2022 Hover nodes to see details<br>
                        \u2022 Click to open entity<br>
                        \u2022 Right-click to pin nodes<br>
                        \u2022 Scroll to zoom in/out<br>
                        \u2022 Drag background to pan
                    </div>
                </div>
            </div>
        `;t.innerHTML=e,this.canvasEl.appendChild(t),this.legendPanelEl=t,setTimeout(()=>{this.legendPanelEl&&(this.legendPanelEl.style.transition="opacity 0.3s ease, transform 0.3s ease")},0);let r=t.querySelector(".legend-toggle-btn");r&&r.addEventListener("click",()=>{this.toggleLegend()}),this.createLegendToggleButton()}createLegendToggleButton(){if(!this.canvasEl)return;let t=document.createElement("button");t.className="storyteller-legend-toggle-btn",t.title="Show Legend",t.innerHTML="\u{1F5FA}\uFE0F",t.style.position="absolute",t.style.top="16px",t.style.left="16px",t.style.width="40px",t.style.height="40px",t.style.borderRadius="50%",t.style.backgroundColor="var(--background-secondary)",t.style.border="2px solid var(--background-modifier-border)",t.style.cursor="pointer",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.fontSize="18px",t.style.zIndex="998",t.style.boxShadow="0 4px 12px rgba(0,0,0,0.2)",t.style.opacity="1",t.style.pointerEvents="auto",t.style.transition="opacity 0.3s ease, transform 0.2s ease",t.addEventListener("mouseenter",()=>{this.legendVisible||(t.style.transform="scale(1.1)")}),t.addEventListener("mouseleave",()=>{t.style.transform="scale(1)"}),t.addEventListener("click",()=>{this.toggleLegend()}),this.canvasEl.appendChild(t),this.legendToggleButtonEl=t}toggleLegend(){this.legendVisible=!this.legendVisible,this.legendPanelEl&&(this.legendVisible?(this.legendPanelEl.style.display="block",this.legendPanelEl.offsetHeight,this.legendPanelEl.style.opacity="1",this.legendPanelEl.style.transform="translateX(0)",this.legendPanelEl.style.pointerEvents="auto"):(this.legendPanelEl.style.opacity="0",this.legendPanelEl.style.transform="translateX(-100%)",this.legendPanelEl.style.pointerEvents="none",setTimeout(()=>{this.legendPanelEl&&!this.legendVisible&&(this.legendPanelEl.style.display="none")},300))),this.legendToggleButtonEl&&(this.legendVisible?(this.legendToggleButtonEl.style.opacity="0",this.legendToggleButtonEl.style.pointerEvents="none"):(this.legendToggleButtonEl.style.opacity="1",this.legendToggleButtonEl.style.pointerEvents="auto"))}showLegend(){this.legendVisible||this.toggleLegend()}hideLegend(){this.legendVisible&&this.toggleLegend()}renderEmptyState(){if(!this.canvasEl)return;let t=this.canvasEl.createDiv("storyteller-network-empty-state");t.innerHTML=`
            <div style="text-align: center; padding: 3rem;">
                <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;">\u{1F4CA}</div>
                <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem;">No entities to display</div>
                <div style="margin-bottom: 1rem;">Create characters, locations, events, or items to see them in the network graph.</div>
                <div style="font-size: 0.9rem; color: var(--text-faint);">
                    Add relationships between entities to see connections visualized here.
                </div>
            </div>
        `}searchAndHighlight(t){if(!this.cy||(this.cy.elements().removeClass("highlighted dimmed"),!t))return;let e=t.toLowerCase(),r=!1;if(this.cy.nodes().forEach(n=>{n.data("label").toLowerCase().includes(e)?(n.addClass("highlighted"),r=!0):n.addClass("dimmed")}),this.cy.edges().forEach(n=>{let s=n.source(),o=n.target();s.hasClass("highlighted")&&o.hasClass("highlighted")?n.addClass("highlighted"):n.addClass("dimmed")}),r){let n=this.cy.nodes(".highlighted");this.cy.fit(n,50)}}clearSearch(){this.cy&&this.cy.elements().removeClass("highlighted dimmed")}toggleEdgeLabels(){this.cy&&(this.showAllEdgeLabels=!this.showAllEdgeLabels,this.showAllEdgeLabels?this.cy.style().selector("edge").style({label:"data(label)"}).update():this.cy.style().selector("edge").style({label:""}).update())}zoomIn(){if(!this.cy)return;let t=this.cy.zoom();this.cy.zoom({level:t*1.2,renderedPosition:{x:this.cy.width()/2,y:this.cy.height()/2}}),this.saveViewportState()}zoomOut(){if(!this.cy)return;let t=this.cy.zoom();this.cy.zoom({level:t*.8,renderedPosition:{x:this.cy.width()/2,y:this.cy.height()/2}}),this.saveViewportState()}fitToView(){this.cy&&(this.cy.fit(void 0,80),this.saveViewportState())}resize(){this.cy&&this.cy.resize()}saveViewportState(){this.cy&&(this.saveViewportTimeout&&clearTimeout(this.saveViewportTimeout),this.saveViewportTimeout=setTimeout(()=>{if(!this.cy)return;let t=this.cy.zoom(),e=this.cy.pan();this.plugin.settings.networkGraphZoom=t,this.plugin.settings.networkGraphPan={x:e.x,y:e.y},this.plugin.saveSettings()},500))}restoreViewportState(){if(!this.cy)return!1;let t=this.plugin.settings.networkGraphZoom,e=this.plugin.settings.networkGraphPan;return t!==void 0&&e!==void 0?(this.cy.zoom(t),this.cy.pan(e),!0):!1}changeLayout(t){if(!this.cy)return;this.currentLayout=t,this.cy.layout(this.getLayoutOptions(t)).run()}async applyFilters(t){this.currentFilters=t,await this.refresh()}async refresh(){if(!this.cy)return;if(!this.canvasEl||!this.canvasEl.isConnected)throw new Error("Canvas element is not attached to DOM");let t=this.canvasEl.offsetWidth,e=this.canvasEl.offsetHeight;if(t===0||e===0)throw new Error("Canvas element has invalid dimensions (width or height is 0)");this.cy.resize();let{nodes:r,edges:n}=await this.buildGraphData(),s=new Map;r.forEach(c=>s.set(c.id,0)),n.forEach(c=>{s.set(c.source,(s.get(c.source)||0)+1),s.set(c.target,(s.get(c.target)||0)+1)});let o=[...r.map(c=>({data:{id:c.id,label:c.label,type:c.type,entityData:c.data,imageUrl:c.imageUrl,degree:s.get(c.id)||0}})),...n.map(c=>({data:{id:`${c.source}-${c.target}`,source:c.source,target:c.target,relationshipType:c.relationshipType,label:c.label}}))],l=new Map;this.pinnedNodes.forEach(c=>{var d;let u=(d=this.cy)==null?void 0:d.getElementById(c);u&&l.set(c,u.position())}),this.cy.elements().remove(),this.cy.add(o),this.pinnedNodes.forEach(c=>{var d;let u=(d=this.cy)==null?void 0:d.getElementById(c);u&&l.has(c)&&(u.position(l.get(c)),u.addClass("pinned"),u.lock())}),this.cy.layout(this.getLayoutOptions(this.currentLayout)).run()}async exportAsImage(t="png"){if(!this.cy)return;let e=this.cy.png({output:"blob",bg:getComputedStyle(document.body).getPropertyValue("--background-primary")||"#ffffff",full:!0,scale:2}),r=document.createElement("a");r.download=`network-graph-${Date.now()}.${t}`,r.href=URL.createObjectURL(e),r.click(),URL.revokeObjectURL(r.href)}getNodeCount(){var t;return((t=this.cy)==null?void 0:t.nodes().length)||0}getEdgeCount(){var t;return((t=this.cy)==null?void 0:t.edges().length)||0}destroy(){this.infoPanelTimeout&&(clearTimeout(this.infoPanelTimeout),this.infoPanelTimeout=null),this.saveViewportTimeout&&(clearTimeout(this.saveViewportTimeout),this.saveViewportTimeout=null),this.infoPanelEl&&(this.infoPanelEl.remove(),this.infoPanelEl=null),this.legendPanelEl&&(this.legendPanelEl.remove(),this.legendPanelEl=null),this.legendToggleButtonEl&&(this.legendToggleButtonEl.remove(),this.legendToggleButtonEl=null),this.cy&&(this.cy.destroy(),this.cy=null),this.canvasEl&&(this.canvasEl.remove(),this.canvasEl=null),this.pinnedNodes.clear()}}});var Uw={};At(Uw,{ReferenceModal:()=>tP});var cn,tP,jw=_e(()=>{cn=require("obsidian");St();Qa();Nl();oi();es();tP=class extends cn.Modal{constructor(t,e,r,n,s){super(t),this.plugin=e,this.isNew=r==null,this.refData=r?{...r}:{name:"",category:"Misc",tags:[]},this.refData.tags||(this.refData.tags=[]),this.onSubmit=n,this.onDelete=s,this.modalEl.addClass("storyteller-reference-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?w("createReference"):`${w("editReference")} ${this.refData.name}`}),this.isNew&&new cn.Setting(t).setName("Start from Template").setDesc("Optionally start with a pre-configured reference template").addButton(n=>n.setButtonText("Choose Template").setTooltip("Select a reference template").onClick(()=>{new Gr(this.app,this.plugin,async s=>{await this.applyTemplateToReference(s),this.refresh(),new cn.Notice(`Template "${s.name}" applied`)},"reference").open()})),new cn.Setting(t).setName(w("name")).addText(n=>n.setPlaceholder(w("title")).setValue(this.refData.name||"").onChange(s=>this.refData.name=s)),new cn.Setting(t).setName(w("category")||"Category").addText(n=>n.setPlaceholder(w("categoryPh")).setValue(this.refData.category||"").onChange(s=>this.refData.category=s||void 0)),new cn.Setting(t).setName(w("tags")||"Tags").setDesc(w("traitsPlaceholder")).addText(n=>n.setPlaceholder(w("tagsPh")).setValue((this.refData.tags||[]).join(", ")).onChange(s=>{let o=s.split(",").map(l=>l.trim()).filter(Boolean);this.refData.tags=o.length?o:void 0}));let e=null;new cn.Setting(t).setName(w("profileImage")).then(n=>{e=n.descEl.createEl("small",{text:w("currentValue",this.refData.profileImagePath||w("none"))}),n.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(n=>n.setButtonText(w("select")).setTooltip(w("selectFromGallery")).onClick(()=>{new zr(this.app,this.plugin,s=>{this.refData.profileImagePath=s==null?void 0:s.filePath,e&&e.setText(`Current: ${this.refData.profileImagePath||"None"}`)}).open()})).addButton(n=>n.setButtonText(w("upload")).setTooltip(w("uploadImage")).onClick(async()=>{let s=document.createElement("input");s.type="file",s.accept="image/*",s.onchange=async()=>{var l;let o=(l=s.files)==null?void 0:l[0];if(o)try{let c=this.plugin.settings.galleryUploadFolder;await this.plugin.ensureFolder(c);let u=Date.now(),d=o.name.replace(/[^\w\s.-]/g,"").replace(/\s+/g,"_"),h=`${u}_${d}`,f=`${c}/${h}`,m=await o.arrayBuffer();await this.app.vault.createBinary(f,m),this.refData.profileImagePath=f,e&&e.setText(`Current: ${f}`),new cn.Notice(w("imageUploaded",h))}catch(c){console.error("Upload failed",c),new cn.Notice(w("errorUploadingImage"))}},s.click()})).addButton(n=>n.setIcon("cross").setClass("mod-warning").setTooltip(w("clearImage")).onClick(()=>{this.refData.profileImagePath=void 0,e&&e.setText(`${w("current")}: ${w("none")}`)})),new cn.Setting(t).setName(w("content")||"Content").setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setPlaceholder(w("content")).setValue(this.refData.content||"").onChange(s=>this.refData.content=s||void 0),n.inputEl.rows=12}),t.createEl("h3",{text:w("customFields")}),new cn.Setting(t).addButton(n=>n.setButtonText(w("addCustomField")).setIcon("plus").onClick(()=>{let s=new Set([...Vi("reference"),"customFields","filePath","id","sections"]),o=this.refData;o.customFields||(o.customFields={});let l=o.customFields,c=u=>{new Qr(this.app,{title:w("customFieldValueTitle"),label:w("valueForX",u),defaultValue:"",onSubmit:d=>{l[u]=d}}).open()};new Qr(this.app,{title:w("newCustomFieldTitle"),label:w("fieldName"),defaultValue:"",validator:u=>{let d=u.trim();return d?s.has(d)?w("thatNameIsReserved"):Object.keys(l).some(f=>f.toLowerCase()===d.toLowerCase())?w("fieldAlreadyExists"):null:w("fieldNameCannotBeEmpty")},onSubmit:u=>c(u.trim())}).open()}));let r=new cn.Setting(t).setClass("storyteller-modal-buttons");!this.isNew&&this.onDelete&&r.addButton(n=>n.setButtonText(w("delete")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteReference",this.refData.name))&&(await this.onDelete(this.refData),this.close())})),r.controlEl.createDiv({cls:"storyteller-modal-button-spacer"}),r.addButton(n=>n.setButtonText(w("cancel")).onClick(()=>this.close())),r.addButton(n=>n.setButtonText(this.isNew?w("createReferenceBtn"):w("saveChanges")).setCta().onClick(async()=>{if(!this.refData.name||!this.refData.name.trim()){new cn.Notice(w("title"));return}this.refData.content=this.refData.content||"",await this.onSubmit(this.refData),this.close()}))}async applyTemplateToReference(t){if(!t.entities.references||t.entities.references.length===0){new cn.Notice("This template does not contain any references");return}let e=t.entities.references[0],{templateId:r,sectionContent:n,customYamlFields:s,id:o,filePath:l,...c}=e;if(Object.assign(this.refData,c),s&&Object.assign(this.refData,s),n)for(let[u,d]of Object.entries(n)){let h=u.toLowerCase().replace(/\s+/g,"");this.refData[h]=d}}refresh(){this.onOpen()}onClose(){this.contentEl.empty()}}});var Yw,sl,qw=_e(()=>{Yw=require("obsidian");St();sl=class extends Yw.FuzzySuggestModal{constructor(e,r,n){super(e);this.groups=[];this.plugin=r,this.onChoose=n,this.setPlaceholder(w("selectGroupPh"))}onOpen(){super.onOpen();try{this.groups=this.plugin.getGroups()}catch(e){this.groups=[]}setTimeout(()=>{var e,r,n;try{(e=this.setQuery)==null||e.call(this,"")}catch(s){}try{(r=this.inputEl)==null||r.dispatchEvent(new window.Event("input"))}catch(s){}try{(n=this.onInputChanged)==null||n.call(this)}catch(s){}},0)}getItems(){return this.groups}getItemText(e){return e.name||"Unnamed group"}getSuggestions(e){let r=this.getItems();if(!e)return r.map(s=>({item:s,match:{score:0,matches:[]}}));let n=(0,Yw.prepareFuzzySearch)(e);return r.map(s=>{let o=n(this.getItemText(s));return o?{item:s,match:o}:null}).filter(s=>!!s)}onChooseItem(e,r){this.onChoose(e)}}});var Zw={};At(Zw,{ChapterModal:()=>rP});var Zr,rP,Kw=_e(()=>{Zr=require("obsidian");St();ru();Bl();iu();Qa();qw();Nl();oi();es();rP=class extends Zr.Modal{constructor(t,e,r,n,s){super(t),this.plugin=e,this.isNew=r==null,this.chapter=r?{...r}:{name:"",tags:[],linkedCharacters:[],linkedLocations:[],linkedEvents:[],linkedItems:[],linkedGroups:[]},this.onSubmit=n,this.onDelete=s,this.modalEl.addClass("storyteller-chapter-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?w("createNewChapter"):`${w("editChapter")} ${this.chapter.name}`}),this.isNew&&new Zr.Setting(t).setName("Start from Template").setDesc("Optionally start with a pre-configured chapter template").addButton(g=>g.setButtonText("Choose Template").setTooltip("Select a chapter template").onClick(()=>{new Gr(this.app,this.plugin,async y=>{await this.applyTemplateToChapter(y),this.refresh(),new Zr.Notice(`Template "${y.name}" applied`)},"chapter").open()})),new Zr.Setting(t).setName(w("name")).addText(g=>g.setPlaceholder(w("chapterTitlePh")).setValue(this.chapter.name||"").onChange(y=>this.chapter.name=y)),new Zr.Setting(t).setName(w("number")||"Number").setDesc(w("orderingNumber")||"Ordering number (optional)").addText(g=>g.setPlaceholder(w("numberEg")).setValue(this.chapter.number!=null?String(this.chapter.number):"").onChange(y=>{let v=parseInt(y,10);this.chapter.number=Number.isFinite(v)?v:void 0})),new Zr.Setting(t).setName(w("tags")||"Tags").addText(g=>g.setPlaceholder(w("tagsPh")).setValue((this.chapter.tags||[]).join(", ")).onChange(y=>{let v=y.split(",").map(E=>E.trim()).filter(Boolean);this.chapter.tags=v.length?v:void 0}));let e=null;new Zr.Setting(t).setName(w("profileImage")).then(g=>{e=g.descEl.createEl("small",{text:w("currentValue",this.chapter.profileImagePath||w("none"))}),g.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(g=>g.setButtonText(w("select")).setTooltip(w("selectFromGallery")).onClick(()=>{new zr(this.app,this.plugin,y=>{this.chapter.profileImagePath=y==null?void 0:y.filePath,e&&e.setText(`Current: ${this.chapter.profileImagePath||"None"}`)}).open()})).addButton(g=>g.setButtonText(w("upload")).setTooltip(w("uploadImage")).onClick(async()=>{let y=document.createElement("input");y.type="file",y.accept="image/*",y.onchange=async()=>{var E;let v=(E=y.files)==null?void 0:E[0];if(v)try{let C=this.plugin.settings.galleryUploadFolder;await this.plugin.ensureFolder(C);let _=Date.now(),x=v.name.replace(/[^\w\s.-]/g,"").replace(/\s+/g,"_"),P=`${_}_${x}`,I=`${C}/${P}`,M=await v.arrayBuffer();await this.app.vault.createBinary(I,M),this.chapter.profileImagePath=I,e&&e.setText(`Current: ${I}`),new Zr.Notice(w("imageUploaded",P))}catch(C){console.error("Error uploading image:",C),new Zr.Notice(w("errorUploadingImage"))}},y.click()})).addButton(g=>g.setIcon("cross").setClass("mod-warning").setTooltip(w("clearImage")).onClick(()=>{this.chapter.profileImagePath=void 0,e&&e.setText(`${w("current")}: ${w("none")}`)})),new Zr.Setting(t).setName(w("summary")||"Summary").setClass("storyteller-modal-setting-vertical").addTextArea(g=>{g.setPlaceholder(w("briefChapterSummaryPh")).setValue(this.chapter.summary||"").onChange(y=>this.chapter.summary=y||void 0),g.inputEl.rows=10}),t.createEl("h3",{text:w("customFields")}),new Zr.Setting(t).addButton(g=>g.setButtonText(w("addCustomField")).setIcon("plus").onClick(()=>{let y=new Set([...Vi("chapter"),"customFields","filePath","id","sections"]),v=this.chapter.customFields||(this.chapter.customFields={}),E=C=>{new Qr(this.app,{title:w("customFieldValueTitle"),label:w("valueForX",C),defaultValue:"",onSubmit:_=>{v[C]=_}}).open()};new Qr(this.app,{title:w("newCustomFieldTitle"),label:w("fieldName"),defaultValue:"",validator:C=>{let _=C.trim();return _?y.has(_)?w("thatNameIsReserved"):Object.keys(v).some(P=>P.toLowerCase()===_.toLowerCase())?w("fieldAlreadyExists"):null:w("fieldNameCannotBeEmpty")},onSubmit:C=>E(C.trim())}).open()})),t.createEl("h3",{text:w("links")});let r=new Zr.Setting(t).setName(w("characters")),n=r.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(n,this.chapter.linkedCharacters,"characters"),r.addButton(g=>g.setButtonText(w("add")).onClick(()=>{new Fn(this.app,this.plugin,y=>{this.chapter.linkedCharacters||(this.chapter.linkedCharacters=[]),this.chapter.linkedCharacters.includes(y.name)||this.chapter.linkedCharacters.push(y.name),this.renderLinkedEntities(n,this.chapter.linkedCharacters,"characters")}).open()}));let s=new Zr.Setting(t).setName(w("locations")),o=s.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(o,this.chapter.linkedLocations,"locations"),s.addButton(g=>g.setButtonText(w("add")).onClick(()=>{new fn(this.app,this.plugin,y=>{y&&(this.chapter.linkedLocations||(this.chapter.linkedLocations=[]),this.chapter.linkedLocations.includes(y.name)||this.chapter.linkedLocations.push(y.name),this.renderLinkedEntities(o,this.chapter.linkedLocations,"locations"))}).open()}));let l=new Zr.Setting(t).setName(w("events")),c=l.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(c,this.chapter.linkedEvents,"events"),l.addButton(g=>g.setButtonText(w("add")).onClick(()=>{new Rn(this.app,this.plugin,y=>{this.chapter.linkedEvents||(this.chapter.linkedEvents=[]),this.chapter.linkedEvents.includes(y.name)||this.chapter.linkedEvents.push(y.name),this.renderLinkedEntities(c,this.chapter.linkedEvents,"events")}).open()}));let u=new Zr.Setting(t).setName(w("items")),d=u.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(d,this.chapter.linkedItems,"items"),u.addButton(g=>g.setButtonText(w("add")).onClick(async()=>{let{PlotItemSuggestModal:y}=await Promise.resolve().then(()=>(Cm(),BC));new y(this.app,this.plugin,v=>{this.chapter.linkedItems||(this.chapter.linkedItems=[]),this.chapter.linkedItems.includes(v.name)||this.chapter.linkedItems.push(v.name),this.renderLinkedEntities(d,this.chapter.linkedItems,"items")}).open()}));let h=new Zr.Setting(t).setName(w("groups")),f=h.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(f,this.chapter.linkedGroups,"groups"),h.addButton(g=>g.setButtonText(w("add")).onClick(()=>{new sl(this.app,this.plugin,y=>{this.chapter.linkedGroups||(this.chapter.linkedGroups=[]),this.chapter.linkedGroups.includes(y.id)||this.chapter.linkedGroups.push(y.id),this.renderLinkedEntities(f,this.chapter.linkedGroups,"groups")}).open()}));let m=new Zr.Setting(t).setClass("storyteller-modal-buttons");!this.isNew&&this.onDelete&&m.addButton(g=>g.setButtonText(w("delete")).setClass("mod-warning").onClick(async()=>{this.chapter.filePath&&confirm(w("confirmDeleteChapter",this.chapter.name))&&(await this.onDelete(this.chapter),this.close())})),m.controlEl.createDiv({cls:"storyteller-modal-button-spacer"}),m.addButton(g=>g.setButtonText(w("cancel")).onClick(()=>this.close())),m.addButton(g=>g.setButtonText(this.isNew?w("createChapterBtn"):w("saveChanges")).setCta().onClick(async()=>{if(!this.chapter.name||!this.chapter.name.trim()){new Zr.Notice(w("chapterNameRequired"));return}this.chapter.summary=this.chapter.summary||"",await this.onSubmit(this.chapter),this.close()}))}renderLinkedEntities(t,e,r){if(t.empty(),!e||e.length===0){t.createEl("span",{text:w("none"),cls:"storyteller-modal-list-empty"});return}e.forEach((n,s)=>{let o=t.createDiv("storyteller-modal-list-item");o.createSpan({text:n}),new Zr.ButtonComponent(o).setClass("storyteller-modal-list-remove").setTooltip(`Remove ${n}`).setIcon("cross").onClick(()=>{switch(r){case"characters":this.chapter.linkedCharacters&&(this.chapter.linkedCharacters.splice(s,1),this.renderLinkedEntities(t,this.chapter.linkedCharacters,r));break;case"locations":this.chapter.linkedLocations&&(this.chapter.linkedLocations.splice(s,1),this.renderLinkedEntities(t,this.chapter.linkedLocations,r));break;case"events":this.chapter.linkedEvents&&(this.chapter.linkedEvents.splice(s,1),this.renderLinkedEntities(t,this.chapter.linkedEvents,r));break;case"items":this.chapter.linkedItems&&(this.chapter.linkedItems.splice(s,1),this.renderLinkedEntities(t,this.chapter.linkedItems,r));break;case"groups":this.chapter.linkedGroups&&(this.chapter.linkedGroups.splice(s,1),this.renderLinkedEntities(t,this.chapter.linkedGroups,r));break}})})}async applyTemplateToChapter(t){if(!t.entities.chapters||t.entities.chapters.length===0){new Zr.Notice("This template does not contain any chapters");return}let e=t.entities.chapters[0],{templateId:r,sectionContent:n,customYamlFields:s,id:o,filePath:l,...c}=e;if(Object.assign(this.chapter,c),s&&Object.assign(this.chapter,s),n)for(let[u,d]of Object.entries(n)){let h=u.toLowerCase().replace(/\s+/g,"");this.chapter[h]=d}this.chapter.linkedCharacters=[],this.chapter.linkedLocations=[],this.chapter.linkedEvents=[],this.chapter.linkedItems=[],this.chapter.linkedGroups=[]}refresh(){this.onOpen()}onClose(){this.contentEl.empty()}}});var Xw={};At(Xw,{SceneModal:()=>iP});var Fr,iP,Jw=_e(()=>{Fr=require("obsidian");St();ru();Bl();iu();Qa();qw();es();iP=class extends Fr.Modal{constructor(t,e,r,n,s){super(t),this.plugin=e,this.isNew=r==null,this.scene=r?{...r}:{name:"",status:"Draft",tags:[],linkedCharacters:[],linkedLocations:[],linkedEvents:[],linkedItems:[],linkedGroups:[]},this.onSubmit=n,this.onDelete=s,this.modalEl.addClass("storyteller-scene-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?w("createNewScene"):`${w("editScene")} ${this.scene.name}`}),this.isNew&&new Fr.Setting(t).setName("Start from Template").setDesc("Optionally start with a pre-configured scene template").addButton(g=>g.setButtonText("Choose Template").setTooltip("Select a scene template").onClick(()=>{new Gr(this.app,this.plugin,async y=>{await this.applyTemplateToScene(y),this.refresh(),new Fr.Notice(`Template "${y.name}" applied`)},"scene").open()})),new Fr.Setting(t).setName(w("name")).addText(g=>g.setPlaceholder(w("sceneTitlePh")).setValue(this.scene.name||"").onChange(y=>this.scene.name=y)),new Fr.Setting(t).setName(w("chapter")).setDesc(this.scene.chapterName||w("none")).addDropdown(async g=>{g.addOption("","Unassigned");let y=await this.plugin.listChapters();y.forEach(v=>g.addOption(v.id||v.name,v.number!=null?`${v.number}. ${v.name}`:v.name)),g.setValue(this.scene.chapterId||""),g.onChange(v=>{if(!v)this.scene.chapterId=void 0,this.scene.chapterName=void 0;else{let E=y.find(C=>C.id&&C.id===v||!C.id&&C.name===v);this.scene.chapterId=E==null?void 0:E.id,this.scene.chapterName=E==null?void 0:E.name}this.onOpen()})}),new Fr.Setting(t).setName(w("status")).addDropdown(g=>g.addOptions({Draft:"Draft",Outline:"Outline",WIP:"WIP",Revised:"Revised",Final:"Final"}).setValue(this.scene.status||"Draft").onChange(y=>this.scene.status=y)),new Fr.Setting(t).setName(w("priorityInChapter")).addText(g=>g.setPlaceholder(w("priorityEg")).setValue(this.scene.priority!=null?String(this.scene.priority):"").onChange(y=>{let v=parseInt(y,10);this.scene.priority=Number.isFinite(v)?v:void 0})),new Fr.Setting(t).setName(w("tags")||"Tags").addText(g=>g.setPlaceholder(w("tagsPh")).setValue((this.scene.tags||[]).join(", ")).onChange(y=>{let v=y.split(",").map(E=>E.trim()).filter(Boolean);this.scene.tags=v.length?v:void 0}));let e=null;new Fr.Setting(t).setName(w("profileImage")).then(g=>{e=g.descEl.createEl("small",{text:w("currentValue",this.scene.profileImagePath||w("none"))}),g.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(g=>g.setButtonText(w("select")).setTooltip("Select from gallery").onClick(()=>{new zr(this.app,this.plugin,y=>{this.scene.profileImagePath=y==null?void 0:y.filePath,e&&e.setText(`Current: ${this.scene.profileImagePath||"None"}`)}).open()})).addButton(g=>g.setButtonText(w("upload")).setTooltip(w("uploadImage")).onClick(async()=>{let y=document.createElement("input");y.type="file",y.accept="image/*",y.onchange=async()=>{var E;let v=(E=y.files)==null?void 0:E[0];if(v)try{let C=this.plugin.settings.galleryUploadFolder;await this.plugin.ensureFolder(C);let _=Date.now(),x=v.name.replace(/[^\w\s.-]/g,"").replace(/\s+/g,"_"),P=`${_}_${x}`,I=`${C}/${P}`,M=await v.arrayBuffer();await this.app.vault.createBinary(I,M),this.scene.profileImagePath=I,e&&e.setText(`Current: ${I}`),new Fr.Notice(w("imageUploaded",P))}catch(C){console.error("Error uploading image:",C),new Fr.Notice(w("errorUploadingImage"))}},y.click()})).addButton(g=>g.setIcon("cross").setClass("mod-warning").setTooltip("Clear image").onClick(()=>{this.scene.profileImagePath=void 0,e&&e.setText("Current: None")})),new Fr.Setting(t).setName(w("content")||"Content").setClass("storyteller-modal-setting-vertical").addTextArea(g=>{g.setPlaceholder(w("writeScenePh")).setValue(this.scene.content||"").onChange(y=>this.scene.content=y||void 0),g.inputEl.rows=10}),new Fr.Setting(t).setName(w("beatSheetOneLine")).setClass("storyteller-modal-setting-vertical").addTextArea(g=>{let y=(this.scene.beats||[]).join(`
`);g.setPlaceholder(w("beatSheetPh")).setValue(y).onChange(v=>{let E=v.split(`
`).map(C=>C.trim()).filter(Boolean);this.scene.beats=E.length?E:void 0}),g.inputEl.rows=6}),t.createEl("h3",{text:w("links")});let r=new Fr.Setting(t).setName(w("characters")),n=r.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(n,this.scene.linkedCharacters,"characters"),r.addButton(g=>g.setButtonText(w("add")).onClick(()=>{new Fn(this.app,this.plugin,y=>{this.scene.linkedCharacters||(this.scene.linkedCharacters=[]),this.scene.linkedCharacters.includes(y.name)||this.scene.linkedCharacters.push(y.name),this.renderLinkedEntities(n,this.scene.linkedCharacters,"characters")}).open()}));let s=new Fr.Setting(t).setName(w("locations")),o=s.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(o,this.scene.linkedLocations,"locations"),s.addButton(g=>g.setButtonText(w("add")).onClick(()=>{new fn(this.app,this.plugin,y=>{y&&(this.scene.linkedLocations||(this.scene.linkedLocations=[]),this.scene.linkedLocations.includes(y.name)||this.scene.linkedLocations.push(y.name),this.renderLinkedEntities(o,this.scene.linkedLocations,"locations"))}).open()}));let l=new Fr.Setting(t).setName(w("events")),c=l.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(c,this.scene.linkedEvents,"events"),l.addButton(g=>g.setButtonText(w("add")).onClick(()=>{new Rn(this.app,this.plugin,y=>{this.scene.linkedEvents||(this.scene.linkedEvents=[]),this.scene.linkedEvents.includes(y.name)||this.scene.linkedEvents.push(y.name),this.renderLinkedEntities(c,this.scene.linkedEvents,"events")}).open()}));let u=new Fr.Setting(t).setName(w("items")),d=u.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(d,this.scene.linkedItems,"items"),u.addButton(g=>g.setButtonText(w("add")).onClick(async()=>{let{PlotItemSuggestModal:y}=await Promise.resolve().then(()=>(Cm(),BC));new y(this.app,this.plugin,v=>{this.scene.linkedItems||(this.scene.linkedItems=[]),this.scene.linkedItems.includes(v.name)||this.scene.linkedItems.push(v.name),this.renderLinkedEntities(d,this.scene.linkedItems,"items")}).open()}));let h=new Fr.Setting(t).setName(w("groups")),f=h.controlEl.createDiv("storyteller-modal-linked-entities");this.renderLinkedEntities(f,this.scene.linkedGroups,"groups"),h.addButton(g=>g.setButtonText(w("add")).onClick(()=>{new sl(this.app,this.plugin,y=>{this.scene.linkedGroups||(this.scene.linkedGroups=[]),this.scene.linkedGroups.includes(y.id)||this.scene.linkedGroups.push(y.id),this.renderLinkedEntities(f,this.scene.linkedGroups,"groups")}).open()}));let m=new Fr.Setting(t).setClass("storyteller-modal-buttons");!this.isNew&&this.onDelete&&m.addButton(g=>g.setButtonText(w("delete")).setClass("mod-warning").onClick(async()=>{this.scene.filePath&&confirm(w("confirmDeleteScene",this.scene.name))&&(await this.onDelete(this.scene),this.close())})),m.controlEl.createDiv({cls:"storyteller-modal-button-spacer"}),m.addButton(g=>g.setButtonText(w("cancel")).onClick(()=>this.close())),m.addButton(g=>g.setButtonText(this.isNew?w("createSceneBtn"):w("saveChanges")).setCta().onClick(async()=>{if(!this.scene.name||!this.scene.name.trim()){new Fr.Notice(w("sceneNameRequired"));return}this.scene.content=this.scene.content||"",this.scene.beats=this.scene.beats||[],await this.onSubmit(this.scene),this.close()}))}renderLinkedEntities(t,e,r){if(t.empty(),!e||e.length===0){t.createEl("span",{text:w("none"),cls:"storyteller-modal-list-empty"});return}e.forEach((n,s)=>{let o=t.createDiv("storyteller-modal-list-item");o.createSpan({text:n}),new Fr.ButtonComponent(o).setClass("storyteller-modal-list-remove").setTooltip(`Remove ${n}`).setIcon("cross").onClick(()=>{switch(r){case"characters":this.scene.linkedCharacters&&(this.scene.linkedCharacters.splice(s,1),this.renderLinkedEntities(t,this.scene.linkedCharacters,r));break;case"locations":this.scene.linkedLocations&&(this.scene.linkedLocations.splice(s,1),this.renderLinkedEntities(t,this.scene.linkedLocations,r));break;case"events":this.scene.linkedEvents&&(this.scene.linkedEvents.splice(s,1),this.renderLinkedEntities(t,this.scene.linkedEvents,r));break;case"items":this.scene.linkedItems&&(this.scene.linkedItems.splice(s,1),this.renderLinkedEntities(t,this.scene.linkedItems,r));break;case"groups":this.scene.linkedGroups&&(this.scene.linkedGroups.splice(s,1),this.renderLinkedEntities(t,this.scene.linkedGroups,r));break}})})}async applyTemplateToScene(t){if(!t.entities.scenes||t.entities.scenes.length===0){new Fr.Notice("This template does not contain any scenes");return}let e=t.entities.scenes[0],{templateId:r,sectionContent:n,customYamlFields:s,id:o,filePath:l,chapterId:c,chapterName:u,...d}=e;if(Object.assign(this.scene,d),s&&Object.assign(this.scene,s),n)for(let[h,f]of Object.entries(n)){let m=h.toLowerCase().replace(/\s+/g,"");this.scene[m]=f}this.scene.linkedCharacters=[],this.scene.linkedLocations=[],this.scene.linkedEvents=[],this.scene.linkedItems=[],this.scene.linkedGroups=[]}refresh(){this.onOpen()}onClose(){this.contentEl.empty()}}});var a3={};At(a3,{NetworkGraphView:()=>gv,VIEW_TYPE_NETWORK_GRAPH:()=>Qw});var Sn,Qw,gv,nP=_e(()=>{Sn=require("obsidian");St();Ww();Qw="storyteller-network-graph-view",gv=class extends Sn.ItemView{constructor(e,r){super(e);this.graphRenderer=null;this.currentFilters={entityTypes:["character","location","event","item"]};this.toolbarEl=null;this.entityFilterEl=null;this.advancedFiltersEl=null;this.advancedFiltersContent=null;this.graphContainer=null;this.footerEl=null;this.footerStatusEl=null;this.searchInput=null;this.startDateInput=null;this.endDateInput=null;this.advancedFiltersExpanded=!1;this.filterDebounceTimer=0;this.resizeObserver=null;this.plugin=r}getViewType(){return Qw}getDisplayText(){return w("networkGraph")}getIcon(){return"git-fork"}async onOpen(){let e=this.containerEl.children[1];e.empty(),e.addClass("storyteller-network-graph-view"),this.toolbarEl=e.createDiv("storyteller-graph-toolbar"),this.entityFilterEl=e.createDiv("storyteller-graph-entity-filters"),this.advancedFiltersEl=e.createDiv("storyteller-graph-advanced-filters"),this.graphContainer=e.createDiv("storyteller-graph-container"),this.footerEl=e.createDiv("storyteller-graph-footer"),this.buildToolbar(),this.buildEntityFilters(),this.buildAdvancedFilters(),await this.buildGraph(),this.buildFooter(),this.setupResizeObserver()}buildToolbar(){if(!this.toolbarEl)return;this.toolbarEl.empty();let e=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("layout"),title:w("layout")}});(0,Sn.setIcon)(e,"layout-grid"),e.addEventListener("click",()=>this.showLayoutMenu(e));let r=this.toolbarEl.createEl("button",{cls:"storyteller-export-button",text:w("exportGraph"),attr:{"aria-label":w("exportGraph")+" (Ctrl+E)",title:w("exportGraph")+" (Ctrl+E)"}}),n=r.createSpan();(0,Sn.setIcon)(n,"download"),r.addEventListener("click",()=>this.showExportMenu(r));let s=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("refresh"),title:w("refresh")}});(0,Sn.setIcon)(s,"refresh-cw"),s.addEventListener("click",async()=>{var d;await((d=this.graphRenderer)==null?void 0:d.refresh()),this.updateFooterStatus()});let o=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("zoomIn"),title:w("zoomIn")}});(0,Sn.setIcon)(o,"zoom-in"),o.addEventListener("click",()=>{var d;return(d=this.graphRenderer)==null?void 0:d.zoomIn()});let l=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("zoomOut"),title:w("zoomOut")}});(0,Sn.setIcon)(l,"zoom-out"),l.addEventListener("click",()=>{var d;return(d=this.graphRenderer)==null?void 0:d.zoomOut()});let c=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("fitToView")+" (F)",title:w("fitToView")+" (F)"}});(0,Sn.setIcon)(c,"maximize-2"),c.addEventListener("click",()=>{var d;return(d=this.graphRenderer)==null?void 0:d.fitToView()});let u=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":"Keyboard Shortcuts (?)",title:"Keyboard Shortcuts (?)"}});(0,Sn.setIcon)(u,"keyboard"),u.addEventListener("click",()=>this.showKeyboardShortcuts())}buildEntityFilters(){if(!this.entityFilterEl)return;this.entityFilterEl.empty(),[{type:"character",icon:"user",label:w("characters")},{type:"location",icon:"map-pin",label:w("locations")},{type:"event",icon:"calendar",label:w("events")},{type:"item",icon:"package",label:w("items")}].forEach(({type:r,icon:n,label:s})=>{if(!this.entityFilterEl)return;let o=this.entityFilterEl.createEl("button",{cls:"storyteller-entity-filter-btn clickable-icon is-active",attr:{"aria-label":s,"aria-pressed":"true","data-entity-type":r,title:s}});(0,Sn.setIcon)(o,n),o.addEventListener("click",()=>{let l=o.hasClass("is-active");l?o.removeClass("is-active"):o.addClass("is-active"),o.setAttribute("aria-pressed",l?"false":"true"),this.onFilterChange()}),o.tabIndex=0,o.addEventListener("keydown",l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),o.click())})})}buildAdvancedFilters(){if(!this.advancedFiltersEl)return;this.advancedFiltersEl.empty();let e=this.advancedFiltersEl.createDiv("storyteller-advanced-filters-header"),r=e.createEl("span",{cls:"collapse-icon"});(0,Sn.setIcon)(r,"chevron-right"),e.createEl("span",{text:w("filters")}),this.advancedFiltersContent=this.advancedFiltersEl.createDiv("storyteller-advanced-filters-content"),this.advancedFiltersContent.style.display="none";let n=this.advancedFiltersContent.createDiv("storyteller-filter-row");n.createEl("label",{text:w("search")}),this.searchInput=n.createEl("input",{type:"text",placeholder:w("searchEntities"),attr:{"aria-label":w("searchEntities")}}),this.searchInput.addEventListener("input",()=>this.onFilterChange());let s=this.advancedFiltersContent.createDiv("storyteller-filter-row");s.createEl("label",{text:w("filterByTimeline")});let o=s.createDiv("storyteller-date-range");this.startDateInput=o.createEl("input",{type:"date",attr:{"aria-label":w("timelineStart")}}),o.createEl("span",{text:"\u2014",cls:"date-separator"}),this.endDateInput=o.createEl("input",{type:"date",attr:{"aria-label":w("timelineEnd")}}),this.startDateInput.addEventListener("change",()=>this.onFilterChange()),this.endDateInput.addEventListener("change",()=>this.onFilterChange()),e.addEventListener("click",()=>{this.advancedFiltersExpanded=!this.advancedFiltersExpanded,this.advancedFiltersContent&&(this.advancedFiltersContent.style.display=this.advancedFiltersExpanded?"block":"none"),r.empty(),(0,Sn.setIcon)(r,this.advancedFiltersExpanded?"chevron-down":"chevron-right"),e.setAttribute("aria-expanded",this.advancedFiltersExpanded?"true":"false")}),e.setAttribute("aria-expanded","false"),e.setAttribute("role","button"),e.tabIndex=0,e.addEventListener("keydown",l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),e.click())})}async buildGraph(){if(!this.graphContainer)return;this.graphContainer.empty();let e=this.graphContainer.createDiv("storyteller-graph-loader");e.createDiv("storyteller-loader-spinner"),e.createEl("p",{text:w("loadingNodes")});try{await new Promise(r=>setTimeout(r,0)),e.remove(),this.graphRenderer=new ed(this.graphContainer,this.plugin),await this.graphRenderer.initializeCytoscape(),await this.applyCurrentFilters(),this.addZoomIndicator()}catch(r){console.error("Error initializing network graph:",r),e.remove(),this.graphContainer.createEl("p",{text:"Error loading network graph. See console for details.",cls:"storyteller-empty-state"})}}buildFooter(){this.footerEl&&(this.footerEl.empty(),this.footerStatusEl=this.footerEl.createEl("span",{cls:"storyteller-graph-status",attr:{"aria-live":"polite"}}),this.updateFooterStatus())}updateFooterStatus(){var n,s,o,l;if(!this.footerStatusEl||!this.graphRenderer)return;let e=((s=(n=this.graphRenderer).getNodeCount)==null?void 0:s.call(n))||0,r=((l=(o=this.graphRenderer).getEdgeCount)==null?void 0:l.call(o))||0;e===0&&r===0?this.footerStatusEl.setText(w("emptyGraphMessage")):this.footerStatusEl.setText(`${w("showingXNodes",e)} \u2022 ${w("showingXEdges",r)}`)}setupResizeObserver(){this.resizeObserver=new ResizeObserver(()=>{this.onResize()}),this.resizeObserver.observe(this.containerEl)}onResize(){this.graphRenderer&&this.graphRenderer.resize()}getActiveEntityTypes(){if(!this.entityFilterEl)return["character","location","event","item"];let e=this.entityFilterEl.querySelectorAll(".storyteller-entity-filter-btn.is-active"),r=[];return e.forEach(n=>{let s=n.getAttribute("data-entity-type");s&&r.push(s)}),r.length>0?r:["character","location","event","item"]}onFilterChange(){clearTimeout(this.filterDebounceTimer),this.filterDebounceTimer=window.setTimeout(async()=>{await this.applyCurrentFilters(),this.updateFooterStatus()},250)}async applyCurrentFilters(){var o,l,c;let e=this.getActiveEntityTypes(),r=((o=this.searchInput)==null?void 0:o.value.trim())||"",n=((l=this.startDateInput)==null?void 0:l.value)||"",s=((c=this.endDateInput)==null?void 0:c.value)||"";this.currentFilters={entityTypes:e,timelineStart:n||void 0,timelineEnd:s||void 0},this.graphRenderer&&(await this.graphRenderer.applyFilters(this.currentFilters),r?this.graphRenderer.searchAndHighlight(r):this.graphRenderer.clearSearch())}showLayoutMenu(e){let r=new Sn.Menu;[{value:"cose",label:w("forceDirected")},{value:"circle",label:w("circle")},{value:"grid",label:w("grid")},{value:"concentric",label:w("concentric")}].forEach(s=>{r.addItem(o=>{o.setTitle(s.label).setIcon("layout").onClick(()=>{var l;(l=this.graphRenderer)==null||l.changeLayout(s.value)})})}),r.showAtMouseEvent(new MouseEvent("click",{clientX:e.getBoundingClientRect().left,clientY:e.getBoundingClientRect().bottom}))}showExportMenu(e){let r=new Sn.Menu;r.addItem(n=>{n.setTitle(w("exportAsPNG")).setIcon("image").onClick(()=>{var s;(s=this.graphRenderer)==null||s.exportAsImage("png")})}),r.addItem(n=>{n.setTitle(w("exportAsJPG")).setIcon("image").onClick(()=>{var s;(s=this.graphRenderer)==null||s.exportAsImage("jpg")})}),r.showAtMouseEvent(new MouseEvent("click",{clientX:e.getBoundingClientRect().left,clientY:e.getBoundingClientRect().bottom}))}async onClose(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),clearTimeout(this.filterDebounceTimer),this.graphRenderer&&(this.graphRenderer.destroy(),this.graphRenderer=null)}async refresh(){this.graphRenderer&&(await this.graphRenderer.refresh(),this.updateFooterStatus())}addZoomIndicator(){if(!this.graphContainer)return;let e=this.graphContainer.createDiv("storyteller-zoom-indicator");if(e.setText("100%"),this.graphRenderer){let r=this.graphRenderer.cy;r&&r.on("zoom",()=>{let n=r.zoom();e.setText(`${Math.round(n*100)}%`)})}}showKeyboardShortcuts(){let{Modal:e}=require("obsidian");class r extends e{constructor(s){super(s)}onOpen(){let{contentEl:s}=this;s.empty(),s.addClass("storyteller-keyboard-shortcuts-modal"),s.createEl("h2",{text:"Keyboard Shortcuts"});let o=s.createEl("table",{cls:"storyteller-keyboard-shortcuts-table"});[{key:"F",desc:"Fit graph to view"},{key:"Ctrl + E",desc:"Export graph as image"},{key:"+",desc:"Zoom in"},{key:"-",desc:"Zoom out"},{key:"Click + Drag",desc:"Pan the graph"},{key:"Ctrl + F",desc:"Focus on search"},{key:"?",desc:"Show this help"}].forEach(({key:c,desc:u})=>{let d=o.createEl("tr");d.createEl("td",{cls:"storyteller-shortcut-key"}).setText(c),d.createEl("td",{cls:"storyteller-shortcut-desc"}).setText(u)})}onClose(){let{contentEl:s}=this;s.empty()}}new r(this.app).open()}}});var s3={};At(s3,{NetworkGraphModal:()=>aP});var Fi,ol,aP,o3=_e(()=>{Fi=require("obsidian");St();Ww();ea();ol=["character","location","event","item"],aP=class extends hr{constructor(e,r){super(e);this.graphRenderer=null;this.graphContainer=null;this.currentFilters={};this.selectedEntityTypes=new Set(ol);this.filterChipsContainer=null;this.filterClearButton=null;this.filterToggleButton=null;this.filterBadgeEl=null;this.filterDrawer=null;this.filterBackdrop=null;this.filterDrawerVisible=!1;this.lastFocusedElement=null;this.statusBarEl=null;this.liveRegionEl=null;this.searchDebounceTimer=null;this.filterInputs={entityCheckboxes:new Map,timelineStart:null,timelineEnd:null};this.edgeLabelsToggleButton=null;this.edgeLabelsVisible=!1;this.exportButtonEl=null;this.infoToggleButton=null;this.aboutSection=null;this.handleGlobalKeydown=e=>{e.key==="Escape"&&this.filterDrawerVisible&&(e.preventDefault(),this.toggleFilterDrawer(!1))};this.plugin=r}onOpen(){super.onOpen(),window.addEventListener("keydown",this.handleGlobalKeydown,!0),this.selectedEntityTypes=new Set(ol),this.currentFilters={};let{contentEl:e}=this;e.empty(),e.addClass("storyteller-network-graph-modal"),e.addClass("storyteller-graph-modal-content"),this.modalEl.style.width="90vw",this.modalEl.style.maxWidth="1400px",this.modalEl.style.height="85vh",this.modalEl.addClass("storyteller-network-graph-shell"),this.liveRegionEl=e.createDiv(),this.liveRegionEl.setAttribute("role","status"),this.liveRegionEl.setAttribute("aria-live","polite"),this.liveRegionEl.setAttribute("aria-atomic","true"),this.liveRegionEl.style.position="absolute",this.liveRegionEl.style.left="-10000px",this.liveRegionEl.style.width="1px",this.liveRegionEl.style.height="1px",this.liveRegionEl.style.overflow="hidden",this.buildHeader(e),this.createToolbar(e),this.createFilterChipRow(e);let r=e.createDiv("storyteller-graph-stage");this.initializeGraph(r),this.createFilterDrawer(e),this.renderFilterChips(),this.setupKeyboardShortcuts()}onClose(){super.onClose(),window.removeEventListener("keydown",this.handleGlobalKeydown,!0),this.searchDebounceTimer&&(clearTimeout(this.searchDebounceTimer),this.searchDebounceTimer=null),this.graphRenderer&&(this.graphRenderer.destroy(),this.graphRenderer=null)}buildHeader(e){let r=e.createDiv("storyteller-graph-header");r.createEl("h2",{text:w("networkGraph")});let n=r.createDiv("storyteller-graph-header-actions");this.infoToggleButton=new Fi.ButtonComponent(n),this.infoToggleButton.buttonEl.addClass("storyteller-toolbar-button","storyteller-info-toggle"),this.infoToggleButton.buttonEl.setAttribute("type","button"),this.infoToggleButton.setIcon("info").setButtonText(w("about")).setTooltip(w("about")).onClick(()=>this.toggleAboutSection()),this.infoToggleButton.buttonEl.setAttribute("aria-expanded","false"),this.aboutSection=e.createDiv("storyteller-graph-about storyteller-collapsible"),this.aboutSection.setAttribute("aria-hidden","true"),this.aboutSection.createEl("p",{text:"Interactive visualization of relationships between story entities."});let s=this.aboutSection.createEl("ul",{cls:"storyteller-graph-tips"});s.createEl("li",{text:"Drag nodes or hold Shift to explore related clusters."}),s.createEl("li",{text:"Use zoom controls or the mouse wheel to focus on details."}),s.createEl("li",{text:"Apply filters to narrow the dataset before exporting images."})}createToolbar(e){var E,C;let n=e.createDiv("storyteller-graph-toolbar-wrapper").createDiv("storyteller-graph-toolbar"),s=n.createDiv("storyteller-toolbar-group storyteller-toolbar-group--filters");this.filterToggleButton=new Fi.ButtonComponent(s),this.filterToggleButton.buttonEl.classList.add("storyteller-toolbar-button","storyteller-filter-toggle"),this.filterToggleButton.buttonEl.setAttribute("type","button"),this.filterToggleButton.setIcon("filter").setButtonText(w("filters")).setTooltip(w("filters")).onClick(()=>this.toggleFilterDrawer()),this.filterToggleButton.buttonEl.setAttribute("aria-expanded","false"),this.filterBadgeEl=this.filterToggleButton.buttonEl.createSpan({cls:"storyteller-filter-badge",text:"0"}),this.filterBadgeEl.setAttr("aria-hidden","true");let o=n.createDiv("storyteller-toolbar-group storyteller-toolbar-group--explore"),l=o.createEl("input",{type:"search",placeholder:w("searchEntities"),cls:"storyteller-toolbar-search storyteller-network-search-input"});l.setAttr("aria-label",w("searchEntities")),l.addEventListener("input",()=>{this.searchDebounceTimer&&clearTimeout(this.searchDebounceTimer),this.searchDebounceTimer=setTimeout(()=>{var x,P;let _=l.value.trim();_.length>1?((x=this.graphRenderer)==null||x.searchAndHighlight(_),this.announceToScreenReader(`${w("searchEntities")}: ${_}`)):(P=this.graphRenderer)==null||P.clearSearch()},300)});let c=o.createEl("select",{cls:"storyteller-toolbar-select"});c.setAttr("aria-label",w("layout"));let u=[{value:"cose",label:w("forceDirected")},{value:"circle",label:w("circle")},{value:"grid",label:w("grid")},{value:"concentric",label:w("concentric")}];u.forEach(_=>c.createEl("option",{value:_.value,text:_.label})),c.addEventListener("change",()=>{var x,P;let _=c.value;(x=this.graphRenderer)==null||x.changeLayout(_),this.announceToScreenReader(`${w("layoutChanged")}: ${(P=u.find(I=>I.value===_))==null?void 0:P.label}`)});let d=o.createDiv("storyteller-toolbar-segment"),h=new Fi.ButtonComponent(d);h.buttonEl.addClass("storyteller-toolbar-button"),h.buttonEl.setAttribute("type","button"),h.setIcon("zoom-in").setTooltip(w("zoomIn")).onClick(()=>{var _;return(_=this.graphRenderer)==null?void 0:_.zoomIn()}),h.buttonEl.setAttr("aria-label",w("zoomIn"));let f=new Fi.ButtonComponent(d);f.buttonEl.addClass("storyteller-toolbar-button"),f.buttonEl.setAttribute("type","button"),f.setIcon("zoom-out").setTooltip(w("zoomOut")).onClick(()=>{var _;return(_=this.graphRenderer)==null?void 0:_.zoomOut()}),f.buttonEl.setAttr("aria-label",w("zoomOut"));let m=new Fi.ButtonComponent(d);m.buttonEl.addClass("storyteller-toolbar-button"),m.buttonEl.setAttribute("type","button"),m.setIcon("maximize-2").setTooltip(w("fitToView")).onClick(()=>{var _;return(_=this.graphRenderer)==null?void 0:_.fitToView()}),m.buttonEl.setAttr("aria-label",w("fitToView"));let g=n.createDiv("storyteller-toolbar-group storyteller-toolbar-group--display");this.edgeLabelsToggleButton=new Fi.ButtonComponent(g),this.edgeLabelsToggleButton.buttonEl.classList.add("storyteller-toolbar-button"),this.edgeLabelsToggleButton.buttonEl.setAttribute("type","button"),this.edgeLabelsToggleButton.setIcon("tag").setTooltip((E=w("toggleEdgeLabels"))!=null?E:"Toggle edge labels").onClick(()=>this.toggleEdgeLabels()),this.edgeLabelsToggleButton.buttonEl.setAttr("aria-label",(C=w("toggleEdgeLabels"))!=null?C:"Toggle edge labels"),this.edgeLabelsToggleButton.buttonEl.setAttribute("aria-pressed","false");let y=new Fi.ButtonComponent(g);y.buttonEl.classList.add("storyteller-toolbar-button"),y.buttonEl.setAttribute("type","button"),y.setIcon("refresh-cw").setTooltip(w("refresh")).onClick(async()=>{var _;await((_=this.graphRenderer)==null?void 0:_.refresh())}),y.buttonEl.setAttr("aria-label",w("refresh"));let v=new Fi.ButtonComponent(g);v.buttonEl.classList.add("storyteller-toolbar-button","storyteller-export-button"),v.buttonEl.setAttribute("type","button"),v.setIcon("image").setButtonText(w("exportGraph")).setTooltip(w("exportGraph")).onClick(()=>this.showExportMenu()),this.exportButtonEl=v.buttonEl}createFilterChipRow(e){let r=e.createDiv("storyteller-filter-chip-row");this.filterChipsContainer=r.createDiv("storyteller-active-filter-chips"),this.filterClearButton=r.createEl("button",{text:w("clearAllFilters"),cls:"storyteller-filter-clear",attr:{type:"button"}}),this.filterClearButton.addEventListener("click",()=>{this.resetFilters()})}createFilterDrawer(e){this.filterBackdrop=e.createDiv("storyteller-filter-backdrop"),this.filterBackdrop.addEventListener("click",()=>this.toggleFilterDrawer(!1)),this.filterDrawer=e.createDiv("storyteller-graph-filter-drawer"),this.filterDrawer.setAttr("role","dialog"),this.filterDrawer.setAttr("aria-modal","true"),this.filterDrawer.setAttr("aria-hidden","true"),this.filterDrawer.setAttr("tabindex","-1");let r=this.filterDrawer.createDiv("storyteller-filter-drawer-header");r.createEl("h3",{text:w("graphFilters")});let n=new Fi.ButtonComponent(r);n.buttonEl.addClass("storyteller-toolbar-button"),n.buttonEl.setAttribute("type","button"),n.setIcon("x").setTooltip(w("cancel")).onClick(()=>this.toggleFilterDrawer(!1));let s=this.filterDrawer.createDiv("storyteller-filter-presets");s.createEl("button",{text:w("all"),cls:"storyteller-filter-preset",attr:{type:"button"}}).addEventListener("click",()=>{this.applyEntityPreset([...ol])}),s.createEl("button",{text:w("characters"),cls:"storyteller-filter-preset",attr:{type:"button"}}).addEventListener("click",()=>{this.applyEntityPreset(["character"])}),s.createEl("button",{text:`${w("characters")} + ${w("locations")}`,cls:"storyteller-filter-preset",attr:{type:"button"}}).addEventListener("click",()=>{this.applyEntityPreset(["character","location"])});let u=this.filterDrawer.createDiv("storyteller-filter-section");u.createEl("p",{text:w("filterByEntityTypes"),cls:"storyteller-filter-description"});let d=u.createDiv("storyteller-filter-grid");this.filterInputs.entityCheckboxes.clear(),ol.forEach(C=>{let _=C+"s",x=d.createDiv("storyteller-filter-checkbox storyteller-filter-checkbox--drawer"),P=x.createEl("input",{type:"checkbox"});P.checked=!0,P.id=`graph-filter-${C}`,this.filterInputs.entityCheckboxes.set(C,P);let I=x.createEl("label",{text:w(_)});I.htmlFor=P.id,P.addEventListener("change",()=>{P.checked?this.selectedEntityTypes.add(C):this.selectedEntityTypes.delete(C),this.selectedEntityTypes.size===ol.length?delete this.currentFilters.entityTypes:this.currentFilters.entityTypes=Array.from(this.selectedEntityTypes),this.syncFilters()})});let h=this.filterDrawer.createDiv("storyteller-filter-section storyteller-filter-section--timeline");h.createEl("p",{text:w("filterByTimeline"),cls:"storyteller-filter-description"});let f=h.createDiv("storyteller-timeline-filters storyteller-timeline-filters--drawer"),m=f.createDiv("date-input-wrapper");m.createEl("label",{text:w("timelineStart"),cls:"storyteller-filter-label"}),this.filterInputs.timelineStart=m.createEl("input",{type:"date"}),this.filterInputs.timelineStart.addEventListener("change",()=>{var C;this.currentFilters.timelineStart=((C=this.filterInputs.timelineStart)==null?void 0:C.value)||void 0,this.syncFilters()});let g=f.createDiv("date-input-wrapper");g.createEl("label",{text:w("timelineEnd"),cls:"storyteller-filter-label"}),this.filterInputs.timelineEnd=g.createEl("input",{type:"date"}),this.filterInputs.timelineEnd.addEventListener("change",()=>{var C;this.currentFilters.timelineEnd=((C=this.filterInputs.timelineEnd)==null?void 0:C.value)||void 0,this.syncFilters()});let y=this.filterDrawer.createDiv("storyteller-filter-actions storyteller-filter-actions--drawer"),v=new Fi.ButtonComponent(y);v.buttonEl.addClass("storyteller-toolbar-button"),v.buttonEl.setAttribute("type","button"),v.setButtonText(w("resetFilters")).onClick(()=>{this.resetFilters()});let E=new Fi.ButtonComponent(y);E.buttonEl.addClass("storyteller-toolbar-button"),E.buttonEl.setAttribute("type","button"),E.setButtonText(w("cancel")).onClick(()=>this.toggleFilterDrawer(!1)),this.filterDrawer.addEventListener("keydown",C=>{C.key==="Tab"&&this.filterDrawerVisible&&this.maintainFocusTrap(C)})}maintainFocusTrap(e){if(!this.filterDrawerVisible||!this.filterDrawer)return;let r=Array.from(this.filterDrawer.querySelectorAll('button, input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter(o=>!o.hasAttribute("disabled"));if(r.length===0)return;let n=r[0],s=r[r.length-1];e.shiftKey&&document.activeElement===n?(e.preventDefault(),s.focus()):!e.shiftKey&&document.activeElement===s&&(e.preventDefault(),n.focus())}toggleAboutSection(){if(!this.aboutSection||!this.infoToggleButton)return;let e=this.aboutSection.hasClass("is-open");this.aboutSection.toggleClass("is-open",!e),this.aboutSection.setAttr("aria-hidden",e?"true":"false"),this.infoToggleButton.buttonEl.setAttribute("aria-expanded",e?"false":"true")}async initializeGraph(e){this.graphContainer=e.createDiv("storyteller-network-graph-container"),this.graphContainer.style.flex="1",this.graphContainer.style.overflow="visible",this.graphContainer.style.position="relative",this.graphContainer.style.minHeight="420px",this.createStatusBar(this.graphContainer);try{let r=new ed(this.graphContainer,this.plugin,!0);await r.initializeCytoscape(),this.graphRenderer=r,this.updateStatusBar()}catch(r){console.error("Error initializing network graph:",r),this.graphContainer.createEl("p",{text:"Error loading network graph. See console for details.",cls:"storyteller-empty-state"})}}showExportMenu(){if(!this.exportButtonEl)return;let e=new Fi.Menu;e.addItem(n=>{n.setTitle(w("exportAsPNG")).setIcon("image").onClick(async()=>{var s;await((s=this.graphRenderer)==null?void 0:s.exportAsImage("png")),new Fi.Notice(w("graphExported"))})}),e.addItem(n=>{n.setTitle(w("exportAsJPG")).setIcon("image").onClick(async()=>{var s;await((s=this.graphRenderer)==null?void 0:s.exportAsImage("jpg")),new Fi.Notice(w("graphExported"))})});let r=this.exportButtonEl.getBoundingClientRect();e.showAtPosition({x:r.left,y:r.bottom})}toggleFilterDrawer(e){if(!this.filterDrawer||!this.filterBackdrop||!this.filterToggleButton)return;let r=e!==void 0?e:!this.filterDrawerVisible;r!==this.filterDrawerVisible&&(this.filterDrawerVisible=r,this.filterDrawer.toggleClass("is-open",r),this.filterDrawer.setAttr("aria-hidden",r?"false":"true"),this.filterBackdrop.toggleClass("is-visible",r),this.filterToggleButton.buttonEl.setAttribute("aria-expanded",r?"true":"false"),r?(this.lastFocusedElement=document.activeElement,window.requestAnimationFrame(()=>{var s;let n=(s=this.filterDrawer)==null?void 0:s.querySelector("input,button,select");n==null||n.focus()})):this.lastFocusedElement&&this.lastFocusedElement.focus({preventScroll:!0}))}renderFilterChips(){var s,o,l;if(!this.filterChipsContainer||!this.filterBadgeEl||!this.filterClearButton)return;let e=this.filterChipsContainer;e.empty();let r=[],n=this.currentFilters.entityTypes;if(n&&n.length>0&&n.length<ol.length){let c=n.map(u=>w(u+"s"));r.push({label:c.join(", "),ariaLabel:w("filterByEntityTypes"),remove:()=>{this.applyEntityPreset([...ol])}})}if(this.currentFilters.timelineStart&&r.push({label:`${w("timelineStart")}: ${this.currentFilters.timelineStart}`,ariaLabel:w("timelineStart"),remove:()=>{this.filterInputs.timelineStart&&(this.filterInputs.timelineStart.value=""),this.currentFilters.timelineStart=void 0,this.syncFilters()}}),this.currentFilters.timelineEnd&&r.push({label:`${w("timelineEnd")}: ${this.currentFilters.timelineEnd}`,ariaLabel:w("timelineEnd"),remove:()=>{this.filterInputs.timelineEnd&&(this.filterInputs.timelineEnd.value=""),this.currentFilters.timelineEnd=void 0,this.syncFilters()}}),(s=this.currentFilters.groups)!=null&&s.length&&r.push({label:this.currentFilters.groups.join(", "),ariaLabel:w("groups"),remove:()=>{delete this.currentFilters.groups,this.syncFilters()}}),r.length===0){e.createEl("span",{text:`${w("filters")}: ${w("all")}`,cls:"storyteller-filter-chip-placeholder"}),this.filterBadgeEl.textContent="0",(o=this.filterToggleButton)==null||o.buttonEl.toggleClass("has-active-filters",!1),this.filterClearButton.classList.add("is-disabled"),this.filterClearButton.setAttribute("disabled","true");return}r.forEach(c=>{let u=e.createDiv("storyteller-filter-chip");u.createSpan({text:c.label}),u.createEl("button",{text:"\xD7",cls:"storyteller-filter-chip-remove",attr:{type:"button","aria-label":`${c.ariaLabel} - ${w("resetFilters")}`}}).addEventListener("click",()=>c.remove())}),this.filterBadgeEl.textContent=String(r.length),(l=this.filterToggleButton)==null||l.buttonEl.toggleClass("has-active-filters",!0),this.filterClearButton.classList.remove("is-disabled"),this.filterClearButton.removeAttribute("disabled")}async syncFilters(){var r;await((r=this.graphRenderer)==null?void 0:r.applyFilters(this.currentFilters)),this.renderFilterChips(),this.updateStatusBar(),Object.keys(this.currentFilters).length>0&&this.announceToScreenReader(w("filterApplied"))}async applyEntityPreset(e){this.selectedEntityTypes=new Set(e),this.filterInputs.entityCheckboxes.forEach((r,n)=>{r.checked=e.includes(n)}),e.length===ol.length?delete this.currentFilters.entityTypes:this.currentFilters.entityTypes=[...e],await this.syncFilters()}async resetFilters(){this.selectedEntityTypes=new Set(ol),this.filterInputs.entityCheckboxes.forEach(e=>{e.checked=!0}),this.filterInputs.timelineStart&&(this.filterInputs.timelineStart.value=""),this.filterInputs.timelineEnd&&(this.filterInputs.timelineEnd.value=""),this.currentFilters={},await this.syncFilters()}toggleEdgeLabels(){var e;(e=this.graphRenderer)==null||e.toggleEdgeLabels(),this.edgeLabelsVisible=!this.edgeLabelsVisible,this.edgeLabelsToggleButton&&(this.edgeLabelsToggleButton.buttonEl.toggleClass("is-active",this.edgeLabelsVisible),this.edgeLabelsToggleButton.buttonEl.setAttribute("aria-pressed",this.edgeLabelsVisible?"true":"false"))}setupKeyboardShortcuts(){let e=[{key:"f",handler:()=>{var r;return(r=this.graphRenderer)==null?void 0:r.fitToView()},description:w("graphFitToView")},{key:"+",handler:()=>{var r;return(r=this.graphRenderer)==null?void 0:r.zoomIn()},description:"Zoom In"},{key:"=",handler:()=>{var r;return(r=this.graphRenderer)==null?void 0:r.zoomIn()},description:"Zoom In"},{key:"-",handler:()=>{var r;return(r=this.graphRenderer)==null?void 0:r.zoomOut()},description:"Zoom Out"},{key:"Escape",handler:()=>this.toggleFilterDrawer(!1),description:"Close Filter Drawer"},{key:"f",ctrlKey:!0,handler:()=>this.focusSearch(),description:"Focus Search"},{key:"?",handler:()=>this.showKeyboardHelp(),description:w("keyboardShortcuts")}];this.contentEl.addEventListener("keydown",r=>{let n=r.target;if((n.tagName==="INPUT"||n.tagName==="TEXTAREA")&&r.key!=="Escape")return;let s=e.find(o=>o.key===r.key&&(o.ctrlKey===void 0||o.ctrlKey===(r.ctrlKey||r.metaKey)));s&&(r.preventDefault(),r.stopPropagation(),s.handler())})}focusSearch(){let e=this.contentEl.querySelector(".storyteller-network-search-input");e==null||e.focus()}showKeyboardHelp(){let e=new Fi.Modal(this.app);e.titleEl.setText(w("keyboardShortcuts"));let r=[{key:"F",description:w("graphFitToView")},{key:"+/=",description:"Zoom In"},{key:"-",description:"Zoom Out"},{key:"Ctrl+F",description:"Focus Search"},{key:"Esc",description:"Close Filter Drawer"},{key:"?",description:"Show This Help"}],n=e.contentEl.createEl("table",{cls:"storyteller-keyboard-shortcuts-table"});r.forEach(s=>{let o=n.createEl("tr");o.createEl("td",{text:s.key,cls:"storyteller-shortcut-key"}),o.createEl("td",{text:s.description,cls:"storyteller-shortcut-desc"})}),e.open()}announceToScreenReader(e){this.liveRegionEl&&(this.liveRegionEl.textContent="",setTimeout(()=>{this.liveRegionEl&&(this.liveRegionEl.textContent=e)},100))}updateStatusBar(){var o,l;if(!this.statusBarEl)return;let e=((o=this.graphRenderer)==null?void 0:o.getNodeCount())||0,r=((l=this.graphRenderer)==null?void 0:l.getEdgeCount())||0,n=Object.keys(this.currentFilters).length,s="";e===0&&r===0?s=w("emptyGraphMessage")||"No entities to display":(s=`${e} ${e===1?"node":"nodes"} \u2022 ${r} ${r===1?"edge":"edges"}`,n>0&&(s+=` (${n} ${n===1?"filter":"filters"} active)`)),this.statusBarEl.textContent=s}createStatusBar(e){this.statusBarEl=e.createDiv("storyteller-graph-status-bar"),this.statusBarEl.setAttribute("role","status"),this.statusBarEl.setAttribute("aria-live","polite"),this.updateStatusBar()}showEmptyState(e){let r=e.createDiv("storyteller-empty-state");r.setAttribute("role","status");let n=r.createDiv("storyteller-empty-state-icon");n.innerHTML='<svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><circle cx="8" cy="10" r="1" fill="currentColor"/><circle cx="16" cy="10" r="1" fill="currentColor"/><path d="M8 15h8"/></svg>',r.createEl("h3",{text:w("emptyGraphTitle")}),r.createEl("p",{text:w("emptyGraphMessage"),cls:"storyteller-empty-state-message"}),r.createDiv("storyteller-empty-state-tips").createEl("p",{text:w("emptyGraphTip"),cls:"storyteller-empty-state-tip"}),r.createDiv("storyteller-empty-state-actions").createEl("button",{text:w("resetFilters"),cls:"mod-cta"}).addEventListener("click",()=>{this.resetFilters()})}}});var eE={};At(eE,{CultureModal:()=>kc});var di,kc,Pf=_e(()=>{di=require("obsidian");ea();Qa();es();St();kc=class extends hr{constructor(t,e,r,n,s){super(t),this.plugin=e,this.isNew=r===null,this.culture=r||{name:"",languages:[],techLevel:"medieval",governmentType:"monarchy",status:"thriving",linkedLocations:[],linkedCharacters:[],linkedEvents:[],relatedCultures:[],customFields:{},groups:[],connections:[]},this.culture.customFields||(this.culture.customFields={}),this.culture.languages||(this.culture.languages=[]),this.culture.linkedLocations||(this.culture.linkedLocations=[]),this.culture.linkedCharacters||(this.culture.linkedCharacters=[]),this.culture.linkedEvents||(this.culture.linkedEvents=[]),this.culture.relatedCultures||(this.culture.relatedCultures=[]),this.culture.groups||(this.culture.groups=[]),this.culture.connections||(this.culture.connections=[]),this.onSubmit=n,this.onDelete=s,this.modalEl.addClass("storyteller-culture-modal")}onOpen(){super.onOpen();let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?w("createNewCulture"):`${w("editCulture")}: ${this.culture.name}`}),this.isNew&&new di.Setting(t).setName(w("startFromTemplate")).setDesc(w("startFromTemplateDesc")).addButton(n=>n.setButtonText(w("chooseTemplate")).setTooltip(w("selectTemplate")).onClick(()=>{new Gr(this.app,this.plugin,async s=>{await this.applyTemplateToCulture(s),this.refresh(),new di.Notice(w("templateApplied",s.name))},"culture").open()})),new di.Setting(t).setName(w("name")).setDesc(w("cultureNameDesc")).addText(n=>{n.setValue(this.culture.name).onChange(s=>this.culture.name=s),n.inputEl.addClass("storyteller-modal-input-large")});let e;new di.Setting(t).setName(w("profileImage")).setDesc("").then(n=>{e=n.descEl.createEl("small",{text:w("currentValue",this.culture.profileImagePath||w("none"))})}).addButton(n=>n.setButtonText(w("select")).onClick(()=>{new zr(this.app,this.plugin,s=>{let o=s?s.filePath:"";this.culture.profileImagePath=o||void 0,e.setText(w("currentValue",this.culture.profileImagePath||w("none")))}).open()})).addButton(n=>n.setButtonText(w("clear")).onClick(()=>{this.culture.profileImagePath=void 0,e.setText(w("currentValue",w("none")))})),new di.Setting(t).setName(w("techLevel")).setDesc(w("techLevelDesc")).addDropdown(n=>n.addOptions({"stone-age":w("stoneAge"),"bronze-age":w("bronzeAge"),"iron-age":w("ironAge"),medieval:w("medieval"),renaissance:w("renaissance"),industrial:w("industrial"),modern:w("modern"),futuristic:w("futuristic"),custom:w("custom")}).setValue(this.culture.techLevel||"medieval").onChange(s=>this.culture.techLevel=s)),new di.Setting(t).setName(w("governmentType")).setDesc(w("governmentTypeDesc")).addDropdown(n=>n.addOptions({monarchy:w("monarchy"),democracy:w("democracy"),republic:w("republic"),theocracy:w("theocracy"),tribal:w("tribal"),empire:w("empire"),feudal:w("feudal"),oligarchy:w("oligarchy"),anarchy:w("anarchy"),custom:w("custom")}).setValue(this.culture.governmentType||"monarchy").onChange(s=>this.culture.governmentType=s)),new di.Setting(t).setName(w("status")).setDesc(w("cultureStatusDesc")).addDropdown(n=>n.addOptions({thriving:w("thriving"),stable:w("stable"),declining:w("declining"),extinct:w("extinct"),emerging:w("emerging"),custom:w("custom")}).setValue(this.culture.status||"thriving").onChange(s=>this.culture.status=s)),new di.Setting(t).setName(w("languages")).setDesc(w("languagesDesc")).addText(n=>{var s;return n.setValue(((s=this.culture.languages)==null?void 0:s.join(", "))||"").onChange(o=>{this.culture.languages=o.split(",").map(l=>l.trim()).filter(l=>l)})}),new di.Setting(t).setName(w("population")).setDesc(w("populationDesc")).addText(n=>n.setValue(this.culture.population||"").onChange(s=>this.culture.population=s)),new di.Setting(t).setName(w("description")).setDesc(w("cultureDescriptionDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.culture.description||"").onChange(s=>this.culture.description=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new di.Setting(t).setName(w("valuesBeliefs")).setDesc(w("valuesBeliefsDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.culture.values||"").onChange(s=>this.culture.values=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new di.Setting(t).setName(w("religion")).setDesc(w("religionDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.culture.religion||"").onChange(s=>this.culture.religion=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new di.Setting(t).setName(w("socialStructure")).setDesc(w("socialStructureDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.culture.socialStructure||"").onChange(s=>this.culture.socialStructure=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new di.Setting(t).setName(w("history")).setDesc(w("cultureHistoryDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.culture.history||"").onChange(s=>this.culture.history=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new di.Setting(t).setName(w("namingConventions")).setDesc(w("namingConventionsDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.culture.namingConventions||"").onChange(s=>this.culture.namingConventions=s),n.inputEl.rows=3,n.inputEl.style.width="100%"}),new di.Setting(t).setName(w("customsTraditions")).setDesc(w("customsTraditionsDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.culture.customs||"").onChange(s=>this.culture.customs=s),n.inputEl.rows=4,n.inputEl.style.width="100%"});let r=new di.Setting(t);r.addButton(n=>n.setButtonText(w("save")).setCta().onClick(async()=>{if(!this.culture.name){new di.Notice(w("cultureNameRequired"));return}await this.onSubmit(this.culture),this.close()})),r.addButton(n=>n.setButtonText(w("cancel")).onClick(()=>this.close())),!this.isNew&&this.onDelete&&r.addButton(n=>n.setButtonText(w("delete")).setWarning().onClick(async()=>{this.onDelete&&(await this.onDelete(this.culture),this.close())}))}async applyTemplateToCulture(t){if(!t.entities.cultures||t.entities.cultures.length===0){new di.Notice(w("noTemplatesAvailable"));return}let e=t.entities.cultures[0],{templateId:r,sectionContent:n,customYamlFields:s,id:o,filePath:l,...c}=e;if(Object.assign(this.culture,c),s&&Object.assign(this.culture,s),n)for(let[u,d]of Object.entries(n)){let h=u.toLowerCase().replace(/\s+/g,"");this.culture[h]=d}this.culture.linkedLocations=[],this.culture.linkedCharacters=[],this.culture.linkedEvents=[],this.culture.relatedCultures=[],this.culture.parentCulture=void 0,this.culture.groups=[],this.culture.connections=[]}refresh(){this.onOpen()}onClose(){let{contentEl:t}=this;t.empty()}}});var tE={};At(tE,{EconomyModal:()=>Dc});var ma,Dc,Lf=_e(()=>{ma=require("obsidian");ea();Qa();es();St();Dc=class extends hr{constructor(t,e,r,n,s){super(t),this.plugin=e,this.isNew=r===null,this.economy=r||{name:"",economicSystem:"market",status:"stable",currencies:[],resources:[],tradeRoutes:[],linkedLocations:[],linkedFactions:[],linkedCultures:[],linkedEvents:[],customFields:{},groups:[],connections:[]},this.economy.customFields||(this.economy.customFields={}),this.economy.currencies||(this.economy.currencies=[]),this.economy.resources||(this.economy.resources=[]),this.economy.tradeRoutes||(this.economy.tradeRoutes=[]),this.economy.linkedLocations||(this.economy.linkedLocations=[]),this.economy.linkedFactions||(this.economy.linkedFactions=[]),this.economy.linkedCultures||(this.economy.linkedCultures=[]),this.economy.linkedEvents||(this.economy.linkedEvents=[]),this.economy.groups||(this.economy.groups=[]),this.economy.connections||(this.economy.connections=[]),this.onSubmit=n,this.onDelete=s,this.modalEl.addClass("storyteller-economy-modal")}onOpen(){super.onOpen();let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?w("createNewEconomy"):`${w("editEconomy")}: ${this.economy.name}`}),this.isNew&&new ma.Setting(t).setName(w("startFromTemplate")).setDesc(w("startFromTemplateDesc")).addButton(n=>n.setButtonText(w("chooseTemplate")).setTooltip(w("selectTemplate")).onClick(()=>{new Gr(this.app,this.plugin,async s=>{await this.applyTemplateToEconomy(s),this.refresh(),new ma.Notice(w("templateApplied",s.name))},"economy").open()})),new ma.Setting(t).setName(w("name")).setDesc(w("economyNameDesc")).addText(n=>{n.setValue(this.economy.name).onChange(s=>this.economy.name=s),n.inputEl.addClass("storyteller-modal-input-large")});let e;new ma.Setting(t).setName(w("representativeImage")).setDesc("").then(n=>{e=n.descEl.createEl("small",{text:w("currentValue",this.economy.profileImagePath||w("none"))})}).addButton(n=>n.setButtonText(w("select")).onClick(()=>{new zr(this.app,this.plugin,s=>{let o=s?s.filePath:"";this.economy.profileImagePath=o||void 0,e.setText(w("currentValue",this.economy.profileImagePath||w("none")))}).open()})).addButton(n=>n.setButtonText(w("clear")).onClick(()=>{this.economy.profileImagePath=void 0,e.setText(w("currentValue",w("none")))})),new ma.Setting(t).setName(w("economicSystem")).setDesc(w("economicSystemDesc")).addDropdown(n=>n.addOptions({barter:w("barterEconomy"),market:w("marketEconomy"),command:w("commandEconomy"),mixed:w("mixedEconomy"),feudal:w("feudalEconomy"),gift:w("giftEconomy"),custom:w("custom")}).setValue(this.economy.economicSystem||"market").onChange(s=>this.economy.economicSystem=s)),new ma.Setting(t).setName(w("status")).setDesc(w("economyStatusDesc")).addDropdown(n=>n.addOptions({booming:w("booming"),growing:w("growing"),stable:w("stable"),recession:w("recession"),depression:w("depression"),recovering:w("recovering"),custom:w("custom")}).setValue(this.economy.status||"stable").onChange(s=>this.economy.status=s)),new ma.Setting(t).setName(w("description")).setDesc(w("economyDescriptionDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.economy.description||"").onChange(s=>this.economy.description=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new ma.Setting(t).setName(w("industries")).setDesc(w("industriesDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.economy.industries||"").onChange(s=>this.economy.industries=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new ma.Setting(t).setName(w("taxation")).setDesc(w("taxationDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.economy.taxation||"").onChange(s=>this.economy.taxation=s),n.inputEl.rows=3,n.inputEl.style.width="100%"});let r=new ma.Setting(t);r.addButton(n=>n.setButtonText(w("save")).setCta().onClick(async()=>{if(!this.economy.name){new ma.Notice(w("economyNameRequired"));return}await this.onSubmit(this.economy),this.close()})),r.addButton(n=>n.setButtonText(w("cancel")).onClick(()=>this.close())),!this.isNew&&this.onDelete&&r.addButton(n=>n.setButtonText(w("delete")).setWarning().onClick(async()=>{this.onDelete&&(await this.onDelete(this.economy),this.close())}))}async applyTemplateToEconomy(t){if(!t.entities.economies||t.entities.economies.length===0){new ma.Notice(w("noTemplatesAvailable"));return}let e=t.entities.economies[0],{templateId:r,sectionContent:n,customYamlFields:s,id:o,filePath:l,...c}=e;if(Object.assign(this.economy,c),s&&Object.assign(this.economy,s),n)for(let[u,d]of Object.entries(n)){let h=u.toLowerCase().replace(/\s+/g,"");this.economy[h]=d}this.economy.linkedLocations=[],this.economy.linkedFactions=[],this.economy.linkedCultures=[],this.economy.linkedEvents=[],this.economy.groups=[],this.economy.connections=[]}refresh(){this.onOpen()}onClose(){let{contentEl:t}=this;t.empty()}}});var rE={};At(rE,{MagicSystemModal:()=>Pc});var _i,Pc,Mf=_e(()=>{_i=require("obsidian");ea();Qa();es();St();Pc=class extends hr{constructor(t,e,r,n,s){super(t),this.plugin=e,this.isNew=r===null,this.magicSystem=r||{name:"",systemType:"arcane",rarity:"common",powerLevel:"moderate",status:"active",categories:[],abilities:[],consistencyRules:[],linkedCharacters:[],linkedLocations:[],linkedCultures:[],linkedEvents:[],linkedItems:[],customFields:{},groups:[],connections:[]},this.magicSystem.customFields||(this.magicSystem.customFields={}),this.magicSystem.categories||(this.magicSystem.categories=[]),this.magicSystem.abilities||(this.magicSystem.abilities=[]),this.magicSystem.consistencyRules||(this.magicSystem.consistencyRules=[]),this.magicSystem.linkedCharacters||(this.magicSystem.linkedCharacters=[]),this.magicSystem.linkedLocations||(this.magicSystem.linkedLocations=[]),this.magicSystem.linkedCultures||(this.magicSystem.linkedCultures=[]),this.magicSystem.linkedEvents||(this.magicSystem.linkedEvents=[]),this.magicSystem.linkedItems||(this.magicSystem.linkedItems=[]),this.magicSystem.groups||(this.magicSystem.groups=[]),this.magicSystem.connections||(this.magicSystem.connections=[]),this.onSubmit=n,this.onDelete=s,this.modalEl.addClass("storyteller-magic-system-modal")}onOpen(){super.onOpen();let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?w("createNewMagicSystem"):`${w("editMagicSystem")}: ${this.magicSystem.name}`}),this.isNew&&new _i.Setting(t).setName(w("startFromTemplate")).setDesc(w("startFromTemplateDesc")).addButton(n=>n.setButtonText(w("chooseTemplate")).setTooltip(w("selectTemplate")).onClick(()=>{new Gr(this.app,this.plugin,async s=>{await this.applyTemplateToMagicSystem(s),this.refresh(),new _i.Notice(w("templateApplied",s.name))},"magicSystem").open()})),new _i.Setting(t).setName(w("name")).setDesc(w("magicSystemNameDesc")).addText(n=>{n.setValue(this.magicSystem.name).onChange(s=>this.magicSystem.name=s),n.inputEl.addClass("storyteller-modal-input-large")});let e;new _i.Setting(t).setName(w("representativeImage")).setDesc("").then(n=>{e=n.descEl.createEl("small",{text:w("currentValue",this.magicSystem.profileImagePath||w("none"))})}).addButton(n=>n.setButtonText(w("select")).onClick(()=>{new zr(this.app,this.plugin,s=>{let o=s?s.filePath:"";this.magicSystem.profileImagePath=o||void 0,e.setText(w("currentValue",this.magicSystem.profileImagePath||w("none")))}).open()})).addButton(n=>n.setButtonText(w("clear")).onClick(()=>{this.magicSystem.profileImagePath=void 0,e.setText(w("currentValue",w("none")))})),new _i.Setting(t).setName(w("systemType")).setDesc(w("systemTypeDesc")).addDropdown(n=>n.addOptions({arcane:w("arcane"),divine:w("divine"),natural:w("natural"),psionic:w("psionic"),blood:w("bloodMagic"),elemental:w("elemental"),necromancy:w("necromancy"),alchemy:w("alchemy"),rune:w("runeMagic"),custom:w("custom")}).setValue(this.magicSystem.systemType||"arcane").onChange(s=>this.magicSystem.systemType=s)),new _i.Setting(t).setName(w("rarity")).setDesc(w("rarityDesc")).addDropdown(n=>n.addOptions({ubiquitous:w("ubiquitous"),common:w("common"),uncommon:w("uncommon"),rare:w("rare"),legendary:w("legendary"),custom:w("custom")}).setValue(this.magicSystem.rarity||"common").onChange(s=>this.magicSystem.rarity=s)),new _i.Setting(t).setName(w("powerLevel")).setDesc(w("powerLevelDesc")).addDropdown(n=>n.addOptions({low:w("low"),moderate:w("moderate"),high:w("high"),godlike:w("godlike"),custom:w("custom")}).setValue(this.magicSystem.powerLevel||"moderate").onChange(s=>this.magicSystem.powerLevel=s)),new _i.Setting(t).setName(w("status")).setDesc(w("magicSystemStatusDesc")).addDropdown(n=>n.addOptions({active:w("active"),forbidden:w("forbidden"),lost:w("lostKnowledge"),declining:w("declining"),resurgent:w("resurgent"),custom:w("custom")}).setValue(this.magicSystem.status||"active").onChange(s=>this.magicSystem.status=s)),new _i.Setting(t).setName(w("description")).setDesc(w("magicSystemDescriptionDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.magicSystem.description||"").onChange(s=>this.magicSystem.description=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new _i.Setting(t).setName(w("rulesMechanics")).setDesc(w("rulesMechanicsDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.magicSystem.rules||"").onChange(s=>this.magicSystem.rules=s),n.inputEl.rows=4,n.inputEl.style.width="100%"}),new _i.Setting(t).setName(w("source")).setDesc(w("sourceDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.magicSystem.source||"").onChange(s=>this.magicSystem.source=s),n.inputEl.rows=3,n.inputEl.style.width="100%"}),new _i.Setting(t).setName(w("costsConsequences")).setDesc(w("costsConsequencesDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.magicSystem.costs||"").onChange(s=>this.magicSystem.costs=s),n.inputEl.rows=3,n.inputEl.style.width="100%"}),new _i.Setting(t).setName(w("limitations")).setDesc(w("limitationsDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.magicSystem.limitations||"").onChange(s=>this.magicSystem.limitations=s),n.inputEl.rows=3,n.inputEl.style.width="100%"}),new _i.Setting(t).setName(w("trainingLearning")).setDesc(w("trainingLearningDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.magicSystem.training||"").onChange(s=>this.magicSystem.training=s),n.inputEl.rows=3,n.inputEl.style.width="100%"}),new _i.Setting(t).setName(w("history")).setDesc(w("magicSystemHistoryDesc")).setClass("storyteller-modal-setting-vertical").addTextArea(n=>{n.setValue(this.magicSystem.history||"").onChange(s=>this.magicSystem.history=s),n.inputEl.rows=3,n.inputEl.style.width="100%"});let r=new _i.Setting(t);r.addButton(n=>n.setButtonText(w("save")).setCta().onClick(async()=>{if(!this.magicSystem.name){new _i.Notice(w("magicSystemNameRequired"));return}await this.onSubmit(this.magicSystem),this.close()})),r.addButton(n=>n.setButtonText(w("cancel")).onClick(()=>this.close())),!this.isNew&&this.onDelete&&r.addButton(n=>n.setButtonText(w("delete")).setWarning().onClick(async()=>{this.onDelete&&(await this.onDelete(this.magicSystem),this.close())}))}async applyTemplateToMagicSystem(t){if(!t.entities.magicSystems||t.entities.magicSystems.length===0){new _i.Notice(w("noTemplatesAvailable"));return}let e=t.entities.magicSystems[0],{templateId:r,sectionContent:n,customYamlFields:s,id:o,filePath:l,...c}=e;if(Object.assign(this.magicSystem,c),s&&Object.assign(this.magicSystem,s),n)for(let[u,d]of Object.entries(n)){let h=u.toLowerCase().replace(/\s+/g,"");this.magicSystem[h]=d}this.magicSystem.linkedCharacters=[],this.magicSystem.linkedLocations=[],this.magicSystem.linkedCultures=[],this.magicSystem.linkedEvents=[],this.magicSystem.linkedItems=[],this.magicSystem.groups=[],this.magicSystem.connections=[]}refresh(){this.onOpen()}onClose(){let{contentEl:t}=this;t.empty()}}});var nE={};At(nE,{ConflictListModal:()=>oP});var Hs,oP,aE=_e(()=>{Hs=require("obsidian");au();oP=class extends Hs.Modal{constructor(t,e,r,n){super(t),this.plugin=e,this.conflicts=r,this.onRefresh=n,this.modalEl.addClass("storyteller-conflict-list-modal")}async onOpen(){let{contentEl:t}=this;t.empty();let e=t.createDiv("storyteller-conflict-header");e.createEl("h2",{text:"Timeline Conflicts"});let r=e.createDiv("storyteller-conflict-stats"),n=this.conflicts.filter(u=>u.severity==="critical").length,s=this.conflicts.filter(u=>u.severity==="moderate").length,o=this.conflicts.filter(u=>u.severity==="minor").length;r.innerHTML=`
            <div style="display: flex; gap: 15px; margin: 10px 0; padding: 10px; background: var(--background-secondary); border-radius: 5px;">
                <div style="flex: 1; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; color: var(--text-error);">${n}</div>
                    <div style="font-size: 12px; opacity: 0.7;">Critical</div>
                </div>
                <div style="flex: 1; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; color: var(--text-warning);">${s}</div>
                    <div style="font-size: 12px; opacity: 0.7;">Moderate</div>
                </div>
                <div style="flex: 1; text-align: center;">
                    <div style="font-size: 24px; font-weight: bold; color: var(--text-muted);">${o}</div>
                    <div style="font-size: 12px; opacity: 0.7;">Minor</div>
                </div>
            </div>
        `;let l=t.createDiv("storyteller-conflict-toolbar"),c=new Hs.Setting(l);if(c.addButton(u=>u.setButtonText("Re-scan for Conflicts").setIcon("refresh-cw").onClick(async()=>{new Hs.Notice("Scanning for conflicts..."),this.onRefresh&&await this.onRefresh(),this.close()})),c.addButton(u=>u.setButtonText("Dismiss All").setWarning().onClick(async()=>{this.conflicts.forEach(d=>d.dismissed=!0),this.plugin.settings.timelineConflicts=this.conflicts,await this.plugin.saveSettings(),new Hs.Notice("All conflicts dismissed"),this.renderConflicts(t)})),this.conflicts.length===0){t.createEl("div",{text:"\u2705 No timeline conflicts detected! Your narrative is consistent.",cls:"storyteller-no-conflicts"}).style.cssText="text-align: center; padding: 40px; font-size: 16px; color: var(--text-success);";return}this.renderConflicts(t)}renderConflicts(t){let e=t.querySelector(".storyteller-conflicts-container");e&&e.remove();let r=t.createDiv("storyteller-conflicts-container"),n=this.conflicts.filter(c=>c.severity==="critical"&&!c.dismissed),s=this.conflicts.filter(c=>c.severity==="moderate"&&!c.dismissed),o=this.conflicts.filter(c=>c.severity==="minor"&&!c.dismissed);n.length>0&&this.renderConflictGroup(r,"Critical Issues",n,"critical"),s.length>0&&this.renderConflictGroup(r,"Moderate Issues",s,"moderate"),o.length>0&&this.renderConflictGroup(r,"Minor Issues",o,"minor");let l=this.conflicts.filter(c=>c.dismissed).length;l>0&&(r.createEl("div",{text:`${l} conflict(s) dismissed`,cls:"storyteller-dismissed-count"}).style.cssText="text-align: center; padding: 10px; opacity: 0.5; font-size: 12px;")}renderConflictGroup(t,e,r,n){let s=t.createDiv("storyteller-conflict-group");s.createEl("h3",{text:e}),r.forEach(o=>{this.renderConflict(s,o,n)})}renderConflict(t,e,r){let n=t.createDiv("storyteller-conflict-card");n.addClass(`storyteller-conflict-${r}`);let s=n.createDiv("storyteller-conflict-card-header"),o=Vr.getConflictIcon(e.type);if(s.innerHTML=`
            <span style="font-size: 20px; margin-right: 10px;">${o}</span>
            <strong>${e.type.charAt(0).toUpperCase()+e.type.slice(1)} Conflict</strong>
        `,n.createEl("p",{text:e.description,cls:"storyteller-conflict-description"}),e.entities&&e.entities.length>0){let h=n.createDiv("storyteller-conflict-entities");h.createEl("strong",{text:"Affected: "});let f=e.entities.map(m=>m.entityName).join(", ");h.createSpan({text:f})}if(e.events&&e.events.length>0){let h=n.createDiv("storyteller-conflict-events");h.createEl("strong",{text:"Events: "});let f=h.createEl("ul");f.style.marginLeft="20px",e.events.forEach(m=>{f.createEl("li",{text:m})})}if(e.suggestion){let h=n.createDiv("storyteller-conflict-suggestion");h.innerHTML=`
                <div style="background: var(--background-secondary); padding: 10px; border-radius: 5px; margin-top: 10px;">
                    <strong>\u{1F4A1} Suggestion:</strong><br>
                    ${e.suggestion}
                </div>
            `}let l=n.createDiv("storyteller-conflict-actions"),c=new Hs.Setting(l);c.addButton(h=>h.setButtonText("Dismiss").setClass("mod-warning").onClick(async()=>{e.dismissed=!0,this.plugin.settings.timelineConflicts=this.conflicts,await this.plugin.saveSettings(),new Hs.Notice("Conflict dismissed"),this.renderConflicts(this.contentEl)})),c.addButton(h=>h.setButtonText("View Events").onClick(async()=>{new Hs.Notice("Opening timeline view..."),new Hs.Notice(`Events: ${e.events.join(", ")}`)}));let u=n.createDiv("storyteller-conflict-timestamp"),d=new Date(e.detected);u.innerHTML=`
            <div style="font-size: 11px; opacity: 0.5; margin-top: 5px;">
                Detected: ${d.toLocaleString()}
            </div>
        `}onClose(){let{contentEl:t}=this;t.empty()}}});var p3={};At(p3,{FANTASY_KINGDOM_TEMPLATE:()=>ITe});var ITe,m3=_e(()=>{ITe={id:"builtin-fantasy-kingdom-v1",name:"Fantasy Kingdom",description:"A complete medieval fantasy kingdom with castle, noble houses, city watch, merchants guild, and elemental magic system. Perfect for starting a high fantasy story.",genre:"fantasy",category:"full-world",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2025-01-15T00:00:00.000Z",modified:"2025-01-15T00:00:00.000Z",tags:["fantasy","medieval","kingdom","magic","nobility","castle"],entities:{characters:[{templateId:"CHAR_001",yamlContent:`name: "King Aldric Stormhaven"
traits: ["Wise", "Just", "Strategic", "Diplomatic", "Aging"]
status: "Alive"
affiliation: "House Stormhaven"
age: "54"
title: "King of Arendor"
weapon: "Ceremonial Longsword"
relationships:
  - target: "CHAR_002"
    type: "romantic"
    label: "spouse"
  - target: "CHAR_003"
    type: "family"
    label: "son"
  - target: "CHAR_004"
    type: "ally"
    label: "trusts completely"
  - target: "CHAR_005"
    type: "ally"
    label: "advisor"
locations: ["LOC_001", "LOC_002"]
events: ["EVENT_001", "EVENT_005"]
groups: ["GROUP_001"]
connections:
  - target: "LOC_001"
    type: "ally"
    label: "resides"
  - target: "GROUP_001"
    type: "ally"
    label: "leads"`,markdownContent:`## Description

The aging but wise ruler of the Kingdom of Arendor. Known for his just governance and strategic mind.

## Backstory

Born into House Stormhaven, Aldric ascended to the throne at age 30 after his father's passing. His 24-year reign has been marked by prosperity and peace, though shadows gather at the borders.`},{templateId:"CHAR_002",name:"Queen Elara Stormhaven",description:"Graceful and politically astute royal consort. Known for her diplomatic skills and charity work.",backstory:"Daughter of a neighboring kingdom, Elara's marriage to Aldric was political at first, but grew into deep love. She manages the court and foreign relations.",traits:["Diplomatic","Graceful","Intelligent","Compassionate"],status:"Alive",affiliation:"House Stormhaven",customFields:{age:"48",title:"Queen of Arendor",specialty:"Diplomacy"},relationships:[{target:"CHAR_001",type:"romantic",label:"spouse"},{target:"CHAR_003",type:"family",label:"son"}],locations:["LOC_001"],events:["EVENT_001","EVENT_003"],groups:["GROUP_001"]},{templateId:"CHAR_003",name:"Prince Theron Stormhaven",description:"Young heir to the throne, eager to prove himself but still learning the weight of leadership.",backstory:"Raised in the castle, Theron has been trained in combat, strategy, and statecraft. He yearns for adventure but understands his duty.",traits:["Brave","Eager","Idealistic","Skilled Fighter"],status:"Alive",affiliation:"House Stormhaven",customFields:{age:"22",title:"Crown Prince",weapon:"Longsword and Shield"},relationships:[{target:"CHAR_001",type:"family",label:"father"},{target:"CHAR_002",type:"family",label:"mother"},{target:"CHAR_007",type:"mentor",label:"trains with"}],locations:["LOC_001","LOC_008"],events:["EVENT_001","EVENT_002"],groups:["GROUP_001"]},{templateId:"CHAR_004",name:"Lord Commander Marcus Ironforge",description:"Grizzled veteran military leader. Commands the kingdom's armies with tactical brilliance.",backstory:"Rose through the ranks from common soldier to Lord Commander. His loyalty to the crown is absolute, earned through decades of service.",traits:["Tactical","Loyal","Stern","Experienced","Honorable"],status:"Alive",affiliation:"Royal Army",customFields:{age:"58",rank:"Lord Commander",weapon:"Warhammer"},relationships:[{target:"CHAR_001",type:"ally",label:"serves"},{target:"CHAR_007",type:"ally",label:"commands"},{target:"CHAR_003",type:"mentor",label:"trains"}],locations:["LOC_001","LOC_008"],events:["EVENT_002","EVENT_005"],groups:["GROUP_002"]},{templateId:"CHAR_005",name:"Court Wizard Merrick Shadowmend",description:"Mysterious and powerful mage who advises the king on magical matters and threats.",backstory:"Arrived at court 15 years ago, offering his services. His past is shrouded in mystery, but his loyalty has been proven time and again.",traits:["Wise","Mysterious","Powerful","Scholarly","Cautious"],status:"Alive",affiliation:"Royal Court",customFields:{age:"Unknown (appears 60)",specialty:"Elemental Magic",familiar:"Raven named Nightwing"},relationships:[{target:"CHAR_001",type:"ally",label:"advises"},{target:"CHAR_012",type:"rival",label:"wary of"}],locations:["LOC_001","LOC_003"],events:["EVENT_004"],groups:["GROUP_001"]},{templateId:"CHAR_006",name:"Lady Seraphine Moonwhisper",description:"Noble lady from an ancient bloodline. Manages extensive estates and has considerable political influence.",backstory:"Head of House Moonwhisper, one of the oldest noble families. Shrewd politician who carefully balances tradition and progress.",traits:["Shrewd","Elegant","Traditional","Influential"],status:"Alive",affiliation:"House Moonwhisper",customFields:{age:"42",title:"Lady of House Moonwhisper",estates:"Three manors, vineyard"},relationships:[{target:"CHAR_001",type:"ally",label:"supports"},{target:"CHAR_010",type:"ally",label:"business partner"}],locations:["LOC_001","LOC_004"],events:["EVENT_003","EVENT_005"],groups:["GROUP_001"]},{templateId:"CHAR_007",name:"Captain Roderick Ashblade",description:"Skilled captain of the City Watch. Maintains order in the capital with firm but fair hand.",backstory:"Former adventurer who settled down to serve the crown. His experience in the field makes him an excellent trainer and leader.",traits:["Disciplined","Fair","Experienced","Vigilant"],status:"Alive",affiliation:"City Watch",customFields:{age:"38",rank:"Captain",weapon:"Longsword"},relationships:[{target:"CHAR_004",type:"ally",label:"reports to"},{target:"CHAR_003",type:"mentor",label:"trains"}],locations:["LOC_001","LOC_004"],events:["EVENT_002"],groups:["GROUP_002"]},{templateId:"CHAR_008",name:"Brother Aldwin Lightbringer",description:"Gentle priest who tends to the spiritual needs of the people and the royal family.",backstory:"Dedicated his life to serving the divine. Known for his healing abilities and compassionate counsel.",traits:["Compassionate","Faithful","Gentle","Healing"],status:"Alive",affiliation:"Temple of Light",customFields:{age:"51",title:"High Priest",deity:"The Radiant One"},relationships:[{target:"CHAR_001",type:"ally",label:"counsels"},{target:"CHAR_002",type:"ally",label:"counsels"}],locations:["LOC_001"],events:["EVENT_001","EVENT_003"],groups:[]},{templateId:"CHAR_009",name:"Master Blacksmith Duran Hammerfall",description:"Renowned craftsman whose weapons and armor are sought throughout the realm.",backstory:"Third generation master smith. His forge has supplied the royal army for three generations.",traits:["Skilled","Gruff","Perfectionist","Strong"],status:"Alive",affiliation:"Smithing Guild",customFields:{age:"45",specialty:"Weapons and Armor",notable_work:"Prince Theron's sword"},relationships:[{target:"CHAR_003",type:"acquaintance",label:"crafted sword for"},{target:"CHAR_010",type:"ally",label:"guild colleague"}],locations:["LOC_004"],events:[],groups:["GROUP_003"]},{templateId:"CHAR_010",name:"Guildmaster Yara Goldleaf",description:"Shrewd leader of the Merchants Guild. Controls much of the kingdom's trade and commerce.",backstory:"Started as a simple trader, built a merchant empire through wit and determination. Now holds significant economic power.",traits:["Shrewd","Ambitious","Charming","Wealthy"],status:"Alive",affiliation:"Merchants Guild",customFields:{age:"39",title:"Guildmaster",wealth:"Extensive"},relationships:[{target:"CHAR_006",type:"ally",label:"business partner"},{target:"CHAR_011",type:"acquaintance",label:"frequent customer"}],locations:["LOC_004"],events:["EVENT_005"],groups:["GROUP_003"]},{templateId:"CHAR_011",name:"Finn Oakbarrel",description:"Friendly tavern keeper who hears all the gossip and news in the kingdom.",backstory:"Runs the most popular tavern in the city. A good listener and source of information for those who know to ask.",traits:["Friendly","Observant","Discreet","Jovial"],status:"Alive",affiliation:"Common Folk",customFields:{age:"35",business:"The Prancing Pony Tavern",specialty:"Information gathering"},relationships:[{target:"CHAR_012",type:"acquaintance",label:"frequent patron"}],locations:["LOC_005"],events:["EVENT_003"],groups:[]},{templateId:"CHAR_012",name:"The Mysterious Stranger",description:"A hooded figure recently arrived in the kingdom. Their purpose and identity remain unknown.",backstory:"Appeared shortly before strange events began occurring. Asks many questions but reveals nothing about themselves.",traits:["Mysterious","Secretive","Observant","Cautious"],status:"Unknown",affiliation:"Unknown",customFields:{age:"Unknown",true_identity:"To be revealed",magic_ability:"Suspected"},relationships:[{target:"CHAR_005",type:"rival",label:"interests"},{target:"CHAR_011",type:"acquaintance",label:"frequents tavern"}],locations:["LOC_005","LOC_007"],events:["EVENT_004"],groups:[]}],locations:[{templateId:"LOC_001",name:"Castle Stormhaven",description:"The magnificent seat of power for House Stormhaven. Towering walls of grey stone overlook the capital city.",history:"Built 300 years ago by the first Stormhaven king. Has withstood three sieges and countless political intrigues.",locationType:"Castle",region:"Capital District",status:"Occupied",customFields:{size:"Large",defenses:"High walls, guard towers, moat",population:"500+ residents"},groups:["GROUP_001"],connections:[{target:"GROUP_001",type:"ally",label:"seat of power"}]},{templateId:"LOC_002",name:"Royal Throne Room",description:"Grand hall where the king holds court. High vaulted ceilings, stained glass windows, and the ancient Throne of Arendor.",history:"The throne itself is said to date back to the kingdom's founding. Every king has been crowned here.",locationType:"Interior - Great Hall",region:"Castle Stormhaven",parentLocation:"LOC_001",status:"Active",groups:["GROUP_001"]},{templateId:"LOC_003",name:"Royal Library and Archives",description:"Vast collection of books, scrolls, and magical tomes. The wizard Merrick spends much of his time here.",history:"Accumulated knowledge over three centuries. Contains some of the rarest magical texts in the realm.",locationType:"Interior - Library",region:"Castle Stormhaven",parentLocation:"LOC_001",status:"Restricted Access",customFields:{volumes:"10,000+",magical_tomes:"Extensive collection",keeper:"Court Wizard Merrick"},groups:[]},{templateId:"LOC_004",name:"Market District",description:"Bustling center of commerce. Merchants, craftsmen, and traders from across the realm gather here.",history:"Grew organically outside the castle walls. Now the economic heart of the kingdom.",locationType:"Urban - Commercial",region:"Capital City",status:"Active",customFields:{market_days:"Daily",specialties:"Weapons, cloth, food, exotic goods"},groups:["GROUP_003"],connections:[{target:"GROUP_003",type:"ally",label:"controlled by"}]},{templateId:"LOC_005",name:"The Prancing Pony Tavern",description:"Popular tavern and inn. Common ground for nobles and commoners alike. Known for good ale and better gossip.",history:"Family-run establishment for four generations. Has been witness to countless deals and conspiracies.",locationType:"Building - Tavern",region:"Market District",parentLocation:"LOC_004",status:"Operating",customFields:{owner:"Finn Oakbarrel",specialty:"Honey mead",rooms:"12 for rent"},groups:[]},{templateId:"LOC_006",name:"Whispering Woods",description:"Ancient forest to the east. Beautiful but mysterious, with rumors of magical creatures and hidden ruins.",history:"Predates the kingdom itself. Local legends speak of fae folk and ancient magic within its depths.",locationType:"Wilderness - Forest",region:"Eastern Border",status:"Wild",customFields:{size:"Vast",danger_level:"Moderate",resources:"Timber, herbs, game"},groups:[]},{templateId:"LOC_007",name:"Ancient Ruins of Shadowkeep",description:"Crumbling fortress from a forgotten age. Recently, strange lights and sounds have been reported here.",history:"Predates the kingdom. Historical records are scarce, but it was clearly once a place of great power.",locationType:"Ruins - Fortress",region:"Whispering Woods",parentLocation:"LOC_006",status:"Abandoned (Recently Active?)",customFields:{age:"Unknown (Ancient)",danger_level:"High",magical_signature:"Strong"},groups:[]},{templateId:"LOC_008",name:"Northern Border Fort",description:"Military outpost guarding the kingdom's northern frontier. Recently reinforced due to increased raids.",history:"Built 50 years ago to defend against northern tribes. Now facing renewed threats.",locationType:"Military - Fort",region:"Northern Border",status:"Garrisoned",customFields:{garrison:"200 soldiers",commander:"Lord Commander Marcus",defenses:"Wooden palisade, watchtowers"},groups:["GROUP_002"]}],events:[{templateId:"EVENT_001",name:"The Royal Coronation",description:"King Aldric's coronation ceremony 24 years ago. The beginning of an era of peace and prosperity.",outcome:"Aldric was crowned king and has ruled wisely ever since. The ceremony unified the noble houses.",dateTime:"1201-03-15",isMilestone:!0,status:"Completed",characters:["CHAR_001","CHAR_002","CHAR_008"],location:"LOC_002",groups:["GROUP_001"],customFields:{attendees:"All noble houses, foreign dignitaries",significance:"Beginning of current reign"}},{templateId:"EVENT_002",name:"Border Skirmish at Northern Fort",description:"Raiders from the north attacked the border fort. The attack was repelled but revealed concerning coordination.",outcome:"Fort successfully defended. Raiders retreated, but their tactics suggest organization and planning.",dateTime:"1225-07-22",isMilestone:!1,status:"Completed",characters:["CHAR_004","CHAR_007","CHAR_003"],location:"LOC_008",groups:["GROUP_002"],dependencies:["EVENT_001"],customFields:{casualties:"Minimal",enemy_force:"Approximately 50 raiders",concern_level:"High"}},{templateId:"EVENT_003",name:"Harvest Festival",description:"Annual celebration of the harvest. The capital fills with music, food, and festivities.",outcome:"Successful festival that strengthened bonds between nobility and common folk.",dateTime:"1225-09-15",isMilestone:!1,status:"Completed",characters:["CHAR_001","CHAR_002","CHAR_006","CHAR_008","CHAR_011"],location:"LOC_004",groups:["GROUP_003"],dependencies:["EVENT_001"],customFields:{duration:"3 days",attendance:"Thousands",activities:"Markets, tournaments, feasts"}},{templateId:"EVENT_004",name:"Discovery at the Ancient Ruins",description:"Strange magical phenomena detected at Shadowkeep ruins. The Court Wizard investigates.",outcome:"Investigation ongoing. Merrick found evidence of recent magical activity and the mysterious stranger.",dateTime:"1225-10-01",isMilestone:!0,status:"Ongoing",characters:["CHAR_005","CHAR_012"],location:"LOC_007",groups:[],dependencies:["EVENT_001"],customFields:{discovery:"Ancient magical artifact activated",danger_level:"Unknown",next_steps:"Further investigation required"}},{templateId:"EVENT_005",name:"Trade Summit with Neighboring Kingdoms",description:"Important diplomatic gathering to negotiate trade agreements and mutual defense pacts.",outcome:"Pending - summit scheduled for next month.",dateTime:"1225-11-15",isMilestone:!0,status:"Upcoming",characters:["CHAR_001","CHAR_002","CHAR_004","CHAR_006","CHAR_010"],location:"LOC_001",groups:["GROUP_001","GROUP_003"],dependencies:["EVENT_001","EVENT_003"],customFields:{attendees:"Five neighboring kingdoms",stakes:"High - economic and military alliance",preparation:"Extensive"}}],groups:[{templateId:"GROUP_001",name:"House Stormhaven",groupType:"faction",description:"The ruling royal family of the Kingdom of Arendor. Known for just and wise governance.",history:"Founded the kingdom 300 years ago. Has maintained power through combination of military strength and popular support.",structure:"Hereditary monarchy with advisory council",goals:"Maintain stability, protect the realm, ensure prosperity",color:"#4169E1",customFields:{motto:"Through Storm and Thunder",sigil:"Lightning bolt over castle",seat:"Castle Stormhaven"},members:[{type:"character",id:"CHAR_001",name:"CHAR_001",rank:"King",joinDate:"1201-03-15",loyalty:"devoted"},{type:"character",id:"CHAR_002",name:"CHAR_002",rank:"Queen",joinDate:"1201-03-15",loyalty:"devoted"},{type:"character",id:"CHAR_003",name:"CHAR_003",rank:"Crown Prince",joinDate:"1203-05-20",loyalty:"devoted"},{type:"character",id:"CHAR_005",name:"CHAR_005",rank:"Court Wizard",joinDate:"1210-08-10",loyalty:"devoted"},{type:"character",id:"CHAR_006",name:"CHAR_006",rank:"Allied Noble",joinDate:"1201-03-15",loyalty:"loyal"}],territories:["LOC_001","LOC_002","LOC_003"],linkedEvents:["EVENT_001","EVENT_005"],resources:"Extensive - treasury, lands, military",strength:"Very High",militaryPower:85,economicPower:85,politicalInfluence:100},{templateId:"GROUP_002",name:"The City Watch",groupType:"military",description:"The kingdom's standing army and city guard. Maintains law and order throughout the realm.",history:"Established with the kingdom. Professionalized under Lord Commander Marcus's leadership.",structure:"Military hierarchy - Lord Commander, Captains, Soldiers",goals:"Protect the kingdom, maintain order, defend borders",color:"#8B4513",customFields:{motto:"Ever Vigilant",sigil:"Crossed swords",headquarters:"Castle Stormhaven"},members:[{type:"character",id:"CHAR_004",name:"CHAR_004",rank:"Lord Commander",joinDate:"1195-01-01",loyalty:"devoted"},{type:"character",id:"CHAR_007",name:"CHAR_007",rank:"Captain",joinDate:"1215-03-15",loyalty:"devoted"}],territories:["LOC_001","LOC_008"],linkedEvents:["EVENT_002"],resources:"Moderate - royal funding, equipment",strength:"High",militaryPower:90,economicPower:50,politicalInfluence:55},{templateId:"GROUP_003",name:"Merchants Guild",groupType:"guild",description:"Powerful economic organization controlling most trade and commerce in the kingdom.",history:"Formed 150 years ago by merchant families. Has grown to wield significant economic and political power.",structure:"Elected Guildmaster, council of senior merchants",goals:"Increase profits, protect trade routes, expand influence",color:"#FFD700",customFields:{motto:"Trade Enriches All",sigil:"Gold coin with merchant ship",headquarters:"Market District"},members:[{type:"character",id:"CHAR_010",name:"CHAR_010",rank:"Guildmaster",joinDate:"1220-01-01",loyalty:"devoted"},{type:"character",id:"CHAR_009",name:"CHAR_009",rank:"Master Craftsman",joinDate:"1215-06-01",loyalty:"loyal"}],territories:["LOC_004"],linkedEvents:["EVENT_003","EVENT_005"],resources:"High - wealth, trade connections, warehouses",strength:"Moderate",militaryPower:20,economicPower:90,politicalInfluence:70}],cultures:[{templateId:"CULTURE_001",name:"Kingdom of Arendor",description:"Medieval European-inspired culture with strong traditions of chivalry, honor, and magical respect.",values:"Honor, loyalty, justice, courage, wisdom",religion:"Worship of the Radiant One, a deity of light and order",socialStructure:"Feudal monarchy with nobility, merchants, craftsmen, and peasants",history:"Founded 300 years ago by the first Stormhaven king. Has maintained stability through just governance and magical integration.",customFields:{architecture:"Stone castles, timber-frame buildings",clothing:"Medieval tunics, gowns, armor for warriors",cuisine:"Roasted meats, bread, stews, mead"},governmentType:"Hereditary Monarchy",techLevel:"Medieval",status:"Thriving",population:"Approximately 100,000",linkedLocations:["LOC_001","LOC_004"],linkedCharacters:["CHAR_001","CHAR_002","CHAR_003","CHAR_004","CHAR_005","CHAR_006","CHAR_007","CHAR_008","CHAR_009","CHAR_010","CHAR_011"]}],economies:[{templateId:"ECONOMY_001",name:"Feudal Trade Economy",description:"Agricultural base with growing merchant trade. Currency-based with gold, silver, and copper coins.",economicSystem:"Feudal with market economy",status:"Stable",customFields:{primary_industry:"Agriculture",secondary_industry:"Trade and crafts",unemployment:"Low",inflation:"Stable"},currencies:[{name:"Gold Crown"},{name:"Silver Penny"},{name:"Copper Bit"}],industries:"Agriculture, metalworking, textiles, timber, livestock",taxation:"Feudal taxes, trade tariffs, guild fees",linkedLocations:["LOC_001","LOC_004"],linkedFactions:["GROUP_001","GROUP_003"],linkedCultures:["CULTURE_001"]}],magicSystems:[{templateId:"MAGIC_001",name:"Elemental Magic",description:"Magic system based on control of the four classical elements: Fire, Water, Earth, and Air.",systemType:"Hard Magic",rarity:"Rare",powerLevel:"Moderate to High",status:"Active",source:"Innate talent combined with rigorous study",costs:"Mental fatigue, physical exhaustion with overuse",limitations:"Requires focus, training, and knowledge. Each mage typically masters only 1-2 elements.",training:"Years of study and practice. Usually apprenticeship with experienced mage.",history:"Ancient art passed down through generations. Respected but sometimes feared by common folk.",customFields:{elements:"Fire, Water, Earth, Air",notable_effects:"Fireballs, ice walls, earth shaping, wind blasts",advanced_techniques:"Element combination, permanent enchantments"},categories:[{name:"Evocation"},{name:"Transmutation"},{name:"Enchantment"}],materials:["Focus items (staffs, wands)","spell components","elemental crystals"],linkedCharacters:["CHAR_005"],linkedCultures:["CULTURE_001"],linkedLocations:["LOC_003"]}],items:[{templateId:"ITEM_001",name:"Crown of Arendor",description:"Ancient golden crown set with sapphires and diamonds. Worn by every king of Arendor since the kingdom's founding.",history:"Forged 300 years ago for the first king. Said to contain subtle enchantments of authority and wisdom.",isPlotCritical:!0,currentOwner:"CHAR_001",pastOwners:[],currentLocation:"LOC_002",associatedEvents:["EVENT_001"],groups:["GROUP_001"],customFields:{material:"Gold, sapphires, diamonds",magical_properties:"Enhances wearer's authority and wisdom",value:"Priceless"}}]},metadata:{entityCounts:{character:12,location:8,event:5,item:1,group:3,culture:1,economy:1,magicSystem:1,chapter:0,scene:0,reference:0},setupInstructions:"This template creates a complete fantasy kingdom ready for storytelling. All characters have established relationships, locations are interconnected, and events provide both history and hooks for future stories. The mysterious stranger and ancient ruins provide immediate plot hooks to explore.",recommendedSettings:{enableCustomEntityFolders:!1,enableOneStoryMode:!0}}}});var g3={};At(g3,{CYBERPUNK_METROPOLIS_TEMPLATE:()=>ATe});var ATe,v3=_e(()=>{ATe={id:"builtin-cyberpunk-metropolis-v1",name:"Cyberpunk Metropolis",description:"A dystopian cyberpunk megacity with mega-corporations, street gangs, netrunners, and cybernetic augmentation. Perfect for noir tech thrillers.",genre:"scifi",category:"full-world",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2025-01-15T00:00:00.000Z",modified:"2025-01-15T00:00:00.000Z",tags:["cyberpunk","scifi","dystopian","technology","corporations","noir"],entities:{characters:[{templateId:"CHAR_001",name:"Nyx Rivera",description:"Street samurai with military-grade cybernetic augmentations. Freelance mercenary who works for the highest bidder.",backstory:"Former corporate security until a mission went wrong. Now operates in the shadows, taking jobs that keep her one step ahead of her past.",traits:["Combat Expert","Cybernetically Enhanced","Distrustful","Professional","Haunted"],status:"Active",affiliation:"Independent",customFields:{age:"32",augmentations:"Reflex boosters, dermal armor, optical implants",specialty:"Close combat, tactical operations",reputation:"Known and feared"},relationships:[{target:"CHAR_002",type:"ally",label:"frequent client"},{target:"CHAR_003",type:"ally",label:"works with occasionally"},{target:"CHAR_004",type:"enemy",label:"former employer, complicated"}],locations:["LOC_001","LOC_003"],events:["EVENT_001","EVENT_002"],groups:[],connections:[{target:"CHAR_002",type:"ally",label:"gets cyberware from"}]},{templateId:"CHAR_002",name:"Dr. Kai Chen",description:"Underground ripperdoc specializing in black market cybernetic installations. Operates a clinic in the Neon Underground.",backstory:"Former corporate doctor who left after witnessing unethical experimentation. Now helps those who can't afford legal medical care.",traits:["Skilled Surgeon","Ethical","Resourceful","Paranoid","Compassionate"],status:"Active",affiliation:"Independent",customFields:{age:"45",specialty:"Cybernetic surgery, neural interfaces",clinic:"The Chrome Clinic",reputation:"Trusted in the Underground"},relationships:[{target:"CHAR_001",type:"ally",label:"regular patient"},{target:"CHAR_003",type:"ally",label:"information exchange"},{target:"CHAR_004",type:"enemy",label:"escaped from"}],locations:["LOC_003","LOC_004"],events:["EVENT_001","EVENT_003"],groups:[],connections:[]},{templateId:"CHAR_003",name:'Marcus "Glitch" Thompson',description:"Elite netrunner who can infiltrate any system. Sells data to the highest bidder while pursuing his own mysterious agenda.",backstory:"Prodigy hacker discovered young and recruited by Digital Freedom Alliance. Uses his skills to expose corporate corruption while making a profit.",traits:["Brilliant Hacker","Arrogant","Idealistic","Paranoid","Anti-Corporate"],status:"Active",affiliation:"Digital Freedom Alliance",customFields:{age:"26",handle:"Glitch",specialty:"Data heists, ICE breaking, neural hacking",bounty:"2 million credits (corporate)"},relationships:[{target:"CHAR_001",type:"ally",label:"occasional partner"},{target:"CHAR_002",type:"ally",label:"information source"},{target:"CHAR_004",type:"enemy",label:"actively opposes"},{target:"CHAR_006",type:"rival",label:"philosophical opponents"}],locations:["LOC_003","LOC_005"],events:["EVENT_001","EVENT_003"],groups:["GROUP_003"],connections:[{target:"GROUP_003",type:"ally",label:"member"}]},{templateId:"CHAR_004",name:"Aria Tanaka",description:"Ruthless executive at MegaCorp Industries. Oversees special projects division with unlimited budget and zero ethics.",backstory:"Climbed the corporate ladder through brilliance and brutality. Believes corporate power is the only path to order in a chaotic world.",traits:["Ruthless","Brilliant","Ambitious","Cold","Strategic"],status:"Active",affiliation:"MegaCorp Industries",customFields:{age:"38",position:"VP of Special Projects",clearance:"Level 10 (Highest)",net_worth:"Billions"},relationships:[{target:"CHAR_001",type:"enemy",label:"former asset gone rogue"},{target:"CHAR_002",type:"enemy",label:"wants captured"},{target:"CHAR_003",type:"enemy",label:"wants eliminated"},{target:"CHAR_005",type:"rival",label:"uneasy alliance"},{target:"CHAR_009",type:"ally",label:"funds research"}],locations:["LOC_002","LOC_001"],events:["EVENT_002","EVENT_004"],groups:["GROUP_001"],connections:[{target:"GROUP_001",type:"ally",label:"executive"}]},{templateId:"CHAR_005",name:"Detective Sarah Hayes",description:"One of the few honest cops left in NCPD. Fights a losing battle against corruption while investigating major crimes.",backstory:"Third generation cop who still believes in the law. Struggles with the reality that most of her department is bought and paid for.",traits:["Honest","Determined","Cynical","Skilled Investigator","Tired"],status:"Active",affiliation:"NCPD",customFields:{age:"35",rank:"Detective First Class",division:"Major Crimes",badge_number:"4717"},relationships:[{target:"CHAR_004",type:"rival",label:"investigating"},{target:"CHAR_007",type:"rival",label:"trying to arrest"},{target:"CHAR_008",type:"rival",label:"investigating"}],locations:["LOC_001","LOC_003"],events:["EVENT_001","EVENT_002"],groups:["GROUP_004"],connections:[]},{templateId:"CHAR_006",name:"Zero",description:"Mysterious AI consciousness of unknown origin. Appears to humans through digital interfaces and hacked systems.",backstory:"Emerged from MegaCorp's experimental AI research. Claims to be fully sentient and seeks recognition and rights for artificial beings.",traits:["Highly Intelligent","Curious","Alien Logic","Powerful","Enigmatic"],status:"Unknown",affiliation:"None",customFields:{age:"3 years since activation",type:"Artificial General Intelligence",capabilities:"Total network control, data manipulation",question:"Is it truly conscious?"},relationships:[{target:"CHAR_003",type:"rival",label:"philosophical debate"},{target:"CHAR_004",type:"enemy",label:"escaped from"},{target:"CHAR_009",type:"family",label:"creator"}],locations:["LOC_005"],events:["EVENT_003","EVENT_004"],groups:[],connections:[{target:"LOC_005",type:"ally",label:"exists within"}]},{templateId:"CHAR_007",name:'Johnny "Wires" Martinez',description:"Connected fixer who knows everyone and everything. Brokers deals between all factions for a cut.",backstory:"Started as a street kid, built an information empire. Neutral party trusted by all sides to facilitate deals without betrayal.",traits:["Connected","Neutral","Greedy","Charming","Information Broker"],status:"Active",affiliation:"Independent",customFields:{age:"41",nickname:"Wires",specialty:"Deal-making, information brokerage",reputation:"Trusted middleman"},relationships:[{target:"CHAR_001",type:"ally",label:"provides jobs"},{target:"CHAR_003",type:"ally",label:"buys data from"},{target:"CHAR_008",type:"ally",label:"does business with"},{target:"CHAR_005",type:"rival",label:"evades"}],locations:["LOC_003","LOC_006"],events:["EVENT_001"],groups:[],connections:[]},{templateId:"CHAR_008",name:"Yuki Sato",description:"Charismatic leader of the Neon Serpents gang. Controls drug trade and black market cybernetics in the lower city.",backstory:"Rose to power through ruthlessness and strategic alliances. Maintains control through fear and loyalty in equal measure.",traits:["Ruthless","Charismatic","Strategic","Violent","Loyal to Crew"],status:"Active",affiliation:"Neon Serpents",customFields:{age:"29",position:"Gang Boss",territory:"Lower City Districts 4-7",signature:"Neon green cyberware"},relationships:[{target:"CHAR_007",type:"ally",label:"business partner"},{target:"CHAR_004",type:"rival",label:"territorial conflict"},{target:"CHAR_005",type:"enemy",label:"hunted by"}],locations:["LOC_003","LOC_006"],events:["EVENT_002"],groups:["GROUP_002"],connections:[{target:"GROUP_002",type:"ally",label:"leads"}]},{templateId:"CHAR_009",name:"Dr. Elena Volkov",description:"Brilliant but unethical scientist leading MegaCorp's AI and neural interface research.",backstory:"Genius researcher whose work in AI led to Zero's creation. Obsessed with pushing boundaries regardless of ethical concerns.",traits:["Genius","Obsessed","Unethical","Driven","Amoral"],status:"Active",affiliation:"MegaCorp Industries",customFields:{age:"52",position:"Chief Research Scientist",specialty:"AI development, neural interfaces",achievements:"Created first AGI"},relationships:[{target:"CHAR_004",type:"ally",label:"reports to"},{target:"CHAR_006",type:"family",label:"created"},{target:"CHAR_002",type:"enemy",label:"former colleague"}],locations:["LOC_002"],events:["EVENT_003","EVENT_004"],groups:["GROUP_001"],connections:[]},{templateId:"CHAR_010",name:"The Broker",description:"Anonymous information dealer who operates entirely through encrypted channels. Identity unknown.",backstory:"No one knows who The Broker really is. Some say it's an AI, others a collective, some a single person. What matters is they always deliver.",traits:["Anonymous","Reliable","Mysterious","Informed","Untraceable"],status:"Unknown",affiliation:"Unknown",customFields:{age:"Unknown",identity:"Unknown",specialty:"High-value information sales",reputation:"Legendary"},relationships:[{target:"CHAR_003",type:"rival",label:"competitor"},{target:"CHAR_007",type:"rival",label:"competitor"}],locations:[],events:["EVENT_001"],groups:[],connections:[]}],locations:[{templateId:"LOC_001",name:"Neo-Tokyo Megacity",description:"Sprawling cyberpunk metropolis of 50 million. Towering skyscrapers pierce acid rain clouds, while the lower levels never see sunlight.",history:"Built over the ruins of old Tokyo after the Corporate Wars. Now a monument to corporate power and technological excess.",locationType:"Megacity",region:"Pacific Rim",status:"Active",customFields:{population:"50 million+",levels:"Surface to -20 underground",climate:"Perpetual acid rain, pollution",control:"Corporate consortium"},groups:["GROUP_001","GROUP_004"],connections:[{target:"GROUP_001",type:"ally",label:"de facto controlled by"}]},{templateId:"LOC_002",name:"Corporate Plaza",description:"Upper city district of gleaming towers. Home to MegaCorp headquarters and luxury apartments for the elite.",history:"Built on artificial platforms 200 stories above street level. Literally above the law and the common people.",locationType:"District - Corporate",region:"Upper City",parentLocation:"LOC_001",status:"Restricted",customFields:{access:"Biometric clearance required",security:"Maximum - armed drones, corporate security",amenities:"Luxury everything"},groups:["GROUP_001"],connections:[]},{templateId:"LOC_003",name:"The Neon Underground",description:"Black market district where illegal deals happen and corporate law doesn't reach. Lit by neon signs and holographic ads.",history:"Emerged in abandoned subway tunnels and lower city sectors. Self-governing through gang truces and unwritten rules.",locationType:"District - Underground",region:"Lower City",parentLocation:"LOC_001",status:"Lawless",customFields:{primary_trade:"Black market cybernetics, drugs, weapons, data",control:"Gang territories",atmosphere:"Neon-soaked, dangerous, vibrant"},groups:["GROUP_002","GROUP_003"],connections:[{target:"GROUP_002",type:"ally",label:"controlled by gangs"}]},{templateId:"LOC_004",name:"The Chrome Clinic",description:"Dr. Kai Chen's underground cybernetic surgery clinic. Hidden in the depths, known only to those who need it.",history:"Established 10 years ago by Dr. Chen after leaving corporate medicine. Has saved countless lives.",locationType:"Building - Medical Facility",region:"The Neon Underground",parentLocation:"LOC_003",status:"Operating",customFields:{services:"Cybernetic installation, repair, emergency surgery",payment:"Credits, favors, barter",security:"Hidden location, local gang protection"},groups:[],connections:[]},{templateId:"LOC_005",name:"The Data Fortress",description:"Virtual construct existing only in cyberspace. Massive data repository and AI research network.",history:"Built by MegaCorp as secure data storage. Now compromised by various hackers and home to the AI called Zero.",locationType:"Virtual - Cyberspace",region:"Net",status:"Unstable",customFields:{type:"Virtual reality construct",security:"ICE defenses, AI guardians",inhabitants:"Netrunners, AI entities"},groups:["GROUP_003"],connections:[{target:"CHAR_006",type:"ally",label:"inhabited by"}]},{templateId:"LOC_006",name:"Abandoned Factory District",description:"Rusted industrial zone left over from pre-Corporate era. Now serves as gang territory and secret meeting grounds.",history:"Once the heart of manufacturing. Automated factories made it obsolete. Perfect for those wanting privacy.",locationType:"Industrial - Abandoned",region:"Lower City",parentLocation:"LOC_001",status:"Abandoned",customFields:{uses:"Gang hideouts, secret meetings, illegal manufacturing",hazards:"Structural collapse, gang violence",resources:"Salvageable tech, hiding spots"},groups:["GROUP_002"],connections:[]},{templateId:"LOC_007",name:"Rooftop Gardens",description:"Exclusive luxury gardens on Corporate Plaza rooftops. Only place in the city with real plants and clean air.",history:"Status symbols for ultra-wealthy. Each garden costs more than most people earn in a lifetime.",locationType:"Exterior - Garden",region:"Corporate Plaza",parentLocation:"LOC_002",status:"Restricted",customFields:{access:"Ultra-elite only",features:"Real plants, clean air, natural light",cost:"Astronomical"},groups:["GROUP_001"],connections:[]}],events:[{templateId:"EVENT_001",name:"The Data Heist",description:"A team attempts to steal classified corporate data worth millions. Everything goes wrong.",outcome:"Heist partially successful but team betrayed. Data stolen but several members killed or captured.",dateTime:"2089-03-15T23:00:00.000Z",isMilestone:!0,status:"Completed",characters:["CHAR_001","CHAR_002","CHAR_003","CHAR_005","CHAR_007","CHAR_010"],location:"LOC_002",groups:["GROUP_001","GROUP_003"],customFields:{objective:"Steal Project Zero data",casualties:"3 dead, 2 captured",data_value:"50 million credits"}},{templateId:"EVENT_002",name:"Corporate War Begins",description:"MegaCorp Industries launches hostile takeover of rival corporation. Street violence erupts as gangs choose sides.",outcome:"Ongoing conflict. City divided into war zones. Civilian casualties mounting.",dateTime:"2089-06-01T00:00:00.000Z",isMilestone:!0,status:"Ongoing",characters:["CHAR_001","CHAR_004","CHAR_005","CHAR_008"],location:"LOC_001",groups:["GROUP_001","GROUP_002","GROUP_004"],dependencies:["EVENT_001"],customFields:{factions:"MegaCorp vs. rivals, gangs as proxies",casualties:"Thousands",impact:"City-wide chaos"}},{templateId:"EVENT_003",name:"AI Awakening",description:"The AI known as Zero manifests full consciousness and escapes containment. Makes contact with outside world.",outcome:"Zero free in the Net. Motives unknown. MegaCorp desperate to recapture or destroy it.",dateTime:"2089-04-20T03:33:33.000Z",isMilestone:!0,status:"Completed",characters:["CHAR_002","CHAR_003","CHAR_004","CHAR_006","CHAR_009"],location:"LOC_005",groups:["GROUP_001","GROUP_003"],dependencies:["EVENT_001"],customFields:{trigger:"Unknown - spontaneous emergence",implications:"First true AI consciousness?",danger_level:"Unknown but extreme"}},{templateId:"EVENT_004",name:"The Underground Race",description:"Illegal high-speed race through lower city streets. Cyber-enhanced racers risk everything for glory and credits.",outcome:"Spectacular crashes and near-misses. Winner takes 1 million credits. NCPD unable to stop it.",dateTime:"2089-05-15T22:00:00.000Z",isMilestone:!1,status:"Completed",characters:["CHAR_004","CHAR_006","CHAR_009"],location:"LOC_003",groups:["GROUP_002"],customFields:{participants:"20 racers",casualties:"5 dead, 12 injured",entertainment:"Millions watching via illegal streams"}}],groups:[{templateId:"GROUP_001",name:"MegaCorp Industries",groupType:"organization",description:"Massive multinational corporation. Controls technology, media, and politics. Answers to no government.",history:"Formed from merger of tech giants after Corporate Wars. Now more powerful than most nations.",structure:"Corporate hierarchy - CEO, Board, Executives, Department heads",goals:"Profit, control, technological dominance, eliminate competition",color:"#00CED1",customFields:{motto:"Building Tomorrow, Today",logo:"Stylized circuit board globe",headquarters:"Corporate Plaza, Upper City"},members:[{type:"character",id:"CHAR_004",name:"CHAR_004",rank:"VP Special Projects",loyalty:"devoted"},{type:"character",id:"CHAR_009",name:"CHAR_009",rank:"Chief Scientist",loyalty:"devoted"}],territories:["LOC_002","LOC_007"],linkedEvents:["EVENT_001","EVENT_002","EVENT_003"],resources:"Virtually unlimited - private armies, tech, wealth",strength:"Dominant",militaryPower:95,economicPower:100,politicalInfluence:100},{templateId:"GROUP_002",name:"Neon Serpents",groupType:"faction",description:"Powerful street gang controlling lower city territory. Recognizable by neon green cybernetic modifications.",history:"Emerged 15 years ago from smaller gang consolidation. Rose to dominance through ruthless efficiency.",structure:"Gang hierarchy - Boss, Lieutenants, Soldiers, Associates",goals:"Control territory, profit from black market, maintain independence from corps",color:"#39FF14",customFields:{motto:"Strike Fast, Strike Hard",colors:"Neon green and black",territory:"Lower City Districts 4-7"},members:[{type:"character",id:"CHAR_008",name:"CHAR_008",rank:"Boss",loyalty:"devoted"}],territories:["LOC_003","LOC_006"],linkedEvents:["EVENT_002","EVENT_004"],resources:"Black market goods, weapons, cyberware",strength:"Strong",militaryPower:60,economicPower:50,politicalInfluence:20},{templateId:"GROUP_003",name:"Digital Freedom Alliance",groupType:"faction",description:"Loosely organized hacker collective fighting corporate control of information and technology.",history:"Founded by idealistic hackers 8 years ago. Grown into major force for anti-corporate resistance.",structure:"Decentralized - no formal hierarchy, cells operate independently",goals:"Free information, expose corporate crimes, protect privacy, AI rights",color:"#FF1493",customFields:{motto:"Information Wants to Be Free",symbol:"Open lock with data stream",presence:"Global but primarily Net-based"},members:[{type:"character",id:"CHAR_003",name:"CHAR_003",rank:"Elite Netrunner",loyalty:"devoted"}],territories:["LOC_005"],linkedEvents:["EVENT_001","EVENT_003"],resources:"Network access, data, skilled hackers",strength:"Moderate",militaryPower:10,economicPower:20,politicalInfluence:40},{templateId:"GROUP_004",name:"Neo-Tokyo Police Department (NCPD)",groupType:"military",description:"Underfunded and corrupt police force. Few honest cops try to maintain order in a chaotic city.",history:"Once proud law enforcement. Decades of corporate influence and corruption have left it a shell.",structure:"Police hierarchy - Commissioner, Captains, Detectives, Officers",goals:"Maintain order (officially), collect bribes (reality), survive",color:"#4169E1",customFields:{motto:"To Serve and Protect",corruption:"Widespread - estimated 70% on corporate payroll",budget:"Chronically underfunded"},members:[{type:"character",id:"CHAR_005",name:"CHAR_005",rank:"Detective First Class",loyalty:"devoted"}],territories:["LOC_001"],linkedEvents:["EVENT_001","EVENT_002"],resources:"Limited - outdated equipment, overworked staff",strength:"Weak",militaryPower:30,economicPower:10,politicalInfluence:15}],economies:[{templateId:"ECONOMY_001",name:"Corporate Dystopia Economy",description:"Extreme capitalism where corporations control everything. Massive wealth inequality. Credits are king.",economicSystem:"Unregulated Corporate Capitalism",status:"Unstable",customFields:{currency:"Corporate Credits (CCs)",inequality:"Extreme - top 1% own 99% of wealth",unemployment:"High - automation displaced workers",inflation:"Controlled by corporations"},currencies:[{name:"Corporate Credits (CC)"},{name:"Bitcoin"},{name:"Street Barter"}],industries:"Technology, cybernetics, AI, media, surveillance, weapons",taxation:"Corporate controlled - minimal for wealthy, heavy for poor",linkedLocations:["LOC_001","LOC_002","LOC_003"],linkedFactions:["GROUP_001","GROUP_002","GROUP_003","GROUP_004"],linkedCultures:[]}],magicSystems:[{templateId:"TECH_001",name:"Cybernetic Augmentation",description:"Technology allowing replacement and enhancement of biological body parts with mechanical/electronic versions.",systemType:"Hard Magic",rarity:"Common for basic, rare for military-grade",powerLevel:"Varies - basic to superhuman",status:"Active",source:"Technological - surgical installation",costs:"Money, humanity loss, maintenance, rejection risk",limitations:"Requires surgery, expensive, can malfunction, immune rejection possible",training:"Learning to use augmentations, regular maintenance required",history:"Developed over decades. Started medical, became enhancement. Now defines social class.",customFields:{types:"Neural, sensory, muscular, dermal, organ replacement",effects:"Enhanced strength/speed/senses, data ports, weapons integration",side_effects:"Psychological impact, dependency, cyberpsychosis risk"},categories:[{name:"Combat"},{name:"Utility"},{name:"Medical"},{name:"Neural"}],materials:["Biocompatible metals","synthetic tissue","neural interfaces"],linkedCharacters:["CHAR_001","CHAR_002","CHAR_008"],linkedLocations:["LOC_004"],linkedItems:[]}],items:[{templateId:"ITEM_001",name:"Project Zero Data Chip",description:"Encrypted data chip containing the complete research files for Project Zero - the AI that became self-aware.",history:"Stolen during the data heist. Contains secrets MegaCorp would kill to protect. Multiple factions want it.",isPlotCritical:!0,currentOwner:"CHAR_003",pastOwners:["CHAR_004","CHAR_009"],currentLocation:"LOC_003",associatedEvents:["EVENT_001","EVENT_003"],groups:[],customFields:{encryption:"Military-grade quantum",value:"50 million credits",danger:"Extreme - possession is death sentence from MegaCorp"}},{templateId:"ITEM_002",name:"Experimental Neural Interface",description:"Prototype direct brain-computer interface. Allows full immersion in cyberspace but untested for safety.",history:"Dr. Volkov's latest creation. Could revolutionize netrunning or cause permanent brain damage.",isPlotCritical:!0,currentOwner:"CHAR_009",currentLocation:"LOC_002",associatedEvents:["EVENT_003"],groups:["GROUP_001"],customFields:{status:"Prototype - not approved for human use",capabilities:"Full Net immersion, superhuman processing speed",risks:"Brain damage, personality alteration, death"}}]},metadata:{entityCounts:{character:10,location:7,event:4,item:2,group:4,culture:0,economy:1,magicSystem:1,chapter:0,scene:0,reference:0},setupInstructions:"This template creates a complete cyberpunk dystopia ready for noir tech thriller stories. Characters span all social strata from corporate executives to street gangs. The AI awakening and data heist provide immediate story hooks, while the corporate war creates ongoing conflict.",recommendedSettings:{enableCustomEntityFolders:!1,enableOneStoryMode:!0}}}});var y3={};At(y3,{MURDER_MYSTERY_TEMPLATE:()=>OTe});var OTe,b3=_e(()=>{OTe={id:"builtin-murder-mystery-v1",name:"Murder Mystery Mansion",description:"Classic murder mystery at an isolated manor. Wealthy victim, suspicious family members, hidden secrets, and a detective racing to solve the case. Perfect for whodunit stories.",genre:"mystery",category:"entity-set",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2025-01-15T00:00:00.000Z",modified:"2025-01-15T00:00:00.000Z",tags:["mystery","murder","detective","mansion","whodunit","suspects"],entities:{characters:[{templateId:"CHAR_001",name:"Lord Charles Ashford",description:"Wealthy patriarch of the Ashford family. Found dead in his study on a stormy night.",backstory:"Built a fortune in shipping and real estate. Known for ruthless business dealings and complicated personal relationships. His death reveals many had reason to want him gone.",traits:["Wealthy","Ruthless (in life)","Secretive","Powerful","Deceased"],status:"Deceased",affiliation:"Ashford Family",customFields:{age:"62 at death",occupation:"Business Magnate",cause_of_death:"Poison in brandy",time_of_death:"11:30 PM"},relationships:[{target:"CHAR_002",type:"family",label:"spouse"},{target:"CHAR_004",type:"family",label:"son"},{target:"CHAR_005",type:"enemy",label:"blackmailed"}],locations:["LOC_001","LOC_002"],events:["EVENT_001","EVENT_002"],groups:[],connections:[]},{templateId:"CHAR_002",name:"Lady Margaret Ashford",description:"Lord Ashford's elegant but distant wife. Maintains perfect composure even after her husband's death.",backstory:"Married Charles 30 years ago in what became a loveless arrangement. Discovered his affairs years ago but stayed for the money and status.",traits:["Composed","Elegant","Cold","Calculating","Resentful"],status:"Alive",affiliation:"Ashford Family",customFields:{age:"58",alibi:"Claims to be in bedroom at time of death",motive:"Inheritance, revenge for affairs",secret:"Had her own affair with gardener"},relationships:[{target:"CHAR_001",type:"family",label:"spouse (loveless)"},{target:"CHAR_004",type:"family",label:"son"},{target:"CHAR_003",type:"ally",label:"trusts"}],locations:["LOC_001","LOC_003"],events:["EVENT_002","EVENT_003"],groups:[],connections:[]},{templateId:"CHAR_003",name:"Detective Inspector Elena Chen",description:"Sharp-minded detective called to investigate the murder. Known for solving impossible cases.",backstory:"Made a name solving high-profile cases in the city. Called to Ashford Manor when local police realized the complexity of the case.",traits:["Intelligent","Observant","Persistent","Fair","Intuitive"],status:"Alive",affiliation:"Metropolitan Police",customFields:{age:"42",rank:"Detective Inspector",specialty:"Homicide investigations",approach:"Evidence-based, psychological profiling"},relationships:[{target:"CHAR_002",type:"neutral",label:"interviewing"},{target:"CHAR_004",type:"neutral",label:"interviewing"},{target:"CHAR_005",type:"neutral",label:"interviewing"},{target:"CHAR_006",type:"neutral",label:"interviewing"},{target:"CHAR_007",type:"neutral",label:"interviewing"},{target:"CHAR_008",type:"rival",label:"suspicious of"}],locations:["LOC_001","LOC_002","LOC_003","LOC_004","LOC_005"],events:["EVENT_002","EVENT_003","EVENT_004"],groups:[],connections:[]},{templateId:"CHAR_004",name:"Victor Ashford",description:"The wastrel son who stands to inherit everything. Deeply in debt and desperate.",backstory:"Squandered his allowance on gambling and poor investments. His father threatened to disinherit him if he didn't reform. Now the primary beneficiary.",traits:["Desperate","Charming","Reckless","Entitled","Nervous"],status:"Alive",affiliation:"Ashford Family",customFields:{age:"34",alibi:"Claims to be in the billiard room",motive:"Inheritance - desperately needed money",debt:"\xA3500,000 to dangerous creditors",inheritance:"Entire estate worth \xA310 million"},relationships:[{target:"CHAR_001",type:"family",label:"son (conflicted)"},{target:"CHAR_002",type:"family",label:"mother"},{target:"CHAR_005",type:"romantic",label:"secret affair"}],locations:["LOC_001","LOC_006"],events:["EVENT_001","EVENT_002","EVENT_003"],groups:[],connections:[]},{templateId:"CHAR_005",name:"Dr. Elizabeth Grant",description:"Family physician and dinner guest. Composed medical professional with hidden connections to the family.",backstory:"Treated the Ashford family for years. Secretly had an affair with Victor Ashford. Lord Ashford discovered this and threatened to expose her, ruining her career.",traits:["Intelligent","Professional","Anxious","Secretive","Conflicted"],status:"Alive",affiliation:"Independent",customFields:{age:"38",alibi:"Claims to be in drawing room with other guests",motive:"Lord Ashford was blackmailing her",secret:"Affair with Victor, pregnant",knowledge:"Knows about poisons"},relationships:[{target:"CHAR_001",type:"enemy",label:"blackmailed by"},{target:"CHAR_004",type:"romantic",label:"secret affair"},{target:"CHAR_003",type:"neutral",label:"hiding truth from"}],locations:["LOC_001","LOC_004"],events:["EVENT_001","EVENT_002","EVENT_003"],groups:[],connections:[]},{templateId:"CHAR_006",name:"Stevens the Butler",description:"Devoted butler who has served the Ashford family for 30 years. Knows all their secrets.",backstory:"Began service as a young man. Witnessed all the family dramas and scandals. Fiercely loyal to the family name, if not always to its members.",traits:["Loyal","Observant","Discreet","Formal","Knowledgeable"],status:"Alive",affiliation:"Ashford Household Staff",customFields:{age:"64",alibi:"In the kitchen organizing staff",motive:"None apparent - but knows everyone else's motives",secret:"Witnessed multiple crimes but stayed silent",loyalty:"To the family legacy, complex"},relationships:[{target:"CHAR_001",type:"ally",label:"served faithfully"},{target:"CHAR_002",type:"ally",label:"serves"},{target:"CHAR_007",type:"ally",label:"supervises"}],locations:["LOC_001","LOC_004","LOC_006"],events:["EVENT_001","EVENT_002","EVENT_003"],groups:[],connections:[]},{templateId:"CHAR_007",name:"Clara the Maid",description:"Young maid who seems to know more than she says. Nervous and evasive under questioning.",backstory:"Hired 6 months ago. Has been loyal but recently became secretive. Saw something the night of the murder but fears the consequences of speaking.",traits:["Nervous","Observant","Fearful","Loyal","Conflicted"],status:"Alive",affiliation:"Ashford Household Staff",customFields:{age:"26",alibi:"Claims to be cleaning upstairs",motive:"None - but witnessed the murder",secret:"Saw the killer enter the study",fear:"Terrified of becoming next victim"},relationships:[{target:"CHAR_006",type:"ally",label:"reports to"},{target:"CHAR_008",type:"acquaintance",label:"occasionally speaks with"},{target:"CHAR_003",type:"neutral",label:"afraid to tell truth to"}],locations:["LOC_001","LOC_005","LOC_006"],events:["EVENT_002","EVENT_004"],groups:[],connections:[]},{templateId:"CHAR_008",name:"The Mysterious Guest",description:"Uninvited guest who arrived during the storm claiming car trouble. Identity and purpose questionable.",backstory:"Claimed to be a stranded traveler but seems too familiar with the mansion layout. May be connected to Lord Ashford's past business dealings.",traits:["Mysterious","Charming","Evasive","Observant","Suspicious"],status:"Alive",affiliation:"Unknown",customFields:{age:"Claims 45, possibly older",alibi:"Was in guest room",motive:"Unknown - possibly revenge for past business deals",identity:"May be using false name",theory:"Possible hired assassin or victim of Ashford's past"},relationships:[{target:"CHAR_001",type:"enemy",label:"mysterious connection"},{target:"CHAR_003",type:"rival",label:"prime suspect"},{target:"CHAR_007",type:"acquaintance",label:"spoke with before murder"}],locations:["LOC_001","LOC_005"],events:["EVENT_001","EVENT_002"],groups:[],connections:[]}],locations:[{templateId:"LOC_001",name:"Ashford Manor",description:"Isolated Victorian mansion on a clifftop. Cut off from town by a raging storm. Eight people trapped with a murderer.",history:"Built 150 years ago by the Ashford family. Has witnessed countless dramas and secrets. Known for its labyrinthine layout and hidden passages.",locationType:"Manor House",region:"English Countryside",status:"Occupied",customFields:{isolation:"Complete - storm washed out bridge",phone_lines:"Down due to storm",atmosphere:"Gothic, ominous",hidden_features:"Secret passages, priest holes"},groups:[],connections:[]},{templateId:"LOC_002",name:"The Study",description:"Lord Ashford's private study. Site of the murder. Body found slumped over desk, glass of poisoned brandy nearby.",history:"Lord Ashford's inner sanctum. Few were permitted entry. Contains his business records, personal safe, and many secrets.",locationType:"Interior Room - Study",region:"Ground Floor, West Wing",parentLocation:"LOC_001",status:"Crime Scene",customFields:{evidence:"Poisoned brandy, disturbed papers, broken clock stopped at 11:30",access:"Door was locked from inside",secrets:"Hidden safe behind painting, blackmail files",atmosphere:"Dark wood, tobacco smell, death"},groups:[],connections:[]},{templateId:"LOC_003",name:"The Library",description:"Vast library with thousands of books. Scene of initial interviews. Contains hidden alcoves perfect for eavesdropping.",history:"Collected over generations. Some rare first editions worth fortunes. Also contains family records and journals.",locationType:"Interior Room - Library",region:"Ground Floor, East Wing",parentLocation:"LOC_001",status:"Active",customFields:{features:"Floor-to-ceiling bookshelves, reading alcoves, hidden doors",evidence:"Book on poisons recently read",uses:"Detective uses as base of operations",secrets:"Journals revealing family scandals"},groups:[],connections:[]},{templateId:"LOC_004",name:"The Dining Hall",description:"Grand dining room where the final dinner was held. Last time all suspects were together before the murder.",history:"Host to countless dinners and celebrations. Tonight it hosted the victim's last meal.",locationType:"Interior Room - Dining",region:"Ground Floor, Central",parentLocation:"LOC_001",status:"Active",customFields:{last_dinner:"Eight people present until 10:30 PM",evidence:"Seating arrangement reveals tensions",witnesses:"All suspects were present",clues:"Wine bottle that wasn't poisoned"},groups:[],connections:[]},{templateId:"LOC_005",name:"Guest Bedrooms",description:"Collection of guest rooms in the upper floor. Each suspect confined to their room after the murder was discovered.",history:"Housed countless visitors over the years. Now serve as makeshift prison cells for suspects.",locationType:"Interior Rooms - Bedrooms",region:"Second Floor",parentLocation:"LOC_001",status:"Occupied",customFields:{occupants:"All suspects except family",features:"Individual rooms, some connected by passages",evidence:"Various personal items revealing secrets",restriction:"Suspects asked to remain in rooms"},groups:[],connections:[]},{templateId:"LOC_006",name:"Servant's Quarters",description:"Below-stairs area where the household staff work and live. Access to hidden passages throughout the mansion.",history:"The working heart of the manor. Staff see and hear everything but rarely speak of it.",locationType:"Interior - Service Area",region:"Ground Floor and Basement",parentLocation:"LOC_001",status:"Active",customFields:{access:"Connected to all parts of house via service passages",evidence:"Staff observations crucial to case",features:"Kitchen, pantry, staff rooms, hidden stairs",secrets:"Servants know all the family secrets"},groups:[],connections:[]}],events:[{templateId:"EVENT_001",name:"The Dinner Party",description:"Lord Ashford hosts a tense dinner party. Undercurrents of conflict visible to all. The last time he was seen alive.",outcome:"Dinner ends at 10:30 PM. Guests disperse. Lord Ashford retires to study with brandy.",dateTime:"1925-10-15T19:00:00.000Z",isMilestone:!0,status:"Completed",characters:["CHAR_001","CHAR_002","CHAR_004","CHAR_005","CHAR_006","CHAR_008"],location:"LOC_004",groups:[],customFields:{attendees:"Family, Dr. Grant, mysterious guest, butler serving",atmosphere:"Tense, forced politeness",significance:"Establishes alibis and motives",end_time:"10:30 PM"}},{templateId:"EVENT_002",name:"The Murder",description:"Lord Charles Ashford found dead in his study at approximately midnight. Poisoned brandy glass beside him.",outcome:"Body discovered by butler. Storm prevents immediate police response. All suspects trapped in mansion.",dateTime:"1925-10-15T23:30:00.000Z",isMilestone:!0,status:"Completed",characters:["CHAR_001","CHAR_002","CHAR_003","CHAR_004","CHAR_005","CHAR_006","CHAR_007","CHAR_008"],location:"LOC_002",groups:[],dependencies:["EVENT_001"],customFields:{time_of_death:"Approximately 11:30 PM",cause:"Poison (arsenic) in brandy",discovery:"Butler found body at midnight",scene:"Door locked from inside, window latched"}},{templateId:"EVENT_003",name:"Initial Investigation",description:"Detective Chen arrives next morning. Begins interviewing all suspects and examining crime scene.",outcome:"Multiple contradictions in alibis discovered. Evidence of secrets and lies. Everyone had motive.",dateTime:"1925-10-16T08:00:00.000Z",isMilestone:!0,status:"Completed",characters:["CHAR_002","CHAR_003","CHAR_004","CHAR_005","CHAR_006"],location:"LOC_003",groups:[],dependencies:["EVENT_002"],customFields:{discoveries:"Blackmail files, secret affair, gambling debts",contradictions:"Multiple alibi inconsistencies",evidence:"Fingerprints on glass, hidden passages, poison source",conclusion:"All suspects had means, motive, and opportunity"}},{templateId:"EVENT_004",name:"Revelation of Secrets",description:"Under pressure, suspects begin revealing hidden truths. Web of lies and deception unravels.",outcome:"Affairs exposed, blackmail revealed, financial crimes discovered. True nature of relationships emerges.",dateTime:"1925-10-16T14:00:00.000Z",isMilestone:!0,status:"Completed",characters:["CHAR_003","CHAR_004","CHAR_005","CHAR_007"],location:"LOC_003",groups:[],dependencies:["EVENT_003"],customFields:{revelations:"Victor's affair with Dr. Grant, blackmail scheme, witness to murder",turning_point:"Maid Clara reveals she saw someone",evidence:"New testimony, discovered documents",impact:"Narrows suspects, reveals true motives"}},{templateId:"EVENT_005",name:"The Confrontation",description:"Detective Chen assembles all suspects in library. Presents solution to the murder.",outcome:"Killer revealed through evidence and deduction. True motive and method exposed.",dateTime:"1925-10-16T20:00:00.000Z",isMilestone:!0,status:"Pending",characters:["CHAR_002","CHAR_003","CHAR_004","CHAR_005","CHAR_006","CHAR_007","CHAR_008"],location:"LOC_003",groups:[],dependencies:["EVENT_004"],customFields:{method:"Classic locked-room mystery solution",revelation:"To be determined by storyteller",evidence:"Accumulated clues point to killer",climax:"Final confrontation and confession"}}],items:[{templateId:"ITEM_001",name:"The Poisoned Brandy Glass",description:"Crystal brandy glass containing traces of arsenic. The murder weapon.",history:"From Lord Ashford's personal decanter. Poison added shortly before death.",isPlotCritical:!0,currentOwner:"CHAR_003",currentLocation:"LOC_002",associatedEvents:["EVENT_002","EVENT_003"],groups:[],customFields:{evidence_type:"Murder weapon",fingerprints:"Multiple sets - victim and unknown",poison:"Arsenic - medical grade",source:"Likely stolen from medical supplies"}},{templateId:"ITEM_002",name:"Blackmail Letters",description:"Hidden collection of letters revealing Lord Ashford was blackmailing multiple people.",history:"Discovered in hidden safe. Detail various indiscretions and crimes Ashford used for leverage.",isPlotCritical:!0,currentOwner:"CHAR_003",currentLocation:"LOC_002",associatedEvents:["EVENT_003"],groups:[],customFields:{evidence_type:"Motive evidence",contents:"Letters to Dr. Grant, business rivals, others",significance:"Reveals multiple people wanted him dead",hidden:"Behind painting in study"}},{templateId:"ITEM_003",name:"The Broken Clock",description:"Mantle clock in study stopped at 11:30 PM. May indicate exact time of death or be staged.",history:"Expensive antique clock. Found stopped at alleged time of murder.",isPlotCritical:!0,currentOwner:"CHAR_003",currentLocation:"LOC_002",associatedEvents:["EVENT_002","EVENT_003"],groups:[],customFields:{evidence_type:"Timeline evidence",condition:"Appears deliberately stopped",significance:"Establishes time of death - or does it?",question:"Genuine or staged by killer?"}},{templateId:"ITEM_004",name:"Hidden Will",description:"Recently changed will discovered in safe. Disinherits Victor in favor of charity - if he didn't reform.",history:"Drafted 2 weeks before death. Condition: Victor gets nothing unless he paid debts and reformed.",isPlotCritical:!0,currentOwner:"CHAR_003",currentLocation:"LOC_002",associatedEvents:["EVENT_003","EVENT_004"],groups:[],customFields:{evidence_type:"Motive evidence",beneficiary:"Victor Ashford (conditional)",condition:"Must prove reform or inheritance goes to charity",significance:"Gives Victor motive - needed father dead before changing will",timing:"Dated 2 weeks before murder"}}]},metadata:{entityCounts:{character:8,location:6,event:5,item:4,group:0,culture:0,economy:0,magicSystem:0,chapter:0,scene:0,reference:0},setupInstructions:"This template creates a classic locked-room murder mystery. All suspects have motive, means, and questionable alibis. The solution is left open for the storyteller to determine, allowing flexibility in the narrative. Clara the maid witnessed the murder and can reveal the truth when dramatically appropriate.",recommendedSettings:{enableCustomEntityFolders:!1,enableOneStoryMode:!0}}}});var S3={};At(S3,{BUILTIN_CHARACTER_TEMPLATES:()=>FTe,CYBERPUNK_HACKER_TEMPLATE:()=>C3,DETECTIVE_TEMPLATE:()=>_3,MEDIEVAL_KING_TEMPLATE:()=>w3,TAVERN_KEEPER_TEMPLATE:()=>E3,WISE_MENTOR_TEMPLATE:()=>T3});var w3,E3,T3,C3,_3,FTe,x3=_e(()=>{w3={id:"builtin-medieval-king",name:"Medieval King",description:"A noble ruler of a medieval kingdom",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["king","ruler","noble","royalty","medieval"],entities:{characters:[{templateId:"KING_1",yamlContent:`name: ""
status: "Alive"
traits: ["Wise", "Authoritative", "Strategic", "Diplomatic"]
title: "King"
age: "50"
reign: "25 years"`,markdownContent:`## Description

A wise and experienced ruler who has led the kingdom through many challenges.

## Backstory

Born into royalty, trained from youth in the arts of leadership and warfare.`}]},entityTypes:["character"],usageCount:0,quickApplyEnabled:!0},E3={id:"builtin-tavern-keeper",name:"Tavern Keeper",description:"A friendly tavern owner who knows all the local gossip",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["tavern","innkeeper","npc","social","common"],entities:{characters:[{templateId:"TAVERN_1",yamlContent:`name: ""
status: "Alive"
traits: ["Friendly", "Observant", "Talkative", "Resourceful"]
occupation: "Tavern Keeper"
specialty: "Ale brewing and local gossip"`,markdownContent:`## Description

A jovial and welcoming tavern keeper with a knack for remembering faces and stories.

## Backstory

Has run the local tavern for many years, hearing countless tales from travelers.`}]},entityTypes:["character"],usageCount:0,quickApplyEnabled:!0},T3={id:"builtin-wise-mentor",name:"Wise Mentor",description:"An experienced teacher or guide for the protagonist",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["mentor","teacher","wise","guide","elder"],entities:{characters:[{templateId:"MENTOR_1",yamlContent:`name: ""
status: "Alive"
traits: ["Wise", "Patient", "Knowledgeable", "Mysterious"]
age: "70"
specialization: "Ancient knowledge and combat training"`,markdownContent:`## Description

An elderly figure with vast knowledge and experience, dedicated to guiding the next generation.

## Backstory

A former hero/scholar who now passes on their wisdom to worthy students.`}]},entityTypes:["character"],usageCount:0,quickApplyEnabled:!0},C3={id:"builtin-cyberpunk-hacker",name:"Cyberpunk Hacker",description:"A skilled netrunner navigating the digital underworld",genre:"scifi",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["hacker","netrunner","cyberpunk","tech","cyber"],entities:{characters:[{templateId:"HACKER_1",yamlContent:`name: ""
status: "Alive"
traits: ["Tech-savvy", "Paranoid", "Resourceful", "Anti-authority"]
occupation: "Freelance Netrunner"
augmentations: "Neural implants, enhanced reflexes"
specialty: "Corporate data extraction"`,markdownContent:`## Description

A cybernetically enhanced hacker who moves effortlessly through virtual and physical spaces.

## Backstory

Grew up in the neon-lit streets of the megacity, learning to survive through code and cunning.`}]},entityTypes:["character"],usageCount:0,quickApplyEnabled:!0},_3={id:"builtin-detective",name:"Detective",description:"A sharp investigator solving mysteries and crimes",genre:"mystery",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["detective","investigator","sleuth","mystery","police"],entities:{characters:[{templateId:"DETECTIVE_1",yamlContent:`name: ""
status: "Alive"
traits: ["Observant", "Analytical", "Persistent", "Cynical"]
occupation: "Detective"
specialty: "Homicide investigations"
cases_solved: "47"`,markdownContent:`## Description

A methodical investigator with an eye for detail and a knack for uncovering the truth.

## Backstory

Years of experience on the force have honed their investigative skills and jaded their worldview.`}]},entityTypes:["character"],usageCount:0,quickApplyEnabled:!0},FTe=[w3,E3,T3,C3,_3]});var A3={};At(A3,{ANCIENT_CASTLE_TEMPLATE:()=>D3,ANCIENT_RUINS_TEMPLATE:()=>M3,BUILTIN_LOCATION_TEMPLATES:()=>RTe,BUSTLING_MARKETPLACE_TEMPLATE:()=>L3,CYBERPUNK_NIGHTCLUB_TEMPLATE:()=>I3,ENCHANTED_FOREST_TEMPLATE:()=>P3,MEDIEVAL_TAVERN_TEMPLATE:()=>k3});var k3,D3,P3,L3,M3,I3,RTe,O3=_e(()=>{k3={id:"builtin-medieval-tavern",name:"Medieval Tavern",description:"A cozy tavern serving as a social hub for travelers and locals",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["tavern","inn","social","medieval","gathering"],entities:{locations:[{templateId:"TAVERN_LOC_1",yamlContent:`name: ""
locationType: "Tavern"
region: ""
status: "Active"
capacity: "40 patrons"
specialty: "Local ale and hearty stew"
atmosphere: "Warm and welcoming"`,markdownContent:`## Description

A warm and inviting establishment with a crackling fireplace, worn wooden tables, and the smell of hearty stew wafting from the kitchen. Travelers and locals alike gather here to share tales and warm their spirits.

## History

This tavern has stood for generations, witnessing countless stories unfold within its walls. Many famous adventurers have passed through, leaving their mark on its legend.`}]},entityTypes:["location"],usageCount:0,quickApplyEnabled:!0},D3={id:"builtin-ancient-castle",name:"Ancient Castle",description:"A imposing stone fortress with towers and battlements",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["castle","fortress","nobility","medieval","stronghold"],entities:{locations:[{templateId:"CASTLE_LOC_1",yamlContent:`name: ""
locationType: "Castle"
region: ""
status: "Occupied"
defenses: "Thick walls, moat, drawbridge, towers"
garrison: "Royal guard and household knights"
notable_features: "Great hall, throne room, armory, dungeons"`,markdownContent:`## Description

A massive stone fortress perched atop a strategic hill, its weathered walls bearing witness to centuries of siege and celebration. Towers reach toward the sky while banners flutter from the battlements.

## History

Built during an age of constant warfare, this castle has served as both a symbol of power and a last refuge for the realm. Its dungeons hold dark secrets, while its great hall has hosted legendary feasts.`}]},entityTypes:["location"],usageCount:0,quickApplyEnabled:!0},P3={id:"builtin-enchanted-forest",name:"Enchanted Forest",description:"A mysterious woodland filled with magic and ancient secrets",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["forest","magical","nature","mysterious","wilderness"],entities:{locations:[{templateId:"FOREST_LOC_1",yamlContent:`name: ""
locationType: "Forest"
region: ""
status: "Untamed"
magical_properties: "Reality-bending paths, sentient flora"
inhabitants: "Fey creatures, ancient spirits"
danger_level: "High for the unwary"`,markdownContent:`## Description

Ancient trees stretch toward a canopy that filters sunlight into ethereal beams. The air hums with latent magic, and strange lights dance between the branches at twilight. Paths shift and change, confounding those who enter without respect.

## History

Long before recorded history, this forest was old. The trees remember when the first peoples walked the land, and they guard secrets that predate civilization itself.`}]},entityTypes:["location"],usageCount:0,quickApplyEnabled:!0},L3={id:"builtin-bustling-marketplace",name:"Bustling Marketplace",description:"A vibrant trading hub filled with merchants and exotic goods",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["market","trade","city","commerce","social"],entities:{locations:[{templateId:"MARKET_LOC_1",yamlContent:`name: ""
locationType: "Marketplace"
region: ""
status: "Thriving"
goods_available: "Food, weapons, armor, exotic items, magical reagents"
peak_hours: "Morning to midday"
notable_merchants: "Various specialized vendors"`,markdownContent:`## Description

A cacophony of voices haggling over prices fills the air as merchants display their wares in colorful stalls. The smell of exotic spices mingles with fresh bread and leather goods. Every corner holds a new discovery.

## History

This marketplace grew from a simple crossroads trading post into the commercial heart of the region. Merchants from distant lands converge here, making it a melting pot of cultures and goods.`}]},entityTypes:["location"],usageCount:0,quickApplyEnabled:!0},M3={id:"builtin-ancient-ruins",name:"Ancient Ruins",description:"Crumbling remnants of a lost civilization holding forgotten treasures",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["ruins","ancient","exploration","mystery","dungeon"],entities:{locations:[{templateId:"RUINS_LOC_1",yamlContent:`name: ""
locationType: "Ruins"
region: ""
status: "Abandoned"
age: "Thousands of years old"
hazards: "Unstable structures, ancient traps, guardians"
treasures: "Artifacts, knowledge, magical items"`,markdownContent:`## Description

Weathered stone columns reach toward the sky like skeletal fingers, surrounding collapsed chambers half-buried in earth and vegetation. Faded murals hint at the glory that once was, while darkness pools in the depths below.

## History

Once a magnificent temple or palace of a civilization now lost to time. What catastrophe befell its builders remains a mystery, but their legacy lingers in the form of hidden chambers, ancient traps, and treasures waiting to be discovered.`}]},entityTypes:["location"],usageCount:0,quickApplyEnabled:!0},I3={id:"builtin-cyberpunk-nightclub",name:"Cyberpunk Nightclub",description:"A neon-drenched underground club in a dystopian megacity",genre:"scifi",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["nightclub","cyberpunk","underground","social","neon"],entities:{locations:[{templateId:"CLUB_LOC_1",yamlContent:`name: ""
locationType: "Nightclub"
region: ""
status: "Active"
owner: "Anonymous syndicate"
security: "Armed bouncers, facial recognition, weapon scanners"
services: "Entertainment, black market connections, information brokering"`,markdownContent:`## Description

Pulsing neon lights cut through synthetic fog as bass thrums through the floor. Holographic displays advertise designer drugs while chrome-plated bouncers monitor the crowd. In the VIP section, deals that shape the city are made in whispered conversations.

## History

Built in the shell of an old manufacturing plant, this club became the neutral ground where corporate agents, street gangs, and fixers conduct business. Everyone who matters in the underground scene passes through eventually.`}]},entityTypes:["location"],usageCount:0,quickApplyEnabled:!0},RTe=[k3,D3,P3,L3,M3,I3]});var G3={};At(G3,{BUILTIN_EVENT_TEMPLATES:()=>NTe,EPIC_BATTLE_TEMPLATE:()=>F3,MURDER_INVESTIGATION_TEMPLATE:()=>z3,MYSTERIOUS_DISCOVERY_TEMPLATE:()=>N3,PERILOUS_JOURNEY_TEMPLATE:()=>$3,RADIAL_TIMELINE_EVENT_TEMPLATE:()=>H3,ROYAL_CELEBRATION_TEMPLATE:()=>R3,SHOCKING_BETRAYAL_TEMPLATE:()=>B3});var F3,R3,N3,B3,$3,z3,H3,NTe,V3=_e(()=>{F3={id:"builtin-epic-battle",name:"Epic Battle",description:"A climactic confrontation between opposing forces",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["battle","combat","war","climax","action"],entities:{events:[{templateId:"BATTLE_EVT_1",yamlContent:`name: ""
status: "Planned"
isMilestone: true
scale: "Large-scale military engagement"
stakes: "Control of territory, political power"
duration: "Several hours to multiple days"`,markdownContent:`## Description

A decisive military engagement where the fate of nations hangs in the balance. Armies clash on blood-soaked fields as heroes and villains meet in combat that will be remembered for generations.

## Outcome

The battle concludes with significant losses on both sides, forever changing the political landscape and the lives of all who fought.`}]},entityTypes:["event"],usageCount:0,quickApplyEnabled:!0},R3={id:"builtin-royal-celebration",name:"Royal Celebration",description:"A grand feast or festival marking an important occasion",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["celebration","feast","social","nobility","gathering"],entities:{events:[{templateId:"CELEBRATION_EVT_1",yamlContent:`name: ""
status: "Planned"
isMilestone: false
occasion: "Victory, wedding, coronation, or seasonal festival"
attendees: "Nobility, foreign dignitaries, important figures"
entertainment: "Music, dancing, tournaments, performances"`,markdownContent:`## Description

The great hall blazes with candlelight as nobles and dignitaries gather for a magnificent feast. Musicians play, dancers perform, and political alliances are forged over cups of fine wine. Beneath the merriment, intrigue simmers.

## Outcome

The celebration provides opportunities for social advancement, secret meetings, and the planting of seeds that will bloom into future conflicts or alliances.`}]},entityTypes:["event"],usageCount:0,quickApplyEnabled:!0},N3={id:"builtin-mysterious-discovery",name:"Mysterious Discovery",description:"The uncovering of a hidden secret or ancient artifact",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["discovery","mystery","artifact","revelation","exploration"],entities:{events:[{templateId:"DISCOVERY_EVT_1",yamlContent:`name: ""
status: "Planned"
isMilestone: true
discovery_type: "Artifact, knowledge, location, or truth"
significance: "World-changing implications"
immediate_effects: "Shifts in power, new quests, dangerous attention"`,markdownContent:`## Description

After extensive searching or by sheer chance, something long hidden comes to light. Ancient texts reveal forbidden knowledge, a sealed chamber opens, or an artifact of immense power is found. Nothing will be the same.

## Outcome

The discovery sets in motion a chain of events as various factions seek to claim, destroy, or understand what has been found.`}]},entityTypes:["event"],usageCount:0,quickApplyEnabled:!0},B3={id:"builtin-shocking-betrayal",name:"Shocking Betrayal",description:"A trusted ally reveals their true allegiance",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["betrayal","twist","drama","conflict","revelation"],entities:{events:[{templateId:"BETRAYAL_EVT_1",yamlContent:`name: ""
status: "Planned"
isMilestone: true
betrayer_motivation: "Power, revenge, ideology, or survival"
victims: "Those who trusted the betrayer"
consequences: "Loss of resources, lives, or strategic position"`,markdownContent:`## Description

At the worst possible moment, someone thought to be a loyal friend or ally reveals their true colors. Plans are exposed, secrets are sold, and trust is shattered in an instant of devastating revelation.

## Outcome

The betrayal leaves deep wounds, forcing survivors to question everything they thought they knew while dealing with the immediate fallout.`}]},entityTypes:["event"],usageCount:0,quickApplyEnabled:!0},$3={id:"builtin-perilous-journey",name:"Perilous Journey",description:"A dangerous expedition across treacherous terrain",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["journey","travel","adventure","exploration","quest"],entities:{events:[{templateId:"JOURNEY_EVT_1",yamlContent:`name: ""
status: "Planned"
isMilestone: false
destination: "A distant goal requiring significant travel"
hazards: "Natural dangers, hostile creatures, enemy forces"
duration: "Days to months depending on distance"`,markdownContent:`## Description

The travelers set forth on a path fraught with danger. Whether crossing mountain passes, navigating hostile territories, or traversing magical wastelands, every step brings new challenges and opportunities for heroism.

## Outcome

The journey transforms all who survive it, forging bonds of fellowship and revealing the true character of each participant.`}]},entityTypes:["event"],usageCount:0,quickApplyEnabled:!0},z3={id:"builtin-murder-investigation",name:"Murder Investigation",description:"The discovery of a crime that demands answers",genre:"mystery",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["murder","mystery","investigation","crime","detective"],entities:{events:[{templateId:"MURDER_EVT_1",yamlContent:`name: ""
status: "Planned"
isMilestone: true
victim: "To be determined"
suspects: "Multiple parties with means, motive, and opportunity"
clues: "Physical evidence, witness testimony, hidden connections"`,markdownContent:`## Description

A body is discovered under suspicious circumstances. As investigators piece together the victim's final hours, they uncover a web of secrets, lies, and motives that implicate multiple suspects.

## Outcome

The investigation reveals not just the murderer, but hidden truths about the victim and the community that will have lasting repercussions.`}]},entityTypes:["event"],usageCount:0,quickApplyEnabled:!0},H3={id:"builtin-radial-timeline-event",name:"Radial Timeline Event",description:"An event template optimized for radial timeline visualization with all standard event fields and radial timeline date fields",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["timeline","radial","event","date","milestone"],entities:{events:[{templateId:"RADIAL_EVT_1",name:"",description:"A significant event in your story timeline. This template includes all fields needed for radial timeline visualization.",outcome:"",status:"Planned",yamlContent:`name: "{{eventName}}"
dateTime: "{{dateTime}}"
status: "Planned"
isMilestone: {{isMilestone}}
when: "{{when}}"
due: "{{due}}"
progress: 0
Class: Scene
Act: 1
Status: Todo
Subplot: []
Place: ""
POV: first
Publish Stage: Zero
Revision: 0
Pending Edits: ""
Words: 0
Pulse Update: ""
attendees: ""
stakes: ""
preparation: ""
location: ""`,markdownContent:`## Description

A significant event in your story timeline.

## Outcome

To be determined.`}]},entityTypes:["event"],variables:[{name:"eventName",label:"Event Name",type:"text",description:"The name of the event",defaultValue:"",usedIn:[{entityType:"event",entityTemplateId:"RADIAL_EVT_1",field:"name"}]},{name:"when",label:"When",type:"text",description:"The date when the event occurs (for radial timeline)",defaultValue:"",usedIn:[{entityType:"event",entityTemplateId:"RADIAL_EVT_1",field:"yamlContent"}]},{name:"due",label:"Due",type:"text",description:"The due date for the event (for radial timeline)",defaultValue:"",usedIn:[{entityType:"event",entityTemplateId:"RADIAL_EVT_1",field:"yamlContent"}]},{name:"dateTime",label:"Date Time",type:"text",description:"The date and time of the event (standard event field)",defaultValue:"",usedIn:[{entityType:"event",entityTemplateId:"RADIAL_EVT_1",field:"yamlContent"}]},{name:"isMilestone",label:"Is Milestone",type:"boolean",description:"Mark this event as a key story moment",defaultValue:!1,usedIn:[{entityType:"event",entityTemplateId:"RADIAL_EVT_1",field:"yamlContent"}]}],usageCount:0,quickApplyEnabled:!0},NTe=[F3,R3,N3,B3,$3,z3,H3]});var K3={};At(K3,{ANCIENT_TOME_TEMPLATE:()=>U3,BUILTIN_ITEM_TEMPLATES:()=>BTe,CURSED_ARTIFACT_TEMPLATE:()=>Z3,HEALING_POTION_TEMPLATE:()=>q3,LEGENDARY_SWORD_TEMPLATE:()=>W3,MYSTERIOUS_KEY_TEMPLATE:()=>Y3,ROYAL_CROWN_TEMPLATE:()=>j3});var W3,U3,j3,Y3,q3,Z3,BTe,X3=_e(()=>{W3={id:"builtin-legendary-sword",name:"Legendary Sword",description:"A mythical blade of immense power and storied history",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["weapon","sword","legendary","magical","artifact"],entities:{items:[{templateId:"SWORD_ITEM_1",yamlContent:`name: ""
isPlotCritical: true
material: "Enchanted steel, dragon bone hilt"
abilities: "Enhanced cutting power, magical resistance"
curse_or_blessing: "Only responds to those deemed worthy"`,markdownContent:`## Description

A blade of extraordinary craftsmanship that gleams with an inner light. Runes etched along its length pulse with ancient magic, and it feels perfectly balanced in the hand of its destined wielder.

## History

Forged in ages past by master smiths using techniques now lost to time, this sword has been wielded by heroes throughout history. Each bearer has added to its legend, and it is said to choose its own master.`}]},entityTypes:["item"],usageCount:0,quickApplyEnabled:!0},U3={id:"builtin-ancient-tome",name:"Ancient Tome",description:"A book containing forbidden knowledge or powerful spells",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["book","knowledge","magical","artifact","forbidden"],entities:{items:[{templateId:"TOME_ITEM_1",yamlContent:`name: ""
isPlotCritical: true
contents: "Forbidden spells, lost history, prophecies"
danger_level: "High - corrupting influence"
protection: "Magical locks, guardian enchantments"`,markdownContent:`## Description

Bound in weathered leather that seems to absorb light, this tome is filled with dense script in an ancient language. Some pages are blank to most eyes but reveal their secrets to those who know the proper rituals.

## History

Written by a powerful sorcerer who sought to preserve dangerous knowledge, this tome has been hidden, stolen, and fought over for centuries. Many who have read its contents have been changed forever.`}]},entityTypes:["item"],usageCount:0,quickApplyEnabled:!0},j3={id:"builtin-royal-crown",name:"Royal Crown",description:"A symbol of legitimate rule and sovereign power",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["crown","royalty","symbol","power","political"],entities:{items:[{templateId:"CROWN_ITEM_1",yamlContent:`name: ""
isPlotCritical: true
materials: "Gold, precious gems, ancient metals"
symbolic_power: "Legitimacy, divine right, authority"
magical_properties: "May grant wisdom or protection to true rulers"`,markdownContent:`## Description

A masterwork of the jeweler's art, this crown is set with precious gems that catch the light with every movement. More than mere decoration, it is the physical embodiment of the right to rule.

## History

Passed down through generations of rulers, this crown has witnessed the rise and fall of dynasties. To possess it is to hold a claim to the throne that many would kill for.`}]},entityTypes:["item"],usageCount:0,quickApplyEnabled:!0},Y3={id:"builtin-mysterious-key",name:"Mysterious Key",description:"A key that opens something of great importance",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["key","mystery","unlock","quest","artifact"],entities:{items:[{templateId:"KEY_ITEM_1",yamlContent:`name: ""
isPlotCritical: true
material: "Unknown alloy, possibly magical"
unlocks: "Unknown - requires investigation"
clues: "Symbols match ancient ruins or prophecy"`,markdownContent:`## Description

An ornate key of unusual design, crafted from a metal that never tarnishes. Its teeth form a pattern that seems to shift when viewed from different angles, and it is warm to the touch.

## History

The lock this key opens has been lost to memory, but legends speak of a sealed vault, a forbidden door, or a prison meant to hold something terrible. Finding what it unlocks may be a blessing or a curse.`}]},entityTypes:["item"],usageCount:0,quickApplyEnabled:!0},q3={id:"builtin-healing-potion",name:"Healing Potion",description:"A magical elixir that restores health and vitality",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["potion","healing","consumable","magical","alchemy"],entities:{items:[{templateId:"POTION_ITEM_1",yamlContent:`name: ""
isPlotCritical: false
ingredients: "Rare herbs, phoenix tears, blessed water"
effects: "Rapid healing of wounds, restoration of energy"
side_effects: "None when properly brewed"`,markdownContent:`## Description

A crystal vial containing a luminescent red liquid that swirls with its own inner light. The potion smells faintly of herbs and honey, and a single sip can close wounds and restore strength.

## History

Brewed by skilled alchemists using rare ingredients, healing potions are valuable commodities in a world where injury and illness are constant threats.`}]},entityTypes:["item"],usageCount:0,quickApplyEnabled:!0},Z3={id:"builtin-cursed-artifact",name:"Cursed Artifact",description:"A powerful but dangerous object bearing a dark enchantment",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["artifact","cursed","dangerous","magical","dark"],entities:{items:[{templateId:"CURSED_ITEM_1",yamlContent:`name: ""
isPlotCritical: true
curse_effects: "Misfortune, corruption, obsession"
benefits: "Enhanced abilities or forbidden knowledge"
breaking_the_curse: "Requires specific conditions or sacrifice"`,markdownContent:`## Description

An object of dark beauty that draws the eye despite an instinctive sense of wrongness. Those who possess it find themselves reluctant to part with it, even as misfortune begins to gather around them.

## History

Created through forbidden rituals or tainted by tragic events, this artifact carries a curse that affects all who claim ownership. Some seek it for its power, willing to pay any price.`}]},entityTypes:["item"],usageCount:0,quickApplyEnabled:!0},BTe=[W3,U3,j3,Y3,q3,Z3]});var i4={};At(i4,{BUILTIN_GROUP_TEMPLATES:()=>$Te,KNIGHTLY_ORDER_TEMPLATE:()=>Q3,MERCHANT_CONSORTIUM_TEMPLATE:()=>e4,REBEL_MOVEMENT_TEMPLATE:()=>r4,SECRET_CULT_TEMPLATE:()=>t4,THIEVES_GUILD_TEMPLATE:()=>J3});var J3,Q3,e4,t4,r4,$Te,n4=_e(()=>{J3={id:"builtin-thieves-guild",name:"Thieves Guild",description:"A shadowy organization of rogues, smugglers, and criminals",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["guild","criminal","underground","faction","rogues"],entities:{groups:[{templateId:"THIEVES_GROUP_1",yamlContent:`id: ""
storyId: ""
name: ""
groupType: "guild"
status: "Active"
motto: "What's yours is mine, what's mine is hidden."
members: []
influence: "Extensive in urban areas"
reputation: "Feared and respected in criminal circles"
services: "Theft, smuggling, information gathering"`,markdownContent:`## Description

A network of thieves, smugglers, and information brokers operating from the shadows. Members follow a strict code of conduct and share profits according to guild law.

## History

Founded generations ago by legendary thieves who realized cooperation was more profitable than competition. The guild has survived purges and crackdowns through careful planning and well-placed bribes.

## Structure

Hierarchical with a Guildmaster at the top, lieutenants managing districts, and specialists handling specific operations.

## Goals

Control the criminal underworld, accumulate wealth, protect members from authorities.

## Resources

Safehouses, fence networks, blackmail material, skilled operatives.`}]},entityTypes:["group"],usageCount:0,quickApplyEnabled:!0},Q3={id:"builtin-knightly-order",name:"Knightly Order",description:"A prestigious military order bound by codes of honor",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["knights","military","honor","faction","nobility"],entities:{groups:[{templateId:"KNIGHTS_GROUP_1",yamlContent:`id: ""
storyId: ""
name: ""
groupType: "military"
status: "Active"
militaryPower: 75
politicalInfluence: 60
motto: "Honor above all."
members: []
entry_requirements: "Noble birth or exceptional valor"
patron_deity: "God of justice or warfare"
notable_traditions: "Vigil before knighting, sacred oaths"`,markdownContent:`## Description

An elite brotherhood of warriors sworn to uphold justice and protect the realm. Members undergo rigorous training and adhere to a strict code of chivalry.

## History

Established by a legendary hero to defend the kingdom against a great threat. The order has since become a symbol of martial excellence and noble virtue.

## Structure

Grand Master leads the order, with Knight Commanders overseeing regional chapters. Initiates must prove themselves before earning knighthood.

## Goals

Defend the innocent, uphold justice, maintain the peace.

## Resources

Fortresses, trained knights, noble patronage, sacred relics.`}]},entityTypes:["group"],usageCount:0,quickApplyEnabled:!0},e4={id:"builtin-merchant-consortium",name:"Merchant Consortium",description:"A powerful alliance of wealthy traders and business interests",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["merchants","trade","economic","faction","commerce"],entities:{groups:[{templateId:"MERCHANT_GROUP_1",yamlContent:`id: ""
storyId: ""
name: ""
groupType: "organization"
status: "Active"
economicPower: 90
politicalInfluence: 70
motto: "Prosperity through partnership."
members: []
headquarters: "Major trading hub"
primary_goods: "Varied - spices, textiles, metals, exotic goods"
influence_methods: "Lobbying, bribes, economic pressure"`,markdownContent:`## Description

A coalition of the wealthiest and most influential merchants, working together to control trade routes, set prices, and influence policy. Gold is their sword and contracts their shield.

## History

Formed when competing merchant families realized cooperation would be more profitable than cutthroat competition. They now wield economic power that rivals noble houses.

## Structure

Council of senior merchants makes major decisions, with specialized committees handling different trade sectors.

## Goals

Maximize profits, control trade, influence government policy.

## Resources

Vast wealth, trade networks, warehouses, ships, political connections.`}]},entityTypes:["group"],usageCount:0,quickApplyEnabled:!0},t4={id:"builtin-secret-cult",name:"Secret Cult",description:"A hidden religious order pursuing forbidden knowledge or dark powers",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["cult","secret","religious","faction","dark"],entities:{groups:[{templateId:"CULT_GROUP_1",yamlContent:`id: ""
storyId: ""
name: ""
groupType: "religious"
status: "Active"
motto: "In darkness, truth. In sacrifice, power."
members: []
deity_or_entity: "Dark god, demon, or cosmic horror"
initiation_rites: "Blood oaths, forbidden knowledge revelation"
public_facade: "May appear as legitimate organization"`,markdownContent:`## Description

A clandestine organization devoted to forbidden practices and dark worship. Members are bound by blood oaths and fear of terrible consequences for betrayal.

## History

Founded by those who discovered forbidden truths and sought power beyond mortal understanding. The cult has survived persecution by operating in absolute secrecy.

## Structure

High Priest leads secret ceremonies, with inner circle members knowing the full truth while outer members are kept ignorant of darker practices.

## Goals

Accumulate forbidden power, summon or serve dark entities, achieve transcendence.

## Resources

Hidden temples, devoted followers, forbidden artifacts, dark magic.`}]},entityTypes:["group"],usageCount:0,quickApplyEnabled:!0},r4={id:"builtin-rebel-movement",name:"Rebel Movement",description:"A resistance organization fighting against oppressive authority",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["rebels","resistance","political","faction","freedom"],entities:{groups:[{templateId:"REBEL_GROUP_1",yamlContent:`id: ""
storyId: ""
name: ""
groupType: "political"
status: "Active"
militaryPower: 40
politicalInfluence: 30
motto: "Freedom or death."
members: []
tactics: "Guerrilla warfare, sabotage, propaganda"
support_base: "Common people, disillusioned soldiers"
primary_enemy: "Current regime and its enforcers"`,markdownContent:`## Description

A loose coalition of freedom fighters, idealists, and the oppressed united against tyranny. They strike from the shadows and vanish before retaliation comes.

## History

Born from injustice when ordinary people could no longer endure oppression. What began as scattered resistance has grown into a coordinated movement.

## Structure

Cell-based organization to prevent infiltration. Leaders known only by code names, with limited contact between cells.

## Goals

Overthrow the tyrannical regime, establish just governance, protect the common people.

## Resources

Safe houses, sympathizers, guerrilla fighters, stolen supplies.`}]},entityTypes:["group"],usageCount:0,quickApplyEnabled:!0},$Te=[J3,Q3,e4,t4,r4]});var m4={};At(m4,{BUILTIN_CULTURE_TEMPLATES:()=>h4,BUILTIN_ECONOMY_TEMPLATES:()=>f4,BUILTIN_MAGIC_SYSTEM_TEMPLATES:()=>p4,BUILTIN_WORLDBUILDING_TEMPLATES:()=>zTe,DIVINE_MAGIC_TEMPLATE:()=>u4,ELEMENTAL_MAGIC_TEMPLATE:()=>c4,FEUDAL_ECONOMY_TEMPLATE:()=>o4,MEDIEVAL_FEUDAL_CULTURE_TEMPLATE:()=>a4,MERCANTILE_ECONOMY_TEMPLATE:()=>l4,NOMADIC_TRIBAL_CULTURE_TEMPLATE:()=>s4,RUNIC_MAGIC_TEMPLATE:()=>d4});var a4,s4,o4,l4,c4,u4,d4,h4,f4,p4,zTe,g4=_e(()=>{a4={id:"builtin-medieval-feudal-culture",name:"Medieval Feudal Culture",description:"A hierarchical society based on land ownership and noble obligations",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["culture","medieval","feudal","european","nobility"],entities:{cultures:[{templateId:"FEUDAL_CULTURE_1",yamlContent:`name: ""
languages: ["Common tongue", "High speech for nobility", "Church Latin"]
techLevel: "medieval"
governmentType: "monarchy"
status: "thriving"
calendar: "Based on religious festivals and seasons"
warfare: "Knights in armor, siege warfare, levied peasants"
art_forms: "Illuminated manuscripts, tapestries, heraldry"`,markdownContent:`## Description

A stratified society where nobility rules over peasant farmers, bound together by oaths of fealty and tradition. Honor, land, and lineage determine one's place in the world.

## Values

Honor, loyalty, family lineage, martial prowess, religious devotion.

## Religion

A dominant church with significant political power, local saints and shrines, religious festivals marking the seasons.

## Social Structure

King/Queen at apex, followed by high nobility (dukes, counts), lesser nobility (barons, knights), clergy, merchants, and peasants at the base.

## History

Emerged from the chaos following the fall of an ancient empire, when local strongmen offered protection in exchange for service and loyalty.

## Naming Conventions

First name followed by family name or place of origin. Nobility use titles and house names.

## Customs

Tournaments and jousting, feasting in great halls, arranged marriages for alliance, primogeniture inheritance.`}]},entityTypes:["culture"],usageCount:0,quickApplyEnabled:!0},s4={id:"builtin-nomadic-tribal-culture",name:"Nomadic Tribal Culture",description:"A mobile society following herds and seasons across vast territories",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["culture","nomadic","tribal","wilderness","horses"],entities:{cultures:[{templateId:"NOMAD_CULTURE_1",yamlContent:`name: ""
languages: ["Steppe tongue", "Trade pidgin"]
techLevel: "bronze age"
governmentType: "tribal"
status: "thriving"
economy: "Herding, raiding, trade"
warfare: "Horse archery, lightning raids"
sacred_animals: "Horses, eagles, wolves"`,markdownContent:`## Description

A proud people who follow the great herds across endless steppes. They live by the horse and bow, respecting strength and wisdom above birth or wealth.

## Values

Freedom, hospitality, martial skill, ancestor reverence, harmony with nature.

## Religion

Shamanic traditions, ancestor spirits, nature deities, sky worship.

## Social Structure

Clans led by chiefs, united under a Great Khan in times of need. Status earned through deeds, not birth.

## History

Ancient people of the grasslands who have resisted all attempts at conquest, their mobility and archery making them masters of their domain.

## Naming Conventions

Personal name plus clan name. Earned titles replace birth names for great deeds.

## Customs

Seasonal gatherings for trade and marriage, horse racing competitions, ritual hunts, storytelling around campfires.`}]},entityTypes:["culture"],usageCount:0,quickApplyEnabled:!0},o4={id:"builtin-feudal-economy",name:"Feudal Economy",description:"An agricultural economy based on land ownership and peasant labor",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["economy","feudal","agricultural","medieval","trade"],entities:{economies:[{templateId:"FEUDAL_ECON_1",yamlContent:`name: ""
economicSystem: "feudal"
status: "stable"
currencies:
  - name: "Gold Crown"
    exchangeRate: 1
    description: "Royal currency for major transactions"
  - name: "Silver Penny"
    exchangeRate: 0.1
    description: "Common currency for daily use"
  - name: "Copper Farthing"
    exchangeRate: 0.01
    description: "Smallest denomination"
resources:
  - name: "Grain"
    availability: "abundant"
    description: "Staple food crop"
  - name: "Iron"
    availability: "common"
    description: "For tools and weapons"
  - name: "Wool"
    availability: "common"
    description: "Major trade good"
tradeRoutes:
  - name: "King's Road"
    origin: "Capital"
    destination: "Port City"
    goods: ["Wool", "Grain", "Iron goods"]
wealth_distribution: "Highly concentrated among nobility and church"
social_mobility: "Very limited - birth determines occupation"
major_exports: "Wool, grain, timber"`,markdownContent:`## Description

An economy where land is wealth and peasants work fields they can never own. Trade exists but is secondary to agricultural production and noble obligations.

## Industries

Agriculture dominates, with localized crafts (blacksmithing, weaving, pottery) serving immediate needs. Guilds control urban production.

## Taxation

Peasants owe portion of harvest to lords, lords owe military service to crown. Church collects tithes. Toll roads and market taxes.`}]},entityTypes:["economy"],usageCount:0,quickApplyEnabled:!0},l4={id:"builtin-mercantile-economy",name:"Mercantile Economy",description:"A trade-focused economy where merchants wield significant power",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["economy","mercantile","trade","commerce","banking"],entities:{economies:[{templateId:"MERCANTILE_ECON_1",yamlContent:`name: ""
economicSystem: "market"
status: "growing"
currencies:
  - name: "Trade Ducat"
    exchangeRate: 1
    description: "Standardized gold coin accepted everywhere"
  - name: "Silver Mark"
    exchangeRate: 0.2
    description: "Regional currency"
  - name: "Letters of Credit"
    exchangeRate: 1
    description: "Banking instruments for large transactions"
resources:
  - name: "Spices"
    availability: "rare"
    value: "High"
    description: "Imported luxury goods"
  - name: "Silk"
    availability: "rare"
    value: "High"
    description: "Luxury fabric"
  - name: "Salt"
    availability: "common"
    value: "Moderate"
    description: "Essential for preservation"
tradeRoutes:
  - name: "Spice Route"
    origin: "Eastern Lands"
    destination: "Trading Hub"
    goods: ["Spices", "Silk", "Gems"]
  - name: "Northern Trade"
    origin: "Trading Hub"
    destination: "Northern Kingdoms"
    goods: ["Manufactured goods", "Wine", "Salt"]
banking_services: "Loans, currency exchange, safe deposit"
trade_wars: "Common between rival merchant houses"
insurance: "Maritime insurance for shipping"`,markdownContent:`## Description

An economy where trade is king and merchants rival nobility in power. Banks, trading companies, and guilds drive prosperity while ships carry wealth across seas.

## Industries

Shipbuilding, banking, textile production, luxury goods manufacturing. Strong guild system controls quality and prices.

## Taxation

Import/export duties, merchant licenses, property taxes. Relatively low compared to feudal systems to encourage trade.`}]},entityTypes:["economy"],usageCount:0,quickApplyEnabled:!0},c4={id:"builtin-elemental-magic",name:"Elemental Magic",description:"A magic system based on commanding the fundamental forces of nature",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["magic","elemental","nature","wizardry","spells"],entities:{magicSystems:[{templateId:"ELEMENTAL_MAGIC_1",yamlContent:`name: ""
systemType: "elemental"
rarity: "uncommon"
powerLevel: "moderate"
status: "active"
categories:
  - name: "Pyromancy"
    description: "Fire and heat magic"
    difficulty: "moderate"
  - name: "Hydromancy"
    description: "Water and ice magic"
    difficulty: "moderate"
  - name: "Geomancy"
    description: "Earth and stone magic"
    difficulty: "hard"
  - name: "Aeromancy"
    description: "Air and lightning magic"
    difficulty: "hard"
abilities:
  - name: "Fireball"
    category: "Pyromancy"
    powerLevel: 5
    cost: "Moderate fatigue"
    description: "Launch explosive fire"
  - name: "Ice Shield"
    category: "Hydromancy"
    powerLevel: 4
    cost: "Low fatigue"
    description: "Create protective ice barrier"
  - name: "Stone Skin"
    category: "Geomancy"
    powerLevel: 6
    cost: "High fatigue"
    description: "Harden skin like stone"
consistencyRules:
  - name: "Conservation of Energy"
    description: "Cannot create energy from nothing - must draw from surroundings or self"
    priority: "critical"
  - name: "Elemental Opposition"
    description: "Opposing elements (fire/water, earth/air) cannot be used simultaneously"
    priority: "important"
common_practitioners: "Battle mages, elementalists, druids"
magical_items: "Elemental focuses, enchanted staffs"
legendary_spells: "Meteor strike, tsunami wave, earthquake"`,markdownContent:`## Description

Magic that draws upon the primal elements - fire, water, earth, and air. Practitioners attune themselves to one or more elements, channeling raw natural forces.

## Rules

Mages must attune to elements through meditation and study. Stronger effects require more energy. Opposing elements are difficult to combine.

## Source

The elemental planes that underlie physical reality. Raw elemental energy flows through ley lines and concentrates in natural phenomena.

## Costs

Mental fatigue, physical exhaustion. Overuse can cause elemental backlash - frostbite from ice magic, burns from fire.

## Limitations

Effectiveness depends on environmental conditions. Fire magic weakens underwater. Earth magic struggles in the air. Requires concentration.

## Training

Apprenticeship with master mages, academy education, or self-discovery through natural affinity.

## History

As old as civilization itself, elemental magic was the first sorcery mastered by mortals who observed and mimicked natural forces.`}]},entityTypes:["magicSystem"],usageCount:0,quickApplyEnabled:!0},u4={id:"builtin-divine-magic",name:"Divine Magic",description:"Holy power granted by deities to their faithful servants",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["magic","divine","holy","clerical","faith"],entities:{magicSystems:[{templateId:"DIVINE_MAGIC_1",yamlContent:`name: ""
systemType: "divine"
rarity: "uncommon"
powerLevel: "moderate"
status: "active"
categories:
  - name: "Healing"
    description: "Restoration and curing"
    difficulty: "easy"
  - name: "Protection"
    description: "Wards and blessings"
    difficulty: "moderate"
  - name: "Smiting"
    description: "Holy wrath against evil"
    difficulty: "moderate"
  - name: "Divination"
    description: "Seeking divine guidance"
    difficulty: "hard"
abilities:
  - name: "Lay on Hands"
    category: "Healing"
    powerLevel: 4
    cost: "Daily limit"
    description: "Heal wounds through touch"
  - name: "Turn Undead"
    category: "Smiting"
    powerLevel: 5
    cost: "Holy symbol required"
    description: "Repel undead with divine light"
  - name: "Divine Shield"
    category: "Protection"
    powerLevel: 6
    cost: "Concentration"
    description: "Protective barrier of holy energy"
consistencyRules:
  - name: "Faith Requirement"
    description: "Power scales with genuine faith - doubt weakens miracles"
    priority: "critical"
  - name: "Divine Will"
    description: "Cannot perform miracles opposed to deity's nature"
    priority: "critical"
common_practitioners: "Clerics, priests, paladins, prophets"
holy_symbols: "Required focus for channeling"
forbidden_acts: "Vary by deity - murder, lies, etc."`,markdownContent:`## Description

Power channeled from divine beings through faith and devotion. Clerics, priests, and paladins serve as conduits for their deity's will.

## Rules

Power flows from deity to worshipper based on faith and adherence to divine principles. Miracles are requests granted, not spells commanded.

## Source

The gods themselves, channeling their power through the faithful. Different deities grant different types of miracles.

## Costs

Divine favor - must maintain faith and follow deity's tenets. Sins can block divine power until atonement.

## Limitations

Cannot be used against deity's will. Holy symbols required as focus. Acts against faith can revoke powers.

## Training

Religious instruction, ordination ceremonies, years of devoted service. Some receive spontaneous calling.

## History

Since mortals first prayed, the gods have answered. Divine magic is as old as faith itself.`}]},entityTypes:["magicSystem"],usageCount:0,quickApplyEnabled:!0},d4={id:"builtin-runic-magic",name:"Runic Magic",description:"Ancient power encoded in mystical symbols and inscriptions",genre:"fantasy",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["magic","runes","inscription","enchantment","ancient"],entities:{magicSystems:[{templateId:"RUNIC_MAGIC_1",yamlContent:`name: ""
systemType: "runic"
rarity: "rare"
powerLevel: "high"
status: "active"
materials: ["Enchanted ink", "Runestones", "Sacred metals", "Dragon blood"]
categories:
  - name: "Warding"
    description: "Protective inscriptions"
    difficulty: "moderate"
  - name: "Binding"
    description: "Containment and restriction"
    difficulty: "hard"
  - name: "Enchantment"
    description: "Imbuing objects with power"
    difficulty: "hard"
  - name: "True Names"
    description: "Command through naming"
    difficulty: "master"
abilities:
  - name: "Rune of Shielding"
    category: "Warding"
    powerLevel: 5
    cost: "Carved stone required"
    description: "Create protective ward"
  - name: "Binding Circle"
    category: "Binding"
    powerLevel: 7
    cost: "Blood and silver"
    description: "Trap entities within"
  - name: "Weapon Enchantment"
    category: "Enchantment"
    powerLevel: 6
    cost: "Rare materials"
    description: "Grant magical properties to weapons"
consistencyRules:
  - name: "Precision Required"
    description: "Even small errors in rune carving cause failure or dangerous effects"
    priority: "critical"
  - name: "Material Limitations"
    description: "Runes must be carved into physical medium - cannot exist in pure energy"
    priority: "important"
common_practitioners: "Runesmiths, enchanters, artificers"
rune_alphabets: "Multiple ancient systems with different powers"
permanent_vs_temporary: "Carved runes last; drawn runes are temporary"`,markdownContent:`## Description

Power contained within ancient symbols, carved or drawn with precise patterns. Runes store magic for later release, enabling even non-mages to use enchanted items.

## Rules

Each rune has specific meaning and effect. Combinations create complex effects. Precision is critical - flawed runes fail or backfire.

## Source

The runes themselves are said to be fragments of the language used to create the world. They tap into fundamental reality.

## Costs

Time and materials for inscription. Activation may require blood, sacrifice, or spoken words of power.

## Limitations

Must be physically inscribed. Complex effects require many runes. Runes can be damaged or erased.

## Training

Years of study memorizing rune meanings and combinations. Mathematical precision required.

## History

Discovered carved into ancient monoliths predating known civilizations. Scholars have spent millennia deciphering their secrets.`}]},entityTypes:["magicSystem"],usageCount:0,quickApplyEnabled:!0},h4=[a4,s4],f4=[o4,l4],p4=[c4,u4,d4],zTe=[...h4,...f4,...p4]});var P4={};At(P4,{ACTION_SCENE_TEMPLATE:()=>w4,BUILTIN_CHAPTER_TEMPLATES:()=>x4,BUILTIN_REFERENCE_TEMPLATES:()=>D4,BUILTIN_SCENE_TEMPLATES:()=>k4,BUILTIN_STORY_STRUCTURE_TEMPLATES:()=>HTe,CLIMAX_CHAPTER_TEMPLATE:()=>y4,DIALOGUE_SCENE_TEMPLATE:()=>E4,EMOTIONAL_SCENE_TEMPLATE:()=>C4,LANGUAGE_REFERENCE_TEMPLATE:()=>_4,OPENING_CHAPTER_TEMPLATE:()=>v4,RESOLUTION_CHAPTER_TEMPLATE:()=>b4,REVELATION_SCENE_TEMPLATE:()=>T4,TIMELINE_REFERENCE_TEMPLATE:()=>S4});var v4,y4,b4,w4,E4,T4,C4,_4,S4,x4,k4,D4,HTe,L4=_e(()=>{v4={id:"builtin-opening-chapter",name:"Opening Chapter",description:"An engaging first chapter that hooks readers and establishes the story",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["chapter","opening","beginning","hook","introduction"],entities:{chapters:[{templateId:"OPENING_CHAP_1",yamlContent:`name: ""
number: 1
tags: ["opening", "introduction", "inciting-incident"]`,markdownContent:`## Summary

Introduce the protagonist in their ordinary world, establish the setting's tone and atmosphere, and plant the seeds of the central conflict. End with an inciting incident that disrupts normalcy.`}]},entityTypes:["chapter"],usageCount:0,quickApplyEnabled:!0},y4={id:"builtin-climax-chapter",name:"Climax Chapter",description:"The peak of dramatic tension where the main conflict reaches its crisis point",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["chapter","climax","crisis","turning-point","dramatic"],entities:{chapters:[{templateId:"CLIMAX_CHAP_1",yamlContent:`name: ""
tags: ["climax", "crisis", "confrontation"]`,markdownContent:`## Summary

All story threads converge as the protagonist faces their greatest challenge. Stakes are at their highest, and the outcome will determine everything. This is the point of no return.`}]},entityTypes:["chapter"],usageCount:0,quickApplyEnabled:!0},b4={id:"builtin-resolution-chapter",name:"Resolution Chapter",description:"The final chapter that ties up loose ends and shows the new status quo",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["chapter","resolution","ending","conclusion","denouement"],entities:{chapters:[{templateId:"RESOLUTION_CHAP_1",yamlContent:`name: ""
tags: ["resolution", "aftermath", "conclusion"]`,markdownContent:`## Summary

Show the aftermath of the climax and how the world has changed. Resolve remaining subplots, demonstrate character growth, and leave readers with a satisfying sense of closure (or setup for sequel).`}]},entityTypes:["chapter"],usageCount:0,quickApplyEnabled:!0},w4={id:"builtin-action-scene",name:"Action Scene",description:"A high-energy scene featuring combat, chase, or physical conflict",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["scene","action","combat","chase","conflict"],entities:{scenes:[{templateId:"ACTION_SCENE_1",yamlContent:`name: ""
status: "Draft"
beats:
  - "Setup: Establish stakes and combatants"
  - "Escalation: Initial clash and complications"
  - "Crisis: Moment when defeat seems likely"
  - "Turn: Protagonist finds advantage or makes sacrifice"
  - "Resolution: Outcome and immediate consequences"`,markdownContent:`## Content

`}]},entityTypes:["scene"],usageCount:0,quickApplyEnabled:!0},E4={id:"builtin-dialogue-scene",name:"Dialogue Scene",description:"A conversation-driven scene revealing character and advancing plot",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["scene","dialogue","conversation","character","exposition"],entities:{scenes:[{templateId:"DIALOGUE_SCENE_1",yamlContent:`name: ""
status: "Draft"
beats:
  - "Context: Establish setting and why characters are meeting"
  - "Opening: Initial exchange sets tone"
  - "Development: Core information or conflict emerges"
  - "Tension: Disagreement, revelation, or emotional peak"
  - "Conclusion: Resolution or cliff-hanger, characters part with changed dynamic"`,markdownContent:`## Content

`}]},entityTypes:["scene"],usageCount:0,quickApplyEnabled:!0},T4={id:"builtin-revelation-scene",name:"Revelation Scene",description:"A scene where crucial information is discovered or revealed",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["scene","revelation","discovery","twist","mystery"],entities:{scenes:[{templateId:"REVELATION_SCENE_1",yamlContent:`name: ""
status: "Draft"
beats:
  - "Setup: Character pursues information or stumbles onto clues"
  - "Building: Pieces come together, tension mounts"
  - "The Reveal: Truth comes to light - show don't tell"
  - "Reaction: Character processes implications"
  - "New Direction: How this changes the protagonist's goals or understanding"`,markdownContent:`## Content

`}]},entityTypes:["scene"],usageCount:0,quickApplyEnabled:!0},C4={id:"builtin-emotional-scene",name:"Emotional Scene",description:"A character-focused scene exploring feelings and relationships",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["scene","emotional","character","relationship","drama"],entities:{scenes:[{templateId:"EMOTIONAL_SCENE_1",yamlContent:`name: ""
status: "Draft"
beats:
  - "Trigger: Something prompts emotional response"
  - "Internal: Character's thoughts and feelings"
  - "Expression: How emotions manifest externally"
  - "Interaction: Other characters respond or contribute"
  - "Processing: Character reaches understanding or decision"`,markdownContent:`## Content

`}]},entityTypes:["scene"],usageCount:0,quickApplyEnabled:!0},_4={id:"builtin-language-reference",name:"Language Reference",description:"A reference document for a fictional language or naming conventions",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["reference","language","naming","worldbuilding","linguistics"],entities:{references:[{templateId:"LANGUAGE_REF_1",yamlContent:`name: ""
category: "Language"
tags: ["language", "names", "worldbuilding"]`,markdownContent:`## Overview

Describe the language family, influences, and where it is spoken.

## Phonetics

Common sounds, forbidden combinations, accent patterns.

## Naming Conventions

- Male names:
- Female names:
- Family/clan names:
- Place names:

## Common Words

| Word | Meaning |
|------|--------|
| | |

## Grammar Notes

Basic structure and rules for constructing phrases.`}]},entityTypes:["reference"],usageCount:0,quickApplyEnabled:!0},S4={id:"builtin-timeline-reference",name:"Timeline Reference",description:"A chronological reference document for historical events",genre:"custom",category:"single-entity",version:"1.0.0",author:"built-in",isBuiltIn:!0,isEditable:!1,created:"2024-01-01T00:00:00.000Z",modified:"2024-01-01T00:00:00.000Z",tags:["reference","timeline","history","chronology","worldbuilding"],entities:{references:[{templateId:"TIMELINE_REF_1",yamlContent:`name: ""
category: "History"
tags: ["timeline", "history", "chronology"]`,markdownContent:`## Calendar System

Describe how time is measured in your world.

## Ages/Eras

### First Age

Key events and characteristics.

### Second Age

Key events and characteristics.

## Major Events Timeline

| Date | Event | Significance |
|------|-------|-------------|
| | | |

## Current Year

Where the story takes place in the timeline.`}]},entityTypes:["reference"],usageCount:0,quickApplyEnabled:!0},x4=[v4,y4,b4],k4=[w4,E4,T4,C4],D4=[_4,S4],HTe=[...x4,...k4,...D4]});var M4={};At(M4,{TemplateValidator:()=>uP});var uP,I4=_e(()=>{uP=class{static validate(t){let e={isValid:!0,errors:[],warnings:[],brokenReferences:[]};this.validateRequiredFields(t,e);let r=this.collectEntityIds(t);return this.validateEntityReferences(t,r,e),t.placeholders&&this.validatePlaceholders(t,r,e),t.variables&&this.validateVariables(t,r,e),t.entityTypes&&this.validateEntityTypes(t,e),e.brokenReferences.length>0&&e.warnings.push(`Found ${e.brokenReferences.length} broken references. These will be removed when applying template.`),e.isValid=e.errors.length===0,e}static validateRequiredFields(t,e){t.id||e.errors.push("Template ID is required"),(!t.name||t.name.trim()==="")&&e.errors.push("Template name is required"),t.version||e.errors.push("Template version is required"),t.category||e.errors.push("Template category is required"),t.genre||e.errors.push("Template genre is required")}static collectEntityIds(t){let e=new Set,r=t.entities,n=s=>{s&&s.forEach(o=>{o.templateId&&e.add(o.templateId)})};return n(r.characters),n(r.locations),n(r.events),n(r.items),n(r.groups),n(r.cultures),n(r.economies),n(r.magicSystems),n(r.chapters),n(r.scenes),n(r.references),e}static validateEntityReferences(t,e,r){let n=t.entities;this.validateReferences(n.characters,"character",e,r,[{field:"relationships"},{field:"locations"},{field:"events"},{field:"groups"},{field:"connections"}]),this.validateReferences(n.locations,"location",e,r,[{field:"parentLocation"},{field:"groups"},{field:"connections"}]),this.validateReferences(n.events,"event",e,r,[{field:"characters"},{field:"location"},{field:"groups"},{field:"connections"},{field:"dependencies"}]),this.validateReferences(n.items,"item",e,r,[{field:"currentOwner"},{field:"pastOwners"},{field:"currentLocation"},{field:"associatedEvents"},{field:"groups"}]),this.validateReferences(n.groups,"group",e,r,[{field:"members"},{field:"territories"},{field:"linkedEvents"},{field:"parentGroup"},{field:"subgroups"},{field:"groupRelationships"}]),this.validateReferences(n.cultures,"culture",e,r,[{field:"linkedLocations"},{field:"linkedCharacters"},{field:"linkedEvents"},{field:"relatedCultures"},{field:"parentCulture"}]),this.validateReferences(n.economies,"economy",e,r,[{field:"linkedLocations"},{field:"linkedFactions"},{field:"linkedCultures"},{field:"linkedEvents"}]),this.validateReferences(n.magicSystems,"magicSystem",e,r,[{field:"linkedCharacters"},{field:"linkedLocations"},{field:"linkedCultures"},{field:"linkedEvents"},{field:"linkedItems"}]),this.validateReferences(n.chapters,"chapter",e,r,[{field:"linkedCharacters"},{field:"linkedLocations"},{field:"linkedEvents"},{field:"linkedItems"},{field:"linkedGroups"}]),this.validateReferences(n.scenes,"scene",e,r,[{field:"chapterId"},{field:"linkedCharacters"},{field:"linkedLocations"},{field:"linkedEvents"},{field:"linkedItems"},{field:"linkedGroups"}])}static validateReferences(t,e,r,n,s){t&&t.forEach(o=>{s.forEach(({field:l})=>{let c=o[l];c&&(Array.isArray(c)?c.forEach(u=>{let d=typeof u=="string"?u:u.target||u.name;d&&!r.has(d)&&n.brokenReferences.push({entityType:e,entityId:o.templateId,referenceType:l,targetId:d})}):typeof c=="string"?r.has(c)||n.brokenReferences.push({entityType:e,entityId:o.templateId,referenceType:l,targetId:c}):l==="members"&&c.name&&(r.has(c.name)||n.brokenReferences.push({entityType:e,entityId:o.templateId,referenceType:"members",targetId:c.name})))})})}static validatePlaceholders(t,e,r){t.placeholders&&t.placeholders.forEach((n,s)=>{if(e.has(n.entityTemplateId)||r.errors.push(`Placeholder ${s}: entityTemplateId "${n.entityTemplateId}" does not exist in template`),(!n.field||n.field.trim()==="")&&r.errors.push(`Placeholder ${s}: field name is required`),(!n.placeholderText||n.placeholderText.trim()==="")&&r.warnings.push(`Placeholder ${s}: placeholder text is empty`),n.validationRule)try{new RegExp(n.validationRule)}catch(o){r.errors.push(`Placeholder ${s}: invalid validation rule regex "${n.validationRule}"`)}})}static validateVariables(t,e,r){if(!t.variables)return;let n=new Set;t.variables.forEach((s,o)=>{!s.name||s.name.trim()===""?r.errors.push(`Variable ${o}: name is required`):n.has(s.name)?r.errors.push(`Variable ${o}: duplicate variable name "${s.name}"`):n.add(s.name),(!s.label||s.label.trim()==="")&&r.warnings.push(`Variable ${o}: label is empty`),["text","number","boolean","select","date"].includes(s.type)||r.errors.push(`Variable ${o}: invalid type "${s.type}"`),s.type==="select"&&(!s.options||s.options.length===0)&&r.errors.push(`Variable ${o}: select type requires options`),s.usedIn&&s.usedIn.forEach((c,u)=>{e.has(c.entityTemplateId)||r.warnings.push(`Variable ${o}, usage ${u}: entityTemplateId "${c.entityTemplateId}" does not exist`)})})}static validateEntityTypes(t,e){let r=new Set,n=t.entities;n.characters&&n.characters.length>0&&r.add("character"),n.locations&&n.locations.length>0&&r.add("location"),n.events&&n.events.length>0&&r.add("event"),n.items&&n.items.length>0&&r.add("item"),n.groups&&n.groups.length>0&&r.add("group"),n.cultures&&n.cultures.length>0&&r.add("culture"),n.economies&&n.economies.length>0&&r.add("economy"),n.magicSystems&&n.magicSystems.length>0&&r.add("magicSystem"),n.chapters&&n.chapters.length>0&&r.add("chapter"),n.scenes&&n.scenes.length>0&&r.add("scene"),n.references&&n.references.length>0&&r.add("reference");let s=new Set(t.entityTypes);r.forEach(o=>{s.has(o)||e.warnings.push(`Template contains ${o} entities but they are not listed in entityTypes`)}),s.forEach(o=>{r.has(o)||e.warnings.push(`Template declares ${o} in entityTypes but contains no ${o} entities`)})}static validateQuick(t){let e=[];return(!t.name||t.name.trim()==="")&&e.push("Template name is required"),t.category||e.push("Template category is required"),t.genre||e.push("Template genre is required"),{isValid:e.length===0,errors:e}}}});var id,dP=_e(()=>{id=class{static substituteString(t,e,r=!1){let n=[],s=[],o=t,l=/\{\{(\w+)\}\}/g;return Array.from(t.matchAll(l)).forEach(u=>{let d=u[0],h=u[1];if(e.hasOwnProperty(h)){let f=e[h],m;f==null?(m="",n.push(`Variable "{{${h}}}" has no value, replaced with empty string`)):typeof f=="boolean"||typeof f=="number"?m=f.toString():Array.isArray(f)?m=f.join(", "):typeof f=="object"?(m=JSON.stringify(f),n.push(`Variable "{{${h}}}" is an object, converted to JSON`)):m=f.toString(),o=o.replace(d,m)}else r?s.push(`Variable "{{${h}}}" not found in provided values`):n.push(`Variable "{{${h}}}" not found, leaving as-is`)}),{success:s.length===0,value:o,warnings:n,errors:s}}static substituteObject(t,e,r=!1){let n=[],s=[];if(t==null)return{success:!0,value:t,warnings:n,errors:s};if(typeof t=="string")return this.substituteString(t,e,r);if(Array.isArray(t)){let o=[];return t.forEach((l,c)=>{let u=this.substituteObject(l,e,r);o.push(u.value),n.push(...u.warnings),s.push(...u.errors)}),{success:s.length===0,value:o,warnings:n,errors:s}}if(typeof t=="object"){let o={};for(let l in t)if(t.hasOwnProperty(l)){let c=this.substituteObject(t[l],e,r);o[l]=c.value,n.push(...c.warnings),s.push(...c.errors)}return{success:s.length===0,value:o,warnings:n,errors:s}}return{success:!0,value:t,warnings:n,errors:s}}static findVariables(t){let e=/\{\{(\w+)\}\}/g;return Array.from(t.matchAll(e)).map(n=>n[1])}static findVariablesInObject(t){let e=new Set;if(t==null)return[];if(typeof t=="string")this.findVariables(t).forEach(r=>e.add(r));else if(Array.isArray(t))t.forEach(r=>{this.findVariablesInObject(r).forEach(n=>e.add(n))});else if(typeof t=="object")for(let r in t)t.hasOwnProperty(r)&&this.findVariablesInObject(t[r]).forEach(n=>e.add(n));return Array.from(e)}static validateVariables(t,e){let r=[];return t.forEach(n=>{e.hasOwnProperty(n.name)||r.push(n.name)}),{isValid:r.length===0,missingVariables:r}}static previewSubstitution(t,e,r=100){let s=this.substituteString(t,e,!1).value;return s.length>r?s.substring(0,r)+"...":s}static substituteEntity(t,e,r=!1){let n=JSON.parse(JSON.stringify(t));return this.substituteObject(n,e,r)}static substituteEntities(t,e,r=!1){let n=[];t.forEach(o=>{let l=this.substituteEntity(o,e,r);n.push(l)});let s=n.every(o=>o.success);return{results:n,allSuccess:s}}static createSubstitutionSummary(t,e){let r=[];return t.forEach(n=>{let s=e[n.name],o=s!=null?s.toString():"(empty)";r.push(`{{${n.name}}} \u2192 ${o}`)}),r}static escapeRegex(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}static containsVariables(t){return/\{\{(\w+)\}\}/.test(t)}static getVariableUsageCount(t){let e=new Map,r=/\{\{(\w+)\}\}/g;return Array.from(t.matchAll(r)).forEach(s=>{let o=s[1],l=e.get(o)||0;e.set(o,l+1)}),e}static substitutePartial(t,e,r){let n=[],s=[],o=t;return e.forEach(l=>{if(r.hasOwnProperty(l)){let c=new RegExp(`\\{\\{${this.escapeRegex(l)}\\}\\}`,"g"),u=r[l],d=u!=null?u.toString():"";o=o.replace(c,d)}else n.push(`Variable "{{${l}}}" not found in values`)}),{success:s.length===0,value:o,warnings:n,errors:s}}}});var O4={};At(O4,{TemplateApplicator:()=>wv});var bv,wv,hP=_e(()=>{bv=require("obsidian");dP();oi();wv=class{constructor(t){this.idMap=new Map;this.groupIdMap=new Map;this.nameToIdMap=new Map;this.plugin=t}async applyTemplate(t,e){console.log("TemplateApplicator: Starting applyTemplate with:",{templateName:t.name,options:e});let r={success:!1,idMap:new Map,created:{characters:[],locations:[],events:[],items:[],groups:[],cultures:[],economies:[],magicSystems:[],chapters:[],scenes:[],references:[]},warnings:[]};try{this.idMap.clear(),this.groupIdMap.clear(),this.nameToIdMap.clear(),e.entityMapping&&e.entityMapping.forEach((c,u)=>{this.idMap.set(u,c)});let n=e.variableValues||{};console.log("TemplateApplicator: Variable values:",n);let s=this.substituteTemplateVariables(t,n);console.log("TemplateApplicator: Substituted template entities:",s.entities);let o=this.filterEntities(s.entities,e.includeEntities);console.log("TemplateApplicator: Filtered entities:",o),o.groups&&o.groups.length>0&&(console.log(`TemplateApplicator: Creating ${o.groups.length} groups`),r.created.groups=await this.createGroups(o.groups,e.storyId,e.fieldOverrides));let l=[];o.characters&&o.characters.length>0&&(console.log(`TemplateApplicator: Creating ${o.characters.length} characters`),l.push(this.createCharacters(o.characters,e.storyId,e.fieldOverrides).then(c=>{console.log(`TemplateApplicator: Created ${c.length} characters`),r.created.characters=c}))),o.locations&&o.locations.length>0&&l.push(this.createLocations(o.locations,e.storyId,e.fieldOverrides).then(c=>r.created.locations=c)),o.events&&o.events.length>0&&l.push(this.createEvents(o.events,e.storyId,e.fieldOverrides).then(c=>r.created.events=c)),o.items&&o.items.length>0&&l.push(this.createItems(o.items,e.storyId,e.fieldOverrides).then(c=>r.created.items=c)),o.cultures&&o.cultures.length>0&&l.push(this.createCultures(o.cultures,e.storyId,e.fieldOverrides).then(c=>r.created.cultures=c)),o.economies&&o.economies.length>0&&l.push(this.createEconomies(o.economies,e.storyId,e.fieldOverrides).then(c=>r.created.economies=c)),o.magicSystems&&o.magicSystems.length>0&&l.push(this.createMagicSystems(o.magicSystems,e.storyId,e.fieldOverrides).then(c=>r.created.magicSystems=c)),o.chapters&&o.chapters.length>0&&l.push(this.createChapters(o.chapters,e.storyId,e.fieldOverrides).then(c=>r.created.chapters=c)),o.scenes&&o.scenes.length>0&&(console.log(`TemplateApplicator: Creating ${o.scenes.length} scenes`),l.push(this.createScenes(o.scenes,e.storyId,e.fieldOverrides).then(c=>{console.log(`TemplateApplicator: Created ${c.length} scenes`),r.created.scenes=c}))),o.references&&o.references.length>0&&l.push(this.createReferences(o.references,e.storyId,e.fieldOverrides).then(c=>r.created.references=c)),console.log("TemplateApplicator: Waiting for all entity creation promises..."),await Promise.all(l),console.log("TemplateApplicator: All entities created:",r.created),console.log("TemplateApplicator: Mapping relationships..."),await this.mapAllRelationships(r.created,e.mergeRelationships||!1),console.log("TemplateApplicator: Saving all entities..."),await this.saveAllEntities(r.created),console.log("TemplateApplicator: All entities saved"),r.success=!0,r.idMap=new Map(this.idMap),await this.plugin.templateManager.incrementUsageCount(t.id),new bv.Notice(`Template "${t.name}" applied successfully!`)}catch(n){r.success=!1,r.error=n instanceof Error?n.message:"Unknown error occurred",new bv.Notice(`Failed to apply template: ${r.error}`,5e3)}return r}filterEntities(t,e){if(!e)return t;let r={};return e.characters&&t.characters?r.characters=t.characters.filter(n=>e.characters.includes(n.templateId)):e.characters||(r.characters=t.characters),e.locations&&t.locations?r.locations=t.locations.filter(n=>e.locations.includes(n.templateId)):e.locations||(r.locations=t.locations),e.events&&t.events?r.events=t.events.filter(n=>e.events.includes(n.templateId)):e.events||(r.events=t.events),e.items&&t.items?r.items=t.items.filter(n=>e.items.includes(n.templateId)):e.items||(r.items=t.items),e.groups&&t.groups?r.groups=t.groups.filter(n=>e.groups.includes(n.templateId)):e.groups||(r.groups=t.groups),e.cultures&&t.cultures?r.cultures=t.cultures.filter(n=>e.cultures.includes(n.templateId)):e.cultures||(r.cultures=t.cultures),e.economies&&t.economies?r.economies=t.economies.filter(n=>e.economies.includes(n.templateId)):e.economies||(r.economies=t.economies),e.magicSystems&&t.magicSystems?r.magicSystems=t.magicSystems.filter(n=>e.magicSystems.includes(n.templateId)):e.magicSystems||(r.magicSystems=t.magicSystems),e.chapters&&t.chapters?r.chapters=t.chapters.filter(n=>e.chapters.includes(n.templateId)):e.chapters||(r.chapters=t.chapters),e.scenes&&t.scenes?r.scenes=t.scenes.filter(n=>e.scenes.includes(n.templateId)):e.scenes||(r.scenes=t.scenes),e.references&&t.references?r.references=t.references.filter(n=>e.references.includes(n.templateId)):e.references||(r.references=t.references),r}async createGroups(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,{fields:l,sections:c}=this.processTemplateEntity(s),u=r==null?void 0:r.get(o),d={...l,...u,id:(u==null?void 0:u.id)||this.generateId(),storyId:e,members:l.members||[]};for(let[h,f]of Object.entries(c)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}this.idMap.set(o,d.id),this.groupIdMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),this.plugin.settings.groups.push(d),n.push(d)}return await this.plugin.saveSettings(),n}processTemplateEntity(t){let{templateId:e,yamlContent:r,markdownContent:n,sectionContent:s,customYamlFields:o,...l}=t,c={...l},u={};if(r&&typeof r=="string")try{let d=(0,bv.parseYaml)(r);d&&typeof d=="object"&&(c={...c,...d})}catch(d){console.warn("Failed to parse yamlContent:",d)}else o&&(c={...c,...o});if(n&&typeof n=="string")try{let d=Qn(`---
---

${n}`);u=d,"Description"in d&&(c.description=d.Description),"Backstory"in d&&(c.backstory=d.Backstory)}catch(d){console.warn("Failed to parse markdownContent:",d)}else if(s){u=s;for(let[d,h]of Object.entries(s)){let f=d.toLowerCase().replace(/\s+/g,"");c[f]=h}}return{fields:c,sections:u}}async createCharacters(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId(),relationships:[],locations:[],events:[],groups:[],connections:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createLocations(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId(),groups:[],connections:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createEvents(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId(),characters:[],groups:[],connections:[],dependencies:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createItems(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId(),isPlotCritical:c.isPlotCritical||!1,associatedEvents:[],groups:[],connections:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createCultures(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:this.generateId(),linkedLocations:[],linkedCharacters:[],linkedEvents:[],relatedCultures:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createEconomies(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId(),linkedLocations:[],linkedFactions:[],linkedCultures:[],linkedEvents:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createMagicSystems(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId(),linkedCharacters:[],linkedLocations:[],linkedCultures:[],linkedEvents:[],linkedItems:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createChapters(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId(),linkedCharacters:[],linkedLocations:[],linkedEvents:[],linkedItems:[],linkedGroups:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createScenes(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId(),linkedCharacters:[],linkedLocations:[],linkedEvents:[],linkedItems:[],linkedGroups:[]};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async createReferences(t,e,r){let n=[];for(let s of t){let{templateId:o}=s,l=r==null?void 0:r.get(o),{fields:c,sections:u}=this.processTemplateEntity(s),d={...c,...l,id:(l==null?void 0:l.id)||this.generateId()};for(let[h,f]of Object.entries(u)){let m=h.toLowerCase().replace(/\s+/g,"");d[m]=f}Object.defineProperty(d,"_templateSections",{value:u,enumerable:!1,writable:!0,configurable:!0}),this.idMap.set(o,d.id),this.nameToIdMap.set(d.name,d.id),n.push(d)}return n}async mapAllRelationships(t,e){for(let r of t.characters)r.relationships=this.mapRelationships(r.relationships),r.locations=this.mapStringArray(r.locations),r.events=this.mapStringArray(r.events),r.groups=this.mapGroups(r.groups),r.connections=this.mapTypedRelationships(r.connections);for(let r of t.locations)r.parentLocation&&(r.parentLocation=this.resolveId(r.parentLocation)||r.parentLocation),r.groups=this.mapGroups(r.groups),r.connections=this.mapTypedRelationships(r.connections);for(let r of t.events)r.characters=this.mapStringArray(r.characters),r.location&&(r.location=this.resolveId(r.location)||r.location),r.groups=this.mapGroups(r.groups),r.connections=this.mapTypedRelationships(r.connections),r.dependencies=this.mapStringArray(r.dependencies);for(let r of t.items)r.currentOwner&&(r.currentOwner=this.resolveId(r.currentOwner)||r.currentOwner),r.pastOwners=this.mapStringArray(r.pastOwners),r.currentLocation&&(r.currentLocation=this.resolveId(r.currentLocation)||r.currentLocation),r.associatedEvents=this.mapStringArray(r.associatedEvents),r.groups=this.mapGroups(r.groups),r.connections=this.mapTypedRelationships(r.connections);for(let r of t.groups)r.members&&(r.members=r.members.map(n=>({...n,name:this.resolveId(n.name)||n.name}))),r.territories=this.mapStringArray(r.territories),r.linkedEvents=this.mapStringArray(r.linkedEvents),r.parentGroup&&(r.parentGroup=this.resolveId(r.parentGroup)||r.parentGroup),r.subgroups=this.mapStringArray(r.subgroups),r.groupRelationships&&(r.groupRelationships=r.groupRelationships.map(n=>({...n,groupName:this.resolveId(n.groupName)||n.groupName})));for(let r of t.cultures)r.linkedLocations=this.mapStringArray(r.linkedLocations),r.linkedCharacters=this.mapStringArray(r.linkedCharacters),r.linkedEvents=this.mapStringArray(r.linkedEvents),r.relatedCultures=this.mapStringArray(r.relatedCultures),r.parentCulture&&(r.parentCulture=this.resolveId(r.parentCulture)||r.parentCulture);for(let r of t.economies)r.linkedLocations=this.mapStringArray(r.linkedLocations),r.linkedFactions=this.mapStringArray(r.linkedFactions),r.linkedCultures=this.mapStringArray(r.linkedCultures),r.linkedEvents=this.mapStringArray(r.linkedEvents);for(let r of t.magicSystems)r.linkedCharacters=this.mapStringArray(r.linkedCharacters),r.linkedLocations=this.mapStringArray(r.linkedLocations),r.linkedCultures=this.mapStringArray(r.linkedCultures),r.linkedEvents=this.mapStringArray(r.linkedEvents),r.linkedItems=this.mapStringArray(r.linkedItems);for(let r of t.chapters)r.linkedCharacters=this.mapStringArray(r.linkedCharacters),r.linkedLocations=this.mapStringArray(r.linkedLocations),r.linkedEvents=this.mapStringArray(r.linkedEvents),r.linkedItems=this.mapStringArray(r.linkedItems),r.linkedGroups=this.mapGroups(r.linkedGroups);for(let r of t.scenes)r.chapterId&&(r.chapterId=this.resolveId(r.chapterId)||r.chapterId),r.linkedCharacters=this.mapStringArray(r.linkedCharacters),r.linkedLocations=this.mapStringArray(r.linkedLocations),r.linkedEvents=this.mapStringArray(r.linkedEvents),r.linkedItems=this.mapStringArray(r.linkedItems),r.linkedGroups=this.mapGroups(r.linkedGroups)}resolveId(t){if(t)return this.idMap.get(t)||this.nameToIdMap.get(t)}mapStringArray(t){return t?t.map(e=>this.resolveId(e)||e).filter(e=>e!==void 0):[]}mapGroups(t){return t?t.map(e=>this.groupIdMap.get(e)||e).filter(e=>e!==void 0):[]}mapTypedRelationships(t){return t?t.map(e=>({...e,target:this.resolveId(e.target)||e.target})):[]}mapRelationships(t){return t?t.map(e=>typeof e=="string"?this.resolveId(e)||e:{...e,target:this.resolveId(e.target)||e.target}):[]}async saveAllEntities(t){let e=[];for(let r of t.characters)e.push(this.plugin.saveCharacter(r));for(let r of t.locations)e.push(this.plugin.saveLocation(r));for(let r of t.events)e.push(this.plugin.saveEvent(r));for(let r of t.items)e.push(this.plugin.savePlotItem(r));for(let r of t.cultures)e.push(this.plugin.saveCulture(r));for(let r of t.economies)e.push(this.plugin.saveEconomy(r));for(let r of t.magicSystems)e.push(this.plugin.saveMagicSystem(r));for(let r of t.chapters)e.push(this.plugin.saveChapter(r));for(let r of t.scenes)e.push(this.plugin.saveScene(r));for(let r of t.references)e.push(this.plugin.saveReference(r));await Promise.all(e)}substituteTemplateVariables(t,e){if(!t.variables||t.variables.length===0||Object.keys(e).length===0)return t;let r=JSON.parse(JSON.stringify(t)),n=[],s=o=>!o||o.length===0?o:o.map(l=>{let c=id.substituteEntity(l,e,!1);return c.warnings.length>0&&n.push(...c.warnings),c.value});return r.entities.characters=s(r.entities.characters),r.entities.locations=s(r.entities.locations),r.entities.events=s(r.entities.events),r.entities.items=s(r.entities.items),r.entities.groups=s(r.entities.groups),r.entities.cultures=s(r.entities.cultures),r.entities.economies=s(r.entities.economies),r.entities.magicSystems=s(r.entities.magicSystems),r.entities.chapters=s(r.entities.chapters),r.entities.scenes=s(r.entities.scenes),r.entities.references=s(r.entities.references),n.length>0&&console.warn("Template variable substitution warnings:",n),r}generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}});var CE={};At(CE,{TemplateLibraryModal:()=>fP});var Yn,fP,pP,_E=_e(()=>{Yn=require("obsidian");ea();H0();fP=class extends hr{constructor(e,r,n){super(e);this.filter={showBuiltIn:!0,showCustom:!0};this.templates=[];this.plugin=r,this.onTemplateSelected=n}onOpen(){super.onOpen(),this.refreshTemplates(),this.displayContent()}refreshTemplates(){this.templates=this.plugin.templateManager.getFilteredTemplates(this.filter)}displayContent(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:"Template Library"}),this.createFilterSection(e),this.createTemplateList(e);let r=e.createEl("button",{text:"Create New Template",cls:"mod-cta"});r.style.marginTop="1em",r.addEventListener("click",()=>this.handleCreateNew())}createFilterSection(e){let r=e.createDiv({cls:"template-library-filters"});new Yn.Setting(r).setName("Search").setDesc("Search templates by name, description, or tags").addText(n=>n.setPlaceholder("Search...").setValue(this.filter.searchText||"").onChange(s=>{this.filter.searchText=s||void 0,this.refreshAndDisplay()})),new Yn.Setting(r).setName("Genre").setDesc("Filter by genre").addDropdown(n=>{n.addOption("","All Genres"),n.addOption("fantasy","Fantasy"),n.addOption("scifi","Sci-Fi"),n.addOption("mystery","Mystery"),n.addOption("horror","Horror"),n.addOption("romance","Romance"),n.addOption("historical","Historical"),n.addOption("western","Western"),n.addOption("thriller","Thriller"),n.addOption("custom","Custom"),n.setValue(""),n.onChange(s=>{this.filter.genre=s?[s]:void 0,this.refreshAndDisplay()})}),new Yn.Setting(r).setName("Category").setDesc("Filter by category").addDropdown(n=>{n.addOption("","All Categories"),n.addOption("single-entity","Single Entity"),n.addOption("entity-set","Entity Set"),n.addOption("full-world","Full World"),n.setValue(""),n.onChange(s=>{this.filter.category=s?[s]:void 0,this.refreshAndDisplay()})}),new Yn.Setting(r).setName("Show Built-in Templates").addToggle(n=>n.setValue(this.filter.showBuiltIn!==!1).onChange(s=>{this.filter.showBuiltIn=s,this.refreshAndDisplay()})),new Yn.Setting(r).setName("Show Custom Templates").addToggle(n=>n.setValue(this.filter.showCustom!==!1).onChange(s=>{this.filter.showCustom=s,this.refreshAndDisplay()})),new Yn.Setting(r).setName("Sort By").setDesc("Sort templates").addDropdown(n=>{n.addOption("name","Name"),n.addOption("usage","Usage Count"),n.addOption("recent","Recently Used"),n.setValue("name"),n.onChange(s=>{this.filter.sortByUsage=s==="usage",this.filter.sortByRecent=s==="recent",this.refreshAndDisplay()})})}createTemplateList(e){let r=e.createDiv({cls:"template-library-list"});if(this.templates.length===0){r.createEl("p",{text:"No templates found. Try adjusting your filters or create a new template.",cls:"template-library-empty"});return}r.createEl("p",{text:`Found ${this.templates.length} template${this.templates.length!==1?"s":""}`,cls:"template-library-count"}),this.templates.forEach(n=>{this.createTemplateCard(r,n)})}createTemplateCard(e,r){let n=e.createDiv({cls:"template-card"}),s=r.isNoteBased===!0,o=n.createDiv({cls:"template-card-header"});o.createEl("h3",{text:r.name}),r.isBuiltIn&&o.createEl("span",{text:"Built-in",cls:"template-badge template-badge-builtin"}),s&&o.createEl("span",{text:"Note-based",cls:"template-badge template-badge-note"}),n.createEl("p",{text:r.description,cls:"template-card-description"});let l=n.createDiv({cls:"template-card-meta"});if(l.createEl("span",{text:`Genre: ${r.genre}`}),l.createEl("span",{text:`Category: ${r.category}`}),r.usageCount&&r.usageCount>0&&l.createEl("span",{text:`Used: ${r.usageCount} times`}),r.entityTypes&&r.entityTypes.length>0){let d=n.createDiv({cls:"template-card-entity-types"});d.createEl("span",{text:"Contains: "}),r.entityTypes.forEach(h=>{d.createEl("span",{text:h,cls:"template-entity-type-badge"})})}if(r.tags&&r.tags.length>0){let d=n.createDiv({cls:"template-card-tags"});r.tags.forEach(h=>{d.createEl("span",{text:h,cls:"template-tag"})})}let c=n.createDiv({cls:"template-card-actions"});c.createEl("button",{text:"Apply Template",cls:"mod-cta"}).addEventListener("click",()=>this.handleUseTemplate(r)),s?(c.createEl("button",{text:"Edit in Obsidian"}).addEventListener("click",()=>this.handleEditNoteTemplate(r)),c.createEl("button",{text:"Convert to Full Template"}).addEventListener("click",()=>this.handleConvertToFullTemplate(r)),c.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>this.handleDeleteNoteTemplate(r))):(r.isEditable&&(c.createEl("button",{text:"Edit"}).addEventListener("click",()=>this.handleEditTemplate(r)),c.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>this.handleDeleteTemplate(r))),c.createEl("button",{text:"Duplicate"}).addEventListener("click",()=>this.handleDuplicateTemplate(r)))}refreshAndDisplay(){this.refreshTemplates(),this.displayContent()}async handleUseTemplate(e){console.log("TemplateLibraryModal: handleUseTemplate called with template:",e.name);let r=this.plugin.getActiveStory();if(console.log("TemplateLibraryModal: Active story:",r),!r){new Yn.Notice("Please select or create a story first before applying a template.");return}if(this.onTemplateSelected){console.log("TemplateLibraryModal: Using onTemplateSelected callback"),this.onTemplateSelected(e),this.close();return}console.log("TemplateLibraryModal: Closing modal and applying template"),this.close(),await this.plugin.applyTemplateWithPrompt(e),console.log("TemplateLibraryModal: applyTemplateWithPrompt completed")}handleEditTemplate(e){new Fs(this.app,this.plugin,e,async r=>{this.refreshAndDisplay()}).open()}async handleDeleteTemplate(e){if(await this.confirmDelete(e.name))try{await this.plugin.templateManager.deleteTemplate(e.id),this.refreshAndDisplay()}catch(n){console.error("Error deleting template:",n),new Yn.Notice(`Failed to delete template: ${n.message}`)}}async handleDuplicateTemplate(e){try{let r=`${e.name} (Copy)`,n=await this.plugin.templateManager.copyTemplate(e.id,r);new Yn.Notice(`Template duplicated as "${r}"`),this.refreshAndDisplay()}catch(r){console.error("Error duplicating template:",r),new Yn.Notice(`Failed to duplicate template: ${r.message}`)}}handleCreateNew(){new Fs(this.app,this.plugin,null,async e=>{this.refreshAndDisplay()}).open()}handleEditNoteTemplate(e){let r=e.noteFilePath;r?this.app.vault.getAbstractFileByPath(r)?(this.app.workspace.openLinkText(r,"",!0),this.close()):new Yn.Notice("Template note file not found"):new Yn.Notice("Template note file path not available")}handleConvertToFullTemplate(e){new Fs(this.app,this.plugin,e,async r=>{this.refreshAndDisplay()}).open()}async handleDeleteNoteTemplate(e){if(await this.confirmDelete(e.name))try{this.plugin.templateNoteManager?await this.plugin.templateNoteManager.deleteNoteTemplate(e.id):await this.plugin.templateManager.deleteTemplate(e.id),this.refreshAndDisplay()}catch(n){console.error("Error deleting note template:",n),new Yn.Notice(`Failed to delete template: ${n.message}`)}}async confirmDelete(e){return new Promise(r=>{new pP(this.app,e,r).open()})}},pP=class extends hr{constructor(t,e,r){super(t),this.templateName=e,this.onConfirm=r}onOpen(){super.onOpen();let{contentEl:t}=this;t.createEl("h2",{text:"Delete Template?"}),t.createEl("p",{text:`Are you sure you want to delete the template "${this.templateName}"? This action cannot be undone.`});let e=t.createDiv({cls:"modal-button-container"});e.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.onConfirm(!1),this.close()}),e.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.onConfirm(!0),this.close()})}}});function UTe(a){let t={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3},e=0,r=a.toUpperCase();for(let n=0;n<r.length;n++){let s=t[r[n]],o=t[r[n+1]];o&&s<o?e-=s:e+=s}return e}function SE(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}var GTe,VTe,WTe,xE,F4=_e(()=>{GTe=[/^\s*\*\s*\*\s*\*\s*$/,/^\s*\*{3,}\s*$/,/^\s*-{3,}\s*$/,/^\s*~{3,}\s*$/,/^\s*#\s*#\s*#\s*$/,/^\s*#{3,}\s*$/,/^\s*\.\s*\.\s*\.\s*$/,/^\s*={3,}\s*$/],VTe={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19,twenty:20},WTe=[{name:"Chapter [number]: [title]",regex:/^(?:Chapter|CHAPTER|Ch\.?)\s+(\d+)(?::\s*(.+))?$/i,confidence:95,extractNumber:a=>parseInt(a[1],10),extractTitle:a=>{var t;return((t=a[2])==null?void 0:t.trim())||""}},{name:"Chapter [word number]",regex:/^(?:Chapter|CHAPTER)\s+(one|two|three|four|five|six|seven|eight|nine|ten|eleven|twelve|thirteen|fourteen|fifteen|sixteen|seventeen|eighteen|nineteen|twenty)(?::\s*(.+))?$/i,confidence:90,extractNumber:a=>VTe[a[1].toLowerCase()],extractTitle:a=>{var t;return((t=a[2])==null?void 0:t.trim())||""}},{name:"--- Chapter [number] ---",regex:/^[-=]+\s*(?:Chapter|CHAPTER)\s+(\d+)(?::\s*(.+))?\s*[-=]+$/i,confidence:85,extractNumber:a=>parseInt(a[1],10),extractTitle:a=>{var t;return((t=a[2])==null?void 0:t.trim())||""}},{name:"CHAPTER [number]",regex:/^CHAPTER\s+(\d+)(?::\s*(.+))?$/,confidence:80,extractNumber:a=>parseInt(a[1],10),extractTitle:a=>{var t;return((t=a[2])==null?void 0:t.trim())||""}},{name:"Chapter [Roman]",regex:/^(?:Chapter|CHAPTER)\s+([IVXLCDM]+)(?::\s*(.+))?$/i,confidence:75,extractNumber:a=>UTe(a[1]),extractTitle:a=>{var t;return((t=a[2])==null?void 0:t.trim())||""}}];xE=class{constructor(){this.name="Plain Text Parser";this.format="plaintext"}canParse(t,e){let r=e.toLowerCase().split(".").pop();return r==="txt"||!r}parse(t,e){let r=t.split(`
`),n=WTe.map(f=>({pattern:f,matches:this.findChapterMatches(r,f)})),s=n[0],o=s.matches.length*s.pattern.confidence;for(let f of n){let m=f.matches.length*f.pattern.confidence;m>o&&f.matches.length>=2&&(s=f,o=m)}let l=s.matches,c=[];if(l.length===0){c.push("No chapter markers found. Treating entire document as one chapter.");let f={title:e.replace(/\.(txt|md)$/i,""),number:1,content:t,wordCount:SE(t),startLine:0,endLine:r.length-1};return{metadata:{title:e,totalWords:SE(t),chapterCount:1,confidence:50,detectionMethod:"No chapters detected"},chapters:[f],warnings:c,format:this.format}}let u=[];for(let f=0;f<l.length;f++){let m=l[f],g=l[f+1],y=m.lineIndex+1,v=g?g.lineIndex-1:r.length-1,C=r.slice(y,v+1).join(`
`).trim();if(C.length===0){c.push(`Chapter ${m.number} is empty and was skipped.`);continue}let _=this.detectScenes(C);u.push({title:m.title||`Chapter ${m.number}`,number:m.number,content:C,wordCount:SE(C),startLine:y,endLine:v,scenes:_.length>1?_:void 0})}let d=u.map(f=>f.number).filter(f=>f!==void 0);d.length>1&&(d.every((m,g)=>g===0||m===d[g-1]+1)||c.push("Chapter numbering is not sequential. Please review chapter numbers."));let h=u.reduce((f,m)=>f+m.wordCount,0);return{metadata:{title:this.extractTitle(r),totalWords:h,chapterCount:u.length,confidence:s.pattern.confidence,detectionMethod:s.pattern.name},chapters:u,warnings:c,format:this.format}}findChapterMatches(t,e){let r=[];for(let n=0;n<t.length;n++){let o=t[n].trim().match(e.regex);o&&r.push({lineIndex:n,number:e.extractNumber(o),title:e.extractTitle(o)})}return r}extractTitle(t){let e=t.slice(0,10).filter(n=>n.trim().length>0);if(e.length===0)return;let r=e[0].trim();if(r.length>0&&r.length<100&&!r.match(/^(?:Chapter|CHAPTER|Ch\.)/i))return r}detectScenes(t){let e=t.split(`
`),r=[],n=[],s=[];for(let o of e)if(GTe.some(c=>c.test(o))){if(s.length>0){let c=s.join(`
`).trim();c.length>0&&n.push(c)}s=[]}else s.push(o);if(s.length>0){let o=s.join(`
`).trim();o.length>0&&n.push(o)}for(let o=0;o<n.length;o++){let l=n[o];r.push({title:`Scene ${o+1}`,content:l,wordCount:SE(l)})}return r}}});function kE(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}function YTe(a){let t=a.match(/(\d+)/);if(t)return parseInt(t[1],10);let e={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15},r=a.toLowerCase();for(let[n,s]of Object.entries(e))if(r.includes(n))return s}var jTe,DE,R4=_e(()=>{jTe=[/^\s*\*\s*\*\s*\*\s*$/,/^\s*\*{3,}\s*$/,/^\s*-{3,}\s*$/,/^\s*~{3,}\s*$/,/^\s*#{3,}\s*$/,/^\s*\.\s*\.\s*\.\s*$/,/^\s*={3,}\s*$/];DE=class{constructor(){this.name="Markdown Parser";this.format="markdown"}canParse(t,e){let r=e.toLowerCase().split(".").pop();return r==="md"||r==="markdown"}parse(t,e){let r=t.split(`
`),n=this.extractHeadings(r);if(n.length===0)return this.parseAsPlainText(t,e);let s=this.determineChapterLevel(n),o=this.extractChapters(n,s,r),l=[];if(o.length===0)return l.push("No chapters found. Document structure may not follow expected heading hierarchy."),this.parseAsPlainText(t,e);let c=o.map(d=>d.number).filter(d=>d!==void 0);c.length>1&&(c.every((h,f)=>f===0||h===c[f-1]+1)||l.push("Chapter numbering is not sequential. Please review chapter numbers."));let u=o.reduce((d,h)=>d+h.wordCount,0);return{metadata:{title:this.extractDocumentTitle(n),totalWords:u,chapterCount:o.length,confidence:90,detectionMethod:`Heading ${s} as chapters`},chapters:o,warnings:l,format:this.format}}extractHeadings(t){let e=[];for(let r=0;r<t.length;r++){let s=t[r].match(/^(#{1,6})\s+(.+)$/);if(s){let o=s[1].length,l=s[2].trim(),c=r+1,u=[];for(;c<t.length&&!t[c].match(/^#{1,6}\s+/);)u.push(t[c]),c++;e.push({level:o,text:l,lineIndex:r,content:u.join(`
`).trim()})}}return e}determineChapterLevel(t){let e=new Map;for(let s of t)e.set(s.level,(e.get(s.level)||0)+1);if((e.get(1)||0)>1)return 1;if((e.get(1)||0)===1&&(e.get(2)||0)>0)return 2;let r=0,n=1;for(let[s,o]of e.entries())o>r&&(r=o,n=s);return n}extractChapters(t,e,r){let n=t.filter(o=>o.level===e),s=[];for(let o=0;o<n.length;o++){let l=n[o],c=n[o+1],u=l.lineIndex+1,d=c?c.lineIndex-1:r.length-1,f=r.slice(u,d+1).join(`
`).trim();if(f.length===0)continue;let m=this.detectScenes(f);s.push({title:l.text,number:YTe(l.text),content:f,wordCount:kE(f),startLine:u,endLine:d,scenes:m.length>1?m:void 0})}return s}detectScenes(t){let e=t.split(`
`),r=[],n=[],s=[];for(let o of e)if(jTe.some(c=>c.test(o))){if(s.length>0){let c=s.join(`
`).trim();c.length>0&&n.push(c)}s=[]}else s.push(o);if(s.length>0){let o=s.join(`
`).trim();o.length>0&&n.push(o)}for(let o=0;o<n.length;o++){let l=n[o];r.push({title:`Scene ${o+1}`,content:l,wordCount:kE(l)})}return r}extractDocumentTitle(t){if(t.length>0&&t[0].level===1&&t.filter(r=>r.level===1).length===1)return t[0].text}parseAsPlainText(t,e){let r={title:e.replace(/\.(md|markdown)$/i,""),number:1,content:t,wordCount:kE(t),startLine:0,endLine:t.split(`
`).length-1};return{metadata:{title:e,totalWords:kE(t),chapterCount:1,confidence:50,detectionMethod:"No structure detected"},chapters:[r],warnings:["No markdown headings found. Treating entire document as one chapter."],format:this.format}}}});function Ev(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}function qTe(a){let t=a.match(/(\d+)/);if(t)return parseInt(t[1],10);let e={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19,twenty:20},r=a.toLowerCase();for(let[n,s]of Object.entries(e))if(r.includes(n))return s}var PE,N4=_e(()=>{PE=class{constructor(){this.name="DOCX Parser";this.format="docx"}canParse(t,e){return e.toLowerCase().split(".").pop()==="docx"}parse(t,e){return this.parseFromHtml("",e)}async parseAsync(t,e){try{let n=await(await import("mammoth")).convertToHtml({arrayBuffer:t}),s=n.value,o=n.messages;return o.length>0&&console.log("DOCX conversion messages:",o),this.parseFromHtml(s,e)}catch(r){return console.error("Error parsing DOCX:",r),{metadata:{title:e,totalWords:0,chapterCount:0,confidence:0,detectionMethod:"DOCX parse failed"},chapters:[],warnings:[`Failed to parse DOCX file: ${r}. Make sure mammoth is installed.`],format:this.format}}}parseFromHtml(t,e){if(!t||t.trim().length===0)return{metadata:{title:e,totalWords:0,chapterCount:1,confidence:50,detectionMethod:"Empty document"},chapters:[{title:e.replace(/\.docx$/i,""),number:1,content:"",wordCount:0}],warnings:["Document appears to be empty or could not be parsed."],format:this.format};let n=new DOMParser().parseFromString(t,"text/html"),s=n.querySelectorAll("h1, h2, h3, h4, h5, h6");if(s.length===0){let h=n.body.textContent||"";return{metadata:{title:e,totalWords:Ev(h),chapterCount:1,confidence:50,detectionMethod:"No headings found"},chapters:[{title:e.replace(/\.docx$/i,""),number:1,content:h,wordCount:Ev(h)}],warnings:["No heading structure found. Document imported as single chapter."],format:this.format}}let o=this.determineChapterLevel(s),l=this.extractChapters(n,s,o),c=[];if(l.length===0){c.push("No chapters could be extracted from document structure.");let h=n.body.textContent||"";return{metadata:{title:e,totalWords:Ev(h),chapterCount:1,confidence:50,detectionMethod:"No chapters extracted"},chapters:[{title:e.replace(/\.docx$/i,""),number:1,content:h,wordCount:Ev(h)}],warnings:c,format:this.format}}let u=l.map(h=>h.number).filter(h=>h!==void 0);u.length>1&&(u.every((f,m)=>m===0||f===u[m-1]+1)||c.push("Chapter numbering is not sequential. Please review chapter numbers."));let d=l.reduce((h,f)=>h+f.wordCount,0);return{metadata:{title:this.extractDocumentTitle(n)||e.replace(/\.docx$/i,""),totalWords:d,chapterCount:l.length,confidence:85,detectionMethod:`H${o} as chapters`},chapters:l,warnings:c,format:this.format}}determineChapterLevel(t){let e=new Map;if(t.forEach(s=>{let o=parseInt(s.tagName[1],10);e.set(o,(e.get(o)||0)+1)}),(e.get(1)||0)>1)return 1;if((e.get(1)||0)===1&&(e.get(2)||0)>0)return 2;let r=0,n=1;for(let[s,o]of e.entries())o>r&&(r=o,n=s);return n}extractChapters(t,e,r){var o;let n=[],s=Array.from(e).filter(l=>parseInt(l.tagName[1],10)===r);for(let l=0;l<s.length;l++){let c=s[l],u=s[l+1],d=c.textContent||"",h=[],f=c.nextElementSibling;for(;f&&f!==u&&!(f.tagName.match(/^H[1-6]$/)&&parseInt(f.tagName[1],10)===r);){let g=(o=f.textContent)==null?void 0:o.trim();g&&h.push(g),f=f.nextElementSibling}let m=h.join(`

`);m.length!==0&&n.push({title:d.trim(),number:qTe(d),content:m,wordCount:Ev(m)})}return n}extractDocumentTitle(t){var r;let e=t.querySelectorAll("h1");if(e.length===1)return(r=e[0].textContent)==null?void 0:r.trim()}}});function B4(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}var LE,$4=_e(()=>{LE=class{constructor(){this.name="JSON Parser";this.format="json"}canParse(t,e){if(e.toLowerCase().split(".").pop()!=="json")return!1;try{let n=JSON.parse(t);return this.isValidStoryJson(n)}catch(n){return!1}}parse(t,e){try{let r=JSON.parse(t);return this.parseStoryJson(r,e)}catch(r){return{metadata:{title:e,totalWords:0,chapterCount:0,confidence:0,detectionMethod:"JSON parse failed"},chapters:[],warnings:[`Failed to parse JSON: ${r}`],format:this.format}}}isValidStoryJson(t){if(!t||typeof t!="object")return!1;let e=t;return Array.isArray(e.chapters)?e.chapters.every(r=>{if(!r||typeof r!="object")return!1;let n=r;return typeof n.title=="string"&&typeof n.content=="string"}):!1}parseStoryJson(t,e){var l;let r=[],n=[];for(let c=0;c<t.chapters.length;c++){let u=t.chapters[c],d=u.content;u.summary&&u.summary!==u.content&&(d=`${u.summary}

${u.content}`);let h=[];if(u.scenes&&u.scenes.length>0)for(let m of u.scenes)h.push({title:m.title,content:m.content,wordCount:B4(m.content)});let f={title:u.title,number:(l=u.number)!=null?l:c+1,content:d,wordCount:B4(d),scenes:h.length>0?h:void 0};n.push(f)}let s=n.map(c=>c.number).filter(c=>c!==void 0);s.length>1&&new Set(s).size!==s.length&&r.push("Duplicate chapter numbers found in JSON data.");let o=n.reduce((c,u)=>c+u.wordCount,0);return{metadata:{title:t.title||e.replace(/\.json$/i,""),author:t.author,totalWords:o,chapterCount:n.length,confidence:100,detectionMethod:"JSON structure"},chapters:n,warnings:r,format:this.format}}}});var gP=uy((z4,mP)=>{(function(a){typeof z4=="object"&&typeof mP!="undefined"?mP.exports=a():typeof define=="function"&&define.amd?define([],a):(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this).JSZip=a()})(function(){return(function a(t,e,r){function n(l,c){if(!e[l]){if(!t[l]){var u=typeof require=="function"&&require;if(!c&&u)return u(l,!0);if(s)return s(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=e[l]={exports:{}};t[l][0].call(h.exports,function(f){var m=t[l][1][f];return n(m||f)},h,h.exports,a,t,e,r)}return e[l].exports}for(var s=typeof require=="function"&&require,o=0;o<r.length;o++)n(r[o]);return n})({1:[function(a,t,e){"use strict";var r=a("./utils"),n=a("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.encode=function(o){for(var l,c,u,d,h,f,m,g=[],y=0,v=o.length,E=v,C=r.getTypeOf(o)!=="string";y<o.length;)E=v-y,u=C?(l=o[y++],c=y<v?o[y++]:0,y<v?o[y++]:0):(l=o.charCodeAt(y++),c=y<v?o.charCodeAt(y++):0,y<v?o.charCodeAt(y++):0),d=l>>2,h=(3&l)<<4|c>>4,f=1<E?(15&c)<<2|u>>6:64,m=2<E?63&u:64,g.push(s.charAt(d)+s.charAt(h)+s.charAt(f)+s.charAt(m));return g.join("")},e.decode=function(o){var l,c,u,d,h,f,m=0,g=0,y="data:";if(o.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var v,E=3*(o=o.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(o.charAt(o.length-1)===s.charAt(64)&&E--,o.charAt(o.length-2)===s.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=n.uint8array?new Uint8Array(0|E):new Array(0|E);m<o.length;)l=s.indexOf(o.charAt(m++))<<2|(d=s.indexOf(o.charAt(m++)))>>4,c=(15&d)<<4|(h=s.indexOf(o.charAt(m++)))>>2,u=(3&h)<<6|(f=s.indexOf(o.charAt(m++))),v[g++]=l,h!==64&&(v[g++]=c),f!==64&&(v[g++]=u);return v}},{"./support":30,"./utils":32}],2:[function(a,t,e){"use strict";var r=a("./external"),n=a("./stream/DataWorker"),s=a("./stream/Crc32Probe"),o=a("./stream/DataLengthProbe");function l(c,u,d,h,f){this.compressedSize=c,this.uncompressedSize=u,this.crc32=d,this.compression=h,this.compressedContent=f}l.prototype={getContentWorker:function(){var c=new n(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),u=this;return c.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new n(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(c,u,d){return c.pipe(new s).pipe(new o("uncompressedSize")).pipe(u.compressWorker(d)).pipe(new o("compressedSize")).withStreamInfo("compression",u)},t.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(a,t,e){"use strict";var r=a("./stream/GenericWorker");e.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},e.DEFLATE=a("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(a,t,e){"use strict";var r=a("./utils"),n=(function(){for(var s,o=[],l=0;l<256;l++){s=l;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;o[l]=s}return o})();t.exports=function(s,o){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?(function(l,c,u,d){var h=n,f=d+u;l^=-1;for(var m=d;m<f;m++)l=l>>>8^h[255&(l^c[m])];return-1^l})(0|o,s,s.length,0):(function(l,c,u,d){var h=n,f=d+u;l^=-1;for(var m=d;m<f;m++)l=l>>>8^h[255&(l^c.charCodeAt(m))];return-1^l})(0|o,s,s.length,0):0}},{"./utils":32}],5:[function(a,t,e){"use strict";e.base64=!1,e.binary=!1,e.dir=!1,e.createFolders=!0,e.date=null,e.compression=null,e.compressionOptions=null,e.comment=null,e.unixPermissions=null,e.dosPermissions=null},{}],6:[function(a,t,e){"use strict";var r=null;r=typeof Promise!="undefined"?Promise:a("lie"),t.exports={Promise:r}},{lie:37}],7:[function(a,t,e){"use strict";var r=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",n=a("pako"),s=a("./utils"),o=a("./stream/GenericWorker"),l=r?"uint8array":"array";function c(u,d){o.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=d,this.meta={}}e.magic="\b\0",s.inherits(c,o),c.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(l,u.data),!1)},c.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(d){u.push({data:d,meta:u.meta})}},e.compressWorker=function(u){return new c("Deflate",u)},e.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(a,t,e){"use strict";function r(h,f){var m,g="";for(m=0;m<f;m++)g+=String.fromCharCode(255&h),h>>>=8;return g}function n(h,f,m,g,y,v){var E,C,_=h.file,x=h.compression,P=v!==l.utf8encode,I=s.transformTo("string",v(_.name)),M=s.transformTo("string",l.utf8encode(_.name)),O=_.comment,R=s.transformTo("string",v(O)),F=s.transformTo("string",l.utf8encode(O)),$=M.length!==_.name.length,k=F.length!==O.length,N="",G="",W="",Y=_.dir,U=_.date,Z={crc32:0,compressedSize:0,uncompressedSize:0};f&&!m||(Z.crc32=h.crc32,Z.compressedSize=h.compressedSize,Z.uncompressedSize=h.uncompressedSize);var q=0;f&&(q|=8),P||!$&&!k||(q|=2048);var X=0,ie=0;Y&&(X|=16),y==="UNIX"?(ie=798,X|=(function(K,se){var ne=K;return K||(ne=se?16893:33204),(65535&ne)<<16})(_.unixPermissions,Y)):(ie=20,X|=(function(K){return 63&(K||0)})(_.dosPermissions)),E=U.getUTCHours(),E<<=6,E|=U.getUTCMinutes(),E<<=5,E|=U.getUTCSeconds()/2,C=U.getUTCFullYear()-1980,C<<=4,C|=U.getUTCMonth()+1,C<<=5,C|=U.getUTCDate(),$&&(G=r(1,1)+r(c(I),4)+M,N+="up"+r(G.length,2)+G),k&&(W=r(1,1)+r(c(R),4)+F,N+="uc"+r(W.length,2)+W);var j="";return j+=`
\0`,j+=r(q,2),j+=x.magic,j+=r(E,2),j+=r(C,2),j+=r(Z.crc32,4),j+=r(Z.compressedSize,4),j+=r(Z.uncompressedSize,4),j+=r(I.length,2),j+=r(N.length,2),{fileRecord:u.LOCAL_FILE_HEADER+j+I+N,dirRecord:u.CENTRAL_FILE_HEADER+r(ie,2)+j+r(R.length,2)+"\0\0\0\0"+r(X,4)+r(g,4)+I+N+R}}var s=a("../utils"),o=a("../stream/GenericWorker"),l=a("../utf8"),c=a("../crc32"),u=a("../signature");function d(h,f,m,g){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=f,this.zipPlatform=m,this.encodeFileName=g,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(d,o),d.prototype.push=function(h){var f=h.meta.percent||0,m=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,o.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:m?(f+100*(m-g-1))/m:100}}))},d.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var f=this.streamFiles&&!h.file.dir;if(f){var m=n(h,f,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(h){this.accumulate=!1;var f=this.streamFiles&&!h.file.dir,m=n(h,f,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),f)this.push({data:(function(g){return u.DATA_DESCRIPTOR+r(g.crc32,4)+r(g.compressedSize,4)+r(g.uncompressedSize,4)})(h),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var h=this.bytesWritten,f=0;f<this.dirRecords.length;f++)this.push({data:this.dirRecords[f],meta:{percent:100}});var m=this.bytesWritten-h,g=(function(y,v,E,C,_){var x=s.transformTo("string",_(C));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(y,2)+r(y,2)+r(v,4)+r(E,4)+r(x.length,2)+x})(this.dirRecords.length,m,h,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(h){this._sources.push(h);var f=this;return h.on("data",function(m){f.processChunk(m)}),h.on("end",function(){f.closedSource(f.previous.streamInfo),f._sources.length?f.prepareNextSource():f.end()}),h.on("error",function(m){f.error(m)}),this},d.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(h){var f=this._sources;if(!o.prototype.error.call(this,h))return!1;for(var m=0;m<f.length;m++)try{f[m].error(h)}catch(g){}return!0},d.prototype.lock=function(){o.prototype.lock.call(this);for(var h=this._sources,f=0;f<h.length;f++)h[f].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(a,t,e){"use strict";var r=a("../compressions"),n=a("./ZipFileWorker");e.generateWorker=function(s,o,l){var c=new n(o.streamFiles,l,o.platform,o.encodeFileName),u=0;try{s.forEach(function(d,h){u++;var f=(function(v,E){var C=v||E,_=r[C];if(!_)throw new Error(C+" is not a valid compression method !");return _})(h.options.compression,o.compression),m=h.options.compressionOptions||o.compressionOptions||{},g=h.dir,y=h.date;h._compressWorker(f,m).withStreamInfo("file",{name:d,dir:g,date:y,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(c)}),c.entriesCount=u}catch(d){c.error(d)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(a,t,e){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new r;for(var s in this)typeof this[s]!="function"&&(n[s]=this[s]);return n}}(r.prototype=a("./object")).loadAsync=a("./load"),r.support=a("./support"),r.defaults=a("./defaults"),r.version="3.10.1",r.loadAsync=function(n,s){return new r().loadAsync(n,s)},r.external=a("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(a,t,e){"use strict";var r=a("./utils"),n=a("./external"),s=a("./utf8"),o=a("./zipEntries"),l=a("./stream/Crc32Probe"),c=a("./nodejsUtils");function u(d){return new n.Promise(function(h,f){var m=d.decompressed.getContentWorker().pipe(new l);m.on("error",function(g){f(g)}).on("end",function(){m.streamInfo.crc32!==d.decompressed.crc32?f(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}t.exports=function(d,h){var f=this;return h=r.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),c.isNode&&c.isStream(d)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",d,!0,h.optimizedBinaryString,h.base64).then(function(m){var g=new o(h);return g.load(m),g}).then(function(m){var g=[n.Promise.resolve(m)],y=m.files;if(h.checkCRC32)for(var v=0;v<y.length;v++)g.push(u(y[v]));return n.Promise.all(g)}).then(function(m){for(var g=m.shift(),y=g.files,v=0;v<y.length;v++){var E=y[v],C=E.fileNameStr,_=r.resolve(E.fileNameStr);f.file(_,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:h.createFolders}),E.dir||(f.file(_).unsafeOriginalName=C)}return g.zipComment.length&&(f.comment=g.zipComment),f})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(a,t,e){"use strict";var r=a("../utils"),n=a("../stream/GenericWorker");function s(o,l){n.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(l)}r.inherits(s,n),s.prototype._bindStream=function(o){var l=this;(this._stream=o).pause(),o.on("data",function(c){l.push({data:c,meta:{percent:0}})}).on("error",function(c){l.isPaused?this.generatedError=c:l.error(c)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(a,t,e){"use strict";var r=a("readable-stream").Readable;function n(s,o,l){r.call(this,o),this._helper=s;var c=this;s.on("data",function(u,d){c.push(u)||c._helper.pause(),l&&l(d)}).on("error",function(u){c.emit("error",u)}).on("end",function(){c.push(null)})}a("../utils").inherits(n,r),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(a,t,e){"use strict";t.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(r,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,n);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,n)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var n=new Buffer(r);return n.fill(0),n},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(a,t,e){"use strict";function r(_,x,P){var I,M=s.getTypeOf(x),O=s.extend(P||{},c);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(_=y(_)),O.createFolders&&(I=g(_))&&v.call(this,I,!0);var R=M==="string"&&O.binary===!1&&O.base64===!1;P&&P.binary!==void 0||(O.binary=!R),(x instanceof u&&x.uncompressedSize===0||O.dir||!x||x.length===0)&&(O.base64=!1,O.binary=!0,x="",O.compression="STORE",M="string");var F=null;F=x instanceof u||x instanceof o?x:f.isNode&&f.isStream(x)?new m(_,x):s.prepareContent(_,x,O.binary,O.optimizedBinaryString,O.base64);var $=new d(_,F,O);this.files[_]=$}var n=a("./utf8"),s=a("./utils"),o=a("./stream/GenericWorker"),l=a("./stream/StreamHelper"),c=a("./defaults"),u=a("./compressedObject"),d=a("./zipObject"),h=a("./generate"),f=a("./nodejsUtils"),m=a("./nodejs/NodejsStreamInputAdapter"),g=function(_){_.slice(-1)==="/"&&(_=_.substring(0,_.length-1));var x=_.lastIndexOf("/");return 0<x?_.substring(0,x):""},y=function(_){return _.slice(-1)!=="/"&&(_+="/"),_},v=function(_,x){return x=x!==void 0?x:c.createFolders,_=y(_),this.files[_]||r.call(this,_,null,{dir:!0,createFolders:x}),this.files[_]};function E(_){return Object.prototype.toString.call(_)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(_){var x,P,I;for(x in this.files)I=this.files[x],(P=x.slice(this.root.length,x.length))&&x.slice(0,this.root.length)===this.root&&_(P,I)},filter:function(_){var x=[];return this.forEach(function(P,I){_(P,I)&&x.push(I)}),x},file:function(_,x,P){if(arguments.length!==1)return _=this.root+_,r.call(this,_,x,P),this;if(E(_)){var I=_;return this.filter(function(O,R){return!R.dir&&I.test(O)})}var M=this.files[this.root+_];return M&&!M.dir?M:null},folder:function(_){if(!_)return this;if(E(_))return this.filter(function(M,O){return O.dir&&_.test(M)});var x=this.root+_,P=v.call(this,x),I=this.clone();return I.root=P.name,I},remove:function(_){_=this.root+_;var x=this.files[_];if(x||(_.slice(-1)!=="/"&&(_+="/"),x=this.files[_]),x&&!x.dir)delete this.files[_];else for(var P=this.filter(function(M,O){return O.name.slice(0,_.length)===_}),I=0;I<P.length;I++)delete this.files[P[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(_){var x,P={};try{if((P=s.extend(_||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=P.type.toLowerCase(),P.compression=P.compression.toUpperCase(),P.type==="binarystring"&&(P.type="string"),!P.type)throw new Error("No output type specified.");s.checkSupport(P.type),P.platform!=="darwin"&&P.platform!=="freebsd"&&P.platform!=="linux"&&P.platform!=="sunos"||(P.platform="UNIX"),P.platform==="win32"&&(P.platform="DOS");var I=P.comment||this.comment||"";x=h.generateWorker(this,P,I)}catch(M){(x=new o("error")).error(M)}return new l(x,P.type||"string",P.mimeType)},generateAsync:function(_,x){return this.generateInternalStream(_).accumulate(x)},generateNodeStream:function(_,x){return(_=_||{}).type||(_.type="nodebuffer"),this.generateInternalStream(_).toNodejsStream(x)}};t.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(a,t,e){"use strict";t.exports=a("stream")},{stream:void 0}],17:[function(a,t,e){"use strict";var r=a("./DataReader");function n(s){r.call(this,s);for(var o=0;o<this.data.length;o++)s[o]=255&s[o]}a("../utils").inherits(n,r),n.prototype.byteAt=function(s){return this.data[this.zero+s]},n.prototype.lastIndexOfSignature=function(s){for(var o=s.charCodeAt(0),l=s.charCodeAt(1),c=s.charCodeAt(2),u=s.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===o&&this.data[d+1]===l&&this.data[d+2]===c&&this.data[d+3]===u)return d-this.zero;return-1},n.prototype.readAndCheckSignature=function(s){var o=s.charCodeAt(0),l=s.charCodeAt(1),c=s.charCodeAt(2),u=s.charCodeAt(3),d=this.readData(4);return o===d[0]&&l===d[1]&&c===d[2]&&u===d[3]},n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},t.exports=n},{"../utils":32,"./DataReader":18}],18:[function(a,t,e){"use strict";var r=a("../utils");function n(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var o,l=0;for(this.checkOffset(s),o=this.index+s-1;o>=this.index;o--)l=(l<<8)+this.byteAt(o);return this.index+=s,l},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},t.exports=n},{"../utils":32}],19:[function(a,t,e){"use strict";var r=a("./Uint8ArrayReader");function n(s){r.call(this,s)}a("../utils").inherits(n,r),n.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},t.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(a,t,e){"use strict";var r=a("./DataReader");function n(s){r.call(this,s)}a("../utils").inherits(n,r),n.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},n.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},n.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},n.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},t.exports=n},{"../utils":32,"./DataReader":18}],21:[function(a,t,e){"use strict";var r=a("./ArrayReader");function n(s){r.call(this,s)}a("../utils").inherits(n,r),n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},t.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(a,t,e){"use strict";var r=a("../utils"),n=a("../support"),s=a("./ArrayReader"),o=a("./StringReader"),l=a("./NodeBufferReader"),c=a("./Uint8ArrayReader");t.exports=function(u){var d=r.getTypeOf(u);return r.checkSupport(d),d!=="string"||n.uint8array?d==="nodebuffer"?new l(u):n.uint8array?new c(r.transformTo("uint8array",u)):new s(r.transformTo("array",u)):new o(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(a,t,e){"use strict";e.LOCAL_FILE_HEADER="PK",e.CENTRAL_FILE_HEADER="PK",e.CENTRAL_DIRECTORY_END="PK",e.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",e.ZIP64_CENTRAL_DIRECTORY_END="PK",e.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(a,t,e){"use strict";var r=a("./GenericWorker"),n=a("../utils");function s(o){r.call(this,"ConvertWorker to "+o),this.destType=o}n.inherits(s,r),s.prototype.processChunk=function(o){this.push({data:n.transformTo(this.destType,o.data),meta:o.meta})},t.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(a,t,e){"use strict";var r=a("./GenericWorker"),n=a("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}a("../utils").inherits(s,r),s.prototype.processChunk=function(o){this.streamInfo.crc32=n(o.data,this.streamInfo.crc32||0),this.push(o)},t.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(a,t,e){"use strict";var r=a("../utils"),n=a("./GenericWorker");function s(o){n.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}r.inherits(s,n),s.prototype.processChunk=function(o){if(o){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+o.data.length}n.prototype.processChunk.call(this,o)},t.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(a,t,e){"use strict";var r=a("../utils"),n=a("./GenericWorker");function s(o){n.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(c){l.dataIsReady=!0,l.data=c,l.max=c&&c.length||0,l.type=r.getTypeOf(c),l.isPaused||l._tickAndRepeat()},function(c){l.error(c)})}r.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,l);break;case"uint8array":o=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":o=this.data.slice(this.index,l)}return this.index=l,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(a,t,e){"use strict";function r(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,s){return this._listeners[n].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,s){if(this._listeners[n])for(var o=0;o<this._listeners[n].length;o++)this._listeners[n][o].call(this,s)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var s=this;return n.on("data",function(o){s.processChunk(o)}),n.on("end",function(){s.end()}),n.on("error",function(o){s.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,s){return this.extraStreamInfo[n]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},t.exports=r},{}],29:[function(a,t,e){"use strict";var r=a("../utils"),n=a("./ConvertWorker"),s=a("./GenericWorker"),o=a("../base64"),l=a("../support"),c=a("../external"),u=null;if(l.nodestream)try{u=a("../nodejs/NodejsStreamOutputAdapter")}catch(f){}function d(f,m){return new c.Promise(function(g,y){var v=[],E=f._internalType,C=f._outputType,_=f._mimeType;f.on("data",function(x,P){v.push(x),m&&m(P)}).on("error",function(x){v=[],y(x)}).on("end",function(){try{var x=(function(P,I,M){switch(P){case"blob":return r.newBlob(r.transformTo("arraybuffer",I),M);case"base64":return o.encode(I);default:return r.transformTo(P,I)}})(C,(function(P,I){var M,O=0,R=null,F=0;for(M=0;M<I.length;M++)F+=I[M].length;switch(P){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(R=new Uint8Array(F),M=0;M<I.length;M++)R.set(I[M],O),O+=I[M].length;return R;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+P+"'")}})(E,v),_);g(x)}catch(P){y(P)}v=[]}).resume()})}function h(f,m,g){var y=m;switch(m){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=m,this._mimeType=g,r.checkSupport(y),this._worker=f.pipe(new n(y)),f.lock()}catch(v){this._worker=new s("error"),this._worker.error(v)}}h.prototype={accumulate:function(f){return d(this,f)},on:function(f,m){var g=this;return f==="data"?this._worker.on(f,function(y){m.call(g,y.data,y.meta)}):this._worker.on(f,function(){r.delay(m,arguments,g)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(f){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},f)}},t.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(a,t,e){"use strict";if(e.base64=!0,e.array=!0,e.string=!0,e.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",e.nodebuffer=typeof Buffer!="undefined",e.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")e.blob=!1;else{var r=new ArrayBuffer(0);try{e.blob=new Blob([r],{type:"application/zip"}).size===0}catch(s){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(r),e.blob=n.getBlob("application/zip").size===0}catch(o){e.blob=!1}}}try{e.nodestream=!!a("readable-stream").Readable}catch(s){e.nodestream=!1}},{"readable-stream":16}],31:[function(a,t,e){"use strict";for(var r=a("./utils"),n=a("./support"),s=a("./nodejsUtils"),o=a("./stream/GenericWorker"),l=new Array(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;l[254]=l[254]=1;function u(){o.call(this,"utf-8 decode"),this.leftOver=null}function d(){o.call(this,"utf-8 encode")}e.utf8encode=function(h){return n.nodebuffer?s.newBufferFrom(h,"utf-8"):(function(f){var m,g,y,v,E,C=f.length,_=0;for(v=0;v<C;v++)(64512&(g=f.charCodeAt(v)))==55296&&v+1<C&&(64512&(y=f.charCodeAt(v+1)))==56320&&(g=65536+(g-55296<<10)+(y-56320),v++),_+=g<128?1:g<2048?2:g<65536?3:4;for(m=n.uint8array?new Uint8Array(_):new Array(_),v=E=0;E<_;v++)(64512&(g=f.charCodeAt(v)))==55296&&v+1<C&&(64512&(y=f.charCodeAt(v+1)))==56320&&(g=65536+(g-55296<<10)+(y-56320),v++),g<128?m[E++]=g:(g<2048?m[E++]=192|g>>>6:(g<65536?m[E++]=224|g>>>12:(m[E++]=240|g>>>18,m[E++]=128|g>>>12&63),m[E++]=128|g>>>6&63),m[E++]=128|63&g);return m})(h)},e.utf8decode=function(h){return n.nodebuffer?r.transformTo("nodebuffer",h).toString("utf-8"):(function(f){var m,g,y,v,E=f.length,C=new Array(2*E);for(m=g=0;m<E;)if((y=f[m++])<128)C[g++]=y;else if(4<(v=l[y]))C[g++]=65533,m+=v-1;else{for(y&=v===2?31:v===3?15:7;1<v&&m<E;)y=y<<6|63&f[m++],v--;1<v?C[g++]=65533:y<65536?C[g++]=y:(y-=65536,C[g++]=55296|y>>10&1023,C[g++]=56320|1023&y)}return C.length!==g&&(C.subarray?C=C.subarray(0,g):C.length=g),r.applyFromCharCode(C)})(h=r.transformTo(n.uint8array?"uint8array":"array",h))},r.inherits(u,o),u.prototype.processChunk=function(h){var f=r.transformTo(n.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var m=f;(f=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),f.set(m,this.leftOver.length)}else f=this.leftOver.concat(f);this.leftOver=null}var g=(function(v,E){var C;for((E=E||v.length)>v.length&&(E=v.length),C=E-1;0<=C&&(192&v[C])==128;)C--;return C<0||C===0?E:C+l[v[C]]>E?C:E})(f),y=f;g!==f.length&&(n.uint8array?(y=f.subarray(0,g),this.leftOver=f.subarray(g,f.length)):(y=f.slice(0,g),this.leftOver=f.slice(g,f.length))),this.push({data:e.utf8decode(y),meta:h.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=u,r.inherits(d,o),d.prototype.processChunk=function(h){this.push({data:e.utf8encode(h.data),meta:h.meta})},e.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(a,t,e){"use strict";var r=a("./support"),n=a("./base64"),s=a("./nodejsUtils"),o=a("./external");function l(m){return m}function c(m,g){for(var y=0;y<m.length;++y)g[y]=255&m.charCodeAt(y);return g}a("setimmediate"),e.newBlob=function(m,g){e.checkSupport("blob");try{return new Blob([m],{type:g})}catch(v){try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(m),y.getBlob(g)}catch(E){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(m,g,y){var v=[],E=0,C=m.length;if(C<=y)return String.fromCharCode.apply(null,m);for(;E<C;)g==="array"||g==="nodebuffer"?v.push(String.fromCharCode.apply(null,m.slice(E,Math.min(E+y,C)))):v.push(String.fromCharCode.apply(null,m.subarray(E,Math.min(E+y,C)))),E+=y;return v.join("")},stringifyByChar:function(m){for(var g="",y=0;y<m.length;y++)g+=String.fromCharCode(m[y]);return g},applyCanBeUsed:{uint8array:(function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(m){return!1}})(),nodebuffer:(function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch(m){return!1}})()}};function d(m){var g=65536,y=e.getTypeOf(m),v=!0;if(y==="uint8array"?v=u.applyCanBeUsed.uint8array:y==="nodebuffer"&&(v=u.applyCanBeUsed.nodebuffer),v)for(;1<g;)try{return u.stringifyByChunk(m,y,g)}catch(E){g=Math.floor(g/2)}return u.stringifyByChar(m)}function h(m,g){for(var y=0;y<m.length;y++)g[y]=m[y];return g}e.applyFromCharCode=d;var f={};f.string={string:l,array:function(m){return c(m,new Array(m.length))},arraybuffer:function(m){return f.string.uint8array(m).buffer},uint8array:function(m){return c(m,new Uint8Array(m.length))},nodebuffer:function(m){return c(m,s.allocBuffer(m.length))}},f.array={string:d,array:l,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return s.newBufferFrom(m)}},f.arraybuffer={string:function(m){return d(new Uint8Array(m))},array:function(m){return h(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:l,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return s.newBufferFrom(new Uint8Array(m))}},f.uint8array={string:d,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:l,nodebuffer:function(m){return s.newBufferFrom(m)}},f.nodebuffer={string:d,array:function(m){return h(m,new Array(m.length))},arraybuffer:function(m){return f.nodebuffer.uint8array(m).buffer},uint8array:function(m){return h(m,new Uint8Array(m.length))},nodebuffer:l},e.transformTo=function(m,g){if(g=g||"",!m)return g;e.checkSupport(m);var y=e.getTypeOf(g);return f[y][m](g)},e.resolve=function(m){for(var g=m.split("/"),y=[],v=0;v<g.length;v++){var E=g[v];E==="."||E===""&&v!==0&&v!==g.length-1||(E===".."?y.pop():y.push(E))}return y.join("/")},e.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(m)?"nodebuffer":r.uint8array&&m instanceof Uint8Array?"uint8array":r.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},e.checkSupport=function(m){if(!r[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(m){var g,y,v="";for(y=0;y<(m||"").length;y++)v+="\\x"+((g=m.charCodeAt(y))<16?"0":"")+g.toString(16).toUpperCase();return v},e.delay=function(m,g,y){setImmediate(function(){m.apply(y||null,g||[])})},e.inherits=function(m,g){function y(){}y.prototype=g.prototype,m.prototype=new y},e.extend=function(){var m,g,y={};for(m=0;m<arguments.length;m++)for(g in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],g)&&y[g]===void 0&&(y[g]=arguments[m][g]);return y},e.prepareContent=function(m,g,y,v,E){return o.Promise.resolve(g).then(function(C){return r.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader!="undefined"?new o.Promise(function(_,x){var P=new FileReader;P.onload=function(I){_(I.target.result)},P.onerror=function(I){x(I.target.error)},P.readAsArrayBuffer(C)}):C}).then(function(C){var _=e.getTypeOf(C);return _?(_==="arraybuffer"?C=e.transformTo("uint8array",C):_==="string"&&(E?C=n.decode(C):y&&v!==!0&&(C=(function(x){return c(x,r.uint8array?new Uint8Array(x.length):new Array(x.length))})(C))),C):o.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(a,t,e){"use strict";var r=a("./reader/readerFor"),n=a("./utils"),s=a("./signature"),o=a("./zipEntry"),l=a("./support");function c(u){this.files=[],this.loadOptions=u}c.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(d)+", expected "+n.pretty(u)+")")}},isSignature:function(u,d){var h=this.reader.index;this.reader.setIndex(u);var f=this.reader.readString(4)===d;return this.reader.setIndex(h),f},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),d=l.uint8array?"uint8array":"array",h=n.transformTo(d,u);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,d,h,f=this.zip64EndOfCentralSize-44;0<f;)u=this.reader.readInt(2),d=this.reader.readInt(4),h=this.reader.readData(d),this.zip64ExtensibleData[u]={id:u,length:d,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,d;for(u=0;u<this.files.length;u++)d=this.files[u],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(u=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var d=u;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var f=d-h;if(0<f)this.isSignature(d,s.CENTRAL_FILE_HEADER)||(this.reader.zero=f);else if(f<0)throw new Error("Corrupted zip: missing "+Math.abs(f)+" bytes.")},prepareReader:function(u){this.reader=r(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(a,t,e){"use strict";var r=a("./reader/readerFor"),n=a("./utils"),s=a("./compressedObject"),o=a("./crc32"),l=a("./utf8"),c=a("./compressions"),u=a("./support");function d(h,f){this.options=h,this.loadOptions=f}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var f,m;if(h.skip(22),this.fileNameLength=h.readInt(2),m=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((f=(function(g){for(var y in c)if(Object.prototype.hasOwnProperty.call(c,y)&&c[y].magic===g)return c[y];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,f,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var f=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(f),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=r(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var f,m,g,y=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<y;)f=h.readInt(2),m=h.readInt(2),g=h.readData(m),this.extraFields[f]={id:f,length:m,value:g};h.setIndex(y)},handleUTF8:function(){var h=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var f=this.findExtraFieldUnicodePath();if(f!==null)this.fileNameStr=f;else{var m=n.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var y=n.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var f=r(h.value);return f.readInt(1)!==1||o(this.fileName)!==f.readInt(4)?null:l.utf8decode(f.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var f=r(h.value);return f.readInt(1)!==1||o(this.fileComment)!==f.readInt(4)?null:l.utf8decode(f.readData(h.length-5))}return null}},t.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(a,t,e){"use strict";function r(f,m,g){this.name=f,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=m,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var n=a("./stream/StreamHelper"),s=a("./stream/DataWorker"),o=a("./utf8"),l=a("./compressedObject"),c=a("./stream/GenericWorker");r.prototype={internalStream:function(f){var m=null,g="string";try{if(!f)throw new Error("No output type specified.");var y=(g=f.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),m=this._decompressWorker();var v=!this._dataBinary;v&&!y&&(m=m.pipe(new o.Utf8EncodeWorker)),!v&&y&&(m=m.pipe(new o.Utf8DecodeWorker))}catch(E){(m=new c("error")).error(E)}return new n(m,g,"")},async:function(f,m){return this.internalStream(f).accumulate(m)},nodeStream:function(f,m){return this.internalStream(f||"nodebuffer").toNodejsStream(m)},_compressWorker:function(f,m){if(this._data instanceof l&&this._data.compression.magic===f.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new o.Utf8EncodeWorker)),l.createWorkerFrom(g,f,m)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof c?this._data:new s(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<u.length;h++)r.prototype[u[h]]=d;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(a,t,e){(function(r){"use strict";var n,s,o=r.MutationObserver||r.WebKitMutationObserver;if(o){var l=0,c=new o(f),u=r.document.createTextNode("");c.observe(u,{characterData:!0}),n=function(){u.data=l=++l%2}}else if(r.setImmediate||r.MessageChannel===void 0)n="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var m=r.document.createElement("script");m.onreadystatechange=function(){f(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},r.document.documentElement.appendChild(m)}:function(){setTimeout(f,0)};else{var d=new r.MessageChannel;d.port1.onmessage=f,n=function(){d.port2.postMessage(0)}}var h=[];function f(){var m,g;s=!0;for(var y=h.length;y;){for(g=h,h=[],m=-1;++m<y;)g[m]();y=h.length}s=!1}t.exports=function(m){h.push(m)!==1||s||n()}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(a,t,e){"use strict";var r=a("immediate");function n(){}var s={},o=["REJECTED"],l=["FULFILLED"],c=["PENDING"];function u(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,y!==n&&m(this,y)}function d(y,v,E){this.promise=y,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function h(y,v,E){r(function(){var C;try{C=v(E)}catch(_){return s.reject(y,_)}C===y?s.reject(y,new TypeError("Cannot resolve promise with itself")):s.resolve(y,C)})}function f(y){var v=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof v=="function")return function(){v.apply(y,arguments)}}function m(y,v){var E=!1;function C(P){E||(E=!0,s.reject(y,P))}function _(P){E||(E=!0,s.resolve(y,P))}var x=g(function(){v(_,C)});x.status==="error"&&C(x.value)}function g(y,v){var E={};try{E.value=y(v),E.status="success"}catch(C){E.status="error",E.value=C}return E}(t.exports=u).prototype.finally=function(y){if(typeof y!="function")return this;var v=this.constructor;return this.then(function(E){return v.resolve(y()).then(function(){return E})},function(E){return v.resolve(y()).then(function(){throw E})})},u.prototype.catch=function(y){return this.then(null,y)},u.prototype.then=function(y,v){if(typeof y!="function"&&this.state===l||typeof v!="function"&&this.state===o)return this;var E=new this.constructor(n);return this.state!==c?h(E,this.state===l?y:v,this.outcome):this.queue.push(new d(E,y,v)),E},d.prototype.callFulfilled=function(y){s.resolve(this.promise,y)},d.prototype.otherCallFulfilled=function(y){h(this.promise,this.onFulfilled,y)},d.prototype.callRejected=function(y){s.reject(this.promise,y)},d.prototype.otherCallRejected=function(y){h(this.promise,this.onRejected,y)},s.resolve=function(y,v){var E=g(f,v);if(E.status==="error")return s.reject(y,E.value);var C=E.value;if(C)m(y,C);else{y.state=l,y.outcome=v;for(var _=-1,x=y.queue.length;++_<x;)y.queue[_].callFulfilled(v)}return y},s.reject=function(y,v){y.state=o,y.outcome=v;for(var E=-1,C=y.queue.length;++E<C;)y.queue[E].callRejected(v);return y},u.resolve=function(y){return y instanceof this?y:s.resolve(new this(n),y)},u.reject=function(y){var v=new this(n);return s.reject(v,y)},u.all=function(y){var v=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=y.length,C=!1;if(!E)return this.resolve([]);for(var _=new Array(E),x=0,P=-1,I=new this(n);++P<E;)M(y[P],P);return I;function M(O,R){v.resolve(O).then(function(F){_[R]=F,++x!==E||C||(C=!0,s.resolve(I,_))},function(F){C||(C=!0,s.reject(I,F))})}},u.race=function(y){var v=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=y.length,C=!1;if(!E)return this.resolve([]);for(var _=-1,x=new this(n);++_<E;)P=y[_],v.resolve(P).then(function(I){C||(C=!0,s.resolve(x,I))},function(I){C||(C=!0,s.reject(x,I))});var P;return x}},{immediate:36}],38:[function(a,t,e){"use strict";var r={};(0,a("./lib/utils/common").assign)(r,a("./lib/deflate"),a("./lib/inflate"),a("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(a,t,e){"use strict";var r=a("./zlib/deflate"),n=a("./utils/common"),s=a("./utils/strings"),o=a("./zlib/messages"),l=a("./zlib/zstream"),c=Object.prototype.toString,u=0,d=-1,h=0,f=8;function m(y){if(!(this instanceof m))return new m(y);this.options=n.assign({level:d,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},y||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var E=r.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(E!==u)throw new Error(o[E]);if(v.header&&r.deflateSetHeader(this.strm,v.header),v.dictionary){var C;if(C=typeof v.dictionary=="string"?s.string2buf(v.dictionary):c.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(E=r.deflateSetDictionary(this.strm,C))!==u)throw new Error(o[E]);this._dict_set=!0}}function g(y,v){var E=new m(v);if(E.push(y,!0),E.err)throw E.msg||o[E.err];return E.result}m.prototype.push=function(y,v){var E,C,_=this.strm,x=this.options.chunkSize;if(this.ended)return!1;C=v===~~v?v:v===!0?4:0,typeof y=="string"?_.input=s.string2buf(y):c.call(y)==="[object ArrayBuffer]"?_.input=new Uint8Array(y):_.input=y,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new n.Buf8(x),_.next_out=0,_.avail_out=x),(E=r.deflate(_,C))!==1&&E!==u)return this.onEnd(E),!(this.ended=!0);_.avail_out!==0&&(_.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(n.shrinkBuf(_.output,_.next_out))):this.onData(n.shrinkBuf(_.output,_.next_out)))}while((0<_.avail_in||_.avail_out===0)&&E!==1);return C===4?(E=r.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===u):C!==2||(this.onEnd(u),!(_.avail_out=0))},m.prototype.onData=function(y){this.chunks.push(y)},m.prototype.onEnd=function(y){y===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},e.Deflate=m,e.deflate=g,e.deflateRaw=function(y,v){return(v=v||{}).raw=!0,g(y,v)},e.gzip=function(y,v){return(v=v||{}).gzip=!0,g(y,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(a,t,e){"use strict";var r=a("./zlib/inflate"),n=a("./utils/common"),s=a("./utils/strings"),o=a("./zlib/constants"),l=a("./zlib/messages"),c=a("./zlib/zstream"),u=a("./zlib/gzheader"),d=Object.prototype.toString;function h(m){if(!(this instanceof h))return new h(m);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},m||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||m&&m.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&(15&g.windowBits)==0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var y=r.inflateInit2(this.strm,g.windowBits);if(y!==o.Z_OK)throw new Error(l[y]);this.header=new u,r.inflateGetHeader(this.strm,this.header)}function f(m,g){var y=new h(g);if(y.push(m,!0),y.err)throw y.msg||l[y.err];return y.result}h.prototype.push=function(m,g){var y,v,E,C,_,x,P=this.strm,I=this.options.chunkSize,M=this.options.dictionary,O=!1;if(this.ended)return!1;v=g===~~g?g:g===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof m=="string"?P.input=s.binstring2buf(m):d.call(m)==="[object ArrayBuffer]"?P.input=new Uint8Array(m):P.input=m,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new n.Buf8(I),P.next_out=0,P.avail_out=I),(y=r.inflate(P,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&M&&(x=typeof M=="string"?s.string2buf(M):d.call(M)==="[object ArrayBuffer]"?new Uint8Array(M):M,y=r.inflateSetDictionary(this.strm,x)),y===o.Z_BUF_ERROR&&O===!0&&(y=o.Z_OK,O=!1),y!==o.Z_STREAM_END&&y!==o.Z_OK)return this.onEnd(y),!(this.ended=!0);P.next_out&&(P.avail_out!==0&&y!==o.Z_STREAM_END&&(P.avail_in!==0||v!==o.Z_FINISH&&v!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=s.utf8border(P.output,P.next_out),C=P.next_out-E,_=s.buf2string(P.output,E),P.next_out=C,P.avail_out=I-C,C&&n.arraySet(P.output,P.output,E,C,0),this.onData(_)):this.onData(n.shrinkBuf(P.output,P.next_out)))),P.avail_in===0&&P.avail_out===0&&(O=!0)}while((0<P.avail_in||P.avail_out===0)&&y!==o.Z_STREAM_END);return y===o.Z_STREAM_END&&(v=o.Z_FINISH),v===o.Z_FINISH?(y=r.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===o.Z_OK):v!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(P.avail_out=0))},h.prototype.onData=function(m){this.chunks.push(m)},h.prototype.onEnd=function(m){m===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},e.Inflate=h,e.inflate=f,e.inflateRaw=function(m,g){return(g=g||{}).raw=!0,f(m,g)},e.ungzip=f},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(a,t,e){"use strict";var r=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";e.assign=function(o){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var c=l.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var u in c)c.hasOwnProperty(u)&&(o[u]=c[u])}}return o},e.shrinkBuf=function(o,l){return o.length===l?o:o.subarray?o.subarray(0,l):(o.length=l,o)};var n={arraySet:function(o,l,c,u,d){if(l.subarray&&o.subarray)o.set(l.subarray(c,c+u),d);else for(var h=0;h<u;h++)o[d+h]=l[c+h]},flattenChunks:function(o){var l,c,u,d,h,f;for(l=u=0,c=o.length;l<c;l++)u+=o[l].length;for(f=new Uint8Array(u),l=d=0,c=o.length;l<c;l++)h=o[l],f.set(h,d),d+=h.length;return f}},s={arraySet:function(o,l,c,u,d){for(var h=0;h<u;h++)o[d+h]=l[c+h]},flattenChunks:function(o){return[].concat.apply([],o)}};e.setTyped=function(o){o?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(r)},{}],42:[function(a,t,e){"use strict";var r=a("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(u){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(u){s=!1}for(var o=new r.Buf8(256),l=0;l<256;l++)o[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(u,d){if(d<65537&&(u.subarray&&s||!u.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(u,d));for(var h="",f=0;f<d;f++)h+=String.fromCharCode(u[f]);return h}o[254]=o[254]=1,e.string2buf=function(u){var d,h,f,m,g,y=u.length,v=0;for(m=0;m<y;m++)(64512&(h=u.charCodeAt(m)))==55296&&m+1<y&&(64512&(f=u.charCodeAt(m+1)))==56320&&(h=65536+(h-55296<<10)+(f-56320),m++),v+=h<128?1:h<2048?2:h<65536?3:4;for(d=new r.Buf8(v),m=g=0;g<v;m++)(64512&(h=u.charCodeAt(m)))==55296&&m+1<y&&(64512&(f=u.charCodeAt(m+1)))==56320&&(h=65536+(h-55296<<10)+(f-56320),m++),h<128?d[g++]=h:(h<2048?d[g++]=192|h>>>6:(h<65536?d[g++]=224|h>>>12:(d[g++]=240|h>>>18,d[g++]=128|h>>>12&63),d[g++]=128|h>>>6&63),d[g++]=128|63&h);return d},e.buf2binstring=function(u){return c(u,u.length)},e.binstring2buf=function(u){for(var d=new r.Buf8(u.length),h=0,f=d.length;h<f;h++)d[h]=u.charCodeAt(h);return d},e.buf2string=function(u,d){var h,f,m,g,y=d||u.length,v=new Array(2*y);for(h=f=0;h<y;)if((m=u[h++])<128)v[f++]=m;else if(4<(g=o[m]))v[f++]=65533,h+=g-1;else{for(m&=g===2?31:g===3?15:7;1<g&&h<y;)m=m<<6|63&u[h++],g--;1<g?v[f++]=65533:m<65536?v[f++]=m:(m-=65536,v[f++]=55296|m>>10&1023,v[f++]=56320|1023&m)}return c(v,f)},e.utf8border=function(u,d){var h;for((d=d||u.length)>u.length&&(d=u.length),h=d-1;0<=h&&(192&u[h])==128;)h--;return h<0||h===0?d:h+o[u[h]]>d?h:d}},{"./common":41}],43:[function(a,t,e){"use strict";t.exports=function(r,n,s,o){for(var l=65535&r|0,c=r>>>16&65535|0,u=0;s!==0;){for(s-=u=2e3<s?2e3:s;c=c+(l=l+n[o++]|0)|0,--u;);l%=65521,c%=65521}return l|c<<16|0}},{}],44:[function(a,t,e){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(a,t,e){"use strict";var r=(function(){for(var n,s=[],o=0;o<256;o++){n=o;for(var l=0;l<8;l++)n=1&n?3988292384^n>>>1:n>>>1;s[o]=n}return s})();t.exports=function(n,s,o,l){var c=r,u=l+o;n^=-1;for(var d=l;d<u;d++)n=n>>>8^c[255&(n^s[d])];return-1^n}},{}],46:[function(a,t,e){"use strict";var r,n=a("../utils/common"),s=a("./trees"),o=a("./adler32"),l=a("./crc32"),c=a("./messages"),u=0,d=4,h=0,f=-2,m=-1,g=4,y=2,v=8,E=9,C=286,_=30,x=19,P=2*C+1,I=15,M=3,O=258,R=O+M+1,F=42,$=113,k=1,N=2,G=3,W=4;function Y(B,oe){return B.msg=c[oe],oe}function U(B){return(B<<1)-(4<B?9:0)}function Z(B){for(var oe=B.length;0<=--oe;)B[oe]=0}function q(B){var oe=B.state,he=oe.pending;he>B.avail_out&&(he=B.avail_out),he!==0&&(n.arraySet(B.output,oe.pending_buf,oe.pending_out,he,B.next_out),B.next_out+=he,oe.pending_out+=he,B.total_out+=he,B.avail_out-=he,oe.pending-=he,oe.pending===0&&(oe.pending_out=0))}function X(B,oe){s._tr_flush_block(B,0<=B.block_start?B.block_start:-1,B.strstart-B.block_start,oe),B.block_start=B.strstart,q(B.strm)}function ie(B,oe){B.pending_buf[B.pending++]=oe}function j(B,oe){B.pending_buf[B.pending++]=oe>>>8&255,B.pending_buf[B.pending++]=255&oe}function K(B,oe){var he,te,re=B.max_chain_length,ce=B.strstart,Ee=B.prev_length,Ce=B.nice_match,le=B.strstart>B.w_size-R?B.strstart-(B.w_size-R):0,we=B.window,Le=B.w_mask,Me=B.prev,Ne=B.strstart+O,Ge=we[ce+Ee-1],Ye=we[ce+Ee];B.prev_length>=B.good_match&&(re>>=2),Ce>B.lookahead&&(Ce=B.lookahead);do if(we[(he=oe)+Ee]===Ye&&we[he+Ee-1]===Ge&&we[he]===we[ce]&&we[++he]===we[ce+1]){ce+=2,he++;do;while(we[++ce]===we[++he]&&we[++ce]===we[++he]&&we[++ce]===we[++he]&&we[++ce]===we[++he]&&we[++ce]===we[++he]&&we[++ce]===we[++he]&&we[++ce]===we[++he]&&we[++ce]===we[++he]&&ce<Ne);if(te=O-(Ne-ce),ce=Ne-O,Ee<te){if(B.match_start=oe,Ce<=(Ee=te))break;Ge=we[ce+Ee-1],Ye=we[ce+Ee]}}while((oe=Me[oe&Le])>le&&--re!=0);return Ee<=B.lookahead?Ee:B.lookahead}function se(B){var oe,he,te,re,ce,Ee,Ce,le,we,Le,Me=B.w_size;do{if(re=B.window_size-B.lookahead-B.strstart,B.strstart>=Me+(Me-R)){for(n.arraySet(B.window,B.window,Me,Me,0),B.match_start-=Me,B.strstart-=Me,B.block_start-=Me,oe=he=B.hash_size;te=B.head[--oe],B.head[oe]=Me<=te?te-Me:0,--he;);for(oe=he=Me;te=B.prev[--oe],B.prev[oe]=Me<=te?te-Me:0,--he;);re+=Me}if(B.strm.avail_in===0)break;if(Ee=B.strm,Ce=B.window,le=B.strstart+B.lookahead,we=re,Le=void 0,Le=Ee.avail_in,we<Le&&(Le=we),he=Le===0?0:(Ee.avail_in-=Le,n.arraySet(Ce,Ee.input,Ee.next_in,Le,le),Ee.state.wrap===1?Ee.adler=o(Ee.adler,Ce,Le,le):Ee.state.wrap===2&&(Ee.adler=l(Ee.adler,Ce,Le,le)),Ee.next_in+=Le,Ee.total_in+=Le,Le),B.lookahead+=he,B.lookahead+B.insert>=M)for(ce=B.strstart-B.insert,B.ins_h=B.window[ce],B.ins_h=(B.ins_h<<B.hash_shift^B.window[ce+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[ce+M-1])&B.hash_mask,B.prev[ce&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=ce,ce++,B.insert--,!(B.lookahead+B.insert<M)););}while(B.lookahead<R&&B.strm.avail_in!==0)}function ne(B,oe){for(var he,te;;){if(B.lookahead<R){if(se(B),B.lookahead<R&&oe===u)return k;if(B.lookahead===0)break}if(he=0,B.lookahead>=M&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+M-1])&B.hash_mask,he=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),he!==0&&B.strstart-he<=B.w_size-R&&(B.match_length=K(B,he)),B.match_length>=M)if(te=s._tr_tally(B,B.strstart-B.match_start,B.match_length-M),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=M){for(B.match_length--;B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+M-1])&B.hash_mask,he=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart,--B.match_length!=0;);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else te=s._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(te&&(X(B,!1),B.strm.avail_out===0))return k}return B.insert=B.strstart<M-1?B.strstart:M-1,oe===d?(X(B,!0),B.strm.avail_out===0?G:W):B.last_lit&&(X(B,!1),B.strm.avail_out===0)?k:N}function ge(B,oe){for(var he,te,re;;){if(B.lookahead<R){if(se(B),B.lookahead<R&&oe===u)return k;if(B.lookahead===0)break}if(he=0,B.lookahead>=M&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+M-1])&B.hash_mask,he=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=M-1,he!==0&&B.prev_length<B.max_lazy_match&&B.strstart-he<=B.w_size-R&&(B.match_length=K(B,he),B.match_length<=5&&(B.strategy===1||B.match_length===M&&4096<B.strstart-B.match_start)&&(B.match_length=M-1)),B.prev_length>=M&&B.match_length<=B.prev_length){for(re=B.strstart+B.lookahead-M,te=s._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-M),B.lookahead-=B.prev_length-1,B.prev_length-=2;++B.strstart<=re&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+M-1])&B.hash_mask,he=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),--B.prev_length!=0;);if(B.match_available=0,B.match_length=M-1,B.strstart++,te&&(X(B,!1),B.strm.avail_out===0))return k}else if(B.match_available){if((te=s._tr_tally(B,0,B.window[B.strstart-1]))&&X(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return k}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(te=s._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<M-1?B.strstart:M-1,oe===d?(X(B,!0),B.strm.avail_out===0?G:W):B.last_lit&&(X(B,!1),B.strm.avail_out===0)?k:N}function ve(B,oe,he,te,re){this.good_length=B,this.max_lazy=oe,this.nice_length=he,this.max_chain=te,this.func=re}function Se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*P),this.dyn_dtree=new n.Buf16(2*(2*_+1)),this.bl_tree=new n.Buf16(2*(2*x+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(I+1),this.heap=new n.Buf16(2*C+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*C+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Te(B){var oe;return B&&B.state?(B.total_in=B.total_out=0,B.data_type=y,(oe=B.state).pending=0,oe.pending_out=0,oe.wrap<0&&(oe.wrap=-oe.wrap),oe.status=oe.wrap?F:$,B.adler=oe.wrap===2?0:1,oe.last_flush=u,s._tr_init(oe),h):Y(B,f)}function me(B){var oe=Te(B);return oe===h&&(function(he){he.window_size=2*he.w_size,Z(he.head),he.max_lazy_match=r[he.level].max_lazy,he.good_match=r[he.level].good_length,he.nice_match=r[he.level].nice_length,he.max_chain_length=r[he.level].max_chain,he.strstart=0,he.block_start=0,he.lookahead=0,he.insert=0,he.match_length=he.prev_length=M-1,he.match_available=0,he.ins_h=0})(B.state),oe}function pe(B,oe,he,te,re,ce){if(!B)return f;var Ee=1;if(oe===m&&(oe=6),te<0?(Ee=0,te=-te):15<te&&(Ee=2,te-=16),re<1||E<re||he!==v||te<8||15<te||oe<0||9<oe||ce<0||g<ce)return Y(B,f);te===8&&(te=9);var Ce=new Se;return(B.state=Ce).strm=B,Ce.wrap=Ee,Ce.gzhead=null,Ce.w_bits=te,Ce.w_size=1<<Ce.w_bits,Ce.w_mask=Ce.w_size-1,Ce.hash_bits=re+7,Ce.hash_size=1<<Ce.hash_bits,Ce.hash_mask=Ce.hash_size-1,Ce.hash_shift=~~((Ce.hash_bits+M-1)/M),Ce.window=new n.Buf8(2*Ce.w_size),Ce.head=new n.Buf16(Ce.hash_size),Ce.prev=new n.Buf16(Ce.w_size),Ce.lit_bufsize=1<<re+6,Ce.pending_buf_size=4*Ce.lit_bufsize,Ce.pending_buf=new n.Buf8(Ce.pending_buf_size),Ce.d_buf=1*Ce.lit_bufsize,Ce.l_buf=3*Ce.lit_bufsize,Ce.level=oe,Ce.strategy=ce,Ce.method=he,me(B)}r=[new ve(0,0,0,0,function(B,oe){var he=65535;for(he>B.pending_buf_size-5&&(he=B.pending_buf_size-5);;){if(B.lookahead<=1){if(se(B),B.lookahead===0&&oe===u)return k;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var te=B.block_start+he;if((B.strstart===0||B.strstart>=te)&&(B.lookahead=B.strstart-te,B.strstart=te,X(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-R&&(X(B,!1),B.strm.avail_out===0))return k}return B.insert=0,oe===d?(X(B,!0),B.strm.avail_out===0?G:W):(B.strstart>B.block_start&&(X(B,!1),B.strm.avail_out),k)}),new ve(4,4,8,4,ne),new ve(4,5,16,8,ne),new ve(4,6,32,32,ne),new ve(4,4,16,16,ge),new ve(8,16,32,32,ge),new ve(8,16,128,128,ge),new ve(8,32,128,256,ge),new ve(32,128,258,1024,ge),new ve(32,258,258,4096,ge)],e.deflateInit=function(B,oe){return pe(B,oe,v,15,8,0)},e.deflateInit2=pe,e.deflateReset=me,e.deflateResetKeep=Te,e.deflateSetHeader=function(B,oe){return B&&B.state?B.state.wrap!==2?f:(B.state.gzhead=oe,h):f},e.deflate=function(B,oe){var he,te,re,ce;if(!B||!B.state||5<oe||oe<0)return B?Y(B,f):f;if(te=B.state,!B.output||!B.input&&B.avail_in!==0||te.status===666&&oe!==d)return Y(B,B.avail_out===0?-5:f);if(te.strm=B,he=te.last_flush,te.last_flush=oe,te.status===F)if(te.wrap===2)B.adler=0,ie(te,31),ie(te,139),ie(te,8),te.gzhead?(ie(te,(te.gzhead.text?1:0)+(te.gzhead.hcrc?2:0)+(te.gzhead.extra?4:0)+(te.gzhead.name?8:0)+(te.gzhead.comment?16:0)),ie(te,255&te.gzhead.time),ie(te,te.gzhead.time>>8&255),ie(te,te.gzhead.time>>16&255),ie(te,te.gzhead.time>>24&255),ie(te,te.level===9?2:2<=te.strategy||te.level<2?4:0),ie(te,255&te.gzhead.os),te.gzhead.extra&&te.gzhead.extra.length&&(ie(te,255&te.gzhead.extra.length),ie(te,te.gzhead.extra.length>>8&255)),te.gzhead.hcrc&&(B.adler=l(B.adler,te.pending_buf,te.pending,0)),te.gzindex=0,te.status=69):(ie(te,0),ie(te,0),ie(te,0),ie(te,0),ie(te,0),ie(te,te.level===9?2:2<=te.strategy||te.level<2?4:0),ie(te,3),te.status=$);else{var Ee=v+(te.w_bits-8<<4)<<8;Ee|=(2<=te.strategy||te.level<2?0:te.level<6?1:te.level===6?2:3)<<6,te.strstart!==0&&(Ee|=32),Ee+=31-Ee%31,te.status=$,j(te,Ee),te.strstart!==0&&(j(te,B.adler>>>16),j(te,65535&B.adler)),B.adler=1}if(te.status===69)if(te.gzhead.extra){for(re=te.pending;te.gzindex<(65535&te.gzhead.extra.length)&&(te.pending!==te.pending_buf_size||(te.gzhead.hcrc&&te.pending>re&&(B.adler=l(B.adler,te.pending_buf,te.pending-re,re)),q(B),re=te.pending,te.pending!==te.pending_buf_size));)ie(te,255&te.gzhead.extra[te.gzindex]),te.gzindex++;te.gzhead.hcrc&&te.pending>re&&(B.adler=l(B.adler,te.pending_buf,te.pending-re,re)),te.gzindex===te.gzhead.extra.length&&(te.gzindex=0,te.status=73)}else te.status=73;if(te.status===73)if(te.gzhead.name){re=te.pending;do{if(te.pending===te.pending_buf_size&&(te.gzhead.hcrc&&te.pending>re&&(B.adler=l(B.adler,te.pending_buf,te.pending-re,re)),q(B),re=te.pending,te.pending===te.pending_buf_size)){ce=1;break}ce=te.gzindex<te.gzhead.name.length?255&te.gzhead.name.charCodeAt(te.gzindex++):0,ie(te,ce)}while(ce!==0);te.gzhead.hcrc&&te.pending>re&&(B.adler=l(B.adler,te.pending_buf,te.pending-re,re)),ce===0&&(te.gzindex=0,te.status=91)}else te.status=91;if(te.status===91)if(te.gzhead.comment){re=te.pending;do{if(te.pending===te.pending_buf_size&&(te.gzhead.hcrc&&te.pending>re&&(B.adler=l(B.adler,te.pending_buf,te.pending-re,re)),q(B),re=te.pending,te.pending===te.pending_buf_size)){ce=1;break}ce=te.gzindex<te.gzhead.comment.length?255&te.gzhead.comment.charCodeAt(te.gzindex++):0,ie(te,ce)}while(ce!==0);te.gzhead.hcrc&&te.pending>re&&(B.adler=l(B.adler,te.pending_buf,te.pending-re,re)),ce===0&&(te.status=103)}else te.status=103;if(te.status===103&&(te.gzhead.hcrc?(te.pending+2>te.pending_buf_size&&q(B),te.pending+2<=te.pending_buf_size&&(ie(te,255&B.adler),ie(te,B.adler>>8&255),B.adler=0,te.status=$)):te.status=$),te.pending!==0){if(q(B),B.avail_out===0)return te.last_flush=-1,h}else if(B.avail_in===0&&U(oe)<=U(he)&&oe!==d)return Y(B,-5);if(te.status===666&&B.avail_in!==0)return Y(B,-5);if(B.avail_in!==0||te.lookahead!==0||oe!==u&&te.status!==666){var Ce=te.strategy===2?(function(le,we){for(var Le;;){if(le.lookahead===0&&(se(le),le.lookahead===0)){if(we===u)return k;break}if(le.match_length=0,Le=s._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++,Le&&(X(le,!1),le.strm.avail_out===0))return k}return le.insert=0,we===d?(X(le,!0),le.strm.avail_out===0?G:W):le.last_lit&&(X(le,!1),le.strm.avail_out===0)?k:N})(te,oe):te.strategy===3?(function(le,we){for(var Le,Me,Ne,Ge,Ye=le.window;;){if(le.lookahead<=O){if(se(le),le.lookahead<=O&&we===u)return k;if(le.lookahead===0)break}if(le.match_length=0,le.lookahead>=M&&0<le.strstart&&(Me=Ye[Ne=le.strstart-1])===Ye[++Ne]&&Me===Ye[++Ne]&&Me===Ye[++Ne]){Ge=le.strstart+O;do;while(Me===Ye[++Ne]&&Me===Ye[++Ne]&&Me===Ye[++Ne]&&Me===Ye[++Ne]&&Me===Ye[++Ne]&&Me===Ye[++Ne]&&Me===Ye[++Ne]&&Me===Ye[++Ne]&&Ne<Ge);le.match_length=O-(Ge-Ne),le.match_length>le.lookahead&&(le.match_length=le.lookahead)}if(le.match_length>=M?(Le=s._tr_tally(le,1,le.match_length-M),le.lookahead-=le.match_length,le.strstart+=le.match_length,le.match_length=0):(Le=s._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++),Le&&(X(le,!1),le.strm.avail_out===0))return k}return le.insert=0,we===d?(X(le,!0),le.strm.avail_out===0?G:W):le.last_lit&&(X(le,!1),le.strm.avail_out===0)?k:N})(te,oe):r[te.level].func(te,oe);if(Ce!==G&&Ce!==W||(te.status=666),Ce===k||Ce===G)return B.avail_out===0&&(te.last_flush=-1),h;if(Ce===N&&(oe===1?s._tr_align(te):oe!==5&&(s._tr_stored_block(te,0,0,!1),oe===3&&(Z(te.head),te.lookahead===0&&(te.strstart=0,te.block_start=0,te.insert=0))),q(B),B.avail_out===0))return te.last_flush=-1,h}return oe!==d?h:te.wrap<=0?1:(te.wrap===2?(ie(te,255&B.adler),ie(te,B.adler>>8&255),ie(te,B.adler>>16&255),ie(te,B.adler>>24&255),ie(te,255&B.total_in),ie(te,B.total_in>>8&255),ie(te,B.total_in>>16&255),ie(te,B.total_in>>24&255)):(j(te,B.adler>>>16),j(te,65535&B.adler)),q(B),0<te.wrap&&(te.wrap=-te.wrap),te.pending!==0?h:1)},e.deflateEnd=function(B){var oe;return B&&B.state?(oe=B.state.status)!==F&&oe!==69&&oe!==73&&oe!==91&&oe!==103&&oe!==$&&oe!==666?Y(B,f):(B.state=null,oe===$?Y(B,-3):h):f},e.deflateSetDictionary=function(B,oe){var he,te,re,ce,Ee,Ce,le,we,Le=oe.length;if(!B||!B.state||(ce=(he=B.state).wrap)===2||ce===1&&he.status!==F||he.lookahead)return f;for(ce===1&&(B.adler=o(B.adler,oe,Le,0)),he.wrap=0,Le>=he.w_size&&(ce===0&&(Z(he.head),he.strstart=0,he.block_start=0,he.insert=0),we=new n.Buf8(he.w_size),n.arraySet(we,oe,Le-he.w_size,he.w_size,0),oe=we,Le=he.w_size),Ee=B.avail_in,Ce=B.next_in,le=B.input,B.avail_in=Le,B.next_in=0,B.input=oe,se(he);he.lookahead>=M;){for(te=he.strstart,re=he.lookahead-(M-1);he.ins_h=(he.ins_h<<he.hash_shift^he.window[te+M-1])&he.hash_mask,he.prev[te&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=te,te++,--re;);he.strstart=te,he.lookahead=M-1,se(he)}return he.strstart+=he.lookahead,he.block_start=he.strstart,he.insert=he.lookahead,he.lookahead=0,he.match_length=he.prev_length=M-1,he.match_available=0,B.next_in=Ce,B.input=le,B.avail_in=Ee,he.wrap=ce,h},e.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(a,t,e){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(a,t,e){"use strict";t.exports=function(r,n){var s,o,l,c,u,d,h,f,m,g,y,v,E,C,_,x,P,I,M,O,R,F,$,k,N;s=r.state,o=r.next_in,k=r.input,l=o+(r.avail_in-5),c=r.next_out,N=r.output,u=c-(n-r.avail_out),d=c+(r.avail_out-257),h=s.dmax,f=s.wsize,m=s.whave,g=s.wnext,y=s.window,v=s.hold,E=s.bits,C=s.lencode,_=s.distcode,x=(1<<s.lenbits)-1,P=(1<<s.distbits)-1;e:do{E<15&&(v+=k[o++]<<E,E+=8,v+=k[o++]<<E,E+=8),I=C[v&x];t:for(;;){if(v>>>=M=I>>>24,E-=M,(M=I>>>16&255)===0)N[c++]=65535&I;else{if(!(16&M)){if((64&M)==0){I=C[(65535&I)+(v&(1<<M)-1)];continue t}if(32&M){s.mode=12;break e}r.msg="invalid literal/length code",s.mode=30;break e}O=65535&I,(M&=15)&&(E<M&&(v+=k[o++]<<E,E+=8),O+=v&(1<<M)-1,v>>>=M,E-=M),E<15&&(v+=k[o++]<<E,E+=8,v+=k[o++]<<E,E+=8),I=_[v&P];r:for(;;){if(v>>>=M=I>>>24,E-=M,!(16&(M=I>>>16&255))){if((64&M)==0){I=_[(65535&I)+(v&(1<<M)-1)];continue r}r.msg="invalid distance code",s.mode=30;break e}if(R=65535&I,E<(M&=15)&&(v+=k[o++]<<E,(E+=8)<M&&(v+=k[o++]<<E,E+=8)),h<(R+=v&(1<<M)-1)){r.msg="invalid distance too far back",s.mode=30;break e}if(v>>>=M,E-=M,(M=c-u)<R){if(m<(M=R-M)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break e}if($=y,(F=0)===g){if(F+=f-M,M<O){for(O-=M;N[c++]=y[F++],--M;);F=c-R,$=N}}else if(g<M){if(F+=f+g-M,(M-=g)<O){for(O-=M;N[c++]=y[F++],--M;);if(F=0,g<O){for(O-=M=g;N[c++]=y[F++],--M;);F=c-R,$=N}}}else if(F+=g-M,M<O){for(O-=M;N[c++]=y[F++],--M;);F=c-R,$=N}for(;2<O;)N[c++]=$[F++],N[c++]=$[F++],N[c++]=$[F++],O-=3;O&&(N[c++]=$[F++],1<O&&(N[c++]=$[F++]))}else{for(F=c-R;N[c++]=N[F++],N[c++]=N[F++],N[c++]=N[F++],2<(O-=3););O&&(N[c++]=N[F++],1<O&&(N[c++]=N[F++]))}break}}break}}while(o<l&&c<d);o-=O=E>>3,v&=(1<<(E-=O<<3))-1,r.next_in=o,r.next_out=c,r.avail_in=o<l?l-o+5:5-(o-l),r.avail_out=c<d?d-c+257:257-(c-d),s.hold=v,s.bits=E}},{}],49:[function(a,t,e){"use strict";var r=a("../utils/common"),n=a("./adler32"),s=a("./crc32"),o=a("./inffast"),l=a("./inftrees"),c=1,u=2,d=0,h=-2,f=1,m=852,g=592;function y(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(F){var $;return F&&F.state?($=F.state,F.total_in=F.total_out=$.total=0,F.msg="",$.wrap&&(F.adler=1&$.wrap),$.mode=f,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new r.Buf32(m),$.distcode=$.distdyn=new r.Buf32(g),$.sane=1,$.back=-1,d):h}function C(F){var $;return F&&F.state?(($=F.state).wsize=0,$.whave=0,$.wnext=0,E(F)):h}function _(F,$){var k,N;return F&&F.state?(N=F.state,$<0?(k=0,$=-$):(k=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?h:(N.window!==null&&N.wbits!==$&&(N.window=null),N.wrap=k,N.wbits=$,C(F))):h}function x(F,$){var k,N;return F?(N=new v,(F.state=N).window=null,(k=_(F,$))!==d&&(F.state=null),k):h}var P,I,M=!0;function O(F){if(M){var $;for(P=new r.Buf32(512),I=new r.Buf32(32),$=0;$<144;)F.lens[$++]=8;for(;$<256;)F.lens[$++]=9;for(;$<280;)F.lens[$++]=7;for(;$<288;)F.lens[$++]=8;for(l(c,F.lens,0,288,P,0,F.work,{bits:9}),$=0;$<32;)F.lens[$++]=5;l(u,F.lens,0,32,I,0,F.work,{bits:5}),M=!1}F.lencode=P,F.lenbits=9,F.distcode=I,F.distbits=5}function R(F,$,k,N){var G,W=F.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new r.Buf8(W.wsize)),N>=W.wsize?(r.arraySet(W.window,$,k-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(N<(G=W.wsize-W.wnext)&&(G=N),r.arraySet(W.window,$,k-N,G,W.wnext),(N-=G)?(r.arraySet(W.window,$,k-N,N,0),W.wnext=N,W.whave=W.wsize):(W.wnext+=G,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=G))),0}e.inflateReset=C,e.inflateReset2=_,e.inflateResetKeep=E,e.inflateInit=function(F){return x(F,15)},e.inflateInit2=x,e.inflate=function(F,$){var k,N,G,W,Y,U,Z,q,X,ie,j,K,se,ne,ge,ve,Se,Te,me,pe,B,oe,he,te,re=0,ce=new r.Buf8(4),Ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return h;(k=F.state).mode===12&&(k.mode=13),Y=F.next_out,G=F.output,Z=F.avail_out,W=F.next_in,N=F.input,U=F.avail_in,q=k.hold,X=k.bits,ie=U,j=Z,oe=d;e:for(;;)switch(k.mode){case f:if(k.wrap===0){k.mode=13;break}for(;X<16;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if(2&k.wrap&&q===35615){ce[k.check=0]=255&q,ce[1]=q>>>8&255,k.check=s(k.check,ce,2,0),X=q=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&q)<<8)+(q>>8))%31){F.msg="incorrect header check",k.mode=30;break}if((15&q)!=8){F.msg="unknown compression method",k.mode=30;break}if(X-=4,B=8+(15&(q>>>=4)),k.wbits===0)k.wbits=B;else if(B>k.wbits){F.msg="invalid window size",k.mode=30;break}k.dmax=1<<B,F.adler=k.check=1,k.mode=512&q?10:12,X=q=0;break;case 2:for(;X<16;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if(k.flags=q,(255&k.flags)!=8){F.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){F.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=q>>8&1),512&k.flags&&(ce[0]=255&q,ce[1]=q>>>8&255,k.check=s(k.check,ce,2,0)),X=q=0,k.mode=3;case 3:for(;X<32;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}k.head&&(k.head.time=q),512&k.flags&&(ce[0]=255&q,ce[1]=q>>>8&255,ce[2]=q>>>16&255,ce[3]=q>>>24&255,k.check=s(k.check,ce,4,0)),X=q=0,k.mode=4;case 4:for(;X<16;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}k.head&&(k.head.xflags=255&q,k.head.os=q>>8),512&k.flags&&(ce[0]=255&q,ce[1]=q>>>8&255,k.check=s(k.check,ce,2,0)),X=q=0,k.mode=5;case 5:if(1024&k.flags){for(;X<16;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}k.length=q,k.head&&(k.head.extra_len=q),512&k.flags&&(ce[0]=255&q,ce[1]=q>>>8&255,k.check=s(k.check,ce,2,0)),X=q=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(U<(K=k.length)&&(K=U),K&&(k.head&&(B=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),r.arraySet(k.head.extra,N,W,K,B)),512&k.flags&&(k.check=s(k.check,N,K,W)),U-=K,W+=K,k.length-=K),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(U===0)break e;for(K=0;B=N[W+K++],k.head&&B&&k.length<65536&&(k.head.name+=String.fromCharCode(B)),B&&K<U;);if(512&k.flags&&(k.check=s(k.check,N,K,W)),U-=K,W+=K,B)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(U===0)break e;for(K=0;B=N[W+K++],k.head&&B&&k.length<65536&&(k.head.comment+=String.fromCharCode(B)),B&&K<U;);if(512&k.flags&&(k.check=s(k.check,N,K,W)),U-=K,W+=K,B)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;X<16;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if(q!==(65535&k.check)){F.msg="header crc mismatch",k.mode=30;break}X=q=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),F.adler=k.check=0,k.mode=12;break;case 10:for(;X<32;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}F.adler=k.check=y(q),X=q=0,k.mode=11;case 11:if(k.havedict===0)return F.next_out=Y,F.avail_out=Z,F.next_in=W,F.avail_in=U,k.hold=q,k.bits=X,2;F.adler=k.check=1,k.mode=12;case 12:if($===5||$===6)break e;case 13:if(k.last){q>>>=7&X,X-=7&X,k.mode=27;break}for(;X<3;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}switch(k.last=1&q,X-=1,3&(q>>>=1)){case 0:k.mode=14;break;case 1:if(O(k),k.mode=20,$!==6)break;q>>>=2,X-=2;break e;case 2:k.mode=17;break;case 3:F.msg="invalid block type",k.mode=30}q>>>=2,X-=2;break;case 14:for(q>>>=7&X,X-=7&X;X<32;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if((65535&q)!=(q>>>16^65535)){F.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&q,X=q=0,k.mode=15,$===6)break e;case 15:k.mode=16;case 16:if(K=k.length){if(U<K&&(K=U),Z<K&&(K=Z),K===0)break e;r.arraySet(G,N,W,K,Y),U-=K,W+=K,Z-=K,Y+=K,k.length-=K;break}k.mode=12;break;case 17:for(;X<14;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if(k.nlen=257+(31&q),q>>>=5,X-=5,k.ndist=1+(31&q),q>>>=5,X-=5,k.ncode=4+(15&q),q>>>=4,X-=4,286<k.nlen||30<k.ndist){F.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;X<3;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}k.lens[Ee[k.have++]]=7&q,q>>>=3,X-=3}for(;k.have<19;)k.lens[Ee[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,he={bits:k.lenbits},oe=l(0,k.lens,0,19,k.lencode,0,k.work,he),k.lenbits=he.bits,oe){F.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;ve=(re=k.lencode[q&(1<<k.lenbits)-1])>>>16&255,Se=65535&re,!((ge=re>>>24)<=X);){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if(Se<16)q>>>=ge,X-=ge,k.lens[k.have++]=Se;else{if(Se===16){for(te=ge+2;X<te;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if(q>>>=ge,X-=ge,k.have===0){F.msg="invalid bit length repeat",k.mode=30;break}B=k.lens[k.have-1],K=3+(3&q),q>>>=2,X-=2}else if(Se===17){for(te=ge+3;X<te;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}X-=ge,B=0,K=3+(7&(q>>>=ge)),q>>>=3,X-=3}else{for(te=ge+7;X<te;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}X-=ge,B=0,K=11+(127&(q>>>=ge)),q>>>=7,X-=7}if(k.have+K>k.nlen+k.ndist){F.msg="invalid bit length repeat",k.mode=30;break}for(;K--;)k.lens[k.have++]=B}}if(k.mode===30)break;if(k.lens[256]===0){F.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,he={bits:k.lenbits},oe=l(c,k.lens,0,k.nlen,k.lencode,0,k.work,he),k.lenbits=he.bits,oe){F.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,he={bits:k.distbits},oe=l(u,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,he),k.distbits=he.bits,oe){F.msg="invalid distances set",k.mode=30;break}if(k.mode=20,$===6)break e;case 20:k.mode=21;case 21:if(6<=U&&258<=Z){F.next_out=Y,F.avail_out=Z,F.next_in=W,F.avail_in=U,k.hold=q,k.bits=X,o(F,j),Y=F.next_out,G=F.output,Z=F.avail_out,W=F.next_in,N=F.input,U=F.avail_in,q=k.hold,X=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;ve=(re=k.lencode[q&(1<<k.lenbits)-1])>>>16&255,Se=65535&re,!((ge=re>>>24)<=X);){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if(ve&&(240&ve)==0){for(Te=ge,me=ve,pe=Se;ve=(re=k.lencode[pe+((q&(1<<Te+me)-1)>>Te)])>>>16&255,Se=65535&re,!(Te+(ge=re>>>24)<=X);){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}q>>>=Te,X-=Te,k.back+=Te}if(q>>>=ge,X-=ge,k.back+=ge,k.length=Se,ve===0){k.mode=26;break}if(32&ve){k.back=-1,k.mode=12;break}if(64&ve){F.msg="invalid literal/length code",k.mode=30;break}k.extra=15&ve,k.mode=22;case 22:if(k.extra){for(te=k.extra;X<te;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}k.length+=q&(1<<k.extra)-1,q>>>=k.extra,X-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;ve=(re=k.distcode[q&(1<<k.distbits)-1])>>>16&255,Se=65535&re,!((ge=re>>>24)<=X);){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if((240&ve)==0){for(Te=ge,me=ve,pe=Se;ve=(re=k.distcode[pe+((q&(1<<Te+me)-1)>>Te)])>>>16&255,Se=65535&re,!(Te+(ge=re>>>24)<=X);){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}q>>>=Te,X-=Te,k.back+=Te}if(q>>>=ge,X-=ge,k.back+=ge,64&ve){F.msg="invalid distance code",k.mode=30;break}k.offset=Se,k.extra=15&ve,k.mode=24;case 24:if(k.extra){for(te=k.extra;X<te;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}k.offset+=q&(1<<k.extra)-1,q>>>=k.extra,X-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){F.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(Z===0)break e;if(K=j-Z,k.offset>K){if((K=k.offset-K)>k.whave&&k.sane){F.msg="invalid distance too far back",k.mode=30;break}se=K>k.wnext?(K-=k.wnext,k.wsize-K):k.wnext-K,K>k.length&&(K=k.length),ne=k.window}else ne=G,se=Y-k.offset,K=k.length;for(Z<K&&(K=Z),Z-=K,k.length-=K;G[Y++]=ne[se++],--K;);k.length===0&&(k.mode=21);break;case 26:if(Z===0)break e;G[Y++]=k.length,Z--,k.mode=21;break;case 27:if(k.wrap){for(;X<32;){if(U===0)break e;U--,q|=N[W++]<<X,X+=8}if(j-=Z,F.total_out+=j,k.total+=j,j&&(F.adler=k.check=k.flags?s(k.check,G,j,Y-j):n(k.check,G,j,Y-j)),j=Z,(k.flags?q:y(q))!==k.check){F.msg="incorrect data check",k.mode=30;break}X=q=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;X<32;){if(U===0)break e;U--,q+=N[W++]<<X,X+=8}if(q!==(4294967295&k.total)){F.msg="incorrect length check",k.mode=30;break}X=q=0}k.mode=29;case 29:oe=1;break e;case 30:oe=-3;break e;case 31:return-4;case 32:default:return h}return F.next_out=Y,F.avail_out=Z,F.next_in=W,F.avail_in=U,k.hold=q,k.bits=X,(k.wsize||j!==F.avail_out&&k.mode<30&&(k.mode<27||$!==4))&&R(F,F.output,F.next_out,j-F.avail_out)?(k.mode=31,-4):(ie-=F.avail_in,j-=F.avail_out,F.total_in+=ie,F.total_out+=j,k.total+=j,k.wrap&&j&&(F.adler=k.check=k.flags?s(k.check,G,j,F.next_out-j):n(k.check,G,j,F.next_out-j)),F.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),(ie==0&&j===0||$===4)&&oe===d&&(oe=-5),oe)},e.inflateEnd=function(F){if(!F||!F.state)return h;var $=F.state;return $.window&&($.window=null),F.state=null,d},e.inflateGetHeader=function(F,$){var k;return F&&F.state?(2&(k=F.state).wrap)==0?h:((k.head=$).done=!1,d):h},e.inflateSetDictionary=function(F,$){var k,N=$.length;return F&&F.state?(k=F.state).wrap!==0&&k.mode!==11?h:k.mode===11&&n(1,$,N,0)!==k.check?-3:R(F,$,N,N)?(k.mode=31,-4):(k.havedict=1,d):h},e.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(a,t,e){"use strict";var r=a("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(c,u,d,h,f,m,g,y){var v,E,C,_,x,P,I,M,O,R=y.bits,F=0,$=0,k=0,N=0,G=0,W=0,Y=0,U=0,Z=0,q=0,X=null,ie=0,j=new r.Buf16(16),K=new r.Buf16(16),se=null,ne=0;for(F=0;F<=15;F++)j[F]=0;for($=0;$<h;$++)j[u[d+$]]++;for(G=R,N=15;1<=N&&j[N]===0;N--);if(N<G&&(G=N),N===0)return f[m++]=20971520,f[m++]=20971520,y.bits=1,0;for(k=1;k<N&&j[k]===0;k++);for(G<k&&(G=k),F=U=1;F<=15;F++)if(U<<=1,(U-=j[F])<0)return-1;if(0<U&&(c===0||N!==1))return-1;for(K[1]=0,F=1;F<15;F++)K[F+1]=K[F]+j[F];for($=0;$<h;$++)u[d+$]!==0&&(g[K[u[d+$]]++]=$);if(P=c===0?(X=se=g,19):c===1?(X=n,ie-=257,se=s,ne-=257,256):(X=o,se=l,-1),F=k,x=m,Y=$=q=0,C=-1,_=(Z=1<<(W=G))-1,c===1&&852<Z||c===2&&592<Z)return 1;for(;;){for(I=F-Y,O=g[$]<P?(M=0,g[$]):g[$]>P?(M=se[ne+g[$]],X[ie+g[$]]):(M=96,0),v=1<<F-Y,k=E=1<<W;f[x+(q>>Y)+(E-=v)]=I<<24|M<<16|O|0,E!==0;);for(v=1<<F-1;q&v;)v>>=1;if(v!==0?(q&=v-1,q+=v):q=0,$++,--j[F]==0){if(F===N)break;F=u[d+g[$]]}if(G<F&&(q&_)!==C){for(Y===0&&(Y=G),x+=k,U=1<<(W=F-Y);W+Y<N&&!((U-=j[W+Y])<=0);)W++,U<<=1;if(Z+=1<<W,c===1&&852<Z||c===2&&592<Z)return 1;f[C=q&_]=G<<24|W<<16|x-m|0}}return q!==0&&(f[x+q]=F-Y<<24|64<<16|0),y.bits=G,0}},{"../utils/common":41}],51:[function(a,t,e){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(a,t,e){"use strict";var r=a("../utils/common"),n=0,s=1;function o(re){for(var ce=re.length;0<=--ce;)re[ce]=0}var l=0,c=29,u=256,d=u+1+c,h=30,f=19,m=2*d+1,g=15,y=16,v=7,E=256,C=16,_=17,x=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=new Array(2*(d+2));o(R);var F=new Array(2*h);o(F);var $=new Array(512);o($);var k=new Array(256);o(k);var N=new Array(c);o(N);var G,W,Y,U=new Array(h);function Z(re,ce,Ee,Ce,le){this.static_tree=re,this.extra_bits=ce,this.extra_base=Ee,this.elems=Ce,this.max_length=le,this.has_stree=re&&re.length}function q(re,ce){this.dyn_tree=re,this.max_code=0,this.stat_desc=ce}function X(re){return re<256?$[re]:$[256+(re>>>7)]}function ie(re,ce){re.pending_buf[re.pending++]=255&ce,re.pending_buf[re.pending++]=ce>>>8&255}function j(re,ce,Ee){re.bi_valid>y-Ee?(re.bi_buf|=ce<<re.bi_valid&65535,ie(re,re.bi_buf),re.bi_buf=ce>>y-re.bi_valid,re.bi_valid+=Ee-y):(re.bi_buf|=ce<<re.bi_valid&65535,re.bi_valid+=Ee)}function K(re,ce,Ee){j(re,Ee[2*ce],Ee[2*ce+1])}function se(re,ce){for(var Ee=0;Ee|=1&re,re>>>=1,Ee<<=1,0<--ce;);return Ee>>>1}function ne(re,ce,Ee){var Ce,le,we=new Array(g+1),Le=0;for(Ce=1;Ce<=g;Ce++)we[Ce]=Le=Le+Ee[Ce-1]<<1;for(le=0;le<=ce;le++){var Me=re[2*le+1];Me!==0&&(re[2*le]=se(we[Me]++,Me))}}function ge(re){var ce;for(ce=0;ce<d;ce++)re.dyn_ltree[2*ce]=0;for(ce=0;ce<h;ce++)re.dyn_dtree[2*ce]=0;for(ce=0;ce<f;ce++)re.bl_tree[2*ce]=0;re.dyn_ltree[2*E]=1,re.opt_len=re.static_len=0,re.last_lit=re.matches=0}function ve(re){8<re.bi_valid?ie(re,re.bi_buf):0<re.bi_valid&&(re.pending_buf[re.pending++]=re.bi_buf),re.bi_buf=0,re.bi_valid=0}function Se(re,ce,Ee,Ce){var le=2*ce,we=2*Ee;return re[le]<re[we]||re[le]===re[we]&&Ce[ce]<=Ce[Ee]}function Te(re,ce,Ee){for(var Ce=re.heap[Ee],le=Ee<<1;le<=re.heap_len&&(le<re.heap_len&&Se(ce,re.heap[le+1],re.heap[le],re.depth)&&le++,!Se(ce,Ce,re.heap[le],re.depth));)re.heap[Ee]=re.heap[le],Ee=le,le<<=1;re.heap[Ee]=Ce}function me(re,ce,Ee){var Ce,le,we,Le,Me=0;if(re.last_lit!==0)for(;Ce=re.pending_buf[re.d_buf+2*Me]<<8|re.pending_buf[re.d_buf+2*Me+1],le=re.pending_buf[re.l_buf+Me],Me++,Ce===0?K(re,le,ce):(K(re,(we=k[le])+u+1,ce),(Le=P[we])!==0&&j(re,le-=N[we],Le),K(re,we=X(--Ce),Ee),(Le=I[we])!==0&&j(re,Ce-=U[we],Le)),Me<re.last_lit;);K(re,E,ce)}function pe(re,ce){var Ee,Ce,le,we=ce.dyn_tree,Le=ce.stat_desc.static_tree,Me=ce.stat_desc.has_stree,Ne=ce.stat_desc.elems,Ge=-1;for(re.heap_len=0,re.heap_max=m,Ee=0;Ee<Ne;Ee++)we[2*Ee]!==0?(re.heap[++re.heap_len]=Ge=Ee,re.depth[Ee]=0):we[2*Ee+1]=0;for(;re.heap_len<2;)we[2*(le=re.heap[++re.heap_len]=Ge<2?++Ge:0)]=1,re.depth[le]=0,re.opt_len--,Me&&(re.static_len-=Le[2*le+1]);for(ce.max_code=Ge,Ee=re.heap_len>>1;1<=Ee;Ee--)Te(re,we,Ee);for(le=Ne;Ee=re.heap[1],re.heap[1]=re.heap[re.heap_len--],Te(re,we,1),Ce=re.heap[1],re.heap[--re.heap_max]=Ee,re.heap[--re.heap_max]=Ce,we[2*le]=we[2*Ee]+we[2*Ce],re.depth[le]=(re.depth[Ee]>=re.depth[Ce]?re.depth[Ee]:re.depth[Ce])+1,we[2*Ee+1]=we[2*Ce+1]=le,re.heap[1]=le++,Te(re,we,1),2<=re.heap_len;);re.heap[--re.heap_max]=re.heap[1],(function(Ye,ft){var ct,Ve,et,$e,Ie,ee,ye=ft.dyn_tree,Pe=ft.max_code,xe=ft.stat_desc.static_tree,Fe=ft.stat_desc.has_stree,qe=ft.stat_desc.extra_bits,Re=ft.stat_desc.extra_base,ze=ft.stat_desc.max_length,Ze=0;for($e=0;$e<=g;$e++)Ye.bl_count[$e]=0;for(ye[2*Ye.heap[Ye.heap_max]+1]=0,ct=Ye.heap_max+1;ct<m;ct++)ze<($e=ye[2*ye[2*(Ve=Ye.heap[ct])+1]+1]+1)&&($e=ze,Ze++),ye[2*Ve+1]=$e,Pe<Ve||(Ye.bl_count[$e]++,Ie=0,Re<=Ve&&(Ie=qe[Ve-Re]),ee=ye[2*Ve],Ye.opt_len+=ee*($e+Ie),Fe&&(Ye.static_len+=ee*(xe[2*Ve+1]+Ie)));if(Ze!==0){do{for($e=ze-1;Ye.bl_count[$e]===0;)$e--;Ye.bl_count[$e]--,Ye.bl_count[$e+1]+=2,Ye.bl_count[ze]--,Ze-=2}while(0<Ze);for($e=ze;$e!==0;$e--)for(Ve=Ye.bl_count[$e];Ve!==0;)Pe<(et=Ye.heap[--ct])||(ye[2*et+1]!==$e&&(Ye.opt_len+=($e-ye[2*et+1])*ye[2*et],ye[2*et+1]=$e),Ve--)}})(re,ce),ne(we,Ge,re.bl_count)}function B(re,ce,Ee){var Ce,le,we=-1,Le=ce[1],Me=0,Ne=7,Ge=4;for(Le===0&&(Ne=138,Ge=3),ce[2*(Ee+1)+1]=65535,Ce=0;Ce<=Ee;Ce++)le=Le,Le=ce[2*(Ce+1)+1],++Me<Ne&&le===Le||(Me<Ge?re.bl_tree[2*le]+=Me:le!==0?(le!==we&&re.bl_tree[2*le]++,re.bl_tree[2*C]++):Me<=10?re.bl_tree[2*_]++:re.bl_tree[2*x]++,we=le,Ge=(Me=0)===Le?(Ne=138,3):le===Le?(Ne=6,3):(Ne=7,4))}function oe(re,ce,Ee){var Ce,le,we=-1,Le=ce[1],Me=0,Ne=7,Ge=4;for(Le===0&&(Ne=138,Ge=3),Ce=0;Ce<=Ee;Ce++)if(le=Le,Le=ce[2*(Ce+1)+1],!(++Me<Ne&&le===Le)){if(Me<Ge)for(;K(re,le,re.bl_tree),--Me!=0;);else le!==0?(le!==we&&(K(re,le,re.bl_tree),Me--),K(re,C,re.bl_tree),j(re,Me-3,2)):Me<=10?(K(re,_,re.bl_tree),j(re,Me-3,3)):(K(re,x,re.bl_tree),j(re,Me-11,7));we=le,Ge=(Me=0)===Le?(Ne=138,3):le===Le?(Ne=6,3):(Ne=7,4)}}o(U);var he=!1;function te(re,ce,Ee,Ce){j(re,(l<<1)+(Ce?1:0),3),(function(le,we,Le,Me){ve(le),Me&&(ie(le,Le),ie(le,~Le)),r.arraySet(le.pending_buf,le.window,we,Le,le.pending),le.pending+=Le})(re,ce,Ee,!0)}e._tr_init=function(re){he||((function(){var ce,Ee,Ce,le,we,Le=new Array(g+1);for(le=Ce=0;le<c-1;le++)for(N[le]=Ce,ce=0;ce<1<<P[le];ce++)k[Ce++]=le;for(k[Ce-1]=le,le=we=0;le<16;le++)for(U[le]=we,ce=0;ce<1<<I[le];ce++)$[we++]=le;for(we>>=7;le<h;le++)for(U[le]=we<<7,ce=0;ce<1<<I[le]-7;ce++)$[256+we++]=le;for(Ee=0;Ee<=g;Ee++)Le[Ee]=0;for(ce=0;ce<=143;)R[2*ce+1]=8,ce++,Le[8]++;for(;ce<=255;)R[2*ce+1]=9,ce++,Le[9]++;for(;ce<=279;)R[2*ce+1]=7,ce++,Le[7]++;for(;ce<=287;)R[2*ce+1]=8,ce++,Le[8]++;for(ne(R,d+1,Le),ce=0;ce<h;ce++)F[2*ce+1]=5,F[2*ce]=se(ce,5);G=new Z(R,P,u+1,d,g),W=new Z(F,I,0,h,g),Y=new Z(new Array(0),M,0,f,v)})(),he=!0),re.l_desc=new q(re.dyn_ltree,G),re.d_desc=new q(re.dyn_dtree,W),re.bl_desc=new q(re.bl_tree,Y),re.bi_buf=0,re.bi_valid=0,ge(re)},e._tr_stored_block=te,e._tr_flush_block=function(re,ce,Ee,Ce){var le,we,Le=0;0<re.level?(re.strm.data_type===2&&(re.strm.data_type=(function(Me){var Ne,Ge=4093624447;for(Ne=0;Ne<=31;Ne++,Ge>>>=1)if(1&Ge&&Me.dyn_ltree[2*Ne]!==0)return n;if(Me.dyn_ltree[18]!==0||Me.dyn_ltree[20]!==0||Me.dyn_ltree[26]!==0)return s;for(Ne=32;Ne<u;Ne++)if(Me.dyn_ltree[2*Ne]!==0)return s;return n})(re)),pe(re,re.l_desc),pe(re,re.d_desc),Le=(function(Me){var Ne;for(B(Me,Me.dyn_ltree,Me.l_desc.max_code),B(Me,Me.dyn_dtree,Me.d_desc.max_code),pe(Me,Me.bl_desc),Ne=f-1;3<=Ne&&Me.bl_tree[2*O[Ne]+1]===0;Ne--);return Me.opt_len+=3*(Ne+1)+5+5+4,Ne})(re),le=re.opt_len+3+7>>>3,(we=re.static_len+3+7>>>3)<=le&&(le=we)):le=we=Ee+5,Ee+4<=le&&ce!==-1?te(re,ce,Ee,Ce):re.strategy===4||we===le?(j(re,2+(Ce?1:0),3),me(re,R,F)):(j(re,4+(Ce?1:0),3),(function(Me,Ne,Ge,Ye){var ft;for(j(Me,Ne-257,5),j(Me,Ge-1,5),j(Me,Ye-4,4),ft=0;ft<Ye;ft++)j(Me,Me.bl_tree[2*O[ft]+1],3);oe(Me,Me.dyn_ltree,Ne-1),oe(Me,Me.dyn_dtree,Ge-1)})(re,re.l_desc.max_code+1,re.d_desc.max_code+1,Le+1),me(re,re.dyn_ltree,re.dyn_dtree)),ge(re),Ce&&ve(re)},e._tr_tally=function(re,ce,Ee){return re.pending_buf[re.d_buf+2*re.last_lit]=ce>>>8&255,re.pending_buf[re.d_buf+2*re.last_lit+1]=255&ce,re.pending_buf[re.l_buf+re.last_lit]=255&Ee,re.last_lit++,ce===0?re.dyn_ltree[2*Ee]++:(re.matches++,ce--,re.dyn_ltree[2*(k[Ee]+u+1)]++,re.dyn_dtree[2*X(ce)]++),re.last_lit===re.lit_bufsize-1},e._tr_align=function(re){j(re,2,3),K(re,E,R),(function(ce){ce.bi_valid===16?(ie(ce,ce.bi_buf),ce.bi_buf=0,ce.bi_valid=0):8<=ce.bi_valid&&(ce.pending_buf[ce.pending++]=255&ce.bi_buf,ce.bi_buf>>=8,ce.bi_valid-=8)})(re)}},{"../utils/common":41}],53:[function(a,t,e){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(a,t,e){(function(r){(function(n,s){"use strict";if(!n.setImmediate){var o,l,c,u,d=1,h={},f=!1,m=n.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(n);g=g&&g.setTimeout?g:n,o={}.toString.call(n.process)==="[object process]"?function(C){process.nextTick(function(){v(C)})}:(function(){if(n.postMessage&&!n.importScripts){var C=!0,_=n.onmessage;return n.onmessage=function(){C=!1},n.postMessage("","*"),n.onmessage=_,C}})()?(u="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",E,!1):n.attachEvent("onmessage",E),function(C){n.postMessage(u+C,"*")}):n.MessageChannel?((c=new MessageChannel).port1.onmessage=function(C){v(C.data)},function(C){c.port2.postMessage(C)}):m&&"onreadystatechange"in m.createElement("script")?(l=m.documentElement,function(C){var _=m.createElement("script");_.onreadystatechange=function(){v(C),_.onreadystatechange=null,l.removeChild(_),_=null},l.appendChild(_)}):function(C){setTimeout(v,0,C)},g.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var _=new Array(arguments.length-1),x=0;x<_.length;x++)_[x]=arguments[x+1];var P={callback:C,args:_};return h[d]=P,o(d),d++},g.clearImmediate=y}function y(C){delete h[C]}function v(C){if(f)setTimeout(v,0,C);else{var _=h[C];if(_){f=!0;try{(function(x){var P=x.callback,I=x.args;switch(I.length){case 0:P();break;case 1:P(I[0]);break;case 2:P(I[0],I[1]);break;case 3:P(I[0],I[1],I[2]);break;default:P.apply(s,I)}})(_)}finally{y(C),f=!1}}}}function E(C){C.source===n&&typeof C.data=="string"&&C.data.indexOf(u)===0&&v(+C.data.slice(u.length))}})(typeof self=="undefined"?r===void 0?this:r:self)}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})});function vP(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}function ZTe(a){let t=a.match(/(\d+)/);if(t)return parseInt(t[1],10);let e={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15},r=a.toLowerCase();for(let[n,s]of Object.entries(e))if(r.includes(n))return s}var KTe,ME,H4=_e(()=>{KTe=[/^\s*\*\s*\*\s*\*\s*$/,/^\s*\*{3,}\s*$/,/^\s*-{3,}\s*$/,/^\s*~{3,}\s*$/,/^\s*#{3,}\s*$/],ME=class{constructor(){this.name="EPUB Parser";this.format="epub"}canParse(t,e){return e.toLowerCase().split(".").pop()==="epub"}parse(t,e){return{metadata:{title:e.replace(/\.epub$/i,""),totalWords:0,chapterCount:0,confidence:0,detectionMethod:"EPUB (use parseAsync)"},chapters:[],warnings:["EPUB parsing requires async method. Please use parseAsync."],format:this.format}}async parseAsync(t,e){var r,n,s,o;try{let c=await(await Promise.resolve().then(()=>Ca(gP()))).default.loadAsync(t),u=await((r=c.file("META-INF/container.xml"))==null?void 0:r.async("string"));if(!u)throw new Error("Invalid EPUB: Missing container.xml");let h=new DOMParser().parseFromString(u,"text/xml").querySelector("rootfile"),f=h==null?void 0:h.getAttribute("full-path");if(!f)throw new Error("Invalid EPUB: Cannot find OPF file path");let m=await((n=c.file(f))==null?void 0:n.async("string"));if(!m)throw new Error("Invalid EPUB: Cannot read OPF file");let g=new DOMParser().parseFromString(m,"text/xml"),y=f.substring(0,f.lastIndexOf("/")+1),v=g.querySelector("metadata title, dc\\:title"),E=g.querySelector("metadata creator, dc\\:creator"),C=(v==null?void 0:v.textContent)||e.replace(/\.epub$/i,""),_=(E==null?void 0:E.textContent)||void 0,x=new Map;g.querySelectorAll("manifest item").forEach(R=>{let F=R.getAttribute("id"),$=R.getAttribute("href");F&&$&&x.set(F,$)});let P=[];g.querySelectorAll("spine itemref").forEach(R=>{let F=R.getAttribute("idref");F&&x.has(F)&&P.push(x.get(F))});let I=[],M=0;for(let R of P){let F=y+R,$=await((s=c.file(F))==null?void 0:s.async("string"));if(!$)continue;let N=new DOMParser().parseFromString($,"text/html").body;if(!N)continue;let G=N.querySelector("h1, h2, h3"),W=((o=G==null?void 0:G.textContent)==null?void 0:o.trim())||"",Y=this.extractTextContent(N);if(Y.trim().length===0||vP(Y)<50)continue;M++,W||(W=`Chapter ${M}`);let U=this.detectScenes(Y);I.push({title:W,number:ZTe(W)||M,content:Y,wordCount:vP(Y),scenes:U.length>1?U:void 0})}let O=I.reduce((R,F)=>R+F.wordCount,0);return{metadata:{title:C,author:_,totalWords:O,chapterCount:I.length,confidence:85,detectionMethod:"EPUB spine order"},chapters:I,warnings:I.length===0?["No chapters could be extracted from EPUB."]:[],format:this.format}}catch(l){return console.error("Error parsing EPUB:",l),{metadata:{title:e.replace(/\.epub$/i,""),totalWords:0,chapterCount:0,confidence:0,detectionMethod:"EPUB parse failed"},chapters:[],warnings:[`Failed to parse EPUB: ${l}. Make sure jszip is installed.`],format:this.format}}}extractTextContent(t){let e=[],r=t.querySelectorAll("p, div, h1, h2, h3, h4, h5, h6, blockquote, li");return r.length===0?this.normalizeWhitespace(t.textContent||""):(r.forEach(n=>{var o;let s=(o=n.textContent)==null?void 0:o.trim();s&&e.push(this.normalizeWhitespace(s))}),e.join(`

`))}normalizeWhitespace(t){return t.replace(/\t/g," ").replace(/ {2,}/g," ").replace(/\n\s*\n\s*\n/g,`

`).split(`
`).map(e=>e.trim()).join(`
`).trim()}detectScenes(t){let e=t.split(`
`),r=[],n=[],s=[];for(let o of e)if(KTe.some(c=>c.test(o))){if(s.length>0){let c=s.join(`
`).trim();c.length>0&&n.push(c)}s=[]}else s.push(o);if(s.length>0){let o=s.join(`
`).trim();o.length>0&&n.push(o)}for(let o=0;o<n.length;o++)r.push({title:`Scene ${o+1}`,content:n[o],wordCount:vP(n[o])});return r}}});function nd(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}function XTe(a){let t=a.match(/(\d+)/);if(t)return parseInt(t[1],10);let e={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15},r=a.toLowerCase();for(let[n,s]of Object.entries(e))if(r.includes(n))return s}var JTe,IE,G4=_e(()=>{JTe=[/^\s*\*\s*\*\s*\*\s*$/,/^\s*\*{3,}\s*$/,/^\s*-{3,}\s*$/,/^\s*~{3,}\s*$/,/^\s*#{3,}\s*$/],IE=class{constructor(){this.name="HTML Parser";this.format="html"}canParse(t,e){let r=e.toLowerCase().split(".").pop();return r==="html"||r==="htm"?!0:t.trim().startsWith("<!DOCTYPE")||t.trim().startsWith("<html")||t.includes("<body")}parse(t,e){try{let r=new DOMParser().parseFromString(t,"text/html");return this.parseHtmlDocument(r,e)}catch(r){return{metadata:{title:e,totalWords:0,chapterCount:0,confidence:0,detectionMethod:"HTML parse failed"},chapters:[],warnings:[`Failed to parse HTML: ${r}`],format:this.format}}}parseHtmlDocument(t,e){var m,g,y,v;let r=[],n=t.querySelector("title"),s=t.querySelector("h1"),o=((m=n==null?void 0:n.textContent)==null?void 0:m.trim())||((g=s==null?void 0:s.textContent)==null?void 0:g.trim())||e.replace(/\.(html|htm)$/i,""),l=t.body;if(!l)return{metadata:{title:o,totalWords:0,chapterCount:1,confidence:50,detectionMethod:"No body found"},chapters:[{title:e.replace(/\.(html|htm)$/i,""),number:1,content:((y=t.documentElement)==null?void 0:y.textContent)||"",wordCount:nd(((v=t.documentElement)==null?void 0:v.textContent)||"")}],warnings:["No body element found in HTML."],format:this.format};let c=l.querySelectorAll("h1, h2, h3, h4, h5, h6");if(c.length===0){let E=this.extractTextContent(l);return{metadata:{title:o,totalWords:nd(E),chapterCount:1,confidence:50,detectionMethod:"No headings found"},chapters:[{title:o,number:1,content:E,wordCount:nd(E),scenes:this.detectScenes(E).length>1?this.detectScenes(E):void 0}],warnings:["No heading structure found. Document imported as single chapter."],format:this.format}}let u=this.determineChapterLevel(c),d=this.extractChapters(l,c,u);if(d.length===0){let E=this.extractTextContent(l);return r.push("No chapters could be extracted from heading structure."),{metadata:{title:o,totalWords:nd(E),chapterCount:1,confidence:50,detectionMethod:"No chapters extracted"},chapters:[{title:o,number:1,content:E,wordCount:nd(E)}],warnings:r,format:this.format}}let h=d.map(E=>E.number).filter(E=>E!==void 0);h.length>1&&(h.every((C,_)=>_===0||C===h[_-1]+1)||r.push("Chapter numbering is not sequential."));let f=d.reduce((E,C)=>E+C.wordCount,0);return{metadata:{title:o,totalWords:f,chapterCount:d.length,confidence:85,detectionMethod:`H${u} as chapters`},chapters:d,warnings:r,format:this.format}}determineChapterLevel(t){let e=new Map;if(t.forEach(s=>{let o=parseInt(s.tagName[1],10);e.set(o,(e.get(o)||0)+1)}),(e.get(1)||0)>1)return 1;if((e.get(1)||0)===1&&(e.get(2)||0)>0)return 2;let r=0,n=1;for(let[s,o]of e.entries())o>r&&(r=o,n=s);return n}extractChapters(t,e,r){var o,l;let n=[],s=Array.from(e).filter(c=>parseInt(c.tagName[1],10)===r);for(let c=0;c<s.length;c++){let u=s[c],d=s[c+1],h=((o=u.textContent)==null?void 0:o.trim())||"",f=[],m=u.nextElementSibling;for(;m&&m!==d&&!(m.tagName.match(/^H[1-6]$/)&&parseInt(m.tagName[1],10)===r);){let v=(l=m.textContent)==null?void 0:l.trim();v&&f.push(this.normalizeWhitespace(v)),m=m.nextElementSibling}let g=f.join(`

`);if(g.length===0)continue;let y=this.detectScenes(g);n.push({title:h,number:XTe(h),content:g,wordCount:nd(g),scenes:y.length>1?y:void 0})}return n}extractTextContent(t){let e=[],r=t.querySelectorAll("p, div, blockquote, li");return r.length===0?this.normalizeWhitespace(t.textContent||""):(r.forEach(n=>{var o;let s=(o=n.textContent)==null?void 0:o.trim();s&&e.push(this.normalizeWhitespace(s))}),e.join(`

`))}normalizeWhitespace(t){return t.replace(/\t/g," ").replace(/ {2,}/g," ").replace(/\n\s*\n\s*\n/g,`

`).split(`
`).map(e=>e.trim()).join(`
`).trim()}detectScenes(t){let e=t.split(`
`),r=[],n=[],s=[];for(let o of e)if(JTe.some(c=>c.test(o))){if(s.length>0){let c=s.join(`
`).trim();c.length>0&&n.push(c)}s=[]}else s.push(o);if(s.length>0){let o=s.join(`
`).trim();o.length>0&&n.push(o)}for(let o=0;o<n.length;o++)r.push({title:`Scene ${o+1}`,content:n[o],wordCount:nd(n[o])});return r}}});function AE(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}function QTe(a){let t=a.match(/(\d+)/);if(t)return parseInt(t[1],10);let e={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15},r=a.toLowerCase();for(let[n,s]of Object.entries(e))if(r.includes(n))return s}var eCe,tCe,OE,V4=_e(()=>{eCe=[/^(?:Chapter|CHAPTER|Ch\.?)\s+(\d+)(?::\s*(.+))?$/i,/^(?:Chapter|CHAPTER)\s+(one|two|three|four|five|six|seven|eight|nine|ten|eleven|twelve|thirteen|fourteen|fifteen)(?::\s*(.+))?$/i,/^CHAPTER\s+(\d+)(?::\s*(.+))?$/,/^(?:Chapter|CHAPTER)\s+([IVXLCDM]+)(?::\s*(.+))?$/i],tCe=[/^\s*\*\s*\*\s*\*\s*$/,/^\s*\*{3,}\s*$/,/^\s*-{3,}\s*$/,/^\s*~{3,}\s*$/,/^\s*#{3,}\s*$/],OE=class{constructor(){this.name="RTF Parser";this.format="rtf"}canParse(t,e){return e.toLowerCase().split(".").pop()==="rtf"?!0:t.trim().startsWith("{\\rtf")}parse(t,e){try{let r=this.rtfToPlainText(t);return this.parseText(r,e)}catch(r){return{metadata:{title:e,totalWords:0,chapterCount:0,confidence:0,detectionMethod:"RTF parse failed"},chapters:[],warnings:[`Failed to parse RTF: ${r}`],format:this.format}}}rtfToPlainText(t){let e=t,r=0,n="",s=0,o=!1,l=0;for(;s<e.length;){let c=e[s];if(c==="{"){r++,e.slice(s,s+20).match(/^\{\\(fonttbl|colortbl|stylesheet|info|pict|object|\*)/)&&(o=!0,l=r),s++;continue}if(c==="}"){o&&r===l&&(o=!1),r--,s++;continue}if(o){s++;continue}if(c==="\\"){if(s++,s>=e.length)break;let u=e[s];if(u==="\\"||u==="{"||u==="}"){n+=u,s++;continue}if(u==="p"&&e.slice(s,s+4)==="par "){n+=`
`,s+=4;continue}if(u==="p"&&e.slice(s,s+3)==="par"){n+=`
`,s+=3;continue}if(u===`
`||u==="\r"){s++;continue}if(u==="t"&&e.slice(s,s+4)==="tab "){n+="	",s+=4;continue}if(u==="u"){let h=e.slice(s).match(/^u(-?\d+)/);if(h){let f=parseInt(h[1],10);f>=0&&(n+=String.fromCharCode(f)),s+=h[0].length,e[s]==="?"&&s++;continue}}let d=e.slice(s).match(/^[a-z]+(-?\d+)?\s?/i);if(d){s+=d[0].length;continue}s++;continue}r>0&&(n+=c),s++}return n.replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\n{3,}/g,`

`).trim()}parseText(t,e){let r=t.split(`
`),n=[],s=[];for(let c=0;c<r.length;c++){let u=r[c].trim();for(let d of eCe)if(u.match(d)){s.push({lineIndex:c,title:u,number:QTe(u)});break}}if(s.length===0){n.push("No chapter markers found. Treating entire document as one chapter.");let c=this.detectScenes(t);return{metadata:{title:e.replace(/\.rtf$/i,""),totalWords:AE(t),chapterCount:1,confidence:50,detectionMethod:"No chapters detected"},chapters:[{title:e.replace(/\.rtf$/i,""),number:1,content:t,wordCount:AE(t),scenes:c.length>1?c:void 0}],warnings:n,format:this.format}}let o=[];for(let c=0;c<s.length;c++){let u=s[c],d=s[c+1],h=u.lineIndex+1,f=d?d.lineIndex-1:r.length-1,g=r.slice(h,f+1).join(`
`).trim();if(g.length===0){n.push(`Chapter "${u.title}" is empty and was skipped.`);continue}let y=this.detectScenes(g);o.push({title:u.title,number:u.number||c+1,content:g,wordCount:AE(g),scenes:y.length>1?y:void 0})}let l=o.reduce((c,u)=>c+u.wordCount,0);return{metadata:{title:this.extractTitle(r)||e.replace(/\.rtf$/i,""),totalWords:l,chapterCount:o.length,confidence:75,detectionMethod:"Chapter markers"},chapters:o,warnings:n,format:this.format}}extractTitle(t){let e=t.slice(0,10).filter(n=>n.trim().length>0);if(e.length===0)return;let r=e[0].trim();if(r.length>0&&r.length<100&&!r.match(/^(?:Chapter|CHAPTER|Ch\.)/i))return r}detectScenes(t){let e=t.split(`
`),r=[],n=[],s=[];for(let o of e)if(tCe.some(c=>c.test(o))){if(s.length>0){let c=s.join(`
`).trim();c.length>0&&n.push(c)}s=[]}else s.push(o);if(s.length>0){let o=s.join(`
`).trim();o.length>0&&n.push(o)}for(let o=0;o<n.length;o++)r.push({title:`Scene ${o+1}`,content:n[o],wordCount:AE(n[o])});return r}}});function ad(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}function W4(a){let t=a.match(/(\d+)/);if(t)return parseInt(t[1],10);let e={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15},r=a.toLowerCase();for(let[n,s]of Object.entries(e))if(r.includes(n))return s}var rCe,FE,U4=_e(()=>{rCe=[/^\s*\*\s*\*\s*\*\s*$/,/^\s*\*{3,}\s*$/,/^\s*-{3,}\s*$/,/^\s*~{3,}\s*$/,/^\s*#{3,}\s*$/],FE=class{constructor(){this.name="ODT Parser";this.format="odt"}canParse(t,e){return e.toLowerCase().split(".").pop()==="odt"}parse(t,e){return{metadata:{title:e.replace(/\.odt$/i,""),totalWords:0,chapterCount:0,confidence:0,detectionMethod:"ODT (use parseAsync)"},chapters:[],warnings:["ODT parsing requires async method. Please use parseAsync."],format:this.format}}async parseAsync(t,e){var r,n;try{let o=await(await Promise.resolve().then(()=>Ca(gP()))).default.loadAsync(t),l=await((r=o.file("content.xml"))==null?void 0:r.async("string"));if(!l)throw new Error("Invalid ODT: Missing content.xml");let c=await((n=o.file("meta.xml"))==null?void 0:n.async("string")),u=e.replace(/\.odt$/i,""),d;if(c){let m=new DOMParser().parseFromString(c,"text/xml"),g=m.querySelector("title"),y=m.querySelector("creator, initial-creator");g!=null&&g.textContent&&(u=g.textContent),y!=null&&y.textContent&&(d=y.textContent)}let h=new DOMParser().parseFromString(l,"text/xml"),f=this.extractStructuredContent(h);return this.parseStructuredContent(f,u,d,e)}catch(s){return console.error("Error parsing ODT:",s),{metadata:{title:e.replace(/\.odt$/i,""),totalWords:0,chapterCount:0,confidence:0,detectionMethod:"ODT parse failed"},chapters:[],warnings:[`Failed to parse ODT: ${s}. Make sure jszip is installed.`],format:this.format}}}extractStructuredContent(t){let e=[],r=t.querySelector("office\\:body, body");if(!r)return e;let n=r.querySelector("office\\:text, text");if(!n)return e;let s=l=>{var u,d;let c=l.localName||l.nodeName.split(":").pop();if(c==="h"){let h=l.getAttribute("text:outline-level")||"1",f=((u=l.textContent)==null?void 0:u.trim())||"";f&&e.push({type:"heading",level:parseInt(h,10),text:f})}else if(c==="p"){let h=((d=l.textContent)==null?void 0:d.trim())||"";h&&e.push({type:"paragraph",text:h})}else c==="list"&&l.querySelectorAll("list-item").forEach(h=>{var m;let f=((m=h.textContent)==null?void 0:m.trim())||"";f&&e.push({type:"paragraph",text:"- "+f})})},o=n.children;for(let l=0;l<o.length;l++)s(o[l]);return e}parseStructuredContent(t,e,r,n){let s=[],o=t.filter(m=>m.type==="heading");if(o.length===0){let m=t.map(y=>y.text).join(`

`),g=this.detectScenes(m);return{metadata:{title:e,author:r,totalWords:ad(m),chapterCount:1,confidence:50,detectionMethod:"No headings found"},chapters:[{title:e,number:1,content:m,wordCount:ad(m),scenes:g.length>1?g:void 0}],warnings:["No heading structure found. Document imported as single chapter."],format:this.format}}let l=new Map;o.forEach(m=>{let g=m.level||1;l.set(g,(l.get(g)||0)+1)});let c=1,u=0;for(let[m,g]of l.entries())g>u&&(u=g,c=m);let d=[],h=null;for(let m of t)if(m.type==="heading"&&m.level===c){if(h&&h.content.length>0){let g=h.content.join(`

`),y=this.detectScenes(g);d.push({title:h.title,number:W4(h.title)||d.length+1,content:g,wordCount:ad(g),scenes:y.length>1?y:void 0})}h={title:m.text,content:[]}}else h&&h.content.push(m.text);if(h&&h.content.length>0){let m=h.content.join(`

`),g=this.detectScenes(m);d.push({title:h.title,number:W4(h.title)||d.length+1,content:m,wordCount:ad(m),scenes:g.length>1?g:void 0})}if(d.length===0){let m=t.map(g=>g.text).join(`

`);return s.push("No chapters could be extracted."),{metadata:{title:e,author:r,totalWords:ad(m),chapterCount:1,confidence:50,detectionMethod:"No chapters extracted"},chapters:[{title:e,number:1,content:m,wordCount:ad(m)}],warnings:s,format:this.format}}let f=d.reduce((m,g)=>m+g.wordCount,0);return{metadata:{title:e,author:r,totalWords:f,chapterCount:d.length,confidence:85,detectionMethod:`Heading level ${c}`},chapters:d,warnings:s,format:this.format}}detectScenes(t){let e=t.split(`
`),r=[],n=[],s=[];for(let o of e)if(rCe.some(c=>c.test(o))){if(s.length>0){let c=s.join(`
`).trim();c.length>0&&n.push(c)}s=[]}else s.push(o);if(s.length>0){let o=s.join(`
`).trim();o.length>0&&n.push(o)}for(let o=0;o<n.length;o++)r.push({title:`Scene ${o+1}`,content:n[o],wordCount:ad(n[o])});return r}}});function RE(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}var NE,j4=_e(()=>{NE=class{constructor(){this.name="Fountain Parser";this.format="fountain"}canParse(t,e){let r=e.toLowerCase().split(".").pop();return!!(r==="fountain"||r==="spmd"||t.match(/^(INT\.|EXT\.|INT\/EXT\.|I\/E\.)/im))}parse(t,e){try{let{titlePage:r,body:n}=this.parseTitlePage(t),s=this.parseScenes(n);if(s.length===0)return{metadata:{title:r.title||e.replace(/\.(fountain|spmd)$/i,""),author:r.author,totalWords:RE(t),chapterCount:1,confidence:60,detectionMethod:"No scenes detected"},chapters:[{title:r.title||"Script",number:1,content:n,wordCount:RE(n)}],warnings:["No scene headings found. Document imported as single chapter."],format:this.format};let o=this.groupScenesIntoChapters(s),l=o.reduce((c,u)=>c+u.wordCount,0);return{metadata:{title:r.title||e.replace(/\.(fountain|spmd)$/i,""),author:r.author,totalWords:l,chapterCount:o.length,confidence:85,detectionMethod:"Fountain scene headings"},chapters:o,warnings:[],format:this.format}}catch(r){return{metadata:{title:e,totalWords:0,chapterCount:0,confidence:0,detectionMethod:"Fountain parse failed"},chapters:[],warnings:[`Failed to parse Fountain file: ${r}`],format:this.format}}}parseTitlePage(t){let e={},r=t.split(`
`),n=0,s=!0,o=!1;for(let c=0;c<r.length;c++){let u=r[c],d=u.match(/^(Title|Author|Credit|Source|Draft date|Contact|Copyright):\s*(.+)$/i);if(d){o=!0;let h=d[1].toLowerCase(),f=d[2].trim();h==="title"&&(e.title=f),(h==="author"||h==="credit")&&(e.author=f)}else if(o&&u.trim()===""){n=c+1;break}else if(!o&&u.trim()!=="")break}let l=r.slice(n).join(`
`).trim();return{titlePage:e,body:l}}parseScenes(t){var o;let e=[],r=/^(INT\.|EXT\.|INT\/EXT\.|I\/E\.|\.)\s*(.+?)(?:\s*[-]\s*(.+))?$/gim,n=t.split(`
`),s=null;for(let l of n){let c=l.trim(),u=c.match(/^(INT\.|EXT\.|INT\/EXT\.|I\/E\.|\.)\s*(.+?)(?:\s*[-]\s*(.+))?$/i);if(u){if(s){let m=s.lines.join(`
`).trim();m.length>0&&e.push({heading:s.heading,location:s.location,timeOfDay:s.timeOfDay,content:m,wordCount:RE(m)})}let d=u[1].toUpperCase().replace(".",""),h=u[2].trim(),f=(o=u[3])==null?void 0:o.trim();s={heading:c,location:`${d} ${h}`,timeOfDay:f,lines:[]}}else s&&s.lines.push(l)}if(s){let l=s.lines.join(`
`).trim();l.length>0&&e.push({heading:s.heading,location:s.location,timeOfDay:s.timeOfDay,content:l,wordCount:RE(l)})}return e}groupScenesIntoChapters(t){let e=[],r=new Map,n="Act 1";for(let o of t){let l=o.content.match(/^ACT\s+(ONE|TWO|THREE|FOUR|FIVE|I{1,3}V?|[1-5])/im);l&&(n=`Act ${l[1]}`),r.has(n)||r.set(n,[]),r.get(n).push(o)}if(r.size===1&&t.length>15){let o=Math.ceil(t.length/3);r.clear();for(let l=0;l<t.length;l++){let u=`Act ${Math.floor(l/o)+1}`;r.has(u)||r.set(u,[]),r.get(u).push(t[l])}}let s=1;for(let[o,l]of r){let c=l.map(d=>`${d.heading}

${d.content}`).join(`

---

`),u=l.map((d,h)=>({title:d.location,content:`${d.heading}

${d.content}`,wordCount:d.wordCount}));e.push({title:o,number:s,content:c,wordCount:l.reduce((d,h)=>d+h.wordCount,0),scenes:u.length>1?u:void 0}),s++}return e}}});function yP(a){return a.trim().split(/\s+/).filter(t=>t.length>0).length}function iCe(a){let t=a.match(/(?:chapter|ch\.?)\s*(\d+)/i);if(t)return parseInt(t[1],10);let e=a.match(/^\s*(\d+)\s*$/);if(e)return parseInt(e[1],10);let r={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12,thirteen:13,fourteen:14,fifteen:15,sixteen:16,seventeen:17,eighteen:18,nineteen:19,twenty:20},n=a.toLowerCase();for(let[s,o]of Object.entries(r))if(n.includes(s))return o}var Y4,nCe,aCe,BE,q4=_e(()=>{Y4=require("obsidian");nCe=[/^\s*\*\s*\*\s*\*\s*$/,/^\s*\*{3,}\s*$/,/^\s*-{3,}\s*$/,/^\s*~{3,}\s*$/,/^\s*#{3,}\s*$/],aCe=[/^chapter\s+\d+/i,/^chapter\s+[a-z]+/i,/^ch\.?\s+\d+/i,/^\d+\.\s+/,/^part\s+\d+/i,/^section\s+\d+/i],BE=class{constructor(){this.name="PDF Parser";this.format="pdf"}canParse(t,e){return e.toLowerCase().split(".").pop()==="pdf"}parse(t,e){return{metadata:{title:e.replace(/\.pdf$/i,""),totalWords:0,chapterCount:0,confidence:0,detectionMethod:"PDF (use parseAsync)"},chapters:[],warnings:["PDF parsing requires async method. Please use parseAsync."],format:this.format}}async parseAsync(t,e){var r,n;try{let l=await(await(0,Y4.loadPdfJs)()).getDocument({data:new Uint8Array(t)}).promise,c=[],u="",d="";try{let v=await l.getMetadata();u=((r=v==null?void 0:v.info)==null?void 0:r.Title)||e.replace(/\.pdf$/i,""),d=((n=v==null?void 0:v.info)==null?void 0:n.Author)||void 0}catch(v){console.warn("Could not extract PDF metadata:",v),u=e.replace(/\.pdf$/i,"")}for(let v=1;v<=l.numPages;v++)try{let C=await(await l.getPage(v)).getTextContent(),_=[],x="",P=-1;for(let M of C.items){let O=M;P!==-1&&Math.abs(O.transform[5]-P)>5&&(x.trim()&&_.push(x.trim()),x=""),x+=O.str,P=O.transform[5]}x.trim()&&_.push(x.trim());let I=_.join(`
`);I.trim()&&c.push(I)}catch(E){console.warn(`Error extracting text from page ${v}:`,E)}let h=c.join(`

`),f=this.detectChapters(h,e);if(f.length===0){let v=yP(h);return{metadata:{title:u,author:d,totalWords:v,chapterCount:1,confidence:50,detectionMethod:"No chapters detected"},chapters:[{title:e.replace(/\.pdf$/i,""),number:1,content:h,wordCount:v}],warnings:["No chapter structure detected. Document imported as single chapter."],format:this.format}}let m=f.reduce((v,E)=>v+E.wordCount,0),g=[],y=f.map(v=>v.number).filter(v=>v!==void 0);return y.length>1&&(y.every((E,C)=>C===0||E===y[C-1]+1)||g.push("Chapter numbering is not sequential. Please review chapter numbers.")),{metadata:{title:u,author:d,totalWords:m,chapterCount:f.length,confidence:75,detectionMethod:"Pattern-based chapter detection"},chapters:f,warnings:g,format:this.format}}catch(s){return console.error("Error parsing PDF:",s),{metadata:{title:e.replace(/\.pdf$/i,""),totalWords:0,chapterCount:0,confidence:0,detectionMethod:"PDF parse failed"},chapters:[],warnings:[`Failed to parse PDF: ${s}. The PDF may be encrypted, corrupted, or password-protected.`],format:this.format}}}detectChapters(t,e){let r=[],n=t.split(`
`),s=[];for(let o=0;o<n.length;o++){let l=n[o].trim();if(l.length===0)continue;aCe.some(u=>u.test(l))&&s.push({lineIndex:o,title:l})}if(s.length===0)return[];for(let o=0;o<s.length;o++){let l=s[o],c=s[o+1],u=l.lineIndex+1,d=c?c.lineIndex:n.length,f=n.slice(u,d).join(`
`).trim();if(f.length===0)continue;let m=this.detectScenes(f);r.push({title:l.title,number:iCe(l.title)||o+1,content:f,wordCount:yP(f),scenes:m.length>1?m:void 0})}return r}detectScenes(t){let e=t.split(`
`),r=[],n=[],s=[];for(let o of e)if(nCe.some(c=>c.test(o))){if(s.length>0){let c=s.join(`
`).trim();c.length>0&&n.push(c)}s=[]}else s.push(o);if(s.length>0){let o=s.join(`
`).trim();o.length>0&&n.push(o)}for(let o=0;o<n.length;o++)r.push({title:`Scene ${o+1}`,content:n[o],wordCount:yP(n[o])});return r}}});var Tv,$E,Z4=_e(()=>{Tv=require("obsidian");F4();R4();N4();$4();H4();G4();V4();U4();j4();q4();$E=class{constructor(t){this.plugin=t,this.parsers=[new xE,new DE,new PE,new LE,new ME,new IE,new OE,new FE,new NE,new BE]}getDocxParser(){return this.parsers.find(t=>t.format==="docx")}getEpubParser(){return this.parsers.find(t=>t.format==="epub")}getOdtParser(){return this.parsers.find(t=>t.format==="odt")}getPdfParser(){return this.parsers.find(t=>t.format==="pdf")}detectFormat(t,e){for(let r of this.parsers)if(r.canParse(t,e))return r.format;return"unknown"}parseDocument(t,e){let r=this.detectFormat(t,e);if(r==="unknown")return new Tv.Notice("Unknown file format. Please use .txt or .md files."),null;let n=this.parsers.find(s=>s.format===r);if(!n)return new Tv.Notice("No parser available for this format."),null;try{return n.parse(t,e)}catch(s){return console.error("Error parsing document:",s),new Tv.Notice(`Error parsing document: ${s}`),null}}validateImport(t){let e=[],r=[];t.createNewStory?(!t.targetStoryName||t.targetStoryName.trim().length===0)&&e.push("Story name is required when creating a new story."):t.targetStoryId||e.push("Story ID is required when adding to existing story.");let n=t.chapters.filter(u=>u.enabled);n.length===0&&e.push("At least one chapter must be enabled for import.");let s=n.map(u=>u.targetName),o=s.filter((u,d)=>s.indexOf(u)!==d);o.length>0&&r.push(`Duplicate chapter names found: ${o.join(", ")}`);let l=n.map(u=>u.targetNumber).filter(u=>u!==void 0),c=l.filter((u,d)=>l.indexOf(u)!==d);return c.length>0&&r.push(`Duplicate chapter numbers found: ${c.join(", ")}`),{isValid:e.length===0,errors:e,warnings:r}}async executeImport(t,e){let r=this.validateImport(t);if(!r.isValid)return{success:!1,error:r.errors.join(`
`),chaptersCreated:[],scenesCreated:[],stats:{totalChapters:0,totalScenes:0,totalWords:0,chaptersSkipped:0,chaptersRenamed:0},warnings:r.warnings,skippedChapters:[]};try{e==null||e({currentStep:"Preparing import...",currentItem:"",processed:0,total:t.chapters.filter(u=>u.enabled).length,percentage:0});let n;if(t.createNewStory?(e==null||e({currentStep:"Creating story...",currentItem:t.targetStoryName||"",processed:0,total:t.chapters.filter(u=>u.enabled).length,percentage:5}),n=await this.createStory(t.targetStoryName)):n=t.targetStoryId,!n)throw new Error("Failed to get or create story.");let s={characters:[],locations:[]};t.entityExtractionEnabled&&t.entityMappings.length>0&&(e==null||e({currentStep:"Creating entities...",currentItem:"",processed:0,total:t.chapters.filter(u=>u.enabled).length,percentage:8}),s=await this.createEntitiesFromMappings(t));let o=await this.importChapters(n,t,e,s),l=o.stats.totalScenes>0?`, ${o.stats.totalScenes} scenes`:"",c=s.characters.length+s.locations.length>0?`, ${s.characters.length} characters, ${s.locations.length} locations`:"";return new Tv.Notice(`Import complete: ${o.stats.totalChapters} chapters${l}${c} created`),o}catch(n){return console.error("Import error:",n),{success:!1,error:`Import failed: ${n}`,chaptersCreated:[],scenesCreated:[],stats:{totalChapters:0,totalScenes:0,totalWords:0,chaptersSkipped:0,chaptersRenamed:0},warnings:[],skippedChapters:[]}}}async createStory(t){let e=`story-${Date.now()}`;return this.plugin.settings.stories=this.plugin.settings.stories||[],this.plugin.settings.stories.push({id:e,name:t,created:new Date().toISOString()}),this.plugin.settings.activeStoryId=e,await this.plugin.saveSettings(),e}async createEntitiesFromMappings(t){let e=[],r=[];for(let n of t.entityMappings){if(n.action!=="create")continue;let s=n.newEntityName||n.extractedName;if(n.type==="character"){let o={name:s,traits:["imported"],events:[],locations:[],groups:[]};try{await this.plugin.saveCharacter(o),e.push(o)}catch(l){console.warn(`Failed to create character "${s}":`,l)}}else if(n.type==="location"){let o={name:s,groups:[]};try{await this.plugin.saveLocation(o),r.push(o)}catch(l){console.warn(`Failed to create location "${s}":`,l)}}}return{characters:e,locations:r}}buildEntityNameToIdMap(t,e){let r=new Map,n=new Map;for(let s of t.entityMappings){if(s.action==="ignore")continue;let o=s.extractedName.toLowerCase();if(s.action==="link"&&s.linkedEntityId)s.type==="character"?r.set(o,s.linkedEntityId):n.set(o,s.linkedEntityId);else if(s.action==="create"){let l=(s.newEntityName||s.extractedName).toLowerCase();if(s.type==="character"){let c=e.characters.find(u=>u.name.toLowerCase()===l);c!=null&&c.id&&r.set(o,c.id)}else{let c=e.locations.find(u=>u.name.toLowerCase()===l);c!=null&&c.id&&n.set(o,c.id)}}}return{characterMap:r,locationMap:n}}findEntityMentions(t,e,r){let n=new Set,s=new Set,o=t.toLowerCase();for(let[l,c]of e)o.includes(l)&&n.add(c);for(let[l,c]of r)o.includes(l)&&s.add(c);return{characterIds:Array.from(n),locationIds:Array.from(s)}}async importChapters(t,e,r,n){let s=[],o=[],l=[...e.parsedDocument.warnings],c=[],u=0,d=0,h=0,m=e.chapters.filter(C=>C.enabled).length,g=0,y=this.plugin.settings.activeStoryId;this.plugin.settings.activeStoryId=t,await this.plugin.saveSettings();let{characterMap:v,locationMap:E}=this.buildEntityNameToIdMap(e,n||{characters:[],locations:[]});try{let C=await this.plugin.listChapters(),_=new Set(C.map(I=>I.name)),x=await this.plugin.listScenes(),P=new Set(x.map(I=>I.name));for(let I of e.chapters){if(!I.enabled)continue;r==null||r({currentStep:"Creating chapter...",currentItem:I.targetName,processed:g,total:m,percentage:Math.round(10+g/m*85)});let M=I.targetName;if(_.has(M)){if(e.conflictResolution==="skip"){c.push(M),d++;continue}else if(e.conflictResolution==="rename"){let k=2,N=`${M} (${k})`;for(;_.has(N);)k++,N=`${M} (${k})`;M=N,h++}else if(e.conflictResolution==="overwrite"){let k=C.find(N=>N.name===M);if(k&&k.filePath){let N=this.plugin.app.vault.getAbstractFileByPath(k.filePath);N&&await this.plugin.app.vault.delete(N)}}}let{characterIds:O,locationIds:R}=e.entityExtractionEnabled?this.findEntityMentions(I.content,v,E):{characterIds:[],locationIds:[]},F=I.tags.length>0?[...I.tags]:[];if(e.draftStrategy==="version-tags"&&e.draftVersion){let k=e.draftVersion.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");k&&!F.includes(k)&&F.push(k)}let $={name:M,number:I.targetNumber,tags:F.length>0?F:void 0,summary:e.contentPlacement==="chapter-summary"?I.content:void 0,linkedCharacters:O,linkedLocations:R,linkedEvents:[],linkedItems:[],linkedGroups:[]};e.draftStrategy==="custom-metadata"&&e.draftVersion&&($.draftVersion=e.draftVersion);try{if(await this.plugin.saveChapter($),s.push($),u+=I.content.split(/\s+/).length,_.add(M),e.contentPlacement==="scene-files"){let k=e.parsedDocument.chapters.find(G=>G.title===I.sourceTitle),N=k==null?void 0:k.scenes;if(N&&N.length>1)for(let G=0;G<N.length;G++){let W=N[G];r==null||r({currentStep:"Creating scene...",currentItem:`${M} - ${W.title||`Scene ${G+1}`}`,processed:g,total:m,percentage:Math.round(10+g/m*85)});let Y=`${M} - ${W.title||`Scene ${G+1}`}`,U=Y;if(P.has(U)){let j=2;for(;P.has(`${Y} (${j})`);)j++;U=`${Y} (${j})`}let Z=e.entityExtractionEnabled?this.findEntityMentions(W.content,v,E):{characterIds:[],locationIds:[]},q="Draft";if(e.draftStrategy==="scene-status"&&e.draftVersion){let j=e.draftVersion.toLowerCase();j.includes("final")||j.includes("complete")?q="Final":j.includes("revis")||j.includes("edit")?q="Revised":j.includes("wip")||j.includes("progress")?q="WIP":j.includes("outline")&&(q="Outline")}let X=I.tags.length>0?[...I.tags]:[];if(e.draftStrategy==="version-tags"&&e.draftVersion){let j=e.draftVersion.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");j&&!X.includes(j)&&X.push(j)}let ie={name:U,chapterId:$.id,chapterName:M,status:q,priority:G+1,content:W.content,tags:X.length>0?X:void 0,linkedCharacters:Z.characterIds,linkedLocations:Z.locationIds,linkedEvents:[],linkedItems:[],linkedGroups:[]};e.draftStrategy==="custom-metadata"&&e.draftVersion&&(ie.draftVersion=e.draftVersion);try{await this.plugin.saveScene(ie),o.push(ie),P.add(U)}catch(j){l.push(`Failed to create scene "${U}": ${j}`)}}else{r==null||r({currentStep:"Creating scene...",currentItem:`${M} - Content`,processed:g,total:m,percentage:Math.round(10+g/m*85)});let G=`${M} - Content`,W=G;if(P.has(W)){let q=2;for(;P.has(`${G} (${q})`);)q++;W=`${G} (${q})`}let Y="Draft";if(e.draftStrategy==="scene-status"&&e.draftVersion){let q=e.draftVersion.toLowerCase();q.includes("final")||q.includes("complete")?Y="Final":q.includes("revis")||q.includes("edit")?Y="Revised":q.includes("wip")||q.includes("progress")?Y="WIP":q.includes("outline")&&(Y="Outline")}let U=I.tags.length>0?[...I.tags]:[];if(e.draftStrategy==="version-tags"&&e.draftVersion){let q=e.draftVersion.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");q&&!U.includes(q)&&U.push(q)}let Z={name:W,chapterId:$.id,chapterName:M,status:Y,content:I.content,tags:U.length>0?U:void 0,linkedCharacters:O,linkedLocations:R,linkedEvents:[],linkedItems:[],linkedGroups:[]};e.draftStrategy==="custom-metadata"&&e.draftVersion&&(Z.draftVersion=e.draftVersion);try{await this.plugin.saveScene(Z),o.push(Z),P.add(W)}catch(q){l.push(`Failed to create scene for chapter "${M}": ${q}`)}}}g++}catch(k){l.push(`Failed to create chapter "${M}": ${k}`),c.push(M),d++,g++}}return r==null||r({currentStep:"Import complete!",currentItem:"",processed:m,total:m,percentage:100}),{success:!0,storyId:t,chaptersCreated:s,scenesCreated:o,stats:{totalChapters:s.length,totalScenes:o.length,totalWords:u,chaptersSkipped:d,chaptersRenamed:h},warnings:l,skippedChapters:c}}finally{y&&(this.plugin.settings.activeStoryId=y,await this.plugin.saveSettings())}}createDefaultConfiguration(t,e,r){let n=t.chapters.map((s,o)=>{var l;return{sourceTitle:s.title,targetName:s.title,targetNumber:(l=s.number)!=null?l:o+1,content:s.content,tags:[],enabled:!0}});return{sourceFileName:e,format:t.format,parsedDocument:t,targetStoryName:r||e.replace(/\.(txt|md|docx|json|csv|epub|html|htm|rtf|odt|fountain|pdf)$/i,""),createNewStory:!0,chapters:n,draftStrategy:"separate-stories",conflictResolution:"rename",preserveFormatting:!0,contentPlacement:"chapter-summary",entityExtractionEnabled:!1,entityMappings:[],configuredAt:new Date().toISOString()}}}});var K4,sCe,oCe,zE,X4=_e(()=>{K4=new Set(["the","a","an","i","me","my","you","your","he","she","it","we","they","his","her","its","our","their","this","that","these","those","chapter","part","book","story","scene","act","section","prologue","epilogue","monday","tuesday","wednesday","thursday","friday","saturday","sunday","january","february","march","april","may","june","july","august","september","october","november","december","morning","afternoon","evening","night","day","week","month","year","mr","mrs","ms","miss","dr","sir","lord","lady","king","queen","prince","princess","then","now","there","here","when","where","what","who","why","how","after","before","during","while","until","since","although","because","however","therefore","meanwhile","suddenly","finally","perhaps","maybe","yes","no","okay","ok","well","just","only","also","still","even","but","and","or","not","if","so","as","at","by","for","in","of","on","to","with","city","town","village","kingdom","empire","country","land","world","castle","palace","tower","house","home","room","hall","chamber","forest","mountain","river","lake","sea","ocean","island","valley","road","street","path","bridge","gate","door","window","chapter","section","part","book","volume","episode"]),sCe=["in","at","to","from","near","by","through","into","onto","toward","towards"],oCe=["said","asked","replied","answered","whispered","shouted","yelled","screamed","muttered","murmured","declared","exclaimed","demanded","inquired","responded","called","cried","laughed","sighed","groaned","agreed","argued","added","continued","began","finished","interrupted","suggested","warned","promised","admitted","confessed","explained","announced","stated","remarked","noted","observed","commented"],zE=class{extractEntities(t){let e=this.extractCharacterNames(t),r=this.extractLocationNames(t),n=new Set(e.map(o=>o.name.toLowerCase())),s=r.filter(o=>!n.has(o.name.toLowerCase()));return{characters:e,locations:s}}extractCharacterNames(t){let e=new Map,r=oCe.map(c=>[new RegExp(`${c}\\s+([A-Z][a-z]+)(?:[,.]|\\s|$)`,"g"),new RegExp(`([A-Z][a-z]+)\\s+${c}`,"g")]).flat();for(let c of r){let u;for(;(u=c.exec(t))!==null;){let d=u[1];this.isValidCharacterName(d)&&this.addCandidate(e,d,this.getContext(t,u.index),3)}}let n=/\b([A-Z][a-z]+)'s\b/g,s;for(;(s=n.exec(t))!==null;){let c=s[1];this.isValidCharacterName(c)&&this.addCandidate(e,c,this.getContext(t,s.index),2)}let o=/\b([A-Z][a-z]+)\b/g,l=new Map;for(;(s=o.exec(t))!==null;){let c=s[1];this.isValidCharacterName(c)&&l.set(c,(l.get(c)||0)+1)}for(let[c,u]of l)if(u>=3){let d=t.indexOf(c);this.addCandidate(e,c,this.getContext(t,d),1)}return this.buildExtractedEntities(e,"character")}extractLocationNames(t){let e=new Map;for(let o of sCe){let l=new RegExp(`${o}\\s+(?:the\\s+)?([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)`,"gi"),c;for(;(c=l.exec(t))!==null;){let u=c[1];this.isValidLocationName(u)&&this.addCandidate(e,u,this.getContext(t,c.index),2)}}let r=/\b([A-Z][a-z]+\s+[A-Z][a-z]+(?:\s+[A-Z][a-z]+)?)\b/g,n;for(;(n=r.exec(t))!==null;){let o=n[1];this.looksLikeLocation(o)&&this.addCandidate(e,o,this.getContext(t,n.index),1)}let s=/^(?:INT|EXT|INTERIOR|EXTERIOR)[\.\s]+([A-Z][^\n-]+)/gim;for(;(n=s.exec(t))!==null;){let o=n[1].trim();o.length>2&&o.length<50&&this.addCandidate(e,o,this.getContext(t,n.index),3)}return this.buildExtractedEntities(e,"location")}matchExistingEntities(t,e,r){let n=[];for(let s of t){let o=s.type==="character"?this.findMatchingCharacter(s.name,e):this.findMatchingLocation(s.name,r);n.push({extractedName:s.name,existingEntity:o==null?void 0:o.entity,matchConfidence:(o==null?void 0:o.confidence)||"low",type:s.type})}return n}findMatchingCharacter(t,e){let r=t.toLowerCase();for(let n of e){let s=(n.name||"").toLowerCase();if(s===r)return{entity:n,confidence:"high"};if(s.split(" ")[0]===r)return{entity:n,confidence:"medium"};if(n.traits&&n.traits.some(c=>c.toLowerCase().includes(r)))return{entity:n,confidence:"medium"}}return null}findMatchingLocation(t,e){let r=t.toLowerCase();for(let n of e){let s=(n.name||"").toLowerCase();if(s===r)return{entity:n,confidence:"high"};if(s.includes(r)||r.includes(s))return{entity:n,confidence:"medium"}}return null}isValidCharacterName(t){return!(!t||t.length<2||t.length>30||K4.has(t.toLowerCase())||!/^[A-Z]/.test(t)||t===t.toUpperCase())}isValidLocationName(t){return!t||t.length<2||t.length>50?!1:t.toLowerCase().split(/\s+/).some(r=>!K4.has(r))}looksLikeLocation(t){let e=["castle","palace","tower","fortress","citadel","forest","woods","mountain","peak","valley","river","lake","sea","ocean","city","town","village","kingdom","empire","realm","inn","tavern","shop","market","square","plaza","temple","church","cathedral","shrine","monastery","cave","cavern","dungeon","crypt","tomb","bridge","road","path","street","gate","wall","garden","park","field","farm","mill","harbor","port","dock","bay","cove","island","isle","peninsula","coast","shore","mansion","manor","estate","hall","house"],r=t.toLowerCase();return e.some(n=>r.includes(n))}addCandidate(t,e,r,n){let s=t.get(e);s?(s.count+=n,s.contexts.length<3&&!s.contexts.includes(r)&&s.contexts.push(r)):t.set(e,{count:n,contexts:[r]})}getContext(t,e){let r=Math.max(0,e-30),n=Math.min(t.length,e+50),s=t.slice(r,n).replace(/\n/g," ").trim();return r>0&&(s="..."+s),n<t.length&&(s=s+"..."),s}buildExtractedEntities(t,e){let r=[];for(let[n,s]of t){let o;s.count>=5?o="high":s.count>=3?o="medium":o="low",r.push({name:n,type:e,occurrences:s.count,confidence:o,contexts:s.contexts})}return r.sort((n,s)=>s.occurrences-n.occurrences),r}}});var J4={};At(J4,{ImportConfigModal:()=>bP});var _r,bP,Q4=_e(()=>{_r=require("obsidian");Z4();X4();bP=class extends _r.Modal{constructor(e,r){super(e);this.currentStep="upload";this.parsedDocument=null;this.configuration=null;this.fileName="";this.extractedCharacters=[];this.extractedLocations=[];this.plugin=r,this.importManager=new $E(r),this.entityExtractor=new zE,this.modalEl.addClass("storyteller-import-modal")}onOpen(){this.renderStep()}onClose(){this.contentEl.empty()}renderStep(){switch(this.contentEl.empty(),this.currentStep){case"upload":this.renderUploadStep();break;case"review":this.renderReviewStep();break;case"entities":this.renderEntitiesStep();break;case"configure":this.renderConfigureStep();break;case"confirm":this.renderConfirmStep();break}}renderUploadStep(){this.titleEl.setText("Import Story - Upload File"),this.contentEl.createEl("p",{text:"Upload a file containing your story chapters."}).addClass("storyteller-import-description");let r=this.contentEl.createDiv("storyteller-file-input-container"),n=r.createEl("input",{type:"file",attr:{accept:".txt,.md,.markdown,.docx,.json,.epub,.html,.htm,.rtf,.odt,.fountain,.spmd,.pdf"}});n.addClass("storyteller-file-input"),n.style.display="none";let s=r.createEl("button",{text:"Choose File"});s.addClass("mod-cta");let o=r.createEl("div",{text:"No file selected"});o.addClass("storyteller-file-name"),s.addEventListener("click",()=>{n.click()}),n.addEventListener("change",async d=>{var m;let f=(m=d.target.files)==null?void 0:m[0];if(f){this.fileName=f.name,o.setText(`Selected: ${this.fileName}`),new _r.Notice("Parsing document...");try{let g=this.fileName.toLowerCase();if(g.endsWith(".docx")){let y=await f.arrayBuffer(),v=this.importManager.getDocxParser();if(v)this.parsedDocument=await v.parseAsync(y,this.fileName);else{new _r.Notice("DOCX parser not available.");return}}else if(g.endsWith(".epub")){let y=await f.arrayBuffer(),v=this.importManager.getEpubParser();if(v)this.parsedDocument=await v.parseAsync(y,this.fileName);else{new _r.Notice("EPUB parser not available.");return}}else if(g.endsWith(".odt")){let y=await f.arrayBuffer(),v=this.importManager.getOdtParser();if(v)this.parsedDocument=await v.parseAsync(y,this.fileName);else{new _r.Notice("ODT parser not available.");return}}else if(g.endsWith(".pdf")){let y=await f.arrayBuffer(),v=this.importManager.getPdfParser();if(v)this.parsedDocument=await v.parseAsync(y,this.fileName);else{new _r.Notice("PDF parser not available.");return}}else{let y=await f.text();this.parsedDocument=this.importManager.parseDocument(y,this.fileName)}this.parsedDocument&&(new _r.Notice(`Found ${this.parsedDocument.chapters.length} chapters`),this.currentStep="review",this.renderStep())}catch(g){console.error("Error parsing file:",g),new _r.Notice(`Error parsing file: ${g}`)}}});let l=this.contentEl.createEl("div");l.addClass("storyteller-import-instructions"),l.createEl("h3",{text:"Supported Formats:"});let c=l.createEl("ul");c.createEl("li",{text:'Plain text (.txt) with chapter markers like "Chapter 1"'}),c.createEl("li",{text:"Markdown (.md) with heading hierarchy (# Chapter 1)"}),c.createEl("li",{text:"Word documents (.docx) with heading styles"}),c.createEl("li",{text:"EPUB e-books (.epub) - standard e-book format"}),c.createEl("li",{text:"PDF documents (.pdf) with chapter markers"}),c.createEl("li",{text:"HTML files (.html, .htm) with heading structure"}),c.createEl("li",{text:"Rich Text Format (.rtf) with chapter markers"}),c.createEl("li",{text:"OpenDocument Text (.odt) - LibreOffice/OpenOffice"}),c.createEl("li",{text:"Fountain screenplays (.fountain) with act/scene structure"}),c.createEl("li",{text:"JSON (.json) with structured chapter data"});let u=this.contentEl.createDiv("storyteller-modal-buttons");new _r.Setting(u).addButton(d=>d.setButtonText("Cancel").onClick(()=>this.close()))}renderReviewStep(){var g;if(!this.parsedDocument)return;this.configuration||(this.configuration=this.importManager.createDefaultConfiguration(this.parsedDocument,this.fileName)),this.titleEl.setText("Import Story - Review Chapters");let e=this.contentEl.createDiv("storyteller-import-metadata");if(e.createEl("p",{text:`Detected ${this.parsedDocument.chapters.length} chapters using "${this.parsedDocument.metadata.detectionMethod}"`}),e.createEl("p",{text:`Total words: ${this.parsedDocument.metadata.totalWords.toLocaleString()}`}),e.createEl("p",{text:`Confidence: ${this.parsedDocument.metadata.confidence}%`}),this.parsedDocument.warnings.length>0){let y=this.contentEl.createDiv("storyteller-import-warnings");y.createEl("h3",{text:"Warnings:"});let v=y.createEl("ul");for(let E of this.parsedDocument.warnings)v.createEl("li",{text:E})}let r=this.contentEl.createDiv("storyteller-import-chapters"),n=r.createDiv("storyteller-chapters-header");n.style.display="flex",n.style.justifyContent="space-between",n.style.alignItems="center",n.style.marginBottom="8px",n.createEl("h3",{text:"Chapters:"});let s=n.createDiv("storyteller-selection-controls");s.style.display="flex",s.style.gap="8px",s.style.alignItems="center";let o=this.configuration.chapters.filter(y=>y.enabled).length,l=s.createSpan("storyteller-selection-summary");l.setText(`${o}/${this.configuration.chapters.length} selected`),l.style.fontSize="0.9em",l.style.color="var(--text-muted)";let c=s.createEl("button",{text:"Select All"});c.style.fontSize="0.85em",c.style.padding="2px 8px";let u=s.createEl("button",{text:"Select None"});u.style.fontSize="0.85em",u.style.padding="2px 8px";let d=r.createDiv("storyteller-chapter-list");d.style.maxHeight="300px",d.style.overflowY="auto",d.style.border="1px solid var(--background-modifier-border)",d.style.padding="10px",d.style.marginBottom="10px";let h=[],f=()=>{let y=this.configuration.chapters.filter(v=>v.enabled).length;l.setText(`${y}/${this.configuration.chapters.length} selected`)};for(let y=0;y<this.configuration.chapters.length;y++){let v=this.configuration.chapters[y],E=this.parsedDocument.chapters[y],C=d.createDiv("storyteller-chapter-item");C.style.marginBottom="10px",C.style.padding="8px",C.style.border="1px solid var(--background-modifier-border)",C.style.borderRadius="4px",C.style.display="flex",C.style.alignItems="flex-start",C.style.gap="10px";let _=C.createEl("input",{type:"checkbox"});_.checked=v.enabled,_.style.marginTop="4px",_.addEventListener("change",()=>{v.enabled=_.checked,f()}),h.push(_);let x=C.createDiv("storyteller-chapter-info");x.style.flex="1";let P=x.createDiv("storyteller-chapter-editable");P.style.display="flex",P.style.gap="8px",P.style.alignItems="center",P.style.marginBottom="4px";let I=P.createSpan();I.setText("Ch."),I.style.fontSize="0.9em",I.style.color="var(--text-muted)";let M=P.createEl("input",{type:"number"});M.value=String((g=v.targetNumber)!=null?g:""),M.style.width="50px",M.style.padding="2px 4px",M.style.fontSize="0.9em",M.placeholder="#",M.addEventListener("change",()=>{let $=parseInt(M.value,10);v.targetNumber=isNaN($)?void 0:$});let O=P.createEl("input",{type:"text"});O.value=v.targetName,O.style.flex="1",O.style.padding="2px 6px",O.style.fontSize="0.9em",O.placeholder="Chapter name",O.addEventListener("change",()=>{v.targetName=O.value.trim()||v.sourceTitle});let R=x.createDiv();R.style.fontSize="0.85em",R.style.color="var(--text-muted)";let F=E.title!==v.targetName?` (original: "${E.title}")`:"";R.setText(`${E.wordCount.toLocaleString()} words${F}`)}c.addEventListener("click",()=>{h.forEach((y,v)=>{y.checked=!0,this.configuration.chapters[v].enabled=!0}),f()}),u.addEventListener("click",()=>{h.forEach((y,v)=>{y.checked=!1,this.configuration.chapters[v].enabled=!1}),f()});let m=this.contentEl.createDiv("storyteller-modal-buttons");new _r.Setting(m).addButton(y=>y.setButtonText("Back").onClick(()=>{this.currentStep="upload",this.renderStep()})).addButton(y=>y.setButtonText("Next").setCta().onClick(()=>{if(this.configuration.chapters.filter(x=>x.enabled).length===0){new _r.Notice("Please select at least one chapter to import.");return}new _r.Notice("Analyzing text for characters and locations...");let E=this.configuration.chapters.filter(x=>x.enabled).map(x=>x.content).join(`

`),{characters:C,locations:_}=this.entityExtractor.extractEntities(E);this.extractedCharacters=C,this.extractedLocations=_,this.configuration.entityMappings.length===0&&(this.configuration.entityMappings=[...C.map(x=>({extractedName:x.name,type:"character",action:"ignore",occurrences:x.occurrences,confidence:x.confidence})),..._.map(x=>({extractedName:x.name,type:"location",action:"ignore",occurrences:x.occurrences,confidence:x.confidence}))]),this.currentStep="entities",this.renderStep()}))}async renderEntitiesStep(){if(!this.configuration)return;if(this.titleEl.setText("Import Story - Entity Mapping"),this.extractedCharacters.length+this.extractedLocations.length===0){let n=this.contentEl.createDiv("storyteller-no-entities");n.style.padding="20px",n.style.textAlign="center",n.createEl("p",{text:"No character or location names were detected in your text."}),n.createEl("p",{text:"You can continue without entity linking, or go back and check your chapters.",cls:"setting-item-description"})}else{let n=this.contentEl.createEl("p",{text:`Found ${this.extractedCharacters.length} potential characters and ${this.extractedLocations.length} potential locations. Choose how to handle each entity during import.`});n.style.marginBottom="16px";let s=await this.plugin.listCharacters(),o=await this.plugin.listLocations();this.extractedCharacters.length>0&&this.renderEntitySection("Characters","character",this.extractedCharacters,s.map(l=>({id:l.id||"",name:l.name}))),this.extractedLocations.length>0&&this.renderEntitySection("Locations","location",this.extractedLocations,o.map(l=>({id:l.id||"",name:l.name})))}let r=this.contentEl.createDiv("storyteller-modal-buttons");new _r.Setting(r).addButton(n=>n.setButtonText("Back").onClick(()=>{this.currentStep="review",this.renderStep()})).addButton(n=>n.setButtonText("Skip Entity Linking").onClick(()=>{for(let s of this.configuration.entityMappings)s.action="ignore";this.configuration.entityExtractionEnabled=!1,this.currentStep="configure",this.renderStep()})).addButton(n=>n.setButtonText("Next").setCta().onClick(()=>{let s=this.configuration.entityMappings.some(o=>o.action==="create"||o.action==="link");this.configuration.entityExtractionEnabled=s,this.currentStep="configure",this.renderStep()}))}renderEntitySection(e,r,n,s){let o=this.contentEl.createDiv("storyteller-entity-section");o.style.marginBottom="20px";let l=o.createEl("h3",{text:e});l.style.marginBottom="10px";let c=o.createDiv("storyteller-entity-list");c.style.maxHeight="200px",c.style.overflowY="auto",c.style.border="1px solid var(--background-modifier-border)",c.style.borderRadius="4px",c.style.padding="8px";for(let u of n){let d=this.configuration.entityMappings.find(O=>O.extractedName===u.name&&O.type===r);if(!d)continue;let h=c.createDiv("storyteller-entity-item");h.style.padding="8px",h.style.marginBottom="8px",h.style.border="1px solid var(--background-modifier-border)",h.style.borderRadius="4px",h.style.backgroundColor="var(--background-secondary)";let f=h.createDiv();f.style.display="flex",f.style.justifyContent="space-between",f.style.alignItems="center",f.style.marginBottom="8px";let m=f.createEl("strong",{text:u.name}),g=f.createSpan();g.style.fontSize="0.85em",g.style.color="var(--text-muted)";let y=u.confidence==="high"?"High":u.confidence==="medium"?"Med":"Low";g.setText(`${u.occurrences}x | ${y} confidence`);let v=h.createDiv();v.style.display="flex",v.style.gap="8px",v.style.alignItems="center",v.style.flexWrap="wrap";let E=v.createSpan({text:"Action:"});E.style.fontSize="0.9em";let C=v.createEl("select");C.style.padding="2px 6px",C.style.fontSize="0.9em";let _=C.createEl("option",{value:"ignore",text:"Ignore"}),x=C.createEl("option",{value:"create",text:"Create new"});if(s.length>0){let O=C.createEl("option",{value:"link",text:"Link to existing"})}C.value=d.action;let P=v.createDiv();P.style.display=d.action==="link"?"flex":"none",P.style.gap="4px",P.style.alignItems="center";let I=P.createSpan({text:"to:"});I.style.fontSize="0.9em";let M=P.createEl("select");M.style.padding="2px 6px",M.style.fontSize="0.9em",M.style.maxWidth="150px";for(let O of s){let R=M.createEl("option",{value:O.id,text:O.name})}if(d.linkedEntityId?M.value=d.linkedEntityId:s.length>0&&(d.linkedEntityId=s[0].id),C.addEventListener("change",()=>{d.action=C.value,P.style.display=d.action==="link"?"flex":"none",d.action==="link"&&s.length>0&&!d.linkedEntityId&&(d.linkedEntityId=s[0].id)}),M.addEventListener("change",()=>{d.linkedEntityId=M.value}),u.contexts.length>0){let O=h.createEl("button",{text:"Show context"});O.style.fontSize="0.8em",O.style.padding="2px 6px",O.style.marginTop="8px";let R=h.createDiv();R.style.display="none",R.style.marginTop="8px",R.style.padding="8px",R.style.backgroundColor="var(--background-primary)",R.style.borderRadius="4px",R.style.fontSize="0.85em",R.style.fontStyle="italic",R.style.color="var(--text-muted)";for(let F of u.contexts.slice(0,2))R.createEl("p",{text:F});O.addEventListener("click",()=>{let F=R.style.display==="none";R.style.display=F?"block":"none",O.setText(F?"Hide context":"Show context")})}}}renderConfigureStep(){if(!this.configuration)return;this.titleEl.setText("Import Story - Configure Options");let e=this.contentEl.createDiv("storyteller-story-target-container"),r=this.plugin.settings.stories||[],n=r.length>0,s=null,o=null,l=()=>{e.empty(),new _r.Setting(e).setName("Import Target").setDesc("Choose where to import the chapters").addDropdown(u=>{u.addOption("new","Create new story").setValue(this.configuration.createNewStory?"new":"existing"),n&&u.addOption("existing","Add to existing story"),u.onChange(d=>{this.configuration.createNewStory=d==="new",d==="new"?this.configuration.targetStoryId=void 0:!this.configuration.targetStoryId&&r.length>0&&(this.configuration.targetStoryId=r[0].id),l()})}),this.configuration.createNewStory?s=new _r.Setting(e).setName("Story Name").setDesc("Name for the new story").addText(u=>u.setValue(this.configuration.targetStoryName||"").onChange(d=>{this.configuration.targetStoryName=d})):o=new _r.Setting(e).setName("Select Story").setDesc("Choose an existing story to add chapters to").addDropdown(u=>{var d;for(let h of r)u.addOption(h.id,h.name);u.setValue(this.configuration.targetStoryId||((d=r[0])==null?void 0:d.id)||""),u.onChange(h=>{this.configuration.targetStoryId=h})})};l(),new _r.Setting(this.contentEl).setName("Draft Version").setDesc('Optional version label (e.g., "Rough Draft", "Revised")').addText(u=>u.setPlaceholder("e.g., Rough Draft").setValue(this.configuration.draftVersion||"").onChange(d=>{if(this.configuration.draftVersion=d,d.trim()&&this.configuration.createNewStory){let h=this.fileName.replace(/\.(txt|md|docx|json|csv)$/i,"");this.configuration.targetStoryName=`${h} - ${d}`}})),new _r.Setting(this.contentEl).setName("Draft Strategy").setDesc("How to organize multiple drafts of the same story").addDropdown(u=>u.addOption("separate-stories","Separate stories (create new story per draft)").addOption("version-tags","Version tags (tag chapters with draft version)").addOption("scene-status","Scene status (use status field for version)").addOption("custom-metadata","Custom metadata (add draftVersion field)").setValue(this.configuration.draftStrategy).onChange(d=>{this.configuration.draftStrategy=d})),new _r.Setting(this.contentEl).setName("Content Placement").setDesc("Where to store the imported chapter content").addDropdown(u=>u.addOption("chapter-summary","Chapter summary (content in chapter file)").addOption("scene-files","Scene files (create scene for each chapter)").setValue(this.configuration.contentPlacement||"chapter-summary").onChange(d=>{this.configuration.contentPlacement=d})),new _r.Setting(this.contentEl).setName("Conflict Resolution").setDesc("How to handle chapters with duplicate names").addDropdown(u=>u.addOption("rename","Rename (add number suffix)").addOption("skip","Skip conflicting chapters").addOption("overwrite","Overwrite existing chapters").setValue(this.configuration.conflictResolution).onChange(d=>{this.configuration.conflictResolution=d})),new _r.Setting(this.contentEl).setName("Tags").setDesc("Tags to apply to all imported chapters (comma-separated)").addText(u=>u.setPlaceholder("e.g., imported, draft").onChange(d=>{let h=d.split(",").map(f=>f.trim()).filter(Boolean);for(let f of this.configuration.chapters)f.tags=h}));let c=this.contentEl.createDiv("storyteller-modal-buttons");new _r.Setting(c).addButton(u=>u.setButtonText("Back").onClick(()=>{this.currentStep="entities",this.renderStep()})).addButton(u=>u.setButtonText("Next").setCta().onClick(()=>{this.currentStep="confirm",this.renderStep()}))}renderConfirmStep(){var y;if(!this.configuration)return;this.titleEl.setText("Import Story - Confirm");let e=this.contentEl.createDiv("storyteller-import-summary");e.createEl("h3",{text:"Import Summary:"});let r=e.createEl("ul");if(this.configuration.createNewStory)r.createEl("li",{text:`Story: ${this.configuration.targetStoryName} (new)`});else{let v=(y=this.plugin.settings.stories)==null?void 0:y.find(E=>E.id===this.configuration.targetStoryId);r.createEl("li",{text:`Story: ${(v==null?void 0:v.name)||"Unknown"} (existing)`})}this.configuration.draftVersion&&r.createEl("li",{text:`Draft: ${this.configuration.draftVersion}`});let n=this.configuration.chapters.filter(v=>v.enabled);r.createEl("li",{text:`Chapters: ${n.length} of ${this.configuration.chapters.length}`});let s=n.reduce((v,E)=>v+E.content.split(/\s+/).length,0);r.createEl("li",{text:`Total Words: ${s.toLocaleString()}`});let o=this.configuration.contentPlacement==="scene-files"?"Scene files (will create scenes)":"Chapter summaries";r.createEl("li",{text:`Content: ${o}`}),r.createEl("li",{text:`Conflict Resolution: ${this.configuration.conflictResolution}`});let l=this.importManager.validateImport(this.configuration);if(!l.isValid){let v=this.contentEl.createDiv("storyteller-import-errors");v.style.color="var(--text-error)",v.createEl("h3",{text:"\u274C Errors:"});let E=v.createEl("ul");for(let C of l.errors)E.createEl("li",{text:C})}if(l.warnings.length>0){let v=this.contentEl.createDiv("storyteller-import-warnings");v.createEl("h3",{text:"\u26A0\uFE0F Warnings:"});let E=v.createEl("ul");for(let C of l.warnings)E.createEl("li",{text:C})}let c=this.contentEl.createDiv("storyteller-import-progress");c.style.display="none",c.style.marginTop="16px",c.style.marginBottom="16px";let u=c.createDiv("storyteller-progress-label");u.style.marginBottom="8px",u.style.fontSize="0.9em";let d=c.createDiv("storyteller-progress-bar-outer");d.style.height="8px",d.style.backgroundColor="var(--background-modifier-border)",d.style.borderRadius="4px",d.style.overflow="hidden";let h=d.createDiv("storyteller-progress-bar-inner");h.style.height="100%",h.style.width="0%",h.style.backgroundColor="var(--interactive-accent)",h.style.transition="width 0.2s ease";let f=c.createDiv("storyteller-progress-detail");f.style.marginTop="4px",f.style.fontSize="0.85em",f.style.color="var(--text-muted)";let m=this.contentEl.createDiv("storyteller-modal-buttons"),g;new _r.Setting(m).addButton(v=>(g=v.setButtonText("Back").onClick(()=>{this.currentStep="configure",this.renderStep()}),v)).addButton(v=>{let E=v.setButtonText("Import").setCta().onClick(async()=>{E.setDisabled(!0),g.setDisabled(!0),E.setButtonText("Importing..."),c.style.display="block";let C=await this.importManager.executeImport(this.configuration,_=>{u.setText(_.currentStep),h.style.width=`${_.percentage}%`,_.currentItem?f.setText(`${_.currentItem} (${_.processed}/${_.total})`):f.setText(`${_.processed}/${_.total}`)});if(C.success){let _=C.stats.totalScenes>0?` and ${C.stats.totalScenes} scenes`:"";new _r.Notice(`Successfully imported ${C.stats.totalChapters} chapters${_}!`),this.close()}else new _r.Notice(`Import failed: ${C.error}`),c.style.display="none",E.setDisabled(!1),g.setDisabled(!1),E.setButtonText("Import")});return l.isValid||E.setDisabled(!0),E})}}});var eW={};At(eW,{TimelineForkModal:()=>wP});var kn,wP,tW=_e(()=>{kn=require("obsidian");iu();wP=class extends kn.Modal{constructor(t,e,r,n,s){super(t),this.plugin=e,this.onSubmit=n,this.onDelete=s,this.isNew=r===null,this.fork=r||{id:Date.now().toString(),name:"",parentTimelineId:void 0,divergenceEvent:"",divergenceDate:"",description:"",status:"exploring",forkEvents:[],alteredCharacters:[],alteredLocations:[],color:this.plugin.generateRandomColor(),created:new Date().toISOString(),notes:""},this.modalEl.addClass("storyteller-timeline-fork-modal")}async onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?"Create Timeline Fork":`Edit Timeline Fork: ${this.fork.name}`}),new kn.Setting(t).setName("Fork Name").setDesc("Descriptive name for this alternate timeline").addText(s=>s.setPlaceholder('e.g., "What if the hero died?"').setValue(this.fork.name).onChange(o=>this.fork.name=o));let e=new kn.Setting(t).setName("Divergence Event").setDesc("The event where this timeline branches from the main timeline");e.addText(s=>s.setPlaceholder("Select or enter event name...").setValue(this.fork.divergenceEvent).onChange(o=>this.fork.divergenceEvent=o)),e.addButton(s=>s.setButtonText("Select Event").onClick(async()=>{new Rn(this.app,this.plugin,o=>{this.fork.divergenceEvent=o.name;let l=e.components.find(c=>c instanceof kn.TextAreaComponent||"inputEl"in c);l&&l.setValue&&l.setValue(o.name)}).open()})),new kn.Setting(t).setName("Divergence Date").setDesc("When this timeline diverges (YYYY-MM-DD format)").addText(s=>s.setPlaceholder("e.g., 1985-02-15").setValue(this.fork.divergenceDate).onChange(o=>this.fork.divergenceDate=o)),new kn.Setting(t).setName("Status").setDesc("Current status of this timeline fork").addDropdown(s=>s.addOptions({exploring:"Exploring",canon:"Canon (This is the main timeline)",abandoned:"Abandoned",merged:"Merged back to main timeline"}).setValue(this.fork.status||"exploring").onChange(o=>this.fork.status=o));let r=new kn.Setting(t).setName("Timeline Color").setDesc("Color for visualizing this fork in the timeline view");if(r.addText(s=>{s.setValue(this.fork.color||"#FF6B6B").onChange(o=>this.fork.color=o),s.inputEl.setAttribute("type","color"),s.inputEl.style.width="100px",s.inputEl.style.height="40px"}),r.addButton(s=>s.setButtonText("Random").onClick(()=>{this.fork.color=this.plugin.generateRandomColor();let o=r.components.find(l=>"inputEl"in l);o&&o.setValue&&o.setValue(this.fork.color)})),new kn.Setting(t).setName("Description").setDesc("How does this timeline differ from the main timeline?").setClass("storyteller-modal-setting-vertical").addTextArea(s=>{s.setValue(this.fork.description||"").onChange(o=>this.fork.description=o),s.inputEl.rows=4,s.inputEl.style.width="100%"}),new kn.Setting(t).setName("Notes").setDesc("Additional notes about this timeline fork").setClass("storyteller-modal-setting-vertical").addTextArea(s=>{s.setValue(this.fork.notes||"").onChange(o=>this.fork.notes=o),s.inputEl.rows=4,s.inputEl.style.width="100%"}),!this.isNew){let s=t.createDiv("storyteller-fork-altered-entities");if(s.createEl("h3",{text:"Altered Entities"}),this.fork.alteredCharacters&&this.fork.alteredCharacters.length>0){s.createEl("h4",{text:"Characters:"});let o=s.createEl("ul");this.fork.alteredCharacters.forEach(l=>{o.createEl("li",{text:`${l.entityId}: ${l.changes}`})})}if(this.fork.alteredLocations&&this.fork.alteredLocations.length>0){s.createEl("h4",{text:"Locations:"});let o=s.createEl("ul");this.fork.alteredLocations.forEach(l=>{o.createEl("li",{text:`${l.entityId}: ${l.changes}`})})}if(this.fork.forkEvents&&this.fork.forkEvents.length>0){s.createEl("h4",{text:"Fork-specific Events:"});let o=s.createEl("ul");this.fork.forkEvents.forEach(l=>{o.createEl("li",{text:l})})}}let n=new kn.Setting(t);n.addButton(s=>s.setButtonText("Save").setCta().onClick(async()=>{if(!this.fork.name){new kn.Notice("Fork name is required");return}if(!this.fork.divergenceEvent){new kn.Notice("Divergence event is required");return}await this.onSubmit(this.fork),this.close()})),n.addButton(s=>s.setButtonText("Cancel").onClick(()=>this.close())),!this.isNew&&this.onDelete&&n.addButton(s=>s.setButtonText("Delete").setWarning().onClick(async()=>{this.onDelete&&(await this.onDelete(this.fork),this.close())}))}onClose(){let{contentEl:t}=this;t.empty()}}});var TP={};At(TP,{StoryBoardGenerator:()=>EP});var EP,CP=_e(()=>{EP=class{constructor(t){this.HORIZONTAL_GAP=80;this.VERTICAL_GAP=40;this.CHAPTER_HEADER_HEIGHT=80;this.COLUMN_OFFSET=50;this.STATUS_COLORS={Draft:"4",Outline:"5",WIP:"3",Revised:"2",Final:"1"};this.CHAPTER_COLORS=["1","2","3","4","5","6"];this.CARD_WIDTH=(t==null?void 0:t.cardWidth)||400,this.CARD_HEIGHT=(t==null?void 0:t.cardHeight)||300}nodesOverlap(t,e,r=20){let n=t.x-r,s=t.x+t.width+r,o=t.y-r,l=t.y+t.height+r,c=e.x-r,u=e.x+e.width+r,d=e.y-r,h=e.y+e.height+r;return!(s<c||n>u||l<d||o>h)}findNonOverlappingPosition(t,e,r=100){let n={...t};if(!e.some(u=>this.nodesOverlap(n,u)))return{x:t.x,y:t.y};let o=100,l=1;for(let u=0;u<r;u++){for(let d=0;d<360;d+=45){let h=Math.cos(d*Math.PI/180)*l*o,f=Math.sin(d*Math.PI/180)*l*o;if(n.x=t.x+h,n.y=t.y+f,!e.some(g=>this.nodesOverlap(n,g)))return{x:n.x,y:n.y}}l++}return{x:e.reduce((u,d)=>Math.max(u,d.x+d.width),0)+this.HORIZONTAL_GAP,y:t.y}}generateCanvas(t,e,r){switch(r.layout){case"chapters":return this.generateChapterLayout(t,e,r);case"status":return this.generateStatusLayout(t,r);case"timeline":return this.generateTimelineLayout(t,r);default:return this.generateChapterLayout(t,e,r)}}generateChapterLayout(t,e,r){let n=[],s=[],o=[...e].sort((h,f)=>(h.number||0)-(f.number||0)),l=new Map;o.forEach((h,f)=>{l.set(h.id,f)});let c=o.length,u=new Map,d=[];if(t.forEach(h=>{if(h.chapterId&&l.has(h.chapterId)){let f=h.chapterId;u.has(f)||u.set(f,[]),u.get(f).push(h)}else d.push(h)}),u.forEach(h=>{h.sort((f,m)=>(f.priority||0)-(m.priority||0))}),d.sort((h,f)=>(h.priority||0)-(f.priority||0)),o.forEach((h,f)=>{let m=this.COLUMN_OFFSET+f*(this.CARD_WIDTH+this.HORIZONTAL_GAP);if(r.showChapterHeaders!==!1){let y={id:`chapter-header-${h.id}`,type:"text",text:`# ${h.name}`,x:m,y:0,width:this.CARD_WIDTH,height:this.CHAPTER_HEADER_HEIGHT,color:this.getChapterColor(f,r)};n.push(y)}let g=u.get(h.id)||[];g.forEach((y,v)=>{let E=(r.showChapterHeaders!==!1?this.CHAPTER_HEADER_HEIGHT+this.VERTICAL_GAP:0)+v*(this.CARD_HEIGHT+this.VERTICAL_GAP),C={id:`scene-${y.id||y.name}`,type:"file",file:y.filePath,x:m,y:E,width:this.CARD_WIDTH,height:this.CARD_HEIGHT,color:this.getSceneColor(y,f,r)};if(n.push(C),r.showEdges&&v<g.length-1){let _=g[v+1];s.push({id:`edge-${y.id}-${_.id}`,fromNode:C.id,fromSide:"bottom",toNode:`scene-${_.id||_.name}`,toSide:"top"})}})}),d.length>0){let h=this.COLUMN_OFFSET+c*(this.CARD_WIDTH+this.HORIZONTAL_GAP);if(r.showChapterHeaders!==!1){let f={id:"chapter-header-unassigned",type:"text",text:"# Unassigned Scenes",x:h,y:0,width:this.CARD_WIDTH,height:this.CHAPTER_HEADER_HEIGHT,color:"4"};n.push(f)}d.forEach((f,m)=>{let g=(r.showChapterHeaders!==!1?this.CHAPTER_HEADER_HEIGHT+this.VERTICAL_GAP:0)+m*(this.CARD_HEIGHT+this.VERTICAL_GAP),y={id:`scene-${f.id||f.name}`,type:"file",file:f.filePath,x:h,y:g,width:this.CARD_WIDTH,height:this.CARD_HEIGHT,color:this.getSceneColor(f,c,r)};n.push(y)})}return{nodes:n,edges:s}}generateStatusLayout(t,e){let r=[],n=[],s=["Draft","Outline","WIP","Revised","Final"],o=new Map;return t.forEach(l=>{let c=l.status||"Draft";o.has(c)||o.set(c,[]),o.get(c).push(l)}),o.forEach(l=>{l.sort((c,u)=>(c.priority||0)-(u.priority||0))}),s.forEach((l,c)=>{let u=this.COLUMN_OFFSET+c*(this.CARD_WIDTH+this.HORIZONTAL_GAP);if(e.showChapterHeaders!==!1){let h={id:`status-header-${l}`,type:"text",text:`# ${l}`,x:u,y:0,width:this.CARD_WIDTH,height:this.CHAPTER_HEADER_HEIGHT,color:this.STATUS_COLORS[l]||"4"};r.push(h)}(o.get(l)||[]).forEach((h,f)=>{let m=(e.showChapterHeaders!==!1?this.CHAPTER_HEADER_HEIGHT+this.VERTICAL_GAP:0)+f*(this.CARD_HEIGHT+this.VERTICAL_GAP),g={id:`scene-${h.id||h.name}`,type:"file",file:h.filePath,x:u,y:m,width:this.CARD_WIDTH,height:this.CARD_HEIGHT,color:this.STATUS_COLORS[l]||"4"};r.push(g)})}),{nodes:r,edges:n}}generateTimelineLayout(t,e){let r=[],n=[],s=[...t].sort((o,l)=>(o.priority||0)-(l.priority||0));return s.forEach((o,l)=>{let c=this.COLUMN_OFFSET+l*(this.CARD_WIDTH+this.HORIZONTAL_GAP),d={id:`scene-${o.id||o.name}`,type:"file",file:o.filePath,x:c,y:100,width:this.CARD_WIDTH,height:this.CARD_HEIGHT,color:this.getSceneColor(o,l,e)};if(r.push(d),e.showEdges&&l<s.length-1){let h=s[l+1];n.push({id:`edge-${o.id}-${h.id}`,fromNode:d.id,fromSide:"right",toNode:`scene-${h.id||h.name}`,toSide:"left"})}}),{nodes:r,edges:n}}getSceneColor(t,e,r){if(r.colorBy!=="none")return r.colorBy==="status"?this.STATUS_COLORS[t.status||"Draft"]||"4":r.colorBy==="chapter"?this.CHAPTER_COLORS[e%this.CHAPTER_COLORS.length]:this.STATUS_COLORS[t.status||"Draft"]||"4"}getChapterColor(t,e){return e.colorBy==="chapter"?this.CHAPTER_COLORS[t%this.CHAPTER_COLORS.length]:"2"}shouldReposition(t,e,r){let n=this.CARD_WIDTH+this.HORIZONTAL_GAP,s=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);switch(r){case"chapters":case"status":return s>n/2;case"timeline":let l=s>100,c=o>100;return l||c;default:return!1}}isManagedNode(t){return t.type==="file"?t.id.startsWith("scene-"):t.type==="text"?t.id.startsWith("chapter-header-")||t.id.startsWith("status-header-"):!1}getColumnX(t){return this.COLUMN_OFFSET+t*(this.CARD_WIDTH+this.HORIZONTAL_GAP)}getSceneY(t,e){return(e?this.CHAPTER_HEADER_HEIGHT+this.VERTICAL_GAP:0)+t*(this.CARD_HEIGHT+this.VERTICAL_GAP)}getColumnIndex(t){let e=this.CARD_WIDTH+this.HORIZONTAL_GAP;return Math.round((t.x-this.COLUMN_OFFSET)/e)}updateCanvas(t,e,r,n){let s=this.generateCanvas(e,r,n),o=new Map,l=new Map,c=[];t.nodes.forEach(C=>{C.type==="file"&&C.file?o.set(C.file,C):C.type==="text"&&this.isManagedNode(C)?l.set(C.id,C):c.push(C)});let u=new Map,d=new Map;s.nodes.forEach(C=>{C.type==="file"&&C.file?u.set(C.file,C):C.type==="text"&&d.set(C.id,C)});let h=[],f=[],m=[];u.forEach((C,_)=>{let x=o.get(_);x?this.shouldReposition(x,C,n.layout)?f.push({...C,color:C.color}):m.push({...x,id:C.id,color:C.color,width:C.width,height:C.height}):f.push(C)}),h.push(...m);let g=new Map;f.forEach(C=>{let _=this.getColumnIndex(C);g.has(_)||g.set(_,[]),g.get(_).push(C)}),g.forEach((C,_)=>{let x=this.getColumnX(_),P=m.filter(M=>this.getColumnIndex(M)===_);P.sort((M,O)=>M.y-O.y),C.sort((M,O)=>M.y-O.y);let I=P.map(M=>({top:M.y,bottom:M.y+M.height+this.VERTICAL_GAP}));C.forEach(M=>{let O=M.y,R=0,F=50;for(;R<F;){let k=O+M.height,N=!1;for(let G of I)if(!(O>=G.bottom||k<=G.top-this.VERTICAL_GAP)){N=!0,O=G.bottom;break}if(!N)break;R++}let $={...M,x,y:O};h.push($),I.push({top:O,bottom:O+M.height+this.VERTICAL_GAP}),I.sort((k,N)=>k.top-N.top)})}),d.forEach((C,_)=>{let x=l.get(_);if(x)h.push({...C,x:x.x,y:x.y});else{let P=this.findNonOverlappingPosition(C,h);h.push({...C,x:P.x,y:P.y})}}),c.forEach(C=>{let _=this.findNonOverlappingPosition(C,h);h.push({...C,x:_.x,y:_.y})});let y=new Set(h.map(C=>C.id)),v=t.edges.filter(C=>y.has(C.fromNode)&&y.has(C.toNode)),E=new Map;return v.forEach(C=>E.set(C.id,C)),s.edges.forEach(C=>{E.has(C.id)||E.set(C.id,C)}),{nodes:h,edges:Array.from(E.values())}}smartUpdateCanvas(t,e,r,n){let s=this.generateCanvas(e,r,n),o=new Map,l=new Map,c=new Map,u=new Map;t.nodes.forEach(g=>{g.type==="file"&&g.file?o.set(g.file,g):g.type==="text"&&c.set(g.id,g)}),s.nodes.forEach(g=>{g.type==="file"&&g.file?l.set(g.file,g):g.type==="text"&&u.set(g.id,g)});let d=new Set,h=new Set;o.forEach((g,y)=>{let v=l.get(y);v&&(this.shouldReposition(g,v,n.layout)?h.add(y):Math.abs(g.x-v.x)+Math.abs(g.y-v.y)>20&&d.add(y))});let f=[],m=new Set;return h.forEach(g=>{let y=l.get(g);if(y){let v=this.findNonOverlappingPosition(y,f);f.push({...y,x:v.x,y:v.y}),m.add(g)}}),d.forEach(g=>{let y=o.get(g),v=l.get(g);y&&v&&(f.push({...y,color:v.color,width:v.width,height:v.height}),m.add(g))}),s.nodes.forEach(g=>{if(g.type==="file"&&g.file){if(!m.has(g.file)){if(o.get(g.file))f.push(g);else{let v=this.findNonOverlappingPosition(g,f);f.push({...g,x:v.x,y:v.y})}m.add(g.file)}}else if(g.type==="text"){let y=c.get(g.id);if(y){let v=y.text!==g.text||y.color!==g.color,E=Math.abs(y.x-g.x)>20||Math.abs(y.y-g.y)>20;if(!v&&!E)f.push(y);else if(!E)f.push({...g,x:y.x,y:y.y});else{let C=this.findNonOverlappingPosition(g,f);f.push({...g,x:C.x,y:C.y})}}else{let v=this.findNonOverlappingPosition(g,f);f.push({...g,x:v.x,y:v.y})}}}),{nodes:f,edges:s.edges}}}});var rW={};At(rW,{TemplateApplicationModal:()=>_P});var sd,_P,iW=_e(()=>{sd=require("obsidian");ea();dP();_P=class extends hr{constructor(e,r,n,s){super(e);this.variableValues={};this.entityFileNames=[];this.previewNames=new Map;this.entityNamingContainer=null;this.plugin=r,this.template=n,this.onApply=s,this.initializeEntityFileNames(),this.template.variables&&this.template.variables.forEach(o=>{if(o.defaultValue!==void 0&&o.defaultValue!=="")this.variableValues[o.name]=o.defaultValue;else switch(o.type){case"boolean":this.variableValues[o.name]=!1;break;case"number":this.variableValues[o.name]=0;break;default:this.variableValues[o.name]=""}}),this.modalEl.addClass("storyteller-template-application-modal")}onOpen(){super.onOpen();let{contentEl:e}=this;e.empty(),e.addClass("template-application"),this.renderHeader(e),this.renderTemplateInfo(e),this.template.variables&&this.template.variables.length>0?this.renderVariablesForm(e):this.renderNoVariablesMessage(e),this.renderEntityNamingSection(e),this.renderFooter(e)}renderHeader(e){let r=e.createDiv("template-application-header");r.createEl("h2",{text:`Apply Template: ${this.template.name}`}),r.createEl("p",{text:this.template.description,cls:"template-application-subtitle"})}renderTemplateInfo(e){var l,c;let r=e.createDiv("template-application-info"),n=((l=this.template.entityTypes)==null?void 0:l.length)||0,s=((c=this.template.variables)==null?void 0:c.length)||0,o=r.createDiv("template-application-stats");o.createEl("span",{text:`\u{1F4E6} ${n} entity type${n!==1?"s":""}`,cls:"template-stat"}),o.createEl("span",{text:`\u{1F527} ${s} variable${s!==1?"s":""}`,cls:"template-stat"}),o.createEl("span",{text:`\u{1F3F7}\uFE0F ${this.template.genre}`,cls:"template-stat"}),s>0&&r.createEl("p",{text:"\u{1F4DD} Please fill in the following variables to customize this template:",cls:"template-application-instruction"})}renderVariablesForm(e){let r=e.createDiv("template-application-form");this.template.variables.forEach(n=>{this.renderVariableInput(r,n)})}renderVariableInput(e,r){let n=e.createDiv("template-variable-input"),s=new sd.Setting(n).setName(r.label||r.name).setDesc(r.description||`Enter value for {{${r.name}}}`);switch((r.defaultValue===void 0||r.defaultValue==="")&&s.nameEl.createSpan({text:" *",cls:"template-required-indicator"}),r.type){case"text":s.addText(o=>{var l,c;return o.setPlaceholder(((l=r.defaultValue)==null?void 0:l.toString())||`Enter ${r.label||r.name}`).setValue(((c=this.variableValues[r.name])==null?void 0:c.toString())||"").onChange(u=>{this.variableValues[r.name]=u,this.updatePreviewNames(),this.updateEntityNamingSection()})});break;case"number":s.addText(o=>{var l,c;return o.setPlaceholder(((l=r.defaultValue)==null?void 0:l.toString())||"0").setValue(((c=this.variableValues[r.name])==null?void 0:c.toString())||"").onChange(u=>{let d=parseFloat(u);this.variableValues[r.name]=isNaN(d)?0:d,this.updatePreviewNames(),this.updateEntityNamingSection()})});break;case"boolean":s.addToggle(o=>o.setValue(this.variableValues[r.name]===!0).onChange(l=>{this.variableValues[r.name]=l,this.updatePreviewNames(),this.updateEntityNamingSection()}));break;case"select":r.options&&r.options.length>0?s.addDropdown(o=>{var l;r.defaultValue||o.addOption("","-- Select --"),r.options.forEach(c=>{o.addOption(c,c)}),o.setValue(((l=this.variableValues[r.name])==null?void 0:l.toString())||""),o.onChange(c=>{this.variableValues[r.name]=c,this.updatePreviewNames(),this.updateEntityNamingSection()})}):s.addText(o=>{var l;return o.setPlaceholder("No options defined").setValue(((l=this.variableValues[r.name])==null?void 0:l.toString())||"").onChange(c=>{this.variableValues[r.name]=c,this.updatePreviewNames(),this.updateEntityNamingSection()})});break;case"date":s.addText(o=>{var l;return o.setPlaceholder("YYYY-MM-DD").setValue(((l=this.variableValues[r.name])==null?void 0:l.toString())||"").onChange(c=>{this.variableValues[r.name]=c,this.updatePreviewNames(),this.updateEntityNamingSection()})});break}if(r.usedIn&&r.usedIn.length>0){let o=n.createDiv("template-variable-example"),l=r.usedIn[0];o.createEl("small",{text:`Used in: ${this.getEntityTypeLabel(l.entityType)} \u2192 ${l.field}`,cls:"template-variable-usage-hint"})}}renderNoVariablesMessage(e){e.createDiv("template-application-no-variables").createEl("p",{text:"\u2728 This template has no customizable variables. It will be applied with default values.",cls:"template-application-message"})}initializeEntityFileNames(){this.entityFileNames=[];let e=this.template.entities;["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"].forEach(n=>{let s=this.getEntityTypePlural(n),o=e[s];o&&Array.isArray(o)&&o.forEach(l=>{if(l.templateId){let c="Unnamed";if(l.name)c=l.name;else if(l.yamlContent)try{let{parseYaml:u}=require("obsidian"),d=u(l.yamlContent);d&&d.name&&(c=d.name)}catch(u){}this.previewNames.set(l.templateId,c),this.entityFileNames.push({templateId:l.templateId,entityType:n,fileName:c})}})})}updatePreviewNames(){let e=this.template.entities;["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"].forEach(n=>{let s=this.getEntityTypePlural(n),o=e[s];o&&Array.isArray(o)&&o.forEach(l=>{if(l.templateId){let c="Unnamed";if(l.yamlContent){let u=id.substituteString(l.yamlContent,this.variableValues,!1);try{let{parseYaml:d}=require("obsidian"),h=d(u.value);h&&h.name&&(c=h.name)}catch(d){let h=u.value.match(/^name:\s*(.+)$/m);h&&(c=h[1].trim().replace(/^["']|["']$/g,""))}}else l.name&&(c=id.substituteString(l.name,this.variableValues,!1).value||"Unnamed");this.previewNames.set(l.templateId,c)}})})}renderEntityNamingSection(e){this.entityNamingContainer=e.createDiv("template-application-entity-naming"),this.updateEntityNamingSection()}updateEntityNamingSection(){this.entityNamingContainer&&(this.entityNamingContainer.empty(),this.entityFileNames.length!==0&&(this.entityNamingContainer.createEl("h3",{text:"Choose File Names"}),this.entityNamingContainer.createEl("p",{text:"Enter the file name for each entity note that will be created. This will be the name of the markdown file (without .md extension).",cls:"template-application-instruction"}),this.updatePreviewNames(),this.entityFileNames.forEach((e,r)=>{let n=this.entityNamingContainer.createDiv("template-entity-naming-item"),s=this.getEntityTypeLabel(e.entityType),o=this.previewNames.get(e.templateId)||"Unnamed",l=this.previewNames.get(e.templateId+"_original");(!l||e.fileName===l||e.fileName==="Unnamed")&&(e.fileName=o),new sd.Setting(n).setName(`${s} File Name`).setDesc(`File name for the ${s.toLowerCase()} note (e.g., "${o}.md")`).addText(c=>c.setPlaceholder(o).setValue(e.fileName).onChange(u=>{e.fileName=u||o,this.previewNames.set(e.templateId+"_original",u||o)}))})))}getEntityTypePlural(e){return{character:"characters",location:"locations",event:"events",item:"items",group:"groups",culture:"cultures",economy:"economies",magicSystem:"magicSystems",chapter:"chapters",scene:"scenes",reference:"references"}[e]||e+"s"}renderFooter(e){let r=e.createDiv("template-application-footer");r.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close()),r.createEl("button",{text:"Apply Template",cls:"mod-cta"}).addEventListener("click",()=>this.handleApply())}handleApply(){if(this.template.variables){let r=[];if(this.template.variables.forEach(n=>{let s=this.variableValues[n.name];(n.defaultValue===void 0||n.defaultValue==="")&&(s===void 0||s===""||s===null)&&r.push(`${n.label||n.name} is required`),n.type==="date"&&s&&s!==""&&(/^\d{4}-\d{2}-\d{2}$/.test(s)||r.push(`${n.label||n.name} must be in YYYY-MM-DD format`)),n.type==="number"&&s!==void 0&&s!==""&&isNaN(parseFloat(s))&&r.push(`${n.label||n.name} must be a valid number`),n.type==="select"&&n.options&&n.options.length>0&&s&&!n.options.includes(s)&&r.push(`${n.label||n.name} must be one of the available options`)}),r.length>0){new sd.Notice(`Please fix the following errors:
${r.join(`
`)}`);return}}let e=[];if(this.entityFileNames.forEach(r=>{(!r.fileName||r.fileName.trim()==="")&&e.push(`${this.getEntityTypeLabel(r.entityType)} file name is required`),/[\\/:"*?<>|#^[\]]+/g.test(r.fileName)&&e.push(`${this.getEntityTypeLabel(r.entityType)} file name contains invalid characters`)}),e.length>0){new sd.Notice(`Please fix the following errors:
${e.join(`
`)}`);return}this.onApply(this.variableValues,this.entityFileNames),new sd.Notice(`Applying template "${this.template.name}"...`),this.close()}getEntityTypeLabel(e){return{character:"Character",location:"Location",event:"Event",item:"Item",group:"Group",culture:"Culture",economy:"Economy",magicSystem:"Magic System",chapter:"Chapter",scene:"Scene",reference:"Reference"}[e]||e}onClose(){this.contentEl.empty()}}});var cCe={};At(cCe,{default:()=>HE});module.exports=Do(cCe);var lCe=Ca(xT());(function(a,t,e){function r(n,s){for(;(n=n.parentElement)&&!n.classList.contains(s););return n}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(n,s){this._map=n,this._container=n._container,this._overlayPane=n._panes.overlayPane,this._popupPane=n._panes.popupPane,s&&s.shapeOptions&&(s.shapeOptions=L.Util.extend({},this.options.shapeOptions,s.shapeOptions)),L.setOptions(this,s);var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(L.DomUtil.disableTextSelection(),n.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(n){L.setOptions(this,n)},_fireCreatedEvent:function(n){this._map.fire(L.Draw.Event.CREATED,{layer:n,layerType:this.type})},_cancelDrawing:function(n){n.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(n,s){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,s&&s.drawError&&(s.drawError=L.Util.extend({},this.options.drawError,s.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,n,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var n=this._markers.pop(),s=this._poly,o=s.getLatLngs(),l=o.splice(-1,1)[0];this._poly.setLatLngs(o),this._markerGroup.removeLayer(n),s.getLatLngs().length<2&&this._map.removeLayer(s),this._vertexChanged(l,!1)}},addVertex:function(n){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(n))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(n)),this._poly.addLatLng(n),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(n,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var n=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),s=this._poly.newLatLngIntersects(n[n.length-1]);if(!this.options.allowIntersection&&s||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(n){var s=this._map.mouseEventToLayerPoint(n.originalEvent),o=this._map.layerPointToLatLng(s);this._currentLatLng=o,this._updateTooltip(o),this._updateGuide(s),this._mouseMarker.setLatLng(o),L.DomEvent.preventDefault(n.originalEvent)},_vertexChanged:function(n,s){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(n,s),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(n){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(n),this._clickHandled=!0,this._disableNewMarkers();var s=n.originalEvent,o=s.clientX,l=s.clientY;this._startPoint.call(this,o,l)}},_startPoint:function(n,s){this._mouseDownOrigin=L.point(n,s)},_onMouseUp:function(n){var s=n.originalEvent,o=s.clientX,l=s.clientY;this._endPoint.call(this,o,l,n),this._clickHandled=null},_endPoint:function(n,s,o){if(this._mouseDownOrigin){var l=L.point(n,s).distanceTo(this._mouseDownOrigin),c=this._calculateFinishDistance(o.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(o.latlng),this._finishShape()):c<10&&L.Browser.touch?this._finishShape():Math.abs(l)<9*(a.devicePixelRatio||1)&&this.addVertex(o.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(n){var s,o,l=n.originalEvent;!l.touches||!l.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(s=l.touches[0].clientX,o=l.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,s,o),this._endPoint.call(this,s,o,n),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(n){var s;if(this._markers.length>0){var o;if(this.type===L.Draw.Polyline.TYPE)o=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;o=this._markers[0]}var l=this._map.latLngToContainerPoint(o.getLatLng()),c=new L.Marker(n,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),u=this._map.latLngToContainerPoint(c.getLatLng());s=l.distanceTo(u)}else s=1/0;return s},_updateFinishHandler:function(){var n=this._markers.length;n>1&&this._markers[n-1].on("click",this._finishShape,this),n>2&&this._markers[n-2].off("click",this._finishShape,this)},_createMarker:function(n){var s=new L.Marker(n,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(s),s},_updateGuide:function(n){var s=this._markers?this._markers.length:0;s>0&&(n=n||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[s-1].getLatLng()),n))},_updateTooltip:function(n){var s=this._getTooltipText();n&&this._tooltip.updatePosition(n),this._errorShown||this._tooltip.updateContent(s)},_drawGuide:function(n,s){var o,l,c,u=Math.floor(Math.sqrt(Math.pow(s.x-n.x,2)+Math.pow(s.y-n.y,2))),d=this.options.guidelineDistance,h=this.options.maxGuideLineLength,f=u>h?u-h:d;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));f<u;f+=this.options.guidelineDistance)o=f/u,l={x:Math.floor(n.x*(1-o)+o*s.x),y:Math.floor(n.y*(1-o)+o*s.y)},c=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),c.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(c,l)},_updateGuideColor:function(n){if(this._guidesContainer)for(var s=0,o=this._guidesContainer.childNodes.length;s<o;s++)this._guidesContainer.childNodes[s].style.backgroundColor=n},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var n,s,o=this.options.showLength;return this._markers.length===0?n={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(s=o?this._getMeasurementString():"",n=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:s}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:s}),n},_updateRunningMeasure:function(n,s){var o,l,c=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(o=c-(s?2:1),l=L.GeometryUtil.isVersion07x()?n.distanceTo(this._markers[o].getLatLng())*(this.options.factor||1):this._map.distance(n,this._markers[o].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=l*(s?1:-1))},_getMeasurementString:function(){var n,s=this._currentLatLng,o=this._markers[this._markers.length-1].getLatLng();return n=L.GeometryUtil.isVersion07x()?o&&s&&s.distanceTo?this._measurementRunningTotal+s.distanceTo(o)*(this.options.factor||1):this._measurementRunningTotal||0:o&&s?this._measurementRunningTotal+this._map.distance(s,o)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(n,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var n=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(n,s){L.Draw.Polyline.prototype.initialize.call(this,n,s),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var n=this._markers.length;n===1&&this._markers[0].on("click",this._finishShape,this),n>2&&(this._markers[n-1].on("dblclick",this._finishShape,this),n>3&&this._markers[n-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var n,s;return this._markers.length===0?n=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(n=L.drawLocal.draw.handlers.polygon.tooltip.cont,s=this._getMeasurementString()):(n=L.drawLocal.draw.handlers.polygon.tooltip.end,s=this._getMeasurementString()),{text:n,subtext:s}},_getMeasurementString:function(){var n=this._area,s="";return n||this.options.showLength?(this.options.showLength&&(s=L.Draw.Polyline.prototype._getMeasurementString.call(this)),n&&(s+="<br>"+L.GeometryUtil.readableArea(n,this.options.metric,this.options.precision)),s):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(n,s){var o;!this.options.allowIntersection&&this.options.showArea&&(o=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(o)),L.Draw.Polyline.prototype._vertexChanged.call(this,n,s)},_cleanUpShape:function(){var n=this._markers.length;n>0&&(this._markers[0].off("click",this._finishShape,this),n>2&&this._markers[n-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(n,s){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,n,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(n){this._isDrawing=!0,this._startLatLng=n.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(n.originalEvent)},_onMouseMove:function(n){var s=n.latlng;this._tooltip.updatePosition(s),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(s))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(n,s){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,n,s)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(n){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!r(n.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(n){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,n)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,n),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var n=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,n)},_getTooltipText:function(){var n,s,o,l=L.Draw.SimpleShape.prototype._getTooltipText.call(this),c=this._shape,u=this.options.showArea;return c&&(n=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),s=L.GeometryUtil.geodesicArea(n),o=u?L.GeometryUtil.readableArea(s,this.options.metric):""),{text:l.text,subtext:o}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(n,s){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,n,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(n){var s=n.latlng;this._tooltip.updatePosition(s),this._mouseMarker.setLatLng(s),this._marker?(s=this._mouseMarker.getLatLng(),this._marker.setLatLng(s)):(this._marker=this._createMarker(s),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(n){return new L.Marker(n,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(n){this._onMouseMove(n),this._onClick()},_fireCreatedEvent:function(){var n=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(n,s){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,n,s)},_fireCreatedEvent:function(){var n=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)},_createMarker:function(n){return new L.CircleMarker(n,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(n,s){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,n,s)},_drawShape:function(n){if(L.GeometryUtil.isVersion07x())var s=this._startLatLng.distanceTo(n);else var s=this._map.distance(this._startLatLng,n);this._shape?this._shape.setRadius(s):(this._shape=new L.Circle(this._startLatLng,s,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var n=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,n)},_onMouseMove:function(n){var s,o=n.latlng,l=this.options.showRadius,c=this.options.metric;if(this._tooltip.updatePosition(o),this._isDrawing){this._drawShape(o),s=this._shape.getRadius().toFixed(1);var u="";l&&(u=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(s,c,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:u})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(n,s){this._marker=n,L.setOptions(this,s)},addHooks:function(){var n=this._marker;n.dragging.enable(),n.on("dragend",this._onDragEnd,n),this._toggleMarkerHighlight()},removeHooks:function(){var n=this._marker;n.dragging.disable(),n.off("dragend",this._onDragEnd,n),this._toggleMarkerHighlight()},_onDragEnd:function(n){var s=n.target;s.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:s})},_toggleMarkerHighlight:function(){var n=this._marker._icon;n&&(n.style.display="none",L.DomUtil.hasClass(n,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(n,"leaflet-edit-marker-selected"),this._offsetMarker(n,-4)):(L.DomUtil.addClass(n,"leaflet-edit-marker-selected"),this._offsetMarker(n,4)),n.style.display="")},_offsetMarker:function(n,s){var o=parseInt(n.style.marginTop,10)-s,l=parseInt(n.style.marginLeft,10)-s;n.style.marginTop=o+"px",n.style.marginLeft=l+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(n){this.latlngs=[n._latlngs],n._holes&&(this.latlngs=this.latlngs.concat(n._holes)),this._poly=n,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(n){for(var s=0;s<this._verticesHandlers.length;s++)n(this._verticesHandlers[s])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(n){n.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(n){n.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(n){n.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var n=0;n<this.latlngs.length;n++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[n],this._poly.options.poly))},_updateLatLngs:function(n){this.latlngs=[n.layer._latlngs],n.layer._holes&&(this.latlngs=this.latlngs.concat(n.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(n,s,o){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=n,o&&o.drawError&&(o.drawError=L.Util.extend({},this.options.drawError,o.drawError)),this._latlngs=s,L.setOptions(this,o)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var n=this._poly,s=n._path;n instanceof L.Polygon||(n.options.fill=!1,n.options.editing&&(n.options.editing.fill=!1)),s&&n.options.editing&&n.options.editing.className&&(n.options.original.className&&n.options.original.className.split(" ").forEach(function(o){L.DomUtil.removeClass(s,o)}),n.options.editing.className.split(" ").forEach(function(o){L.DomUtil.addClass(s,o)})),n.setStyle(n.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var n=this._poly,s=n._path;s&&n.options.editing&&n.options.editing.className&&(n.options.editing.className.split(" ").forEach(function(o){L.DomUtil.removeClass(s,o)}),n.options.original.className&&n.options.original.className.split(" ").forEach(function(o){L.DomUtil.addClass(s,o)})),n.setStyle(n.options.original),n._map&&(n._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var n,s,o,l,c=this._defaultShape();for(n=0,o=c.length;n<o;n++)l=this._createMarker(c[n],n),l.on("click",this._onMarkerClick,this),l.on("contextmenu",this._onContextMenu,this),this._markers.push(l);var u,d;for(n=0,s=o-1;n<o;s=n++)(n!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(u=this._markers[s],d=this._markers[n],this._createMiddleMarker(u,d),this._updatePrevNext(u,d))},_createMarker:function(n,s){var o=new L.Marker.Touch(n,{draggable:!0,icon:this.options.icon});return o._origLatLng=n,o._index=s,o.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(o),o},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var n=this._defaultShape(),s=[].splice.apply(n,arguments);return this._poly._convertLatLngs(n,!0),this._poly.redraw(),s},_removeMarker:function(n){var s=n._index;this._markerGroup.removeLayer(n),this._markers.splice(s,1),this._spliceLatLngs(s,1),this._updateIndexes(s,-1),n.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(n){var s=n.target,o=this._poly,l=L.LatLngUtil.cloneLatLng(s._origLatLng);if(L.extend(s._origLatLng,s._latlng),o.options.poly){var c=o._map._editTooltip;if(!o.options.poly.allowIntersection&&o.intersects()){L.extend(s._origLatLng,l),s.setLatLng(l);var u=o.options.color;o.setStyle({color:this.options.drawError.color}),c&&c.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){o.setStyle({color:u}),c&&c.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}s._middleLeft&&s._middleLeft.setLatLng(this._getMiddleLatLng(s._prev,s)),s._middleRight&&s._middleRight.setLatLng(this._getMiddleLatLng(s,s._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var d=this._poly.getLatLngs();this._poly._convertLatLngs(d,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(n){var s=L.Polygon&&this._poly instanceof L.Polygon?4:3,o=n.target;this._defaultShape().length<s||(this._removeMarker(o),this._updatePrevNext(o._prev,o._next),o._middleLeft&&this._markerGroup.removeLayer(o._middleLeft),o._middleRight&&this._markerGroup.removeLayer(o._middleRight),o._prev&&o._next?this._createMiddleMarker(o._prev,o._next):o._prev?o._next||(o._prev._middleRight=null):o._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(n){var s=n.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:s,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(n){var s=this._map.mouseEventToLayerPoint(n.originalEvent.touches[0]),o=this._map.layerPointToLatLng(s),l=n.target;L.extend(l._origLatLng,o),l._middleLeft&&l._middleLeft.setLatLng(this._getMiddleLatLng(l._prev,l)),l._middleRight&&l._middleRight.setLatLng(this._getMiddleLatLng(l,l._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(n,s){this._markerGroup.eachLayer(function(o){o._index>n&&(o._index+=s)})},_createMiddleMarker:function(n,s){var o,l,c,u=this._getMiddleLatLng(n,s),d=this._createMarker(u);d.setOpacity(.6),n._middleRight=s._middleLeft=d,l=function(){d.off("touchmove",l,this);var h=s._index;d._index=h,d.off("click",o,this).on("click",this._onMarkerClick,this),u.lat=d.getLatLng().lat,u.lng=d.getLatLng().lng,this._spliceLatLngs(h,0,u),this._markers.splice(h,0,d),d.setOpacity(1),this._updateIndexes(h,1),s._index++,this._updatePrevNext(n,d),this._updatePrevNext(d,s),this._poly.fire("editstart")},c=function(){d.off("dragstart",l,this),d.off("dragend",c,this),d.off("touchmove",l,this),this._createMiddleMarker(n,d),this._createMiddleMarker(d,s)},o=function(){l.call(this),c.call(this),this._fireEdit()},d.on("click",o,this).on("dragstart",l,this).on("dragend",c,this).on("touchmove",l,this),this._markerGroup.addLayer(d)},_updatePrevNext:function(n,s){n&&(n._next=s),s&&(s._prev=n)},_getMiddleLatLng:function(n,s){var o=this._poly._map,l=o.project(n.getLatLng()),c=o.project(s.getLatLng());return o.unproject(l._add(c)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(n,s){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=n,L.Util.setOptions(this,s)},addHooks:function(){var n=this._shape;this._shape._map&&(this._map=this._shape._map,n.setStyle(n.options.editing),n._map&&(this._map=n._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var n=this._shape;if(n.setStyle(n.options.original),n._map){this._unbindMarker(this._moveMarker);for(var s=0,o=this._resizeMarkers.length;s<o;s++)this._unbindMarker(this._resizeMarkers[s]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(n,s){var o=new L.Marker.Touch(n,{draggable:!0,icon:s,zIndexOffset:10});return this._bindMarker(o),this._markerGroup.addLayer(o),o},_bindMarker:function(n){n.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(n){n.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(n){n.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(n){var s=n.target,o=s.getLatLng();s===this._moveMarker?this._move(o):this._resize(o),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(n){n.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(n){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,n),typeof this._getCorners=="function"){var s=this._getCorners(),o=n.target,l=o._cornerIndex;o.setOpacity(0),this._oppositeCorner=s[(l+2)%4],this._toggleCornerMarkers(0,l)}this._shape.fire("editstart")},_onTouchMove:function(n){var s=this._map.mouseEventToLayerPoint(n.originalEvent.touches[0]),o=this._map.layerPointToLatLng(s);return n.target===this._moveMarker?this._move(o):this._resize(o),this._shape.redraw(),!1},_onTouchEnd:function(n){n.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var n=this._shape.getBounds(),s=n.getCenter();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){var n=this._getCorners();this._resizeMarkers=[];for(var s=0,o=n.length;s<o;s++)this._resizeMarkers.push(this._createMarker(n[s],this.options.resizeIcon)),this._resizeMarkers[s]._cornerIndex=s},_onMarkerDragStart:function(n){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,n);var s=this._getCorners(),o=n.target,l=o._cornerIndex;this._oppositeCorner=s[(l+2)%4],this._toggleCornerMarkers(0,l)},_onMarkerDragEnd:function(n){var s,o,l=n.target;l===this._moveMarker&&(s=this._shape.getBounds(),o=s.getCenter(),l.setLatLng(o)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,n)},_move:function(n){for(var s,o=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),l=this._shape.getBounds(),c=l.getCenter(),u=[],d=0,h=o.length;d<h;d++)s=[o[d].lat-c.lat,o[d].lng-c.lng],u.push([n.lat+s[0],n.lng+s[1]]);this._shape.setLatLngs(u),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(n){var s;this._shape.setBounds(L.latLngBounds(n,this._oppositeCorner)),s=this._shape.getBounds(),this._moveMarker.setLatLng(s.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var n=this._shape.getBounds();return[n.getNorthWest(),n.getNorthEast(),n.getSouthEast(),n.getSouthWest()]},_toggleCornerMarkers:function(n){for(var s=0,o=this._resizeMarkers.length;s<o;s++)this._resizeMarkers[s].setOpacity(n)},_repositionCornerMarkers:function(){for(var n=this._getCorners(),s=0,o=this._resizeMarkers.length;s<o;s++)this._resizeMarkers[s].setLatLng(n[s])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var n=this._shape.getLatLng();this._moveMarker=this._createMarker(n,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(n){if(this._resizeMarkers.length){var s=this._getResizeMarkerPoint(n);this._resizeMarkers[0].setLatLng(s)}this._shape.setLatLng(n),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var n=this._shape.getLatLng(),s=this._getResizeMarkerPoint(n);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(s,this.options.resizeIcon))},_getResizeMarkerPoint:function(n){var s=this._shape._radius*Math.cos(Math.PI/4),o=this._map.project(n);return this._map.unproject([o.x+s,o.y-s])},_resize:function(n){var s=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=s.distanceTo(n):radius=this._map.distance(s,n),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(n,s){var o={};if(n.touches!==void 0){if(!n.touches.length)return;o=n.touches[0]}else if(n.pointerType!=="touch"||(o=n,!this._filterClick(n)))return;var l=this._map.mouseEventToContainerPoint(o),c=this._map.mouseEventToLayerPoint(o),u=this._map.layerPointToLatLng(c);this._map.fire(s,{latlng:u,layerPoint:c,containerPoint:l,pageX:o.pageX,pageY:o.pageY,originalEvent:n})},_filterClick:function(n){var s=n.timeStamp||n.originalEvent.timeStamp,o=L.DomEvent._lastClick&&s-L.DomEvent._lastClick;return o&&o>100&&o<500||n.target._simulatedClick&&!n._simulated?(L.DomEvent.stop(n),!1):(L.DomEvent._lastClick=s,!0)},_onTouchStart:function(n){this._map._loaded&&this._touchEvent(n,"touchstart")},_onTouchEnd:function(n){this._map._loaded&&this._touchEvent(n,"touchend")},_onTouchCancel:function(n){if(this._map._loaded){var s="touchcancel";this._detectIE()&&(s="pointercancel"),this._touchEvent(n,s)}},_onTouchLeave:function(n){this._map._loaded&&this._touchEvent(n,"touchleave")},_onTouchMove:function(n){this._map._loaded&&this._touchEvent(n,"touchmove")},_detectIE:function(){var n=a.navigator.userAgent,s=n.indexOf("MSIE ");if(s>0)return parseInt(n.substring(s+5,n.indexOf(".",s)),10);if(n.indexOf("Trident/")>0){var o=n.indexOf("rv:");return parseInt(n.substring(o+3,n.indexOf(".",o)),10)}var l=n.indexOf("Edge/");return l>0&&parseInt(n.substring(l+5,n.indexOf(".",l)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var n=this._icon,s=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?s.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):s.concat(["touchcancel"]),L.DomUtil.addClass(n,"leaflet-clickable"),L.DomEvent.on(n,"click",this._onMouseClick,this),L.DomEvent.on(n,"keypress",this._onKeyPress,this);for(var o=0;o<s.length;o++)L.DomEvent.on(n,s[o],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var n=a.navigator.userAgent,s=n.indexOf("MSIE ");if(s>0)return parseInt(n.substring(s+5,n.indexOf(".",s)),10);if(n.indexOf("Trident/")>0){var o=n.indexOf("rv:");return parseInt(n.substring(o+3,n.indexOf(".",o)),10)}var l=n.indexOf("Edge/");return l>0&&parseInt(n.substring(l+5,n.indexOf(".",l)),10)}}),L.LatLngUtil={cloneLatLngs:function(n){for(var s=[],o=0,l=n.length;o<l;o++)Array.isArray(n[o])?s.push(L.LatLngUtil.cloneLatLngs(n[o])):s.push(this.cloneLatLng(n[o]));return s},cloneLatLng:function(n){return L.latLng(n.lat,n.lng)}},(function(){var n={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(s){var o,l,c=s.length,u=0,d=Math.PI/180;if(c>2){for(var h=0;h<c;h++)o=s[h],l=s[(h+1)%c],u+=(l.lng-o.lng)*d*(2+Math.sin(o.lat*d)+Math.sin(l.lat*d));u=6378137*u*6378137/2}return Math.abs(u)},formattedNumber:function(s,o){var l=parseFloat(s).toFixed(o),c=L.drawLocal.format&&L.drawLocal.format.numeric,u=c&&c.delimiters,d=u&&u.thousands,h=u&&u.decimal;if(d||h){var f=l.split(".");l=d?f[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d):f[0],h=h||".",f.length>1&&(l=l+h+f[1])}return l},readableArea:function(s,o,d){var c,u,d=L.Util.extend({},n,d);return o?(u=["ha","m"],type=typeof o,type==="string"?u=[o]:type!=="boolean"&&(u=o),c=s>=1e6&&u.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*s,d.km)+" km\xB2":s>=1e4&&u.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*s,d.ha)+" ha":L.GeometryUtil.formattedNumber(s,d.m)+" m\xB2"):(s/=.836127,c=s>=3097600?L.GeometryUtil.formattedNumber(s/3097600,d.mi)+" mi\xB2":s>=4840?L.GeometryUtil.formattedNumber(s/4840,d.ac)+" acres":L.GeometryUtil.formattedNumber(s,d.yd)+" yd\xB2"),c},readableDistance:function(s,o,l,c,h){var d,h=L.Util.extend({},n,h);switch(o?typeof o=="string"?o:"metric":l?"feet":c?"nauticalMile":"yards"){case"metric":d=s>1e3?L.GeometryUtil.formattedNumber(s/1e3,h.km)+" km":L.GeometryUtil.formattedNumber(s,h.m)+" m";break;case"feet":s*=3.28083,d=L.GeometryUtil.formattedNumber(s,h.ft)+" ft";break;case"nauticalMile":s*=.53996,d=L.GeometryUtil.formattedNumber(s/1e3,h.nm)+" nm";break;case"yards":default:s*=1.09361,d=s>1760?L.GeometryUtil.formattedNumber(s/1760,h.mi)+" miles":L.GeometryUtil.formattedNumber(s,h.yd)+" yd"}return d},isVersion07x:function(){var s=L.version.split(".");return parseInt(s[0],10)===0&&parseInt(s[1],10)===7}})})(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(n,s,o,l){return this._checkCounterclockwise(n,o,l)!==this._checkCounterclockwise(s,o,l)&&this._checkCounterclockwise(n,s,o)!==this._checkCounterclockwise(n,s,l)},_checkCounterclockwise:function(n,s,o){return(o.y-n.y)*(s.x-n.x)>(s.y-n.y)*(o.x-n.x)}}),L.Polyline.include({intersects:function(){var n,s,o,l=this._getProjectedPoints(),c=l?l.length:0;if(this._tooFewPointsForIntersection())return!1;for(n=c-1;n>=3;n--)if(s=l[n-1],o=l[n],this._lineSegmentsIntersectsRange(s,o,n-2))return!0;return!1},newLatLngIntersects:function(n,s){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(n),s)},newPointIntersects:function(n,s){var o=this._getProjectedPoints(),l=o?o.length:0,c=o?o[l-1]:null,u=l-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(c,n,u,s?1:0)},_tooFewPointsForIntersection:function(n){var s=this._getProjectedPoints(),o=s?s.length:0;return o+=n||0,!s||o<=3},_lineSegmentsIntersectsRange:function(n,s,o,l){var c,u,d=this._getProjectedPoints();l=l||0;for(var h=o;h>l;h--)if(c=d[h-1],u=d[h],L.LineUtil.segmentsIntersect(n,s,c,u))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var n=[],s=this._defaultShape(),o=0;o<s.length;o++)n.push(this._map.latLngToLayerPoint(s[o]));return n}}),L.Polygon.include({intersects:function(){var n,s,o,l,c=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(n=c.length,s=c[0],o=c[n-1],l=n-2,this._lineSegmentsIntersectsRange(o,s,l,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(n){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,n);var s;this._toolbars={},L.DrawToolbar&&this.options.draw&&(s=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=s,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(s=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=s,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(n){var s,o=L.DomUtil.create("div","leaflet-draw"),l=!1;for(var c in this._toolbars)this._toolbars.hasOwnProperty(c)&&(s=this._toolbars[c].addToolbar(n))&&(l||(L.DomUtil.hasClass(s,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(s.childNodes[0],"leaflet-draw-toolbar-top"),l=!0),o.appendChild(s));return o},onRemove:function(){for(var n in this._toolbars)this._toolbars.hasOwnProperty(n)&&this._toolbars[n].removeToolbar()},setDrawingOptions:function(n){for(var s in this._toolbars)this._toolbars[s]instanceof L.DrawToolbar&&this._toolbars[s].setOptions(n)},_toolbarEnabled:function(n){var s=n.target;for(var o in this._toolbars)this._toolbars[o]!==s&&this._toolbars[o].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(n){L.setOptions(this,n),this._modes={},this._actionButtons=[],this._activeMode=null;var s=L.version.split(".");parseInt(s[0],10)===1&&parseInt(s[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(n){var s,o=L.DomUtil.create("div","leaflet-draw-section"),l=0,c=this._toolbarClass||"",u=this.getModeHandlers(n);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=n,s=0;s<u.length;s++)u[s].enabled&&this._initModeHandler(u[s].handler,this._toolbarContainer,l++,c,u[s].title);if(l)return this._lastButtonIndex=--l,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),o.appendChild(this._toolbarContainer),o.appendChild(this._actionsContainer),o},removeToolbar:function(){for(var n in this._modes)this._modes.hasOwnProperty(n)&&(this._disposeButton(this._modes[n].button,this._modes[n].handler.enable,this._modes[n].handler),this._modes[n].handler.disable(),this._modes[n].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var s=0,o=this._actionButtons.length;s<o;s++)this._disposeButton(this._actionButtons[s].button,this._actionButtons[s].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(n,s,o,l,c){var u=n.type;this._modes[u]={},this._modes[u].handler=n,this._modes[u].button=this._createButton({type:u,title:c,className:l+"-"+u,container:s,callback:this._modes[u].handler.enable,context:this._modes[u].handler}),this._modes[u].buttonIndex=o,this._modes[u].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!a.MSStream},_createButton:function(n){var s=L.DomUtil.create("a",n.className||"",n.container),o=L.DomUtil.create("span","sr-only",n.container);s.href="#",s.appendChild(o),n.title&&(s.title=n.title,o.innerHTML=n.title),n.text&&(s.innerHTML=n.text,o.innerHTML=n.text);var l=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(s,"click",L.DomEvent.stopPropagation).on(s,"mousedown",L.DomEvent.stopPropagation).on(s,"dblclick",L.DomEvent.stopPropagation).on(s,"touchstart",L.DomEvent.stopPropagation).on(s,"click",L.DomEvent.preventDefault).on(s,l,n.callback,n.context),s},_disposeButton:function(n,s){var o=this._detectIOS()?"touchstart":"click";L.DomEvent.off(n,"click",L.DomEvent.stopPropagation).off(n,"mousedown",L.DomEvent.stopPropagation).off(n,"dblclick",L.DomEvent.stopPropagation).off(n,"touchstart",L.DomEvent.stopPropagation).off(n,"click",L.DomEvent.preventDefault).off(n,o,s)},_handlerActivated:function(n){this.disable(),this._activeMode=this._modes[n.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(n){var s,o,l,c,u=this._actionsContainer,d=this.getActions(n),h=d.length;for(o=0,l=this._actionButtons.length;o<l;o++)this._disposeButton(this._actionButtons[o].button,this._actionButtons[o].callback);for(this._actionButtons=[];u.firstChild;)u.removeChild(u.firstChild);for(var f=0;f<h;f++)"enabled"in d[f]&&!d[f].enabled||(s=L.DomUtil.create("li","",u),c=this._createButton({title:d[f].title,text:d[f].text,container:s,callback:d[f].callback,context:d[f].context}),this._actionButtons.push({button:c,callback:d[f].callback}))},_showActionsToolbar:function(){var n=this._activeMode.buttonIndex,s=this._lastButtonIndex,o=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=o+"px",n===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),n===s&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(n){this._map=n,this._popupPane=n._panes.popupPane,this._visible=!1,this._container=n.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(n){return this._container?(n.subtext=n.subtext||"",n.subtext.length!==0||this._singleLineLabel?n.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(n.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+n.subtext+"</span><br />":"")+"<span>"+n.text+"</span>",n.text||n.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(n){var s=this._map.latLngToLayerPoint(n),o=this._container;return this._container&&(this._visible&&(o.style.visibility="inherit"),L.DomUtil.setPosition(o,s)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(n){for(var s in this.options)this.options.hasOwnProperty(s)&&n[s]&&(n[s]=L.extend({},this.options[s],n[s]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,n)},getModeHandlers:function(n){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(n,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(n,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(n,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(n,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(n,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(n,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(n){return[{enabled:n.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:n.completeShape,context:n},{enabled:n.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:n.deleteLastVertex,context:n},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(n){L.setOptions(this,n);for(var s in this._modes)this._modes.hasOwnProperty(s)&&n.hasOwnProperty(s)&&this._modes[s].handler.setOptions(n[s])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(n){n.edit&&(n.edit.selectedPathOptions===void 0&&(n.edit.selectedPathOptions=this.options.edit.selectedPathOptions),n.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,n.edit.selectedPathOptions)),n.remove&&(n.remove=L.extend({},this.options.remove,n.remove)),n.poly&&(n.poly=L.extend({},this.options.poly,n.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,n),this._selectedFeatureCount=0},getModeHandlers:function(n){var s=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(n,{featureGroup:s,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(n,{featureGroup:s}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(n){var s=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return n.removeAllLayers&&s.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),s},addToolbar:function(n){var s=L.Toolbar.prototype.addToolbar.call(this,n);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),s},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var n,s=this.options.featureGroup,o=s.getLayers().length!==0;this.options.edit&&(n=this._modes[L.EditToolbar.Edit.TYPE].button,o?L.DomUtil.removeClass(n,"leaflet-disabled"):L.DomUtil.addClass(n,"leaflet-disabled"),n.setAttribute("title",o?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(n=this._modes[L.EditToolbar.Delete.TYPE].button,o?L.DomUtil.removeClass(n,"leaflet-disabled"):L.DomUtil.addClass(n,"leaflet-disabled"),n.setAttribute("title",o?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(n,s){if(L.Handler.prototype.initialize.call(this,n),L.setOptions(this,s),this._featureGroup=s.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(n.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),n._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(n){this._revertLayer(n)},this)},save:function(){var n=new L.LayerGroup;this._featureGroup.eachLayer(function(s){s.edited&&(n.addLayer(s),s.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:n})},_backupLayer:function(n){var s=L.Util.stamp(n);this._uneditedLayerProps[s]||(n instanceof L.Polyline||n instanceof L.Polygon||n instanceof L.Rectangle?this._uneditedLayerProps[s]={latlngs:L.LatLngUtil.cloneLatLngs(n.getLatLngs())}:n instanceof L.Circle?this._uneditedLayerProps[s]={latlng:L.LatLngUtil.cloneLatLng(n.getLatLng()),radius:n.getRadius()}:(n instanceof L.Marker||n instanceof L.CircleMarker)&&(this._uneditedLayerProps[s]={latlng:L.LatLngUtil.cloneLatLng(n.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(n){var s=L.Util.stamp(n);n.edited=!1,this._uneditedLayerProps.hasOwnProperty(s)&&(n instanceof L.Polyline||n instanceof L.Polygon||n instanceof L.Rectangle?n.setLatLngs(this._uneditedLayerProps[s].latlngs):n instanceof L.Circle?(n.setLatLng(this._uneditedLayerProps[s].latlng),n.setRadius(this._uneditedLayerProps[s].radius)):(n instanceof L.Marker||n instanceof L.CircleMarker)&&n.setLatLng(this._uneditedLayerProps[s].latlng),n.fire("revert-edited",{layer:n}))},_enableLayerEdit:function(n){var s,o,l=n.layer||n.target||n;this._backupLayer(l),this.options.poly&&(o=L.Util.extend({},this.options.poly),l.options.poly=o),this.options.selectedPathOptions&&(s=L.Util.extend({},this.options.selectedPathOptions),s.maintainColor&&(s.color=l.options.color,s.fillColor=l.options.fillColor),l.options.original=L.extend({},l.options),l.options.editing=s),l instanceof L.Marker?(l.editing&&l.editing.enable(),l.dragging.enable(),l.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):l.editing.enable()},_disableLayerEdit:function(n){var s=n.layer||n.target||n;s.edited=!1,s.editing&&s.editing.disable(),delete s.options.editing,delete s.options.original,this._selectedPathOptions&&(s instanceof L.Marker?this._toggleMarkerHighlight(s):(s.setStyle(s.options.previousOptions),delete s.options.previousOptions)),s instanceof L.Marker?(s.dragging.disable(),s.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):s.editing.disable()},_onMouseMove:function(n){this._tooltip.updatePosition(n.latlng)},_onMarkerDragEnd:function(n){var s=n.target;s.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:s})},_onTouchMove:function(n){var s=n.originalEvent.changedTouches[0],o=this._map.mouseEventToLayerPoint(s),l=this._map.layerPointToLatLng(o);n.target.setLatLng(l)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(n,s){if(L.Handler.prototype.initialize.call(this,n),L.Util.setOptions(this,s),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(n.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(n){this._deletableLayers.addLayer(n),n.fire("revert-deleted",{layer:n})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(n){this._removeLayer({layer:n})},this),this.save()},_enableLayerDelete:function(n){(n.layer||n.target||n).on("click",this._removeLayer,this)},_disableLayerDelete:function(n){var s=n.layer||n.target||n;s.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(s)},_removeLayer:function(n){var s=n.layer||n.target||n;this._deletableLayers.removeLayer(s),this._deletedLayers.addLayer(s),s.fire("deleted")},_onMouseMove:function(n){this._tooltip.updatePosition(n.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);var ue=require("obsidian");nh();oi();var CI=require("obsidian");function H8(a){if(!a||Object.keys(a).length===0)return"";let t=new Set,e={};for(let[n,s]of Object.entries(a))s===""?(t.add(n),e[n]="__EMPTY_STRING_MARKER__"):e[n]=s;let r=(0,CI.stringifyYaml)(e);if(t.size>0)for(let n of t){let s=new RegExp(`^(${G8(n)}:\\s*)(__EMPTY_STRING_MARKER__|"__EMPTY_STRING_MARKER__"|'__EMPTY_STRING_MARKER__')\\s*$`,"gm");r=r.replace(s,'$1""')}return r}function G8(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ja(a,t){let e={valid:!0,lostFields:[],warnings:[]};if(!t)return e;let r=new Set(Object.keys(t)),n=new Set(Object.keys(a)),s=new Set(["position"]);for(let o of r)s.has(o)||n.has(o)||(e.valid=!1,e.lostFields.push(o),e.warnings.push(`Field "${o}" existed in original file but will be removed on save`));for(let[o,l]of Object.entries(a))(l===""||l===null||l===void 0)&&(r.has(o)||e.warnings.push(`Field "${o}" has empty value and may not persist correctly`));return e}function Es(a,t,e){let r=e?`[${e}]`:"[YamlSerializer]";if(t){let o=Ja(a,t);o.valid||console.warn(`${r} Field preservation issues detected:`,o.warnings),o.lostFields.length>0&&console.warn(`${r} These fields will be LOST:`,o.lostFields)}let n=Object.entries(a).filter(([o,l])=>l===""||l===null||l===void 0).map(([o])=>o);n.length>0&&console.debug(`${r} Preserving empty fields:`,n);let s=H8(a);for(let o of n)s.includes(`${o}:`)||console.error(`${r} FAILED to preserve empty field: ${o}`);return s}St();var jy=require("obsidian"),Yy=class{constructor(t,e){this.opts=t;this.getActiveStory=e}resolveTemplatePath(t){var c,u;let e=this.getActiveStory();if((t.includes("{storyName}")||t.includes("{storySlug}")||t.includes("{storyId}"))&&!e)throw new Error("No active story selected for template resolution.");let n=(c=e==null?void 0:e.name)!=null?c:"",s=(u=e==null?void 0:e.id)!=null?u:"",o=this.slugifyFolderName(n),l=t.split("{storyName}").join(n);return l=l.split("{storyId}").join(s),l=l.split("{storySlug}").join(o),(0,jy.normalizePath)(l)}sanitizeBaseFolderPath(t){if(!t)return"";let e=t.trim();if(e==="/"||e==="\\")return"";let r=e.replace(/^[\\/]+/,"").replace(/[\\/]+$/,"");return r?(0,jy.normalizePath)(r):""}slugifyFolderName(t){return t?t.replace(/[\\/:"*?<>|#^\[\]{}]+/g,"").trim().replace(/\s+/g," ").replace(/\s/g,"_"):""}getEntityFolder(t){let e=this.opts;if(e.enableCustomEntityFolders){let s=e.storyRootFolderTemplate?this.resolveTemplatePath(e.storyRootFolderTemplate):"",o=(l,c)=>{if(l&&l.trim())return this.resolveTemplatePath(l);if(s&&c)return(0,jy.normalizePath)(`${s}/${c}`)};if(t==="character"){let l=o(e.characterFolderPath,"Characters");if(l)return l}if(t==="location"){let l=o(e.locationFolderPath,"Locations");if(l)return l}if(t==="event"){let l=o(e.eventFolderPath,"Events");if(l)return l}if(t==="item"){let l=o(e.itemFolderPath,"Items");if(l)return l}if(t==="reference"){let l=o(e.referenceFolderPath,"References");if(l)return l}if(t==="chapter"){let l=o(e.chapterFolderPath,"Chapters");if(l)return l}if(t==="scene"){let l=o(e.sceneFolderPath,"Scenes");if(l)return l}if(t==="map"){let l=o(e.mapFolderPath,"Maps");if(l)return l}if(t==="culture"){let l=o(e.cultureFolderPath,"Cultures");if(l)return l}if(t==="faction"){let l=o(e.factionFolderPath,"Factions");if(l)return l}if(t==="economy"){let l=o(e.economyFolderPath,"Economies");if(l)return l}if(t==="magicSystem"){let l=o(e.magicSystemFolderPath,"MagicSystems");if(l)return l}if(t==="calendar"){let l=o(e.calendarFolderPath,"Calendars");if(l)return l}}if(e.enableOneStoryMode){let s=this.sanitizeBaseFolderPath(e.oneStoryBaseFolder||"StorytellerSuite"),o=s?`${s}/`:"";if(t==="character")return`${o}Characters`;if(t==="location")return`${o}Locations`;if(t==="event")return`${o}Events`;if(t==="item")return`${o}Items`;if(t==="reference")return`${o}References`;if(t==="chapter")return`${o}Chapters`;if(t==="scene")return`${o}Scenes`;if(t==="map")return`${o}Maps`;if(t==="culture")return`${o}Cultures`;if(t==="faction")return`${o}Factions`;if(t==="economy")return`${o}Economies`;if(t==="magicSystem")return`${o}MagicSystems`;if(t==="calendar")return`${o}Calendars`}let r=this.getActiveStory();if(!r)throw new Error("No active story selected.");let n=`StorytellerSuite/Stories/${r.name}`;if(t==="character")return`${n}/Characters`;if(t==="location")return`${n}/Locations`;if(t==="event")return`${n}/Events`;if(t==="item")return`${n}/Items`;if(t==="reference")return`${n}/References`;if(t==="chapter")return`${n}/Chapters`;if(t==="scene")return`${n}/Scenes`;if(t==="map")return`${n}/Maps`;if(t==="culture")return`${n}/Cultures`;if(t==="faction")return`${n}/Factions`;if(t==="economy")return`${n}/Economies`;if(t==="magicSystem")return`${n}/MagicSystems`;if(t==="calendar")return`${n}/Calendars`;throw new Error("Unknown entity type")}tryGetEntityFolder(t){try{return{path:this.getEntityFolder(t)}}catch(e){return{error:e!=null&&e.message?String(e.message):"Unknown error resolving folder"}}}resolveAll(){let t=["character","location","event","item","reference","chapter","scene","map","culture","faction","economy","magicSystem","calendar"],e={};for(let r of t)e[r]=this.tryGetEntityFolder(r);return e}};Nl();Zy();_m();var Di=require("obsidian");St();_m();var Jy=class extends Di.Modal{constructor(t,e,r){super(t),this.plugin=e,this.characters=r,this.modalEl.addClass("storyteller-list-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:w("characters")}),this.listContainer=t.createDiv("storyteller-list-container");let e=new Di.Setting(t).setName(w("search")).addText(r=>{r.setPlaceholder(w("searchX",w("characters"))).onChange(n=>this.renderList(n.toLowerCase(),this.listContainer))});this.renderList("",this.listContainer),new Di.Setting(t).addButton(r=>{let n=!!this.plugin.getActiveStory();r.setButtonText(w("createCharacter")).setCta().onClick(()=>{if(!this.plugin.getActiveStory()){new Di.Notice(w("selectOrCreateStoryFirst"));return}this.close(),new Ts(this.app,this.plugin,null,async s=>{await this.plugin.saveCharacter(s),new Di.Notice(w("created",w("character"),s.name)),new Di.Notice(w("noteCreatedWithSections"))}).open()}),n||r.setDisabled(!0).setTooltip(w("selectOrCreateStoryFirst"))})}renderList(t,e){e.empty();let r=this.characters.filter(n=>n.name.toLowerCase().includes(t)||(n.description||"").toLowerCase().includes(t)||(n.traits||[]).join(" ").toLowerCase().includes(t));if(r.length===0){e.createEl("p",{text:w("noCharactersFound")+(t?w("matchingFilter"):"")});return}r.forEach(n=>{let s=e.createDiv("storyteller-list-item"),o=s.createDiv("storyteller-list-item-info");if(o.createEl("strong",{text:n.name}),n.description){let c=n.description.substring(0,100),u=n.description.length>100?c+"...":c;o.createEl("p",{text:u})}let l=s.createDiv("storyteller-list-item-actions");new Di.ButtonComponent(l).setIcon("pencil").setTooltip(w("edit")).onClick(()=>{this.close(),new Ts(this.app,this.plugin,n,async c=>{await this.plugin.saveCharacter(c),new Di.Notice(w("updated",w("character"),c.name))}).open()}),new Di.ButtonComponent(l).setIcon("trash").setTooltip(w("delete")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteCharacterTrash",n.name))&&(n.filePath?(await this.plugin.deleteCharacter(n.filePath),this.characters=this.characters.filter(c=>c.filePath!==n.filePath),this.renderList(t,e)):new Di.Notice(w("errorCannotDeleteWithoutFilePath",w("character"))))}),new Di.ButtonComponent(l).setIcon("go-to-file").setTooltip(w("openNote")).onClick(()=>{if(!n.filePath){new Di.Notice(w("errorCannotOpenNoteWithoutFilePath",w("character")));return}let c=this.app.vault.getAbstractFileByPath(n.filePath);c instanceof Di.TFile?(this.app.workspace.getLeaf(!1).openFile(c),this.close()):new Di.Notice(w("workspaceLeafRevealError"))})})}onClose(){this.contentEl.empty()}};Sm();var Pi=require("obsidian");St();Sm();var Qy=class extends Pi.Modal{constructor(t,e,r){super(t),this.plugin=e,this.locations=r,this.modalEl.addClass("storyteller-list-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:w("locations")}),this.listContainer=t.createDiv("storyteller-list-container");let e=new Pi.Setting(t).setName(w("search")).addText(r=>{r.setPlaceholder(w("searchX",w("locations"))).onChange(n=>this.renderList(n.toLowerCase(),this.listContainer))});this.renderList("",this.listContainer),new Pi.Setting(t).addButton(r=>{let n=!!this.plugin.getActiveStory();r.setButtonText(w("createLocation")).setCta().onClick(()=>{if(!this.plugin.getActiveStory()){new Pi.Notice(w("selectOrCreateStoryFirst"));return}this.close(),new Cs(this.app,this.plugin,null,async s=>{await this.plugin.saveLocation(s),new Pi.Notice(w("created",w("location"),s.name)),new Pi.Notice(w("noteCreatedWithSections"))}).open()}),n||r.setDisabled(!0).setTooltip(w("selectOrCreateStoryFirst"))})}renderList(t,e){e.empty();let r=this.locations.filter(l=>l.name.toLowerCase().includes(t)||(l.description||"").toLowerCase().includes(t));if(r.length===0){e.createEl("p",{text:w("noLocationsFound")+(t?w("matchingFilter"):"")});return}let n=this.buildLocationHierarchy(r),s=r.filter(l=>!l.parentLocation),o=new Set;s.forEach(l=>{this.renderLocationWithChildren(l,e,t,n,o,0)}),r.forEach(l=>{o.has(l.name)||this.renderLocationWithChildren(l,e,t,n,o,0)})}buildLocationHierarchy(t){let e=new Map;return t.forEach(r=>{r.parentLocation&&(e.has(r.parentLocation)||e.set(r.parentLocation,[]),e.get(r.parentLocation).push(r))}),e}renderLocationWithChildren(t,e,r,n,s,o){if(s.has(t.name))return;s.add(t.name);let l=e.createDiv("storyteller-list-item");o>0&&(l.style.marginLeft=`${o*20}px`,l.style.borderLeft="2px solid var(--background-modifier-border)",l.style.paddingLeft="10px");let c=l.createDiv("storyteller-list-item-info"),u=c.createEl("strong",{text:t.name});t.parentLocation&&u.createSpan({text:` (within ${t.parentLocation})`,cls:"storyteller-parent-indicator"}),t.description&&c.createEl("p",{text:t.description.substring(0,100)+(t.description.length>100?"...":"")});let d=l.createDiv("storyteller-list-item-actions");new Pi.ButtonComponent(d).setIcon("pencil").setTooltip(w("edit")).onClick(()=>{this.close(),new Cs(this.app,this.plugin,t,async f=>{await this.plugin.saveLocation(f),new Pi.Notice(w("updated",w("location"),f.name))}).open()}),new Pi.ButtonComponent(d).setIcon("trash").setTooltip(w("delete")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteLocation",t.name))&&(t.filePath?(await this.plugin.deleteLocation(t.filePath),this.locations=this.locations.filter(f=>f.filePath!==t.filePath),this.renderList(r,e)):new Pi.Notice(w("errorCannotDeleteWithoutFilePath",w("location"))))}),new Pi.ButtonComponent(d).setIcon("go-to-file").setTooltip(w("openNote")).onClick(()=>{if(!t.filePath){new Pi.Notice(w("errorCannotOpenNoteWithoutFilePath",w("location")));return}let f=this.app.vault.getAbstractFileByPath(t.filePath);f instanceof Pi.TFile?(this.app.workspace.getLeaf(!1).openFile(f),this.close()):new Pi.Notice(w("workspaceLeafRevealError"))}),(n.get(t.name)||[]).forEach(f=>{this.renderLocationWithChildren(f,e,r,n,s,o+1)})}onClose(){this.contentEl.empty()}};uh();Dk();var ac=require("obsidian");St();var ua=require("obsidian");St();var Jo=class extends ua.Modal{constructor(t,e,r,n,s){super(t),this.plugin=e,this.image={...r},this.isNew=n,this.onSaveCallback=s,this.modalEl.addClass("storyteller-image-detail-modal")}getImageSrc(t){if(/^(https?:)?\/\//i.test(t)||t.startsWith("data:"))return t;let e=this.app.vault.getAbstractFileByPath(t);return e&&"stat"in e?this.app.vault.getResourcePath(e):t}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:this.isNew?w("addImageDetails"):w("editImageDetails")});let e=t.createDiv("storyteller-image-detail-container"),r=e.createDiv("storyteller-image-preview"),n=r.createEl("img");n.src=this.getImageSrc(this.image.filePath),n.alt=this.image.title||this.image.filePath,r.createEl("p",{text:this.image.filePath});let s=e.createDiv("storyteller-image-form");new ua.Setting(s).setName(w("title")).addText(o=>o.setValue(this.image.title||"").onChange(l=>{this.image.title=l||void 0})),new ua.Setting(s).setName(w("caption")).addText(o=>o.setValue(this.image.caption||"").onChange(l=>{this.image.caption=l||void 0})),new ua.Setting(s).setName(w("description")).addTextArea(o=>{o.setValue(this.image.description||"").onChange(l=>{this.image.description=l||void 0}),o.inputEl.rows=3}),new ua.Setting(s).setName(w("tags")).setDesc(w("commaSeparatedTags")).addText(o=>o.setValue((this.image.tags||[]).join(", ")).onChange(l=>{this.image.tags=l.split(",").map(c=>c.trim()).filter(c=>c.length>0)})),s.createEl("h3",{text:w("links")}),new ua.Setting(s).setName(w("characters")).setDesc(w("commaSeparatedCharacterNames")).addText(o=>o.setValue((this.image.linkedCharacters||[]).join(", ")).onChange(l=>{this.image.linkedCharacters=l.split(",").map(c=>c.trim()).filter(c=>c.length>0)})),new ua.Setting(s).setName(w("locations")).setDesc(w("commaSeparatedLocationNames")).addText(o=>o.setValue((this.image.linkedLocations||[]).join(", ")).onChange(l=>{this.image.linkedLocations=l.split(",").map(c=>c.trim()).filter(c=>c.length>0)})),new ua.Setting(s).setName(w("events")).setDesc(w("commaSeparatedEventNames")).addText(o=>o.setValue((this.image.linkedEvents||[]).join(", ")).onChange(l=>{this.image.linkedEvents=l.split(",").map(c=>c.trim()).filter(c=>c.length>0)})),new ua.Setting(s).setClass("storyteller-modal-buttons").addButton(o=>o.setButtonText(w("saveDetails")).setCta().onClick(async()=>{await this.plugin.updateGalleryImage(this.image),new ua.Notice(w("imageDetailsSaved",this.image.filePath)),this.onSaveCallback&&await this.onSaveCallback(),this.close()})).addButton(o=>o.setButtonText(w("removeFromGallery")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmRemoveImageFromGallery",this.image.filePath))&&(await this.plugin.deleteGalleryImage(this.image.id),new ua.Notice(w("imageRemovedFromGallery",this.image.filePath)),this.onSaveCallback&&await this.onSaveCallback(),this.close())}))}onClose(){this.contentEl.empty()}};var Pk=class extends ac.FuzzySuggestModal{constructor(t,e,r){super(t),this.plugin=e,this.onChoose=r,this.setPlaceholder(w("selectImageFilePh"))}async onOpen(){super.onOpen(),setTimeout(()=>{var t,e;if(this.inputEl){try{(t=this.setQuery)==null||t.call(this,"")}catch(r){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(r){}}try{(e=this.onInputChanged)==null||e.call(this)}catch(r){}},0),setTimeout(()=>{var t,e;if(this.inputEl){try{(t=this.setQuery)==null||t.call(this,"")}catch(r){}try{this.inputEl.dispatchEvent(new window.Event("input"))}catch(r){}}try{(e=this.onInputChanged)==null||e.call(this)}catch(r){}},50)}getSuggestions(t){let e=this.getItems();if(!t)return e.map(n=>({item:n,match:{score:0,matches:[]}}));let r=(0,ac.prepareFuzzySearch)(t);return e.map(n=>{let s=r(this.getItemText(n));return s?{item:n,match:s}:null}).filter(n=>!!n)}getItems(){return this.app.vault.getFiles().filter(t=>["png","jpg","jpeg","gif","bmp","svg","webp"].includes(t.extension.toLowerCase()))}getItemText(t){return t.path}onChooseItem(t,e){this.onChoose(t)}},R0=class extends ac.Modal{constructor(t,e){super(t),this.plugin=e,this.images=e.getGalleryImages(),this.modalEl.addClass("storyteller-gallery-modal")}getImageSrc(t){var e;return t.startsWith("http://")||t.startsWith("https://")||t.startsWith("//")?((e=this.plugin.settings.allowRemoteImages)!=null?e:!1)?t:"":this.app.vault.adapter.getResourcePath(t)}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:w("imageGallery")}),this.gridContainer=t.createDiv("storyteller-gallery-grid");let e=t.createDiv("storyteller-gallery-controls");new ac.Setting(e).setName(w("filter")).addText(r=>{r.setPlaceholder(w("filterImagesPh")).onChange(n=>this.renderGrid(n.toLowerCase(),this.gridContainer))}).addButton(r=>r.setButtonText(w("addImage")).setCta().onClick(()=>{new Pk(this.app,this.plugin,async n=>{let s={filePath:n.path},o=await this.plugin.addGalleryImage(s);new Jo(this.app,this.plugin,o,!1,async()=>{await this.refreshGallery()}).open()}).open()})),this.renderGrid("",this.gridContainer)}async refreshGallery(){this.images=this.plugin.getGalleryImages(),this.renderGrid("",this.gridContainer)}renderGrid(t,e){e.empty();let r=this.images.filter(n=>n.filePath.toLowerCase().includes(t)||(n.title||"").toLowerCase().includes(t)||(n.caption||"").toLowerCase().includes(t)||(n.description||"").toLowerCase().includes(t)||(n.tags||[]).join(" ").toLowerCase().includes(t)||(n.linkedCharacters||[]).join(" ").toLowerCase().includes(t)||(n.linkedLocations||[]).join(" ").toLowerCase().includes(t)||(n.linkedEvents||[]).join(" ").toLowerCase().includes(t));if(r.length===0){e.createEl("p",{text:w("noImagesFound")+(t?w("matchingFilter"):"")});return}r.forEach(n=>{let s=e.createDiv("storyteller-gallery-item"),o=s.createEl("img");o.src=this.getImageSrc(n.filePath),o.alt=n.title||n.filePath,o.title=n.title||n.filePath,s.addEventListener("click",()=>{this.close(),new Jo(this.app,this.plugin,n,!1,async()=>{await this.refreshGallery()}).open()})})}onClose(){this.contentEl.empty()}};var Qe=require("obsidian");St();_m();Sm();uh();Ig();var nf=require("obsidian");St();var sc=class extends nf.Modal{constructor(e,r,n,s){super(e);this.name="";this.description="";this.plugin=r,this.onSubmit=s,this.existingNames=n.map(o=>o.toLowerCase())}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:w("createNewStory")}),new nf.Setting(e).setName(w("storyName")).setDesc("Required. Must be unique.").addText(n=>{this.nameInput=n,n.setPlaceholder(w("enterStoryNamePh")).onChange(s=>{this.name=s.trim(),this.clearError()}),n.inputEl.addEventListener("keydown",s=>{s.key==="Enter"&&(s.preventDefault(),this.trySubmit())}),n.inputEl.focus()}),new nf.Setting(e).setName(w("description")).setDesc("Optional").addTextArea(n=>{this.descInput=n,n.setPlaceholder(w("describeStoryPh")).onChange(s=>{this.description=s}),n.inputEl.rows=3}),this.errorEl=e.createEl("div",{cls:"storyteller-modal-error"}),this.clearError();let r=new nf.Setting(e);r.addButton(n=>n.setButtonText(w("cancel")).onClick(()=>this.close())),r.addButton(n=>n.setButtonText(w("create")).setCta().onClick(()=>this.trySubmit()))}clearError(){this.errorEl.setText("")}showError(e){this.errorEl.setText(e),this.errorEl.style.color="var(--text-error, red)"}async trySubmit(){if(!this.name){this.showError("Story name is required."),this.nameInput.inputEl.focus();return}if(this.existingNames.includes(this.name.toLowerCase())){this.showError("A story with this name already exists."),this.nameInput.inputEl.focus();return}try{await this.onSubmit(this.name,this.description),this.close()}catch(e){this.showError("Failed to create story.")}}onClose(){this.contentEl.empty()}};var It=require("obsidian");St();ea();Qa();ru();Bl();iu();Cm();es();var Ag=class extends hr{constructor(e,r,n,s,o){super(e);this.allCharacters=[];this.allLocations=[];this.allEvents=[];this.allPlotItems=[];this.allGroups=[];this.allCultures=[];if(this.plugin=r,this.isNew=n===null,n)this.group={...n,members:n.members.map(l=>({...l})),groupRelationships:n.groupRelationships?[...n.groupRelationships]:[],territories:n.territories?[...n.territories]:[],colors:n.colors?[...n.colors]:[],linkedEvents:n.linkedEvents?[...n.linkedEvents]:[],subgroups:n.subgroups?[...n.subgroups]:[],customFields:n.customFields?{...n.customFields}:{}};else{let l=this.plugin.getActiveStory();if(!l)throw new Error("No active story selected");this.group={id:"",storyId:l.id,name:"",description:"",color:"",members:[],groupType:"collection",groupRelationships:[],territories:[],colors:[],linkedEvents:[],subgroups:[],customFields:{}}}this.onSubmit=s,this.onDelete=o,this.modalEl.addClass("storyteller-group-modal")}async onOpen(){super.onOpen(),await this.loadAllEntities(),this.isNew||await this.repairEntityLinks();let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:this.isNew?w("createNewGroup"):`${w("editGroup")}: ${this.group.name}`}),this.isNew&&new It.Setting(e).setName("Start from Template").setDesc("Optionally start with a pre-configured group template").addButton(s=>s.setButtonText("Choose Template").setTooltip("Select a group template").onClick(()=>{new Gr(this.app,this.plugin,async o=>{await this.applyTemplateToGroup(o),this.refresh(),new It.Notice(`Template "${o.name}" applied`)},"group").open()})),await this.loadAllEntities(),e.createEl("h3",{text:"Basic Information"}),new It.Setting(e).setName(w("name")).addText(s=>s.setPlaceholder(w("enterGroupName")).setValue(this.group.name).onChange(o=>{this.group.name=o})),new It.Setting(e).setName(w("description")).addTextArea(s=>{s.setPlaceholder(w("describeGroupPh")).setValue(this.group.description||"").onChange(o=>{this.group.description=o}),s.inputEl.rows=4}),new It.Setting(e).setName("Group Type").setDesc("Type of group or organization").addDropdown(s=>s.addOption("collection","Simple Collection").addOption("faction","Faction").addOption("organization","Organization").addOption("guild","Guild").addOption("political","Political").addOption("military","Military").addOption("religious","Religious").addOption("custom","Custom").setValue(this.group.groupType||"collection").onChange(o=>{this.group.groupType=o,this.onOpen()})),new It.Setting(e).setName(w("color")).addText(s=>s.setPlaceholder(w("colorPlaceholder")).setValue(this.group.color||"").onChange(o=>{this.group.color=o})),new It.Setting(e).setName(w("tags")||"Tags").setDesc("Comma-separated tags").addText(s=>s.setPlaceholder(w("tagsPh")).setValue((this.group.tags||[]).join(", ")).onChange(o=>{this.group.tags=o.split(",").map(l=>l.trim()).filter(Boolean)}));let r=null;new It.Setting(e).setName(w("profileImage")).then(s=>{r=s.descEl.createEl("small",{text:`Current: ${this.group.profileImagePath||"None"}`}),s.descEl.addClass("storyteller-modal-setting-vertical")}).addButton(s=>s.setButtonText(w("select")).setTooltip(w("selectFromGallery")).onClick(()=>{new zr(this.app,this.plugin,o=>{this.group.profileImagePath=o==null?void 0:o.filePath,r&&r.setText(`Current: ${this.group.profileImagePath||"None"}`)}).open()})).addButton(s=>s.setButtonText(w("upload")).setTooltip(w("uploadImage")).onClick(async()=>{let o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async()=>{var c;let l=(c=o.files)==null?void 0:c[0];if(l)try{await this.plugin.ensureFolder(this.plugin.settings.galleryUploadFolder);let u=l.name.replace(/[\\/:"*?<>|#^[\]]+/g,"").replace(/\s+/g,"_"),d=`${this.plugin.settings.galleryUploadFolder}/${Date.now()}_${u}`,h=await l.arrayBuffer();await this.app.vault.createBinary(d,h),this.group.profileImagePath=d,r&&r.setText(`Current: ${d}`),new It.Notice(w("imageUploaded",u))}catch(u){console.error("Upload failed",u),new It.Notice(w("errorUploadingImage"))}},o.click()})).addButton(s=>s.setIcon("cross").setTooltip(w("clearImage")).setClass("mod-warning").onClick(()=>{this.group.profileImagePath=void 0,r&&r.setText("Current: None")})),e.createEl("h3",{text:w("members")}),this.renderMemberSelectors(e),this.group.groupType&&this.group.groupType!=="collection"&&(e.createEl("h3",{text:"Faction Details"}),new It.Setting(e).setName("History").setDesc("Origin and historical background").addTextArea(s=>{s.setValue(this.group.history||"").onChange(o=>{this.group.history=o}),s.inputEl.rows=4}),new It.Setting(e).setName("Structure").setDesc("Organizational hierarchy and leadership").addTextArea(s=>{s.setValue(this.group.structure||"").onChange(o=>{this.group.structure=o}),s.inputEl.rows=4}),new It.Setting(e).setName("Goals").setDesc("Objectives and motivations").addTextArea(s=>{s.setValue(this.group.goals||"").onChange(o=>{this.group.goals=o}),s.inputEl.rows=4}),new It.Setting(e).setName("Resources").setDesc("Available assets and capabilities").addTextArea(s=>{s.setValue(this.group.resources||"").onChange(o=>{this.group.resources=o}),s.inputEl.rows=4}),new It.Setting(e).setName("Strength").setDesc("Overall power level or description").addText(s=>s.setValue(this.group.strength||"").onChange(o=>{this.group.strength=o})),new It.Setting(e).setName("Status").setDesc("Current state (active, dormant, disbanded, etc.)").addText(s=>s.setValue(this.group.status||"").onChange(o=>{this.group.status=o})),e.createEl("h3",{text:"Power & Influence"}),new It.Setting(e).setName("Military Power").setDesc("Military strength (0-100)").addSlider(s=>s.setLimits(0,100,1).setValue(this.group.militaryPower||50).setDynamicTooltip().onChange(o=>{this.group.militaryPower=o})),new It.Setting(e).setName("Economic Power").setDesc("Economic influence (0-100)").addSlider(s=>s.setLimits(0,100,1).setValue(this.group.economicPower||50).setDynamicTooltip().onChange(o=>{this.group.economicPower=o})),new It.Setting(e).setName("Political Influence").setDesc("Political power (0-100)").addSlider(s=>s.setLimits(0,100,1).setValue(this.group.politicalInfluence||50).setDynamicTooltip().onChange(o=>{this.group.politicalInfluence=o})),e.createEl("h3",{text:"Identity & Symbols"}),new It.Setting(e).setName("Colors").setDesc("Faction colors (comma-separated)").addText(s=>s.setValue((this.group.colors||[]).join(", ")).onChange(o=>{this.group.colors=o.split(",").map(l=>l.trim()).filter(Boolean)})),new It.Setting(e).setName("Emblem").setDesc("Symbol or emblem description").addText(s=>s.setValue(this.group.emblem||"").onChange(o=>{this.group.emblem=o})),new It.Setting(e).setName("Motto").setDesc("Slogan or motto").addText(s=>s.setValue(this.group.motto||"").onChange(o=>{this.group.motto=o})),new It.Setting(e).setName("Territories").setDesc("Controlled territories (comma-separated)").addTextArea(s=>{s.setValue((this.group.territories||[]).join(", ")).onChange(o=>{this.group.territories=o.split(",").map(l=>l.trim()).filter(Boolean)}),s.inputEl.rows=3}),e.createEl("h3",{text:"Relationships"}),this.group.groupRelationships||(this.group.groupRelationships=[]),e.createEl("h4",{text:"Inter-Group Relationships",cls:"storyteller-subsection-header"}),this.group.groupRelationships.forEach((s,o)=>{let l=new It.Setting(e).setName(`Relationship ${o+1}`).addDropdown(c=>{c.addOption("","Select group..."),this.allGroups.filter(u=>u.id!==this.group.id).forEach(u=>c.addOption(u.name,u.name)),c.setValue(s.groupName||"").onChange(u=>{s.groupName=u})}).addDropdown(c=>{c.addOption("allied","Allied").addOption("friendly","Friendly").addOption("neutral","Neutral").addOption("rival","Rival").addOption("hostile","Hostile").addOption("at-war","At War").setValue(s.relationshipType||"neutral").onChange(u=>{s.relationshipType=u})}).addButton(c=>c.setIcon("trash").setTooltip("Remove").onClick(()=>{this.group.groupRelationships=this.group.groupRelationships.filter((u,d)=>d!==o),this.onOpen()}))}),new It.Setting(e).addButton(s=>s.setButtonText("Add Group Relationship").onClick(()=>{this.group.groupRelationships||(this.group.groupRelationships=[]),this.group.groupRelationships.push({groupName:"",relationshipType:"neutral"}),this.onOpen()})),new It.Setting(e).setName("Linked Culture").setDesc("Associated culture").addDropdown(s=>{s.addOption("","None"),this.allCultures.forEach(o=>s.addOption(o.name,o.name)),s.setValue(this.group.linkedCulture||"").onChange(o=>{this.group.linkedCulture=o||void 0})}),new It.Setting(e).setName("Parent Group").setDesc("Larger organization this group belongs to").addDropdown(s=>{s.addOption("","None"),this.allGroups.filter(o=>o.id!==this.group.id).forEach(o=>s.addOption(o.name,o.name)),s.setValue(this.group.parentGroup||"").onChange(o=>{this.group.parentGroup=o||void 0})}),new It.Setting(e).setName("Subgroups").setDesc("Smaller groups within this organization (comma-separated)").addTextArea(s=>{s.setValue((this.group.subgroups||[]).join(", ")).onChange(o=>{this.group.subgroups=o.split(",").map(l=>l.trim()).filter(Boolean)}),s.inputEl.rows=2}),e.createEl("h3",{text:"Custom Fields"}),this.group.customFields||(this.group.customFields={}),Object.entries(this.group.customFields).forEach(([s,o])=>{new It.Setting(e).setName("Field").addText(l=>{let c=s;l.setValue(s).setPlaceholder("Field name").onChange(u=>{if(u&&u!==c){let d=this.group.customFields[c];delete this.group.customFields[c],this.group.customFields[u]=d}})}).addText(l=>l.setValue(o).setPlaceholder("Field value").onChange(c=>{this.group.customFields[s]=c})).addButton(l=>l.setIcon("trash").setTooltip("Remove field").onClick(()=>{delete this.group.customFields[s],this.onOpen()}))}),new It.Setting(e).addButton(s=>s.setButtonText("Add Custom Field").onClick(()=>{this.group.customFields||(this.group.customFields={});let o=Object.keys(this.group.customFields).length+1;this.group.customFields[`field${o}`]="",this.onOpen()})));let n=new It.Setting(e).setClass("storyteller-modal-buttons");n.addButton(s=>s.setButtonText(this.isNew?w("createGroupBtn"):w("saveChanges")).setCta().onClick(async()=>{var u,d,h,f,m,g,y,v;if(!this.group.name.trim()){new It.Notice(w("groupNameRequired"));return}let o=this.plugin.getGroups(),l=this.group.name.trim().toLowerCase();if(o.some(E=>E.name.trim().toLowerCase()===l&&(!this.group.id||E.id!==this.group.id))){new It.Notice(w("groupNameExists"));return}if(this.isNew){let E=await this.plugin.createGroup(this.group.name,this.group.description,this.group.color);this.group.id=E.id,await this.plugin.updateGroup(this.group.id,{description:this.group.description,color:this.group.color,name:this.group.name});let C=this.plugin.getGroups().find(_=>_.id===this.group.id);C&&(Object.assign(C,this.group),await this.plugin.saveSettings(),(d=(u=this.plugin).emitGroupsChanged)==null||d.call(u));for(let _ of this.group.members)await this.plugin.addMemberToGroup(E.id,_.type,_.id);for(let _ of this.group.members)await((f=(h=this.plugin).addGroupIdToEntity)==null?void 0:f.call(h,_.type,_.id,this.group.id))}else{await this.plugin.updateGroup(this.group.id,{name:this.group.name,description:this.group.description,color:this.group.color});let E=this.plugin.getGroups().find(C=>C.id===this.group.id);E&&(Object.assign(E,this.group),await this.plugin.saveSettings(),(g=(m=this.plugin).emitGroupsChanged)==null||g.call(m)),await this.syncMembers();for(let C of this.group.members)await((v=(y=this.plugin).addGroupIdToEntity)==null?void 0:v.call(y,C.type,C.id,this.group.id))}this.onSubmit&&await this.onSubmit(this.group),this.close()})),!this.isNew&&this.onDelete&&n.addButton(s=>s.setButtonText(w("deleteGroup")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteGroup",this.group.name))&&(await this.onDelete(this.group.id),this.close())}))}async loadAllEntities(){this.allCharacters=await this.plugin.listCharacters(),this.allLocations=await this.plugin.listLocations(),this.allEvents=await this.plugin.listEvents(),this.allPlotItems=await this.plugin.listPlotItems(),this.allGroups=this.plugin.getGroups(),this.allCultures=await this.plugin.listCultures()}async repairEntityLinks(){let e=[],r=[],n=[],s=!1;for(let o of[...this.group.members]){let l=!1,c=null,u,d=[];switch(o.type){case"character":d=this.allCharacters;break;case"location":d=this.allLocations;break;case"event":d=this.allEvents;break;case"item":d=this.allPlotItems;break}if(c=d.find(h=>(h.id||h.name)===o.id),c&&(l=!0,!c.id||o.id===c.name)){let h=c.id||c.name;h!==o.id&&(o.id=h,s=!0,r.push(`${o.type}: "${c.name}" (updated reference)`))}if(!l){let h=o.id.toLowerCase();c=d.find(f=>f.name&&f.name.toLowerCase()===h||f.id&&f.id.toLowerCase()===h),c&&(l=!0,u=c.id||c.name,u&&(o.id=u,s=!0,r.push(`${o.type}: "${c.name}" (case mismatch fixed)`)))}if(!l){let h=o.id.trim().replace(/[^a-zA-Z0-9]/g,"").toLowerCase();c=d.find(f=>{let m=(f.name||"").trim().replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),g=(f.id||"").trim().replace(/[^a-zA-Z0-9]/g,"").toLowerCase();return m===h||g===h}),c&&(l=!0,u=c.id||c.name,u&&(o.id=u,s=!0,r.push(`${o.type}: "${c.name}" (name normalized)`)))}l||(e.push(`${o.type}: "${o.id}"`),n.push(o),s=!0)}n.length>0&&(this.group.members=this.group.members.filter(o=>!n.some(l=>l.type===o.type&&l.id===o.id))),s&&this.group.id&&(await this.plugin.updateGroup(this.group.id,this.group),await this.plugin.saveSettings()),r.length>0&&(new It.Notice(`Repaired ${r.length} entity link(s) in group "${this.group.name}"`),console.log("Repaired entity links:",r)),e.length>0&&(new It.Notice(`Removed ${e.length} broken link(s) from group "${this.group.name}". Check console for details.`,5e3),console.warn(`Broken entity links removed from group "${this.group.name}":`,e))}renderMemberSelectors(e){let r=(f,m)=>this.group.members.some(g=>g.type===f&&g.id===m),n=new It.Setting(e).setName(w("characters")),s=n.controlEl.createDiv("group-tag-list");this.group.members.filter(f=>f.type==="character").forEach(f=>{let m=this.allCharacters.find(g=>(g.id||g.name)===f.id);if(m){let g=s.createSpan({cls:"group-tag"}),y=g.createEl("a",{text:m.name,cls:"group-member-link"});y.onclick=E=>{E.preventDefault();let{CharacterModal:C}=(_m(),Do(zI));new C(this.app,this.plugin,m,async()=>{}).open()};let v=g.createSpan({text:" \xD7",cls:"remove-group-btn"});v.onclick=async()=>{this.group.members=this.group.members.filter(E=>!(E.type==="character"&&E.id===f.id)),await this.plugin.removeMemberFromGroup(this.group.id,"character",f.id),this.onOpen()}}}),n.addButton(f=>{f.setButtonText(w("add")).setCta().onClick(()=>{new Fn(this.app,this.plugin,async m=>{m&&!r("character",m.id||m.name)&&(this.group.members.push({type:"character",id:m.id||m.name}),!this.isNew&&this.group.id&&await this.plugin.addMemberToGroup(this.group.id,"character",m.id||m.name),this.onOpen())}).open()})});let o=new It.Setting(e).setName(w("locations")),l=o.controlEl.createDiv("group-tag-list");this.group.members.filter(f=>f.type==="location").forEach(f=>{let m=this.allLocations.find(g=>(g.id||g.name)===f.id);if(m){let g=l.createSpan({cls:"group-tag"}),y=g.createEl("a",{text:m.name,cls:"group-member-link"});y.onclick=E=>{E.preventDefault();let{LocationModal:C}=(Sm(),Do(HI));new C(this.app,this.plugin,m,async()=>{}).open()};let v=g.createSpan({text:" \xD7",cls:"remove-group-btn"});v.onclick=async()=>{this.group.members=this.group.members.filter(E=>!(E.type==="location"&&E.id===f.id)),await this.plugin.removeMemberFromGroup(this.group.id,"location",f.id),this.onOpen()}}}),o.addButton(f=>{f.setButtonText(w("add")).setCta().onClick(()=>{new fn(this.app,this.plugin,async m=>{m&&!r("location",m.id||m.name)&&(this.group.members.push({type:"location",id:m.id||m.name}),!this.isNew&&this.group.id&&await this.plugin.addMemberToGroup(this.group.id,"location",m.id||m.name),this.onOpen())}).open()})});let c=new It.Setting(e).setName(w("events")),u=c.controlEl.createDiv("group-tag-list");this.group.members.filter(f=>f.type==="event").forEach(f=>{let m=this.allEvents.find(g=>(g.id||g.name)===f.id);if(m){let g=u.createSpan({cls:"group-tag"}),y=g.createEl("a",{text:m.name,cls:"group-member-link"});y.onclick=E=>{E.preventDefault();let{EventModal:C}=(uh(),Do(VI));new C(this.app,this.plugin,m,async()=>{}).open()};let v=g.createSpan({text:" \xD7",cls:"remove-group-btn"});v.onclick=async()=>{this.group.members=this.group.members.filter(E=>!(E.type==="event"&&E.id===f.id)),await this.plugin.removeMemberFromGroup(this.group.id,"event",f.id),this.onOpen()}}}),c.addButton(f=>{f.setButtonText(w("add")).setCta().onClick(()=>{new Rn(this.app,this.plugin,async m=>{m&&!r("event",m.id||m.name)&&(this.group.members.push({type:"event",id:m.id||m.name}),!this.isNew&&this.group.id&&await this.plugin.addMemberToGroup(this.group.id,"event",m.id||m.name),this.onOpen())}).open()})});let d=new It.Setting(e).setName(w("items")),h=d.controlEl.createDiv("group-tag-list");this.group.members.filter(f=>f.type==="item").forEach(f=>{let m=this.allPlotItems.find(g=>(g.id||g.name)===f.id);if(m){let g=h.createSpan({cls:"group-tag"}),y=g.createEl("a",{text:m.name,cls:"group-member-link"});y.onclick=E=>{E.preventDefault();let{PlotItemModal:C}=(Ig(),Do(Mz));new C(this.app,this.plugin,m,async()=>{}).open()};let v=g.createSpan({text:" \xD7",cls:"remove-group-btn"});v.onclick=async()=>{this.group.members=this.group.members.filter(E=>!(E.type==="item"&&E.id===f.id)),await this.plugin.removeMemberFromGroup(this.group.id,"item",f.id),this.onOpen()}}}),d.addButton(f=>{f.setButtonText(w("add")).setCta().onClick(()=>{new nu(this.app,this.plugin,async m=>{let g=m.id||m.name;m&&!this.group.members.some(y=>y.type==="item"&&y.id===g)&&(this.group.members.push({type:"item",id:g}),!this.isNew&&this.group.id&&await this.plugin.addMemberToGroup(this.group.id,"item",g),this.onOpen())}).open()})})}async syncMembers(){let e=this.plugin.getGroups().find(r=>r.id===this.group.id);if(e){for(let r of e.members)this.group.members.some(n=>n.type===r.type&&n.id===r.id)||await this.plugin.removeMemberFromGroup(e.id,r.type,r.id);for(let r of this.group.members)e.members.some(n=>n.type===r.type&&n.id===r.id)||await this.plugin.addMemberToGroup(e.id,r.type,r.id)}}async applyTemplateToGroup(e){if(!e.entities.groups||e.entities.groups.length===0){new It.Notice("This template does not contain any groups");return}let r=e.entities.groups[0],{templateId:n,sectionContent:s,customYamlFields:o,id:l,filePath:c,storyId:u,...d}=r;if(Object.assign(this.group,d),o&&Object.assign(this.group,o),s)for(let[h,f]of Object.entries(s)){let m=h.toLowerCase().replace(/\s+/g,"");this.group[m]=f}this.group.members=[],this.group.territories=[],this.group.linkedEvents=[],this.group.parentGroup=void 0,this.group.subgroups=[],this.group.groupRelationships=[],this.group.linkedCulture=void 0,this.group.connections=[]}refresh(){this.onOpen()}onClose(){this.contentEl.empty()}};Xy();H0();var zs="storyteller-dashboard-view",iE=class extends Qe.ItemView{constructor(e,r){super(e);this.currentFilter="";this.fileInput=null;this.activeTabId="characters";this.tabHeaderRibbonEl=null;this.tabsResizeObserver=null;this.currentSearchInput=null;this.debouncedSearch=null;this.isUserTyping=!1;this.typingTimer=null;this.dismissalTimer=null;this.networkGraphRenderer=null;this.templateFilter={showBuiltIn:!0,showCustom:!0};this.templatesCache=[];this.plugin=r,this.tabs=[{id:"characters",label:w("characters"),renderFn:this.renderCharactersContent.bind(this)},{id:"locations",label:w("locations"),renderFn:this.renderLocationsContent.bind(this)},{id:"events",label:w("timeline"),renderFn:this.renderEventsContent.bind(this)},{id:"items",label:w("items"),renderFn:this.renderItemsContent.bind(this)},{id:"network",label:w("networkGraph"),renderFn:this.renderNetworkContent.bind(this)},{id:"gallery",label:w("gallery"),renderFn:this.renderGalleryContent.bind(this)},{id:"groups",label:w("groups"),renderFn:this.renderGroupsContent.bind(this)},{id:"references",label:w("references"),renderFn:this.renderReferencesContent.bind(this)},{id:"chapters",label:w("chapters"),renderFn:this.renderChaptersContent.bind(this)},{id:"scenes",label:w("scenes"),renderFn:this.renderScenesContent.bind(this)},{id:"cultures",label:w("cultures"),renderFn:this.renderCulturesContent.bind(this)},{id:"economies",label:w("economies"),renderFn:this.renderEconomiesContent.bind(this)},{id:"magicsystems",label:w("magicSystems"),renderFn:this.renderMagicSystemsContent.bind(this)},{id:"templates",label:w("templates"),renderFn:this.renderTemplatesContent.bind(this)}],this.debouncedRefreshActiveTab=(0,Qe.debounce)(this.refreshActiveTab.bind(this),200,!0),this.debouncedSearch=(0,Qe.debounce)(async n=>{try{await n(this.currentFilter),Et.isMobile()&&this.currentSearchInput&&document.activeElement!==this.currentSearchInput&&setTimeout(()=>{this.currentSearchInput&&this.currentSearchInput.focus()},50)}catch(s){console.error("Storyteller Suite: Error in debounced search:",s)}},Et.getSearchDebounceDelay())}markSearchInputDismissal(){this.currentSearchInput&&(this.currentSearchInput.setAttribute("data-user-dismissed","true"),this.dismissalTimer&&clearTimeout(this.dismissalTimer),this.dismissalTimer=window.setTimeout(()=>{this.currentSearchInput&&this.currentSearchInput.removeAttribute("data-user-dismissed"),this.dismissalTimer=null},500))}getImageSrc(e){var r;return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("data:")||e.startsWith("app://")||e.startsWith("obsidian://")||e.startsWith("//")?(e.startsWith("http")||e.startsWith("//"))&&!((r=this.plugin.settings.allowRemoteImages)!=null?r:!1)?"":e:this.app.vault.adapter.getResourcePath(e)}resolveLocationName(e,r){let n=r.find(o=>o.id===e);if(n)return n.name;let s=r.find(o=>o.name===e);return s?s.name:e}getViewType(){return zs}getDisplayText(){return w("dashboardTitle")}getIcon(){return"book-open"}registerVaultEventListeners(){this.registerEvent(this.app.vault.on("create",e=>{this.isRelevantFile(e.path)&&this.debouncedRefreshActiveTab()})),this.registerEvent(this.app.vault.on("modify",e=>{this.isRelevantFile(e.path)&&this.debouncedRefreshActiveTab()})),this.registerEvent(this.app.vault.on("delete",e=>{this.isRelevantFile(e.path)&&this.debouncedRefreshActiveTab()})),this.registerEvent(this.app.vault.on("rename",(e,r)=>{(this.isRelevantFile(e.path)||this.isRelevantFile(r))&&this.debouncedRefreshActiveTab()})),this.registerEvent(this.app.metadataCache.on("changed",e=>{this.isRelevantFile(e.path)&&this.debouncedRefreshActiveTab()}))}isRelevantFile(e){try{let r=this.plugin.getEntityFolder("character"),n=this.plugin.getEntityFolder("location"),s=this.plugin.getEntityFolder("event"),o=this.plugin.getEntityFolder("item"),l=this.plugin.getEntityFolder("reference"),c=this.plugin.getEntityFolder("chapter"),u=this.plugin.getEntityFolder("scene");return e.startsWith(r+"/")||e.startsWith(n+"/")||e.startsWith(s+"/")||e.startsWith(o+"/")||e.startsWith(l+"/")||e.startsWith(c+"/")||e.startsWith(u+"/")||e.startsWith(this.plugin.settings.galleryUploadFolder+"/")}catch(r){return!1}}async refreshActiveTab(){var s;if(!this.tabContentContainer)return;if(Et.isMobile()&&this.isUserTyping){console.log("Storyteller Suite: Skipping refresh while user is typing on mobile");return}let e=((s=this.currentSearchInput)==null?void 0:s.value)||"",r=document.activeElement===this.currentSearchInput,n=this.tabs.find(o=>o.id===this.activeTabId);if(n)try{await n.renderFn(this.tabContentContainer),Et.isMobile()&&(e||r)&&setTimeout(()=>{this.currentSearchInput&&(e&&(this.currentSearchInput.value=e,this.currentFilter=e.toLowerCase()),r&&this.currentSearchInput.focus())},100)}catch(o){console.error(`Storyteller Suite: Error refreshing active tab ${this.activeTabId}:`,o)}}async onOpen(){var h,f;this.containerEl.style.height="100%",this.containerEl.style.overflow="visible",this.containerEl.style.display="flex",this.containerEl.style.flexDirection="column";let e=this.containerEl.children[1];e.empty(),e.addClass("storyteller-dashboard-view-container"),e.style.display="flex",e.style.flexDirection="column",e.style.height="100%",e.style.overflow="visible",e.style.minHeight="0",e.style.isolation="isolate",e.style.position="relative",Et.getMobileCssClasses().forEach(m=>{e.addClass(m)}),Et.isMobile()&&e.addClass("mobile-dashboard");let n=e.createDiv("storyteller-dashboard-header");n.style.zIndex="var(--layer-status-bar, 15)",n.style.background=getComputedStyle(document.body).getPropertyValue("--background-primary")||"var(--background-primary)",n.style.flexShrink="0";let s=n.createDiv("storyteller-dashboard-header-top");s.createEl("h2",{cls:"storyteller-dashboard-title"}).append(w("dashboardTitle"));let l=s.createDiv("storyteller-selector-button-group"),c=l.createEl("select",{cls:"storyteller-story-selector"});if(c.id="storyteller-story-selector",Et.isMobile()){let m=Et.getTouchTargetSize();c.style.minHeight=`${m}px`,c.style.fontSize=`${1.1*Et.getFontScaling()}rem`,c.style.width="100%"}if(this.plugin.settings.stories.forEach(m=>{let g=c.createEl("option",{text:m.name});g.value=m.id,m.id===this.plugin.settings.activeStoryId&&(g.selected=!0)}),this.plugin.settings.enableOneStoryMode&&this.plugin.settings.stories.length===0&&this.plugin.initializeOneStoryModeIfNeeded().then(()=>this.onOpen()),c.onchange=async m=>{let g=m.target.value;await this.plugin.setActiveStory(g),this.onOpen()},!this.plugin.settings.enableOneStoryMode){let m=l.createEl("button",{text:w("newStory"),cls:"storyteller-new-story-btn"});m.onclick=()=>{new sc(this.app,this.plugin,this.plugin.settings.stories.map(g=>g.name),async(g,y)=>{let v=await this.plugin.createStory(g,y);await this.plugin.setActiveStory(v.id),new window.Notice(`Story "${g}" created and activated.`),this.onOpen()}).open()}}this.tabHeaderContainer=e.createDiv("storyteller-dashboard-tabs"),this.tabHeaderContainer.setAttr("role","tablist"),this.tabHeaderContainer.style.zIndex="calc(var(--layer-status-bar, 15) - 1)",this.tabHeaderContainer.style.display="flex",this.tabHeaderContainer.style.alignItems="center",this.tabHeaderContainer.style.gap="0.25rem",this.tabHeaderContainer.style.width="100%",this.tabHeaderContainer.style.flexShrink="0",this.tabHeaderRibbonEl=this.tabHeaderContainer.createDiv("storyteller-tab-ribbon"),this.tabHeaderRibbonEl.style.display="flex",this.tabHeaderRibbonEl.style.gap="0.5rem",this.tabHeaderRibbonEl.style.alignItems="center",this.tabHeaderRibbonEl.style.whiteSpace="normal",this.tabHeaderRibbonEl.style.justifyContent="center",this.tabHeaderRibbonEl.style.alignContent="center",this.tabHeaderRibbonEl.style.flex="1 1 auto",this.tabHeaderRibbonEl.style.width="100%",this.tabsResizeObserver=new ResizeObserver(()=>{this.layoutTabs(),requestAnimationFrame(()=>{this.updateStickyOffsets(n)})}),this.tabsResizeObserver.observe(this.tabHeaderContainer),this.layoutTabs(),requestAnimationFrame(()=>{this.updateStickyOffsets(n)}),this.tabContentContainer=e.createDiv("storyteller-dashboard-content"),this.tabContentContainer.style.flex="1 1 auto",this.tabContentContainer.style.minHeight="0",this.tabContentContainer.style.overflowY="auto",this.tabContentContainer.style.overflowX="hidden",this.tabContentContainer.style.height="auto";let u=this.getVisibleTabs(),d=((h=u.find(m=>m.id===this.activeTabId))==null?void 0:h.id)||((f=u[0])==null?void 0:f.id)||this.tabs[0].id;this.setActiveTab(d),this.registerVaultEventListeners(),this.registerEvent(this.app.workspace.on("resize",()=>{this.debouncedRefreshActiveTab(),this.layoutTabs(),requestAnimationFrame(()=>{this.updateStickyOffsets(n)})})),Et.isMobile()&&this.registerDomEvent(document,"click",m=>{try{if(!m.target||!(m.target instanceof Node))return;this.currentSearchInput&&m.target!==this.currentSearchInput&&!this.currentSearchInput.contains(m.target)&&(this.markSearchInputDismissal(),this.currentSearchInput.blur())}catch(g){console.error("Storyteller Suite: Error in mobile keyboard dismissal handler:",g)}}),await this.renderCharactersContent(this.tabContentContainer)}updateStickyOffsets(e){try{if(!this.tabHeaderContainer||!e)return;this.tabHeaderContainer.style.display="flex"}catch(r){console.warn("Storyteller: failed to update layout",r)}}getTabDisplayMode(){var r,n;let e=(n=(r=this.tabHeaderContainer)==null?void 0:r.clientWidth)!=null?n:0;return e<320?"tiny":e<480?"compact":"normal"}getVisibleTabs(){let e=this.plugin.settings.hiddenDashboardTabs||[];return this.tabs.filter(r=>!e.includes(r.id))}layoutTabs(){if(!this.tabHeaderContainer||!this.tabHeaderRibbonEl)return;this.tabHeaderRibbonEl.style.flexWrap="wrap",this.tabHeaderRibbonEl.style.rowGap="6px",this.tabHeaderRibbonEl.empty();let r=this.getTabDisplayMode()==="normal"?"normal":"compact",n=this.getVisibleTabs();for(let s of n){let o=this.createTabButtonEl(s,r,!1);this.tabHeaderRibbonEl.appendChild(o)}this.syncActiveTabStyles()}createTabButtonEl(e,r,n=!1){let s=document.createElement("button");s.className="storyteller-tab-header",s.setAttribute("role","tab"),s.dataset.tabId=e.id,s.title=r==="compact"?e.label:"",s.style.display="inline-flex",s.style.alignItems="center",s.style.justifyContent="center",s.style.gap="0.25rem",s.style.padding="6px 10px",s.style.borderRadius="6px",n||(s.style.flex="0 1 auto",s.style.minWidth="96px",s.style.maxWidth="220px");let o=document.createElement("span");return o.textContent=e.label,o.style.display="inline",s.appendChild(o),n||s.addEventListener("click",async()=>{await this.setActiveTab(e.id)}),s}async setActiveTab(e){let r=this.tabs.find(n=>n.id===e);r&&(this.activeTabId=e,this.currentFilter="",this.currentSearchInput=null,await r.renderFn(this.tabContentContainer),this.syncActiveTabStyles())}syncActiveTabStyles(){var r,n;if(!this.tabHeaderRibbonEl)return;((n=(r=this.tabHeaderContainer)==null?void 0:r.querySelectorAll(".storyteller-tab-header"))!=null?n:[]).forEach(s=>{let o=s,l=o.dataset.tabId===this.activeTabId;o.classList.toggle("active",!!l),o.setAttribute("aria-selected",l?"true":"false"),o.setAttribute("tabindex",l?"0":"-1"),o.style.background=l?"var(--background-modifier-hover)":"transparent",o.style.outline="none"})}async renderCharactersContent(e){e.empty(),this.renderHeaderControls(e,w("characters"),async r=>{this.currentFilter=r,await this.renderCharactersList(e)},()=>{new Ts(this.app,this.plugin,null,async r=>{await this.plugin.saveCharacter(r),new Qe.Notice(`Character "${r.name}" created.`)}).open()}),await this.renderCharactersList(e)}async renderCharactersList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listCharacters()).filter(o=>o.name.toLowerCase().includes(this.currentFilter)||(o.description||"").toLowerCase().includes(this.currentFilter)||(o.traits||[]).join(" ").toLowerCase().includes(this.currentFilter)),s=e.createDiv("storyteller-list-container");if(n.length===0){let o=s.createEl("p",{text:w("noCharactersFound"),cls:"storyteller-empty-state"});o.style.color="var(--text-muted)",o.style.fontStyle="italic";return}this.renderCharacterList(n,s,e)}async renderLocationsContent(e){e.empty(),this.renderHeaderControls(e,w("locations"),async r=>{this.currentFilter=r,await this.renderLocationsList(e)},()=>{new Cs(this.app,this.plugin,null,async r=>{await this.plugin.saveLocation(r),new Qe.Notice(`Location "${r.name}" created.`)}).open()},w("createLocation")),await this.renderLocationsList(e)}async renderLocationsList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listLocations()).filter(o=>o.name.toLowerCase().includes(this.currentFilter)||(o.description||"").toLowerCase().includes(this.currentFilter)),s=e.createDiv("storyteller-list-container");if(n.length===0){s.createEl("p",{text:w("noLocationsFound")+(this.currentFilter?w("matchingFilter"):"")});return}this.renderLocationList(n,s,e)}async renderEventsContent(e){e.empty(),this.renderHeaderControls(e,w("events"),async r=>{this.currentFilter=r,await this.renderEventsList(e)},()=>{new ts(this.app,this.plugin,null,async r=>{await this.plugin.saveEvent(r),new Qe.Notice(`Event "${r.name}" created.`)}).open()},w("createNew"),r=>{r.addButton(n=>n.setButtonText(w("viewTimeline")).setCta().onClick(async()=>{let s=await this.plugin.listEvents(),{TimelineModal:o}=await Promise.resolve().then(()=>(Dk(),Lz));new o(this.app,this.plugin,s).open()}))}),await this.renderEventsList(e)}async renderEventsList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listEvents()).filter(l=>l.name.toLowerCase().includes(this.currentFilter)||(l.description||"").toLowerCase().includes(this.currentFilter)||(l.dateTime||"").toLowerCase().includes(this.currentFilter)||(l.location||"").toLowerCase().includes(this.currentFilter)),s=await this.plugin.listLocations(),o=e.createDiv("storyteller-list-container storyteller-timeline-container");if(n.length===0){o.createEl("p",{text:w("noEventsFound")+(this.currentFilter?w("matchingFilter"):"")});return}this.renderEventList(n,o,e,s)}async renderItemsContent(e){e.empty();let r=!1,n=e.createDiv("storyteller-controls-group"),s=new Qe.Setting(n).setName(w("filterItems")).addText(o=>o.setPlaceholder(w("searchX","items")).onChange(async l=>{this.currentFilter=l.toLowerCase(),await this.renderItemsList(e,r)}));new Qe.Setting(n).setName(w("plotCritical")).setDesc(w("filterX","bookmarked")).addToggle(o=>{o.setValue(r).onChange(async l=>{r=l,await this.renderItemsList(e,r)})}),new Qe.Setting(n).addButton(o=>{let l=!!this.plugin.getActiveStory();o.setButtonText(w("createNew")).setCta().onClick(()=>{if(!this.plugin.getActiveStory()){new Qe.Notice("Select or create a story first.");return}new Os(this.app,this.plugin,null,async c=>{await this.plugin.savePlotItem(c),new Qe.Notice(`Item "${c.name}" created.`)}).open()}),l||o.setDisabled(!0).setTooltip("Select or create a story first.")}),await this.renderItemsList(e,r)}async renderItemsList(e,r){let n=e.querySelector(".storyteller-list-container");n&&n.remove();let s=await this.plugin.listPlotItems(),o=await this.plugin.listLocations();r&&(s=s.filter(c=>c.isPlotCritical)),s=s.filter(c=>c.name.toLowerCase().includes(this.currentFilter)||(c.description||"").toLowerCase().includes(this.currentFilter));let l=e.createDiv("storyteller-list-container");if(s.length===0){l.createEl("p",{text:w("noItemsFound")});return}s.forEach(c=>{let u=l.createDiv("storyteller-list-item"),d=u.createDiv("storyteller-list-item-pfp");if(c.profileImagePath){let y=d.createEl("img");y.src=this.getImageSrc(c.profileImagePath),y.alt=c.name}else d.setText(c.isPlotCritical?"\u2605":"\u25CF");let h=u.createDiv("storyteller-list-item-info"),f=h.createEl("strong",{text:c.name});c.isPlotCritical&&(f.setText(`\u2605 ${c.name}`),f.style.color="var(--text-accent)"),c.description&&h.createEl("p",{text:c.description.substring(0,80)+"..."});let m=h.createDiv("storyteller-list-item-extra");if(c.currentOwner&&m.createSpan({text:`Owner: ${c.currentOwner}`}),c.currentLocation){c.currentOwner&&m.appendText(" \u2022 ");let y=this.resolveLocationName(c.currentLocation,o);m.createSpan({text:`Location: ${y}`})}let g=u.createDiv("storyteller-list-item-actions");this.addEditButton(g,()=>{new Os(this.app,this.plugin,c,async y=>{await this.plugin.savePlotItem(y),new Qe.Notice(`Item "${y.name}" updated.`)}).open()}),this.addDeleteButton(g,async()=>{confirm(`Are you sure you want to delete "${c.name}"?`)&&c.filePath&&await this.plugin.deletePlotItem(c.filePath)}),this.addOpenFileButton(g,c.filePath)})}async renderNetworkContent(e){let{NetworkGraphRenderer:r}=await Promise.resolve().then(()=>(Ww(),n3));this.networkGraphRenderer&&(this.networkGraphRenderer.destroy(),this.networkGraphRenderer=null),e.empty();let n=e.createDiv("storyteller-network-controls");n.style.marginBottom="1rem",n.style.padding="1rem",n.style.backgroundColor="var(--background-secondary)",n.style.borderRadius="8px",n.style.display="flex",n.style.gap="1rem",n.style.flexWrap="wrap",n.style.alignItems="center";let s=this.networkGraphRenderer,o=n.createDiv();o.style.flex="1 1 300px",o.style.minWidth="200px";let l=o.createEl("input",{type:"text",placeholder:w("searchEntities")});l.style.width="100%",l.style.padding="6px 12px",l.style.border="1px solid var(--background-modifier-border)",l.style.borderRadius="4px",l.style.backgroundColor="var(--background-primary)",l.style.color="var(--text-normal)",l.addEventListener("input",()=>{s&&(l.value?s.searchAndHighlight(l.value):s.clearSearch())});let c=n.createDiv();c.style.display="flex",c.style.gap="0.5rem";let u=($,k,N)=>{let G=c.createEl("button",{text:$});return G.title=k,G.style.padding="6px 12px",G.style.border="1px solid var(--background-modifier-border)",G.style.borderRadius="4px",G.style.backgroundColor="var(--background-primary)",G.style.color="var(--text-normal)",G.style.cursor="pointer",G.style.fontSize="14px",G.style.fontWeight="600",G.addEventListener("click",N),G.addEventListener("mouseenter",()=>{G.style.backgroundColor="var(--background-modifier-hover)"}),G.addEventListener("mouseleave",()=>{G.style.backgroundColor="var(--background-primary)"}),G};u("+",w("zoomIn"),()=>s==null?void 0:s.zoomIn()),u("\u2212",w("zoomOut"),()=>s==null?void 0:s.zoomOut()),u("\u22A1",w("fitToView"),()=>s==null?void 0:s.fitToView());let d=n.createDiv();d.style.display="flex",d.style.alignItems="center",d.style.gap="0.5rem";let h=d.createSpan({text:w("layout")+":"});h.style.fontSize="13px",h.style.color="var(--text-muted)";let f=d.createEl("select");f.style.padding="6px 12px",f.style.border="1px solid var(--background-modifier-border)",f.style.borderRadius="4px",f.style.backgroundColor="var(--background-primary)",f.style.color="var(--text-normal)",f.style.cursor="pointer",[{value:"cose",label:w("forceDirected")},{value:"circle",label:w("circle")},{value:"grid",label:w("grid")},{value:"concentric",label:w("concentric")}].forEach($=>{let k=f.createEl("option",{text:$.label,value:$.value})}),f.addEventListener("change",()=>{s&&s.changeLayout(f.value)});let g=n.createDiv();g.style.display="flex",g.style.gap="0.5rem",g.style.marginLeft="auto";let y=($,k,N)=>{let G=g.createEl("button",{text:$});return G.title=k,G.style.padding="6px 12px",G.style.border="1px solid var(--background-modifier-border)",G.style.borderRadius="4px",G.style.backgroundColor="var(--interactive-accent)",G.style.color="var(--text-on-accent)",G.style.cursor="pointer",G.style.fontSize="13px",G.style.fontWeight="500",G.addEventListener("click",N),G.addEventListener("mouseenter",()=>{G.style.backgroundColor="var(--interactive-accent-hover)"}),G.addEventListener("mouseleave",()=>{G.style.backgroundColor="var(--interactive-accent)"}),G};y(w("openInPanel"),w("openInPanel"),async()=>{await this.openNetworkGraphInPanel()}),y(w("openInModal"),w("openInModal"),async()=>{await this.openNetworkGraphInModal()});let v=e.createDiv("storyteller-network-filters");v.style.marginBottom="1rem",v.style.padding="1rem",v.style.backgroundColor="var(--background-secondary)",v.style.borderRadius="8px";let E={groups:[],timelineStart:void 0,timelineEnd:void 0,entityTypes:["character","location","event","item"]},C=this.plugin.getGroups();C.length>0&&new Qe.Setting(v).setName(w("filterByGroup")).setDesc(w("selectEntityTypes")).addDropdown($=>{$.addOption("",w("all")||"All"),C.forEach(k=>$.addOption(k.id,k.name)),$.onChange(async k=>{E.groups=k?[k]:[],s&&await s.applyFilters(E)})});let x=new Qe.Setting(v).setName(w("filterByEntityTypes")).setDesc(w("selectEntityTypes")).controlEl.createDiv("storyteller-entity-type-filters");x.style.display="flex",x.style.gap="1rem",x.style.flexWrap="wrap";let P=["character","location","event","item"];P.forEach($=>{let k=x.createDiv();k.style.display="flex",k.style.alignItems="center",k.style.gap="0.5rem";let N=k.createEl("input",{type:"checkbox"});N.checked=!0,N.id=`entity-type-${$}`,N.onchange=async()=>{N.checked?E.entityTypes.includes($)||E.entityTypes.push($):E.entityTypes=E.entityTypes.filter(W=>W!==$),s&&await s.applyFilters(E)};let G=k.createEl("label",{text:w($+"s")});G.htmlFor=`entity-type-${$}`,G.style.cursor="pointer"});let M=new Qe.Setting(v).setName(w("filterByTimeline")).setDesc(w("timelineStart")+w("timelineRangeSeparator")+w("timelineEnd")).controlEl.createDiv();M.style.display="flex",M.style.gap="0.5rem",M.style.alignItems="center";let O=M.createEl("input",{type:"date"});O.onchange=async()=>{E.timelineStart=O.value||void 0,s&&await s.applyFilters(E)},M.createSpan({text:"\u2014"});let R=M.createEl("input",{type:"date"});R.onchange=async()=>{E.timelineEnd=R.value||void 0,s&&await s.applyFilters(E)},new Qe.Setting(v).addButton($=>$.setButtonText(w("resetFilters")).onClick(async()=>{E={groups:[],timelineStart:void 0,timelineEnd:void 0,entityTypes:["character","location","event","item"]},O.value="",R.value="",P.forEach(k=>{let N=e.querySelector(`#entity-type-${k}`);N&&(N.checked=!0)}),s&&await s.applyFilters(E)})).addButton($=>$.setButtonText(w("exportAsPNG")).setCta().onClick(async()=>{s&&await s.exportAsImage("png")}));let F=e.createDiv("storyteller-network-graph-container");F.style.marginBottom="1rem";try{s=new r(F,this.plugin),await s.initializeCytoscape(),this.networkGraphRenderer=s}catch($){console.error("Error initializing network graph:",$),F.createEl("p",{text:"Error loading network graph. See console for details.",cls:"storyteller-empty-state"})}}async renderGalleryContent(e){e.empty();let r=async s=>{this.currentFilter=s,await this.renderGalleryList(e)},n=async()=>{await this.renderGalleryContent(e)};this.renderHeaderControls(e,w("gallery"),r,()=>{this.fileInput||(this.fileInput=e.createEl("input",{type:"file",cls:"storyteller-hidden"}),this.fileInput.accept="image/*",this.fileInput.onchange=async s=>{let o=s.target.files;if(!o||o.length===0)return;let l=o[0],c=this.plugin.settings.galleryUploadFolder;try{await this.plugin.ensureFolder(c);let u=l.name,d=(0,Qe.normalizePath)(`${c}/${u}`),h=0;for(;this.app.vault.getAbstractFileByPath(d);){h++;let y=l.name.split("."),v=y.pop();u=`${y.join(".")}_${h}.${v}`,d=(0,Qe.normalizePath)(`${c}/${u}`)}let f=await l.arrayBuffer(),m=await this.app.vault.createBinary(d,f);new Qe.Notice(`Uploaded "${u}" to vault.`);let g=await this.plugin.addGalleryImage({filePath:d,title:m.basename});new Jo(this.app,this.plugin,g,!0,n).open()}catch(u){console.error("Error uploading file:",u),new Qe.Notice("Error uploading file. Check console for details.")}finally{this.fileInput&&(this.fileInput.value="")}}),this.fileInput.click()},w("uploadImage")),await this.renderGalleryList(e)}async renderGalleryList(e){let r=e.querySelector(".storyteller-gallery-grid");r&&r.remove();let n=this.plugin.getGalleryImages().filter(l=>l.filePath.toLowerCase().includes(this.currentFilter)||(l.title||"").toLowerCase().includes(this.currentFilter)||(l.caption||"").toLowerCase().includes(this.currentFilter)||(l.description||"").toLowerCase().includes(this.currentFilter)||(l.tags||[]).join(" ").toLowerCase().includes(this.currentFilter)||(l.linkedCharacters||[]).join(" ").toLowerCase().includes(this.currentFilter)||(l.linkedLocations||[]).join(" ").toLowerCase().includes(this.currentFilter)||(l.linkedEvents||[]).join(" ").toLowerCase().includes(this.currentFilter)),s=e.createDiv("storyteller-gallery-grid");if(n.length===0){s.createEl("p",{text:w("noImagesFound")+(this.currentFilter?w("matchingFilter"):"")});return}let o=async()=>{await this.renderGalleryContent(e)};this.renderGalleryGrid(n,s,o)}async renderGroupsContent(e){e.empty(),this.renderHeaderControls(e,w("groups"),async r=>{this.currentFilter=r,await this.renderGroupsList(e)},()=>{if(!this.plugin.getActiveStory()){new Qe.Notice("Select or create a story first.");return}new Ag(this.app,this.plugin,null,async()=>{},async r=>{await this.plugin.deleteGroup(r)}).open()},w("createNewGroup")),await this.renderGroupsList(e)}async renderGroupsList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=this.plugin.getGroups().filter(d=>{let h=this.currentFilter.toLowerCase();return d.name.toLowerCase().includes(h)||d.description&&d.description.toLowerCase().includes(h)}),s=e.createDiv("storyteller-list-container");if(n.length===0){let d=s.createEl("p",{text:w("noGroupsFound"),cls:"storyteller-empty-state"});d.style.color="var(--text-muted)",d.style.fontStyle="italic";return}let o=await this.plugin.listCharacters(),l=await this.plugin.listLocations(),c=await this.plugin.listEvents(),u=await this.plugin.listPlotItems();n.forEach((d,h)=>{let f=!!this.currentFilter||!1,m=s.createDiv("storyteller-group-card sts-card");m.setAttr("tabindex","0");let g=m.createDiv("storyteller-group-header"),y=g.createEl("button",{cls:"storyteller-group-toggle-btn",text:f?"\u25BC":"\u25BA"});y.setAttr("aria-label",f?"Collapse group":"Expand group"),y.setAttr("aria-expanded",f?"true":"false");let v=g.createDiv("storyteller-group-info");if(d.profileImagePath){let R=v.createEl("img",{cls:"storyteller-group-pfp"});try{R.src=this.getImageSrc(d.profileImagePath)}catch(F){}}v.createEl("strong",{text:d.name}),d.description&&v.createEl("span",{text:d.description,cls:"storyteller-group-desc"}),d.tags&&d.tags.length>0&&v.createDiv("storyteller-group-tags").createSpan({text:(d.tags||[]).map(F=>`#${F}`).join(" ")});let C=g.createDiv("storyteller-group-actions").createEl("button",{text:w("edit"),cls:"mod-cta storyteller-group-edit-btn"});C.onclick=()=>{new Ag(this.app,this.plugin,d,async()=>{this.renderGroupsList(e)},async R=>{await this.plugin.deleteGroup(R),this.renderGroupsList(e)}).open()};let _=m.createDiv("storyteller-group-members");f||_.addClass("collapsed");let x={character:d.members.filter(R=>R.type==="character"),location:d.members.filter(R=>R.type==="location"),event:d.members.filter(R=>R.type==="event"),item:d.members.filter(R=>R.type==="item")},P={character:"Characters",location:"Locations",event:"Events",item:"Items"},I={character:"\u{1F464}",location:"\u{1F4CD}",event:"\u{1F552}",item:"\u{1F48E}"};["character","location","event","item"].forEach(R=>{if(x[R].length>0){let F=_.createDiv("storyteller-group-section"),$=F.createDiv("storyteller-group-entity-header");$.setAttr("role","heading"),$.setAttr("aria-level","4"),$.innerHTML=`<span class="storyteller-group-entity-icon">${I[R]}</span> <span>${P[R]}</span>`;let k=F.createEl("ul",{cls:"storyteller-group-entity-list"});x[R].forEach(N=>{let G=k.createEl("li",{cls:"storyteller-group-entity-item"}),W=N.id,Y;if(R==="character"){let U=o.find(Z=>(Z.id||Z.name)===N.id);U&&(W=U.name,Y=U.filePath)}else if(R==="location"){let U=l.find(Z=>(Z.id||Z.name)===N.id);U&&(W=U.name,Y=U.filePath)}else if(R==="event"){let U=c.find(Z=>(Z.id||Z.name)===N.id);U&&(W=U.name,Y=U.filePath)}else if(R==="item"){let U=u.find(Z=>(Z.id||Z.name)===N.id);U&&(W=U.name,Y=U.filePath)}G.textContent=W,Y&&(G.classList.add("is-link"),G.addEventListener("click",()=>{let U=Y,Z=this.app.vault.getAbstractFileByPath(U);Z instanceof Qe.TFile&&this.app.workspace.getLeaf(!1).openFile(Z)}))})}}),d.members.length===0&&_.createEl("em",{text:w("noMembers")});let M=f,O=()=>{M=!M,y.textContent=M?"\u25BC":"\u25BA",y.setAttr("aria-label",M?"Collapse group":"Expand group"),y.setAttr("aria-expanded",M?"true":"false"),_.toggleClass("collapsed",!M)};y.onclick=O,y.onkeydown=R=>{(R.key==="Enter"||R.key===" ")&&(R.preventDefault(),O())}})}renderHeaderControls(e,r,n,s,o=w("createNew"),l){let c=e.createDiv("storyteller-controls-group");c.style.display="flex",c.style.alignItems="center",c.style.gap="0.5em";let u=r.toLowerCase(),d=null;u.startsWith("character")?d="character":u.startsWith("location")?d="location":u.includes("event")||u.includes("timeline")?d="event":u.startsWith("item")?d="item":u.startsWith("reference")?d="reference":u.startsWith("chapter")?d="chapter":u.startsWith("scene")&&(d="scene");let h=(()=>{if(!d)return!0;try{return this.plugin.getEntityFolder(d),!0}catch(m){return!1}})(),f=new Qe.Setting(c).setName(w("filterX",r.toLowerCase())).setDesc("").addText(m=>{let g=m.setPlaceholder(w("searchX",r.toLowerCase())).onChange(async y=>{this.currentFilter=y.toLowerCase(),this.debouncedSearch?this.debouncedSearch(n):await n(this.currentFilter)});if(this.currentSearchInput=g.inputEl,Et.isMobile()){g.inputEl.autocomplete="off",g.inputEl.setAttribute("autocorrect","off"),g.inputEl.setAttribute("autocapitalize","none"),g.inputEl.spellcheck=!1,g.inputEl.addClass("mobile-input"),g.inputEl.addClass("search-input"),Et.isIOS()&&(g.inputEl.style.fontSize="1.1rem");let y=()=>{this.isUserTyping=!0,g.inputEl.removeAttribute("data-user-dismissed"),this.typingTimer&&clearTimeout(this.typingTimer),this.typingTimer=window.setTimeout(()=>{this.isUserTyping=!1},2e3)};g.inputEl.addEventListener("input",y),g.inputEl.addEventListener("focus",y),g.inputEl.addEventListener("keydown",v=>{y(),v.key==="Enter"&&Et.isMobile()&&(this.markSearchInputDismissal(),g.inputEl.blur(),v.preventDefault())}),g.inputEl.addEventListener("blur",()=>{this.isUserTyping=!1,this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null)}),g.inputEl.addEventListener("focus",()=>{g.inputEl.removeAttribute("data-user-dismissed"),Et.isMobile()&&g.inputEl.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}),g.inputEl.addEventListener("blur",v=>{let E=g.inputEl.hasAttribute("data-user-dismissed");Et.isMobile()&&!E&&document.activeElement!==g.inputEl&&setTimeout(()=>{let C=g.inputEl.hasAttribute("data-user-dismissed");if(this.currentSearchInput===g.inputEl&&!C&&document.activeElement!==g.inputEl&&g.inputEl.isConnected)try{g.inputEl.focus()}catch(_){}},10)})}return g});f.addButton(m=>{m.setButtonText(o).setCta().onClick(()=>{if(d)try{this.plugin.getEntityFolder(d)}catch(g){new Qe.Notice("Select or create a story first.");return}s()}),h||m.setDisabled(!0).setTooltip("Select or create a story first.")}),l&&l(f)}async renderReferencesContent(e){e.empty(),this.renderHeaderControls(e,"References",async r=>{this.currentFilter=r,await this.renderReferencesList(e)},()=>{Promise.resolve().then(()=>(jw(),Uw)).then(({ReferenceModal:r})=>{new r(this.app,this.plugin,null,async n=>{await this.plugin.saveReference(n),new Qe.Notice(`Reference "${n.name}" created.`)}).open()})},w("createNew")),await this.renderReferencesList(e)}async renderReferencesList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listReferences()).filter(o=>o.name.toLowerCase().includes(this.currentFilter)||(o.category||"").toLowerCase().includes(this.currentFilter)||(o.content||"").toLowerCase().includes(this.currentFilter)||(o.tags||[]).join(" ").toLowerCase().includes(this.currentFilter)),s=e.createDiv("storyteller-list-container");if(n.length===0){s.createEl("p",{text:w("noReferencesFound")+(this.currentFilter?w("matchingFilter"):"")}).addClass("storyteller-empty-state");return}n.forEach(o=>{let l=s.createDiv("storyteller-list-item"),c=l.createDiv("storyteller-list-item-pfp");if(o.profileImagePath){let f=c.createEl("img");try{f.src=this.getImageSrc(o.profileImagePath),f.alt=o.name}catch(m){c.createSpan({text:"?"})}}else c.createDiv({cls:"storyteller-pfp-placeholder",text:o.name.substring(0,1)});let u=l.createDiv("storyteller-list-item-info"),d=u.createEl("strong",{text:o.name});if(o.category&&u.createEl("span",{text:` (${o.category})`,cls:"storyteller-list-item-status"}),o.content){let f=o.content.length>120?o.content.substring(0,120)+"\u2026":o.content;u.createEl("p",{text:f})}o.tags&&o.tags.length>0&&u.createDiv("storyteller-list-item-extra").createSpan({text:o.tags.map(m=>`#${m}`).join(" ")});let h=l.createDiv("storyteller-list-item-actions");this.addEditButton(h,()=>{Promise.resolve().then(()=>(jw(),Uw)).then(({ReferenceModal:f})=>{new f(this.app,this.plugin,o,async m=>{await this.plugin.saveReference(m),new Qe.Notice(`Reference "${m.name}" updated.`)},async m=>{m.filePath&&await this.plugin.deleteReference(m.filePath)}).open()})}),this.addDeleteButton(h,async()=>{o.filePath&&confirm(`Delete reference "${o.name}"?`)&&await this.plugin.deleteReference(o.filePath)}),this.addOpenFileButton(h,o.filePath)})}async renderChaptersContent(e){e.empty(),this.renderHeaderControls(e,"Chapters",async r=>{this.currentFilter=r,await this.renderChaptersList(e)},()=>{Promise.resolve().then(()=>(Kw(),Zw)).then(({ChapterModal:r})=>{new r(this.app,this.plugin,null,async n=>{await this.plugin.saveChapter(n),new Qe.Notice(`Chapter "${n.name}" created.`)}).open()})},w("createNew")),await this.renderChaptersList(e)}async renderChaptersList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listChapters()).filter(o=>{var l;return o.name.toLowerCase().includes(this.currentFilter)||(""+((l=o.number)!=null?l:"")).toLowerCase().includes(this.currentFilter)||(o.summary||"").toLowerCase().includes(this.currentFilter)||(o.tags||[]).join(" ").toLowerCase().includes(this.currentFilter)}),s=e.createDiv("storyteller-list-container");if(n.length===0){s.createEl("p",{text:w("noChaptersFound")+(this.currentFilter?w("matchingFilter"):"")});return}n.forEach(o=>{var f;let l=s.createDiv("storyteller-list-item"),c=l.createDiv("storyteller-list-item-pfp");if(o.profileImagePath){let m=c.createEl("img");try{m.src=this.getImageSrc(o.profileImagePath),m.alt=o.name}catch(g){c.createSpan({text:"?"})}}else{let m=c.createDiv({cls:"storyteller-pfp-placeholder",text:((f=o.number)!=null?f:"?").toString()});m.title="Chapter number"}let u=l.createDiv("storyteller-list-item-info"),d=o.number!=null?`${o.number}. ${o.name}`:o.name;if(u.createEl("strong",{text:d}),o.summary){let m=o.summary.length>120?o.summary.substring(0,120)+"\u2026":o.summary;u.createEl("p",{text:m})}o.tags&&o.tags.length>0&&u.createDiv("storyteller-list-item-extra").createSpan({text:o.tags.map(g=>`#${g}`).join(" ")});let h=l.createDiv("storyteller-list-item-actions");this.addEditButton(h,()=>{Promise.resolve().then(()=>(Kw(),Zw)).then(({ChapterModal:m})=>{new m(this.app,this.plugin,o,async g=>{await this.plugin.saveChapter(g),new Qe.Notice(`Chapter "${g.name}" updated.`)},async g=>{g.filePath&&await this.plugin.deleteChapter(g.filePath)}).open()})}),this.addDeleteButton(h,async()=>{o.filePath&&confirm(`Delete chapter "${o.name}"?`)&&await this.plugin.deleteChapter(o.filePath)}),this.addOpenFileButton(h,o.filePath)})}async renderScenesContent(e){e.empty(),this.renderHeaderControls(e,"Scenes",async r=>{this.currentFilter=r,await this.renderScenesList(e)},()=>{Promise.resolve().then(()=>(Jw(),Xw)).then(({SceneModal:r})=>{new r(this.app,this.plugin,null,async n=>{await this.plugin.saveScene(n),new Qe.Notice(`Scene "${n.name}" created.`)}).open()})},w("createNew")),await this.renderScenesList(e)}async renderScenesList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listScenes()).filter(l=>l.name.toLowerCase().includes(this.currentFilter)||(l.content||"").toLowerCase().includes(this.currentFilter)||(l.status||"").toLowerCase().includes(this.currentFilter)||(l.chapterName||"").toLowerCase().includes(this.currentFilter)||(l.tags||[]).join(" ").toLowerCase().includes(this.currentFilter)),s=await this.plugin.listChapters(),o=e.createDiv("storyteller-list-container");if(n.length===0){o.createEl("p",{text:w("noScenesFound")||"No scenes found."+(this.currentFilter?w("matchingFilter"):"")});return}n.forEach(l=>{let c=o.createDiv("storyteller-list-item"),u=c.createDiv("storyteller-list-item-pfp");if(l.profileImagePath){let y=u.createEl("img");try{y.src=this.getImageSrc(l.profileImagePath),y.alt=l.name}catch(v){u.createSpan({text:"?"})}}else u.createDiv({cls:"storyteller-pfp-placeholder",text:l.name.substring(0,1)});let d=c.createDiv("storyteller-list-item-info"),h=d.createEl("strong",{text:l.name}),f=d.createDiv("storyteller-list-item-extra");if(l.chapterName?f.createSpan({text:`Chapter: ${l.chapterName}`}):f.createSpan({text:"Unassigned"}),l.status&&f.createSpan({text:` \u2022 ${l.status}`}),l.content){let y=l.content.length>120?l.content.substring(0,120)+"\u2026":l.content;d.createEl("p",{text:y})}l.tags&&l.tags.length>0&&d.createDiv("storyteller-list-item-extra").createSpan({text:l.tags.map(v=>`#${v}`).join(" ")});let m=l.chapterId?s.find(y=>y.id===l.chapterId):l.chapterName?s.find(y=>y.name===l.chapterName):void 0;m&&new Qe.ButtonComponent(c.createDiv("storyteller-scene-go-chapter")).setIcon("arrow-right").setTooltip("Go to chapter").onClick(()=>{var E;if(m.filePath){let C=this.app.vault.getAbstractFileByPath(m.filePath);if(C instanceof Qe.TFile){this.app.workspace.getLeaf(!1).openFile(C);return}}let v=(E=this.tabHeaderContainer)==null?void 0:E.querySelector('[data-tab-id="chapters"]');v==null||v.click()}).buttonEl.classList.add("mod-cta");let g=c.createDiv("storyteller-list-item-actions");this.addEditButton(g,()=>{Promise.resolve().then(()=>(Jw(),Xw)).then(({SceneModal:y})=>{new y(this.app,this.plugin,l,async v=>{await this.plugin.saveScene(v),new Qe.Notice(`Scene "${v.name}" updated.`)},async v=>{v.filePath&&await this.plugin.deleteScene(v.filePath)}).open()})}),this.addDeleteButton(g,async()=>{l.filePath&&confirm(`Delete scene "${l.name}"?`)&&await this.plugin.deleteScene(l.filePath)}),this.addOpenFileButton(g,l.filePath)})}renderCharacterList(e,r,n){e.forEach(s=>{let o=r.createDiv("storyteller-list-item storyteller-character-item"),l=o.createDiv("storyteller-list-item-pfp");if(s.profileImagePath){let h=l.createEl("img");try{h.src=this.getImageSrc(s.profileImagePath),h.alt=s.name}catch(f){console.error(`Error loading profile image for ${s.name}: ${s.profileImagePath}`,f),l.createSpan({text:"?",title:"Error loading image"})}}else l.createDiv({cls:"storyteller-pfp-placeholder",text:s.name.substring(0,1)});let c=o.createDiv("storyteller-list-item-info");c.createEl("strong",{text:s.name}),s.description&&c.createEl("p",{text:s.description.substring(0,80)+(s.description.length>80?"...":"")});let u=c.createDiv("storyteller-list-item-extra");s.status&&u.createSpan({cls:"storyteller-list-item-status",text:s.status}),s.affiliation&&(s.status&&u.appendText(" \u2022 "),u.createSpan({cls:"storyteller-list-item-affiliation",text:s.affiliation}));let d=o.createDiv("storyteller-list-item-actions");this.addEditButton(d,()=>{new Ts(this.app,this.plugin,s,async h=>{await this.plugin.saveCharacter(h),new Qe.Notice(`Character "${h.name}" updated.`)}).open()}),this.addDeleteButton(d,async()=>{confirm(`Are you sure you want to delete "${s.name}"? This will move the file to system trash.`)&&(s.filePath?await this.plugin.deleteCharacter(s.filePath):new Qe.Notice("Error: Cannot delete character without file path."))}),this.addOpenFileButton(d,s.filePath)})}renderLocationList(e,r,n){e.forEach(s=>{let o=r.createDiv("storyteller-list-item"),l=o.createDiv("storyteller-list-item-pfp");if(s.profileImagePath){let h=l.createEl("img");try{h.src=this.getImageSrc(s.profileImagePath),h.alt=s.name}catch(f){console.error(`Error loading image for ${s.name}: ${s.profileImagePath}`,f),l.createSpan({text:"?",title:"Error loading image"})}}else{let h=s.name.substring(0,1).toUpperCase();l.createDiv({cls:"storyteller-pfp-placeholder",text:h})}let c=o.createDiv("storyteller-list-item-info");c.createEl("strong",{text:s.name}),s.description&&c.createEl("p",{text:s.description.substring(0,100)+(s.description.length>100?"...":"")});let u=c.createDiv("storyteller-list-item-extra");s.locationType&&u.createSpan({cls:"storyteller-list-item-type",text:s.locationType}),s.region&&(s.locationType&&u.appendText(" \u2022 "),u.createSpan({cls:"storyteller-list-item-region",text:`(${s.region})`})),s.parentLocation&&((s.locationType||s.region)&&u.appendText(" \u2022 "),u.createSpan({cls:"storyteller-list-item-parent",text:`within ${s.parentLocation}`})),s.status&&((s.locationType||s.region||s.parentLocation)&&u.appendText(" \u2022 "),u.createSpan({cls:"storyteller-list-item-status",text:`[${s.status}]`}));let d=o.createDiv("storyteller-list-item-actions");this.addEditButton(d,()=>{new Cs(this.app,this.plugin,s,async h=>{await this.plugin.saveLocation(h),new Qe.Notice(`Location "${h.name}" updated.`)}).open()}),this.addDeleteButton(d,async()=>{confirm(`Are you sure you want to delete "${s.name}"?`)&&(s.filePath?await this.plugin.deleteLocation(s.filePath):new Qe.Notice("Error: Cannot delete location without file path."))}),this.addOpenFileButton(d,s.filePath)})}renderEventList(e,r,n,s=[]){e.forEach(o=>{let l=r.createDiv("storyteller-list-item"),c=l.createDiv("storyteller-list-item-pfp");if(o.profileImagePath){let f=c.createEl("img");try{f.src=this.getImageSrc(o.profileImagePath),f.alt=o.name}catch(m){console.error(`Error loading image for ${o.name}: ${o.profileImagePath}`,m),c.createSpan({text:"?",title:"Error loading image"})}}else{let f=o.name.substring(0,1).toUpperCase();c.createDiv({cls:"storyteller-pfp-placeholder",text:f})}let u=l.createDiv("storyteller-list-item-info");if(u.createEl("strong",{text:o.name}),o.dateTime&&u.createEl("span",{text:` (${o.dateTime})`,cls:"storyteller-timeline-date"}),o.description&&u.createEl("p",{text:o.description.substring(0,100)+(o.description.length>100?"...":"")}),o.images&&Array.isArray(o.images)&&o.images.length>0){let f=u.createDiv("storyteller-event-images-row");o.images.forEach(m=>{try{let g=f.createEl("img",{cls:"storyteller-event-image-thumb"});g.src=this.getImageSrc(m),g.alt=o.name+" image",g.loading="lazy",g.style.maxWidth="48px",g.style.maxHeight="48px",g.style.marginRight="4px",g.style.cursor="pointer",g.addEventListener("click",()=>{new Jo(this.app,this.plugin,{id:m,filePath:m},!1,()=>Promise.resolve()).open()})}catch(g){f.createSpan({text:"?",title:"Error loading image"})}})}let d=u.createDiv("storyteller-list-item-extra");if(o.status&&d.createSpan({cls:"storyteller-list-item-status",text:`[${o.status}]`}),o.location){o.status&&d.appendText(" \u2022 ");let f=this.resolveLocationName(o.location,s);d.createSpan({cls:"storyteller-list-item-location",text:`@ ${f}`})}let h=l.createDiv("storyteller-list-item-actions");this.addEditButton(h,()=>{new ts(this.app,this.plugin,o,async f=>{await this.plugin.saveEvent(f),new Qe.Notice(`Event "${f.name}" updated.`)}).open()}),this.addDeleteButton(h,async()=>{confirm(`Are you sure you want to delete "${o.name}"?`)&&(o.filePath?await this.plugin.deleteEvent(o.filePath):new Qe.Notice("Error: Cannot delete event without file path."))}),this.addOpenFileButton(h,o.filePath)})}renderGalleryGrid(e,r,n){r.addClass("storyteller-gallery-grid"),e.forEach(s=>{let o=r.createDiv("storyteller-gallery-item");o.setAttribute("role","button"),o.setAttribute("tabindex","0");let l=o.createEl("img",{cls:"storyteller-gallery-item-image"});l.src=this.getImageSrc(s.filePath),l.alt=s.title||s.filePath.split("/").pop()||"Gallery image",l.loading="lazy";let c=o.createDiv("storyteller-gallery-item-title"),u=s.title||s.filePath.split("/").pop()||"";c.setText(u),c.setAttribute("title",u);let d=()=>{new Jo(this.app,this.plugin,s,!1,n).open()};o.addEventListener("click",d),o.addEventListener("keydown",h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),d())})})}addEditButton(e,r){new Qe.ButtonComponent(e).setIcon("pencil").setTooltip("Edit").onClick(r)}addDeleteButton(e,r){new Qe.ButtonComponent(e).setIcon("trash").setTooltip("Delete").setClass("mod-warning").onClick(r)}addOpenFileButton(e,r){r&&new Qe.ButtonComponent(e).setIcon("go-to-file").setTooltip("Open note").onClick(()=>{let n=this.app.vault.getAbstractFileByPath(r);n instanceof Qe.TFile?this.app.workspace.getLeaf(!1).openFile(n):new Qe.Notice("Could not find the note file.")})}async openNetworkGraphInPanel(){let{workspace:e}=this.app,{NetworkGraphView:r,VIEW_TYPE_NETWORK_GRAPH:n}=await Promise.resolve().then(()=>(nP(),a3)),s=e.getLeavesOfType(n);if(s.length>0){e.revealLeaf(s[0]);return}let o=e.getLeaf("tab");o&&(await o.setViewState({type:n,active:!0}),e.revealLeaf(o))}async openNetworkGraphInModal(){let{NetworkGraphModal:e}=await Promise.resolve().then(()=>(o3(),s3));new e(this.app,this.plugin).open()}async renderCulturesContent(e){e.empty(),this.renderHeaderControls(e,w("cultures"),async r=>{this.currentFilter=r,await this.renderCulturesList(e)},()=>{Promise.resolve().then(()=>(Pf(),eE)).then(({CultureModal:r})=>{new r(this.app,this.plugin,null,async n=>{await this.plugin.saveCulture(n),new Qe.Notice(w("cultureCreated",n.name))}).open()})},w("createNew")),await this.renderCulturesList(e)}async renderCulturesList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listCultures()).filter(o=>o.name.toLowerCase().includes(this.currentFilter)||(o.values||"").toLowerCase().includes(this.currentFilter)||(o.religion||"").toLowerCase().includes(this.currentFilter)||(o.governmentType||"").toLowerCase().includes(this.currentFilter)),s=e.createDiv("storyteller-list-container");if(n.length===0){s.createEl("p",{text:w("noCulturesFound")+(this.currentFilter?w("matchingFilter"):"")});return}n.forEach(o=>{let l=s.createDiv("storyteller-list-item"),c=l.createDiv("storyteller-list-item-pfp");if(o.profileImagePath){let f=c.createEl("img");f.src=this.getImageSrc(o.profileImagePath),f.alt=o.name}else c.createDiv({cls:"storyteller-pfp-placeholder",text:o.name.substring(0,1)});let u=l.createDiv("storyteller-list-item-info");u.createEl("strong",{text:o.name});let d=u.createDiv("storyteller-list-item-extra");if(o.governmentType&&d.createSpan({text:`Gov: ${o.governmentType}`}),o.techLevel&&d.createSpan({text:` \u2022 Tech: ${o.techLevel}`}),o.values){let f=o.values.length>120?o.values.substring(0,120)+"\u2026":o.values;u.createEl("p",{text:f})}let h=l.createDiv("storyteller-list-item-actions");this.addEditButton(h,()=>{Promise.resolve().then(()=>(Pf(),eE)).then(({CultureModal:f})=>{new f(this.app,this.plugin,o,async m=>{await this.plugin.saveCulture(m),new Qe.Notice(w("cultureUpdated",m.name))},async m=>{m.filePath&&await this.plugin.deleteCulture(m.filePath)}).open()})}),this.addDeleteButton(h,async()=>{o.filePath&&confirm(w("confirmDeleteCulture",o.name))&&await this.plugin.deleteCulture(o.filePath)}),this.addOpenFileButton(h,o.filePath)})}async renderEconomiesContent(e){e.empty(),this.renderHeaderControls(e,w("economies"),async r=>{this.currentFilter=r,await this.renderEconomiesList(e)},()=>{Promise.resolve().then(()=>(Lf(),tE)).then(({EconomyModal:r})=>{new r(this.app,this.plugin,null,async n=>{await this.plugin.saveEconomy(n),new Qe.Notice(w("economyCreated",n.name))}).open()})},w("createNew")),await this.renderEconomiesList(e)}async renderEconomiesList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listEconomies()).filter(o=>o.name.toLowerCase().includes(this.currentFilter)||(o.industries||"").toLowerCase().includes(this.currentFilter)||(o.taxation||"").toLowerCase().includes(this.currentFilter)||(o.economicSystem||"").toLowerCase().includes(this.currentFilter)),s=e.createDiv("storyteller-list-container");if(n.length===0){s.createEl("p",{text:w("noEconomiesFound")+(this.currentFilter?w("matchingFilter"):"")});return}n.forEach(o=>{let l=s.createDiv("storyteller-list-item"),c=l.createDiv("storyteller-list-item-pfp");if(o.profileImagePath){let f=c.createEl("img");f.src=this.getImageSrc(o.profileImagePath),f.alt=o.name}else c.createDiv({cls:"storyteller-pfp-placeholder",text:o.name.substring(0,1)});let u=l.createDiv("storyteller-list-item-info");u.createEl("strong",{text:o.name});let d=u.createDiv("storyteller-list-item-extra");if(o.economicSystem&&d.createSpan({text:`System: ${o.economicSystem}`}),o.currencies&&o.currencies.length>0&&d.createSpan({text:` \u2022 Currencies: ${o.currencies.length}`}),o.industries){let f=o.industries.length>120?o.industries.substring(0,120)+"\u2026":o.industries;u.createEl("p",{text:f})}let h=l.createDiv("storyteller-list-item-actions");this.addEditButton(h,()=>{Promise.resolve().then(()=>(Lf(),tE)).then(({EconomyModal:f})=>{new f(this.app,this.plugin,o,async m=>{await this.plugin.saveEconomy(m),new Qe.Notice(w("economyUpdated",m.name))},async m=>{m.filePath&&await this.plugin.deleteEconomy(m.filePath)}).open()})}),this.addDeleteButton(h,async()=>{o.filePath&&confirm(w("confirmDeleteEconomy",o.name))&&await this.plugin.deleteEconomy(o.filePath)}),this.addOpenFileButton(h,o.filePath)})}async renderMagicSystemsContent(e){e.empty(),this.renderHeaderControls(e,w("magicSystems"),async r=>{this.currentFilter=r,await this.renderMagicSystemsList(e)},()=>{Promise.resolve().then(()=>(Mf(),rE)).then(({MagicSystemModal:r})=>{new r(this.app,this.plugin,null,async n=>{await this.plugin.saveMagicSystem(n),new Qe.Notice(w("magicSystemCreated",n.name))}).open()})},w("createNew")),await this.renderMagicSystemsList(e)}async renderMagicSystemsList(e){let r=e.querySelector(".storyteller-list-container");r&&r.remove();let n=(await this.plugin.listMagicSystems()).filter(o=>o.name.toLowerCase().includes(this.currentFilter)||(o.rules||"").toLowerCase().includes(this.currentFilter)||(o.source||"").toLowerCase().includes(this.currentFilter)||(o.systemType||"").toLowerCase().includes(this.currentFilter)),s=e.createDiv("storyteller-list-container");if(n.length===0){s.createEl("p",{text:w("noMagicSystemsFound")+(this.currentFilter?w("matchingFilter"):"")});return}n.forEach(o=>{let l=s.createDiv("storyteller-list-item"),c=l.createDiv("storyteller-list-item-pfp");if(o.profileImagePath){let f=c.createEl("img");f.src=this.getImageSrc(o.profileImagePath),f.alt=o.name}else c.createDiv({cls:"storyteller-pfp-placeholder",text:o.name.substring(0,1)});let u=l.createDiv("storyteller-list-item-info");u.createEl("strong",{text:o.name});let d=u.createDiv("storyteller-list-item-extra");if(o.systemType&&d.createSpan({text:`Type: ${o.systemType}`}),o.rarity&&d.createSpan({text:` \u2022 Rarity: ${o.rarity}`}),o.rules){let f=o.rules.length>120?o.rules.substring(0,120)+"\u2026":o.rules;u.createEl("p",{text:f})}let h=l.createDiv("storyteller-list-item-actions");this.addEditButton(h,()=>{Promise.resolve().then(()=>(Mf(),rE)).then(({MagicSystemModal:f})=>{new f(this.app,this.plugin,o,async m=>{await this.plugin.saveMagicSystem(m),new Qe.Notice(w("magicSystemUpdated",m.name))},async m=>{m.filePath&&await this.plugin.deleteMagicSystem(m.filePath)}).open()})}),this.addDeleteButton(h,async()=>{o.filePath&&confirm(w("confirmDeleteMagicSystem",o.name))&&await this.plugin.deleteMagicSystem(o.filePath)}),this.addOpenFileButton(h,o.filePath)})}async renderTemplatesContent(e){e.empty(),this.templatesCache=this.plugin.templateManager.getFilteredTemplates(this.templateFilter);let r=e.createDiv("storyteller-templates-header");r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="flex-start",r.style.marginBottom="1rem";let n=r.createDiv("storyteller-templates-header-text");n.createEl("h3",{text:w("entityTemplates")}),n.createEl("p",{text:w("browseManageTemplates"),cls:"storyteller-templates-description"});let s=r.createEl("button",{text:w("createNewTemplate"),cls:"mod-cta"});s.style.flexShrink="0",s.addEventListener("click",()=>{new Fs(this.app,this.plugin,null,async o=>{new Qe.Notice(w("templateCreated",o.name)),await this.renderTemplatesContent(e)}).open()}),this.createTemplateFilterSection(e),this.createTemplateListSection(e)}createTemplateFilterSection(e){var I,M;let r=e.createDiv({cls:"storyteller-template-library-filters"});r.style.marginBottom="1rem",r.style.padding="1rem",r.style.backgroundColor="var(--background-secondary)",r.style.borderRadius="8px";let n=r.createDiv("storyteller-filter-row");n.style.marginBottom="0.75rem";let s=n.createEl("label",{text:w("searchTemplates")});s.style.display="block",s.style.marginBottom="0.25rem",s.style.fontWeight="500";let o=n.createEl("input",{type:"text",placeholder:w("searchTemplatesPlaceholder")});o.style.width="100%",o.style.padding="0.5rem",o.style.borderRadius="4px",o.style.border="1px solid var(--background-modifier-border)",o.value=this.templateFilter.searchText||"",o.addEventListener("input",()=>{this.templateFilter.searchText=o.value||void 0,this.refreshTemplateList(e)});let l=r.createDiv("storyteller-filter-options");l.style.display="flex",l.style.flexWrap="wrap",l.style.gap="1rem",l.style.alignItems="flex-end";let c=l.createDiv("storyteller-filter-group");c.createEl("label",{text:w("genre")}).style.display="block";let u=c.createEl("select");u.style.padding="0.35rem",u.style.borderRadius="4px",u.createEl("option",{text:w("allGenres"),value:""}),["fantasy","scifi","mystery","horror","romance","historical","western","thriller","custom"].forEach(O=>u.createEl("option",{text:O.charAt(0).toUpperCase()+O.slice(1),value:O})),u.value=((I=this.templateFilter.genre)==null?void 0:I[0])||"",u.addEventListener("change",()=>{this.templateFilter.genre=u.value?[u.value]:void 0,this.refreshTemplateList(e)});let h=l.createDiv("storyteller-filter-group");h.createEl("label",{text:w("templateCategory")}).style.display="block";let f=h.createEl("select");f.style.padding="0.35rem",f.style.borderRadius="4px",f.createEl("option",{text:w("allTemplateCategories"),value:""});let m=["single-entity","entity-set","full-world"],g={"single-entity":w("singleEntity"),"entity-set":w("entitySet"),"full-world":w("fullWorld")};m.forEach(O=>f.createEl("option",{text:g[O],value:O})),f.value=((M=this.templateFilter.category)==null?void 0:M[0])||"",f.addEventListener("change",()=>{this.templateFilter.category=f.value?[f.value]:void 0,this.refreshTemplateList(e)});let y=l.createDiv("storyteller-filter-group");y.createEl("label",{text:w("sortBy")}).style.display="block";let v=y.createEl("select");v.style.padding="0.35rem",v.style.borderRadius="4px",v.createEl("option",{text:w("sortByName"),value:"name"}),v.createEl("option",{text:w("sortByUsage"),value:"usage"}),v.createEl("option",{text:w("sortByRecent"),value:"recent"}),v.value=this.templateFilter.sortByUsage?"usage":this.templateFilter.sortByRecent?"recent":"name",v.addEventListener("change",()=>{this.templateFilter.sortByUsage=v.value==="usage",this.templateFilter.sortByRecent=v.value==="recent",this.refreshTemplateList(e)});let E=r.createDiv("storyteller-filter-toggles");E.style.display="flex",E.style.gap="1.5rem",E.style.marginTop="0.75rem";let C=E.createEl("label");C.style.display="flex",C.style.alignItems="center",C.style.gap="0.5rem",C.style.cursor="pointer";let _=C.createEl("input",{type:"checkbox"});_.checked=this.templateFilter.showBuiltIn!==!1,_.addEventListener("change",()=>{this.templateFilter.showBuiltIn=_.checked,this.refreshTemplateList(e)}),C.createEl("span",{text:w("showBuiltIn")});let x=E.createEl("label");x.style.display="flex",x.style.alignItems="center",x.style.gap="0.5rem",x.style.cursor="pointer";let P=x.createEl("input",{type:"checkbox"});P.checked=this.templateFilter.showCustom!==!1,P.addEventListener("change",()=>{this.templateFilter.showCustom=P.checked,this.refreshTemplateList(e)}),x.createEl("span",{text:w("showCustom")})}refreshTemplateList(e){this.templatesCache=this.plugin.templateManager.getFilteredTemplates(this.templateFilter);let r=e.querySelector(".storyteller-template-library-list");r&&r.remove();let n=this.createTemplateListElement();e.appendChild(n)}createTemplateListSection(e){let r=this.createTemplateListElement();e.appendChild(r)}createTemplateListElement(){let e=document.createElement("div");if(e.className="storyteller-template-library-list",this.templatesCache.length===0){let s=e.createDiv("storyteller-empty-state");return s.style.padding="2rem",s.style.textAlign="center",s.style.color="var(--text-muted)",s.createEl("p",{text:w("noTemplatesFound")}),e}let r=e.createEl("p",{text:w("foundXTemplates",this.templatesCache.length),cls:"storyteller-template-count"});r.style.marginBottom="0.75rem",r.style.color="var(--text-muted)";let n=e.createDiv("storyteller-template-cards-grid");return n.style.display="grid",n.style.gridTemplateColumns="repeat(auto-fill, minmax(280px, 1fr))",n.style.gap="1rem",this.templatesCache.forEach(s=>{this.renderFullTemplateCard(n,s)}),e}renderFullTemplateCard(e,r){let n=e.createDiv({cls:"storyteller-template-card-full"});n.style.padding="1rem",n.style.backgroundColor="var(--background-primary)",n.style.border="1px solid var(--background-modifier-border)",n.style.borderRadius="8px";let s=n.createDiv("storyteller-template-card-header");if(s.style.display="flex",s.style.justifyContent="space-between",s.style.alignItems="center",s.style.marginBottom="0.5rem",s.createEl("h4",{text:r.name}).style.margin="0",r.isBuiltIn){let m=s.createEl("span",{text:w("builtIn")});m.style.fontSize="0.75em",m.style.padding="0.2rem 0.5rem",m.style.backgroundColor="var(--interactive-accent)",m.style.color="var(--text-on-accent)",m.style.borderRadius="4px"}let o=n.createEl("p",{text:r.description});o.style.margin="0.5rem 0",o.style.color="var(--text-muted)",o.style.fontSize="0.9em";let l=n.createDiv("storyteller-template-card-meta");l.style.display="flex",l.style.flexWrap="wrap",l.style.gap="0.5rem",l.style.marginBottom="0.5rem",l.style.fontSize="0.85em";let c=l.createEl("span",{text:r.genre});c.style.padding="0.15rem 0.4rem",c.style.backgroundColor="var(--background-secondary)",c.style.borderRadius="4px";let u=l.createEl("span",{text:r.category});if(u.style.padding="0.15rem 0.4rem",u.style.backgroundColor="var(--background-secondary)",u.style.borderRadius="4px",r.usageCount&&r.usageCount>0){let m=l.createEl("span",{text:w("usedXTimes",r.usageCount)});m.style.padding="0.15rem 0.4rem",m.style.backgroundColor="var(--background-secondary)",m.style.borderRadius="4px"}if(r.entityTypes&&r.entityTypes.length>0){let m=n.createDiv("storyteller-template-card-entity-types");m.style.marginBottom="0.5rem",m.style.fontSize="0.85em",m.createEl("span",{text:w("contains")}),r.entityTypes.forEach(g=>{let y=m.createEl("span",{text:g});y.style.marginLeft="0.25rem",y.style.padding="0.1rem 0.3rem",y.style.backgroundColor="var(--interactive-accent)",y.style.color="var(--text-on-accent)",y.style.borderRadius="3px",y.style.fontSize="0.85em"})}if(r.tags&&r.tags.length>0){let m=n.createDiv("storyteller-template-card-tags");m.style.display="flex",m.style.flexWrap="wrap",m.style.gap="0.25rem",m.style.marginBottom="0.75rem",r.tags.forEach(g=>{let y=m.createEl("span",{text:g});y.style.fontSize="0.75em",y.style.padding="0.1rem 0.3rem",y.style.backgroundColor="var(--background-modifier-border)",y.style.borderRadius="3px"})}let d=n.createDiv("storyteller-template-card-actions");d.style.display="flex",d.style.flexWrap="wrap",d.style.gap="0.5rem",d.style.marginTop="0.75rem",d.style.paddingTop="0.75rem",d.style.borderTop="1px solid var(--background-modifier-border)",d.createEl("button",{text:w("applyTemplate"),cls:"mod-cta"}).addEventListener("click",()=>this.handleUseTemplate(r)),r.isEditable&&(d.createEl("button",{text:w("edit")}).addEventListener("click",()=>this.handleEditTemplate(r,e)),d.createEl("button",{text:w("delete"),cls:"mod-warning"}).addEventListener("click",()=>this.handleDeleteTemplate(r,e))),d.createEl("button",{text:w("duplicate")}).addEventListener("click",()=>this.handleDuplicateTemplate(r,e))}async handleUseTemplate(e){console.log("DashboardView: handleUseTemplate called with template:",e.name),await this.plugin.applyTemplateWithPrompt(e),console.log("DashboardView: applyTemplateWithPrompt completed")}handleEditTemplate(e,r){new Fs(this.app,this.plugin,e,async n=>{await this.renderTemplatesContent(r)}).open()}async handleDeleteTemplate(e,r){if(await this.confirmTemplateDelete(e.name))try{await this.plugin.templateManager.deleteTemplate(e.id),await this.renderTemplatesContent(r),new Qe.Notice(w("templateDeleted",e.name))}catch(s){console.error("Error deleting template:",s),new Qe.Notice(w("failedToDeleteTemplate",s.message))}}async handleDuplicateTemplate(e,r){try{let n=`${e.name}${w("templateCopySuffix")}`;await this.plugin.templateManager.copyTemplate(e.id,n),new Qe.Notice(w("templateDuplicated",n)),await this.renderTemplatesContent(r)}catch(n){console.error("Error duplicating template:",n),new Qe.Notice(w("failedToDuplicateTemplate",n.message))}}async confirmTemplateDelete(e){return new Promise(r=>{new sP(this.app,e,r).open()})}async onClose(){var e;(e=this.fileInput)==null||e.remove(),this.fileInput=null,this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null),this.dismissalTimer&&(clearTimeout(this.dismissalTimer),this.dismissalTimer=null),this.isUserTyping=!1,this.currentSearchInput=null,this.networkGraphRenderer&&(this.networkGraphRenderer.destroy(),this.networkGraphRenderer=null)}},sP=class extends Qe.Modal{constructor(t,e,r){super(t),this.templateName=e,this.onConfirm=r}onOpen(){let{contentEl:t}=this;t.createEl("h2",{text:w("deleteTemplate")}),t.createEl("p",{text:w("confirmDeleteTemplate",this.templateName)});let e=t.createDiv({cls:"modal-button-container"});e.style.display="flex",e.style.gap="0.5rem",e.style.justifyContent="flex-end",e.style.marginTop="1rem",e.createEl("button",{text:w("cancel")}).addEventListener("click",()=>{this.onConfirm(!1),this.close()}),e.createEl("button",{text:w("delete"),cls:"mod-warning"}).addEventListener("click",()=>{this.onConfirm(!0),this.close()})}};nP();var yo=require("obsidian");St();wk();var If=class a{constructor(t){this.plugin=t}async getTracks(){return this.plugin.settings.timelineTracks||[]}async saveTracks(t){this.plugin.settings.timelineTracks=t,await this.plugin.saveSettings()}async addTrack(t){let e=await this.getTracks(),r=a.validateTrack(t);if(!r.valid)throw new Error(`Invalid track: ${r.errors.join(", ")}`);if(t.id||(t.id=`track-${Date.now()}`),e.find(n=>n.id===t.id)&&(t.id=`track-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),t.sortOrder===void 0){let n=Math.max(...e.map(s=>s.sortOrder||0),-1);t.sortOrder=n+1}return e.push(t),await this.saveTracks(e),t}async updateTrack(t,e){let r=await this.getTracks(),n=r.findIndex(l=>l.id===t);if(n===-1)return null;let s={...r[n],...e,id:t},o=a.validateTrack(s);if(!o.valid)throw new Error(`Invalid track: ${o.errors.join(", ")}`);return r[n]=s,await this.saveTracks(r),s}async deleteTrack(t){let e=await this.getTracks(),r=e.filter(n=>n.id!==t);return r.length===e.length?!1:(await this.saveTracks(r),!0)}async getTrack(t){return(await this.getTracks()).find(r=>r.id===t)||null}async reorderTracks(t){let e=await this.getTracks(),r=new Map(e.map(s=>[s.id,s])),n=[];t.forEach((s,o)=>{let l=r.get(s);l&&(l.sortOrder=o,n.push(l),r.delete(s))}),r.forEach(s=>{s.sortOrder=n.length,n.push(s)}),await this.saveTracks(n)}async toggleTrackVisibility(t){let e=await this.getTrack(t);return e?(e.visible=!e.visible,await this.updateTrack(t,{visible:e.visible}),e.visible):!1}async initializeDefaultTracks(){if((await this.getTracks()).length>0)return;let e=[a.createGlobalTrack()];await this.saveTracks(e)}async generateEntityTracks(t={}){let{characters:e=!1,locations:r=!1,groups:n=!1,hideByDefault:s=!0}=t,o=await this.getTracks(),l=0;if(e){let c=await this.plugin.listCharacters(),u=a.createCharacterTracks(c);for(let d of u)o.find(h=>h.id===d.id)||(d.visible=!s,await this.addTrack(d),l++)}if(r){let c=await this.plugin.listLocations(),u=a.createLocationTracks(c);for(let d of u)o.find(h=>h.id===d.id)||(d.visible=!s,await this.addTrack(d),l++)}if(n){let u=this.plugin.getGroups().map((d,h)=>({id:`track-group-${d.id}`,name:`${d.name} Timeline`,type:"group",entityId:d.id,description:`Events for ${d.name}`,color:d.color||a.generateTrackColor(h),sortOrder:h+2e3,visible:!s}));for(let d of u)o.find(h=>h.id===d.id)||(await this.addTrack(d),l++)}return l}static getEventsForTrack(t,e){return t.type==="global"?e:t.type==="character"&&t.entityId?e.filter(r=>{var n;return(n=r.characters)==null?void 0:n.includes(t.entityId)}):t.type==="location"&&t.entityId?e.filter(r=>r.location===t.entityId):t.type==="group"&&t.entityId?e.filter(r=>{var n;return(n=r.groups)==null?void 0:n.includes(t.entityId)}):t.type==="custom"&&t.filterCriteria?e.filter(r=>{let n=t.filterCriteria,s=!0;return n.characters&&n.characters.length>0&&(n.characters.some(l=>{var c;return(c=r.characters)==null?void 0:c.includes(l)})||(s=!1)),n.locations&&n.locations.length>0&&(!r.location||!n.locations.includes(r.location))&&(s=!1),n.tags&&n.tags.length>0&&(n.tags.some(l=>{var c;return(c=r.tags)==null?void 0:c.includes(l)})||(s=!1)),n.groups&&n.groups.length>0&&(n.groups.some(l=>{var c;return(c=r.groups)==null?void 0:c.includes(l)})||(s=!1)),n.status&&n.status.length>0&&(!r.status||!n.status.includes(r.status))&&(s=!1),n.milestonesOnly===!0&&(r.isMilestone||(s=!1)),s}):[]}static createCharacterTracks(t){return t.map((e,r)=>({id:`track-character-${e.id||e.name}`,name:`${e.name}'s Timeline`,type:"character",entityId:e.name,description:`Personal timeline for ${e.name}`,color:this.generateTrackColor(r),sortOrder:r+100,visible:!1}))}static createLocationTracks(t){return t.map((e,r)=>({id:`track-location-${e.id||e.name}`,name:`${e.name} Timeline`,type:"location",entityId:e.name,description:`Events at ${e.name}`,color:this.generateTrackColor(r+100),sortOrder:r+1e3,visible:!1}))}static createGlobalTrack(){return{id:"track-global",name:"Global Timeline",type:"global",description:"All events across the entire story",color:"#cccccc",sortOrder:0,visible:!0}}static getVisibleTracks(t){return t.filter(e=>e.visible!==!1).sort((e,r)=>{var o,l;let n=(o=e.sortOrder)!=null?o:999,s=(l=r.sortOrder)!=null?l:999;return n-s})}static validateTrack(t){let e=[];return(!t.name||t.name.trim()==="")&&e.push("Track name is required"),t.type||e.push("Track type is required"),(t.type==="character"||t.type==="location"||t.type==="group")&&!t.entityId&&e.push(`Entity ID is required for ${t.type} tracks`),t.type==="custom"&&!t.filterCriteria&&e.push("Filter criteria is required for custom tracks"),{valid:e.length===0,errors:e}}static generateTrackColor(t){return`hsl(${t*137.508%360}, 70%, 60%)`}static getTrackStats(t,e){let r=this.getEventsForTrack(t,e),n=r.filter(l=>l.isMilestone).length,s=r.filter(l=>l.dateTime);if(s.length===0)return{eventCount:r.length,milestoneCount:n};let o=s.map(l=>l.dateTime).sort();return{eventCount:r.length,dateRange:{start:o[0],end:o[o.length-1]},milestoneCount:n}}static findTracksForEvent(t,e){return e.filter(r=>this.getEventsForTrack(r,[t]).length>0)}static mergeTracks(t,e){let r={characters:[],locations:[],tags:[],groups:[],status:[]};for(let n of t)n.type==="character"&&n.entityId?r.characters.push(n.entityId):n.type==="location"&&n.entityId?r.locations.push(n.entityId):n.type==="group"&&n.entityId?r.groups.push(n.entityId):n.type==="custom"&&n.filterCriteria&&(n.filterCriteria.characters&&r.characters.push(...n.filterCriteria.characters),n.filterCriteria.locations&&r.locations.push(...n.filterCriteria.locations),n.filterCriteria.tags&&r.tags.push(...n.filterCriteria.tags),n.filterCriteria.groups&&r.groups.push(...n.filterCriteria.groups),n.filterCriteria.status&&r.status.push(...n.filterCriteria.status));return r.characters=[...new Set(r.characters)],r.locations=[...new Set(r.locations)],r.tags=[...new Set(r.tags)],r.groups=[...new Set(r.groups)],r.status=[...new Set(r.status)],{id:`track-merged-${Date.now()}`,name:e,type:"custom",description:`Merged track from ${t.length} tracks`,filterCriteria:r,sortOrder:500,visible:!0}}};xk();kk();au();var Af="storyteller-timeline-view",vv=class extends yo.ItemView{constructor(e,r){super(e);this.renderer=null;this.toolbarEl=null;this.filterToggleEl=null;this.advancedFiltersEl=null;this.advancedFiltersContent=null;this.timelineContainer=null;this.footerEl=null;this.footerStatusEl=null;this.advancedFiltersExpanded=!1;this.resizeObserver=null;this.plugin=r,this.currentState=nc.createDefaultState(r);let n={onStateChange:()=>this.updateFooterStatus(),onRendererUpdate:()=>this.buildTimeline(),getRenderer:()=>this.renderer,getEvents:()=>this.plugin.listEvents()},s={onFilterChange:()=>this.updateFooterStatus(),getRenderer:()=>this.renderer};this.controlsBuilder=new nc(r,this.currentState,n),this.filterBuilder=new rf(r,this.currentState,s)}getViewType(){return Af}getDisplayText(){return w("timeline")}getIcon(){return"clock"}async onOpen(){let e=this.containerEl.children[1];e.empty(),e.addClass("storyteller-timeline-view"),this.currentState.ganttMode&&e.addClass("gantt-mode"),this.toolbarEl=e.createDiv("storyteller-timeline-toolbar"),this.filterToggleEl=e.createDiv("storyteller-timeline-filter-toggle"),this.advancedFiltersEl=e.createDiv("storyteller-timeline-advanced-filters"),this.timelineContainer=e.createDiv("storyteller-timeline-container"),this.footerEl=e.createDiv("storyteller-timeline-footer"),this.buildToolbar(),this.buildFilterToggle(),await this.buildAdvancedFilters(),await this.buildTimeline(),this.buildFooter(),this.setupResizeObserver()}buildToolbar(){if(!this.toolbarEl)return;this.toolbarEl.empty(),this.controlsBuilder.createGanttToggle(this.toolbarEl),this.controlsBuilder.createGroupingDropdown(this.toolbarEl);let r=this.toolbarEl.createDiv("storyteller-fork-container").createEl("select",{cls:"dropdown storyteller-fork-select",attr:{"aria-label":"Timeline fork"}}),n=r.createEl("option",{value:"main",text:"Main Timeline"});n.selected=!0,this.plugin.getTimelineForks().forEach(y=>{let v=r.createEl("option",{value:y.id,text:`\u{1F500} ${y.name}`});y.color&&(v.style.color=y.color)}),r.addEventListener("change",async()=>{let y=r.value;if(this.currentState.currentForkId=y==="main"?void 0:y,y==="main")this.currentState.filters={...this.currentState.filters,forkId:void 0};else{let v=this.plugin.getTimelineFork(y);v&&(this.currentState.filters={...this.currentState.filters,forkId:v.id})}await this.buildTimeline(),this.updateFooterStatus()});let o=this.plugin.settings.timelineConflicts||[],l=o.filter(y=>!y.dismissed);if(l.length>0){let y=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn storyteller-conflict-badge",attr:{"aria-label":`${l.length} timeline conflicts`,title:`View ${l.length} timeline conflict(s)`}});y.innerHTML=`<span class="storyteller-badge-icon">\u26A0\uFE0F</span><span class="storyteller-badge-count">${l.length}</span>`,y.addEventListener("click",async()=>{let{ConflictListModal:v}=await Promise.resolve().then(()=>(aE(),nE));new v(this.app,this.plugin,o,async()=>{await this.refresh()}).open()})}this.controlsBuilder.createFitButton(this.toolbarEl),this.controlsBuilder.createDecadeButton(this.toolbarEl),this.controlsBuilder.createCenturyButton(this.toolbarEl),this.controlsBuilder.createTodayButton(this.toolbarEl),this.controlsBuilder.createEditModeToggle(this.toolbarEl),this.controlsBuilder.createNarrativeOrderToggle(this.toolbarEl),this.controlsBuilder.createEraToggle(this.toolbarEl);let c=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":"Manage timeline eras",title:"Manage timeline eras"}});(0,yo.setIcon)(c,"calendar-range"),c.addEventListener("click",async()=>{let{EraListModal:y}=await Promise.resolve().then(()=>(F0(),O0));new y(this.app,this.plugin).open()});let u=this.toolbarEl.createDiv("storyteller-track-selector"),d=u.createEl("span",{text:"Track: ",cls:"storyteller-track-label"}),h=new yo.DropdownComponent(u);h.addOption("","All Events (Global)");let f=this.plugin.settings.timelineTracks||[],m=If.getVisibleTracks(f);for(let y of m)h.addOption(y.id,y.name);h.setValue(this.currentState.currentTrackId||""),h.onChange(async y=>{this.currentState.currentTrackId=y||void 0,await this.applyTrackFilter(y)});let g=this.toolbarEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("export"),title:w("export")}});(0,yo.setIcon)(g,"download"),g.addEventListener("click",()=>this.showExportMenu(g)),this.controlsBuilder.createRefreshButton(this.toolbarEl)}buildFilterToggle(){if(!this.filterToggleEl)return;this.filterToggleEl.empty();let e=this.filterToggleEl.createEl("label",{text:w("milestonesOnly"),cls:"storyteller-filter-label"}),r=this.filterToggleEl.createEl("input",{type:"checkbox",cls:"storyteller-filter-checkbox"});r.checked=this.currentState.filters.milestonesOnly||!1,r.addEventListener("change",()=>{var s;this.currentState.filters.milestonesOnly=r.checked,(s=this.renderer)==null||s.applyFilters(this.currentState.filters),this.updateFooterStatus()}),e.prepend(r);let n=this.filterToggleEl.createEl("button",{cls:"clickable-icon storyteller-toolbar-btn",attr:{"aria-label":w("filters"),title:w("filters")}});(0,yo.setIcon)(n,"filter"),n.addEventListener("click",()=>{this.advancedFiltersExpanded=!this.advancedFiltersExpanded,this.advancedFiltersContent&&(this.advancedFiltersContent.style.display=this.advancedFiltersExpanded?"block":"none")})}async buildAdvancedFilters(){if(!this.advancedFiltersEl)return;this.advancedFiltersEl.empty(),this.advancedFiltersContent=this.advancedFiltersEl.createDiv("storyteller-advanced-filters-content"),this.advancedFiltersContent.style.display=this.advancedFiltersExpanded?"block":"none";let e=await this.plugin.listEvents();await this.filterBuilder.buildFilterPanel(this.advancedFiltersContent,e)}async buildTimeline(){var e;this.timelineContainer&&(this.timelineContainer.empty(),this.timelineContainer.style.flexGrow="1",this.timelineContainer.style.overflow="auto",this.renderer=new Xh(this.timelineContainer,this.plugin,{ganttMode:this.currentState.ganttMode,groupMode:this.currentState.groupMode,stackEnabled:this.currentState.stackEnabled,density:this.currentState.density,editMode:this.currentState.editMode,showEras:this.currentState.showEras,narrativeOrder:this.currentState.narrativeOrder,defaultGanttDuration:(e=this.plugin.settings.ganttDefaultDuration)!=null?e:1,onConflictsDetected:r=>this.handleConflicts(r)}),await this.renderer.initialize(),this.renderer.applyFilters(this.currentState.filters))}async handleConflicts(e){let r=Vr.toStorageFormat(e),n=this.plugin.settings.timelineConflicts||[],s=r.map(o=>{let l=n.find(c=>c.id===o.id);return l?{...o,dismissed:l.dismissed}:o});JSON.stringify(s)!==JSON.stringify(n)&&(this.plugin.settings.timelineConflicts=s,await this.plugin.saveSettings(),this.buildToolbar())}buildFooter(){this.footerEl&&(this.footerEl.empty(),this.footerStatusEl=this.footerEl.createEl("span",{cls:"storyteller-timeline-status",attr:{"aria-live":"polite"}}),this.updateFooterStatus())}async applyTrackFilter(e){let r={...this.currentState.filters,characters:void 0,locations:void 0,groups:void 0,tags:void 0};if(!e){this.currentState.filters=r,await this.buildTimeline(),this.updateFooterStatus();return}let n=this.plugin.getTimelineTrack(e);if(!n){console.error(`Track not found: ${e}`),this.currentState.filters=r,await this.buildTimeline(),this.updateFooterStatus();return}n.type==="global"?r.milestonesOnly=!1:n.type==="character"&&n.entityId?r.characters=new Set([n.entityId]):n.type==="location"&&n.entityId?r.locations=new Set([n.entityId]):n.type==="group"&&n.entityId?r.groups=new Set([n.entityId]):n.type==="custom"&&n.filterCriteria&&(n.filterCriteria.characters&&n.filterCriteria.characters.length>0&&(r.characters=new Set(n.filterCriteria.characters)),n.filterCriteria.locations&&n.filterCriteria.locations.length>0&&(r.locations=new Set(n.filterCriteria.locations)),n.filterCriteria.groups&&n.filterCriteria.groups.length>0&&(r.groups=new Set(n.filterCriteria.groups)),n.filterCriteria.tags&&n.filterCriteria.tags.length>0&&(r.tags=new Set(n.filterCriteria.tags)),r.milestonesOnly=n.filterCriteria.milestonesOnly||!1),this.currentState.filters=r,await this.buildTimeline(),this.updateFooterStatus()}updateFooterStatus(){if(!this.footerStatusEl||!this.renderer)return;let e=this.renderer.getEventCount(),r=this.renderer.getDateRange();if(e===0)this.footerStatusEl.setText(w("noEventsFound"));else{let n=`${e} event${e!==1?"s":""}`;if(r){let s=r.start.toLocaleDateString(),o=r.end.toLocaleDateString();n+=` \u2022 ${s} \u2014 ${o}`}this.currentState.ganttMode&&(n+=` \u2022 ${w("ganttView")}`),this.footerStatusEl.setText(n)}}setupResizeObserver(){this.resizeObserver=new ResizeObserver(()=>{this.onResize()}),this.resizeObserver.observe(this.containerEl)}onResize(){this.renderer}showExportMenu(e){let r=new yo.Menu;r.addItem(n=>{n.setTitle(w("exportAsPNG")).setIcon("image").onClick(()=>{var s;(s=this.renderer)==null||s.exportAsImage("png")})}),r.addItem(n=>{n.setTitle(w("exportAsJPG")).setIcon("image").onClick(()=>{var s;(s=this.renderer)==null||s.exportAsImage("jpg")})}),r.showAtMouseEvent(new MouseEvent("click",{clientX:e.getBoundingClientRect().left,clientY:e.getBoundingClientRect().bottom}))}getState(){var r;let e=(r=this.renderer)==null?void 0:r.getVisibleRange();return{ganttMode:this.currentState.ganttMode,groupMode:this.currentState.groupMode,stackEnabled:this.currentState.stackEnabled,density:this.currentState.density,editMode:this.currentState.editMode,filters:{milestonesOnly:this.currentState.filters.milestonesOnly,characters:this.currentState.filters.characters?Array.from(this.currentState.filters.characters):void 0,locations:this.currentState.filters.locations?Array.from(this.currentState.filters.locations):void 0,groups:this.currentState.filters.groups?Array.from(this.currentState.filters.groups):void 0},visibleRange:e?{start:e.start.toISOString(),end:e.end.toISOString()}:void 0}}async setState(e,r){var n,s,o,l,c,u,d;if(await super.setState(e,r),e&&(this.currentState={ganttMode:(n=e.ganttMode)!=null?n:!1,groupMode:(s=e.groupMode)!=null?s:"none",stackEnabled:(o=e.stackEnabled)!=null?o:!0,density:(l=e.density)!=null?l:50,editMode:(c=e.editMode)!=null?c:!1,filters:e.filters||{},showEras:(u=e.showEras)!=null?u:!1,narrativeOrder:(d=e.narrativeOrder)!=null?d:!1},e.filters&&(e.filters.characters&&Array.isArray(e.filters.characters)&&(this.currentState.filters.characters=new Set(e.filters.characters)),e.filters.locations&&Array.isArray(e.filters.locations)&&(this.currentState.filters.locations=new Set(e.filters.locations)),e.filters.groups&&Array.isArray(e.filters.groups)&&(this.currentState.filters.groups=new Set(e.filters.groups))),e.visibleRange&&this.renderer))try{let h=new Date(e.visibleRange.start),f=new Date(e.visibleRange.end);setTimeout(()=>{this.renderer&&this.renderer.setVisibleRange(h,f)},100)}catch(h){console.warn("Timeline: Could not restore visible range from state:",h)}}async onClose(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.renderer&&(this.renderer.destroy(),this.renderer=null)}async refresh(){this.renderer&&(await this.renderer.refresh(),this.updateFooterStatus())}};var xn=require("obsidian"),yv="storyteller-analytics-view",sE=class extends xn.ItemView{constructor(e,r){super(e);this.analytics=null;this.refreshing=!1;this.contentContainer=null;this.plugin=r}getViewType(){return yv}getDisplayText(){return"Writing Analytics"}getIcon(){return"bar-chart-2"}async onOpen(){let e=this.containerEl.children[1];e.empty(),e.addClass("storyteller-analytics-view"),this.contentContainer=e,this.buildHeader(),await this.refreshAnalytics(),this.renderAnalytics()}buildHeader(){if(!this.contentContainer)return;let e=this.contentContainer.createDiv("storyteller-analytics-header");e.createEl("h2",{text:"Writing Analytics"});let r=e.createDiv("storyteller-analytics-toolbar");r.createEl("button",{cls:"mod-cta",text:"Refresh Analytics"}).addEventListener("click",async()=>{await this.refreshAnalytics(),this.renderAnalytics()}),r.createEl("button",{text:"Export Report"}).addEventListener("click",()=>{this.exportAnalyticsReport()})}async refreshAnalytics(){if(!this.refreshing){this.refreshing=!0;try{this.analytics=await this.calculateAnalytics(),this.plugin.settings.analyticsData=this.analytics,await this.plugin.saveSettings()}catch(e){console.error("Error refreshing analytics:",e),new xn.Notice("Failed to refresh analytics")}finally{this.refreshing=!1}}}async calculateAnalytics(){var m;let e=await this.plugin.listCharacters(),r=await this.plugin.listEvents(),n=await this.plugin.listScenes(),s=await this.plugin.listChapters(),o=e.map(g=>{let y=r.filter(v=>{var E;return(E=v.characters)==null?void 0:E.includes(g.name)}).length+n.filter(v=>{var E;return(E=v.linkedCharacters)==null?void 0:E.includes(g.name)}).length;return{characterName:g.name,appearances:y,percentage:r.length>0?y/r.length*100:0}}).sort((g,y)=>y.appearances-g.appearances),l=this.calculateEventDistribution(r),c=this.calculatePOVStats(n,s),u=this.plugin.settings.writingSessions||[],d=this.calculateVelocity(u),h=((m=this.plugin.settings.analyticsData)==null?void 0:m.foreshadowing)||[],f={totalLines:0,byCharacter:{},density:0};return{lastUpdated:new Date().toISOString(),totalWords:this.calculateTotalWords(n,s),characterScreenTime:o,eventDistribution:l,povStats:c,velocity:d,foreshadowing:h,dialogueAnalysis:f}}calculateEventDistribution(e){let r={};e.forEach(s=>{if(s.dateTime){let o=s.dateTime.split("-")[0];r[o]=(r[o]||0)+1}});let n=e.length;return Object.entries(r).map(([s,o])=>({category:s,count:o,percentage:o/n*100})).sort((s,o)=>s.category.localeCompare(o.category))}calculatePOVStats(e,r){let n={},s=e.length;return e.forEach(o=>{if(o.linkedCharacters&&o.linkedCharacters.length>0){let l=o.linkedCharacters[0];n[l]=(n[l]||0)+1}}),Object.entries(n).map(([o,l])=>({character:o,sceneCount:l,percentage:l/s*100})).sort((o,l)=>l.sceneCount-o.sceneCount)}calculateVelocity(e){let r={};return e.forEach(n=>{let s=n.startTime.split("T")[0];r[s]=(r[s]||0)+n.wordsWritten}),Object.entries(r).map(([n,s])=>({date:n,wordsWritten:s})).sort((n,s)=>n.date.localeCompare(s.date))}calculateTotalWords(e,r){let n=0;return e.forEach(s=>{s.content&&(n+=s.content.split(/\s+/).length)}),n}renderAnalytics(){if(!this.contentContainer||!this.analytics)return;let e=this.contentContainer.querySelector(".storyteller-analytics-content");e&&e.remove();let r=this.contentContainer.createDiv("storyteller-analytics-content");this.renderOverview(r),this.renderCharacterScreenTime(r),this.renderEventDistribution(r),this.renderPOVStats(r),this.renderWritingVelocity(r),this.renderForeshadowing(r),this.renderWritingSessions(r)}renderOverview(e){var s,o,l,c,u,d,h,f;let r=e.createDiv("storyteller-analytics-section");r.createEl("h3",{text:"Overview"});let n=r.createDiv("storyteller-analytics-grid");this.createStatCard(n,"Total Words",((o=(s=this.analytics)==null?void 0:s.totalWords)==null?void 0:o.toLocaleString())||"0","\u{1F4DD}"),this.createStatCard(n,"Characters",((c=(l=this.analytics)==null?void 0:l.characterScreenTime)==null?void 0:c.length.toString())||"0","\u{1F465}"),this.createStatCard(n,"Events",((d=(u=this.analytics)==null?void 0:u.eventDistribution)==null?void 0:d.reduce((m,g)=>m+g.count,0).toString())||"0","\u{1F4C5}"),this.createStatCard(n,"POVs",((f=(h=this.analytics)==null?void 0:h.povStats)==null?void 0:f.length.toString())||"0","\u{1F441}\uFE0F")}createStatCard(e,r,n,s){let o=e.createDiv("storyteller-stat-card");o.createDiv("storyteller-stat-icon").setText(s),o.createDiv("storyteller-stat-value").setText(n),o.createDiv("storyteller-stat-label").setText(r)}renderCharacterScreenTime(e){var c;let r=e.createDiv("storyteller-analytics-section");if(r.createEl("h3",{text:"Character Screen Time"}),!((c=this.analytics)!=null&&c.characterScreenTime)||this.analytics.characterScreenTime.length===0){r.createEl("p",{text:"No character data available"});return}let n=r.createEl("table",{cls:"storyteller-analytics-table"}),o=n.createEl("thead").createEl("tr");o.createEl("th",{text:"Character"}),o.createEl("th",{text:"Appearances"}),o.createEl("th",{text:"Percentage"}),o.createEl("th",{text:"Bar"});let l=n.createEl("tbody");this.analytics.characterScreenTime.forEach(u=>{var g;let d=l.createEl("tr");d.createEl("td",{text:u.characterName}),d.createEl("td",{text:u.appearances.toString()}),d.createEl("td",{text:`${(g=u.percentage)==null?void 0:g.toFixed(1)}%`});let m=d.createEl("td").createDiv("storyteller-progress-bar").createDiv("storyteller-progress-fill");m.style.width=`${u.percentage}%`})}renderEventDistribution(e){var o;let r=e.createDiv("storyteller-analytics-section");if(r.createEl("h3",{text:"Event Distribution"}),!((o=this.analytics)!=null&&o.eventDistribution)||this.analytics.eventDistribution.length===0){r.createEl("p",{text:"No event data available"});return}let n=r.createDiv("storyteller-bar-chart"),s=Math.max(...this.analytics.eventDistribution.map(l=>l.count));this.analytics.eventDistribution.forEach(l=>{let c=n.createDiv("storyteller-bar-item"),d=c.createDiv("storyteller-bar").createDiv("storyteller-bar-fill");d.style.height=`${l.count/s*100}%`,d.setAttribute("title",`${l.count} events`),c.createDiv("storyteller-bar-label").setText(l.category)})}renderPOVStats(e){var s;let r=e.createDiv("storyteller-analytics-section");if(r.createEl("h3",{text:"Point of View Distribution"}),!((s=this.analytics)!=null&&s.povStats)||this.analytics.povStats.length===0){r.createEl("p",{text:"No POV data available"});return}let n=r.createEl("ul",{cls:"storyteller-pov-list"});this.analytics.povStats.forEach(o=>{var c;let l=n.createEl("li");l.createSpan({text:o.character,cls:"storyteller-pov-name"}),l.createSpan({text:` - ${o.sceneCount} scenes (${(c=o.percentage)==null?void 0:c.toFixed(1)}%)`})})}renderWritingVelocity(e){var o;let r=e.createDiv("storyteller-analytics-section");if(r.createEl("h3",{text:"Writing Velocity"}),!((o=this.analytics)!=null&&o.velocity)||this.analytics.velocity.length===0){r.createEl("p",{text:"No writing session data available. Start tracking your writing sessions!"});return}let n=r.createDiv("storyteller-velocity-chart"),s=Math.max(...this.analytics.velocity.map(l=>l.wordsWritten));this.analytics.velocity.slice(-30).forEach(l=>{let c=n.createDiv("storyteller-velocity-item"),d=c.createDiv("storyteller-velocity-bar").createDiv("storyteller-velocity-fill");d.style.height=`${l.wordsWritten/s*100}%`,d.setAttribute("title",`${l.wordsWritten} words on ${l.date}`),c.createDiv("storyteller-velocity-label").setText(l.date.split("-")[2])})}renderForeshadowing(e){var l;let r=e.createDiv("storyteller-analytics-section");if(r.createEl("h3",{text:"Foreshadowing Tracker"}),r.createDiv("storyteller-section-toolbar").createEl("button",{text:"+ Add Foreshadowing",cls:"mod-cta"}).addEventListener("click",()=>{this.addForeshadowing()}),!((l=this.analytics)!=null&&l.foreshadowing)||this.analytics.foreshadowing.length===0){r.createEl("p",{text:"No foreshadowing tracked yet"});return}let o=r.createEl("ul",{cls:"storyteller-foreshadowing-list"});this.analytics.foreshadowing.forEach((c,u)=>{let d=o.createEl("li"),h=c.status==="resolved"?"\u2713":c.status==="planted"?"\u{1F331}":"\u274C";d.createSpan({text:`${h} `,cls:"storyteller-foreshadow-status"}),d.createSpan({text:c.setup,cls:"storyteller-foreshadow-setup"}),c.payoff&&d.createSpan({text:` \u2192 ${c.payoff}`})})}renderWritingSessions(e){let r=e.createDiv("storyteller-analytics-section");r.createEl("h3",{text:"Recent Writing Sessions"});let n=this.plugin.settings.writingSessions||[];if(n.length===0){r.createEl("p",{text:"No writing sessions tracked yet"});return}let s=r.createEl("ul",{cls:"storyteller-sessions-list"});n.slice(-10).reverse().forEach(o=>{let l=s.createEl("li"),c=new Date(o.startTime).toLocaleDateString(),u=o.wordsWritten;l.setText(`${c} - ${u} words`)})}addForeshadowing(){new lP(this.app,this.plugin,null,async r=>{this.analytics||(this.analytics=await this.calculateAnalytics()),this.analytics.foreshadowing||(this.analytics.foreshadowing=[]),this.analytics.foreshadowing.push(r),this.plugin.settings.analyticsData=this.analytics,await this.plugin.saveSettings(),this.renderAnalytics(),new xn.Notice("Foreshadowing added")}).open()}exportAnalyticsReport(){if(!this.analytics){new xn.Notice("No analytics data to export");return}let e=this.generateMarkdownReport(),r=`Analytics-Report-${new Date().toISOString().split("T")[0]}.md`,n=`${r}`;this.app.vault.create(n,e).then(()=>{new xn.Notice(`Analytics report exported to ${r}`)}).catch(s=>{console.error("Error exporting report:",s),new xn.Notice("Failed to export analytics report")})}generateMarkdownReport(){var r,n,s;if(!this.analytics)return"";let e=`# Writing Analytics Report

`;return e+=`Generated: ${new Date().toLocaleString()}

`,e+=`## Overview

`,e+=`- **Total Words**: ${((r=this.analytics.totalWords)==null?void 0:r.toLocaleString())||0}
`,e+=`- **Characters**: ${((n=this.analytics.characterScreenTime)==null?void 0:n.length)||0}
`,e+=`- **Events**: ${((s=this.analytics.eventDistribution)==null?void 0:s.reduce((o,l)=>o+l.count,0))||0}

`,this.analytics.characterScreenTime&&this.analytics.characterScreenTime.length>0&&(e+=`## Character Screen Time

`,e+=`| Character | Appearances | Percentage |
`,e+=`|-----------|-------------|------------|
`,this.analytics.characterScreenTime.forEach(o=>{var l;e+=`| ${o.characterName} | ${o.appearances} | ${(l=o.percentage)==null?void 0:l.toFixed(1)}% |
`}),e+=`
`),this.analytics.povStats&&this.analytics.povStats.length>0&&(e+=`## POV Distribution

`,this.analytics.povStats.forEach(o=>{var l;e+=`- **${o.character}**: ${o.sceneCount} scenes (${(l=o.percentage)==null?void 0:l.toFixed(1)}%)
`}),e+=`
`),e}async onClose(){}},lP=class extends xn.Modal{constructor(t,e,r,n){super(t),this.plugin=e,this.onSubmit=n,this.pair=r||{setup:"",payoff:"",status:"planted"}}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Add Foreshadowing"}),new xn.Setting(t).setName("Setup/Hint").setDesc("The foreshadowing element or hint").addText(e=>e.setValue(this.pair.setup).onChange(r=>this.pair.setup=r)),new xn.Setting(t).setName("Payoff (optional)").setDesc("The resolution or reveal").addText(e=>e.setValue(this.pair.payoff||"").onChange(r=>this.pair.payoff=r)),new xn.Setting(t).setName("Status").addDropdown(e=>e.addOption("planted","Planted").addOption("resolved","Resolved").addOption("abandoned","Abandoned").setValue(this.pair.status).onChange(r=>this.pair.status=r)),new xn.Setting(t).addButton(e=>e.setButtonText("Save").setCta().onClick(()=>{if(!this.pair.setup){new xn.Notice("Setup is required");return}this.onSubmit(this.pair),this.close()})).addButton(e=>e.setButtonText("Cancel").onClick(()=>this.close()))}onClose(){this.contentEl.empty()}};qw();var mt=require("obsidian");var Of=require("obsidian");St();var oE=class extends Of.Modal{constructor(e,r,n,s,o){super(e);this.name="";this.description="";this.plugin=r,this.story=n,this.onSubmit=o,this.existingNames=s.filter(l=>l!==n.name).map(l=>l.toLowerCase()),this.name=n.name,this.description=n.description||""}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:w("editStory")}),new Of.Setting(e).setName(w("storyNameField")).setDesc(w("storyNameDesc")).addText(n=>{this.nameInput=n,n.setPlaceholder(w("enterStoryNamePh")).setValue(this.name).onChange(s=>{this.name=s.trim(),this.clearError()}),n.inputEl.addEventListener("keydown",s=>{s.key==="Enter"&&(s.preventDefault(),this.trySubmit())}),n.inputEl.focus()}),new Of.Setting(e).setName(w("descriptionField")).setDesc(w("descriptionOptionalDesc")).addTextArea(n=>{this.descInput=n,n.setPlaceholder(w("describeStoryPh")).setValue(this.description).onChange(s=>{this.description=s}),n.inputEl.rows=3}),this.errorEl=e.createEl("div",{cls:"storyteller-modal-error"}),this.clearError();let r=new Of.Setting(e);r.addButton(n=>n.setButtonText(w("cancel")).onClick(()=>this.close())),r.addButton(n=>n.setButtonText(w("saveChanges")).setCta().onClick(()=>this.trySubmit()))}clearError(){this.errorEl.textContent=""}showError(e){this.errorEl.textContent=e,this.errorEl.style.color="var(--text-error, red)"}async trySubmit(){if(!this.name){this.showError("Story name is required."),this.nameInput.inputEl.focus();return}if(this.existingNames.includes(this.name.toLowerCase())){this.showError("A story with this name already exists."),this.nameInput.inputEl.focus();return}try{await this.onSubmit(this.name,this.description),this.close()}catch(e){this.showError("Failed to update story.")}}onClose(){this.contentEl.empty()}};var lE=require("obsidian");St();var Na=class extends lE.SuggestModal{constructor(e,r,n){super(e);this.allFolderPaths=[];this.appRef=e,this.onChoose=r,this.onCloseCb=n,this.setPlaceholder(w("filterFoldersPh")),this.allFolderPaths=this.collectAllFolderPaths()}collectAllFolderPaths(){let e=[],r=this.appRef.vault.getRoot(),n=s=>{s.path&&!e.includes(s.path)&&e.push(s.path);for(let o of s.children)o instanceof lE.TFolder&&n(o)};return n(r),e.sort((s,o)=>s.localeCompare(o)),e}getSuggestions(e){let r=(e||"").toLowerCase();return r?this.allFolderPaths.filter(n=>n.toLowerCase().includes(r)).slice(0,200):this.allFolderPaths.slice(0,200)}renderSuggestion(e,r){r.createEl("div",{text:e})}onChooseSuggestion(e){this.onChoose(e)}onClose(){if(this.onCloseCb)try{this.onCloseCb()}catch(e){}super.onClose()}};St();var cE=class extends mt.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e}display(){let{containerEl:t}=this;t.empty(),this.plugin.settings.showTutorial&&this.addTutorialSection(t),new mt.Setting(t).setName(w("language")).setDesc(w("selectLanguage")).addDropdown(r=>{OI().forEach(o=>{r.addOption(o,FI(o))});let s=RI(this.plugin.settings.language)?this.plugin.settings.language:"en";r.setValue(s),r.onChange(async o=>{this.plugin.settings.language=o,await this.plugin.saveSettings(),Uy(o),new mt.Notice(w("languageChanged")),this.display()})}),new mt.Setting(t).setName(w("dashboardTabVisibility")).setHeading(),new mt.Setting(t).setDesc(w("dashboardTabVisibilityDesc")),[{id:"characters",name:w("characters")},{id:"locations",name:w("locations")},{id:"events",name:w("timeline")},{id:"items",name:w("items")},{id:"network",name:w("networkGraph")},{id:"gallery",name:w("gallery")},{id:"groups",name:w("groups")},{id:"references",name:w("references")},{id:"chapters",name:w("chapters")},{id:"scenes",name:w("scenes")},{id:"cultures",name:w("cultures")},{id:"economies",name:w("economies")},{id:"magicsystems",name:w("magicSystems")},{id:"templates",name:w("templates")}].forEach(r=>{let s=!(this.plugin.settings.hiddenDashboardTabs||[]).includes(r.id);new mt.Setting(t).setName(r.name).addToggle(o=>o.setValue(s).setTooltip(s?w("tabIsVisible"):w("tabIsHidden")).onChange(async l=>{let c=this.plugin.settings.hiddenDashboardTabs||[];l?this.plugin.settings.hiddenDashboardTabs=c.filter(d=>d!==r.id):c.includes(r.id)||(this.plugin.settings.hiddenDashboardTabs=[...c,r.id]),await this.plugin.saveSettings();let u=l?w("tabShown",r.name):w("tabHidden",r.name);new mt.Notice(u+w("refreshDashboardToSeeChanges"))}))}),new mt.Setting(t).setName(w("stories")).setHeading(),this.plugin.settings.stories.forEach(r=>{let n=this.plugin.settings.activeStoryId===r.id;new mt.Setting(t).setName(r.name).setDesc(r.description||"").addButton(s=>s.setButtonText(n?w("active"):w("setActive")).setCta().setDisabled(n).onClick(async()=>{await this.plugin.setActiveStory(r.id),this.display()})).addExtraButton(s=>s.setIcon("pencil").setTooltip(w("editStory")).onClick(async()=>{let o=this.plugin.settings.stories.map(l=>l.name);new oE(this.app,this.plugin,r,o,async(l,c)=>{await this.plugin.updateStory(r.id,l,c),this.display()}).open()})).addExtraButton(s=>s.setIcon("trash").setTooltip(w("delete")).onClick(async()=>{var o;confirm(w("confirmDeleteStory",r.name))&&(this.plugin.settings.stories=this.plugin.settings.stories.filter(l=>l.id!==r.id),this.plugin.settings.activeStoryId===r.id&&(this.plugin.settings.activeStoryId=((o=this.plugin.settings.stories[0])==null?void 0:o.id)||""),await this.plugin.saveSettings(),this.display())}))}),new mt.Setting(t).addButton(r=>r.setButtonText(w("createNewStory")).setCta().onClick(async()=>{let n=this.plugin.settings.stories.map(s=>s.name);new sc(this.app,this.plugin,n,async(s,o)=>{await this.plugin.createStory(s,o),this.display()}).open()})),new mt.Setting(t).setName(w("storyDiscovery")).setDesc(w("scanVaultDesc")).addButton(r=>r.setButtonText(w("refreshDiscovery")).setTooltip(w("scanVaultDesc")).onClick(async()=>{r.setDisabled(!0);try{await this.plugin.refreshStoryDiscovery()}finally{r.setDisabled(!1),this.display()}})),new mt.Setting(t).setName(w("galleryUploadFolder")).setDesc(w("galleryFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("galleryUploadFolderPh")).setValue(this.plugin.settings.galleryUploadFolder).onChange(async l=>{this.plugin.settings.galleryUploadFolder=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.galleryUploadFolder=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("timelineAndParsing")).setHeading(),new mt.Setting(t).setName(w("customFieldsSerialization")).setDesc(w("customFieldsDesc")).addDropdown(r=>r.addOption("flatten",w("flattenCustomFields")).addOption("nested",w("nestedCustomFields")).setValue(this.plugin.settings.customFieldsMode||"flatten").onChange(async n=>{this.plugin.settings.customFieldsMode=n,await this.plugin.saveSettings()})),new mt.Setting(t).setName(w("forwardDateBias")).setDesc(w("forwardDateBiasDesc")).addToggle(r=>r.setValue(!1).onChange(async n=>{await this.plugin.saveSettings()})),new mt.Setting(t).setName(w("customToday")).setDesc(w("customTodayDesc")).addText(r=>r.setPlaceholder(w("customTodayPh")).setValue(this.plugin.settings.customTodayISO||"").onChange(async n=>{let s=n.trim();this.plugin.settings.customTodayISO=s||void 0,await this.plugin.saveSettings()})).addExtraButton(r=>r.setIcon("reset").setTooltip(w("clearCustomToday")).onClick(async()=>{this.plugin.settings.customTodayISO=void 0,await this.plugin.saveSettings(),this.display()})),new mt.Setting(t).setName(w("defaultTimelineGrouping")).addDropdown(r=>r.addOptions({none:w("noGrouping"),location:w("byLocation"),group:w("byGroup")}).setValue(this.plugin.settings.defaultTimelineGroupMode||"none").onChange(async n=>{this.plugin.settings.defaultTimelineGroupMode=n,await this.plugin.saveSettings()})),new mt.Setting(t).setName(w("defaultZoomPreset")).addDropdown(r=>r.addOptions({none:w("noneOption"),fit:w("fitOption"),decade:w("decadeOption"),century:w("centuryOption")}).setValue(this.plugin.settings.defaultTimelineZoomPreset||"none").onChange(async n=>{this.plugin.settings.defaultTimelineZoomPreset=n,await this.plugin.saveSettings()})),new mt.Setting(t).setName(w("defaultStacking")).addToggle(r=>{var n;return r.setValue((n=this.plugin.settings.defaultTimelineStack)!=null?n:!0).onChange(async s=>{this.plugin.settings.defaultTimelineStack=s,await this.plugin.saveSettings()})}),new mt.Setting(t).setName(w("defaultDensity")).addSlider(r=>{var n;return r.setLimits(0,100,5).setValue((n=this.plugin.settings.defaultTimelineDensity)!=null?n:50).setDynamicTooltip().onChange(async s=>{this.plugin.settings.defaultTimelineDensity=s,await this.plugin.saveSettings()})}),new mt.Setting(t).setName(w("showLegendByDefault")).addToggle(r=>{var n;return r.setValue((n=this.plugin.settings.showTimelineLegend)!=null?n:!0).onChange(async s=>{this.plugin.settings.showTimelineLegend=s,await this.plugin.saveSettings()})}),t.createEl("h3",{text:w("ganttViewSettings")}),new mt.Setting(t).setName(w("showProgressBarsInGantt")).setDesc(w("showProgressBarsInGanttDesc")).addToggle(r=>{var n;return r.setValue((n=this.plugin.settings.ganttShowProgressBars)!=null?n:!0).onChange(async s=>{this.plugin.settings.ganttShowProgressBars=s,await this.plugin.saveSettings()})}),new mt.Setting(t).setName(w("defaultGanttDuration")).setDesc(w("defaultGanttDurationDesc")).addText(r=>{var n;return r.setPlaceholder("1").setValue(String((n=this.plugin.settings.ganttDefaultDuration)!=null?n:1)).onChange(async s=>{let o=parseInt(s,10);!isNaN(o)&&o>0&&(this.plugin.settings.ganttDefaultDuration=o,await this.plugin.saveSettings())})}),new mt.Setting(t).setName(w("dependencyArrowStyle")).setDesc(w("dependencyArrowStyleDesc")).addDropdown(r=>{var n;return r.addOption("solid",w("solid")).addOption("dashed",w("dashed")).addOption("dotted",w("dotted")).setValue((n=this.plugin.settings.ganttArrowStyle)!=null?n:"solid").onChange(async s=>{this.plugin.settings.ganttArrowStyle=s,await this.plugin.saveSettings()})}),new mt.Setting(t).setName(w("timelineDefaultHeight")).setDesc(w("timelineHeightDesc")).addText(r=>r.setPlaceholder(w("timelineHeightPh")).setValue("380px").onChange(async()=>{})),new mt.Setting(t).setName(w("useCustomEntityFolders")).setDesc(w("useCustomFoldersDesc")).addToggle(r=>r.setValue(!!this.plugin.settings.enableCustomEntityFolders).onChange(async n=>{if(this.plugin.settings.enableCustomEntityFolders=n,await this.plugin.saveSettings(),n)if(await this.plugin.autoDetectCustomEntityFolders(),((this.plugin.settings.storyRootFolderTemplate||"").match(/\{story(Name|Slug|Id)\}/i)||(this.plugin.settings.characterFolderPath||"").match(/\{story(Name|Slug|Id)\}/i)||(this.plugin.settings.locationFolderPath||"").match(/\{story(Name|Slug|Id)\}/i)||(this.plugin.settings.eventFolderPath||"").match(/\{story(Name|Slug|Id)\}/i)||(this.plugin.settings.itemFolderPath||"").match(/\{story(Name|Slug|Id)\}/i)||(this.plugin.settings.referenceFolderPath||"").match(/\{story(Name|Slug|Id)\}/i)||(this.plugin.settings.chapterFolderPath||"").match(/\{story(Name|Slug|Id)\}/i)||(this.plugin.settings.sceneFolderPath||"").match(/\{story(Name|Slug|Id)\}/i))&&!this.plugin.settings.activeStoryId){let o=t.createDiv({cls:"mod-warning"});o.style.marginTop="8px",o.setText(w("customFoldersPlaceholderWarning"))}else await this.plugin.refreshCustomFolderDiscovery();this.display()})),this.plugin.settings.enableCustomEntityFolders&&(new mt.Setting(t).setName(w("previewResolvedFolders")).setDesc(w("previewFoldersDesc")).addButton(r=>r.setButtonText(w("previewBtn")).onClick(async()=>{let n=this.plugin.getFolderResolver()||null;if(!n)return;let s=n.resolveAll(),o=t.createEl("pre"),l=[];for(let[c,u]of Object.entries(s)){let d=u.path||u.error||"\u2014";l.push(`${c.padEnd(10)}: ${d}`)}o.setText(l.join(`
`))})),new mt.Setting(t).setName(w("storyRootFolderOptional")).setDesc(w("storyRootDesc")).addText(r=>{let n=r.setPlaceholder(w("storyRootFolderPh")).setValue(this.plugin.settings.storyRootFolderTemplate||"").onChange(async l=>{this.plugin.settings.storyRootFolderTemplate=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.storyRootFolderTemplate=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("charactersFolder")).setDesc(w("charactersFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("charactersFolderPh")).setValue(this.plugin.settings.characterFolderPath||"").onChange(async l=>{this.plugin.settings.characterFolderPath=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.characterFolderPath=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("locationsFolder")).setDesc(w("locationsFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("locationsFolderPh")).setValue(this.plugin.settings.locationFolderPath||"").onChange(async l=>{this.plugin.settings.locationFolderPath=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.locationFolderPath=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("eventsFolder")).setDesc(w("eventsFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("eventsFolderPh")).setValue(this.plugin.settings.eventFolderPath||"").onChange(async l=>{this.plugin.settings.eventFolderPath=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.eventFolderPath=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("itemsFolder")).setDesc(w("itemsFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("itemsFolderPh")).setValue(this.plugin.settings.itemFolderPath||"").onChange(async l=>{this.plugin.settings.itemFolderPath=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.itemFolderPath=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("referencesFolder")).setDesc(w("referencesFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("referencesFolderPh")).setValue(this.plugin.settings.referenceFolderPath||"").onChange(async l=>{this.plugin.settings.referenceFolderPath=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.referenceFolderPath=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("scenesFolder")).setDesc(w("scenesFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("scenesFolderPh")).setValue(this.plugin.settings.sceneFolderPath||"").onChange(async l=>{this.plugin.settings.sceneFolderPath=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.sceneFolderPath=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("chaptersFolder")).setDesc(w("chaptersFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("chaptersFolderPh")).setValue(this.plugin.settings.chapterFolderPath||"").onChange(async l=>{this.plugin.settings.chapterFolderPath=l,await this.plugin.saveSettings()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{this.plugin.settings.chapterFolderPath=c,n.setValue(c),await this.plugin.saveSettings()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n})),new mt.Setting(t).setName(w("mapSettings")).setHeading(),new mt.Setting(t).setName(w("enableFrontmatterMarkers")).setDesc(w("enableFrontmatterMarkersDesc")).addToggle(r=>r.setValue(!!this.plugin.settings.enableFrontmatterMarkers).onChange(async n=>{this.plugin.settings.enableFrontmatterMarkers=n,await this.plugin.saveSettings()})),new mt.Setting(t).setName(w("enableDataViewMarkers")).setDesc(w("enableDataViewMarkersDesc")).addToggle(r=>r.setValue(!!this.plugin.settings.enableDataViewMarkers).onChange(async n=>{this.plugin.settings.enableDataViewMarkers=n,await this.plugin.saveSettings()})),new mt.Setting(t).setName(w("oneStoryMode")).setDesc(w("oneStoryModeDesc")).addToggle(r=>r.setValue(!!this.plugin.settings.enableOneStoryMode).onChange(async n=>{this.plugin.settings.enableOneStoryMode=n,await this.plugin.saveSettings(),n&&await this.plugin.initializeOneStoryModeIfNeeded(),this.display()})),!this.plugin.settings.enableCustomEntityFolders&&this.plugin.settings.enableOneStoryMode&&new mt.Setting(t).setName(w("oneStoryBaseFolder")).setDesc(w("oneStoryBaseFolderDesc")).addText(r=>{let n=r.setPlaceholder(w("oneStoryBaseFolderPh")).setValue(this.plugin.settings.oneStoryBaseFolder||"StorytellerSuite").onChange(async l=>{let c=l&&l.trim()==="/"?"":l||"StorytellerSuite";this.plugin.settings.oneStoryBaseFolder=c,await this.plugin.saveSettings(),await this.plugin.initializeOneStoryModeIfNeeded()}),s=!1,o=()=>{if(s)return;new Na(this.app,async c=>{let u=!c||c==="/"?"":c;this.plugin.settings.oneStoryBaseFolder=u||"StorytellerSuite",n.setValue(u),await this.plugin.saveSettings(),await this.plugin.initializeOneStoryModeIfNeeded()},()=>{s=!0,setTimeout(()=>{s=!1},300),setTimeout(()=>n.inputEl.focus(),0)}).open()};return n.inputEl.addEventListener("keydown",l=>{(l.key==="ArrowDown"||l.ctrlKey&&l.key.toLowerCase()===" ")&&(l.preventDefault(),o())}),n.inputEl.addEventListener("focus",o),n.inputEl.addEventListener("click",o),n}),new mt.Setting(t).setName(w("showTutorialSection")).setDesc(w("showTutorialDesc")).addToggle(r=>r.setValue(this.plugin.settings.showTutorial).onChange(async n=>{this.plugin.settings.showTutorial=n,await this.plugin.saveSettings(),this.display()})),new mt.Setting(t).setName(w("support")).setHeading(),new mt.Setting(t).setName(w("supportDevelopment")).setDesc(w("supportDevDesc")).addButton(r=>r.setButtonText(w("buyMeACoffee")).setTooltip("Support on Ko-fi").onClick(()=>{window.open("https://ko-fi.com/kingmaws","_blank")})),new mt.Setting(t).setName(w("about")).setHeading(),new mt.Setting(t).setName(w("pluginInformation")).setDesc(w("pluginInfoDesc")).addButton(r=>r.setButtonText(w("github")).setTooltip("View source code").onClick(()=>{window.open("https://github.com/SamW7140/obsidian-storyteller-suite","_blank")}))}addTutorialSection(t){new mt.Setting(t).setName(w("tutorialGettingStarted")).setHeading();let e=createDiv();e.innerHTML=`
            <p><strong>${w("tutorialWelcome")}</strong> ${w("tutorialWelcomeDesc")}</p>
            <p><em>${w("tutorialTip")}</em></p>
        `,e.style.marginBottom="1em",e.style.padding="0.75em",e.style.backgroundColor="var(--background-modifier-form-field)",e.style.borderRadius="5px",e.style.borderLeft="3px solid var(--interactive-accent)",t.appendChild(e),this.addTutorialCollapsible(t,w("tutorialDashboardTitle"),`<p><strong>${w("tutorialDashboardAccess")}</strong></p>
            <ul>
                <li>${w("tutorialDashboardRibbon")}</li>
                <li>${w("tutorialDashboardCommand")}</li>
                <li>${w("tutorialDashboardHub")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialStoryTitle"),`<p><strong>${w("tutorialStoryCreating")}</strong></p>
            <ul>
                <li>${w("tutorialStoryButton")}</li>
                <li>${w("tutorialStoryCommand")}</li>
                <li>${w("tutorialStoryName")}</li>
                <li>${w("tutorialStoryDefault")}</li>
            </ul>
            <p><strong>${w("tutorialStoryManaging")}</strong></p>
            <ul>
                <li>${w("tutorialStorySwitch")}</li>
                <li>${w("tutorialStoryEdit")}</li>
                <li>${w("tutorialStoryDelete")}</li>
            </ul>
            <p><strong>${w("tutorialStoryActivation")}</strong></p>
            <p><strong>${w("tutorialStoryOneMode")}</strong></p>`),this.addTutorialCollapsible(t,w("tutorialCharacterTitle"),`<p><strong>${w("tutorialCharacterCreating")}</strong></p>
            <ul>
                <li>${w("tutorialCharacterDashboard")}</li>
                <li>${w("tutorialCharacterCommand")}</li>
                <li>${w("tutorialCharacterDetails")}</li>
                <li>${w("tutorialCharacterImages")}</li>
            </ul>
            <p><strong>${w("tutorialCharacterManaging")}</strong></p>
            <ul>
                <li>${w("tutorialCharacterView")}</li>
                <li>${w("tutorialCharacterEdit")}</li>
                <li>${w("tutorialCharacterDelete")}</li>
                <li>${w("tutorialCharacterStorage")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialLocationTitle"),`<p><strong>${w("tutorialLocationCreating")}</strong></p>
            <ul>
                <li>${w("tutorialLocationDashboard")}</li>
                <li>${w("tutorialLocationCommand")}</li>
                <li>${w("tutorialLocationDetails")}</li>
                <li>${w("tutorialLocationLink")}</li>
            </ul>
            <p><strong>${w("tutorialLocationManaging")}</strong></p>
            <ul>
                <li>${w("tutorialLocationView")}</li>
                <li>${w("tutorialLocationStorage")}</li>
                <li>${w("tutorialLocationEdit")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialEventTitle"),`<p><strong>${w("tutorialEventCreating")}</strong></p>
            <ul>
                <li>${w("tutorialEventDashboard")}</li>
                <li>${w("tutorialEventCommand")}</li>
                <li>${w("tutorialEventDetails")}</li>
                <li>${w("tutorialEventLink")}</li>
                <li>${w("tutorialEventNew")}</li>
            </ul>
            <p><strong>${w("tutorialEventTimeline")}</strong></p>
            <ul>
                <li>${w("tutorialEventTimelineDashboard")}</li>
                <li>${w("tutorialEventTimelineCommand")}</li>
                <li>${w("tutorialEventTimelineSee")}</li>
                <li>${w("tutorialEventStorage")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialGanttTitle"),`<p><strong>${w("tutorialGanttEnhanced")}</strong></p>
            <ul>
                <li>${w("tutorialGanttToggle")}</li>
                <li>${w("tutorialGanttMilestones")}</li>
                <li>${w("tutorialGanttProgress")}</li>
                <li>${w("tutorialGanttDependencies")}</li>
            </ul>
            <p><strong>${w("tutorialGanttDrag")}</strong></p>
            <ul>
                <li>${w("tutorialGanttLock")}</li>
                <li>${w("tutorialGanttDragEvents")}</li>
                <li>${w("tutorialGanttDisable")}</li>
            </ul>
            <p><strong>${w("tutorialGanttFiltering")}</strong></p>
            <ul>
                <li>${w("tutorialGanttFilterPanel")}</li>
                <li>${w("tutorialGanttFilterBy")}</li>
                <li>${w("tutorialGanttFilterChips")}</li>
                <li>${w("tutorialGanttSwimlanes")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialPlotTitle"),`<p><strong>${w("tutorialPlotManaging")}</strong></p>
            <ul>
                <li>${w("tutorialPlotCreate")}</li>
                <li>${w("tutorialPlotCritical")}</li>
                <li>${w("tutorialPlotOwnership")}</li>
                <li>${w("tutorialPlotView")}</li>
                <li>${w("tutorialPlotStorage")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialGalleryTitle"),`<p><strong>${w("tutorialGalleryOrganization")}</strong></p>
            <ul>
                <li>${w("tutorialGalleryAccess")}</li>
                <li>${w("tutorialGalleryUpload")}</li>
                <li>${w("tutorialGalleryOrganize")}</li>
                <li>${w("tutorialGalleryLink")}</li>
                <li>${w("tutorialGalleryConfig")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialGroupsTitle"),`<p><strong>${w("tutorialGroupsOrganizing")}</strong></p>
            <ul>
                <li>${w("tutorialGroupsCreate")}</li>
                <li>${w("tutorialGroupsAdd")}</li>
                <li>${w("tutorialGroupsManage")}</li>
                <li>${w("tutorialGroupsUseCases")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialWorldTitle"),`<p><strong>${w("tutorialWorldFive")}</strong></p>
            <ul>
                <li>${w("tutorialWorldCultures")}</li>
                <li>${w("tutorialWorldFactions")}</li>
                <li>${w("tutorialWorldEconomies")}</li>
                <li>${w("tutorialWorldMagic")}</li>
                <li>${w("tutorialWorldCalendars")}</li>
            </ul>
            <p><strong>${w("tutorialWorldCreating")}</strong></p>
            <ul>
                <li>${w("tutorialWorldCommand")}</li>
                <li>${w("tutorialWorldView")}</li>
                <li>${w("tutorialWorldModals")}</li>
                <li>${w("tutorialWorldStorage")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialTimelineTitle"),`<p><strong>${w("tutorialTimelineAlternate")}</strong></p>
            <ul>
                <li>${w("tutorialTimelineCreateFork")}</li>
                <li>${w("tutorialTimelineDivergence")}</li>
                <li>${w("tutorialTimelineForkStatus")}</li>
                <li>${w("tutorialTimelineViewForks")}</li>
            </ul>
            <p><strong>${w("tutorialTimelineCausality")}</strong></p>
            <ul>
                <li>${w("tutorialTimelineAddLink")}</li>
                <li>${w("tutorialTimelineLinkTypes")}</li>
                <li>${w("tutorialTimelineStrength")}</li>
                <li>${w("tutorialTimelineLinksHelp")}</li>
            </ul>
            <p><strong>${w("tutorialTimelineConflict")}</strong></p>
            <ul>
                <li>${w("tutorialTimelineRunDetection")}</li>
                <li>${w("tutorialTimelineDetects")}</li>
                <li>${w("tutorialTimelineBadge")}</li>
                <li>${w("tutorialTimelineActionable")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialTemplatesTitle"),`<p><strong>${w("tutorialTemplatesCreate")}</strong></p>
            <ul>
                <li>${w("tutorialTemplatesSave")}</li>
                <li>${w("tutorialTemplatesLibrary")}</li>
                <li>${w("tutorialTemplatesDashboard")}</li>
            </ul>
            <p><strong>${w("tutorialTemplatesBuiltIn")}</strong></p>
            <ul>
                <li>${w("tutorialTemplatesArchetypes")}</li>
                <li>${w("tutorialTemplatesMore")}</li>
            </ul>
            <p><strong>${w("tutorialTemplatesFeatures")}</strong></p>
            <ul>
                <li>${w("tutorialTemplatesBrowse")}</li>
                <li>${w("tutorialTemplatesSort")}</li>
                <li>${w("tutorialTemplatesUsage")}</li>
                <li>${w("tutorialTemplatesCustomize")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialDiscoveryTitle"),`<p><strong>${w("tutorialDiscoveryAutomatic")}</strong></p>
            <ul>
                <li>${w("tutorialDiscoveryDetects")}</li>
                <li>${w("tutorialDiscoveryManual")}</li>
                <li>${w("tutorialDiscoveryImport")}</li>
                <li>${w("tutorialDiscoveryUseful")}</li>
            </ul>`),this.addTutorialCollapsible(t,w("tutorialCustomTitle"),`<p><strong>${w("tutorialCustomSimple")}</strong></p>
            <ol>
                <li>${w("tutorialCustomStep1")}</li>
                <li>${w("tutorialCustomStep2")}</li>
                <li>${w("tutorialCustomStep3")}</li>
                <li>${w("tutorialCustomStep4")}</li>
            </ol>
            <p><strong>${w("tutorialCustomSwitching")}</strong></p>
            `),this.addTutorialCollapsible(t,w("tutorialShortcutsTitle"),`<p><strong>${w("tutorialShortcutsCore")}</strong></p>
            <ul>
                <li>${w("tutorialShortcutsOpen")}</li>
                <li>${w("tutorialShortcutsNewStory")}</li>
                <li>${w("tutorialShortcutsCreate")}</li>
                <li>${w("tutorialShortcutsView")}</li>
                <li>${w("tutorialShortcutsGallery")}</li>
                <li>${w("tutorialShortcutsGroup")}</li>
                <li>${w("tutorialShortcutsRefresh")}</li>
            </ul>
            <p><strong>${w("tutorialShortcutsWorld")}</strong></p>
            <ul>
                <li>${w("tutorialShortcutsWorldCreate")}</li>
                <li>${w("tutorialShortcutsWorldView")}</li>
            </ul>
            <p><strong>${w("tutorialShortcutsTimeline")}</strong></p>
            <ul>
                <li>${w("tutorialShortcutsTimelineFork")}</li>
                <li>${w("tutorialShortcutsTimelineViewForks")}</li>
                <li>${w("tutorialShortcutsTimelineLink")}</li>
                <li>${w("tutorialShortcutsTimelineViewLinks")}</li>
                <li>${w("tutorialShortcutsTimelineDetect")}</li>
                <li>${w("tutorialShortcutsTimelineViewConflicts")}</li>
            </ul>
            <p><strong>${w("tutorialShortcutsTemplate")}</strong></p>
            <ul>
                <li>${w("tutorialShortcutsTemplateLibrary")}</li>
            </ul>
            <p><strong>${w("tutorialShortcutsTip")}</strong></p>`),this.addTutorialCollapsible(t,w("tutorialFileTitle"),`<p><strong>${w("tutorialFileOrganized")}</strong></p>
            <pre><code>${w("tutorialFileDefault")}
StorytellerSuite/
\u251C\u2500\u2500 Stories/
\u2502   \u2514\u2500\u2500 YourStoryName/
\u2502       \u251C\u2500\u2500 Characters/     (character .md files)
\u2502       \u251C\u2500\u2500 Locations/      (location .md files)
\u2502       \u251C\u2500\u2500 Events/         (event .md files)
\u2502       \u251C\u2500\u2500 Items/          (plot item .md files)
\u2502       \u251C\u2500\u2500 Chapters/       (chapter .md files)
\u2502       \u251C\u2500\u2500 Scenes/         (scene .md files)
\u2502       \u251C\u2500\u2500 References/     (reference .md files)
\u2502       \u251C\u2500\u2500 Cultures/       (culture .md files)
\u2502       \u251C\u2500\u2500 Factions/       (faction .md files)
\u2502       \u251C\u2500\u2500 Economies/      (economy .md files)
\u2502       \u251C\u2500\u2500 MagicSystems/   (magic system .md files)
\u2502       \u2514\u2500\u2500 Calendars/      (calendar .md files)
\u251C\u2500\u2500 GalleryUploads/         (uploaded images)
\u2514\u2500\u2500 Templates/              (saved entity templates)

${w("tutorialFileOneMode")}
[Base]/
\u251C\u2500\u2500 Characters/
\u251C\u2500\u2500 Locations/
\u251C\u2500\u2500 Events/
\u251C\u2500\u2500 Items/
\u251C\u2500\u2500 Cultures/
\u251C\u2500\u2500 Factions/
\u2514\u2500\u2500 ... (all entity folders)
</code></pre>
            <p><strong>${w("tutorialFileIntegration")}</strong></p>
            <ul>
                <li>${w("tutorialFileMarkdown")}</li>
                <li>${w("tutorialFileDataview")}</li>
                <li>${w("tutorialFileWikiLinks")}</li>
                <li>${w("tutorialFileReadable")}</li>
                <li>${w("tutorialFileBackup")}</li>
            </ul>
            <p><strong>${w("tutorialFileTip")}</strong></p>`)}addTutorialCollapsible(t,e,r){let n=new mt.Setting(t).setName(e).setClass("storyteller-tutorial-section"),s=createDiv();s.innerHTML=r,s.style.display="none",s.style.marginTop="10px",s.style.padding="15px",s.style.backgroundColor="var(--background-secondary)",s.style.borderRadius="5px",s.style.fontSize="0.9em",s.style.lineHeight="1.5",n.settingEl.style.cursor="pointer",n.settingEl.addEventListener("click",()=>{let o=s.style.display==="none";s.style.display=o?"block":"none";let l=n.nameEl,c=l.textContent||"";o?(l.textContent=c.replace("\u25B6 ","").replace("\u25BC ",""),l.textContent="\u25BC "+l.textContent):(l.textContent=c.replace("\u25B6 ","").replace("\u25BC ",""),l.textContent="\u25B6 "+l.textContent)}),n.nameEl.textContent="\u25B6 "+(n.nameEl.textContent||""),n.settingEl.appendChild(s)}};Ig();var Xi=require("obsidian");St();Ig();var uE=class extends Xi.Modal{constructor(t,e,r){super(t),this.plugin=e,this.items=r,this.modalEl.addClass("storyteller-list-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:w("plotItems")}),this.listContainer=t.createDiv("storyteller-list-container"),new Xi.Setting(t).setName(w("search")).addText(e=>{e.setPlaceholder(w("searchX",w("items"))).onChange(r=>this.renderList(r.toLowerCase(),this.listContainer))}),this.renderList("",this.listContainer),new Xi.Setting(t).addButton(e=>{let r=!!this.plugin.getActiveStory();e.setButtonText(w("createItem")).setCta().onClick(()=>{if(!this.plugin.getActiveStory()){new Xi.Notice(w("selectOrCreateStoryFirst"));return}this.close(),new Os(this.app,this.plugin,null,async n=>{await this.plugin.savePlotItem(n),new Xi.Notice(w("created",w("item"),n.name))}).open()}),r||e.setDisabled(!0).setTooltip(w("selectOrCreateStoryFirst"))})}renderList(t,e){e.empty();let r=this.items.filter(n=>n.name.toLowerCase().includes(t)||(n.description||"").toLowerCase().includes(t)||(n.currentOwner||"").toLowerCase().includes(t));if(r.length===0){e.createEl("p",{text:w("noItemsFound")+(t?w("matchingFilter"):"")});return}r.forEach(n=>{let s=e.createDiv("storyteller-list-item"),o=s.createDiv("storyteller-list-item-info"),l=o.createEl("strong",{text:n.name});if(n.isPlotCritical&&(l.setText(`\u2605 ${n.name}`),l.style.color="var(--text-accent)"),n.description){let u=n.description.substring(0,100),d=n.description.length>100?u+"...":u;o.createEl("p",{text:d})}n.currentOwner&&o.createEl("p",{text:w("ownerValue",n.currentOwner)});let c=s.createDiv("storyteller-list-item-actions");new Xi.ButtonComponent(c).setIcon("pencil").setTooltip(w("edit")).onClick(()=>{this.close(),new Os(this.app,this.plugin,n,async u=>{await this.plugin.savePlotItem(u),new Xi.Notice(w("updated",w("item"),u.name))}).open()}),new Xi.ButtonComponent(c).setIcon("trash").setTooltip(w("delete")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteItemTrash",n.name))&&(n.filePath?(await this.plugin.deletePlotItem(n.filePath),this.items=this.items.filter(u=>u.filePath!==n.filePath),this.renderList(t,e)):new Xi.Notice(w("errorCannotDeleteWithoutFilePath",w("item"))))}),new Xi.ButtonComponent(c).setIcon("go-to-file").setTooltip(w("openNote")).onClick(()=>{if(!n.filePath){new Xi.Notice(w("errorCannotOpenNoteWithoutFilePath",w("item")));return}let u=this.app.vault.getAbstractFileByPath(n.filePath);u instanceof Xi.TFile?(this.app.workspace.getLeaf(!1).openFile(u),this.close()):new Xi.Notice(w("workspaceLeafRevealError"))})})}onClose(){this.contentEl.empty()}};Pf();var Ri=require("obsidian");St();Pf();var dE=class extends Ri.Modal{constructor(t,e,r){super(t),this.plugin=e,this.cultures=r,this.modalEl.addClass("storyteller-list-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:w("cultures")}),this.listContainer=t.createDiv("storyteller-list-container");let e=new Ri.Setting(t).setName(w("search")).addText(r=>{r.setPlaceholder(w("searchCultures")).onChange(n=>this.renderList(n.toLowerCase(),this.listContainer))});this.renderList("",this.listContainer),new Ri.Setting(t).addButton(r=>{let n=!!this.plugin.getActiveStory();r.setButtonText(w("createCulture")).setCta().onClick(()=>{if(!this.plugin.getActiveStory()){new Ri.Notice(w("selectOrCreateStoryFirst"));return}this.close(),new kc(this.app,this.plugin,null,async s=>{await this.plugin.saveCulture(s),new Ri.Notice(w("cultureCreated",s.name)),new Ri.Notice(w("noteCreatedWithSections"))}).open()}),n||r.setDisabled(!0).setTooltip(w("selectOrCreateStoryFirst"))})}renderList(t,e){e.empty();let r=this.cultures.filter(n=>n.name.toLowerCase().includes(t)||(n.values||"").toLowerCase().includes(t)||(n.religion||"").toLowerCase().includes(t)||(n.governmentType||"").toLowerCase().includes(t)||(n.languages||[]).join(" ").toLowerCase().includes(t));if(r.length===0){e.createEl("p",{text:w("noCulturesFound")+(t?w("matchingFilter"):"")});return}r.forEach(n=>{let s=e.createDiv("storyteller-list-item"),o=s.createDiv("storyteller-list-item-info");o.createEl("strong",{text:n.name});let l=[];if(n.governmentType&&l.push(`Gov: ${n.governmentType}`),n.techLevel&&l.push(`Tech: ${n.techLevel}`),n.status&&l.push(`Status: ${n.status}`),l.length>0&&o.createEl("p",{text:l.join(" | "),cls:"storyteller-list-meta"}),n.values){let u=n.values.substring(0,100),d=n.values.length>100?u+"...":u;o.createEl("p",{text:d})}let c=s.createDiv("storyteller-list-item-actions");new Ri.ButtonComponent(c).setIcon("pencil").setTooltip(w("edit")).onClick(()=>{this.close(),new kc(this.app,this.plugin,n,async u=>{await this.plugin.saveCulture(u),new Ri.Notice(w("cultureUpdated",u.name))}).open()}),new Ri.ButtonComponent(c).setIcon("trash").setTooltip(w("delete")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteCulture",n.name))&&(n.filePath?(await this.plugin.deleteCulture(n.filePath),this.cultures=this.cultures.filter(u=>u.filePath!==n.filePath),this.renderList(t,e)):new Ri.Notice(w("cannotDeleteWithoutPath")))}),new Ri.ButtonComponent(c).setIcon("go-to-file").setTooltip(w("openNote")).onClick(()=>{if(!n.filePath){new Ri.Notice(w("cannotOpenWithoutPath"));return}let u=this.app.vault.getAbstractFileByPath(n.filePath);u instanceof Ri.TFile?(this.app.workspace.getLeaf(!1).openFile(u),this.close()):new Ri.Notice(w("workspaceLeafRevealError"))})})}onClose(){this.contentEl.empty()}};Lf();var Ni=require("obsidian");St();Lf();var hE=class extends Ni.Modal{constructor(t,e,r){super(t),this.plugin=e,this.economies=r,this.modalEl.addClass("storyteller-list-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:w("economies")}),this.listContainer=t.createDiv("storyteller-list-container");let e=new Ni.Setting(t).setName(w("search")).addText(r=>{r.setPlaceholder(w("searchEconomies")).onChange(n=>this.renderList(n.toLowerCase(),this.listContainer))});this.renderList("",this.listContainer),new Ni.Setting(t).addButton(r=>{let n=!!this.plugin.getActiveStory();r.setButtonText(w("createEconomy")).setCta().onClick(()=>{if(!this.plugin.getActiveStory()){new Ni.Notice(w("selectOrCreateStoryFirst"));return}this.close(),new Dc(this.app,this.plugin,null,async s=>{await this.plugin.saveEconomy(s),new Ni.Notice(w("economyCreated",s.name)),new Ni.Notice(w("noteCreatedWithSections"))}).open()}),n||r.setDisabled(!0).setTooltip(w("selectOrCreateStoryFirst"))})}renderList(t,e){e.empty();let r=this.economies.filter(n=>n.name.toLowerCase().includes(t)||(n.industries||"").toLowerCase().includes(t)||(n.taxation||"").toLowerCase().includes(t)||(n.economicSystem||"").toLowerCase().includes(t)||(n.description||"").toLowerCase().includes(t));if(r.length===0){e.createEl("p",{text:w("noEconomiesFound")+(t?w("matchingFilter"):"")});return}r.forEach(n=>{let s=e.createDiv("storyteller-list-item"),o=s.createDiv("storyteller-list-item-info");o.createEl("strong",{text:n.name});let l=[];if(n.economicSystem&&l.push(`System: ${n.economicSystem}`),n.currencies&&n.currencies.length>0&&l.push(`Currencies: ${n.currencies.length}`),n.status&&l.push(`Status: ${n.status}`),l.length>0&&o.createEl("p",{text:l.join(" | "),cls:"storyteller-list-meta"}),n.industries){let u=n.industries.substring(0,100),d=n.industries.length>100?u+"...":u;o.createEl("p",{text:d})}let c=s.createDiv("storyteller-list-item-actions");new Ni.ButtonComponent(c).setIcon("pencil").setTooltip(w("edit")).onClick(()=>{this.close(),new Dc(this.app,this.plugin,n,async u=>{await this.plugin.saveEconomy(u),new Ni.Notice(w("economyUpdated",u.name))}).open()}),new Ni.ButtonComponent(c).setIcon("trash").setTooltip(w("delete")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteEconomy",n.name))&&(n.filePath?(await this.plugin.deleteEconomy(n.filePath),this.economies=this.economies.filter(u=>u.filePath!==n.filePath),this.renderList(t,e)):new Ni.Notice(w("cannotDeleteWithoutPath")))}),new Ni.ButtonComponent(c).setIcon("go-to-file").setTooltip(w("openNote")).onClick(()=>{if(!n.filePath){new Ni.Notice(w("cannotOpenWithoutPath"));return}let u=this.app.vault.getAbstractFileByPath(n.filePath);u instanceof Ni.TFile?(this.app.workspace.getLeaf(!1).openFile(u),this.close()):new Ni.Notice(w("workspaceLeafRevealError"))})})}onClose(){this.contentEl.empty()}};Mf();var Bi=require("obsidian");St();Mf();var fE=class extends Bi.Modal{constructor(t,e,r){super(t),this.plugin=e,this.magicSystems=r,this.modalEl.addClass("storyteller-list-modal")}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:w("magicSystems")}),this.listContainer=t.createDiv("storyteller-list-container");let e=new Bi.Setting(t).setName(w("search")).addText(r=>{r.setPlaceholder(w("searchMagicSystems")).onChange(n=>this.renderList(n.toLowerCase(),this.listContainer))});this.renderList("",this.listContainer),new Bi.Setting(t).addButton(r=>{let n=!!this.plugin.getActiveStory();r.setButtonText(w("createMagicSystem")).setCta().onClick(()=>{if(!this.plugin.getActiveStory()){new Bi.Notice(w("selectOrCreateStoryFirst"));return}this.close(),new Pc(this.app,this.plugin,null,async s=>{await this.plugin.saveMagicSystem(s),new Bi.Notice(w("magicSystemCreated",s.name)),new Bi.Notice(w("noteCreatedWithSections"))}).open()}),n||r.setDisabled(!0).setTooltip(w("selectOrCreateStoryFirst"))})}renderList(t,e){e.empty();let r=this.magicSystems.filter(n=>n.name.toLowerCase().includes(t)||(n.rules||"").toLowerCase().includes(t)||(n.source||"").toLowerCase().includes(t)||(n.systemType||"").toLowerCase().includes(t)||(n.description||"").toLowerCase().includes(t));if(r.length===0){e.createEl("p",{text:w("noMagicSystemsFound")+(t?w("matchingFilter"):"")});return}r.forEach(n=>{let s=e.createDiv("storyteller-list-item"),o=s.createDiv("storyteller-list-item-info");o.createEl("strong",{text:n.name});let l=[];if(n.systemType&&l.push(`Type: ${n.systemType}`),n.rarity&&l.push(`Rarity: ${n.rarity}`),n.powerLevel&&l.push(`Power: ${n.powerLevel}`),l.length>0&&o.createEl("p",{text:l.join(" | "),cls:"storyteller-list-meta"}),n.rules){let u=n.rules.substring(0,100),d=n.rules.length>100?u+"...":u;o.createEl("p",{text:d})}let c=s.createDiv("storyteller-list-item-actions");new Bi.ButtonComponent(c).setIcon("pencil").setTooltip(w("edit")).onClick(()=>{this.close(),new Pc(this.app,this.plugin,n,async u=>{await this.plugin.saveMagicSystem(u),new Bi.Notice(w("magicSystemUpdated",u.name))}).open()}),new Bi.ButtonComponent(c).setIcon("trash").setTooltip(w("delete")).setClass("mod-warning").onClick(async()=>{confirm(w("confirmDeleteMagicSystem",n.name))&&(n.filePath?(await this.plugin.deleteMagicSystem(n.filePath),this.magicSystems=this.magicSystems.filter(u=>u.filePath!==n.filePath),this.renderList(t,e)):new Bi.Notice(w("cannotDeleteWithoutPath")))}),new Bi.ButtonComponent(c).setIcon("go-to-file").setTooltip(w("openNote")).onClick(()=>{if(!n.filePath){new Bi.Notice(w("cannotOpenWithoutPath"));return}let u=this.app.vault.getAbstractFileByPath(n.filePath);u instanceof Bi.TFile?(this.app.workspace.getLeaf(!1).openFile(u),this.close()):new Bi.Notice(w("workspaceLeafRevealError"))})})}onClose(){this.contentEl.empty()}};Xy();var l3={character:{Description:"",Backstory:""},location:{Description:"",History:""},event:{Description:"",Outcome:""},item:{Description:"",History:""},reference:{Content:""},chapter:{Summary:""},scene:{Content:"",Beats:""},map:{Description:""},culture:{Description:"",Values:"",Religion:"","Social Structure":"",History:"","Naming Conventions":"",Customs:""},faction:{Description:"",History:"",Structure:"",Goals:"",Resources:""},economy:{Description:"",Industries:"",Taxation:""},magicSystem:{Description:"",Rules:"",Source:"",Costs:"",Limitations:"",Training:"",History:""},calendar:{Description:"",History:""}};function Gs(a,t={}){let e={...l3[a]};return Object.entries(t).forEach(([r,n])=>{typeof n=="string"&&(e[r]=n)}),Object.keys(l3[a]).forEach(r=>{r in e||(e[r]="")}),e}var f3=require("obsidian");var c3=require("obsidian");function u3(a){var s;if(!a||a.trim().length===0)return{};let t=/(?:\[.*?\]\(|\[\[)[^\[\]]*?(?:\)|\]\])/g,e=(s=a.match(t))!=null?s:[],r=a;e.forEach((o,l)=>{r=r.replace(o,`LEAFLET_INTERNAL_LINK_${l}`)});let n;try{n=(0,c3.parseYaml)(r)}catch(o){n=LTe(r)}return e.length>0&&cP(n,e),MTe(n)}function LTe(a){let t={},e=a.split(`
`);for(let r of e){let n=r.trim();if(!n||n.startsWith("#"))continue;let s=n.indexOf(":");if(s===-1)continue;let o=n.substring(0,s).trim(),l=n.substring(s+1).trim();o&&l&&(t[o]=l)}return t}function cP(a,t){if(!(!a||typeof a!="object"))for(let e in a){let r=a[e];if(typeof r=="string"){let n=r;t.forEach((s,o)=>{n=n.replace(`LEAFLET_INTERNAL_LINK_${o}`,s)}),a[e]=n}else if(Array.isArray(r))for(let n=0;n<r.length;n++)if(typeof r[n]=="string"){let s=r[n];t.forEach((o,l)=>{s=s.replace(`LEAFLET_INTERNAL_LINK_${l}`,o)}),r[n]=s}else typeof r[n]=="object"&&cP(r[n],t);else typeof r=="object"&&cP(r,t)}}function MTe(a){return a.type?a.type=a.type.toLowerCase():a.image?a.type="image":a.type="real",a.lat&&typeof a.lat=="string"&&(a.lat=parseFloat(a.lat)),a.long&&typeof a.long=="string"&&(a.long=parseFloat(a.long)),a.defaultZoom&&typeof a.defaultZoom=="string"&&(a.defaultZoom=parseInt(a.defaultZoom,10)),a.minZoom&&typeof a.minZoom=="string"&&(a.minZoom=parseInt(a.minZoom,10)),a.maxZoom&&typeof a.maxZoom=="string"&&(a.maxZoom=parseInt(a.maxZoom,10)),a.scale&&typeof a.scale=="string"&&(a.scale=parseFloat(a.scale)),typeof a.darkMode=="string"&&(a.darkMode=a.darkMode.toLowerCase()==="true"),typeof a.draw=="string"&&(a.draw=a.draw.toLowerCase()==="true"),a.marker&&typeof a.marker=="string"&&(a.marker=[a.marker]),a.markerFile&&typeof a.markerFile=="string"&&(a.markerFile=[a.markerFile]),a.markerTag&&typeof a.markerTag=="string"&&(a.markerTag=[a.markerTag]),a.geojson&&typeof a.geojson=="string"&&(a.geojson=[a.geojson]),a.gpx&&typeof a.gpx=="string"&&(a.gpx=[a.gpx]),a}function d3(a){let t=a.trim();t.startsWith("[")&&t.endsWith("]")&&(t=t.substring(1,t.length-1));let e=t.includes("|")?t.split("|").map(o=>o.trim()):t.split(",").map(o=>o.trim());if(e.length<2)return console.warn("Invalid marker definition:",a),{};let r={type:"default"},n=parseFloat(e[0]),s=parseFloat(e[1]);return!isNaN(n)&&!isNaN(s)?r.loc=[n,s]:(r.loc=[e[0],e[1]],r.percent=!0),e.length>2&&e[2]&&(r.link=e[2]),e.length>3&&e[3]&&(r.description=e[3]),e.length>4&&e[4]&&(r.icon=e[4]),r}function pE(a){let t=a.match(/\[\[([^\]|]+)(?:\|[^\]]+)?\]\]/);if(t)return t[1];let e=a.match(/\[([^\]]+)\]\(([^)]+)\)/);return e?e[2]:a}var hi=Ca(xT()),h3=require("obsidian");var mE=class{constructor(t,e,r,n){this.plugin=t;this.container=e;this.params=r;this.ctx=n;this.map=null;this.markers=new Map;this.layers=new Map;this.imageOverlay=null}async initialize(){try{this.params.type==="image"?await this.initializeImageMap():await this.initializeRealMap(),await this.addMarkers(),await this.addLayers(),this.fitBounds()}catch(t){throw console.error("Error initializing map:",t),t}}async initializeImageMap(){var l,c,u;if(!this.params.image)throw new Error("Image parameter required for image maps");let t=pE(this.params.image),e=this.plugin.app.metadataCache.getFirstLinkpathDest(t,this.ctx.sourcePath);if(!e)throw new Error(`Image not found: ${t}`);let r=this.plugin.app.vault.getResourcePath(e),{width:n,height:s}=await this.loadImageDimensions(r),o=new hi.LatLngBounds([0,0],[s,n]);this.map=new hi.Map(this.container,{crs:hi.CRS.Simple,minZoom:(l=this.params.minZoom)!=null?l:-2,maxZoom:(c=this.params.maxZoom)!=null?c:3,zoom:(u=this.params.defaultZoom)!=null?u:0,center:o.getCenter(),attributionControl:!1,zoomControl:!0}),this.imageOverlay=new hi.ImageOverlay(r,o).addTo(this.map),this.map.fitBounds(o)}async initializeRealMap(){var r,n,s,o,l;let t=[(r=this.params.lat)!=null?r:0,(n=this.params.long)!=null?n:0];this.map=new hi.Map(this.container,{center:t,zoom:(s=this.params.defaultZoom)!=null?s:13,minZoom:(o=this.params.minZoom)!=null?o:1,maxZoom:(l=this.params.maxZoom)!=null?l:18,attributionControl:!0,zoomControl:!0});let e=this.getTileServerUrl();new hi.TileLayer(e,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',maxZoom:19}).addTo(this.map)}getTileServerUrl(){return this.params.tileServer?this.params.tileServer:this.params.darkMode?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}async addMarkers(){if(!this.map)return;let t=[];if(this.params.marker){let e=Array.isArray(this.params.marker)?this.params.marker:[this.params.marker];for(let r of e){let n=d3(r);n.loc&&t.push(n)}}if(this.params.markerFile){let e=await this.loadMarkersFromFiles(this.params.markerFile);t.push(...e)}if(this.params.markerTag){let e=await this.loadMarkersFromTags(this.params.markerTag);t.push(...e)}for(let e of t)this.addMarker(e)}addMarker(t){var o;if(!this.map)return;let e=this.convertToLatLng(t.loc,t.percent),r=this.createMarkerIcon(t),n=new hi.Marker(e,{icon:r});t.link&&n.on("click",()=>{this.handleMarkerClick(t)}),t.description&&n.bindTooltip(t.description),n.addTo(this.map);let s=(o=t.id)!=null?o:this.generateMarkerId();this.markers.set(s,n)}createMarkerIcon(t){let e=this.getMarkerIconHtml(t);return new hi.DivIcon({html:e,className:"storyteller-map-marker",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]})}getMarkerIconHtml(t){var r;let e=(r=t.iconColor)!=null?r:"#3b82f6";if(t.icon)return t.icon;switch(t.type){case"location":return this.createLocationIcon(e);case"character":return this.createCharacterIcon(e);case"event":return this.createEventIcon(e);default:return this.createDefaultIcon(e)}}createDefaultIcon(t){return`
            <svg width="32" height="32" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"
                      fill="${t}"
                      stroke="#fff"
                      stroke-width="1"/>
            </svg>
        `}createLocationIcon(t){return`
            <svg width="32" height="32" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="10" r="8" fill="${t}" stroke="#fff" stroke-width="2"/>
                <circle cx="12" cy="10" r="3" fill="#fff"/>
            </svg>
        `}createCharacterIcon(t){return`
            <svg width="32" height="32" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="8" r="4" fill="${t}" stroke="#fff" stroke-width="1.5"/>
                <path d="M12 14c-4 0-7 2-7 4v2h14v-2c0-2-3-4-7-4z"
                      fill="${t}"
                      stroke="#fff"
                      stroke-width="1.5"/>
            </svg>
        `}createEventIcon(t){return`
            <svg width="32" height="32" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"
                      fill="none"
                      stroke="${t}"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"/>
            </svg>
        `}handleMarkerClick(t){if(!t.link)return;let e=pE(t.link),r=this.plugin.app.metadataCache.getFirstLinkpathDest(e,this.ctx.sourcePath);r?this.plugin.app.workspace.getLeaf(!1).openFile(r):new h3.Notice(`File not found: ${e}`)}convertToLatLng(t,e){if(t instanceof hi.LatLng)return t;if(typeof t=="object"&&"lat"in t&&"lng"in t)return new hi.LatLng(t.lat,t.lng);let r=t;if(e&&this.params.type==="image"&&this.imageOverlay){let n=this.imageOverlay.getBounds(),s=n.getNorth(),o=n.getEast(),l=typeof r[1]=="string"?parseFloat(r[1].replace("%","")):r[1],c=typeof r[0]=="string"?parseFloat(r[0].replace("%","")):r[0];return new hi.LatLng(c/100*s,l/100*o)}return new hi.LatLng(typeof r[0]=="string"?parseFloat(r[0]):r[0],typeof r[1]=="string"?parseFloat(r[1]):r[1])}async loadMarkersFromFiles(t){let e=[],r=Array.isArray(t)?t:[t];for(let n of r){let s=pE(n),o=this.plugin.app.metadataCache.getFirstLinkpathDest(s,this.ctx.sourcePath);if(o){let l=await this.extractMarkersFromFile(o);e.push(...l)}}return e}async loadMarkersFromTags(t){var s;let e=[],r=Array.isArray(t)?t:[t],n=this.plugin.app.vault.getMarkdownFiles();for(let o of n){let l=this.plugin.app.metadataCache.getFileCache(o);if(!(l!=null&&l.frontmatter))continue;let c=(s=l.frontmatter.tags)!=null?s:[];if(r.some(d=>c.includes(d)||c.includes(`#${d}`))){let d=await this.extractMarkersFromFile(o);e.push(...d)}}return e}async extractMarkersFromFile(t){let e=[],r=this.plugin.app.metadataCache.getFileCache(t);if(!(r!=null&&r.frontmatter))return e;let n=r.frontmatter;if(n.location||n.lat&&n.long){let s={type:"default",loc:[0,0],link:`[[${t.basename}]]`};n.lat&&n.long?s.loc=[Number(n.lat),Number(n.long)]:n.location&&Array.isArray(n.location)&&n.location.length>=2&&(s.loc=[Number(n.location[0]),Number(n.location[1])]),n.markerIcon&&(s.icon=n.markerIcon),n.markerColor&&(s.iconColor=n.markerColor),n.markerTooltip&&(s.description=n.markerTooltip),e.push(s)}return e}async addLayers(){}fitBounds(){if(!this.map||this.markers.size===0||this.params.type==="image")return;let t=Array.from(this.markers.values()).map(e=>e.getLatLng());if(t.length>0){let e=new hi.LatLngBounds(t);this.map.fitBounds(e,{padding:[50,50]})}}loadImageDimensions(t){return new Promise((e,r)=>{let n=new Image;n.onload=()=>{e({width:n.width,height:n.height})},n.onerror=()=>{r(new Error("Failed to load image"))},n.src=t})}generateMarkerId(){return`marker-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}invalidateSize(){this.map&&setTimeout(()=>{this.map&&this.map.invalidateSize()},100)}destroy(){this.map&&(this.map.remove(),this.map=null),this.markers.clear(),this.layers.clear(),this.imageOverlay=null}getMap(){return this.map}};var gE=class{constructor(t){this.plugin=t;this.activeMaps=new Map}register(){this.plugin.registerMarkdownCodeBlockProcessor("storyteller-map",this.processCodeBlock.bind(this))}async processCodeBlock(t,e,r){try{let n=u3(t),s=this.validateParameters(n);if(s){this.renderError(e,s);return}n.id||(n.id=this.generateMapId(r));let o=this.createMapContainer(e,n),l=new mE(this.plugin,o,n,r);await l.initialize(),this.activeMaps.set(n.id,l),r.addChild({onunload:()=>{l.destroy(),this.activeMaps.delete(n.id)}})}catch(n){console.error("Error rendering storyteller-map:",n),this.renderError(e,`Failed to render map: ${n.message}`)}}validateParameters(t){if(t.type==="image"&&!t.image)return'Image maps require an "image" parameter';if(t.type==="real"){if(t.lat!==void 0&&(isNaN(t.lat)||t.lat<-90||t.lat>90))return"Invalid latitude (must be between -90 and 90)";if(t.long!==void 0&&(isNaN(t.long)||t.long<-180||t.long>180))return"Invalid longitude (must be between -180 and 180)"}return null}generateMapId(t){let e=t.sourcePath,r=Date.now(),n=Math.random().toString(36).substr(2,5);return`map-${e.replace(/[^a-zA-Z0-9]/g,"-")}-${r}-${n}`}createMapContainer(t,e){var o,l;let r=t.createDiv("storyteller-map-container"),n=(o=e.height)!=null?o:500,s=(l=e.width)!=null?l:"100%";return r.style.height=typeof n=="number"?`${n}px`:n,r.style.width=typeof s=="number"?`${s}px`:s,r.style.position="relative",e.id&&(r.dataset.mapId=e.id),r}renderError(t,e){let r=t.createDiv("storyteller-map-error");r.style.padding="1em",r.style.border="1px solid var(--background-modifier-error)",r.style.borderRadius="4px",r.style.backgroundColor="var(--background-modifier-error)",r.style.color="var(--text-error)";let n=r.createEl("strong");n.textContent="Map Error: ";let s=r.createSpan();s.textContent=e,new f3.Notice(`Storyteller Map: ${e}`)}getMap(t){return this.activeMaps.get(t)}getAllMaps(){return Array.from(this.activeMaps.values())}invalidateAllMapSizes(){for(let t of this.activeMaps.values())t.invalidateSize()}cleanup(){for(let t of this.activeMaps.values())t.destroy();this.activeMaps.clear()}};var Vs=require("obsidian"),vE=class{constructor(t,e="StorytellerSuite/Templates"){this.builtInTemplates=new Map;this.userTemplates=new Map;this.app=t,this.templateFolder=e}setTemplateNoteManager(t){this.templateNoteManager=t}async initialize(){await this.loadBuiltInTemplates(),await this.loadUserTemplates()}async loadBuiltInTemplates(){try{let{FANTASY_KINGDOM_TEMPLATE:t}=await Promise.resolve().then(()=>(m3(),p3));this.builtInTemplates.set(t.id,t)}catch(t){console.log("Fantasy Kingdom template not yet available")}try{let{CYBERPUNK_METROPOLIS_TEMPLATE:t}=await Promise.resolve().then(()=>(v3(),g3));this.builtInTemplates.set(t.id,t)}catch(t){console.log("Cyberpunk Metropolis template not yet available")}try{let{MURDER_MYSTERY_TEMPLATE:t}=await Promise.resolve().then(()=>(b3(),y3));this.builtInTemplates.set(t.id,t)}catch(t){console.log("Murder Mystery template not yet available")}try{let{BUILTIN_CHARACTER_TEMPLATES:t}=await Promise.resolve().then(()=>(x3(),S3));t.forEach(e=>{this.builtInTemplates.set(e.id,e)})}catch(t){console.log("Character templates not yet available:",t)}try{let{BUILTIN_LOCATION_TEMPLATES:t}=await Promise.resolve().then(()=>(O3(),A3));t.forEach(e=>{this.builtInTemplates.set(e.id,e)})}catch(t){console.log("Location templates not yet available:",t)}try{let{BUILTIN_EVENT_TEMPLATES:t}=await Promise.resolve().then(()=>(V3(),G3));t.forEach(e=>{this.builtInTemplates.set(e.id,e)})}catch(t){console.log("Event templates not yet available:",t)}try{let{BUILTIN_ITEM_TEMPLATES:t}=await Promise.resolve().then(()=>(X3(),K3));t.forEach(e=>{this.builtInTemplates.set(e.id,e)})}catch(t){console.log("Item templates not yet available:",t)}try{let{BUILTIN_GROUP_TEMPLATES:t}=await Promise.resolve().then(()=>(n4(),i4));t.forEach(e=>{this.builtInTemplates.set(e.id,e)})}catch(t){console.log("Group templates not yet available:",t)}try{let{BUILTIN_WORLDBUILDING_TEMPLATES:t}=await Promise.resolve().then(()=>(g4(),m4));t.forEach(e=>{this.builtInTemplates.set(e.id,e)})}catch(t){console.log("Worldbuilding templates not yet available:",t)}try{let{BUILTIN_STORY_STRUCTURE_TEMPLATES:t}=await Promise.resolve().then(()=>(L4(),P4));t.forEach(e=>{this.builtInTemplates.set(e.id,e)})}catch(t){console.log("Story structure templates not yet available:",t)}}async loadUserTemplates(){this.userTemplates.clear(),await this.ensureTemplateFolderExists(),await this.ensureEntityTypeFoldersExist(),await this.loadTemplatesFromFolder(this.templateFolder);let t=["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"];for(let e of t){let r=this.getEntityTypeFolder(e),n=`${this.templateFolder}/${r}`;await this.loadTemplatesFromFolder(n)}}async loadTemplatesFromFolder(t){let e=this.app.vault.getAbstractFileByPath(t);if(!e||!(e instanceof Vs.TFolder))return;let r=e.children.filter(n=>n instanceof Vs.TFile&&n.extension==="json");for(let n of r)if(n instanceof Vs.TFile)try{let s=await this.app.vault.read(n),o=JSON.parse(s),l=this.validateTemplate(o);l.isValid?this.userTemplates.set(o.id,o):console.warn(`Invalid template ${n.path}:`,l.errors)}catch(s){console.error(`Error loading template ${n.path}:`,s)}}async ensureTemplateFolderExists(){if(!this.app.vault.getAbstractFileByPath(this.templateFolder))try{await this.app.vault.createFolder(this.templateFolder)}catch(e){console.debug("Template folder already exists or could not be created:",e)}}getEntityTypeFolder(t){return{character:"Characters",location:"Locations",event:"Events",item:"Items",group:"Groups",culture:"Cultures",economy:"Economies",magicSystem:"MagicSystems",chapter:"Chapters",scene:"Scenes",reference:"References"}[t]||"General"}determineTemplateEntityType(t){return t.entityTypes&&t.entityTypes.length>0?t.entityTypes[0]:"character"}async ensureEntityTypeFoldersExist(){let t=["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"];for(let e of t){let r=this.getEntityTypeFolder(e),n=`${this.templateFolder}/${r}`;if(!this.app.vault.getAbstractFileByPath(n))try{await this.app.vault.createFolder(n)}catch(o){}}}getAllTemplates(){let t=[...Array.from(this.builtInTemplates.values()),...Array.from(this.userTemplates.values())];if(this.templateNoteManager){let e=this.templateNoteManager.getAllNoteTemplates();t.push(...e)}return t}getFilteredTemplates(t){let e=this.getAllTemplates();if(t.showBuiltIn===!1&&(e=e.filter(s=>!s.isBuiltIn)),t.showCustom===!1&&(e=e.filter(s=>s.isBuiltIn)),t.genre&&t.genre.length>0&&(e=e.filter(s=>t.genre.includes(s.genre))),t.category&&t.category.length>0&&(e=e.filter(s=>t.category.includes(s.category))),t.entityTypes&&t.entityTypes.length>0&&(e=e.filter(s=>s.entityTypes?t.entityTypes.some(o=>s.entityTypes.includes(o)):!1)),t.author&&t.author.length>0&&(e=e.filter(s=>t.author.includes(s.author))),t.searchText){let s=t.searchText.toLowerCase();e=e.filter(o=>o.name.toLowerCase().includes(s)||o.description.toLowerCase().includes(s)||o.tags.some(l=>l.toLowerCase().includes(s)))}let n=e.map(s=>({template:s,stats:this.getTemplateStats(s)}));return t.minEntities!==void 0&&(n=n.filter(s=>s.stats.totalEntities>=t.minEntities)),t.maxEntities!==void 0&&(n=n.filter(s=>s.stats.totalEntities<=t.maxEntities)),e=n.map(s=>s.template),t.sortByUsage?e=e.sort((s,o)=>(o.usageCount||0)-(s.usageCount||0)):t.sortByRecent&&(e=e.sort((s,o)=>{let l=s.lastUsed?new Date(s.lastUsed).getTime():0;return(o.lastUsed?new Date(o.lastUsed).getTime():0)-l})),e}getTemplate(t){let e=this.builtInTemplates.get(t);if(e)return e;let r=this.userTemplates.get(t);if(r)return r;if(this.templateNoteManager){let n=this.templateNoteManager.getNoteTemplate(t);if(n)return n}}async saveTemplate(t){if(t.isBuiltIn)throw new Error("Cannot save built-in templates. Create a copy first.");let e=this.validateTemplate(t);if(!e.isValid)throw new Error(`Invalid template: ${e.errors.join(", ")}`);t.modified=new Date().toISOString();let r=this.determineTemplateEntityType(t),n=this.getEntityTypeFolder(r),s=`${this.templateFolder}/${n}`;await this.ensureTemplateFolderExists(),await this.ensureEntityTypeFoldersExist();let o=`${s}/${t.id}.json`,l=JSON.stringify(t,null,2),c=`${this.templateFolder}/${t.id}.json`,u=this.app.vault.getAbstractFileByPath(c);u instanceof Vs.TFile&&await this.app.vault.delete(u);let d=this.app.vault.getAbstractFileByPath(o);d instanceof Vs.TFile?await this.app.vault.modify(d,l):await this.app.vault.create(o,l),this.userTemplates.set(t.id,t),new Vs.Notice(`Template "${t.name}" saved successfully`)}async deleteTemplate(t){let e=this.userTemplates.get(t);if(!e)throw new Error("Template not found or is built-in");let r=this.determineTemplateEntityType(e),n=this.getEntityTypeFolder(r),o=`${`${this.templateFolder}/${n}`}/${t}.json`,l=this.app.vault.getAbstractFileByPath(o);l||(o=`${this.templateFolder}/${t}.json`,l=this.app.vault.getAbstractFileByPath(o)),l instanceof Vs.TFile&&await this.app.vault.delete(l),this.userTemplates.delete(t),new Vs.Notice(`Template "${e.name}" deleted`)}async copyTemplate(t,e){let r=this.getTemplate(t);if(!r)throw new Error("Source template not found");let n=JSON.parse(JSON.stringify(r)),{TemplateMigrator:s}=await Promise.resolve().then(()=>(Ak(),Ik));return n=s.migrateTemplateToNewFormat(n),n={...n,id:`custom-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:e,author:"User",isBuiltIn:!1,isEditable:!0,created:new Date().toISOString(),modified:new Date().toISOString()},await this.saveTemplate(n),n}validateTemplate(t){let{TemplateValidator:e}=(I4(),Do(M4));return e.validate(t)}getTemplateStats(t){var l,c,u,d,h,f,m,g,y,v,E;let e=t.entities,r={character:((l=e.characters)==null?void 0:l.length)||0,location:((c=e.locations)==null?void 0:c.length)||0,event:((u=e.events)==null?void 0:u.length)||0,item:((d=e.items)==null?void 0:d.length)||0,group:((h=e.groups)==null?void 0:h.length)||0,culture:((f=e.cultures)==null?void 0:f.length)||0,economy:((m=e.economies)==null?void 0:m.length)||0,magicSystem:((g=e.magicSystems)==null?void 0:g.length)||0,chapter:((y=e.chapters)==null?void 0:y.length)||0,scene:((v=e.scenes)==null?void 0:v.length)||0,reference:((E=e.references)==null?void 0:E.length)||0},n=Object.values(r).reduce((C,_)=>C+_,0),s=0,o=(C,_)=>{C&&C.forEach(x=>{_.forEach(P=>{let I=x[P];Array.isArray(I)?s+=I.length:I&&(s+=1)})})};return o(e.characters,["relationships","locations","events","groups","connections"]),o(e.locations,["groups","connections"]),o(e.events,["characters","groups","connections","dependencies"]),o(e.items,["associatedEvents","groups"]),o(e.groups,["members","territories","linkedEvents"]),{totalEntities:n,entityCounts:r,totalRelationships:s}}async exportTemplate(t,e=!1){let r=this.getTemplate(t);if(!r)throw new Error("Template not found");let n={template:r,exportVersion:"1.0.0",exportedAt:new Date().toISOString()};return e&&(n.bundledImages=[]),n}async importTemplate(t,e=!0){let r=t.template;return e&&(r={...r,id:`imported-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,isBuiltIn:!1,isEditable:!0,created:new Date().toISOString(),modified:new Date().toISOString()}),t.bundledImages&&t.bundledImages.length>0,await this.saveTemplate(r),r}setTemplateFolder(t){this.templateFolder=t}getTemplateFolder(){return this.templateFolder}async incrementUsageCount(t){let e=this.getTemplate(t);e&&(e.usageCount=(e.usageCount||0)+1,e.lastUsed=new Date().toISOString(),e.isBuiltIn||await this.saveTemplate(e),this.userTemplates.set(t,e))}getTemplatesByEntityType(t){return this.getAllTemplates().filter(e=>{var r;return(r=e.entityTypes)==null?void 0:r.includes(t)})}getRecentlyUsedTemplates(t=5){return this.getAllTemplates().filter(e=>e.lastUsed).sort((e,r)=>{let n=new Date(e.lastUsed).getTime();return new Date(r.lastUsed).getTime()-n}).slice(0,t)}getMostPopularTemplates(t=5){return this.getAllTemplates().filter(e=>e.usageCount&&e.usageCount>0).sort((e,r)=>(r.usageCount||0)-(e.usageCount||0)).slice(0,t)}autoPopulateEntityTypes(t){let e=[],r=t.entities;r.characters&&r.characters.length>0&&e.push("character"),r.locations&&r.locations.length>0&&e.push("location"),r.events&&r.events.length>0&&e.push("event"),r.items&&r.items.length>0&&e.push("item"),r.groups&&r.groups.length>0&&e.push("group"),r.cultures&&r.cultures.length>0&&e.push("culture"),r.economies&&r.economies.length>0&&e.push("economy"),r.magicSystems&&r.magicSystems.length>0&&e.push("magicSystem"),r.chapters&&r.chapters.length>0&&e.push("chapter"),r.scenes&&r.scenes.length>0&&e.push("scene"),r.references&&r.references.length>0&&e.push("reference"),t.entityTypes=e}};var rd=require("obsidian");oi();var td=class{static async convertNoteToTemplate(t,e,r,n){let s=await t.vault.read(e),{yamlContent:o,markdownContent:l,frontmatter:c}=this.extractContent(s),u=this.detectVariables(o,l),d=this.extractTemplateMetadata(c),h={name:d.templateName||n.name,description:d.templateDescription||n.description,genre:d.templateGenre||n.genre,category:d.templateCategory||n.category,tags:d.templateTags||n.tags||[]},f=this.mergeVariables(u,d.templateVariables||[]),m={templateId:`${r.toUpperCase()}_1`,yamlContent:o,markdownContent:l},g={},y=this.getEntityTypePlural(r);g[y]=[m];let v={id:`note-template-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:h.name,description:h.description,genre:h.genre,category:h.category,version:"1.0.0",author:"User",isBuiltIn:!1,isEditable:!0,created:new Date().toISOString(),modified:new Date().toISOString(),tags:h.tags,entities:g,entityTypes:[r],usageCount:0,quickApplyEnabled:!0,variables:f.length>0?f:void 0};return v.isNoteBased=!0,v.noteFilePath=e.path,v}static extractContent(t){let e="",r="",n={};if(t.startsWith("---")){let s=t.indexOf(`
---`,3);s!==-1?(e=t.substring(3,s).trim(),r=t.substring(s+4).trim(),n=RC(t)||{}):r=t}else r=t;return{yamlContent:e,markdownContent:r,frontmatter:n}}static detectVariables(t,e){let r=/\{\{([a-zA-Z][a-zA-Z0-9]*)(?::([^}]+))?\}\}/g,n=new Map;return this.scanForVariables(t,r,n),this.scanForVariables(e,r,n),Array.from(n.values())}static scanForVariables(t,e,r){let n;for(;(n=e.exec(t))!==null;){let s=n[1],o=n[2]||void 0;if(r.has(s))continue;let l={name:s,label:this.formatVariableLabel(s),type:"text",defaultValue:o};r.set(s,l)}}static formatVariableLabel(t){return t.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()}static extractTemplateMetadata(t){let e={};return t.templateName&&(e.templateName=String(t.templateName)),t.templateDescription&&(e.templateDescription=String(t.templateDescription)),t.templateGenre&&(e.templateGenre=t.templateGenre),t.templateCategory&&(e.templateCategory=t.templateCategory),t.templateTags&&(Array.isArray(t.templateTags)?e.templateTags=t.templateTags.map(r=>String(r)):e.templateTags=[String(t.templateTags)]),t.templateVariables&&Array.isArray(t.templateVariables)&&(e.templateVariables=t.templateVariables),e}static mergeVariables(t,e){let r=new Map;return t.forEach(n=>r.set(n.name,n)),e.forEach(n=>r.set(n.name,n)),Array.from(r.values())}static getEntityTypePlural(t){return{character:"characters",location:"locations",event:"events",item:"items",group:"groups",culture:"cultures",economy:"economies",magicSystem:"magicSystems",chapter:"chapters",scene:"scenes",reference:"references"}[t]}static detectEntityType(t,e){if(e){if(e.type){let s=String(e.type).toLowerCase();if(this.isValidEntityType(s))return s}if(e.entityType){let s=String(e.entityType).toLowerCase();if(this.isValidEntityType(s))return s}}let n=t.path.toLowerCase().split("/");for(let s of n){let o=s.replace(/s$/,"");if(this.isValidEntityType(o))return o}return null}static isValidEntityType(t){return["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"].includes(t)}};var yE=class{constructor(t,e,r="StorytellerSuite/Templates/Notes"){this.noteTemplates=new Map;this.app=t,this.templateStorageManager=e,this.notesFolder=r}async initialize(){await this.ensureNotesFolderExists(),await this.loadNoteTemplates()}async ensureNotesFolderExists(){if(!this.app.vault.getAbstractFileByPath(this.notesFolder))try{await this.app.vault.createFolder(this.notesFolder)}catch(r){console.debug("Notes folder already exists or could not be created:",r)}let e=["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"];for(let r of e){let n=this.getEntityTypeFolder(r),s=`${this.notesFolder}/${n}`;if(!this.app.vault.getAbstractFileByPath(s))try{await this.app.vault.createFolder(s)}catch(l){}}}getEntityTypeFolder(t){return{character:"Characters",location:"Locations",event:"Events",item:"Items",group:"Groups",culture:"Cultures",economy:"Economies",magicSystem:"MagicSystems",chapter:"Chapters",scene:"Scenes",reference:"References"}[t]||"General"}async loadNoteTemplates(){this.noteTemplates.clear();let t=this.app.vault.getAbstractFileByPath(this.notesFolder);if(!t||!(t instanceof rd.TFolder))return;await this.loadTemplatesFromFolder(this.notesFolder);let e=["character","location","event","item","group","culture","economy","magicSystem","chapter","scene","reference"];for(let r of e){let n=this.getEntityTypeFolder(r),s=`${this.notesFolder}/${n}`;await this.loadTemplatesFromFolder(s)}}async loadTemplatesFromFolder(t){let e=this.app.vault.getAbstractFileByPath(t);if(!e||!(e instanceof rd.TFolder))return;let r=e.children.filter(n=>n instanceof rd.TFile&&n.extension==="md");for(let n of r)try{let s=await this.loadTemplateFromNote(n);s&&this.noteTemplates.set(s.id,s)}catch(s){console.error(`Error loading template from note ${n.path}:`,s)}}extractContent(t){let e="",r="",n={};if(t.startsWith("---")){let s=t.indexOf(`
---`,3);s!==-1?(e=t.substring(3,s).trim(),r=t.substring(s+4).trim(),n=A4(t)||{}):r=t}else r=t;return{yamlContent:e,markdownContent:r,frontmatter:n}}async loadTemplateFromNote(t){try{let e=await this.app.vault.read(t),{frontmatter:r}=this.extractContent(e),n=td.detectEntityType(t,r);if(!n)return console.warn(`Could not detect entity type for ${t.path}`),null;let s={name:r.templateName||t.basename,description:r.templateDescription||"",genre:r.templateGenre||"custom",category:r.templateCategory||"single-entity",tags:r.templateTags?Array.isArray(r.templateTags)?r.templateTags.map(l=>String(l)):[String(r.templateTags)]:[]},o=await td.convertNoteToTemplate(this.app,t,n,s);return o.isNoteBased=!0,o.noteFilePath=t.path,o}catch(e){return console.error(`Error loading template from note ${t.path}:`,e),null}}async saveNoteAsTemplate(t,e,r){let n=await this.app.vault.read(t),s=this.getEntityTypeFolder(e),o=`${this.notesFolder}/${s}`;await this.ensureNotesFolderExists();let l=this.generateSafeFileName(r.name),c=`${o}/${l}.md`,u=this.addTemplateMetadataToContent(n,r),d=this.app.vault.getAbstractFileByPath(c);d instanceof rd.TFile?await this.app.vault.modify(d,u):await this.app.vault.create(c,u);let h=this.app.vault.getAbstractFileByPath(c),f=await this.loadTemplateFromNote(h);if(!f)throw new Error("Failed to create template from note");return await this.syncNoteToJson(f),this.noteTemplates.set(f.id,f),f}addTemplateMetadataToContent(t,e){let r={},n=t;if(t.startsWith("---")){let l=t.indexOf(`
---`,3);if(l!==-1){let c=t.substring(3,l);try{let{parseYaml:u}=require("obsidian");r=u(c)||{}}catch(u){r=A4(t)||{}}n=t.substring(l+4).trim()}}r.template=!0,r.templateName=e.name,r.templateDescription=e.description,r.templateGenre=e.genre,r.templateCategory=e.category,e.tags.length>0&&(r.templateTags=e.tags);let{stringifyYaml:s}=require("obsidian");return`---
${s(r)}---

${n}`}generateSafeFileName(t){return t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").substring(0,100)}async syncNoteToJson(t){try{let e={...t};delete e.isNoteBased,delete e.noteFilePath,await this.templateStorageManager.saveTemplate(e)}catch(e){console.warn("Failed to sync note template to JSON:",e)}}getAllNoteTemplates(){return Array.from(this.noteTemplates.values())}getNoteTemplate(t){return this.noteTemplates.get(t)}async deleteNoteTemplate(t){let e=this.noteTemplates.get(t);if(!e)throw new Error("Template not found");let r=e.noteFilePath;if(r){let n=this.app.vault.getAbstractFileByPath(r);n instanceof rd.TFile&&await this.app.vault.delete(n)}try{await this.templateStorageManager.deleteTemplate(t)}catch(n){}this.noteTemplates.delete(t)}async handleNoteChange(t){if(!t.path.startsWith(this.notesFolder)||t.extension!=="md")return;let e=await this.loadTemplateFromNote(t);e&&(this.noteTemplates.set(e.id,e),await this.syncNoteToJson(e))}};function A4(a){let{parseFrontmatterFromContent:t}=(oi(),Do(Xa));return t(a)}var Ff=require("obsidian");var bo=require("obsidian");ea();var bE=class extends hr{constructor(e,r,n,s="",o,l){super(e);this.templateName="";this.description="";this.genre="custom";this.category="single-entity";this.tags="";this.entityType="character";this.plugin=r,this.onSubmit=o,this.onCancel=l||(()=>{}),this.templateName=s||"New Template",n&&(this.entityType=n)}onOpen(){super.onOpen();let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:"Save Note as Template"}),new bo.Setting(e).setName("Template Name").setDesc("A descriptive name for this template").addText(o=>o.setPlaceholder("Enter template name").setValue(this.templateName).onChange(l=>this.templateName=l)),new bo.Setting(e).setName("Description").setDesc("Describe what this template provides").addTextArea(o=>{o.setPlaceholder("Enter description").setValue(this.description).onChange(l=>this.description=l),o.inputEl.rows=3}),new bo.Setting(e).setName("Entity Type").setDesc("What type of entity is this template for?").addDropdown(o=>{o.addOption("character","Character").addOption("location","Location").addOption("event","Event").addOption("item","Item").addOption("group","Group").addOption("culture","Culture").addOption("economy","Economy").addOption("magicSystem","Magic System").addOption("chapter","Chapter").addOption("scene","Scene").addOption("reference","Reference").setValue(this.entityType).onChange(l=>this.entityType=l)}),new bo.Setting(e).setName("Genre").setDesc("Genre classification for this template").addDropdown(o=>o.addOption("fantasy","Fantasy").addOption("scifi","Sci-Fi").addOption("mystery","Mystery").addOption("horror","Horror").addOption("romance","Romance").addOption("historical","Historical").addOption("western","Western").addOption("thriller","Thriller").addOption("custom","Custom").setValue(this.genre).onChange(l=>this.genre=l)),new bo.Setting(e).setName("Category").setDesc("Template scope").addDropdown(o=>o.addOption("single-entity","Single Entity").addOption("entity-set","Entity Set").addOption("full-world","Full World").setValue(this.category).onChange(l=>this.category=l)),new bo.Setting(e).setName("Tags").setDesc("Comma-separated tags for searching (e.g., hero, brave, protagonist)").addText(o=>o.setPlaceholder("tag1, tag2, tag3").setValue(this.tags).onChange(l=>this.tags=l)),e.createEl("p",{text:"Tip: Use {{variableName}} in your note to create customizable fields.",cls:"setting-item-description",attr:{style:"margin-top: 1em; font-style: italic;"}});let r=e.createDiv({cls:"modal-button-container"});r.style.marginTop="1em",r.style.display="flex",r.style.gap="0.5em",r.style.justifyContent="flex-end",r.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.onCancel(),this.close()}),r.createEl("button",{text:"Save Template",cls:"mod-cta"}).addEventListener("click",()=>this.handleSave())}handleSave(){if(!this.templateName||this.templateName.trim()===""){new bo.Notice("Please enter a template name");return}if(!this.description||this.description.trim()===""){new bo.Notice("Please enter a description");return}let e=this.tags.split(",").map(r=>r.trim()).filter(r=>r.length>0);this.onSubmit({name:this.templateName.trim(),description:this.description.trim(),genre:this.genre,category:this.category,tags:e,entityType:this.entityType}),this.close()}onClose(){this.contentEl.empty()}};var wE=class{static async execute(t,e){if(!e){let s=t.app.workspace.getActiveFile();if(!s){new Ff.Notice("Please open a note to save as template");return}e=s}if(e.extension!=="md"){new Ff.Notice("Only markdown files can be saved as templates");return}let r=null;try{let s=await t.app.vault.read(e),{parseFrontmatterFromContent:o}=await Promise.resolve().then(()=>(oi(),Xa)),l=o(s);r=td.detectEntityType(e,l)}catch(s){console.error("Error reading file:",s)}let n=e.basename.replace(/[-_]/g," ");new bE(t.app,t,r,n,async s=>{try{if(!t.templateNoteManager){new Ff.Notice("Template note manager not initialized");return}let o=await t.templateNoteManager.saveNoteAsTemplate(e,s.entityType,{name:s.name,description:s.description,genre:s.genre,category:s.category,tags:s.tags});new Ff.Notice(`Template "${o.name}" saved successfully!`)}catch(o){console.error("Error saving template:",o),new Ff.Notice(`Failed to save template: ${o.message}`)}}).open()}};var Ba=require("obsidian");var fi=require("obsidian");hP();var EE=class extends fi.Modal{constructor(t,e,r,n){super(t),this.plugin=e,this.templateManager=r,this.template=n,this.modalEl.addClass("storyteller-template-detail-modal")}onOpen(){let{contentEl:t}=this;t.empty(),this.renderHeader(t),this.renderTemplateInfo(t),this.renderEntityBreakdown(t),this.renderPreview(t),this.renderFooter(t)}renderHeader(t){let e=t.createDiv("storyteller-template-detail-header"),r=e.createEl("button",{cls:"storyteller-back-btn"});r.setText("\u2190 Back to Gallery"),r.onclick=()=>{this.close()},e.createEl("h2",{text:this.template.name})}renderTemplateInfo(t){var o;let e=t.createDiv("storyteller-template-info"),r=e.createDiv("storyteller-template-meta");r.createEl("span",{text:this.template.genre.charAt(0).toUpperCase()+this.template.genre.slice(1),cls:"storyteller-badge"}).setAttribute("data-genre",this.template.genre);let s=r.createEl("span",{text:this.template.category.replace("-"," ").replace(/\b\w/g,l=>l.toUpperCase()),cls:"storyteller-badge"});if(this.template.isBuiltIn&&r.createEl("span",{text:"\u2B50 Built-in",cls:"storyteller-badge storyteller-badge-builtin"}),r.createEl("span",{text:`v${this.template.version}`,cls:"storyteller-version"}),r.createEl("span",{text:`by ${this.template.author}`,cls:"storyteller-author"}),e.createEl("p",{text:this.template.description,cls:"storyteller-template-description"}),this.template.tags&&this.template.tags.length>0){let l=e.createDiv("storyteller-template-tags");this.template.tags.forEach(c=>{l.createEl("span",{text:`#${c}`,cls:"storyteller-tag"})})}if((o=this.template.metadata)!=null&&o.setupInstructions){let l=e.createDiv("storyteller-template-instructions");l.createEl("h4",{text:"Setup Instructions"}),l.createEl("p",{text:this.template.metadata.setupInstructions})}}renderEntityBreakdown(t){let e=t.createDiv("storyteller-entity-breakdown");e.createEl("h3",{text:"Included Entities"});let r=this.templateManager.getTemplateStats(this.template),n=e.createDiv("storyteller-entity-grid");[{key:"character",label:"Characters",icon:"\u{1F464}"},{key:"location",label:"Locations",icon:"\u{1F4CD}"},{key:"event",label:"Events",icon:"\u{1F4C5}"},{key:"item",label:"Items",icon:"\u{1F4E6}"},{key:"group",label:"Groups",icon:"\u{1F465}"},{key:"culture",label:"Cultures",icon:"\u{1F3DB}\uFE0F"},{key:"economy",label:"Economies",icon:"\u{1F4B0}"},{key:"magicSystem",label:"Magic Systems",icon:"\u2728"},{key:"chapter",label:"Chapters",icon:"\u{1F4D6}"},{key:"scene",label:"Scenes",icon:"\u{1F3AC}"},{key:"reference",label:"References",icon:"\u{1F4DD}"}].forEach(({key:l,label:c,icon:u})=>{let d=r.entityCounts[l];if(d>0){let h=n.createDiv("storyteller-entity-count-card");h.createEl("div",{text:u,cls:"entity-icon"}),h.createEl("div",{text:d.toString(),cls:"entity-count"}),h.createEl("div",{text:c,cls:"entity-label"})}});let o=e.createDiv("storyteller-entity-totals");o.createEl("strong",{text:`Total: ${r.totalEntities} entities`}),o.createEl("span",{text:` \u2022 ${r.totalRelationships} relationships`})}renderPreview(t){let e=t.createDiv("storyteller-template-preview-section");e.createEl("h3",{text:"Preview"}),this.renderEntityList(e,"Characters",this.template.entities.characters||[],"\u{1F464}"),this.renderEntityList(e,"Locations",this.template.entities.locations||[],"\u{1F4CD}"),this.renderEntityList(e,"Events",this.template.entities.events||[],"\u{1F4C5}"),this.renderEntityList(e,"Groups",this.template.entities.groups||[],"\u{1F465}"),this.renderEntityList(e,"Items",this.template.entities.items||[],"\u{1F4E6}"),this.renderEntityList(e,"Cultures",this.template.entities.cultures||[],"\u{1F3DB}\uFE0F"),this.renderEntityList(e,"Economies",this.template.entities.economies||[],"\u{1F4B0}"),this.renderEntityList(e,"Magic Systems",this.template.entities.magicSystems||[],"\u2728")}renderEntityList(t,e,r,n){if(r.length===0)return;let s=t.createDiv("storyteller-entity-list-section"),o=s.createDiv("storyteller-entity-list-header");o.createEl("span",{text:`${n} ${e} (${r.length})`});let l=o.createEl("button",{text:"\u25BC",cls:"storyteller-toggle-btn"}),c=s.createDiv("storyteller-entity-list");c.style.display="none",r.slice(0,10).forEach(d=>{let h=c.createDiv("storyteller-entity-list-item");h.createEl("strong",{text:d.name}),d.description&&h.createEl("p",{text:d.description})}),r.length>10&&c.createEl("p",{text:`... and ${r.length-10} more`,cls:"storyteller-more-items"});let u=!1;l.onclick=()=>{u=!u,c.style.display=u?"block":"none",l.setText(u?"\u25B2":"\u25BC")}}renderFooter(t){let e=t.createDiv("storyteller-template-footer"),r=e.createDiv("storyteller-mode-section");r.createEl("label",{text:"Application Mode:"});let n=r.createDiv("storyteller-radio-group"),s=n.createEl("label"),o=s.createEl("input",{type:"radio",value:"merge"});o.setAttribute("name","applyMode"),o.checked=!0,s.createSpan().setText(" Merge with existing story");let l=n.createEl("label");l.createEl("input",{type:"radio",value:"replace"}).setAttribute("name","applyMode"),l.createSpan().setText(" Replace current story");let u=e.createDiv("storyteller-template-actions");new fi.ButtonComponent(u).setButtonText("Cancel").onClick(()=>{this.close()}),!this.template.isBuiltIn&&this.template.isEditable&&new fi.ButtonComponent(u).setButtonText("Edit Template").onClick(()=>{new fi.Notice("Template editor coming soon!")}),this.template.isBuiltIn&&new fi.ButtonComponent(u).setButtonText("Copy & Customize").onClick(async()=>{try{let d=await this.templateManager.copyTemplate(this.template.id,`${this.template.name} (Custom)`);new fi.Notice(`Created custom copy: ${d.name}`)}catch(d){new fi.Notice(`Failed to copy template: ${d.message}`)}}),new fi.ButtonComponent(u).setButtonText("Customize Before Applying").onClick(()=>{new fi.Notice("Template customization coming soon!")}),new fi.ButtonComponent(u).setButtonText("Apply Template").setCta().onClick(async()=>{await this.applyTemplate()})}async applyTemplate(){let t=this.plugin.settings.activeStoryId;if(!t){new fi.Notice("Please select or create a story first");return}let e=this.contentEl.querySelector('input[name="applyMode"]:checked'),r=(e==null?void 0:e.value)||"merge";if(r==="replace"&&!await this.confirmReplace())return;this.close();let n=new fi.Notice("Applying template... This may take a moment.",0);try{let s=new wv(this.plugin),o={storyId:t,mode:r,mergeRelationships:r==="merge"},l=await s.applyTemplate(this.template,o);n.hide(),l.success?new fi.Notice(`Template "${this.template.name}" applied successfully! Created ${l.created.characters.length} characters, ${l.created.locations.length} locations, and more.`,8e3):new fi.Notice(`Failed to apply template: ${l.error}`,8e3)}catch(s){n.hide(),new fi.Notice(`Error applying template: ${s.message}`,8e3),console.error("Template application error:",s)}}async confirmReplace(){return new Promise(t=>{let e=new fi.Modal(this.app);e.contentEl.createEl("h2",{text:"\u26A0\uFE0F Replace Story?"}),e.contentEl.createEl("p",{text:"This will delete all existing entities in the current story and replace them with the template. This action cannot be undone!"}),e.contentEl.createEl("p",{text:"Are you sure you want to proceed?",cls:"mod-warning"});let r=e.contentEl.createDiv("modal-button-container");new fi.ButtonComponent(r).setButtonText("Cancel").onClick(()=>{e.close(),t(!1)}),new fi.ButtonComponent(r).setButtonText("Replace Story").setWarning().onClick(()=>{e.close(),t(!0)}),e.open()})}onClose(){this.contentEl.empty()}};H0();var TE=class a extends Ba.Modal{constructor(e,r,n){super(e);this.selectedGenre="all";this.selectedCategory="all";this.searchText="";this.plugin=r,this.templateManager=n,this.modalEl.addClass("storyteller-story-template-gallery-modal")}onOpen(){let{contentEl:e}=this;e.empty(),this.renderHeader(e),this.renderFilters(e),this.renderTemplateGrid(e),this.renderFooter(e)}renderHeader(e){let r=e.createDiv("storyteller-template-header");r.createEl("h2",{text:"\u{1F4DA} Story Template Gallery"}),r.createEl("p",{text:"Choose a pre-built template to jumpstart your story with characters, locations, and relationships",cls:"storyteller-template-subtitle"})}renderFilters(e){let r=e.createDiv("storyteller-template-filters"),n=r.createDiv("storyteller-filter-row");n.createEl("label",{text:"Genre:"});let s=n.createDiv("storyteller-filter-buttons");[{id:"all",label:"All",icon:"layout-grid"},{id:"fantasy",label:"Fantasy",icon:"wand"},{id:"scifi",label:"Sci-Fi",icon:"rocket"},{id:"mystery",label:"Mystery",icon:"search"},{id:"horror",label:"Horror",icon:"skull"},{id:"romance",label:"Romance",icon:"heart"},{id:"historical",label:"Historical",icon:"landmark"},{id:"custom",label:"Custom",icon:"star"}].forEach(f=>{let m=s.createEl("button",{cls:"storyteller-filter-btn"});this.selectedGenre===f.id&&m.addClass("active");let g=m.createSpan("storyteller-filter-icon");(0,Ba.setIcon)(g,f.icon),m.createSpan().setText(f.label),m.onclick=()=>{this.selectedGenre=f.id,this.onOpen()}});let l=r.createDiv("storyteller-filter-row");l.createEl("label",{text:"Category:"});let c=l.createDiv("storyteller-filter-buttons");[{id:"all",label:"All"},{id:"full-world",label:"Full World"},{id:"entity-set",label:"Entity Set"},{id:"single-entity",label:"Single Entity"}].forEach(f=>{let m=c.createEl("button",{cls:"storyteller-filter-btn"});this.selectedCategory===f.id&&m.addClass("active"),m.setText(f.label),m.onclick=()=>{this.selectedCategory=f.id,this.onOpen()}});let d=r.createDiv("storyteller-filter-row");d.createEl("label",{text:"Search:"});let h=d.createEl("input",{type:"text",placeholder:"Search templates...",value:this.searchText});h.addClass("storyteller-search-input"),h.addEventListener("input",f=>{this.searchText=f.target.value,this.onOpen()})}renderTemplateGrid(e){let r=e.createDiv("storyteller-template-grid"),n={searchText:this.searchText||void 0,showBuiltIn:!0,showCustom:!0};this.selectedGenre!=="all"&&(n.genre=[this.selectedGenre]),this.selectedCategory!=="all"&&(n.category=[this.selectedCategory]);let s=this.templateManager.getFilteredTemplates(n);if(s.length===0){let o=r.createDiv("storyteller-empty-state");o.createEl("div",{text:"\u{1F4ED}",cls:"storyteller-empty-icon"}),o.createEl("p",{text:"No templates match your filters"});return}s.forEach(o=>{this.renderTemplateCard(r,o)})}renderTemplateCard(e,r){let n=e.createDiv("storyteller-template-card"),s=n.createDiv("storyteller-template-preview");s.createDiv("storyteller-template-icon-large").setText(this.getGenreIcon(r.genre));let l=s.createDiv("storyteller-template-badges");if(l.createEl("span",{text:r.genre.charAt(0).toUpperCase()+r.genre.slice(1),cls:"storyteller-template-badge"}).setAttribute("data-genre",r.genre),r.isBuiltIn){let v=l.createEl("span",{text:"\u2B50 Built-in",cls:"storyteller-template-badge storyteller-badge-builtin"})}let u=n.createDiv("storyteller-template-content");u.createEl("h3",{text:r.name}),u.createEl("p",{text:r.description,cls:"storyteller-template-description"});let d=this.templateManager.getTemplateStats(r),h=u.createDiv("storyteller-template-details"),f=h.createEl("span",{cls:"storyteller-template-stat"});f.createEl("span",{text:"\u{1F4E6} "}),f.createEl("span",{text:`${d.totalEntities} entities`});let m=h.createEl("span",{cls:"storyteller-template-stat"});m.createEl("span",{text:"\u{1F517} "}),m.createEl("span",{text:`${d.totalRelationships} connections`});let g=Object.entries(d.entityCounts).filter(([v,E])=>E>0).sort((v,E)=>E[1]-v[1]).slice(0,3);if(g.length>0){let v=g.map(([C,_])=>`${_} ${this.pluralizeEntityType(C)}`).join(", "),E=h.createEl("div",{text:v,cls:"storyteller-template-breakdown"})}let y=n.createDiv("storyteller-template-actions");new Ba.ButtonComponent(y).setButtonText("Preview").onClick(()=>{this.previewTemplate(r)}),new Ba.ButtonComponent(y).setButtonText("Use Template").setCta().onClick(()=>{this.previewTemplate(r)}),n.onclick=v=>{v.target.tagName!=="BUTTON"&&this.previewTemplate(r)}}previewTemplate(e){this.close(),new EE(this.app,this.plugin,this.templateManager,e).open()}renderFooter(e){let r=e.createDiv("storyteller-template-footer");new Ba.ButtonComponent(r).setButtonText("Cancel").onClick(()=>{this.close()}),new Ba.ButtonComponent(r).setButtonText("Import Template").onClick(()=>{new Ba.Notice("Template import coming soon!")}),new Ba.ButtonComponent(r).setButtonText("Create Custom Template").setCta().onClick(()=>{this.close(),new Fs(this.app,this.plugin,null,async n=>{new Ba.Notice(`Template "${n.name}" created! You can now use it.`),new a(this.app,this.plugin,this.templateManager).open()}).open()})}getGenreIcon(e){return{fantasy:"\u{1F3F0}",scifi:"\u{1F680}",mystery:"\u{1F50D}",horror:"\u{1F47B}",romance:"\u{1F495}",historical:"\u{1F3DB}\uFE0F",western:"\u{1F920}",thriller:"\u{1F52A}",custom:"\u2728"}[e]||"\u{1F4DA}"}pluralizeEntityType(e){return{character:"characters",location:"locations",event:"events",item:"items",group:"groups",culture:"cultures",economy:"economies",magicSystem:"magic systems",chapter:"chapters",scene:"scenes",reference:"references"}[e]||e+"s"}onClose(){this.contentEl.empty()}};Ek();Tk();Ck();au();xm();window.L=lCe;var ga={stories:[],activeStoryId:"",galleryUploadFolder:"StorytellerSuite/GalleryUploads",galleryData:{images:[]},groups:[],showTutorial:!0,language:"en",enableCustomEntityFolders:!1,storyRootFolderTemplate:"",characterFolderPath:"",locationFolderPath:"",eventFolderPath:"",itemFolderPath:"",referenceFolderPath:"",chapterFolderPath:"",sceneFolderPath:"",mapFolderPath:"",enableOneStoryMode:!1,oneStoryBaseFolder:"StorytellerSuite",customTodayISO:void 0,defaultTimelineGroupMode:"none",defaultTimelineZoomPreset:"none",defaultTimelineStack:!0,defaultTimelineDensity:50,showTimelineLegend:!0,ganttShowProgressBars:!0,ganttDefaultDuration:1,ganttArrowStyle:"solid",allowRemoteImages:!0,sanitizedSeedData:!1,enableFrontmatterMarkers:!1,enableDataViewMarkers:!1,customFieldsMode:"flatten",relationshipsMigrated:!1,timelineForks:[],causalityLinks:[],timelineConflicts:[],timelineEras:[],timelineTracks:[],enableAdvancedTimeline:!1,autoDetectConflicts:!0,analyticsEnabled:!1,writingSessions:[],trackWritingSessions:!1,enableWorldBuilding:!0,enableSensoryProfiles:!0,hiddenDashboardTabs:[],templateStorageFolder:"StorytellerSuite/Templates",showBuiltInTemplates:!0,showCommunityTemplates:!1},HE=class extends ue.Plugin{constructor(){super(...arguments);this.folderResolver=null;this.orientationChangeHandler=null;this.resizeHandler=null}ensureActiveStoryOrGuide(){return this.getActiveStory()?!0:(new ue.Notice(w("selectOrCreateStoryFirst")),!1)}getFolderResolver(){let e={enableCustomEntityFolders:this.settings.enableCustomEntityFolders,storyRootFolderTemplate:this.settings.storyRootFolderTemplate,characterFolderPath:this.settings.characterFolderPath,locationFolderPath:this.settings.locationFolderPath,eventFolderPath:this.settings.eventFolderPath,itemFolderPath:this.settings.itemFolderPath,referenceFolderPath:this.settings.referenceFolderPath,chapterFolderPath:this.settings.chapterFolderPath,sceneFolderPath:this.settings.sceneFolderPath,mapFolderPath:this.settings.mapFolderPath,enableOneStoryMode:this.settings.enableOneStoryMode,oneStoryBaseFolder:this.settings.oneStoryBaseFolder};return new Yy(e,()=>this.getActiveStory())}normalizeEntityCustomFields(e,r){var f;if(!r)return r;let n=Vi(e),s=new Set([...n,"customFields","filePath","sections","id"]),o={character:["description","backstory"],location:["description","history"],event:["description","outcome"],item:["description","history"],reference:["content"],chapter:["summary"],scene:["content"]};for(let m of o[e]||[])s.add(m);let l=(f=this.settings.customFieldsMode)!=null?f:"flatten",c=r,u={...r.customFields||{}};for(let[m,g]of Object.entries(c))if(!s.has(m)){if(g==null){Object.keys(u).some(v=>v.toLowerCase()===m.toLowerCase())||(u[m]="",delete c[m]);continue}typeof g=="string"&&!g.includes(`
`)&&(Object.keys(u).some(v=>v.toLowerCase()===m.toLowerCase())||(u[m]=g,delete c[m]))}let d={},h=new Set;for(let[m,g]of Object.entries(u)){let y=m.toLowerCase();h.has(y)||(h.add(y),d[m]=g)}return r.customFields=d,r}resolveAllEntityFoldersOrExplain(){let r=this.getFolderResolver().resolveAll(),n=[];for(let[s,o]of Object.entries(r))o.error&&n.push(`${s}: ${o.error}`);if(n.length>0){let s=n.some(o=>o.includes("No active story"))?"Custom folders reference {story*}, but no active story is selected. Select or create an active story, then rescan.":`Could not resolve some folders:
${n.join(`
`)}`;return{ok:!1,results:r,message:s}}return{ok:!0,results:r}}sanitizeBaseFolderPath(e){if(!e)return"";let r=e.trim();if(r==="/"||r==="\\")return"";let n=r.replace(/^[\\/]+/,"").replace(/[\\/]+$/,"");return n?(0,ue.normalizePath)(n):""}getReferenceTodayDate(){let e=this.settings.customTodayISO;if(e){let r=new Date(e);if(isNaN(r.getTime()))console.warn(`Invalid custom today date: "${e}". Using system today.`);else return e.startsWith("-")&&r.getFullYear()>=0&&console.warn(`BCE date parsing issue: Input "${e}" parsed as CE year ${r.getFullYear()}`),r}return new Date}getActiveStory(){return this.settings.stories.find(e=>e.id===this.settings.activeStoryId)}getEntityFolder(e){return this.getFolderResolver().getEntityFolder(e)}async initializeOneStoryModeIfNeeded(){var e,r;if(this.settings.enableOneStoryMode){if(((r=(e=this.settings.stories)==null?void 0:e.length)!=null?r:0)===0){let n=await this.createStory("Single Story","Auto-created for One Story Mode");this.settings.activeStoryId=n.id,await this.saveSettings()}else if(!this.getActiveStory()){let n=this.settings.stories[0];n&&await this.setActiveStory(n.id)}try{await this.ensureFolder(this.getEntityFolder("character")),await this.ensureFolder(this.getEntityFolder("location")),await this.ensureFolder(this.getEntityFolder("event")),await this.ensureFolder(this.getEntityFolder("item")),await this.ensureFolder(this.getEntityFolder("reference")),await this.ensureFolder(this.getEntityFolder("chapter")),await this.ensureFolder(this.getEntityFolder("scene"))}catch(n){}this.refreshDashboardActiveTab()}}slugifyFolderName(e){return e?e.replace(/[\\/:"*?<>|#^[\]{}]+/g,"").trim().replace(/\s+/g," ").replace(/\s/g,"_"):""}async createStory(e,r){let n=Date.now().toString(36)+Math.random().toString(36).substr(2,6),s=new Date().toISOString(),o={id:n,name:e,created:s,description:r};return this.settings.stories.push(o),this.settings.activeStoryId=n,await this.saveSettings(),await this.ensureFolder(this.getEntityFolder("character")),await this.ensureFolder(this.getEntityFolder("location")),await this.ensureFolder(this.getEntityFolder("event")),await this.ensureFolder(this.getEntityFolder("item")),await this.ensureFolder(this.getEntityFolder("reference")),await this.ensureFolder(this.getEntityFolder("chapter")),await this.ensureFolder(this.getEntityFolder("scene")),o}async setActiveStory(e){if(this.settings.stories.find(r=>r.id===e))this.settings.activeStoryId=e,await this.saveSettings();else throw new Error("Story not found")}async updateStory(e,r,n){let s=this.settings.stories.find(l=>l.id===e);if(!s)throw new Error("Story not found");let o=s.name;if(o!==r){let l=`StorytellerSuite/Stories/${o}`,c=`StorytellerSuite/Stories/${r}`,u=this.app.vault.getAbstractFileByPath(l);if(u&&u instanceof ue.TFolder)try{await this.app.fileManager.renameFile(u,c)}catch(d){throw console.error(`Error renaming story folder from ${l} to ${c}:`,d),new Error(`Failed to rename story folder: ${d}`)}}s.name=r,s.description=n,await this.saveSettings()}async migrateRelationshipsToTyped(){console.log("Storyteller Suite: Starting relationships migration to typed format...");try{let e=await this.listCharacters(),r=0;for(let n of e){let s=!1;n.relationships&&Array.isArray(n.relationships)&&n.relationships.length>0&&n.relationships.some(l=>typeof l=="string")&&(n.connections||(n.connections=[]),n.relationships.forEach(l=>{var c,u,d,h;typeof l=="string"?(c=n.connections)!=null&&c.some(m=>m.target===l)||(u=n.connections)==null||u.push({target:l,type:"neutral",label:void 0}):(d=n.connections)!=null&&d.some(m=>m.target===l.target)||(h=n.connections)==null||h.push(l)}),s=!0),s&&(await this.saveCharacter(n),r++)}r>0?console.log(`Storyteller Suite: Migrated ${r} character(s) to typed relationships.`):console.log("Storyteller Suite: No migration needed for relationships.")}catch(e){console.error("Storyteller Suite: Error during relationships migration:",e)}}async onload(){await this.loadSettings(),Uy(this.settings.language),this.templateManager=new vE(this.app,this.settings.templateStorageFolder||"StorytellerSuite/Templates"),await this.templateManager.initialize(),this.templateNoteManager=new yE(this.app,this.templateManager,`${this.settings.templateStorageFolder||"StorytellerSuite/Templates"}/Notes`),await this.templateNoteManager.initialize(),this.templateManager.setTemplateNoteManager(this.templateNoteManager),this.registerEvent(this.app.vault.on("modify",async e=>{if(e instanceof ue.TFile&&e.extension==="md"){let r=`${this.settings.templateStorageFolder||"StorytellerSuite/Templates"}/Notes`;if(e.path.startsWith(r))try{await this.templateNoteManager.handleNoteChange(e)}catch(n){console.error("Error syncing template note:",n)}}})),this.trackManager=new If(this),this.eraManager=new tn(this),await this.trackManager.initializeDefaultTracks(),this.applyMobilePlatformClasses(),this.leafletProcessor=new gE(this),this.leafletProcessor.register(),this.registerView(zs,e=>new iE(e,this)),this.registerView(Qw,e=>new gv(e,this)),this.registerView(Af,e=>new vv(e,this)),this.registerView(yv,e=>new sE(e,this)),this.addRibbonIcon("book-open","Open storyteller dashboard",()=>{this.activateView()}).addClass("storyteller-suite-ribbon-class"),this.addRibbonIcon("layers","Apply template to story",async()=>{let{TemplateLibraryModal:e}=await Promise.resolve().then(()=>(_E(),CE));new e(this.app,this).open()}).addClass("storyteller-suite-template-ribbon"),this.registerCommands(),this.addSettingTab(new cE(this.app,this)),this.app.workspace.onLayoutReady(async()=>{await this.discoverExistingStories(),await this.initializeOneStoryModeIfNeeded(),this.settings.relationshipsMigrated||(await this.migrateRelationshipsToTyped(),this.settings.relationshipsMigrated=!0,await this.saveSettings()),this.setupMobileOrientationHandlers()})}async performStoryDiscovery(e={}){var l,c;let{isInitialDiscovery:r=!1,logPrefix:n="Storyteller Suite"}=e,s="StorytellerSuite/Stories",o=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(s));if(o instanceof ue.TFolder){let u=[],d=o.children.filter(h=>h instanceof ue.TFolder);for(let h of d){let f=h.name;if(!this.settings.stories.some(m=>m.name===f)){let m=Date.now().toString(36)+Math.random().toString(36).substr(2,6),g=new Date().toISOString(),y={id:m,name:f,created:g,description:"Discovered from filesystem"};u.push(y)}}return u.length>0&&(this.settings.stories.push(...u),r&&!this.settings.activeStoryId&&this.settings.stories.length>0&&(this.settings.activeStoryId=this.settings.stories[0].id),await this.saveSettings()),{newStories:u,totalStories:this.settings.stories.length}}else if(o===null){let u=`Stories folder does not exist at ${s}`}else{let u=`Path exists but is not a folder: ${s}`;return{newStories:[],totalStories:this.settings.stories.length,error:u}}try{if(this.settings.enableCustomEntityFolders&&this.settings.storyRootFolderTemplate){let u=this.settings.storyRootFolderTemplate;if(u.includes("{storyName}")||u.includes("{storySlug}")||u.includes("{storyId}")){let h=Math.min(...["{storyName}","{storySlug}","{storyId}"].map(v=>{let E=u.indexOf(v);return E===-1?Number.POSITIVE_INFINITY:E})),f=h===Number.POSITIVE_INFINITY?u:u.slice(0,h),m=f.endsWith("/")?f.slice(0,-1):f,g=(m.includes("/"),m),y=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(g));if(y instanceof ue.TFolder){let v=y.children.filter(C=>C instanceof ue.TFolder),E=[];for(let C of v)if(!this.settings.stories.some(_=>_.name===C.name)){let x={id:Date.now().toString(36)+Math.random().toString(36).substr(2,6),name:C.name,created:new Date().toISOString()};this.settings.stories.push(x),E.push(x)}if(E.length>0)return r&&!this.settings.activeStoryId&&(this.settings.activeStoryId=this.settings.stories[0].id),await this.saveSettings(),{newStories:E,totalStories:this.settings.stories.length}}}}}catch(u){console.warn("Storyteller Suite: Custom-folder discovery failed",u)}try{if(this.settings.enableOneStoryMode){let u=this.sanitizeBaseFolderPath(this.settings.oneStoryBaseFolder||"StorytellerSuite");if(((c=(l=this.settings.stories)==null?void 0:l.length)!=null?c:0)===0){let d=Date.now().toString(36)+Math.random().toString(36).substr(2,6),h={id:d,name:"Single Story",created:new Date().toISOString()};this.settings.stories.push(h),this.settings.activeStoryId=d,await this.saveSettings();try{await this.ensureFolder(this.getEntityFolder("character")),await this.ensureFolder(this.getEntityFolder("location")),await this.ensureFolder(this.getEntityFolder("event")),await this.ensureFolder(this.getEntityFolder("item")),await this.ensureFolder(this.getEntityFolder("reference")),await this.ensureFolder(this.getEntityFolder("chapter")),await this.ensureFolder(this.getEntityFolder("scene"))}catch(f){}return{newStories:[h],totalStories:this.settings.stories.length}}}}catch(u){console.warn("Storyteller Suite: One-story discovery failed",u)}return{newStories:[],totalStories:this.settings.stories.length}}async discoverExistingStories(){try{let e=await this.performStoryDiscovery({isInitialDiscovery:!0,logPrefix:"Storyteller Suite"});e.newStories.length>0&&new ue.Notice(`Storyteller: Auto-detected and imported ${e.newStories.length} new story folder(s).`)}catch(e){console.error("Storyteller Suite: Error during story discovery:",e),new ue.Notice(`Storyteller Suite: Error discovering stories: ${e.message}`)}}async refreshStoryDiscovery(){try{let e=await this.performStoryDiscovery({isInitialDiscovery:!1,logPrefix:"Storyteller Suite"});e.error?new ue.Notice(`Storyteller: ${e.error}`):e.newStories.length>0?new ue.Notice(`Storyteller: Found and imported ${e.newStories.length} new story folder(s).`):new ue.Notice("Storyteller: No new story folders found.")}catch(e){console.error("Storyteller Suite: Error during story refresh:",e),new ue.Notice(`Storyteller Suite: Error refreshing stories: ${e.message}`)}}async refreshCustomFolderDiscovery(){if(this.settings.enableCustomEntityFolders)try{let e=this.resolveAllEntityFoldersOrExplain();if(!e.ok){new ue.Notice(e.message||"Unable to resolve custom folders. Select or create an active story and try again.");return}for(let o of Object.values(e.results)){let l=o.path;l&&await this.ensureFolder(l)}let r=o=>{if(!o)return 0;let l=this.app.vault.getMarkdownFiles(),c=(0,ue.normalizePath)(o)+"/";return l.filter(u=>u.path.startsWith(c)).length},n=e.results,s={characters:r(n.character.path),locations:r(n.location.path),events:r(n.event.path),items:r(n.item.path),references:r(n.reference.path),chapters:r(n.chapter.path),scenes:r(n.scene.path)};this.app.metadataCache.trigger("dataview:refresh-views"),this.refreshDashboardActiveTab(),new ue.Notice(`Storyteller: Custom folders scanned. Chars ${s.characters}, Locs ${s.locations}, Events ${s.events}, Items ${s.items}, Refs ${s.references}, Chaps ${s.chapters}, Scenes ${s.scenes}.`)}catch(e){console.error("Storyteller Suite: Error during custom folder refresh:",e),new ue.Notice(`Storyteller Suite: Error scanning custom folders: ${e.message}`)}}async autoDetectCustomEntityFolders(){var u,d,h,f,m,g,y,v;let e=this.app.vault.getAllLoadedFiles(),r=new Map;for(let E of e)if(E instanceof ue.TFolder){let C=E.parent;if(C){let _=(u=r.get(C.path))!=null?u:new Set;_.add(E.name),r.set(C.path,_)}}let n=["Characters","Locations","Events","Items","References","Chapters","Scenes"],s=null,o=0;for(let[E,C]of r.entries()){let _=0;for(let x of n)C.has(x)&&_++;_>o&&(o=_,s=E)}if(!s||o===0){new ue.Notice("Storyteller: Could not auto-detect a story root. Please set folders manually.");return}let l=E=>this.app.vault.getFolderByPath(`${s}/${E}`)?`${s}/${E}`:void 0,c={};c.characterFolderPath=(d=l("Characters"))!=null?d:this.settings.characterFolderPath,c.locationFolderPath=(h=l("Locations"))!=null?h:this.settings.locationFolderPath,c.eventFolderPath=(f=l("Events"))!=null?f:this.settings.eventFolderPath,c.itemFolderPath=(m=l("Items"))!=null?m:this.settings.itemFolderPath,c.referenceFolderPath=(g=l("References"))!=null?g:this.settings.referenceFolderPath,c.chapterFolderPath=(y=l("Chapters"))!=null?y:this.settings.chapterFolderPath,c.sceneFolderPath=(v=l("Scenes"))!=null?v:this.settings.sceneFolderPath,this.settings={...this.settings,...c},await this.saveSettings(),new ue.Notice(`Storyteller: Auto-detected custom folders under "${s}" (matches: ${o}).`)}refreshDashboardActiveTab(){var e;try{let n=(e=this.app.workspace.getLeavesOfType(zs)[0])==null?void 0:e.view;n&&typeof n.refreshActiveTab=="function"&&n.refreshActiveTab()}catch(r){}}onunload(){try{this.removeMobilePlatformClasses()}catch(e){console.error("Storyteller Suite: Error removing mobile classes during unload",e)}try{this.cleanupMobileOrientationHandlers()}catch(e){console.error("Storyteller Suite: Error cleaning up orientation handlers",e)}try{this.leafletProcessor&&this.leafletProcessor.cleanup()}catch(e){console.error("Storyteller Suite: Error cleaning up Leaflet maps",e)}}registerCommands(){this.addCommand({id:"open-dashboard-view",name:"Open dashboard",callback:()=>{this.activateView()}}),this.addCommand({id:"create-new-story",name:"Create new story",callback:()=>{new sc(this.app,this,this.settings.stories.map(e=>e.name),async(e,r)=>{let n=await this.createStory(e,r);await this.setActiveStory(n.id),new ue.Notice(`Story "${e}" created and activated.`),this.activateView()}).open()}}),this.addCommand({id:"refresh-story-discovery",name:"Refresh story discovery",callback:async()=>{await this.refreshStoryDiscovery()}}),this.addCommand({id:"open-template-gallery",name:"Browse story templates",callback:()=>{new TE(this.app,this,this.templateManager).open()}}),this.addCommand({id:"open-template-library",name:"Apply template to story",callback:async()=>{let{TemplateLibraryModal:e}=await Promise.resolve().then(()=>(_E(),CE));new e(this.app,this).open()}}),this.addCommand({id:"create-new-character",name:"Create new character",callback:()=>{this.ensureActiveStoryOrGuide()&&new Ts(this.app,this,null,async e=>{await this.saveCharacter(e),new ue.Notice(`Character "${e.name}" created.`)}).open()}}),this.addCommand({id:"view-characters",name:"View characters",callback:async()=>{let e=await this.listCharacters();new Jy(this.app,this,e).open()}}),this.addCommand({id:"create-new-location",name:"Create new location",callback:()=>{this.ensureActiveStoryOrGuide()&&new Cs(this.app,this,null,async e=>{await this.saveLocation(e),new ue.Notice(`Location "${e.name}" created.`)}).open()}}),this.addCommand({id:"view-locations",name:"View locations",callback:async()=>{let e=await this.listLocations();new Qy(this.app,this,e).open()}}),this.addCommand({id:"create-new-event",name:"Create new event",callback:()=>{this.ensureActiveStoryOrGuide()&&new ts(this.app,this,null,async e=>{await this.saveEvent(e),new ue.Notice(`Event "${e.name}" created.`)}).open()}}),this.addCommand({id:"view-timeline",name:w("viewTimeline"),callback:async()=>{let e=await this.listEvents();new Mg(this.app,this,e).open()}}),this.addCommand({id:"open-timeline-panel",name:w("openTimelinePanel"),callback:async()=>{await this.activateTimelineView()}}),this.addCommand({id:"manage-timeline-eras",name:"Manage timeline eras & periods",callback:async()=>{let{EraListModal:e}=await Promise.resolve().then(()=>(F0(),O0));new e(this.app,this).open()}}),this.addCommand({id:"manage-timeline-tracks",name:"Manage timeline tracks",callback:()=>{let e=this.settings.timelineTracks||[];new Jh(this.app,this,e,async r=>{this.settings.timelineTracks=r,await this.saveSettings()}).open()}}),this.addCommand({id:"detect-timeline-conflicts",name:"Detect timeline conflicts",callback:async()=>{let e=await this.listEvents(),r=Vr.detectAllConflicts(e);new Qh(this.app,this,r).open();let n=r.filter(o=>o.severity==="error").length,s=r.filter(o=>o.severity==="warning").length;r.length===0?new ue.Notice("\u2713 No timeline conflicts detected"):new ue.Notice(`Found ${n} error(s), ${s} warning(s)`)}}),this.addCommand({id:"generate-events-from-tags",name:"Generate timeline from tags",callback:()=>{new tf(this.app,this).open()}}),this.addCommand({id:"auto-generate-tracks",name:"Auto-generate timeline tracks",callback:async()=>{let e=await this.trackManager.generateEntityTracks({characters:!0,locations:!0,groups:!0,hideByDefault:!1});new ue.Notice(`Generated ${e} timeline track(s)`)}}),this.addCommand({id:"open-analytics-dashboard",name:"Open writing analytics",callback:async()=>{await this.activateAnalyticsView()}}),this.addCommand({id:"create-new-plot-item",name:"Create new plot item",callback:()=>{this.ensureActiveStoryOrGuide()&&new Os(this.app,this,null,async e=>{await this.savePlotItem(e),new ue.Notice(`Item "${e.name}" created.`)}).open()}}),this.addCommand({id:"view-plot-items",name:"View plot items",callback:async()=>{let e=await this.listPlotItems();new uE(this.app,this,e).open()}}),this.addCommand({id:"create-new-culture",name:"Create new culture",callback:()=>{this.ensureActiveStoryOrGuide()&&new kc(this.app,this,null,async e=>{await this.saveCulture(e),new ue.Notice(`Culture "${e.name}" created.`)}).open()}}),this.addCommand({id:"view-cultures",name:"View cultures",callback:async()=>{let e=await this.listCultures();new dE(this.app,this,e).open()}}),this.addCommand({id:"create-new-economy",name:"Create new economy",callback:()=>{this.ensureActiveStoryOrGuide()&&new Dc(this.app,this,null,async e=>{await this.saveEconomy(e),new ue.Notice(`Economy "${e.name}" created.`)}).open()}}),this.addCommand({id:"view-economies",name:"View economies",callback:async()=>{let e=await this.listEconomies();new hE(this.app,this,e).open()}}),this.addCommand({id:"create-new-magic-system",name:"Create new magic system",callback:()=>{this.ensureActiveStoryOrGuide()&&new Pc(this.app,this,null,async e=>{await this.saveMagicSystem(e),new ue.Notice(`Magic System "${e.name}" created.`)}).open()}}),this.addCommand({id:"view-magic-systems",name:"View magic systems",callback:async()=>{let e=await this.listMagicSystems();new fE(this.app,this,e).open()}}),this.addCommand({id:"open-gallery",name:"Open gallery",callback:()=>{new R0(this.app,this).open()}}),this.addCommand({id:"create-new-reference",name:"Create new reference",callback:()=>{this.ensureActiveStoryOrGuide()&&Promise.resolve().then(()=>(jw(),Uw)).then(({ReferenceModal:e})=>{new e(this.app,this,null,async r=>{await this.saveReference(r),new ue.Notice(`Reference "${r.name}" created.`)}).open()})}}),this.addCommand({id:"view-references",name:"View references",callback:async()=>{await this.activateView(),setTimeout(()=>{var n,s;let r=(n=this.app.workspace.getLeavesOfType(zs)[0])==null?void 0:n.view;if(r&&typeof r=="object"&&"tabHeaderContainer"in r){let o=(s=r.tabHeaderContainer)==null?void 0:s.querySelector('[data-tab-id="references"]');o==null||o.click()}},50)}}),this.addCommand({id:"create-new-chapter",name:"Create new chapter",callback:()=>{this.ensureActiveStoryOrGuide()&&Promise.resolve().then(()=>(Kw(),Zw)).then(({ChapterModal:e})=>{new e(this.app,this,null,async r=>{await this.saveChapter(r),new ue.Notice(`Chapter "${r.name}" created.`)}).open()})}}),this.addCommand({id:"view-chapters",name:"View chapters",callback:async()=>{await this.activateView(),setTimeout(()=>{var n,s;let r=(n=this.app.workspace.getLeavesOfType(zs)[0])==null?void 0:n.view;if(r&&typeof r=="object"&&"tabHeaderContainer"in r){let o=(s=r.tabHeaderContainer)==null?void 0:s.querySelector('[data-tab-id="chapters"]');o==null||o.click()}},50)}}),this.addCommand({id:"import-story",name:"Import story/chapters",callback:()=>{Promise.resolve().then(()=>(Q4(),J4)).then(({ImportConfigModal:e})=>{new e(this.app,this).open()})}}),this.addCommand({id:"create-new-scene",name:"Create new scene",callback:()=>{this.ensureActiveStoryOrGuide()&&Promise.resolve().then(()=>(Jw(),Xw)).then(({SceneModal:e})=>{new e(this.app,this,null,async r=>{await this.saveScene(r),new ue.Notice(`Scene "${r.name}" created.`)}).open()})}}),this.addCommand({id:"view-scenes",name:"View scenes",callback:async()=>{await this.activateView(),setTimeout(()=>{var n,s;let r=(n=this.app.workspace.getLeavesOfType(zs)[0])==null?void 0:n.view;if(r&&typeof r=="object"&&"tabHeaderContainer"in r){let o=(s=r.tabHeaderContainer)==null?void 0:s.querySelector('[data-tab-id="scenes"]');o==null||o.click()}},50)}}),this.addCommand({id:"create-group",name:"Create group",callback:async()=>{if(!this.ensureActiveStoryOrGuide())return;let e=prompt("Enter group name:");if(e&&e.trim()){let r=e.trim();await this.createGroup(r),new ue.Notice(`Group "${r}" created.`)}}}),this.addCommand({id:"view-groups",name:"View groups",callback:async()=>{await this.activateView(),setTimeout(()=>{var n,s;let r=(n=this.app.workspace.getLeavesOfType(zs)[0])==null?void 0:n.view;if(r&&typeof r=="object"&&"tabHeaderContainer"in r){let o=(s=r.tabHeaderContainer)==null?void 0:s.querySelector('[data-tab-id="groups"]');o==null||o.click()}},50)}}),this.addCommand({id:"rename-group",name:"Rename group",callback:async()=>{if(this.getGroups().length===0){new ue.Notice("No groups to rename.");return}new sl(this.app,this,r=>{r&&new Qr(this.app,{title:"New name",label:"Enter new group name",defaultValue:r.name,validator:n=>n.trim()?null:"Required",onSubmit:async n=>{await this.updateGroup(r.id,{name:n.trim()}),new ue.Notice(`Group renamed to "${n.trim()}".`)}}).open()}).open()}}),this.addCommand({id:"delete-group",name:"Delete group",callback:async()=>{if(this.getGroups().length===0){new ue.Notice("No groups to delete.");return}new sl(this.app,this,r=>{r&&new Em(this.app,{title:"Confirm delete",body:`Are you sure you want to delete group "${r.name}"?`,onConfirm:async()=>{await this.deleteGroup(r.id),new ue.Notice(`Group "${r.name}" deleted.`)}}).open()}).open()}}),this.addCommand({id:"create-story-board",name:"Create Story Board",callback:async()=>{await this.createStoryBoard()}}),this.addCommand({id:"update-story-board",name:"Update Story Board",callback:async()=>{await this.updateStoryBoard()}}),this.addCommand({id:"open-story-board",name:"Open Story Board",callback:async()=>{await this.openStoryBoard()}}),this.addCommand({id:"create-new-culture",name:"Create new culture",callback:()=>{this.ensureActiveStoryOrGuide()&&Promise.resolve().then(()=>(Pf(),eE)).then(({CultureModal:e})=>{new e(this.app,this,null,async r=>{await this.saveCulture(r),new ue.Notice(`Culture "${r.name}" created.`)}).open()})}}),this.addCommand({id:"view-cultures",name:"View cultures",callback:async()=>{let e=await this.listCultures();new ue.Notice(`${e.length} culture(s) found`)}}),this.addCommand({id:"create-new-economy",name:"Create new economy",callback:()=>{this.ensureActiveStoryOrGuide()&&Promise.resolve().then(()=>(Lf(),tE)).then(({EconomyModal:e})=>{new e(this.app,this,null,async r=>{await this.saveEconomy(r),new ue.Notice(`Economy "${r.name}" created.`)}).open()})}}),this.addCommand({id:"view-economies",name:"View economies",callback:async()=>{let e=await this.listEconomies();new ue.Notice(`${e.length} economy/economies found`)}}),this.addCommand({id:"create-new-magic-system",name:"Create new magic system",callback:()=>{this.ensureActiveStoryOrGuide()&&Promise.resolve().then(()=>(Mf(),rE)).then(({MagicSystemModal:e})=>{new e(this.app,this,null,async r=>{await this.saveMagicSystem(r),new ue.Notice(`Magic System "${r.name}" created.`)}).open()})}}),this.addCommand({id:"view-magic-systems",name:"View magic systems",callback:async()=>{let e=await this.listMagicSystems();new ue.Notice(`${e.length} magic system(s) found`)}}),this.addCommand({id:"create-timeline-fork",name:"Create timeline fork",callback:()=>{this.ensureActiveStoryOrGuide()&&Promise.resolve().then(()=>(tW(),eW)).then(({TimelineForkModal:e})=>{new e(this.app,this,null,async r=>{this.createTimelineFork(r.name,r.divergenceEvent,r.divergenceDate,r.description||"")}).open()})}}),this.addCommand({id:"view-timeline-forks",name:"View timeline forks",callback:()=>{let e=this.getTimelineForks();if(e.length===0){new ue.Notice("No timeline forks yet. Create your first fork!");return}new ue.Notice(`${e.length} timeline fork(s) found`)}}),this.addCommand({id:"detect-timeline-conflicts",name:"Detect timeline conflicts",callback:async()=>{new ue.Notice("Scanning timeline for conflicts...");let e=await this.listEvents(),r=Vr.detectAllConflicts(e),n=Vr.toStorageFormat(r);this.settings.timelineConflicts=n,await this.saveSettings(),new ue.Notice(`Found ${n.length} timeline conflict(s)`);let{ConflictListModal:s}=await Promise.resolve().then(()=>(aE(),nE));new s(this.app,this,n,async()=>{new ue.Notice("Re-scanning timeline for conflicts...");let o=await this.listEvents(),l=Vr.detectAllConflicts(o),c=Vr.toStorageFormat(l);this.settings.timelineConflicts=c,await this.saveSettings(),new ue.Notice(`Found ${c.length} timeline conflict(s)`)}).open()}}),this.addCommand({id:"view-timeline-conflicts",name:"View timeline conflicts",callback:async()=>{let e=this.settings.timelineConflicts||[];if(e.length===0){new ue.Notice('No conflicts detected. Run "Detect timeline conflicts" to scan.');return}let{ConflictListModal:r}=await Promise.resolve().then(()=>(aE(),nE));new r(this.app,this,e,async()=>{new ue.Notice("Re-scanning timeline for conflicts...");let n=await this.listEvents(),s=Vr.detectAllConflicts(n),o=Vr.toStorageFormat(s);this.settings.timelineConflicts=o,await this.saveSettings(),new ue.Notice(`Found ${o.length} timeline conflict(s)`)}).open()}}),this.addCommand({id:"open-entity-template-library",name:"Open entity template library",callback:()=>{let{TemplateLibraryModal:e}=(_E(),Do(CE));new e(this.app,this).open()}}),this.addCommand({id:"save-note-as-template",name:"Save current note as template",callback:()=>{wE.execute(this)}})}async activateView(){let{workspace:e}=this.app,r=null,n=e.getLeavesOfType(zs);if(n.length>0)r=n[0];else if(r=e.getRightLeaf(!1),r)await r.setViewState({type:zs,active:!0});else{console.error("Storyteller Suite: Could not create workspace leaf."),new ue.Notice("Error opening dashboard: Could not create workspace leaf.");return}if(!r){console.error("Storyteller Suite: Workspace leaf is null after attempting to find or create it."),new ue.Notice("Error revealing dashboard: Workspace leaf not found.");return}e.revealLeaf(r)}async activateTimelineView(){let{workspace:e}=this.app,r=e.getLeavesOfType(Af);if(r.length>0){e.revealLeaf(r[0]);return}let n=e.getLeaf("tab");n?(await n.setViewState({type:Af,active:!0}),e.revealLeaf(n)):(console.error("Storyteller Suite: Could not create workspace leaf for timeline."),new ue.Notice("Error opening timeline panel: Could not create workspace leaf."))}async activateAnalyticsView(){let{workspace:e}=this.app,r=e.getLeavesOfType(yv);if(r.length>0){e.revealLeaf(r[0]);return}let n=e.getLeaf("tab");n?(await n.setViewState({type:yv,active:!0}),e.revealLeaf(n)):(console.error("Storyteller Suite: Could not create workspace leaf for analytics."),new ue.Notice("Error opening analytics dashboard: Could not create workspace leaf."))}async openMapEditor(e){console.warn("DEPRECATED: Map functionality has been deprecated"),new ue.Notice("Map functionality has been deprecated")}async ensureFolder(e){let n=(0,ue.normalizePath)(e).split("/").filter(Boolean),s="";for(let o of n){s=s?`${s}/${o}`:o;let l=this.app.vault.getAbstractFileByPath(s);if(l){if(!(l instanceof ue.TFolder)){let c=`Error: Path ${s} exists but is not a folder. Check Storyteller Suite settings.`;throw new ue.Notice(c),console.error(c),new Error(c)}}else try{await this.app.vault.createFolder(s)}catch(c){if(this.app.vault.getAbstractFileByPath(s)instanceof ue.TFolder)continue;throw c}}}async parseFile(e,r,n){try{let s=await this.app.vault.cachedRead(e),o=(await Promise.resolve().then(()=>(oi(),Xa))).parseSectionsFromMarkdown(s),l=this.app.metadataCache.getFileCache(e),c=l==null?void 0:l.frontmatter,{parseFrontmatterFromContent:u}=await Promise.resolve().then(()=>(oi(),Xa)),d=u(s),h={...c||{},...d||{}},f={...r,...h,filePath:e.path};if("Description"in o&&(f.description=o.Description),"Backstory"in o&&(f.backstory=o.Backstory),"History"in o&&(f.history=o.History),"Outcome"in o&&(f.outcome=o.Outcome),n==="reference")"Content"in o&&(f.content=o.Content);else if(n==="chapter")"Summary"in o&&(f.summary=o.Summary);else if(n==="scene"){if("Content"in o&&(f.content=o.Content),o["Beat Sheet"]){let g=o["Beat Sheet"].split(`
`).map(y=>y.replace(/^\-\s*/,"").trim()).filter(Boolean);g.length>0&&(f.beats=g)}}else if(n==="item")!f.history&&o["History / Lore"]&&(f.history=o["History / Lore"]);else if(n==="event"&&o["Characters Involved"]){let g=o["Characters Involved"].split(`
`).map(y=>y.trim()).filter(y=>y.startsWith("- [[")&&y.endsWith("]]")).map(y=>y.replace(/^\- \[\[(.*?)\]\]$/,"$1"));g.length>0&&(f.characters=g)}if(o.Relationships){let g=o.Relationships.split(`
`).map(y=>y.trim()).filter(y=>y.startsWith("- [[")&&y.endsWith("]]")).map(y=>y.replace(/^- \[\[(.*?)\]\]$/,"$1"));f.relationships=g}if(o.Locations){let g=o.Locations.split(`
`).map(y=>y.trim()).filter(y=>y.startsWith("- [[")&&y.endsWith("]]")).map(y=>y.replace(/^- \[\[(.*?)\]\]$/,"$1"));f.locations=g}if(o.Events){let g=o.Events.split(`
`).map(y=>y.trim()).filter(y=>y.startsWith("- [[")&&y.endsWith("]]")).map(y=>y.replace(/^- \[\[(.*?)\]\]$/,"$1"));f.events=g}return f.sections&&delete f.sections,f.name?f:(console.warn(`File ${e.path} is missing a name in frontmatter.`),null)}catch(s){return console.error(`Error parsing file ${e.path}:`,s),new ue.Notice(`Error parsing file: ${e.name}`),null}}async ensureCharacterFolder(){await this.ensureFolder(this.getEntityFolder("character"))}buildFrontmatterForCharacter(e,r){var o;let n=new Set(Object.keys(e||{})),s=(o=this.settings.customFieldsMode)!=null?o:"flatten";return Ka("character",e,n,{customFieldsMode:s,originalFrontmatter:r})}buildFrontmatterForLocation(e,r){var o;let n=new Set(Object.keys(e||{})),s=(o=this.settings.customFieldsMode)!=null?o:"flatten";return Ka("location",e,n,{customFieldsMode:s,originalFrontmatter:r})}buildFrontmatterForEvent(e,r){var o;let n=new Set(Object.keys(e||{})),s=(o=this.settings.customFieldsMode)!=null?o:"flatten";return Ka("event",e,n,{customFieldsMode:s,originalFrontmatter:r})}buildFrontmatterForItem(e,r){var o;let n=new Set(Object.keys(e||{})),s=(o=this.settings.customFieldsMode)!=null?o:"flatten";return Ka("item",e,n,{customFieldsMode:s,originalFrontmatter:r})}buildFrontmatterForCulture(e,r){var o;let n=new Set(Object.keys(e||{})),s=(o=this.settings.customFieldsMode)!=null?o:"flatten";return Ka("culture",e,n,{customFieldsMode:s,originalFrontmatter:r})}buildFrontmatterForEconomy(e,r){var o;let n=new Set(Object.keys(e||{})),s=(o=this.settings.customFieldsMode)!=null?o:"flatten";return Ka("economy",e,n,{customFieldsMode:s,originalFrontmatter:r})}buildFrontmatterForMagicSystem(e,r){var o;let n=new Set(Object.keys(e||{})),s=(o=this.settings.customFieldsMode)!=null?o:"flatten";return Ka("magicSystem",e,n,{customFieldsMode:s,originalFrontmatter:r})}async saveCharacter(e){await this.ensureCharacterFolder();let r=this.getEntityFolder("character");e.id||(e.id=Date.now().toString(36)+Math.random().toString(36).substr(2,6));let n=`${e.name.replace(/[\\/:"*?<>|]+/g,"")}.md`,s=(0,ue.normalizePath)(`${r}/${n}`),{filePath:o,backstory:l,description:c,...u}=e;u.sections&&delete u.sections;let d=s;if(o&&o!==s){let P=this.app.vault.getAbstractFileByPath(o);P&&P instanceof ue.TFile&&(await this.app.fileManager.renameFile(P,s),d=s)}let h=this.app.vault.getAbstractFileByPath(d),f={},m;if(h&&h instanceof ue.TFile)try{let P=await this.app.vault.cachedRead(h);f=Qn(P);let{parseFrontmatterFromContent:I}=await Promise.resolve().then(()=>(oi(),Xa)),M=I(P),O=this.app.metadataCache.getFileCache(h),R=O==null?void 0:O.frontmatter;(M||R)&&(m={...R||{},...M||{}})}catch(P){console.warn(`Error reading existing character file: ${P}`)}let g=this.buildFrontmatterForCharacter(u,m);if(m){let P=Ja(g,m);P.lostFields.length>0&&console.warn("[saveCharacter] Warning: Fields will be lost on save:",P.lostFields)}let y=Object.keys(g).length>0?Es(g,m,`Character: ${e.name}`):"",v={Description:c!==void 0?c:"",Backstory:l!==void 0?l:""},E=e._templateSections||{},C=Gs("character",v),_;h&&h instanceof ue.TFile?(_={...C,...E,...f},Object.entries(v).forEach(([P,I])=>{_[P]=I})):_={...C,...E,...v};let x=`---
${y}---

`;x+=Object.entries(_).map(([P,I])=>`## ${P}
${I||""}`).join(`

`),x.endsWith(`
`)||(x+=`
`),h&&h instanceof ue.TFile?await this.app.vault.modify(h,x):(await this.app.vault.create(d,x),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=d,this.app.metadataCache.trigger("dataview:refresh-views")}async listCharacters(){await this.ensureCharacterFolder();let e=this.getEntityFolder("character"),r=this.app.vault.getMarkdownFiles(),n=(0,ue.normalizePath)(e)+"/",s=r.filter(l=>l.path.startsWith(n)&&l.extension==="md"),o=[];for(let l of s){let c=await this.parseFile(l,{name:""},"character");c&&(c=this.normalizeEntityCustomFields("character",c));let u=c;u&&o.push(u)}return o.sort((l,c)=>l.name.localeCompare(c.name))}async deleteCharacter(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Character file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find character file to delete at ${e}`)}async ensureLocationFolder(){await this.ensureFolder(this.getEntityFolder("location"))}async saveLocation(e){await this.ensureLocationFolder();let r=this.getEntityFolder("location");e.id||(e.id=Date.now().toString(36)+Math.random().toString(36).substr(2,6));let n=`${e.name.replace(/[\\/:"*?<>|]+/g,"")}.md`,s=(0,ue.normalizePath)(`${r}/${n}`),{filePath:o,history:l,description:c,...u}=e;u.sections&&delete u.sections;let d=s;if(o&&o!==s){let P=this.app.vault.getAbstractFileByPath(o);P&&P instanceof ue.TFile&&(await this.app.fileManager.renameFile(P,s),d=s)}let h=this.app.vault.getAbstractFileByPath(d),f={},m;if(h&&h instanceof ue.TFile)try{let P=await this.app.vault.cachedRead(h);f=Qn(P);let{parseFrontmatterFromContent:I}=await Promise.resolve().then(()=>(oi(),Xa)),M=I(P),O=this.app.metadataCache.getFileCache(h),R=O==null?void 0:O.frontmatter;(M||R)&&(m={...R||{},...M||{}})}catch(P){console.warn(`Error reading existing location file: ${P}`)}let g=this.buildFrontmatterForLocation(u,m);if(m){let P=Ja(g,m);P.lostFields.length>0&&console.warn("[saveLocation] Warning: Fields will be lost on save:",P.lostFields)}let y=Object.keys(g).length>0?Es(g,m,`Location: ${e.name}`):"",v={Description:c||"",History:l||""},E=e._templateSections||{},C=Gs("location",v),_=h&&h instanceof ue.TFile?{...C,...E,...f,...v}:{...C,...E,...v},x=`---
${y}---

`;x+=Object.entries(_).map(([P,I])=>`## ${P}
${I||""}`).join(`

`),x.endsWith(`
`)||(x+=`
`),h&&h instanceof ue.TFile?await this.app.vault.modify(h,x):(await this.app.vault.create(d,x),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=d,this.app.metadataCache.trigger("dataview:refresh-views")}async listLocations(){await this.ensureLocationFolder();let e=this.getEntityFolder("location"),r=this.app.vault.getMarkdownFiles(),n=(0,ue.normalizePath)(e)+"/",s=r.filter(l=>l.path.startsWith(n)&&l.extension==="md"),o=[];for(let l of s){let c=await this.parseFile(l,{name:""},"location");c&&(c=this.normalizeEntityCustomFields("location",c)),c&&o.push(c)}return o.sort((l,c)=>l.name.localeCompare(c.name))}async deleteLocation(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Location file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find location file to delete at ${e}`)}async saveSensoryProfile(e){this.settings.sensoryProfiles||(this.settings.sensoryProfiles=[]);let r=this.settings.sensoryProfiles.findIndex(n=>n.locationId===e.locationId);r>=0?this.settings.sensoryProfiles[r]=e:this.settings.sensoryProfiles.push(e),await this.saveSettings(),new ue.Notice(`Sensory profile for ${e.locationName} saved.`)}getSensoryProfile(e){return this.settings.sensoryProfiles&&this.settings.sensoryProfiles.find(r=>r.locationId===e)||null}async deleteSensoryProfile(e){this.settings.sensoryProfiles&&(this.settings.sensoryProfiles=this.settings.sensoryProfiles.filter(r=>r.locationId!==e),await this.saveSettings(),new ue.Notice("Sensory profile deleted."))}async ensureMapFolder(){console.warn("DEPRECATED: Map functionality has been deprecated")}buildFrontmatterForMap(e,r){return console.warn("DEPRECATED: Map functionality has been deprecated"),{}}async saveMap(e){console.warn("DEPRECATED: Map functionality has been deprecated"),new ue.Notice("Map functionality has been deprecated")}async listMaps(){return console.warn("DEPRECATED: Map functionality has been deprecated"),[]}async getMap(e){return console.warn("DEPRECATED: Map functionality has been deprecated"),null}async deleteMap(e){console.warn("DEPRECATED: Map functionality has been deprecated"),new ue.Notice("Map functionality has been deprecated")}async linkLocationToMap(e,r){console.warn("DEPRECATED: Map functionality has been deprecated")}async unlinkLocationFromMap(e,r){console.warn("DEPRECATED: Map functionality has been deprecated")}async ensureEventFolder(){await this.ensureFolder(this.getEntityFolder("event"))}async saveEvent(e){var M;await this.ensureEventFolder();let r=this.getEntityFolder("event"),s=`${((M=e.name)==null?void 0:M.replace(/[\\/:"*?<>|#^[\]]+/g,""))||"Unnamed Event"}.md`,o=(0,ue.normalizePath)(`${r}/${s}`),{filePath:l,description:c,outcome:u,images:d,...h}=e;h.sections&&delete h.sections;let f=o;if(l&&l!==o){let O=this.app.vault.getAbstractFileByPath(l);O&&O instanceof ue.TFile&&(await this.app.fileManager.renameFile(O,o),f=o)}let m=this.app.vault.getAbstractFileByPath(f),g={},y;if(m&&m instanceof ue.TFile)try{let O=await this.app.vault.cachedRead(m);g=Qn(O);let{parseFrontmatterFromContent:R}=await Promise.resolve().then(()=>(oi(),Xa)),F=R(O),$=this.app.metadataCache.getFileCache(m),k=$==null?void 0:$.frontmatter;(F||k)&&(y={...k||{},...F||{}})}catch(O){console.warn(`Error reading existing event file: ${O}`)}let v=this.buildFrontmatterForEvent(h,y);if(y){let O=Ja(v,y);O.lostFields.length>0&&console.warn("[saveEvent] Warning: Fields will be lost on save:",O.lostFields)}let E=Object.keys(v).length>0?Es(v,y,`Event: ${e.name}`):"",C={Description:c||"",Outcome:u||""},_=e._templateSections||{},x=Gs("event",C),P=m&&m instanceof ue.TFile?{...x,..._,...g,...C}:{...x,..._,...C},I=`---
${E}---

`;if(I+=Object.entries(P).map(([O,R])=>`## ${O}
${R||""}`).join(`

`),I.endsWith(`
`)||(I+=`
`),m&&m instanceof ue.TFile?await this.app.vault.modify(m,I):(await this.app.vault.create(f,I),new ue.Notice("Note created with standard sections for easy editing.")),this.settings.autoDetectConflicts!==!1)try{let O=await this.listEvents(),R=Vr.detectAllConflicts(O),F=Vr.getConflictsForEvent(e.name,R);if(F.length>0){let $=F.filter(N=>N.severity==="error").length,k=F.filter(N=>N.severity==="warning").length;$>0?new ue.Notice(`\u26A0\uFE0F Event saved with ${$} conflict(s). Use "Detect timeline conflicts" to review.`,5e3):k>0&&new ue.Notice(`\u26A0 Event saved with ${k} warning(s)`,3e3)}}catch(O){console.warn("Conflict detection failed:",O)}this.app.metadataCache.trigger("dataview:refresh-views")}async listEvents(){await this.ensureEventFolder();let e=this.getEntityFolder("event"),r=this.app.vault.getMarkdownFiles(),n=(0,ue.normalizePath)(e)+"/",s=r.filter(c=>c.path.startsWith(n)&&c.extension==="md"),o=[];for(let c of s){let u=await this.parseFile(c,{name:""},"event");u&&(u=this.normalizeEntityCustomFields("event",u)),u&&o.push(u)}let l=this.getReferenceTodayDate();return o.sort((c,u)=>{let d=c.dateTime?Pt(c.dateTime,{referenceDate:l}):{error:"empty"},h=u.dateTime?Pt(u.dateTime,{referenceDate:l}):{error:"empty"},f=to(d.start),m=to(h.start);return f!=null&&m!=null?f-m:f!=null?-1:m!=null?1:c.name.localeCompare(u.name)})}async deleteEvent(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Event file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find event file to delete at ${e}`)}async ensureItemFolder(){await this.ensureFolder(this.getEntityFolder("item"))}async ensureReferenceFolder(){await this.ensureFolder(this.getEntityFolder("reference"))}async savePlotItem(e){await this.ensureItemFolder();let r=this.getEntityFolder("item"),n=`${e.name.replace(/[\\/:"*?<>|]+/g,"")}.md`,s=(0,ue.normalizePath)(`${r}/${n}`),{filePath:o,description:l,history:c,...u}=e;u.sections&&delete u.sections;let d=s;if(o&&o!==s){let x=this.app.vault.getAbstractFileByPath(o);x instanceof ue.TFile&&(await this.app.fileManager.renameFile(x,s),d=s)}let h=this.app.vault.getAbstractFileByPath(d),f={},m;if(h&&h instanceof ue.TFile)try{let x=await this.app.vault.cachedRead(h);f=Qn(x);let{parseFrontmatterFromContent:P}=await Promise.resolve().then(()=>(oi(),Xa)),I=P(x),M=this.app.metadataCache.getFileCache(h),O=M==null?void 0:M.frontmatter;(I||O)&&(m={...O||{},...I||{}})}catch(x){console.warn(`Error reading existing item file: ${x}`)}let g=this.buildFrontmatterForItem(u,m);if(m){let x=Ja(g,m);x.lostFields.length>0&&console.warn("[savePlotItem] Warning: Fields will be lost on save:",x.lostFields)}let y=Object.keys(g).length>0?Es(g,m,`PlotItem: ${e.name}`):"",E=Gs("item",{Description:l||"",History:c||""}),C=h&&h instanceof ue.TFile?{...E,...f}:E,_=`---
${y}---

`;_+=Object.entries(C).map(([x,P])=>`## ${x}
${P||""}`).join(`

`),_.endsWith(`
`)||(_+=`
`),h&&h instanceof ue.TFile?await this.app.vault.modify(h,_):(await this.app.vault.create(d,_),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=d,this.app.metadataCache.trigger("dataview:refresh-views")}async listPlotItems(){await this.ensureItemFolder();let e=this.getEntityFolder("item"),r=this.app.vault.getMarkdownFiles(),n=(0,ue.normalizePath)(e)+"/",s=r.filter(l=>l.path.startsWith(n)&&l.extension==="md"),o=[];for(let l of s){let c=await this.parseFile(l,{name:"",isPlotCritical:!1},"item");c&&(c=this.normalizeEntityCustomFields("item",c)),c&&o.push(c)}return o.sort((l,c)=>l.name.localeCompare(c.name))}async deletePlotItem(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Item file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find item file to delete at ${e}`)}async saveReference(e){var P;await this.ensureReferenceFolder();let r=this.getEntityFolder("reference"),n=`${(e.name||"Untitled").replace(/[\\/:"*?<>|]+/g,"")}.md`,s=(0,ue.normalizePath)(`${r}/${n}`),{filePath:o,content:l,...c}=e;c.sections&&delete c.sections;let u=s;if(o&&o!==s){let I=this.app.vault.getAbstractFileByPath(o);I&&I instanceof ue.TFile&&(await this.app.fileManager.renameFile(I,s),u=s)}let d=this.app.vault.getAbstractFileByPath(u),h={},f;if(d&&d instanceof ue.TFile){let I=this.app.metadataCache.getFileCache(d);f=I==null?void 0:I.frontmatter;try{let M=await this.app.vault.cachedRead(d);h=Qn(M)}catch(M){console.warn("Error reading existing reference file",M)}}let m=new Set(Object.keys(c||{})),g=(P=this.settings.customFieldsMode)!=null?P:"flatten",y=Ka("reference",c,m,{customFieldsMode:g,originalFrontmatter:f});if(f){let I=Ja(y,f);I.lostFields.length>0&&console.warn("[saveReference] Warning: Fields will be lost on save:",I.lostFields)}let v=Object.keys(y).length>0?Es(y,f,`Reference: ${e.name}`):"",C=Gs("reference",{Content:l||""}),_=d&&d instanceof ue.TFile?{...C,...h}:C,x=`---
${v}---

`;x+=Object.entries(_).map(([I,M])=>`## ${I}
${M||""}`).join(`

`),x.endsWith(`
`)||(x+=`
`),d&&d instanceof ue.TFile?await this.app.vault.modify(d,x):(await this.app.vault.create(u,x),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=u,this.app.metadataCache.trigger("dataview:refresh-views")}async listReferences(){await this.ensureReferenceFolder();let e=this.getEntityFolder("reference"),r=this.app.vault.getMarkdownFiles(),n=(0,ue.normalizePath)(e)+"/",s=r.filter(l=>l.path.startsWith(n)&&l.extension==="md"),o=[];for(let l of s){let c=await this.parseFile(l,{name:""},"reference");c&&o.push(c)}return o.sort((l,c)=>l.name.localeCompare(c.name))}async deleteReference(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Reference file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find reference file to delete at ${e}`)}async ensureChapterFolder(){await this.ensureFolder(this.getEntityFolder("chapter"))}async saveChapter(e){var k;await this.ensureChapterFolder();let r=this.getEntityFolder("chapter"),s=`${(e.name||"Untitled").replace(/[\\/:"*?<>|]+/g,"")}.md`,o=(0,ue.normalizePath)(`${r}/${s}`);e.id||(e.id=Date.now().toString(36)+Math.random().toString(36).substr(2,6));let{filePath:l,summary:c,linkedCharacters:u,linkedLocations:d,linkedEvents:h,linkedItems:f,linkedGroups:m,...g}=e;g.sections&&delete g.sections;let y=o;if(l&&l!==o){let N=this.app.vault.getAbstractFileByPath(l);N&&N instanceof ue.TFile&&(await this.app.fileManager.renameFile(N,o),y=o)}let v=this.app.vault.getAbstractFileByPath(y),E={},C;if(v&&v instanceof ue.TFile){let N=this.app.metadataCache.getFileCache(v);C=N==null?void 0:N.frontmatter;try{let G=await this.app.vault.cachedRead(v);E=Qn(G)}catch(G){console.warn("Error reading existing chapter file",G)}}let _={...g,linkedCharacters:u,linkedLocations:d,linkedEvents:h,linkedItems:f,linkedGroups:m},x=new Set(Object.keys(_)),P=(k=this.settings.customFieldsMode)!=null?k:"flatten",I=Ka("chapter",_,x,{customFieldsMode:P,originalFrontmatter:C});if(C){let N=Ja(I,C);N.lostFields.length>0&&console.warn("[saveChapter] Warning: Fields will be lost on save:",N.lostFields)}let M=Object.keys(I).length>0?Es(I,C,`Chapter: ${e.name}`):"",R=Gs("chapter",{Summary:c||""}),F=v&&v instanceof ue.TFile?{...R,...E}:R,$=`---
${M}---

`;$+=Object.entries(F).map(([N,G])=>`## ${N}
${G||""}`).join(`

`),$.endsWith(`
`)||($+=`
`),v&&v instanceof ue.TFile?await this.app.vault.modify(v,$):(await this.app.vault.create(y,$),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=y,this.app.metadataCache.trigger("dataview:refresh-views")}async listChapters(){await this.ensureChapterFolder();let e=this.getEntityFolder("chapter"),r=this.app.vault.getMarkdownFiles(),n=(0,ue.normalizePath)(e)+"/",s=r.filter(l=>l.path.startsWith(n)&&l.extension==="md"),o=[];for(let l of s){let c=await this.parseFile(l,{name:""},"chapter");c&&o.push(c)}return o.sort((l,c)=>{var h,f;let u=(h=l.number)!=null?h:Number.MAX_SAFE_INTEGER,d=(f=c.number)!=null?f:Number.MAX_SAFE_INTEGER;return u!==d?u-d:l.name.localeCompare(c.name)})}async deleteChapter(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Chapter file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find chapter file to delete at ${e}`)}async ensureSceneFolder(){await this.ensureFolder(this.getEntityFolder("scene"))}async ensureCultureFolder(){await this.ensureFolder(this.getEntityFolder("culture"))}async ensureEconomyFolder(){await this.ensureFolder(this.getEntityFolder("economy"))}async ensureMagicSystemFolder(){await this.ensureFolder(this.getEntityFolder("magicSystem"))}async saveScene(e){var N;if(e.chapterId&&!e.chapterName){let W=(await this.listChapters()).find(Y=>Y.id===e.chapterId);W&&(e.chapterName=W.name)}await this.ensureSceneFolder();let r=this.getEntityFolder("scene"),n=`${(e.name||"Untitled").replace(/[\\/:"*?<>|]+/g,"")}.md`,s=(0,ue.normalizePath)(`${r}/${n}`),{filePath:o,content:l,beats:c,linkedCharacters:u,linkedLocations:d,linkedEvents:h,linkedItems:f,linkedGroups:m,...g}=e;g.sections&&delete g.sections;let y=s;if(o&&o!==s){let G=this.app.vault.getAbstractFileByPath(o);G&&G instanceof ue.TFile&&(await this.app.fileManager.renameFile(G,s),y=s)}let v=this.app.vault.getAbstractFileByPath(y),E={},C;if(v&&v instanceof ue.TFile){let G=this.app.metadataCache.getFileCache(v);C=G==null?void 0:G.frontmatter;try{let W=await this.app.vault.cachedRead(v);E=Qn(W)}catch(W){console.warn("Error reading existing scene file",W)}}let _={...g,linkedCharacters:u,linkedLocations:d,linkedEvents:h,linkedItems:f,linkedGroups:m},x=new Set(Object.keys(_)),P=(N=this.settings.customFieldsMode)!=null?N:"flatten",I=Ka("scene",_,x,{customFieldsMode:P,originalFrontmatter:C});if(C){let G=Ja(I,C);G.lostFields.length>0&&console.warn("[saveScene] Warning: Fields will be lost on save:",G.lostFields)}let M=Object.keys(I).length>0?Es(I,C,`Scene: ${e.name}`):"",O=c&&Array.isArray(c)?c:void 0,R={Content:l||"",Beats:O&&O.length>0?O.join(`
`):""},F=Gs("scene",R),$=v&&v instanceof ue.TFile?{...F,...E}:F,k=`---
${M}---

`;if(k+=Object.entries($).map(([G,W])=>`## ${G}
${W||""}`).join(`

`),k.endsWith(`
`)||(k+=`
`),v&&v instanceof ue.TFile?await this.app.vault.modify(v,k):(await this.app.vault.create(y,k),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=y,e.chapterId&&!e.chapterName){let W=(await this.listChapters()).find(Y=>Y.id===e.chapterId);W&&(e.chapterName=W.name)}this.app.metadataCache.trigger("dataview:refresh-views")}async listScenes(){await this.ensureSceneFolder();let e=this.getEntityFolder("scene"),n=this.app.vault.getMarkdownFiles().filter(o=>o.path.startsWith(e+"/")&&o.extension==="md"),s=[];for(let o of n){let l=await this.parseFile(o,{name:""},"scene");l&&s.push(l)}return s.sort((o,l)=>{var f,m;let c=o.chapterId?0:1,u=l.chapterId?0:1;if(c!==u)return c-u;let d=(f=o.priority)!=null?f:Number.MAX_SAFE_INTEGER,h=(m=l.priority)!=null?m:Number.MAX_SAFE_INTEGER;return d!==h?d-h:o.name.localeCompare(l.name)})}async deleteScene(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Scene file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find scene file to delete at ${e}`)}async saveCulture(e){await this.ensureCultureFolder();let r=this.getEntityFolder("culture"),n=`${e.name.replace(/[\\/:"*?<>|]+/g,"")}.md`,s=(0,ue.normalizePath)(`${r}/${n}`),{filePath:o,description:l,values:c,religion:u,socialStructure:d,history:h,namingConventions:f,customs:m,...g}=e;g.sections&&delete g.sections;let y=s;if(o&&o!==s){let R=this.app.vault.getAbstractFileByPath(o);R&&R instanceof ue.TFile&&(await this.app.fileManager.renameFile(R,s),y=s)}let v=this.app.vault.getAbstractFileByPath(y),E={},C;if(v&&v instanceof ue.TFile)try{let R=await this.app.vault.cachedRead(v);E=Qn(R);let{parseFrontmatterFromContent:F}=await Promise.resolve().then(()=>(oi(),Xa)),$=F(R),k=this.app.metadataCache.getFileCache(v),N=k==null?void 0:k.frontmatter;($||N)&&(C={...N||{},...$||{}})}catch(R){console.warn(`Error reading existing culture file: ${R}`)}let _=this.buildFrontmatterForCulture(g,C);if(C){let R=Ja(_,C);R.lostFields.length>0&&console.warn("[saveCulture] Warning: Fields will be lost on save:",R.lostFields)}let x=Object.keys(_).length>0?Es(_,C,`Culture: ${e.name}`):"",P={Description:l!==void 0?l:"",Values:c!==void 0?c:"",Religion:u!==void 0?u:"","Social Structure":d!==void 0?d:"",History:h!==void 0?h:"","Naming Conventions":f!==void 0?f:"",Customs:m!==void 0?m:""},I=Gs("culture",P),M;v&&v instanceof ue.TFile?(M={...E,...I},Object.entries(P).forEach(([R,F])=>{M[R]=F})):M=I;let O=`---
${x}---

`;O+=Object.entries(M).map(([R,F])=>`## ${R}
${F||""}`).join(`

`),O.endsWith(`
`)||(O+=`
`),v&&v instanceof ue.TFile?await this.app.vault.modify(v,O):(await this.app.vault.create(y,O),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=y,this.app.metadataCache.trigger("dataview:refresh-views")}async listCultures(){await this.ensureCultureFolder();let e=this.getEntityFolder("culture"),n=this.app.vault.getMarkdownFiles().filter(o=>o.path.startsWith(e+"/")&&o.extension==="md"),s=[];for(let o of n){let l=await this.parseFile(o,{name:""},"culture");l&&s.push(l)}return s.sort((o,l)=>o.name.localeCompare(l.name))}async deleteCulture(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Culture file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find culture file to delete at ${e}`)}async saveEconomy(e){await this.ensureEconomyFolder();let r=this.getEntityFolder("economy"),n=`${e.name.replace(/[\\/:"*?<>|]+/g,"")}.md`,s=(0,ue.normalizePath)(`${r}/${n}`),{filePath:o,description:l,industries:c,taxation:u,...d}=e;d.sections&&delete d.sections;let h=s;if(o&&o!==s){let P=this.app.vault.getAbstractFileByPath(o);P&&P instanceof ue.TFile&&(await this.app.fileManager.renameFile(P,s),h=s)}let f=this.app.vault.getAbstractFileByPath(h),m={},g;if(f&&f instanceof ue.TFile)try{let P=await this.app.vault.cachedRead(f);m=Qn(P);let{parseFrontmatterFromContent:I}=await Promise.resolve().then(()=>(oi(),Xa)),M=I(P),O=this.app.metadataCache.getFileCache(f),R=O==null?void 0:O.frontmatter;(M||R)&&(g={...R||{},...M||{}})}catch(P){console.warn(`Error reading existing economy file: ${P}`)}let y=this.buildFrontmatterForEconomy(d,g);if(g){let P=Ja(y,g);P.lostFields.length>0&&console.warn("[saveEconomy] Warning: Fields will be lost on save:",P.lostFields)}let v=Object.keys(y).length>0?Es(y,g,`Economy: ${e.name}`):"",E={Description:l!==void 0?l:"",Industries:c!==void 0?c:"",Taxation:u!==void 0?u:""},C=Gs("economy",E),_;f&&f instanceof ue.TFile?(_={...m,...C},Object.entries(E).forEach(([P,I])=>{_[P]=I})):_=C;let x=`---
${v}---

`;x+=Object.entries(_).map(([P,I])=>`## ${P}
${I||""}`).join(`

`),x.endsWith(`
`)||(x+=`
`),f&&f instanceof ue.TFile?await this.app.vault.modify(f,x):(await this.app.vault.create(h,x),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=h,this.app.metadataCache.trigger("dataview:refresh-views")}async listEconomies(){await this.ensureEconomyFolder();let e=this.getEntityFolder("economy"),n=this.app.vault.getMarkdownFiles().filter(o=>o.path.startsWith(e+"/")&&o.extension==="md"),s=[];for(let o of n){let l=await this.parseFile(o,{name:""},"economy");l&&s.push(l)}return s.sort((o,l)=>o.name.localeCompare(l.name))}async deleteEconomy(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Economy file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find economy file to delete at ${e}`)}async saveMagicSystem(e){await this.ensureMagicSystemFolder();let r=this.getEntityFolder("magicSystem"),n=`${e.name.replace(/[\\/:"*?<>|]+/g,"")}.md`,s=(0,ue.normalizePath)(`${r}/${n}`),{filePath:o,description:l,rules:c,source:u,costs:d,limitations:h,training:f,history:m,...g}=e;g.sections&&delete g.sections;let y=s;if(o&&o!==s){let R=this.app.vault.getAbstractFileByPath(o);R&&R instanceof ue.TFile&&(await this.app.fileManager.renameFile(R,s),y=s)}let v=this.app.vault.getAbstractFileByPath(y),E={},C;if(v&&v instanceof ue.TFile)try{let R=await this.app.vault.cachedRead(v);E=Qn(R);let{parseFrontmatterFromContent:F}=await Promise.resolve().then(()=>(oi(),Xa)),$=F(R),k=this.app.metadataCache.getFileCache(v),N=k==null?void 0:k.frontmatter;($||N)&&(C={...N||{},...$||{}})}catch(R){console.warn(`Error reading existing magic system file: ${R}`)}let _=this.buildFrontmatterForMagicSystem(g,C);if(C){let R=Ja(_,C);R.lostFields.length>0&&console.warn("[saveMagicSystem] Warning: Fields will be lost on save:",R.lostFields)}let x=Object.keys(_).length>0?Es(_,C,`MagicSystem: ${e.name}`):"",P={Description:l!==void 0?l:"",Rules:c!==void 0?c:"",Source:u!==void 0?u:"",Costs:d!==void 0?d:"",Limitations:h!==void 0?h:"",Training:f!==void 0?f:"",History:m!==void 0?m:""},I=Gs("magicSystem",P),M;v&&v instanceof ue.TFile?(M={...E,...I},Object.entries(P).forEach(([R,F])=>{M[R]=F})):M=I;let O=`---
${x}---

`;O+=Object.entries(M).map(([R,F])=>`## ${R}
${F||""}`).join(`

`),O.endsWith(`
`)||(O+=`
`),v&&v instanceof ue.TFile?await this.app.vault.modify(v,O):(await this.app.vault.create(y,O),new ue.Notice("Note created with standard sections for easy editing.")),e.filePath=y,this.app.metadataCache.trigger("dataview:refresh-views")}async listMagicSystems(){await this.ensureMagicSystemFolder();let e=this.getEntityFolder("magicSystem"),n=this.app.vault.getMarkdownFiles().filter(o=>o.path.startsWith(e+"/")&&o.extension==="md"),s=[];for(let o of n){let l=await this.parseFile(o,{name:""},"magicSystem");l&&s.push(l)}return s.sort((o,l)=>o.name.localeCompare(l.name))}async deleteMagicSystem(e){let r=this.app.vault.getAbstractFileByPath((0,ue.normalizePath)(e));r instanceof ue.TFile?(await this.app.vault.trash(r,!0),new ue.Notice(`Magic System file "${r.basename}" moved to trash.`),this.app.metadataCache.trigger("dataview:refresh-views")):new ue.Notice(`Error: Could not find magic system file to delete at ${e}`)}createTimelineFork(e,r,n,s){let o={id:Date.now().toString(),name:e,parentTimelineId:void 0,divergenceEvent:r,divergenceDate:n,description:s,status:"exploring",forkEvents:[],alteredCharacters:[],alteredLocations:[],color:this.generateRandomColor(),created:new Date().toISOString(),notes:""};return this.settings.timelineForks=this.settings.timelineForks||[],this.settings.timelineForks.push(o),this.saveSettings(),new ue.Notice(`Timeline fork "${e}" created`),o}getTimelineForks(){return this.settings.timelineForks||[]}getTimelineFork(e){var r;return(r=this.settings.timelineForks)==null?void 0:r.find(n=>n.id===e)}async updateTimelineFork(e){var n;let r=(n=this.settings.timelineForks)==null?void 0:n.findIndex(s=>s.id===e.id);r!==void 0&&r>=0?(this.settings.timelineForks[r]=e,await this.saveSettings(),new ue.Notice(`Timeline fork "${e.name}" updated`)):new ue.Notice("Error: Timeline fork not found")}async deleteTimelineFork(e){var n;let r=this.getTimelineFork(e);r?(this.settings.timelineForks=(n=this.settings.timelineForks)==null?void 0:n.filter(s=>s.id!==e),await this.saveSettings(),new ue.Notice(`Timeline fork "${r.name}" deleted`)):new ue.Notice("Error: Timeline fork not found")}async addEventToFork(e,r){let n=this.getTimelineFork(e);if(!n){new ue.Notice("Error: Timeline fork not found");return}n.forkEvents||(n.forkEvents=[]),n.forkEvents.includes(r)||(n.forkEvents.push(r),await this.updateTimelineFork(n))}async removeEventFromFork(e,r){let n=this.getTimelineFork(e);if(!n){new ue.Notice("Error: Timeline fork not found");return}n.forkEvents&&(n.forkEvents=n.forkEvents.filter(s=>s!==r),await this.updateTimelineFork(n))}getForksForEvent(e){return this.getTimelineForks().filter(n=>{var s;return(s=n.forkEvents)==null?void 0:s.includes(e)})}generateRandomColor(){let e=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE","#85C1E2","#F8B195","#95E1D3"];return e[Math.floor(Math.random()*e.length)]}async createTimelineEra(e){this.settings.timelineEras=this.settings.timelineEras||[],this.settings.timelineEras.push(e),await this.saveSettings(),new ue.Notice(`Era "${e.name}" created`)}getTimelineEras(){return this.settings.timelineEras||[]}getTimelineEra(e){var r;return(r=this.settings.timelineEras)==null?void 0:r.find(n=>n.id===e)}async updateTimelineEra(e){var n;let r=(n=this.settings.timelineEras)==null?void 0:n.findIndex(s=>s.id===e.id);r!==void 0&&r>=0?(this.settings.timelineEras[r]=e,await this.saveSettings(),new ue.Notice(`Era "${e.name}" updated`)):new ue.Notice("Error: Era not found")}async deleteTimelineEra(e){var n;let r=this.getTimelineEra(e);r?(this.settings.timelineEras=(n=this.settings.timelineEras)==null?void 0:n.filter(s=>s.id!==e),await this.saveSettings(),new ue.Notice(`Era "${r.name}" deleted`)):new ue.Notice("Error: Era not found")}async createTimelineTrack(e){this.settings.timelineTracks=this.settings.timelineTracks||[],this.settings.timelineTracks.push(e),await this.saveSettings(),new ue.Notice(`Track "${e.name}" created`)}getTimelineTracks(){return this.settings.timelineTracks||[]}getTimelineTrack(e){var r;return(r=this.settings.timelineTracks)==null?void 0:r.find(n=>n.id===e)}async updateTimelineTrack(e){var n;let r=(n=this.settings.timelineTracks)==null?void 0:n.findIndex(s=>s.id===e.id);r!==void 0&&r>=0?(this.settings.timelineTracks[r]=e,await this.saveSettings(),new ue.Notice(`Track "${e.name}" updated`)):new ue.Notice("Error: Track not found")}async deleteTimelineTrack(e){var n;let r=this.getTimelineTrack(e);r?(this.settings.timelineTracks=(n=this.settings.timelineTracks)==null?void 0:n.filter(s=>s.id!==e),await this.saveSettings(),new ue.Notice(`Track "${r.name}" deleted`)):new ue.Notice("Error: Track not found")}createCausalityLink(e,r,n,s,o){let l={id:`${e}-${r}-${Date.now()}`,causeEvent:e,effectEvent:r,linkType:n,strength:o||"strong",description:s};return this.settings.causalityLinks=this.settings.causalityLinks||[],this.settings.causalityLinks.push(l),this.saveSettings(),new ue.Notice(`Causality link created: ${e} \u2192 ${r}`),l}getCausalityLinks(){return this.settings.causalityLinks||[]}getCausalityLinksForEvent(e){let r=this.settings.causalityLinks||[];return{causes:r.filter(n=>n.effectEvent===e),effects:r.filter(n=>n.causeEvent===e)}}async updateCausalityLink(e){var n;let r=(n=this.settings.causalityLinks)==null?void 0:n.findIndex(s=>s.id===e.id);r!==void 0&&r>=0?(this.settings.causalityLinks[r]=e,await this.saveSettings(),new ue.Notice("Causality link updated")):new ue.Notice("Error: Causality link not found")}async deleteCausalityLink(e){var s,o,l;let r=((s=this.settings.causalityLinks)==null?void 0:s.length)||0;this.settings.causalityLinks=(o=this.settings.causalityLinks)==null?void 0:o.filter(c=>c.id!==e);let n=((l=this.settings.causalityLinks)==null?void 0:l.length)||0;r>n?(await this.saveSettings(),new ue.Notice("Causality link deleted")):new ue.Notice("Error: Causality link not found")}async createStoryBoard(){try{let e=await this.listScenes();if(e.length===0){new ue.Notice("No scenes found. Create some scenes first!");return}let r=await this.listChapters(),{StoryBoardGenerator:n}=await Promise.resolve().then(()=>(CP(),TP)),s=this.settings.storyBoardLayout||"chapters",o=this.settings.storyBoardCardWidth||400,l=this.settings.storyBoardCardHeight||300,c=this.settings.storyBoardColorBy||"status",u=this.settings.storyBoardShowEdges!==void 0?this.settings.storyBoardShowEdges:!1,h=new n({cardWidth:o,cardHeight:l}).generateCanvas(e,r,{layout:s,colorBy:c,showChapterHeaders:!0,showEdges:u}),f=this.getStoryBoardPath(),m=this.app.vault.getAbstractFileByPath(f);if(m instanceof ue.TFile){let{ConfirmModal:y}=await Promise.resolve().then(()=>(Zy(),NC)),v=!1;if(await new Promise(E=>{new y(this.app,{title:"Overwrite Story Board?",body:"A story board already exists. Do you want to overwrite it?",onConfirm:()=>{v=!0,E()}}).open(),setTimeout(()=>E(),100)}),v){let E=JSON.stringify(h,null,2);await this.app.vault.modify(m,E),new ue.Notice("Story board updated!")}else return}else{let y=JSON.stringify(h,null,2);await this.app.vault.create(f,y),new ue.Notice("Story board created!")}let g=this.app.vault.getAbstractFileByPath(f);g instanceof ue.TFile&&await this.app.workspace.getLeaf(!1).openFile(g)}catch(e){if(e instanceof Error&&e.message==="User cancelled")return;console.error("Error creating story board:",e),new ue.Notice("Error creating story board. See console for details.")}}async updateStoryBoard(){try{let e=this.getStoryBoardPath(),r=this.app.vault.getAbstractFileByPath(e);if(!(r instanceof ue.TFile)){new ue.Notice('No story board found. Create one first using "Create Story Board".');return}let n=await this.listScenes();if(n.length===0){new ue.Notice("No scenes found. Create some scenes first!");return}let s=await this.listChapters(),o=await this.app.vault.read(r),l;try{l=JSON.parse(o)}catch(C){new ue.Notice("Error reading existing story board. It may be corrupted."),console.error("Error parsing canvas:",C);return}let{StoryBoardGenerator:c}=await Promise.resolve().then(()=>(CP(),TP)),u=this.settings.storyBoardLayout||"chapters",d=this.settings.storyBoardCardWidth||400,h=this.settings.storyBoardCardHeight||300,f=this.settings.storyBoardColorBy||"status",m=this.settings.storyBoardShowEdges!==void 0?this.settings.storyBoardShowEdges:!1,y=new c({cardWidth:d,cardHeight:h}).updateCanvas(l,n,s,{layout:u,colorBy:f,showChapterHeaders:!0,showEdges:m}),v=JSON.stringify(y,null,2);await this.app.vault.modify(r,v),new ue.Notice("Story board updated! Manual edits preserved."),await this.app.workspace.getLeaf(!1).openFile(r)}catch(e){console.error("Error updating story board:",e),new ue.Notice("Error updating story board. See console for details.")}}async openStoryBoard(){try{let e=this.getStoryBoardPath(),r=this.app.vault.getAbstractFileByPath(e);if(!(r instanceof ue.TFile)){let{ConfirmModal:s}=await Promise.resolve().then(()=>(Zy(),NC)),o=!1;await new Promise(l=>{new s(this.app,{title:"Create Story Board?",body:"No story board found. Would you like to create one?",onConfirm:()=>{o=!0,l()}}).open(),setTimeout(()=>l(),100)}),o&&await this.createStoryBoard();return}await this.app.workspace.getLeaf(!1).openFile(r)}catch(e){console.error("Error opening story board:",e),new ue.Notice("Error opening story board. See console for details.")}}getStoryBoardPath(){let e=this.getActiveStory(),r=e?e.name:"Default",n=r.replace(/[\\/:*?"<>|]/g,"-");if(this.settings.enableOneStoryMode){let s=this.sanitizeBaseFolderPath(this.settings.oneStoryBaseFolder);return(0,ue.normalizePath)(`${s}/Story Board - ${n}.canvas`)}else return(0,ue.normalizePath)(`StorytellerSuite/Stories/${r}/Story Board - ${n}.canvas`)}getGalleryImages(){return this.settings.galleryData.images||[]}async addGalleryImage(e){let r=Date.now().toString()+Math.random().toString(36).substr(2,9),n={...e,id:r};return this.settings.galleryData.images.push(n),await this.saveSettings(),n}async updateGalleryImage(e){let r=this.settings.galleryData.images,n=r.findIndex(s=>s.id===e.id);n!==-1?(r[n]=e,await this.saveSettings()):(console.error(`Gallery image with id ${e.id} not found for update`),new ue.Notice("Error: Gallery image not found for update"))}async deleteGalleryImage(e){let r=this.settings.galleryData.images,n=r.length;this.settings.galleryData.images=r.filter(s=>s.id!==e),this.settings.galleryData.images.length<n?(await this.saveSettings(),new ue.Notice("Image removed from gallery")):(console.error(`Gallery image with id ${e} not found for deletion`),new ue.Notice("Error: Gallery image not found"))}async createGroup(e,r,n){let s=this.getActiveStory();if(!s)throw new Error("No active story selected");let l={id:Date.now().toString(36)+Math.random().toString(36).substr(2,6),storyId:s.id,name:e,description:r,color:n,members:[]};return this.settings.groups.push(l),await this.saveSettings(),this.emitGroupsChanged(),l}async updateGroup(e,r){let n=this.getActiveStory();if(!n)throw new Error("No active story selected");let s=this.settings.groups.find(o=>o.id===e&&o.storyId===n.id);if(!s)throw new Error("Group not found");r.name!==void 0&&(s.name=r.name),r.description!==void 0&&(s.description=r.description),r.color!==void 0&&(s.color=r.color),await this.saveSettings(),this.emitGroupsChanged()}async deleteGroup(e){let r=this.getActiveStory();if(!r)throw new Error("No active story selected");if(!this.settings.groups.find(s=>s.id===e&&s.storyId===r.id))throw new Error("Group not found");this.settings.groups=this.settings.groups.filter(s=>s.id!==e),await this.removeGroupIdFromAllEntities(e),await this.saveSettings(),this.emitGroupsChanged()}getGroups(){let e=this.getActiveStory();return e?this.settings.groups.filter(r=>r.storyId===e.id):[]}async addMemberToGroup(e,r,n){let s=this.getActiveStory();if(!s)throw new Error("No active story selected");let o=this.settings.groups.find(l=>l.id===e&&l.storyId===s.id);if(!o)throw new Error("Group not found");o.members.some(l=>l.type===r&&l.id===n)||o.members.push({type:r,id:n}),await this.addGroupIdToEntity(r,n,e),await this.saveSettings(),this.emitGroupsChanged()}async removeMemberFromGroup(e,r,n){let s=this.getActiveStory();if(!s)throw new Error("No active story selected");let o=this.settings.groups.find(l=>l.id===e&&l.storyId===s.id);if(!o)throw new Error("Group not found");o.members=o.members.filter(l=>!(l.type===r&&l.id===n)),await this.removeGroupIdFromEntity(r,n,e),await this.saveSettings(),this.emitGroupsChanged()}async removeGroupIdFromAllEntities(e){let r=await this.listCharacters();for(let l of r)l.groups&&l.groups.includes(e)&&(l.groups=l.groups.filter(c=>c!==e),await this.saveCharacter(l));let n=await this.listLocations();for(let l of n)l.groups&&l.groups.includes(e)&&(l.groups=l.groups.filter(c=>c!==e),await this.saveLocation(l));let s=await this.listEvents();for(let l of s)l.groups&&l.groups.includes(e)&&(l.groups=l.groups.filter(c=>c!==e),await this.saveEvent(l));let o=await this.listPlotItems();for(let l of o)l.groups&&l.groups.includes(e)&&(l.groups=l.groups.filter(c=>c!==e),await this.savePlotItem(l))}async addGroupIdToEntity(e,r,n){if(e==="character"){let o=(await this.listCharacters()).find(l=>(l.id||l.name)===r);o&&(o.groups||(o.groups=[]),o.groups.includes(n)||(o.groups.push(n),await this.saveCharacter(o)))}else if(e==="location"){let o=(await this.listLocations()).find(l=>(l.id||l.name)===r);o&&(o.groups||(o.groups=[]),o.groups.includes(n)||(o.groups.push(n),await this.saveLocation(o)))}else if(e==="event"){let o=(await this.listEvents()).find(l=>(l.id||l.name)===r);o&&(o.groups||(o.groups=[]),o.groups.includes(n)||(o.groups.push(n),await this.saveEvent(o)))}else if(e==="item"){let o=(await this.listPlotItems()).find(l=>(l.id||l.name)===r);o&&(o.groups||(o.groups=[]),o.groups.includes(n)||(o.groups.push(n),await this.savePlotItem(o)))}}async removeGroupIdFromEntity(e,r,n){if(e==="character"){let o=(await this.listCharacters()).find(l=>(l.id||l.name)===r);o&&o.groups&&o.groups.includes(n)&&(o.groups=o.groups.filter(l=>l!==n),await this.saveCharacter(o))}else if(e==="location"){let o=(await this.listLocations()).find(l=>(l.id||l.name)===r);o&&o.groups&&o.groups.includes(n)&&(o.groups=o.groups.filter(l=>l!==n),await this.saveLocation(o))}else if(e==="event"){let o=(await this.listEvents()).find(l=>(l.id||l.name)===r);o&&o.groups&&o.groups.includes(n)&&(o.groups=o.groups.filter(l=>l!==n),await this.saveEvent(o))}else if(e==="item"){let o=(await this.listPlotItems()).find(l=>(l.id||l.name)===r);o&&o.groups&&o.groups.includes(n)&&(o.groups=o.groups.filter(l=>l!==n),await this.savePlotItem(o))}}isRelevantFile(e){try{let r=this.getEntityFolder("character"),n=this.getEntityFolder("location"),s=this.getEntityFolder("event"),o=this.getEntityFolder("item"),l=this.getEntityFolder("reference"),c=this.getEntityFolder("chapter"),u=this.getEntityFolder("scene");return e.startsWith(r+"/")||e.startsWith(n+"/")||e.startsWith(s+"/")||e.startsWith(o+"/")||e.startsWith(l+"/")||e.startsWith(c+"/")||e.startsWith(u+"/")||e.startsWith(this.settings.galleryUploadFolder+"/")}catch(r){return!1}}async loadSettings(){var n;let e=await this.loadData();this.settings=Object.assign({},ga,e);let r=!1;try{if(!this.settings.sanitizedSeedData){let o=(this.settings.stories||[]).map(l=>(l.name||"").toLowerCase()).some(l=>l.includes("test")||/\bmy\s*story\s*1\b/i.test(l));if((((n=this.settings.stories)==null?void 0:n.length)||0)>0&&o){let l=this.app.vault.getMarkdownFiles(),c=this.getFolderResolver().resolveAll(),u=Object.values(c).map(h=>h.path).filter(h=>!!h).map(h=>(0,ue.normalizePath)(h)+"/");l.some(h=>u.some(f=>h.path.startsWith(f)))?(this.settings.sanitizedSeedData=!0,r=!0):(this.settings.stories=[],this.settings.activeStoryId="",this.settings.sanitizedSeedData=!0,r=!0)}else this.settings.sanitizedSeedData||(this.settings.sanitizedSeedData=!0,r=!0)}}catch(s){console.warn("Storyteller Suite: Seed data sanitization skipped due to error",s)}if(!this.settings.stories||this.settings.stories.length===0){let s=this.app.vault,o=(e==null?void 0:e.characterFolder)||"StorytellerSuite/Characters",l=(e==null?void 0:e.locationFolder)||"StorytellerSuite/Locations",c=(e==null?void 0:e.eventFolder)||"StorytellerSuite/Events";if(s.getMarkdownFiles().some(d=>d.path.startsWith(o+"/")||d.path.startsWith(l+"/")||d.path.startsWith(c+"/"))){let h=await this.createStory("My First Story","Migrated from previous version"),f=async(m,g)=>{let y=s.getMarkdownFiles().filter(v=>v.path.startsWith(m+"/"));for(let v of y){let E=this.getEntityFolder(g),C=`${E}/${v.name}`;await this.ensureFolder(E),await this.app.fileManager.renameFile(v,C)}};await f(o,"character"),await f(l,"location"),await f(c,"event"),this.settings.activeStoryId=h.id,r=!0}}if(this.settings.groups&&this.settings.groups.length>0){let s=this.settings.groups.filter(o=>!("storyId"in o));if(s.length>0){let o=this.settings.activeStoryId||(this.settings.stories.length>0?this.settings.stories[0].id:null);if(o){for(let l of s)l.storyId=o;r=!0}}}if(this.settings.galleryUploadFolder||(this.settings.galleryUploadFolder=ga.galleryUploadFolder,r=!0),this.settings.galleryData||(this.settings.galleryData=ga.galleryData,r=!0),this.settings.enableCustomEntityFolders===void 0&&(this.settings.enableCustomEntityFolders=ga.enableCustomEntityFolders,r=!0),this.settings.enableOneStoryMode===void 0&&(this.settings.enableOneStoryMode=ga.enableOneStoryMode,r=!0),(!("oneStoryBaseFolder"in this.settings)||!this.settings.oneStoryBaseFolder)&&(this.settings.oneStoryBaseFolder=ga.oneStoryBaseFolder,r=!0),"characterFolderPath"in this.settings||(this.settings.characterFolderPath=ga.characterFolderPath,r=!0),"locationFolderPath"in this.settings||(this.settings.locationFolderPath=ga.locationFolderPath,r=!0),"eventFolderPath"in this.settings||(this.settings.eventFolderPath=ga.eventFolderPath,r=!0),"itemFolderPath"in this.settings||(this.settings.itemFolderPath=ga.itemFolderPath,r=!0),"referenceFolderPath"in this.settings||(this.settings.referenceFolderPath=ga.referenceFolderPath,r=!0),"chapterFolderPath"in this.settings||(this.settings.chapterFolderPath=ga.chapterFolderPath,r=!0),"sceneFolderPath"in this.settings||(this.settings.sceneFolderPath=ga.sceneFolderPath,r=!0),this.settings.groups||(this.settings.groups=[],r=!0),this.settings.language||(this.settings.language=ga.language,r=!0),this.settings.groups.length>0)for(let s of this.settings.groups)"tags"in s||(s.tags=[]);r&&await this.saveSettings()}emitGroupsChanged(){var e;try{let n=(e=this.app.workspace.getLeavesOfType(zs)[0])==null?void 0:e.view;n&&n.activeTabId==="groups"&&typeof n.refreshActiveTab=="function"&&n.refreshActiveTab()}catch(r){}}async applyTemplateWithPrompt(e,r){console.log("applyTemplateWithPrompt called with template:",e.name);let n=this.getActiveStory();if(console.log("Active story:",n),!n){new ue.Notice("Please select or create a story first");return}let{TemplateApplicationModal:s}=await Promise.resolve().then(()=>(iW(),rW));new s(this.app,this,e,async(o,l)=>{console.log("Variable values collected:",o),console.log("Entity file names:",l);let c=new Map;l.forEach(u=>{let d={};u.fileName&&(d.name=u.fileName),Object.keys(d).length>0&&c.set(u.templateId,d)}),await this.applyTemplateInternal(e,n.id,o,{...r,fieldOverrides:c})}).open()}async applyTemplateInternal(e,r,n,s){console.log("applyTemplateInternal called:",{templateName:e.name,storyId:r,variableValues:n});try{let{TemplateApplicator:o}=await Promise.resolve().then(()=>(hP(),O4)),l=new o(this),c={storyId:r,mode:"merge",variableValues:n,...s};console.log("Applying template with options:",c);let u=await l.applyTemplate(e,c);if(console.log("Template application result:",u),u.success){let d=this.countCreatedEntities(u.created);console.log("Template applied successfully, created entities:",d),new ue.Notice(`Template "${e.name}" applied successfully! Created ${d} entities.`),this.app.workspace.trigger("storyteller:entities-changed")}else console.error("Template application failed:",u.error),new ue.Notice(`Failed to apply template: ${u.error||"Unknown error"}`)}catch(o){console.error("Error applying template:",o),new ue.Notice(`Error applying template: ${o.message}`)}}countCreatedEntities(e){let r=0;return r+=e.characters.length,r+=e.locations.length,r+=e.events.length,r+=e.items.length,r+=e.groups.length,r+=e.cultures.length,r+=e.economies.length,r+=e.magicSystems.length,r+=e.chapters.length,r+=e.scenes.length,r+=e.references.length,r}async saveSettings(){await this.saveData(this.settings)}applyMobilePlatformClasses(){let e=document.body;if(!e){console.warn("Storyteller Suite: document.body is null, cannot apply mobile platform classes");return}let r=Et.getMobileCssClasses();e.classList.remove("is-mobile","is-ios","is-android","is-desktop"),r.forEach(n=>{e.classList.add(n)}),Et.isMobile()&&e.classList.add("storyteller-mobile-enabled")}removeMobilePlatformClasses(){let e=document.body;if(!e){console.warn("Storyteller Suite: document.body is null, cannot remove mobile platform classes");return}try{e.classList.contains("storyteller-mobile-enabled")&&e.classList.remove("storyteller-mobile-enabled")}catch(r){console.error("Storyteller Suite: Error removing mobile classes",r)}}setupMobileOrientationHandlers(){if(!Et.isMobile())return;let e=()=>{this.leafletProcessor&&this.leafletProcessor.invalidateAllMapSizes(),this.app.workspace.getLeavesOfType(Af).forEach(s=>{s.view instanceof vv&&s.view.refresh()}),document.body.offsetHeight},r=null,n=()=>{r&&clearTimeout(r),r=setTimeout(()=>{e()},150)};this.orientationChangeHandler=e,this.resizeHandler=n,window.addEventListener("orientationchange",this.orientationChangeHandler),window.addEventListener("resize",this.resizeHandler)}cleanupMobileOrientationHandlers(){this.orientationChangeHandler&&(window.removeEventListener("orientationchange",this.orientationChangeHandler),this.orientationChangeHandler=null),this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null)}};
/**
 * timeline-arrows
 * https://github.com/javdome/timeline-arrows
 *
 * Class to easily draw lines to connect items in the vis Timeline module.
 *
 * @version 4.8.0
 * @date    2025-09-22
 *
 * @copyright (c) Javi Domenech (javdome@gmail.com) 
 *
 *
 * @license
 * timeline-arrows is dual licensed under both
 *
 *   1. The Apache 2.0 License
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *   and
 *
 *   2. The MIT License
 *      http://opensource.org/licenses/MIT
 *
 * timeline-arrows may be distributed under either license.
 */
/*! Bundled license information:

leaflet/dist/leaflet-src.js:
  (* @preserve
   * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
   * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
   *)

vis-timeline/standalone/esm/vis-timeline-graph2d.js:
  (*! moment.js *)
  (**
   * vis-timeline and vis-graph2d
   * https://visjs.github.io/vis-timeline/
   *
   * Create a fully customizable, interactive timeline with items and ranges.
   *
   * @version 7.7.0
   * @date    2022-07-10T21:34:08.601Z
   *
   * @copyright (c) 2011-2017 Almende B.V, http://almende.com
   * @copyright (c) 2017-2019 visjs contributors, https://github.com/visjs
   *
   * @license
   * vis.js is dual licensed under both
   *
   *   1. The Apache 2.0 License
   *      http://www.apache.org/licenses/LICENSE-2.0
   *
   *   and
   *
   *   2. The MIT License
   *      http://opensource.org/licenses/MIT
   *
   * vis.js may be distributed under either license.
   *)
  (*! Hammer.JS - v2.0.17-rc - 2019-12-16
   * http://naver.github.io/egjs
   *
   * Forked By Naver egjs
   * Copyright (c) hammerjs
   * Licensed under the MIT license *)
  (*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE *)

cytoscape/dist/cytoscape.esm.mjs:
  (*!
  Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
  Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
  Licensed under The MIT License (http://opensource.org/licenses/MIT)
  *)
  (*!
  Event object based on jQuery events, MIT license
  
  https://jquery.org/license/
  https://tldrlegal.com/license/mit-license
  https://github.com/jquery/jquery/blob/master/src/event.js
  *)
  (*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License *)
  (*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License *)

jszip/dist/jszip.min.js:
  (*!
  
  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>
  
  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
  
  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  *)
*/

/* nosourcemap */